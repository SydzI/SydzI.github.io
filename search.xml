<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>0xGame2025Week1WriteUp</title>
    <url>/2025/10/10/0xGame2025Week1ReverseWriteUp/</url>
    <content><![CDATA[<p>0xGame2025 Week1 Reverseæ–¹å‘å…¨è§£&amp;è¯¦è§£</p>
<span id="more"></span>

<h2 id="EasyXor"><a href="#EasyXor" class="headerlink" title="EasyXor"></a>EasyXor</h2><ul>
<li><p>é™„ä»¶ç¨‹åºç”¨IDAæ‰“å¼€å°±æ˜¯mainå‡½æ•°çš„ä½ç½®äº†ï¼ŒæŒ‰F5åç¼–è¯‘å¾—åˆ°å¦‚ä¸‹ï¼š</p>
<p><img src="/../images/image-20251003215402469-1760102969152-3.png" alt="åç¼–è¯‘ç»“æœ"></p>
<p>è¿›è¡Œä¸€äº›å°å°çš„å˜é‡åä¼˜åŒ–å¯ä»¥å¾—åˆ°ï¼š</p>
<p><img src="/../images/image-20251003215440797-1760102969152-2.png" alt="å°å°çš„ä¼˜åŒ–å"></p>
</li>
<li><p>å¯ä»¥çœ‹å‡ºï¼Œå‡½æ•°è·å–flagè¾“å…¥ï¼Œç„¶åå¯¹flagæ¯ä¸€ä½è¿›è¡Œå¼‚æˆ–ï¼Œå¼‚æˆ–çš„å€¼æ¥è‡ªä¸€ä¸ªç»™å®šçš„å­—ç¬¦ä¸²ï¼Œè¦æ±‚å¼‚æˆ–åçš„å€¼è¦ç­‰äºstr[i]-iã€‚æ‰€ä»¥è§£å¯†æ€è·¯æ˜¯ï¼ŒæŠŠå¼‚æˆ–å…³ç³»ä¸­çš„Charå’Œstr[i]-iè¿›è¡Œå¯¹è°ƒï¼Œå³ç”±Char^key[index%length] &#x3D;&#x3D; str[i]-i å¾—åˆ° ( str[i]-i )^key[index%length] &#x3D;&#x3D; Charã€‚è§£å¯†è„šæœ¬ï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs C"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;string.h&gt;</span></span><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>	<span class="hljs-type">char</span> str[] = &#123;<br>    <span class="hljs-number">0x42</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x27</span>,<br>    <span class="hljs-number">0x55</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x23</span>,<br>    <span class="hljs-number">0x6A</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span><br>    &#125;;<br>    <span class="hljs-type">char</span> key[] = <span class="hljs-string">&quot;raputa0xGame2025&quot;</span>;<br>    <span class="hljs-type">char</span> flag[<span class="hljs-number">45</span>];<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">43</span>; i++) &#123;<br>        flag[i] = (str[i] - i) ^ key[i % <span class="hljs-built_in">strlen</span>(key)];<br>    &#125;<br>    flag[<span class="hljs-number">44</span>] = <span class="hljs-string">&#x27;\0&#x27;</span>;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s&quot;</span>, flag);<br>	<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h2 id="BaseUpx"><a href="#BaseUpx" class="headerlink" title="BaseUpx"></a>BaseUpx</h2><ul>
<li><p>é¢˜ç›®æç¤ºæœ‰Upxå£³ï¼Œç”¨DIEæ‰“å¼€é™„ä»¶ç¨‹åºå¯ä»¥çœ‹å‡ºè¿™æ˜¯æ ‡å‡†upx4.24</p>
<p><img src="/../images/image-20251003221920374-1760102969152-1.png" alt="DIEç•Œé¢"></p>
</li>
<li><p>åœ¨Githubä¸Šä¸‹è½½<a href="https://github.com/upx/upx/releases/tag/v4.2.4">Release UPX 4.2.4 Â· upx&#x2F;upx</a>ï¼Œä½¿ç”¨æŒ‡ä»¤upx -dè„±å£³</p>
<p><img src="/../images/image-20251003222033233-1760102969152-7.png" alt="è„±å£³"></p>
</li>
<li><p>ç„¶åå°±å¯ä»¥æŠŠè„±å£³åçš„ç¨‹åºæ‹¿åˆ°IDAé‡Œåˆ†æï¼Œæ‰“å¼€å°±æ˜¯mainå‡½æ•°äº†ï¼ŒæŒ‰F5åç¼–è¯‘ï¼š</p>
<p><img src="/../images/image-20251003222227627-1760102969152-5.png" alt="åç¼–è¯‘ç»“æœ"></p>
</li>
<li><p>å¯ä»¥çœ‹åˆ°å‡½æ•°å¯¹è¾“å…¥çš„encï¼ˆå®é™…ä¸Šæ˜¯flagï¼‰è¿›è¡Œäº†base64encodeï¼Œç„¶åå’Œstrè¿›è¡Œæ¯”è¾ƒã€‚å› æ­¤æ€è·¯æ˜¯æ‹¿åˆ°strï¼Œç›´æ¥ç”¨<a href="https://cyberchef.org/">CyberChef</a>æ¥è¿›è¡Œbase64è§£ç ï¼š</p>
<p><img src="/../images/image-20251003222543143-1760102969152-6.png" alt="cyberchefè§£å¯†"></p>
</li>
</ul>
<h2 id="SignIn"><a href="#SignIn" class="headerlink" title="SignIn"></a>SignIn</h2><ul>
<li><p>é™„ä»¶ç¨‹åºç”¨IDAæ‰“å¼€ï¼Œç›´æ¥å°±æ˜¯mainå‡½æ•°äº†ï¼ŒæŒ‰F5åç¼–è¯‘ï¼Œæç¤ºflagåœ¨ç¨‹åºé‡Œ</p>
<p><img src="/../images/image-20251003222821412-1760102969152-4.png" alt="mainå‡½æ•°"></p>
</li>
<li><p>shift+F12æŸ¥çœ‹å­—ç¬¦ä¸²è¡¨ï¼Œå°±å¯ä»¥æ‰¾åˆ°flagäº†</p>
<p><img src="/../images/image-20251003222909434-1760102969152-8.png" alt="å­—ç¬¦ä¸²è¡¨"></p>
</li>
</ul>
<h2 id="SignIn2"><a href="#SignIn2" class="headerlink" title="SignIn2"></a>SignIn2</h2><ul>
<li><p>è¿è¡Œé™„ä»¶ç¨‹åºå¯ä»¥çœ‹åˆ°ä¸€äº›æç¤ºï¼š</p>
<p><img src="/../images/image-20251003223506054-1760102969152-9.png" alt="æç¤º"></p>
<p>æç¤ºROT47ï¼Œåº”è¯¥æ˜¯æŸç§åŠ å¯†</p>
</li>
<li><p>é™„ä»¶ç¨‹åºç”¨IDAæ‰“å¼€ï¼ŒæŒ‰F5åç¼–è¯‘mainå‡½æ•°ï¼š</p>
<p><img src="/../images/image-20251003223242376-1760102969152-10.png" alt="mainå‡½æ•°"></p>
<p>å¯ä»¥çœ‹åˆ°ç¨‹åºé‡Œæœ¬æ¥å°±æœ‰ä¸€ä¸ªflagï¼Œç¨‹åºæ‹¿åˆ°æˆ‘ä»¬è¾“å…¥çš„æ•°å­—åå¯¹flagè¿›è¡Œäº†åŠ å¯†ï¼Œç„¶åæ£€æŸ¥åŠ å¯†åçš„flagå¼€å¤´å‡ ä¸ªå­—æ¯æ˜¯ä¸æ˜¯â€0xGameâ€ã€‚æ—¢ç„¶æåˆ°äº†ROT47ï¼Œå°±æŠŠflagçš„æ•°æ®æ‹¿åˆ°<a href="https://cyberchef.org/">CyberChef</a>é‡Œçœ‹çœ‹èƒ½ä¸èƒ½è§£å¯†ï¼Œåˆšå¥½å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªROT 47 Brust Forceï¼ˆflagå°±ç›´æ¥å¤åˆ¶ç¨‹åºé‡Œçš„å°±å¥½äº†ï¼‰ï¼š</p>
<p><img src="/../images/image-20251004143034177-1760102969153-11.png" alt="cyberchef"></p>
<p>å½“æ—¶è§£å®Œæ²¡ç»†çœ‹flagå†…å®¹ï¼Œå¤ç°è¿™é¢˜æ¥å†™åšå®¢çš„æ—¶å€™çœ‹åˆ°è¿™ä¸ªflagè¿˜æœ‰ç‚¹æ€€ç–‘å¯¹ä¸å¯¹ğŸ˜‚</p>
</li>
</ul>
<h2 id="ZZZ"><a href="#ZZZ" class="headerlink" title="ZZZ"></a>ZZZ</h2><ul>
<li><p>é™„ä»¶ç¨‹åºç”¨IDAæ‰“å¼€ï¼Œç›´æ¥å°±æ˜¯mainå‡½æ•°äº†ï¼ŒæŒ‰F5åç¼–è¯‘ä¸€ä¸‹ï¼š</p>
<p><img src="/../images/image-20251004151114879-1760102969153-12.png" alt="mainå‡½æ•°åç¼–è¯‘ç»“æœ"></p>
</li>
<li><p>å¯ä»¥çœ‹å‡ºç¨‹åºæ‹¿åˆ°è¾“å…¥çš„flagåå…ˆæ£€æŸ¥äº†ä¸€ä¸‹æ ¼å¼ï¼Œç„¶åæˆªå–é™¤äº†4ä¸ªéƒ¨åˆ†ï¼Œæ‹¿è¿™4ä¸ªéƒ¨åˆ†å»ºç«‹äº†ç­‰å¼ã€‚ç»“åˆé¢˜ç›®ZZZå¯ä»¥æ¨æµ‹è¿™æ˜¯åœ¨è€ƒz3æ±‚è§£ã€‚é¢˜ç›®ä¸ºäº†ä¿è¯å”¯ä¸€è§£è¿˜ç»™äº†flagçš„sha256æ¥éªŒè¯</p>
</li>
<li><p>ç”¨z3å¤ç°ä¸€ä¸‹ç­‰å¼ï¼Œå†åŠ ä¸Šsha256éªŒè¯ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> z3 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> hashlib<br>sha256=<span class="hljs-string">&#x27;4aba519d4666f5421488afaaf89efdcbe48e7a53f814ce5c1d82b46b55032651&#x27;</span><br>s=Solver()<br>x1=BitVec(<span class="hljs-string">&#x27;x1&#x27;</span>,<span class="hljs-number">32</span>)<br>x2=BitVec(<span class="hljs-string">&#x27;x2&#x27;</span>,<span class="hljs-number">32</span>)<br>x3=BitVec(<span class="hljs-string">&#x27;x3&#x27;</span>,<span class="hljs-number">32</span>)<br>x4=BitVec(<span class="hljs-string">&#x27;x4&#x27;</span>,<span class="hljs-number">32</span>)<br>s.add(<span class="hljs-number">3</span> * x2 + <span class="hljs-number">5</span> * x1 + <span class="hljs-number">7</span> * x4 + <span class="hljs-number">2</span> * x3 == -<span class="hljs-number">1445932505</span>)<br>s.add(<span class="hljs-number">2</span> * (<span class="hljs-number">2</span> * (<span class="hljs-number">2</span> * x2 + x3) + x1) + x4 == -<span class="hljs-number">672666814</span>)<br>s.add(<span class="hljs-number">7</span> * x2 + <span class="hljs-number">3</span> * x1 + <span class="hljs-number">5</span> * x4 + <span class="hljs-number">4</span> * x3 == <span class="hljs-number">958464147</span>)<br>s.add(((x1 ^ x2) &lt;&lt; <span class="hljs-number">6</span>) + ((x3 &gt;&gt; <span class="hljs-number">6</span>) ^ <span class="hljs-number">0x4514</span>) == <span class="hljs-number">123074281</span>)<br><br><span class="hljs-keyword">while</span> s.check() == sat:<br>    model=s.model()<br>    x1_val=model[x1].as_long()<br>    x2_val=model[x2].as_long()<br>    x3_val=model[x3].as_long()<br>    x4_val=model[x4].as_long()<br>    flag=<span class="hljs-string">f&quot;0xGame&#123;&#123;<span class="hljs-subst">&#123;x1_val:08x&#125;</span><span class="hljs-subst">&#123;x2_val:08x&#125;</span><span class="hljs-subst">&#123;x3_val:08x&#125;</span><span class="hljs-subst">&#123;x4_val:08x&#125;</span>&#125;&#125;&quot;</span><br>    <span class="hljs-keyword">if</span> hashlib.sha256(flag.encode()).hexdigest()==sha256:<span class="hljs-comment">#éªŒè¯æ˜¯å¦ä¸ºæ­£ç¡®flag</span><br>        <span class="hljs-built_in">print</span>(flag)<br>    exception=Or(x1!=x1_val,x2!=x2_val,x3!=x3_val,x4!=x4_val)<span class="hljs-comment">#æ’é™¤åŒä¸€è§£</span><br>    s.add(exception)<br></code></pre></td></tr></table></figure></li>
</ul>
<h2 id="DyDebug"><a href="#DyDebug" class="headerlink" title="DyDebug"></a>DyDebug</h2><ul>
<li><p>é™„ä»¶ç¨‹åºç”¨IDAæ‰“å¼€ï¼Œç›´æ¥å°±æ˜¯mainå‡½æ•°äº†ï¼ŒæŒ‰F5çœ‹çœ‹åç¼–è¯‘ï¼š</p>
<p><img src="/../images/image-20251004131520036-1760102969153-13.png" alt="mainå‡½æ•°åç¼–è¯‘ç»“æœ"></p>
</li>
<li><p>å¦‚æ³¨é‡Šå†™çš„ï¼Œç¨‹åºå¯¹æˆ‘ä»¬çš„è¾“å…¥æ²¡æœ‰ä»»ä½•æ“ä½œï¼Œè€Œæ˜¯æ‹¿äº†flagæ˜æ–‡æ¥æ¯”è¾ƒï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥åŠ¨æ€è°ƒè¯•æ‹¿åˆ°flagæ˜æ–‡ã€‚è¿™é‡Œéœ€è¦çŸ¥é“ä¸€äº›æ±‡ç¼–å°çŸ¥è¯†ï¼šå‡½æ•°çš„è¿”å›å€¼å­˜æ”¾åœ¨å¯„å­˜å™¨raxé‡Œã€‚ç„¶åå¼€å§‹æˆ‘ä»¬çš„æ“ä½œï¼š</p>
<p>åœ¨mainå‡½æ•°åç¼–è¯‘ç•Œé¢é€‰ä¸­è§£å¯†å‡½æ•°decrypt_string()æ‰€åœ¨è¡Œï¼Œå³é”®é€‰æ‹©jump to disasmè·³åˆ°æ±‡ç¼–ç•Œé¢ï¼š</p>
<p><img src="/../images/image-20251004134158983-1760102969153-14.png" alt="jump to disasm"></p>
<p>å…‰æ ‡åœåœ¨çš„åœ°æ–¹é™„è¿‘å°±æœ‰ä¸€ä¸ªcall _Z14decrypt_stringPKcyæŒ‡ä»¤ï¼Œåé¢æœ‰æ³¨é‡Šæ˜¯è§£å¯†å‡½æ•°decrypt_string()</p>
<p><img src="/../images/image-20251004134355375-1760102969153-15.png" alt="å…‰æ ‡åœåœ¨è¿™é‡Œ"></p>
<p>å…¶å®å…‰æ ‡åœåœ¨çš„ä½ç½®çš„æŒ‡ä»¤å°±æ˜¯å–å‡½æ•°è¿”å›å€¼çš„æ“ä½œäº†ã€‚å‡½æ•°çš„è¿”å›å€¼æ”¾åœ¨raxé‡Œï¼Œè€Œè¿™æ¡æŒ‡ä»¤æŠŠrax movï¼ˆç§»åŠ¨ï¼‰åˆ°äº†[rbp-10h+decrypted_str]ï¼Œçœ‹ä¸æ‡‚æ²¡å…³ç³»ï¼Œåªéœ€è¦çŸ¥é“å‡½æ•°è¿”å›å€¼å¯ä»¥é€šè¿‡è¿™é‡Œçš„raxçœ‹åˆ°å°±è¡Œäº†ã€‚è¿™ä¸ªè¿”å›å€¼å°±æ˜¯è§£å¯†åå¾—åˆ°çš„flagæ˜æ–‡ã€‚åœ¨å…‰æ ‡åœåœ¨çš„ä½ç½®æŒ‰F2ä¸‹æ–­ç‚¹</p>
<p><img src="/../images/image-20251004134943597-1760102969153-16.png" alt="F2ä¸‹æ–­ç‚¹"></p>
<p>æŠŠç•Œé¢æ­£ä¸Šæ–¹çš„â€no debuggerâ€æ”¹é€‰æˆâ€local windows debuggerâ€ï¼ŒæŒ‰æ—è¾¹ç»¿è‰²çš„ä¸‰è§’å½¢å¼€å§‹è°ƒè¯•</p>
<p><img src="/../images/image-20251004135012031-1760102969153-20.png" alt="local windows debugger"></p>
<p>è¿™æ—¶å€™ä¼šå¼¹å‡ºå‘½ä»¤è¡Œçª—å£ï¼Œéšä¾¿è¾“å…¥ä¸€ç‚¹ä¸œè¥¿ï¼ŒæŒ‰å›è½¦</p>
<p><img src="/../images/image-20251004135050308-1760102969153-18.png" alt="éšä¾¿è¾“ç‚¹ä¸œè¥¿"></p>
<p>å¯ä»¥çœ‹åˆ°IDAé‡Œç¨‹åºåœåœ¨äº†æˆ‘ä»¬åˆšåˆšä¸‹æ–­ç‚¹çš„åœ°æ–¹</p>
<p><img src="/../images/image-20251004135229299-1760102969153-17.png" alt="åœåœ¨äº†æ–­ç‚¹ä½ç½®"></p>
<p>æŠŠé¼ æ ‡ç§»åˆ°raxä¸Šå°±å¯ä»¥çœ‹åˆ°flagäº†ï¼ŒåŒå‡»raxåˆ°flagçš„ä½ç½®ï¼Œå¯ä»¥æŠŠè¿™ä¸€ä¸²æ•°æ®å¤åˆ¶ç»™AIæå–</p>
<p><img src="/../images/image-20251004135253094-1760102969153-19.png" alt="flagçš„ä½ç½®"></p>
</li>
</ul>
]]></content>
      <categories>
        <category>WriteUp&amp;å¤ç°</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>WriteUp</tag>
        <tag>Reverse</tag>
      </tags>
  </entry>
  <entry>
    <title>0xGame2025Week2WriteUp</title>
    <url>/2025/10/19/0xGame2025Week2ReverseWriteUp/</url>
    <content><![CDATA[<p>0xGame2025 Week2 Reverseæ–¹å‘å…¨è§£&amp;è¯¦è§£</p>
<span id="more"></span>

<h2 id="shuffle"><a href="#shuffle" class="headerlink" title="shuffle"></a>shuffle</h2><ul>
<li><p>é™„ä»¶ç”¨IDAæ‰“å¼€ï¼Œmainå‡½æ•°åç¼–è¯‘åå¤§æ¦‚é•¿è¿™æ ·ï¼š</p>
<p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-10-08%20220553.png" alt="mainå‡½æ•°"></p>
<p>è¿™æ˜¯shuffleå‡½æ•°ï¼š</p>
<p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-10-08%20220917.png" alt="shuffleå‡½æ•°"></p>
<p>å¯ä»¥çœ‹å‡ºè¿™æ˜¯åœ¨è€ƒéšæœºæ•°ï¼Œæœ‰äº†ç§å­å°±å¯ä»¥å¾—åˆ°ä¸€æ¨¡ä¸€æ ·çš„éšæœºæ•°åºåˆ—ã€‚å›åˆ°mainå‡½æ•°ï¼ŒåŒå‡»seedå¯ä»¥å¾—åˆ°ä¸€ä¸ªå€¼ï¼š</p>
<p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-10-08%20220939.png" alt="mainå‡½æ•°ä¸­çš„seed"></p>
<p>ä½†æ˜¯ç»è¿‡æµ‹è¯•è¿™ä¸ªseedè§£ä¸å‡ºflagï¼Œå›å¤´çœ‹å¯ä»¥å‘ç°ä¸Šå›¾ä¸­seedè¿˜æœ‰å¦ä¸€ä¸ªå¼•ç”¨ï¼šruntime_envï¼Œå¾ˆå¯ç–‘äº†ã€‚åŒå‡»è·³è½¬ï¼š</p>
<p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-10-08%20220959.png" alt="å¦æœ‰å…¶seed"></p>
<p>å‡ºç°äº†å¯¹seedçš„èµ‹å€¼ï¼Œç»“åˆåå­—çš„â€runtimeâ€å¯ä»¥æ¨æµ‹è¿™ä¸ªæ‰æ˜¯çœŸæ­£çš„seed</p>
</li>
<li><p>è§£å¯†è„šæœ¬ï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs C"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span><br><br><span class="hljs-type">void</span> <span class="hljs-title function_">unshuffle_simple</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *str, <span class="hljs-type">int</span> length)</span> &#123;<br>    <span class="hljs-type">int</span> *rand_vals = (<span class="hljs-type">int</span>*)<span class="hljs-built_in">malloc</span>(length * <span class="hljs-keyword">sizeof</span>(<span class="hljs-type">int</span>));<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> temp;<br>    <span class="hljs-type">int</span> i, j;<br><br>    <span class="hljs-comment">// å…ˆè·å–æ‰€æœ‰éšæœºå€¼</span><br>    <span class="hljs-keyword">for</span> (i = length - <span class="hljs-number">1</span>; i &gt; <span class="hljs-number">0</span>; --i) &#123;<br>        rand_vals[i] = rand();<br>    &#125;<br><br>    <span class="hljs-comment">// é€†å‘æ´—ç‰Œï¼šä»å‰å¾€å</span><br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">1</span>; i &lt; length; i++) &#123;<br>        j = rand_vals[i] % (i + <span class="hljs-number">1</span>);<br>        <span class="hljs-comment">// æ‰§è¡Œç›¸åŒçš„äº¤æ¢</span><br>        temp = str[i];<br>        str[i] = str[j];<br>        str[j] = temp;<br>    &#125;<br><br>    <span class="hljs-built_in">free</span>(rand_vals);<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> seed = <span class="hljs-number">0x666</span>;<br>    <span class="hljs-type">char</span> flag[] = <span class="hljs-string">&quot;23-64bed6&#125;-xm5300-&#123;faGa34-0e04c2e7c2a78f39a4&quot;</span>;<br>    <span class="hljs-type">int</span> length = <span class="hljs-built_in">strlen</span>(flag);<br>    srand(seed);<br>    unshuffle_simple((<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>*)flag, length);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;flag: %s\n&quot;</span>, flag);<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h2 id="ç®—æ•°é«˜æ‰‹"><a href="#ç®—æ•°é«˜æ‰‹" class="headerlink" title="ç®—æ•°é«˜æ‰‹"></a>ç®—æ•°é«˜æ‰‹</h2><ul>
<li><p>é™„ä»¶ç¨‹åºæ˜¯ä¸ªpythonexeï¼Œç›¸å…³çŸ¥è¯†å¯ä»¥å‚è€ƒ<a href="http://sydzi.github.io/2025/10/05/Day17-python%E9%80%86%E5%90%91/">Day17:pythoné€†å‘</a><del>ï¼ˆç‹å©†å–ç“œing</del>ã€‚ä½¿ç”¨<a href="https://github.com/extremecoders-re/pyinstxtractor">pyinstxtractor</a>è§£åŒ…åå¯ä»¥å¾—åˆ°ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼š</p>
<p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-10-09%20082444.png" alt="pyinstxtractorè§£åŒ…"></p>
<p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-10-09%20082559.png" alt="è§£åŒ…å¾—åˆ°çš„æ–‡ä»¶å¤¹"></p>
</li>
<li><p>æ ¹æ®pyinstxtractorçš„æç¤ºå¯ä»¥æ‰¾åˆ°ç–‘ä¼¼å…¥å£æ–‡ä»¶ï¼ŒåŒåçš„æ–‡ä»¶å¯èƒ½æ€§å¤§ç‚¹ã€‚ç„¶åç”¨uncompyle6æŠŠpycè½¬æˆpyæ ¼å¼ï¼š</p>
<p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-10-09%20082742.png" alt="pycè½¬æˆpy(å¿½ç•¥æˆ‘çš„ç¯å¢ƒæŠ¥é”™)"></p>
</li>
<li><p>ç›´æ¥å¾—åˆ°flag</p>
</li>
</ul>
<h2 id="BabyJar"><a href="#BabyJar" class="headerlink" title="BabyJar"></a>BabyJar</h2><ul>
<li><p>é™„ä»¶ç¨‹åºæ˜¯ä¸ªjaræ–‡ä»¶ï¼Œç”¨jd-guiæ‰“å¼€ï¼š</p>
<p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-10-09%20090601.png" alt="mainå‡½æ•°"></p>
<p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-10-09%20090623.png" alt="encryptå‡½æ•°"></p>
</li>
<li><p>å¯ä»¥çœ‹åˆ°è¿™æ˜¯ä¸€ä¸ªjavaçš„flagæ£€éªŒç¨‹åºï¼ŒåŠ å¯†é€»è¾‘åœ¨encryptæ–¹æ³•é‡Œã€‚ä¸Šå›¾é€‰ä¸­çš„é‚£è¡ŒæŠŠå­—èŠ‚çš„é«˜ä½ç§»åˆ°ä½ä½ï¼Œä½ä½ç§»åˆ°é«˜ä½ï¼Œæ‰€ä»¥å†æ“ä½œä¸€æ¬¡å°±å¯ä»¥è¿˜åŸã€‚è¿˜è¦æ³¨æ„encryptçš„è¿”å›å€¼è¿›è¡Œäº†base64ç¼–ç ã€‚</p>
</li>
<li><p>è§£å¯†è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">enc,key</span>):<br>    enc=base64.b64decode(enc)<br>    flag=<span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> enc:<br>        temp=((i&amp;<span class="hljs-number">240</span>)&gt;&gt;<span class="hljs-number">4</span>|(i&amp;<span class="hljs-number">15</span>)&lt;&lt;<span class="hljs-number">4</span>)<br>        flag+=<span class="hljs-built_in">chr</span>(temp^key)<br>    <span class="hljs-keyword">return</span> flag<br><br>enc=<span class="hljs-string">&quot;QsY1V5cX9jJyF2JSAgdikwfCEneTAgICUpNnd1Iyk8IXUkJ3QhcyZ8J3YpY=&quot;</span><br>key=<span class="hljs-number">20</span><br>flag=<span class="hljs-string">&quot;&quot;</span><br>flag=decrypt(enc,key)<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure></li>
</ul>
<h2 id="16bit"><a href="#16bit" class="headerlink" title="16bit"></a>16bit</h2><ul>
<li><p>æ ¹æ®é¢˜ç›®åç§°å’Œæç¤ºå¯ä»¥æ¨æµ‹è€ƒå¯Ÿ16ä½ç¯å¢ƒé€†å‘ã€‚é™„ä»¶ç¨‹åºä¸èƒ½è¿è¡Œï¼ŒIDAä¹Ÿåç¼–è¯‘ä¸äº†ï¼Œåªèƒ½è¯»æ±‡ç¼–ï¼š</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm"><span class="hljs-symbol">seg000:</span><span class="hljs-number">0000</span> <span class="hljs-comment">; =============== S U B R O U T I N E =======================================</span><br><span class="hljs-symbol">seg000:</span><span class="hljs-number">0000</span><br><span class="hljs-symbol">seg000:</span><span class="hljs-number">0000</span> <span class="hljs-comment">; Attributes: noreturn</span><br><span class="hljs-symbol">seg000:</span><span class="hljs-number">0000</span><br><span class="hljs-symbol">seg000:</span><span class="hljs-number">0000</span>                 <span class="hljs-meta">public</span> start<br><span class="hljs-symbol">seg000:</span><span class="hljs-number">0000</span> start           proc <span class="hljs-built_in">near</span><br><span class="hljs-symbol">seg000:</span><span class="hljs-number">0000</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ax</span>, <span class="hljs-built_in">seg</span> dseg<br><span class="hljs-symbol">seg000:</span><span class="hljs-number">0003</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ds</span>, <span class="hljs-built_in">ax</span>          <span class="hljs-comment">; dsegæ˜¯æ•°æ®æ®µï¼Œæœ‰flagåŠ å¯†åçš„æ•°æ®</span><br><span class="hljs-symbol">seg000:</span><span class="hljs-number">0005</span>                 <span class="hljs-meta">assume</span> <span class="hljs-built_in">ds</span>:dseg<br><span class="hljs-symbol">seg000:</span><span class="hljs-number">0005</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">cx</span>, <span class="hljs-number">17h</span>         <span class="hljs-comment">; countå¯„å­˜å™¨ï¼Œä¸€èˆ¬å­˜æ”¾å¾ªç¯æ¬¡æ•°</span><br><span class="hljs-symbol">seg000:</span><span class="hljs-number">0008</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">si</span>, <span class="hljs-number">0</span><br><span class="hljs-symbol">seg000:</span><span class="hljs-number">000B</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">di</span>, <span class="hljs-number">0</span><br><span class="hljs-symbol">seg000:</span>000E<br><span class="hljs-symbol">seg000:</span>000E loc_1000E:                              <span class="hljs-comment">; CODE XREF: start+1Câ†“j</span><br><span class="hljs-symbol">seg000:</span>000E                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">al</span>, [<span class="hljs-built_in">si</span>+<span class="hljs-number">0Ah</span>]    <span class="hljs-comment">; si=0æ—¶[0Ah]å³dsegï¼š000Aï¼Œæ˜¯flagå¯†æ–‡çš„ä½ç½®ï¼Œæ­¤å¤„æ˜¯åœ¨å–å‡ºå¯†æ–‡</span><br><span class="hljs-symbol">seg000:</span><span class="hljs-number">0012</span>                 <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">al</span>, <span class="hljs-number">9</span>           <span class="hljs-comment">; å‡9</span><br><span class="hljs-symbol">seg000:</span><span class="hljs-number">0014</span>                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">al</span>, <span class="hljs-number">0Eh</span>         <span class="hljs-comment">; å¼‚æˆ–</span><br><span class="hljs-symbol">seg000:</span><span class="hljs-number">0016</span>                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">di</span>+<span class="hljs-number">38h</span>], <span class="hljs-built_in">al</span>    <span class="hljs-comment">; è§£å¯†åçš„æ•°æ®å­˜æ”¾åˆ°ä»¥[38h]å³dseg:0038hä¸ºèµ·å§‹çš„åŒºåŸŸ</span><br><span class="hljs-symbol">seg000:</span>001A                 <span class="hljs-keyword">inc</span>     <span class="hljs-built_in">si</span>              <span class="hljs-comment">; å¾€ä¸‹å–</span><br><span class="hljs-symbol">seg000:</span><span class="hljs-number">001B</span>                 <span class="hljs-keyword">inc</span>     <span class="hljs-built_in">di</span>              <span class="hljs-comment">; å¾€ä¸‹å­˜</span><br><span class="hljs-symbol">seg000:</span>001C                 <span class="hljs-keyword">loop</span>    loc_1000E       <span class="hljs-comment">; si=0æ—¶[0Ah]å³dsegï¼š000Aï¼Œæ˜¯flagå¯†æ–‡çš„ä½ç½®ï¼Œæ­¤å¤„æ˜¯åœ¨å–å‡ºå¯†æ–‡</span><br><span class="hljs-symbol">seg000:</span>001E                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">cx</span>, <span class="hljs-number">17h</span>         <span class="hljs-comment">; æ›´æ–°å¾ªç¯æ¬¡æ•°</span><br><span class="hljs-symbol">seg000:</span><span class="hljs-number">0021</span><br><span class="hljs-symbol">seg000:</span><span class="hljs-number">0021</span> loc_10021:                              <span class="hljs-comment">; CODE XREF: start+2Fâ†“j</span><br><span class="hljs-symbol">seg000:</span><span class="hljs-number">0021</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">al</span>, [<span class="hljs-built_in">si</span>+<span class="hljs-number">0Ah</span>]    <span class="hljs-comment">; æ­¤å¤„si=17h,æ‰€ä»¥å–çš„æ˜¯ä»¥dseg:0021hä¸ºèµ·å§‹çš„æ•°æ®</span><br><span class="hljs-symbol">seg000:</span><span class="hljs-number">0025</span>                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">al</span>, <span class="hljs-number">0Eh</span>         <span class="hljs-comment">; å¼‚æˆ–</span><br><span class="hljs-symbol">seg000:</span><span class="hljs-number">0027</span>                 <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">al</span>, <span class="hljs-number">9</span>           <span class="hljs-comment">; å‡9</span><br><span class="hljs-symbol">seg000:</span><span class="hljs-number">0029</span>                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">di</span>+<span class="hljs-number">38h</span>], <span class="hljs-built_in">al</span>    <span class="hljs-comment">; è§£å¯†åçš„æ•°æ®å­˜æ”¾åˆ°seg:004fä¸ºèµ·å§‹çš„åŒºåŸŸ</span><br><span class="hljs-symbol">seg000:</span><span class="hljs-number">002D</span>                 <span class="hljs-keyword">inc</span>     <span class="hljs-built_in">si</span>              <span class="hljs-comment">; å¾€ä¸‹å–</span><br><span class="hljs-symbol">seg000:</span>002E                 <span class="hljs-keyword">inc</span>     <span class="hljs-built_in">di</span>              <span class="hljs-comment">; å¾€ä¸‹å­˜</span><br><span class="hljs-symbol">seg000:</span>002F                 <span class="hljs-keyword">loop</span>    loc_10021       <span class="hljs-comment">; æ­¤å¤„si=17h,æ‰€ä»¥å–çš„æ˜¯ä»¥dseg:0021hä¸ºèµ·å§‹çš„æ•°æ®</span><br><span class="hljs-symbol">seg000:</span><span class="hljs-number">0031</span>                 <span class="hljs-keyword">mov</span>     byte_100A6, <span class="hljs-number">24h</span> <span class="hljs-comment">; &#x27;$&#x27; ; byte_100A6æ˜¯&quot;flag=&quot;ï¼Œæ­¤å¤„æ˜¯åœ¨æ‰“å°flag</span><br><span class="hljs-symbol">seg000:</span><span class="hljs-number">0036</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">dx</span>, <span class="hljs-number">67h</span> <span class="hljs-comment">; &#x27;g&#x27;</span><br><span class="hljs-symbol">seg000:</span><span class="hljs-number">0039</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-number">ah</span>, <span class="hljs-number">9</span><br><span class="hljs-symbol">seg000:</span>003B                 <span class="hljs-keyword">int</span>     <span class="hljs-number">21h</span>             <span class="hljs-comment">; DOS - PRINT STRING</span><br><span class="hljs-symbol">seg000:</span>003B                                         <span class="hljs-comment">; DS:DX -&gt; string terminated by &quot;$&quot;</span><br><span class="hljs-symbol">seg000:</span><span class="hljs-number">003D</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">dx</span>, <span class="hljs-number">38h</span> <span class="hljs-comment">; &#x27;8&#x27;</span><br><span class="hljs-symbol">seg000:</span><span class="hljs-number">0040</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-number">ah</span>, <span class="hljs-number">9</span><br><span class="hljs-symbol">seg000:</span><span class="hljs-number">0042</span>                 <span class="hljs-keyword">int</span>     <span class="hljs-number">21h</span>             <span class="hljs-comment">; DOS - PRINT STRING</span><br><span class="hljs-symbol">seg000:</span><span class="hljs-number">0042</span>                                         <span class="hljs-comment">; DS:DX -&gt; string terminated by &quot;$&quot;</span><br><span class="hljs-symbol">seg000:</span><span class="hljs-number">0044</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ax</span>, <span class="hljs-number">4C00h</span><br><span class="hljs-symbol">seg000:</span><span class="hljs-number">0047</span>                 <span class="hljs-keyword">int</span>     <span class="hljs-number">21h</span>             <span class="hljs-comment">; DOS - 2+ - QUIT WITH EXIT CODE (EXIT)</span><br><span class="hljs-symbol">seg000:</span><span class="hljs-number">0047</span> start           endp                    <span class="hljs-comment">; AL = exit code</span><br><span class="hljs-symbol">seg000:</span><span class="hljs-number">0047</span><br><span class="hljs-symbol">seg000:</span><span class="hljs-number">0047</span> seg000          ends<br><span class="hljs-symbol">seg000:</span><span class="hljs-number">0047</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0009</span> <span class="hljs-comment">; ===========================================================================</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0009</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0009</span> <span class="hljs-comment">; Segment type: Pure data</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0009</span> dseg            <span class="hljs-meta">segment</span> para <span class="hljs-meta">public</span> <span class="hljs-string">&#x27;DATA&#x27;</span> <span class="hljs-meta">use16</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0009</span>                 <span class="hljs-meta">assume</span> <span class="hljs-built_in">cs</span>:dseg<br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0009</span>                 <span class="hljs-comment">;org 9</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0009</span>                 <span class="hljs-meta">align</span> <span class="hljs-number">2</span><br><span class="hljs-symbol">dseg:</span>000A                 <span class="hljs-built_in">db</span>  <span class="hljs-number">47h</span> <span class="hljs-comment">; G</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">000B</span>                 <span class="hljs-built_in">db</span>  <span class="hljs-number">7Fh</span> <span class="hljs-comment">; </span><br><span class="hljs-symbol">dseg:</span>000C                 <span class="hljs-built_in">db</span>  <span class="hljs-number">52h</span> <span class="hljs-comment">; R</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">000D</span>                 <span class="hljs-built_in">db</span>  <span class="hljs-number">78h</span> <span class="hljs-comment">; x</span><br><span class="hljs-symbol">dseg:</span>000E                 <span class="hljs-built_in">db</span>  <span class="hljs-number">6Ch</span> <span class="hljs-comment">; l</span><br><span class="hljs-symbol">dseg:</span>000F                 <span class="hljs-built_in">db</span>  <span class="hljs-number">74h</span> <span class="hljs-comment">; t</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0010</span>                 <span class="hljs-built_in">db</span>  <span class="hljs-number">7Eh</span> <span class="hljs-comment">; ~</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0011</span>                 <span class="hljs-built_in">db</span>  <span class="hljs-number">72h</span> <span class="hljs-comment">; r</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0012</span>                 <span class="hljs-built_in">db</span>  <span class="hljs-number">47h</span> <span class="hljs-comment">; G</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0013</span>                 <span class="hljs-built_in">db</span>  <span class="hljs-number">47h</span> <span class="hljs-comment">; G</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0014</span>                 <span class="hljs-built_in">db</span>  <span class="hljs-number">73h</span> <span class="hljs-comment">; s</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0015</span>                 <span class="hljs-built_in">db</span>  <span class="hljs-number">5Ah</span> <span class="hljs-comment">; Z</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0016</span>                 <span class="hljs-built_in">db</span>  <span class="hljs-number">84h</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0017</span>                 <span class="hljs-built_in">db</span>  <span class="hljs-number">5Ah</span> <span class="hljs-comment">; Z</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0018</span>                 <span class="hljs-built_in">db</span>  <span class="hljs-number">43h</span> <span class="hljs-comment">; C</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0019</span>                 <span class="hljs-built_in">db</span>  <span class="hljs-number">85h</span><br><span class="hljs-symbol">dseg:</span>001A                 <span class="hljs-built_in">db</span>  <span class="hljs-number">46h</span> <span class="hljs-comment">; F</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">001B</span>                 <span class="hljs-built_in">db</span>  <span class="hljs-number">5Ah</span> <span class="hljs-comment">; Z</span><br><span class="hljs-symbol">dseg:</span>001C                 <span class="hljs-built_in">db</span>  <span class="hljs-number">83h</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">001D</span>                 <span class="hljs-built_in">db</span>  <span class="hljs-number">6Fh</span> <span class="hljs-comment">; o</span><br><span class="hljs-symbol">dseg:</span>001E                 <span class="hljs-built_in">db</span>  <span class="hljs-number">46h</span> <span class="hljs-comment">; F</span><br><span class="hljs-symbol">dseg:</span>001F                 <span class="hljs-built_in">db</span>  <span class="hljs-number">5Ah</span> <span class="hljs-comment">; Z</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0020</span>                 <span class="hljs-built_in">db</span>  <span class="hljs-number">6Ch</span> <span class="hljs-comment">; l</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0021</span>                 <span class="hljs-built_in">db</span>  <span class="hljs-number">33h</span> <span class="hljs-comment">; 3</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0022</span>                 <span class="hljs-built_in">db</span>  <span class="hljs-number">30h</span> <span class="hljs-comment">; 0</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0023</span>                 <span class="hljs-built_in">db</span>  <span class="hljs-number">73h</span> <span class="hljs-comment">; s</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0024</span>                 <span class="hljs-built_in">db</span>  <span class="hljs-number">32h</span> <span class="hljs-comment">; 2</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0025</span>                 <span class="hljs-built_in">db</span>  <span class="hljs-number">75h</span> <span class="hljs-comment">; u</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0026</span>                 <span class="hljs-built_in">db</span>  <span class="hljs-number">66h</span> <span class="hljs-comment">; f</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0027</span>                 <span class="hljs-built_in">db</span>  <span class="hljs-number">37h</span> <span class="hljs-comment">; 7</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0028</span>                 <span class="hljs-built_in">db</span>  <span class="hljs-number">61h</span> <span class="hljs-comment">; a</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0029</span>                 <span class="hljs-built_in">db</span>  <span class="hljs-number">66h</span> <span class="hljs-comment">; f</span><br><span class="hljs-symbol">dseg:</span>002A                 <span class="hljs-built_in">db</span>  <span class="hljs-number">33h</span> <span class="hljs-comment">; 3</span><br><span class="hljs-symbol">dseg:</span>002B                 <span class="hljs-built_in">db</span>  <span class="hljs-number">30h</span> <span class="hljs-comment">; 0</span><br><span class="hljs-symbol">dseg:</span>002C                 <span class="hljs-built_in">db</span>  <span class="hljs-number">78h</span> <span class="hljs-comment">; x</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">002D</span>                 <span class="hljs-built_in">db</span>  <span class="hljs-number">66h</span> <span class="hljs-comment">; f</span><br><span class="hljs-symbol">dseg:</span>002E                 <span class="hljs-built_in">db</span>  <span class="hljs-number">40h</span> <span class="hljs-comment">; @</span><br><span class="hljs-symbol">dseg:</span>002F                 <span class="hljs-built_in">db</span>  <span class="hljs-number">35h</span> <span class="hljs-comment">; 5</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0030</span>                 <span class="hljs-built_in">db</span>  <span class="hljs-number">61h</span> <span class="hljs-comment">; a</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0031</span>                 <span class="hljs-built_in">db</span>  <span class="hljs-number">4Eh</span> <span class="hljs-comment">; N</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0032</span>                 <span class="hljs-built_in">db</span>  <span class="hljs-number">64h</span> <span class="hljs-comment">; d</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0033</span>                 <span class="hljs-built_in">db</span>  <span class="hljs-number">34h</span> <span class="hljs-comment">; 4</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0034</span>                 <span class="hljs-built_in">db</span>  <span class="hljs-number">65h</span> <span class="hljs-comment">; e</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0035</span>                 <span class="hljs-built_in">db</span>  <span class="hljs-number">32h</span> <span class="hljs-comment">; 2</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0036</span>                 <span class="hljs-built_in">db</span>  <span class="hljs-number">33h</span> <span class="hljs-comment">; 3</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0037</span>                 <span class="hljs-built_in">db</span>  <span class="hljs-number">88h</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0038</span>                 <span class="hljs-built_in">db</span>    <span class="hljs-number">0</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0039</span>                 <span class="hljs-built_in">db</span>    <span class="hljs-number">0</span><br><span class="hljs-symbol">dseg:</span>003A                 <span class="hljs-built_in">db</span>    <span class="hljs-number">0</span><br><span class="hljs-symbol">dseg:</span>003B                 <span class="hljs-built_in">db</span>    <span class="hljs-number">0</span><br><span class="hljs-symbol">dseg:</span>003C                 <span class="hljs-built_in">db</span>    <span class="hljs-number">0</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">003D</span>                 <span class="hljs-built_in">db</span>    <span class="hljs-number">0</span><br><span class="hljs-symbol">dseg:</span>003E                 <span class="hljs-built_in">db</span>    <span class="hljs-number">0</span><br><span class="hljs-symbol">dseg:</span>003F                 <span class="hljs-built_in">db</span>    <span class="hljs-number">0</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0040</span>                 <span class="hljs-built_in">db</span>    <span class="hljs-number">0</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0041</span>                 <span class="hljs-built_in">db</span>    <span class="hljs-number">0</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0042</span>                 <span class="hljs-built_in">db</span>    <span class="hljs-number">0</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0043</span>                 <span class="hljs-built_in">db</span>    <span class="hljs-number">0</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0044</span>                 <span class="hljs-built_in">db</span>    <span class="hljs-number">0</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0045</span>                 <span class="hljs-built_in">db</span>    <span class="hljs-number">0</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0046</span>                 <span class="hljs-built_in">db</span>    <span class="hljs-number">0</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0047</span>                 <span class="hljs-built_in">db</span>    <span class="hljs-number">0</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0048</span>                 <span class="hljs-built_in">db</span>    <span class="hljs-number">0</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0049</span>                 <span class="hljs-built_in">db</span>    <span class="hljs-number">0</span><br><span class="hljs-symbol">dseg:</span>004A                 <span class="hljs-built_in">db</span>    <span class="hljs-number">0</span><br><span class="hljs-symbol">dseg:</span>004B                 <span class="hljs-built_in">db</span>    <span class="hljs-number">0</span><br><span class="hljs-symbol">dseg:</span>004C                 <span class="hljs-built_in">db</span>    <span class="hljs-number">0</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">004D</span>                 <span class="hljs-built_in">db</span>    <span class="hljs-number">0</span><br><span class="hljs-symbol">dseg:</span>004E                 <span class="hljs-built_in">db</span>    <span class="hljs-number">0</span><br><span class="hljs-symbol">dseg:</span>004F                 <span class="hljs-built_in">db</span>    <span class="hljs-number">0</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0050</span>                 <span class="hljs-built_in">db</span>    <span class="hljs-number">0</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0051</span>                 <span class="hljs-built_in">db</span>    <span class="hljs-number">0</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0052</span>                 <span class="hljs-built_in">db</span>    <span class="hljs-number">0</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0053</span>                 <span class="hljs-built_in">db</span>    <span class="hljs-number">0</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0054</span>                 <span class="hljs-built_in">db</span>    <span class="hljs-number">0</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0055</span>                 <span class="hljs-built_in">db</span>    <span class="hljs-number">0</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0056</span>                 <span class="hljs-built_in">db</span>    <span class="hljs-number">0</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0057</span>                 <span class="hljs-built_in">db</span>    <span class="hljs-number">0</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0058</span>                 <span class="hljs-built_in">db</span>    <span class="hljs-number">0</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0059</span>                 <span class="hljs-built_in">db</span>    <span class="hljs-number">0</span><br><span class="hljs-symbol">dseg:</span>005A                 <span class="hljs-built_in">db</span>    <span class="hljs-number">0</span><br><span class="hljs-symbol">dseg:</span>005B                 <span class="hljs-built_in">db</span>    <span class="hljs-number">0</span><br><span class="hljs-symbol">dseg:</span>005C                 <span class="hljs-built_in">db</span>    <span class="hljs-number">0</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">005D</span>                 <span class="hljs-built_in">db</span>    <span class="hljs-number">0</span><br><span class="hljs-symbol">dseg:</span>005E                 <span class="hljs-built_in">db</span>    <span class="hljs-number">0</span><br><span class="hljs-symbol">dseg:</span>005F                 <span class="hljs-built_in">db</span>    <span class="hljs-number">0</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0060</span>                 <span class="hljs-built_in">db</span>    <span class="hljs-number">0</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0061</span>                 <span class="hljs-built_in">db</span>    <span class="hljs-number">0</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0062</span>                 <span class="hljs-built_in">db</span>    <span class="hljs-number">0</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0063</span>                 <span class="hljs-built_in">db</span>    <span class="hljs-number">0</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0064</span>                 <span class="hljs-built_in">db</span>    <span class="hljs-number">0</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0065</span>                 <span class="hljs-built_in">db</span>    <span class="hljs-number">0</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0066</span> byte_100A6      <span class="hljs-built_in">db</span> <span class="hljs-number">0</span>                    <span class="hljs-comment">; DATA XREF: start+31â†‘w</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0067</span>                 <span class="hljs-built_in">db</span>  <span class="hljs-number">66h</span> <span class="hljs-comment">; f</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0068</span>                 <span class="hljs-built_in">db</span>  <span class="hljs-number">6Ch</span> <span class="hljs-comment">; l</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">0069</span>                 <span class="hljs-built_in">db</span>  <span class="hljs-number">61h</span> <span class="hljs-comment">; a</span><br><span class="hljs-symbol">dseg:</span>006A                 <span class="hljs-built_in">db</span>  <span class="hljs-number">67h</span> <span class="hljs-comment">; g</span><br><span class="hljs-symbol">dseg:</span>006B                 <span class="hljs-built_in">db</span>  <span class="hljs-number">20h</span><br><span class="hljs-symbol">dseg:</span>006C                 <span class="hljs-built_in">db</span>  <span class="hljs-number">3Dh</span> <span class="hljs-comment">; =</span><br><span class="hljs-symbol">dseg:</span><span class="hljs-number">006D</span>                 <span class="hljs-built_in">db</span>  <span class="hljs-number">24h</span> <span class="hljs-comment">; $</span><br><span class="hljs-symbol">dseg:</span>006E                 <span class="hljs-built_in">db</span>    ? <span class="hljs-comment">;</span><br><span class="hljs-symbol">dseg:</span>006F                 <span class="hljs-built_in">db</span>    ? <span class="hljs-comment">;</span><br><span class="hljs-symbol">dseg:</span>006F dseg            ends<br><span class="hljs-symbol">dseg:</span>006F<br><span class="hljs-symbol">seg002:</span><span class="hljs-number">0000</span> <span class="hljs-comment">; ===========================================================================</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>å¯ä»¥çœ‹å‡ºç¨‹åºåˆ†ä¸¤éƒ¨åˆ†å¯¹flagçš„å¯†æ–‡è¿›è¡Œäº†è§£å¯†ï¼Œæ¨¡æ‹Ÿè¿™æ®µä»£ç å°±å¯ä»¥å¾—åˆ°flagã€‚è§£å¯†è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">data = [<br>    <span class="hljs-number">0x47</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x47</span>,<br>    <span class="hljs-number">0x73</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x6F</span>,<br>    <span class="hljs-number">0x46</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x37</span>,<br>    <span class="hljs-number">0x61</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x4E</span>,<br>    <span class="hljs-number">0x64</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x88</span><br>]<br><br>output = []<br><br><span class="hljs-comment"># ç¬¬ä¸€æ®µè§£å¯†ï¼ˆå‰ 0x17 å­—èŠ‚ï¼‰</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0x17</span>):<br>    al = data[i]<br>    al = (al - <span class="hljs-number">9</span>) &amp; <span class="hljs-number">0xFF</span><br>    al = al ^ <span class="hljs-number">0x0E</span><br>    output.append(al)<br><br><span class="hljs-comment"># ç¬¬äºŒæ®µè§£å¯†ï¼ˆå 0x17 å­—èŠ‚ï¼‰</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0x17</span>,<span class="hljs-number">0x2E</span>):<br>    al = data[i]<br>    al = al ^ <span class="hljs-number">0x0E</span><br>    al = (al - <span class="hljs-number">9</span>) &amp; <span class="hljs-number">0xFF</span><br>    output.append(al)<br><br><span class="hljs-comment"># è¾“å‡ºä¸ºå­—ç¬¦ä¸²</span><br>flag = <span class="hljs-string">&#x27;&#x27;</span>.join(<span class="hljs-built_in">chr</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> output)<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure></li>
</ul>
<h2 id="TELF"><a href="#TELF" class="headerlink" title="TELF"></a>TELF</h2><ul>
<li><p>é¢˜ç›®æç¤ºåŠ å£³ï¼ŒDIEæ£€æŸ¥å‘ç°é™„ä»¶ç¨‹åºåŠ äº†upxå£³ï¼š</p>
<p><img src="/../images/image-20251010194622670.png" alt="DIEæ£€æŸ¥"></p>
<p>è¿™æ˜¯ä¸ªelfæ–‡ä»¶ï¼Œè€ƒå¯Ÿelfæ‰‹åŠ¨è„±å£³çš„è¯éš¾åº¦ä¸å°ã€‚ä½¿ç”¨upxå·¥å…·ä¼šå‘ç°è„±ä¸äº†å£³ï¼Œæ¨æµ‹æœ‰upxç‰¹å¾é­”æ”¹ã€‚ç”¨010editoræ‰“å¼€é™„ä»¶ç¨‹åºï¼Œæ³¨æ„åˆ°å‡ºç°äº†å¯ç–‘å­—æ ·â€X1câ€ï¼š</p>
<p><img src="/../images/image-20251010195805683.png" alt="å¯ç–‘å­—æ ·"></p>
<p>ä¿®æ”¹â€X1câ€ä¸ºâ€UPXâ€åç¨‹åºå¯æ­£å¸¸å·¥å…·è„±å£³ï¼š</p>
<p><img src="/../images/image-20251010195916919.png" alt="å·¥å…·è„±å£³"></p>
<p>è„±å£³åçš„ç¨‹åºç”¨IDAæ‰“å¼€ï¼Œmainå‡½æ•°å¦‚ä¸‹ï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs C"><span class="hljs-type">int</span> __fastcall <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **argv, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **envp)</span><br>&#123;<br>  __int64 block; <span class="hljs-comment">// [rsp+8h] [rbp-A8h] BYREF</span><br>  _QWORD fl4g[<span class="hljs-number">8</span>]; <span class="hljs-comment">// [rsp+10h] [rbp-A0h] BYREF</span><br>  <span class="hljs-type">char</span> flag[<span class="hljs-number">8</span>]; <span class="hljs-comment">// [rsp+50h] [rbp-60h] BYREF</span><br>  __int64 v7; <span class="hljs-comment">// [rsp+58h] [rbp-58h]</span><br>  __int64 v8; <span class="hljs-comment">// [rsp+60h] [rbp-50h]</span><br>  __int64 v9; <span class="hljs-comment">// [rsp+68h] [rbp-48h]</span><br>  __int64 v10; <span class="hljs-comment">// [rsp+70h] [rbp-40h]</span><br>  __int64 v11; <span class="hljs-comment">// [rsp+78h] [rbp-38h]</span><br>  __int64 v12; <span class="hljs-comment">// [rsp+80h] [rbp-30h]</span><br>  _DWORD key[<span class="hljs-number">5</span>]; <span class="hljs-comment">// [rsp+90h] [rbp-20h] BYREF</span><br>  <span class="hljs-type">int</span> k; <span class="hljs-comment">// [rsp+A4h] [rbp-Ch]</span><br>  <span class="hljs-type">int</span> j; <span class="hljs-comment">// [rsp+A8h] [rbp-8h]</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [rsp+ACh] [rbp-4h]</span><br><br>  srand(<span class="hljs-number">0xF6950u</span>);<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">3</span>; ++i )<br>    key[i] = rand();<br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Please input your flag: &quot;</span>);<br>  <span class="hljs-keyword">if</span> ( __isoc99_scanf(<span class="hljs-string">&quot;%56s&quot;</span>, flag) == <span class="hljs-number">1</span> )<br>  &#123;<br>    <span class="hljs-keyword">if</span> ( <span class="hljs-built_in">strlen</span>(flag) == <span class="hljs-number">56</span> )<br>    &#123;<br>      fl4g[<span class="hljs-number">0</span>] = *flag;<br>      fl4g[<span class="hljs-number">1</span>] = v7;<br>      fl4g[<span class="hljs-number">2</span>] = v8;<br>      fl4g[<span class="hljs-number">3</span>] = v9;<br>      fl4g[<span class="hljs-number">4</span>] = v10;<br>      fl4g[<span class="hljs-number">5</span>] = v11;<br>      fl4g[<span class="hljs-number">6</span>] = v12;<br>      <span class="hljs-keyword">for</span> ( j = <span class="hljs-number">0</span>; j &lt;= <span class="hljs-number">55</span>; j += <span class="hljs-number">8</span> )<br>      &#123;<br>        block = fl4g[j / <span class="hljs-number">8u</span>];<br>        encrypt(&amp;block, key);<br>        fl4g[j / <span class="hljs-number">8u</span>] = block;<br>      &#125;<br>      <span class="hljs-keyword">for</span> ( k = <span class="hljs-number">0</span>; k &lt;= <span class="hljs-number">55</span>; ++k )<br>      &#123;<br>        <span class="hljs-keyword">if</span> ( enc[k] != *(fl4g + k) )<br>        &#123;<br>          <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Try Again!&quot;</span>);<br>          <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>        &#125;<br>      &#125;<br>      <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Congratulation!&quot;</span>);<br>      <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>      <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Length Error!&quot;</span>);<br>      <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    fwrite(<span class="hljs-string">&quot;Input error or EOF\n&quot;</span>, <span class="hljs-number">1uLL</span>, <span class="hljs-number">0x13u</span>LL, _bss_start);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹å‡ºç¨‹åºç”¨å…ˆéšæœºæ•°ç”Ÿæˆäº†keyï¼Œç„¶åå¯¹è¾“å…¥çš„flagè¿›è¡Œäº†åŠ å¯†ï¼Œæœ€åæ˜¯æ ¡éªŒã€‚åŠ å¯†å‡½æ•°å¦‚ä¸‹ï¼Œæ˜¯teaåŠ å¯†ï¼š</p>
<p><img src="/../images/image-20251010200059379.png" alt="encryptå‡½æ•°"></p>
<p>ä½†æ˜¯ç”¨ç›¸åŒç§å­ç”Ÿæˆçš„éšæœºæ•°ç»„æˆçš„keyä¼šè§£å¯†å¤±è´¥ï¼ŒåŠ¨è°ƒä¼šå‘ç°keyå’Œè‡ªå·±ä½¿ç”¨åŒä¸€ç§å­ç”Ÿæˆçš„keyä¸åŒï¼ˆIDAelfåŠ¨è°ƒæ•™ç¨‹è§<a href="https://www.52pojie.cn/thread-730499-1-1.html">idaåŠ¨æ€è°ƒè¯•elf(æ— å‘è¯¦ç»†)</a>ï¼‰ï¼š</p>
<p><img src="/../images/image-20251010201432090.png" alt="åŠ¨è°ƒæ—¶çš„key"></p>
<p>è¿™æ ·å°±èƒ½è§£å¯†äº†ã€‚teaåŠ å¯†çš„ä¸»è¦é€»è¾‘æ˜¯å¼‚æˆ–ï¼Œæ‰€ä»¥åªéœ€è¦è¿˜åŸå‡ºåŠ å¯†æ—¶çš„ç›¸å…³å˜é‡å°±å¯ä»¥äº†</p>
</li>
<li><p>è§£å¯†è„šæœ¬ï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs C"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><br><span class="hljs-type">void</span> <span class="hljs-title function_">decrypt</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span>* block, <span class="hljs-type">uint32_t</span>* key)</span> &#123;<br>    <span class="hljs-type">uint32_t</span> p1 = block[<span class="hljs-number">0</span>];<br>    <span class="hljs-type">uint32_t</span> p2 = block[<span class="hljs-number">1</span>];<br>    <span class="hljs-type">int</span> sum = <span class="hljs-number">0</span>;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; i++) &#123;<br>        sum -= <span class="hljs-number">0x61C88647</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; i++) &#123;<br>        p2 -= (p1 + sum) ^ (<span class="hljs-number">16</span> * p1 + key[<span class="hljs-number">2</span>]) ^ ((p1 &gt;&gt; <span class="hljs-number">5</span>) + key[<span class="hljs-number">3</span>]);<br>        p1 -= (p2 + sum) ^ (<span class="hljs-number">16</span> * p2 + key[<span class="hljs-number">0</span>]) ^ ((p2 &gt;&gt; <span class="hljs-number">5</span>) + key[<span class="hljs-number">1</span>]);<br>        sum += <span class="hljs-number">0x61C88647</span>;<br>    &#125;<br>    block[<span class="hljs-number">0</span>] = p1;<br>    block[<span class="hljs-number">1</span>] = p2;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">uint32_t</span> key[<span class="hljs-number">4</span>] = &#123; <span class="hljs-number">0x7e4d087b</span>, <span class="hljs-number">0x7a4db733</span>, <span class="hljs-number">0x70fe9df0</span>, <span class="hljs-number">0x595607f7</span> &#125;;<br>    <span class="hljs-type">uint32_t</span> enc[<span class="hljs-number">14</span>] = &#123;<br>        <span class="hljs-number">0xDC01DAAD</span>, <span class="hljs-number">0x088A5BAE</span>, <span class="hljs-number">0x8F4FF54E</span>, <span class="hljs-number">0x9E9D5F6E</span>,<br>        <span class="hljs-number">0x08A94E0A</span>, <span class="hljs-number">0xC245AB25</span>, <span class="hljs-number">0x438FC94B</span>, <span class="hljs-number">0x28D6513D</span>,<br>        <span class="hljs-number">0xF4CD72F6</span>, <span class="hljs-number">0x3B4AB42B</span>, <span class="hljs-number">0xEF6636FB</span>, <span class="hljs-number">0xB28C8AD6</span>,<br>        <span class="hljs-number">0x1B9C1AEB</span>, <span class="hljs-number">0x531F9C0A</span><br>    &#125;;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">14</span>; i += <span class="hljs-number">2</span>) &#123;<br>        decrypt(&amp;enc[i], key);<br>    &#125;<br><br>    <span class="hljs-type">char</span>* flagChar = (<span class="hljs-type">char</span>*)enc;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">56</span>; i++) &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, flagChar[i]);<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
]]></content>
      <categories>
        <category>WriteUp&amp;å¤ç°</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>WriteUp</tag>
        <tag>Reverse</tag>
      </tags>
  </entry>
  <entry>
    <title>19thCISCNåˆèµ›WriteUp</title>
    <url>/2025/12/28/19thCISCN%E5%88%9D%E8%B5%9BWriteUp&amp;%E5%A4%8D%E7%8E%B0/</url>
    <content><![CDATA[<p>ç¬¬ä¸€æ¬¡å‚åŠ å›½èµ›ï¼Œéš¾å“­äº†ğŸ˜­ğŸ˜­</p>
<span id="more"></span>

<h2 id="WriteUp"><a href="#WriteUp" class="headerlink" title="WriteUp"></a>WriteUp</h2><h3 id="babygame"><a href="#babygame" class="headerlink" title="babygame"></a>babygame</h3><blockquote>
<p>godoté€†å‘,AESç®—æ³•</p>
</blockquote>
<p>é™„ä»¶ç¨‹åºæ˜¯ä¸ªå°æ¸¸æˆã€‚æ‹–å…¥x64dbgåˆ†æï¼Œä¸€è·¯F9ï¼Œåœ¨å…¥å£ç‚¹é™„è¿‘å¯ä»¥çœ‹åˆ°Godot Engineå­—æ ·</p>
<p><img src="/../images/1766932387724-2.png" alt="å…¥å£ç‚¹é™„è¿‘æ‰¾åˆ°godot engineå­—æ ·"></p>
<p>ä¸Šç½‘æŸ¥æ‰¾ä¸€ä¸‹å¯ä»¥çŸ¥é“godotæ˜¯ä¸€ç§æ¸¸æˆå¼•æ“ï¼Œç±»ä¼¼unityï¼Œå¯ä»¥è§£åŒ…</p>
<p>ä½¿ç”¨<a href="https://github.com/GDRETools/gdsdecomp">GDRETools&#x2F;gdsdecomp</a>è§£æexeå¯ä»¥å¾—åˆ°ä¸€ä¸ªbabygameæ–‡ä»¶å¤¹ï¼Œæ–‡ä»¶å¤¹ä¸‹çš„scriptsç›®å½•æ‰“å¼€å¦‚ä¸‹</p>
<p><img src="/../images/1766932387724-1.png" alt="scriptsç›®å½•"></p>
<p>010editorå¯ä»¥æ‰“å¼€gdæ–‡ä»¶ç›´æ¥æŸ¥çœ‹ï¼Œå¦‚ä¸‹æ˜¯flag.gdï¼Œå‡ºç°äº†ä¸»è¦çš„æ£€éªŒé€»è¾‘ï¼ŒåŠ å¯†ä½¿ç”¨äº†AES_ECB</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs Java"><span class="hljs-keyword">extends</span> <span class="hljs-title class_">CenterContainer</span><br><br><span class="hljs-meta">@onready</span> <span class="hljs-keyword">var</span> flagTextEdit: Node = $PanelContainer / VBoxContainer / FlagTextEdit<br><span class="hljs-meta">@onready</span> <span class="hljs-keyword">var</span> label2: Node = $PanelContainer / VBoxContainer / Label2<br><br><span class="hljs-keyword">static</span> <span class="hljs-type">var</span> <span class="hljs-variable">key</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;FanAglFanAglOoO!&quot;</span><br><span class="hljs-type">var</span> <span class="hljs-variable">data</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&quot;</span><br><br>func <span class="hljs-title function_">_on_ready</span><span class="hljs-params">()</span> -&gt; <span class="hljs-keyword">void</span> :<br>    Flag.hide()<br><br>func <span class="hljs-title function_">get_key</span><span class="hljs-params">()</span> -&gt; String:<br>    <span class="hljs-keyword">return</span> key<br><br>func <span class="hljs-title function_">submit</span><span class="hljs-params">()</span> -&gt; <span class="hljs-keyword">void</span> :<br>    data = flagTextEdit.text<br><br>    <span class="hljs-type">var</span> <span class="hljs-variable">aes</span> <span class="hljs-operator">=</span> AESContext.new()<br>    aes.start(AESContext.MODE_ECB_ENCRYPT, key.to_utf8_buffer())<br>    <span class="hljs-type">var</span> <span class="hljs-variable">encrypted</span> <span class="hljs-operator">=</span> aes.update(data.to_utf8_buffer())<br>    aes.finish()<br><br>    <span class="hljs-keyword">if</span> encrypted.hex_encode() == <span class="hljs-string">&quot;d458af702a680ae4d089ce32fc39945d&quot;</span>:<br>        label2.show()<br>    <span class="hljs-keyword">else</span>:<br>        label2.hide()<br><br>func <span class="hljs-title function_">back</span><span class="hljs-params">()</span> -&gt; <span class="hljs-keyword">void</span> :<br>    get_tree().change_scene_to_file(<span class="hljs-string">&quot;res://scenes/menu.tscn&quot;</span>)<br><br><span class="hljs-keyword">extends</span> <span class="hljs-title class_">Node</span><br></code></pre></td></tr></table></figure>

<p>é¢˜ç›®æç¤ºéœ€è¦æ”¶é›†é‡‘å¸ï¼ˆå¾—åˆ†ï¼‰ï¼Œåœ¨game_manager.gdé‡Œå¯ä»¥å‘ç°å¾—åˆ†ä¼šä¿®æ”¹keyï¼ŒAä¼šè¢«æ›¿æ¢æˆB</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs Java"><span class="hljs-meta">@onready</span> <span class="hljs-type">var</span> <span class="hljs-variable">fan</span> <span class="hljs-operator">=</span> $<span class="hljs-string">&quot;../Fan&quot;</span><br><br><span class="hljs-type">var</span> <span class="hljs-variable">score</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span><br><br>func <span class="hljs-title function_">add_point</span><span class="hljs-params">()</span>:<br>    score += <span class="hljs-number">1</span><br>    <span class="hljs-keyword">if</span> score == <span class="hljs-number">1</span>:<br>        Flag.key = Flag.key.replace(<span class="hljs-string">&quot;A&quot;</span>, <span class="hljs-string">&quot;B&quot;</span>)<br>        fan.visible = <span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure>

<p>æ‰€ä»¥æŠŠkeyæ”¹ä¸€ä¸‹ï¼Œç„¶åä½¿ç”¨Cryptoåº“è§£å¯†å³å¯</p>
<p>Exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">import</span> binascii<br>enc=<span class="hljs-string">&quot;d458af702a680ae4d089ce32fc39945d&quot;</span><br>enc_bytes=binascii.unhexlify(enc)<br>key=<span class="hljs-string">b&quot;FanBglFanBglOoO!&quot;</span><br>cipher = AES.new(key, AES.MODE_ECB)<br>decrypted = cipher.decrypt(enc_bytes)<br><span class="hljs-built_in">print</span>(decrypted)    <br><span class="hljs-comment">#flag&#123;wOW~youAregrEaT!&#125;</span><br></code></pre></td></tr></table></figure>

<h2 id="å¤ç°"><a href="#å¤ç°" class="headerlink" title="å¤ç°"></a>å¤ç°</h2><h3 id="wasm-login"><a href="#wasm-login" class="headerlink" title="wasm-login"></a>wasm-login</h3><blockquote>
<p>js+wasmé€†å‘(æ²¡å­¦è¿‡jswebé€†å‘â•¥ï¹â•¥â€¦</p>
</blockquote>
<p>é™„ä»¶æ˜¯ä¸ªç½‘é¡µç™»å½•æ ¡éªŒé¡¹ç›®</p>
<p><img src="/../images/image-20260102143806427.png" alt="é™„ä»¶æ–‡ä»¶åˆ—è¡¨"></p>
<p>é¢˜ç›®æè¿°ï¼š</p>
<p><img src="/../images/image-20260102145448548.png" alt="é¢˜ç›®æè¿°"></p>
<p>åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ‰§è¡Œpython -m http.server 4000å¯ä»¥æŠŠé¡¹ç›®è·‘èµ·æ¥ï¼ˆå½“ç„¶ç›´æ¥çœ‹ä»£ç ä¹Ÿè¡Œï¼Œä½†æ˜¯å½“æ—¶æ²¡æ€è·¯ï¼Œäºæ˜¯å°±æ‰¾äº†ä¸ªåŠæ³•æŠŠé¡¹ç›®è·‘èµ·æ¥çœ‹çœ‹ï¼‰</p>
<p><img src="/../images/image-20260102144454944.png" alt="è¿è¡Œé¡¹ç›®"></p>
<p>index.htmlçš„scriptéƒ¨åˆ†å¦‚ä¸‹</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript">  &lt;script src=<span class="hljs-string">&quot;crypto-js.js&quot;</span>&gt;&lt;/script&gt;<br>  <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;build/release.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br>  <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;module&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="language-javascript"><span class="language-xml">     <span class="hljs-keyword">import</span> &#123; authenticate &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./build/release.js&quot;</span>;</span></span><br><span class="language-javascript"><span class="language-xml">    <span class="hljs-comment">// åˆå§‹åŒ– WASM æ¨¡å—</span></span></span><br><span class="language-javascript"><span class="language-xml">    <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">initWasm</span>(<span class="hljs-params"></span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">      <span class="hljs-keyword">const</span> wasmStatus = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;wasm-status&#x27;</span>);</span></span><br><span class="language-javascript"><span class="language-xml">      <span class="hljs-keyword">const</span> loginForm = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;login-form&#x27;</span>);</span></span><br><span class="language-javascript"><span class="language-xml">      <span class="hljs-keyword">const</span> loginBtn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;login-btn&#x27;</span>);</span></span><br><span class="language-javascript"><span class="language-xml">      <span class="hljs-keyword">const</span> loginSpinner = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;login-spinner&#x27;</span>);</span></span><br><span class="language-javascript"><span class="language-xml">      <span class="hljs-keyword">const</span> statusMessage = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;status-message&#x27;</span>);</span></span><br><span class="language-javascript"><span class="language-xml">      <span class="hljs-keyword">const</span> errorMessage = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;error-message&#x27;</span>);</span></span><br><span class="language-javascript"><span class="language-xml">      <span class="hljs-keyword">const</span> passwordInput = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;password&#x27;</span>);</span></span><br><span class="language-javascript"><span class="language-xml">      <span class="hljs-keyword">const</span> togglePasswordBtn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;toggle-password&#x27;</span>);</span></span><br><span class="language-javascript"><span class="language-xml">      </span></span><br><span class="language-javascript"><span class="language-xml">      <span class="hljs-keyword">try</span> &#123;</span></span><br><span class="language-javascript"><span class="language-xml"></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">// åˆå§‹åŒ–å®Œæˆ</span></span></span><br><span class="language-javascript"><span class="language-xml">        wasmStatus.<span class="hljs-property">textContent</span> = <span class="hljs-string">&#x27;WASM å·²åŠ è½½&#x27;</span>;</span></span><br><span class="language-javascript"><span class="language-xml">        wasmStatus.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">&#x27;text-success&#x27;</span>);</span></span><br><span class="language-javascript"><span class="language-xml">        </span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">// åˆ‡æ¢å¯†ç å¯è§æ€§</span></span></span><br><span class="language-javascript"><span class="language-xml">        togglePasswordBtn.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-keyword">const</span> type = passwordInput.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;type&#x27;</span>) === <span class="hljs-string">&#x27;password&#x27;</span> ? <span class="hljs-string">&#x27;text&#x27;</span> : <span class="hljs-string">&#x27;password&#x27;</span>;</span></span><br><span class="language-javascript"><span class="language-xml">          passwordInput.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">&#x27;type&#x27;</span>, type);</span></span><br><span class="language-javascript"><span class="language-xml">          </span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-keyword">const</span> icon = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;i&#x27;</span>);</span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-keyword">const</span> text = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;span&#x27;</span>);</span></span><br><span class="language-javascript"><span class="language-xml">          </span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-keyword">if</span> (type === <span class="hljs-string">&#x27;text&#x27;</span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            icon.<span class="hljs-property">classList</span>.<span class="hljs-title function_">remove</span>(<span class="hljs-string">&#x27;fa-eye-slash&#x27;</span>);</span></span><br><span class="language-javascript"><span class="language-xml">            icon.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">&#x27;fa-eye&#x27;</span>);</span></span><br><span class="language-javascript"><span class="language-xml">            text.<span class="hljs-property">textContent</span> = <span class="hljs-string">&#x27;éšè—&#x27;</span>;</span></span><br><span class="language-javascript"><span class="language-xml">          &#125; <span class="hljs-keyword">else</span> &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            icon.<span class="hljs-property">classList</span>.<span class="hljs-title function_">remove</span>(<span class="hljs-string">&#x27;fa-eye&#x27;</span>);</span></span><br><span class="language-javascript"><span class="language-xml">            icon.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">&#x27;fa-eye-slash&#x27;</span>);</span></span><br><span class="language-javascript"><span class="language-xml">            text.<span class="hljs-property">textContent</span> = <span class="hljs-string">&#x27;æ˜¾ç¤º&#x27;</span>;</span></span><br><span class="language-javascript"><span class="language-xml">          &#125;</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;);</span></span><br><span class="language-javascript"><span class="language-xml">        </span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">// ç™»å½•è¡¨å•æäº¤å¤„ç†</span></span></span><br><span class="language-javascript"><span class="language-xml">        loginForm.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;submit&#x27;</span>, <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">          e.<span class="hljs-title function_">preventDefault</span>();</span></span><br><span class="language-javascript"><span class="language-xml">          </span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-comment">// æ˜¾ç¤ºåŠ è½½çŠ¶æ€</span></span></span><br><span class="language-javascript"><span class="language-xml">          loginBtn.<span class="hljs-property">disabled</span> = <span class="hljs-literal">true</span>;</span></span><br><span class="language-javascript"><span class="language-xml">          loginSpinner.<span class="hljs-property">classList</span>.<span class="hljs-title function_">remove</span>(<span class="hljs-string">&#x27;hidden&#x27;</span>);</span></span><br><span class="language-javascript"><span class="language-xml">          statusMessage.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">&#x27;hidden&#x27;</span>);</span></span><br><span class="language-javascript"><span class="language-xml">          </span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-keyword">try</span> &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">const</span> username = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;username&#x27;</span>).<span class="hljs-property">value</span>;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">const</span> password = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;password&#x27;</span>).<span class="hljs-property">value</span>;</span></span><br><span class="language-javascript"><span class="language-xml">            </span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-comment">// è°ƒç”¨ WASM ä¸­çš„ authenticate å‡½æ•°</span></span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">const</span> authResult = <span class="hljs-title function_">authenticate</span>(username, password);</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">const</span> authData = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(authResult);</span></span><br><span class="language-javascript"><span class="language-xml">            </span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-comment">// æ¨¡æ‹Ÿå‘é€åˆ°æœåŠ¡å™¨</span></span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;å‘é€åˆ°æœåŠ¡å™¨çš„æ•°æ®:&#x27;</span>, authData);</span></span><br><span class="language-javascript"><span class="language-xml">            </span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-comment">// æ¨¡æ‹ŸæœåŠ¡å™¨å“åº”</span></span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-title function_">simulateServerRequest</span>(authData)</span></span><br><span class="language-javascript"><span class="language-xml">              .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> &#123;</span></span><br><span class="language-javascript"><span class="language-xml">                <span class="hljs-keyword">if</span> (response.<span class="hljs-property">success</span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">                  <span class="hljs-comment">// ç™»å½•æˆåŠŸ</span></span></span><br><span class="language-javascript"><span class="language-xml">                  <span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;ç™»å½•æˆåŠŸï¼&#x27;</span>);</span></span><br><span class="language-javascript"><span class="language-xml">                &#125; <span class="hljs-keyword">else</span> &#123;</span></span><br><span class="language-javascript"><span class="language-xml">                  <span class="hljs-comment">// ç™»å½•å¤±è´¥</span></span></span><br><span class="language-javascript"><span class="language-xml">                  <span class="hljs-title function_">showError</span>(response.<span class="hljs-property">message</span> || <span class="hljs-string">&#x27;ç™»å½•å¤±è´¥ï¼Œè¯·é‡è¯•&#x27;</span>);</span></span><br><span class="language-javascript"><span class="language-xml">                &#125;</span></span><br><span class="language-javascript"><span class="language-xml">              &#125;)</span></span><br><span class="language-javascript"><span class="language-xml">              .<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> &#123;</span></span><br><span class="language-javascript"><span class="language-xml">                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&#x27;ç™»å½•é”™è¯¯:&#x27;</span>, error);</span></span><br><span class="language-javascript"><span class="language-xml">                <span class="hljs-title function_">showError</span>(<span class="hljs-string">&#x27;ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åé‡è¯•&#x27;</span>);</span></span><br><span class="language-javascript"><span class="language-xml">              &#125;)</span></span><br><span class="language-javascript"><span class="language-xml">              .<span class="hljs-title function_">finally</span>(<span class="hljs-function">() =&gt;</span> &#123;</span></span><br><span class="language-javascript"><span class="language-xml">                <span class="hljs-comment">// æ¢å¤æŒ‰é’®çŠ¶æ€</span></span></span><br><span class="language-javascript"><span class="language-xml">                loginBtn.<span class="hljs-property">disabled</span> = <span class="hljs-literal">false</span>;</span></span><br><span class="language-javascript"><span class="language-xml">                loginSpinner.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">&#x27;hidden&#x27;</span>);</span></span><br><span class="language-javascript"><span class="language-xml">              &#125;);</span></span><br><span class="language-javascript"><span class="language-xml">            </span></span><br><span class="language-javascript"><span class="language-xml">          &#125; <span class="hljs-keyword">catch</span> (error) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&#x27;WASM å¤„ç†é”™è¯¯:&#x27;</span>, error);</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-title function_">showError</span>(<span class="hljs-string">&#x27;å†…éƒ¨é”™è¯¯ï¼Œè¯·è”ç³»ç®¡ç†å‘˜&#x27;</span>);</span></span><br><span class="language-javascript"><span class="language-xml">            </span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-comment">// æ¢å¤æŒ‰é’®çŠ¶æ€</span></span></span><br><span class="language-javascript"><span class="language-xml">            loginBtn.<span class="hljs-property">disabled</span> = <span class="hljs-literal">false</span>;</span></span><br><span class="language-javascript"><span class="language-xml">            loginSpinner.<span class="hljs-property">classList</span>.<span class="hljs-title function_">remove</span>(<span class="hljs-string">&#x27;hidden&#x27;</span>);</span></span><br><span class="language-javascript"><span class="language-xml">          &#125;</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;);</span></span><br><span class="language-javascript"><span class="language-xml">        </span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">// æ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯</span></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">showError</span>(<span class="hljs-params">message</span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">          errorMessage.<span class="hljs-property">textContent</span> = message;</span></span><br><span class="language-javascript"><span class="language-xml">          statusMessage.<span class="hljs-property">classList</span>.<span class="hljs-title function_">remove</span>(<span class="hljs-string">&#x27;hidden&#x27;</span>);</span></span><br><span class="language-javascript"><span class="language-xml">          </span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-comment">// æ·»åŠ åŠ¨ç”»æ•ˆæœ</span></span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-keyword">const</span> errorBox = statusMessage.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;div&#x27;</span>);</span></span><br><span class="language-javascript"><span class="language-xml">          errorBox.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">&#x27;animate-shake&#x27;</span>);</span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            errorBox.<span class="hljs-property">classList</span>.<span class="hljs-title function_">remove</span>(<span class="hljs-string">&#x27;animate-shake&#x27;</span>);</span></span><br><span class="language-javascript"><span class="language-xml">          &#125;, <span class="hljs-number">500</span>);</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;</span></span><br><span class="language-javascript"><span class="language-xml">        </span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">// æ¨¡æ‹ŸæœåŠ¡å™¨è¯·æ±‚</span></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">simulateServerRequest</span>(<span class="hljs-params">data</span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-comment">// æ¨¡æ‹Ÿç½‘ç»œå»¶è¿Ÿ</span></span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;</span></span><br><span class="language-javascript"><span class="language-xml">              <span class="hljs-comment">// å®é™…åº”ç”¨ä¸­è¿™é‡Œåº”è¯¥æ˜¯çœŸå®çš„ API è¯·æ±‚</span></span></span><br><span class="language-javascript"><span class="language-xml">              <span class="hljs-comment">// è¿™é‡Œä»…ä½œæ¼”ç¤ºï¼Œä½¿ç”¨æœ¬åœ°åˆ¤æ–­</span></span></span><br><span class="language-javascript"><span class="language-xml">              <span class="hljs-keyword">const</span> check = <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-title class_">MD5</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data)).<span class="hljs-title function_">toString</span>(<span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">enc</span>.<span class="hljs-property">Hex</span>);</span></span><br><span class="language-javascript"><span class="language-xml">              <span class="hljs-keyword">if</span> (check.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">&quot;ccaf33e3512e31f3&quot;</span>))&#123;</span></span><br><span class="language-javascript"><span class="language-xml">                <span class="hljs-title function_">resolve</span>(&#123; <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span> &#125;);</span></span><br><span class="language-javascript"><span class="language-xml">              &#125;<span class="hljs-keyword">else</span>&#123;</span></span><br><span class="language-javascript"><span class="language-xml">                <span class="hljs-title function_">resolve</span>(&#123; <span class="hljs-attr">success</span>: <span class="hljs-literal">false</span> &#125;);</span></span><br><span class="language-javascript"><span class="language-xml">              &#125;</span></span><br><span class="language-javascript"><span class="language-xml">            &#125;, <span class="hljs-number">1000</span>);</span></span><br><span class="language-javascript"><span class="language-xml">          &#125;);</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;</span></span><br><span class="language-javascript"><span class="language-xml">        </span></span><br><span class="language-javascript"><span class="language-xml">      &#125; <span class="hljs-keyword">catch</span> (error) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&#x27;WASM åŠ è½½å¤±è´¥:&#x27;</span>, error);</span></span><br><span class="language-javascript"><span class="language-xml">        wasmStatus.<span class="hljs-property">textContent</span> = <span class="hljs-string">&#x27;WASM åŠ è½½å¤±è´¥&#x27;</span>;</span></span><br><span class="language-javascript"><span class="language-xml">        wasmStatus.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">&#x27;text-danger&#x27;</span>);</span></span><br><span class="language-javascript"><span class="language-xml">        </span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">// ç¦ç”¨ç™»å½•æŒ‰é’®</span></span></span><br><span class="language-javascript"><span class="language-xml">        loginBtn.<span class="hljs-property">disabled</span> = <span class="hljs-literal">true</span>;</span></span><br><span class="language-javascript"><span class="language-xml">        loginBtn.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">&#x27;bg-neutral-400&#x27;</span>);</span></span><br><span class="language-javascript"><span class="language-xml">        loginBtn.<span class="hljs-property">classList</span>.<span class="hljs-title function_">remove</span>(<span class="hljs-string">&#x27;bg-primary&#x27;</span>, <span class="hljs-string">&#x27;hover:bg-primary/90&#x27;</span>);</span></span><br><span class="language-javascript"><span class="language-xml">      &#125;</span></span><br><span class="language-javascript"><span class="language-xml">    &#125;</span></span><br><span class="language-javascript"><span class="language-xml">    </span></span><br><span class="language-javascript"><span class="language-xml">    <span class="hljs-comment">// é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ– WASM</span></span></span><br><span class="language-javascript"><span class="language-xml">    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;load&#x27;</span>, initWasm);</span></span><br><span class="language-javascript"><span class="language-xml">  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br>&lt;/body&gt;<br>&lt;/html&gt;    <br><br>&lt;!-- æµ‹è¯•è´¦å· admin æµ‹è¯•å¯†ç  admin--&gt;<br></code></pre></td></tr></table></figure>

<p>å®¡é˜…ä»£ç å¯çŸ¥ï¼Œæ ¡éªŒé€»è¾‘åœ¨simulateServerRequest()é‡Œï¼Œä¸»è¦æ˜¯å¦‚ä¸‹å‡ è¡Œ</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> check = <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-title class_">MD5</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data)).<span class="hljs-title function_">toString</span>(<span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">enc</span>.<span class="hljs-property">Hex</span>);<br><span class="hljs-keyword">if</span> (check.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">&quot;ccaf33e3512e31f3&quot;</span>))&#123;<br>    <span class="hljs-title function_">resolve</span>(&#123; <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span> &#125;);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_">resolve</span>(&#123; <span class="hljs-attr">success</span>: <span class="hljs-literal">false</span> &#125;);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>dataæ˜¯ä¼ å…¥çš„å‚æ•°ï¼Œå®é™…å‚æ•°åº”è¯¥æ˜¯authDataï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// è°ƒç”¨ WASM ä¸­çš„ authenticate å‡½æ•°</span><br><span class="hljs-keyword">const</span> authResult = <span class="hljs-title function_">authenticate</span>(username, password);<br><span class="hljs-keyword">const</span> authData = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(authResult);<br><br><span class="hljs-comment">// æ¨¡æ‹ŸæœåŠ¡å™¨å“åº”</span><br><span class="hljs-title function_">simulateServerRequest</span>(authData).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> &#123;<br>	<span class="hljs-keyword">if</span> (response.<span class="hljs-property">success</span>) &#123;<br>		<span class="hljs-comment">// ç™»å½•æˆåŠŸ</span><br>		<span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;ç™»å½•æˆåŠŸï¼&#x27;</span>);<br>	&#125; <span class="hljs-keyword">else</span> &#123;<br>		<span class="hljs-comment">// ç™»å½•å¤±è´¥</span><br>		<span class="hljs-title function_">showError</span>(response.<span class="hljs-property">message</span> || <span class="hljs-string">&#x27;ç™»å½•å¤±è´¥ï¼Œè¯·é‡è¯•&#x27;</span>);<br>	&#125;<br>&#125;)<br></code></pre></td></tr></table></figure>

<p>æ‰€ä»¥æ ¡éªŒé€»è¾‘ä¸ºï¼šè°ƒç”¨wasmçš„authenticateå‡½æ•°ï¼Œè¿”å›å€¼æ±‚md5åä¸ç»™å®šçš„å“ˆå¸Œå€¼å¤´â€ccaf33e3512e31f3â€è¿›è¡Œæ¯”è¾ƒã€‚ç»“åˆé¢˜ç›®æè¿°ï¼Œauthenticateå‡½æ•°é™¤äº†ç”¨åˆ°index.htmlæœ«å°¾çš„æµ‹è¯•è´¦å¯†ï¼Œè¿˜å¯èƒ½ç”¨åˆ°äº†æ—¶é—´æˆ³ï¼Œæ„å‘³ç€éœ€è¦æ±‚å‡ºè¿™ä¸ªæ—¶é—´æˆ³è¿›è€Œæ±‚å‡ºå®Œæ•´å“ˆå¸Œå€¼ã€‚å¯ä»¥é€‰æ‹©çˆ†ç ´æ—¶é—´æˆ³ï¼Œä½†æ˜¯åœ¨æ­¤ä¹‹å‰è¿˜å¾—äº†è§£ä¸€ä¸‹æ—¶é—´æˆ³æ€ä¹ˆæ¥çš„</p>
<p>release.jsç”¨æ¥è¿æ¥wasmå’Œjsï¼Œåœ¨release.jsé‡Œå¯ä»¥çœ‹åˆ°ä¸€äº›wasmçš„ç¯å¢ƒé…ç½®ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> adaptedImports = &#123;<br>    <span class="hljs-attr">env</span>: <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">setPrototypeOf</span>(&#123;<br>      <span class="hljs-title function_">abort</span>(<span class="hljs-params">message, fileName, lineNumber, columnNumber</span>) &#123;<br>        <span class="hljs-comment">// ~lib/builtins/abort(~lib/string/String | null?, ~lib/string/String | null?, u32?, u32?) =&gt; void</span><br>        message = <span class="hljs-title function_">__liftString</span>(message &gt;&gt;&gt; <span class="hljs-number">0</span>);<br>        fileName = <span class="hljs-title function_">__liftString</span>(fileName &gt;&gt;&gt; <span class="hljs-number">0</span>);<br>        lineNumber = lineNumber &gt;&gt;&gt; <span class="hljs-number">0</span>;<br>        columnNumber = columnNumber &gt;&gt;&gt; <span class="hljs-number">0</span>;<br>        (<span class="hljs-function">() =&gt;</span> &#123;<br>          <span class="hljs-comment">// @external.js</span><br>          <span class="hljs-keyword">throw</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`<span class="hljs-subst">$&#123;message&#125;</span> in <span class="hljs-subst">$&#123;fileName&#125;</span>:<span class="hljs-subst">$&#123;lineNumber&#125;</span>:<span class="hljs-subst">$&#123;columnNumber&#125;</span>`</span>);<br>        &#125;)();<br>      &#125;,<br>      <span class="hljs-string">&quot;console.log&quot;</span>(text) &#123;<br>        <span class="hljs-comment">// ~lib/bindings/dom/console.log(~lib/string/String) =&gt; void</span><br>        text = <span class="hljs-title function_">__liftString</span>(text &gt;&gt;&gt; <span class="hljs-number">0</span>);<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(text);<br>      &#125;,<br>      <span class="hljs-string">&quot;Date.now&quot;</span>() &#123;<br>        <span class="hljs-comment">// ~lib/bindings/dom/Date.now() =&gt; f64</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();<br>      &#125;,<br>    &#125;, <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>(<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(globalThis), imports.<span class="hljs-property">env</span> || &#123;&#125;)),<br>  &#125;;<br></code></pre></td></tr></table></figure>

<p>æ­¤å¤„è®¾ç½®äº†ç¯å¢ƒé‡(ç¯å¢ƒå‡½æ•°ï¼Ÿ)Date.now()ï¼Œé€šè¿‡å·¥å…·<a href="https://github.com/WebAssembly/wabt/tree/main">wabt</a>ä¸‹çš„wasm2cè½¬åŒ–å‡ºwasmçš„cä»£ç ï¼Œä¹Ÿå¯ä»¥å‘ç°ç›¸å…³å†…å®¹</p>
<p><img src="/../images/image-20260102161051236.png" alt="cä»£ç ä¸­çš„date.now"></p>
<p>æ¥ä¸‹æ¥ï¼Œè¦æƒ³çˆ†ç ´æ—¶é—´æˆ³ï¼Œéœ€è¦èƒ½å¤Ÿè®¾ç½®authenticateå‡½æ•°ä½¿ç”¨çš„æ—¶é—´æˆ³ã€‚åœ¨wasmé‡Œéš¾ä»¥ä¿®æ”¹ç›¸å…³é€»è¾‘ï¼Œåªå¥½åœ¨release.jsä¸­ä¿®æ”¹Date.now()çš„å®šä¹‰ï¼Œä½¿å…¶åœ¨è¢«authenticateå‡½æ•°è°ƒç”¨çš„æ—¶å€™è¿”å›æˆ‘ä»¬æƒ³è¦çš„æ•°ã€‚è¿™é‡Œå¯ä»¥åˆ›å»ºä¸€ä¸ªå…¨å±€å˜é‡globalThis.mytimeï¼Œç„¶åä¿®æ”¹Date.now()çš„è¿”å›å€¼ä¸ºè¿™ä¸ªå…¨å±€å˜é‡ï¼Œè¿™æ ·å°±å¯ä»¥è®¾ç½®ä¸åŒçš„æ—¶é—´æˆ³æ¥è®©authenticateå‡½æ•°ä½¿ç”¨äº†ã€‚</p>
<p><img src="/../images/image-20260102162920935.png" alt="ä¿®æ”¹release.js"></p>
<p>æœ€åæŠ„ä¸€ä¸‹index.htmlé‡Œæ£€éªŒé€»è¾‘çš„jsä»£ç å°±å¯ä»¥å†™å‡ºhookè„šæœ¬ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> &#123; authenticate &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./build/release.js&quot;</span>;<span class="hljs-comment">// æ¨¡ä»¿index.htmlå¯¼å…¥authenticateå‡½æ•°ï¼Œåç»­ç›´æ¥è°ƒç”¨</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">CryptoJS</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;crypto-js&quot;</span>;<span class="hljs-comment">// index.htmlçš„æ£€éªŒé€»è¾‘ç”¨åˆ°äº†è¿™ä¸ªæ–‡ä»¶ï¼Œéœ€è¦å¯¼å…¥ï¼Œå¦åˆ™ç…§æŠ„ä¼šæŠ¥é”™</span><br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">hook</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-keyword">var</span> startTime=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">&quot;2025-12-21T22:40:00+08:00&quot;</span>).<span class="hljs-title function_">getTime</span>();<br>    <span class="hljs-keyword">var</span> endTime=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">&quot;2025-12-22T01:10:00+08:00&quot;</span>).<span class="hljs-title function_">getTime</span>();<br>    <span class="hljs-comment">// è¿™é‡Œçš„æ—¶é—´èŒƒå›´æ˜¯é€šè¿‡æ–‡ä»¶ä¿®æ”¹æ—¶é—´æ¨æµ‹å‡ºæ¥çš„ï¼ˆçœ‹å…¶ä»–å¸ˆå‚…çš„wpæ‰getåˆ°è¿™ç‚¹ï¼Œå¤ªç»†äº†ï¼‰</span><br>    <span class="hljs-keyword">const</span> username = <span class="hljs-string">&quot;admin&quot;</span>;<br>    <span class="hljs-keyword">const</span> password = <span class="hljs-string">&quot;admin&quot;</span>;<br><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Start brute forcing...&quot;</span>);<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i=startTime;i&lt;=endTime;i+=<span class="hljs-number">1</span>)&#123;<br>        globalThis.<span class="hljs-property">mytime</span> = i;<br>        <span class="hljs-comment">// ä¸‹é¢å‡ è¡Œç›´æ¥æŠ„åŸä»£ç å³å¯</span><br>        <span class="hljs-comment">// è°ƒç”¨ WASM ä¸­çš„ authenticate å‡½æ•°</span><br>        <span class="hljs-keyword">const</span> authResult = <span class="hljs-title function_">authenticate</span>(username, password);<br>        <span class="hljs-keyword">const</span> authData = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(authResult);<br>        <span class="hljs-keyword">var</span> check = <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-title class_">MD5</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(authData)).<span class="hljs-title function_">toString</span>(<span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">enc</span>.<span class="hljs-property">Hex</span>);<br>        <span class="hljs-keyword">if</span>(check.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">&quot;ccaf33e3512e31f3&quot;</span>))&#123;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;found hash:&quot;</span>,check);<span class="hljs-comment">// è¿”å›æ“ä½œæ”¹æˆè¾“å‡ºhash</span><br>        &#125;<br>    &#125;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Brute forcing completed.&quot;</span>);<br>&#125;<br><br><span class="hljs-title function_">hook</span>();<br><span class="hljs-comment">// Start brute forcing...</span><br><span class="hljs-comment">// found hash: ccaf33e3512e31f36228f0b97ccbc8f1</span><br><span class="hljs-comment">// Brute forcing completed.</span><br></code></pre></td></tr></table></figure>

<h3 id="eternum"><a href="#eternum" class="headerlink" title="eternum"></a>eternum</h3><blockquote>
<p>goé€†å‘ï¼Œå¾…æ›´æ–°â€¦</p>
</blockquote>
<h3 id="vvvmmm"><a href="#vvvmmm" class="headerlink" title="vvvmmm"></a>vvvmmm</h3><blockquote>
<p>vmé€†å‘ï¼Œå¾…æ›´æ–°â€¦</p>
</blockquote>
]]></content>
      <categories>
        <category>WriteUp&amp;å¤ç°</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>WriteUp</tag>
        <tag>Reverse</tag>
        <tag>å¤ç°</tag>
      </tags>
  </entry>
  <entry>
    <title>Day12:åè°ƒè¯•ï¼ˆä¸€ï¼‰</title>
    <url>/2025/08/02/Day12-%E5%8F%8D%E8%B0%83%E8%AF%95/</url>
    <content><![CDATA[<p>åè°ƒè¯•åŸºæœ¬åŸç†ã€WINAPIæ£€æµ‹ã€æ•°æ®æ£€æµ‹ã€è¿›ç¨‹æ£€æµ‹</p>
<span id="more"></span>

<h2 id="åè°ƒè¯•åŸºæœ¬åŸç†"><a href="#åè°ƒè¯•åŸºæœ¬åŸç†" class="headerlink" title="åè°ƒè¯•åŸºæœ¬åŸç†"></a>åè°ƒè¯•åŸºæœ¬åŸç†</h2><ul>
<li>åè°ƒè¯•æŠ€æœ¯é€šå¸¸å€ŸåŠ©æ“ä½œç³»ç»Ÿç›¸å…³çš„å†…å®¹æ¥å®ç°ï¼Œå¸¸è§åŠæ³•æœ‰è°ƒç”¨WindowsAPIè·å¾—ç›¸å…³æ•°æ®ã€æœ‰æ„è§¦å‘å¼‚å¸¸ç›‘æµ‹å¼‚å¸¸å¤„ç†ï¼ˆè°ƒè¯•å™¨ä¼šæ•è·å¼‚å¸¸ï¼‰ã€æ—¶é—´å·®æ£€æµ‹ï¼ˆå®é™…è¿è¡Œè¿‡ç¨‹ååˆ†è¿…é€Ÿï¼‰ã€ç¡¬ä»¶æ–­ç‚¹æ£€æµ‹ã€è¿›ç¨‹æ£€æµ‹ç­‰</li>
</ul>
<h2 id="WINAPIæ£€æµ‹"><a href="#WINAPIæ£€æµ‹" class="headerlink" title="WINAPIæ£€æµ‹"></a>WINAPIæ£€æµ‹</h2><ul>
<li>ç”±äºæ˜¯ç›´æ¥ä½¿ç”¨WINAPIï¼Œæ‰€ä»¥ä¸€èˆ¬åœ¨IDAæˆ–è€…åŠ¨æ€è°ƒè¯•å™¨é‡Œä¼šæœ‰æ˜æ˜¾çš„å‡½æ•°åå­—æ ·ï¼Œè¯†åˆ«ä¼šæ¯”è¾ƒå®¹æ˜“</li>
<li>æ­¤ç±»ä¸€èˆ¬æ˜¯åˆ©ç”¨å‡½æ•°çš„è¿”å›å€¼æˆ–è€…å‡½æ•°ä¼ é€’å›æ¥çš„å‚æ•°ä½œä¸ºåˆ¤æ–­æ ‡å‡†ï¼Œåº”å¯¹æ–¹æ³•ä¸»è¦æœ‰ä½¿ç”¨ååè°ƒè¯•æ’ä»¶ã€ä¿®æ”¹ç›¸å…³å€¼ã€hookç­‰</li>
</ul>
<h3 id="IsDebuggerPresent"><a href="#IsDebuggerPresent" class="headerlink" title="IsDebuggerPresent"></a>IsDebuggerPresent</h3><ul>
<li><p>åŸç†ï¼š</p>
<p>IsDebuggerPresent() å®é™…ä¸Šæ˜¯é€šè¿‡è®¿é—®PEBï¼ˆProcessEnvironmentBlockï¼Œè¿›ç¨‹ç¯å¢ƒå—ï¼Œä¸€ä¸ªæè¿°è¿›ç¨‹ç›¸å…³æ•°æ®çš„ç»“æ„ä½“ï¼‰ä¸­çš„BeingDebuggedæ ‡å¿—æ¥åˆ¤æ–­æ˜¯å¦è¢«è°ƒè¯•çš„ï¼Œè¢«è°ƒè¯•çš„è¯ï¼Œå‡½æ•°è¿”å›1ã€‚æœ‰å…³BeingDebuggedçš„å†…å®¹ï¼Œè§ä¸‹æ–‡ã€‚</p>
</li>
<li><p>IDAå’ŒXDbgçš„æ•ˆæœå›¾ï¼š</p>
<p><img src="/../images/image-20250802131116428.png" alt="IDAæ•ˆæœå›¾"></p>
<p><img src="/../images/image-20250802131150198.png" alt="XDbgæ•ˆæœå›¾"></p>
<p>å¯ä»¥çœ‹åˆ°æ˜æ˜¾çš„IsDebuggerPresentå­—æ ·ã€‚</p>
</li>
<li><p>åº”å¯¹æ–¹æ³•ï¼š</p>
<p>åœ¨XDbgä¸­å¼€å¯scyllahideæ’ä»¶æˆ–è€…åœ¨TEST EAX,EAXåæ”¹å˜ä¸€ä¸‹ZFå°±å¯ä»¥äº†</p>
</li>
</ul>
<h3 id="CheckRemoteDebuggerPresent"><a href="#CheckRemoteDebuggerPresent" class="headerlink" title="CheckRemoteDebuggerPresent"></a>CheckRemoteDebuggerPresent</h3><ul>
<li><p>åŸç†ï¼š</p>
<p>å‡½æ•°åŸå‹ï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c">BOOL WINAPI <span class="hljs-title function_">CheckRemoteDebuggerPresent</span><span class="hljs-params">(</span><br><span class="hljs-params">	In		HANDLE hProcess,<span class="hljs-comment">//å‚æ•°1ï¼Œä¸€ä¸ªè¿›ç¨‹å¥æŸ„ï¼Œä¼ å…¥å½“å‰è¿›ç¨‹å¥æŸ„å°±æ˜¯checklocaläº†</span></span><br><span class="hljs-params">	Inout	PBOOL pbDebuggerPresent<span class="hljs-comment">//å‚æ•°2ï¼Œä¸€ä¸ªç”¨æ¥ä¼ é€’çš„å¸ƒå°”å€¼ï¼Œç”¨æ¥è¡¨ç¤ºæ˜¯å¦è¢«è°ƒè¯•</span></span><br><span class="hljs-params">)</span>;<br></code></pre></td></tr></table></figure>

<p>è¿™ä¸ªå‡½æ•°å®é™…ä¸Šæ˜¯å€Ÿç”¨äº†NtQueryInfomationProcesså‡½æ•°æ¥å®ç°è°ƒè¯•æ£€æµ‹çš„ï¼Œç®€å•è®²å°±æ˜¯é€šè¿‡NtQueryInformationProcessæŸ¥è¯¢ä¸€ä¸ªæ•°æ®ç„¶åå’Œéè°ƒè¯•çŠ¶æ€ä¸‹è¿™ä¸ªæ•°æ®é¢„æœŸçš„å€¼è¿›è¡Œæ¯”è¾ƒï¼Œæ¯”è¾ƒç»“æœå†ä¼ ç»™è‡ªå·±çš„å‚æ•°2ã€‚æ›´è¯¦ç»†çš„åŸç†è§ä¸‹ä¸€ä¸ªAPI</p>
</li>
<li><p>æ•ˆæœå›¾ï¼š</p>
<p><img src="/../images/image-20250802151411075.png" alt="IDAæ•ˆæœå›¾"></p>
<p><img src="/../images/image-20250802151613861.png" alt="xdbgæ•ˆæœ"></p>
</li>
<li><p>åº”å¯¹æ–¹æ³•ï¼š</p>
<p>scyllahideä¾æ—§ç®¡ç”¨ï¼Œä¹Ÿå¯ä»¥åœ¨call CheckRemoteDebuggerPresentä¸‹é¢çš„cmpåæ”¹å˜zfæ¥å®ç°ååè°ƒè¯•</p>
</li>
</ul>
<h3 id="NtQueryInformationProcess"><a href="#NtQueryInformationProcess" class="headerlink" title="NtQueryInformationProcess"></a>NtQueryInformationProcess</h3><ul>
<li><p>åŸç†ï¼š</p>
<p>å‡½æ•°åŸå‹ï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c">__kernel_entry NTSTATUS <span class="hljs-title function_">NtQueryInformationProcess</span><span class="hljs-params">(</span><br><span class="hljs-params">    IN HANDLE           ProcessHandle,<span class="hljs-comment">//è¦æŸ¥è¯¢çš„è¿›ç¨‹å¥æŸ„</span></span><br><span class="hljs-params">    IN PROCESSINFOCLASS ProcessInformationClass,<span class="hljs-comment">//è¦æŸ¥è¯¢çš„ä¿¡æ¯ç±»å‹</span></span><br><span class="hljs-params">    OUT PVOID           ProcessInformation,<span class="hljs-comment">//æ¥æ”¶æŸ¥è¯¢ç»“æœçš„ç¼“å†²åŒºï¼ˆå˜é‡ï¼‰</span></span><br><span class="hljs-params">    IN ULONG            ProcessInformationLength,<span class="hljs-comment">//ç¼“å†²åŒºå¤§å°</span></span><br><span class="hljs-params">    OUT PULONG          ReturnLength OPTIONAL<span class="hljs-comment">//å®é™…è¿”å›çš„æ•°æ®å¤§å°ï¼Œå¯é€‰</span></span><br><span class="hljs-params">)</span>;<br></code></pre></td></tr></table></figure>

<p>é€šè¿‡è®¾ç½®ç¬¬äºŒä¸ªå‚æ•°ä¸º0x7ï¼ˆè¡¨ç¤ºæŸ¥è¯¢ä¸€ä¸ªå«ProcessDebugPortçš„å˜é‡ï¼‰ï¼Œå‡½æ•°ä¼šé€šè¿‡ç¬¬ä¸‰ä¸ªå‚æ•°ä¼ é€’è°ƒè¯•ä¿¡æ¯ï¼Œè¢«è°ƒè¯•åˆ™ä¼ é€’<strong>é</strong>0</p>
<p>æˆ–è€…è®¾ç½®ç¬¬äºŒä¸ªå‚æ•°ä¸º0x1Eï¼ˆè¡¨ç¤ºæŸ¥è¯¢ä¸€ä¸ªå«ProcessDebugObjectHandleçš„å˜é‡ï¼‰ï¼Œè¢«è°ƒè¯•åˆ™ä¼ é€’<strong>é</strong>NULL</p>
<p>æˆ–è€…è®¾ç½®ç¬¬äºŒä¸ªå‚æ•°ä¸º0x1Fï¼ˆè¡¨ç¤ºæŸ¥è¯¢ä¸€ä¸ªå«ProcessDebugFlagsçš„å˜é‡ï¼‰ï¼Œè¢«è°ƒè¯•åˆ™ä¼ é€’0</p>
<p>åŸå‹æ˜¯è¿™æ ·ï¼Œä½†æ˜¯è¿™ä¸ªå‡½æ•°æ˜¯Windowså†…éƒ¨APIï¼Œå³ç³»ç»Ÿä¸æƒ³ç”¨æˆ·ä½¿ç”¨è¿™ä¸ªå‡½æ•°ï¼ˆå¯èƒ½æ˜¯å‡ºäºå®‰å…¨è€ƒè™‘ï¼‰ï¼Œæ‰€ä»¥ç›´æ¥è°ƒç”¨æ˜¯ä¸è¡Œçš„ï¼Œè¦åŠ¨æ€åŠ è½½ã€‚ä¸‹é¢æ˜¯DSç»™çš„å®ç°æºç å‚è€ƒï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs C"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;windows.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><br><span class="hljs-comment">// 1. å®šä¹‰å‡½æ•°æŒ‡é’ˆç±»å‹ï¼ˆå¿…é¡»æ‰‹åŠ¨å£°æ˜ï¼‰</span><br><span class="hljs-keyword">typedef</span> LONG NTSTATUS;<br><span class="hljs-keyword">typedef</span> <span class="hljs-title function_">NTSTATUS</span> <span class="hljs-params">(NTAPI* PNtQueryInformationProcess)</span><span class="hljs-params">(</span><br><span class="hljs-params">    HANDLE ProcessHandle,</span><br><span class="hljs-params">    <span class="hljs-type">int</span> ProcessInformationClass,  <span class="hljs-comment">// ç›´æ¥ä½¿ç”¨ int ä»£æ›¿ PROCESSINFOCLASS</span></span><br><span class="hljs-params">    PVOID ProcessInformation,</span><br><span class="hljs-params">    ULONG ProcessInformationLength,</span><br><span class="hljs-params">    PULONG ReturnLength</span><br><span class="hljs-params">)</span>;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-comment">// 2. åŠ¨æ€åŠ è½½ ntdll.dll</span><br>    HMODULE hNtdll = GetModuleHandleW(<span class="hljs-string">L&quot;ntdll.dll&quot;</span>);<br>    <span class="hljs-keyword">if</span> (!hNtdll) &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;hello\n&quot;</span>);<br>        system(<span class="hljs-string">&quot;pause&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-comment">// 3. è·å– NtQueryInformationProcess å‡½æ•°åœ°å€</span><br>    PNtQueryInformationProcess NtQueryInformationProcess = <br>        (PNtQueryInformationProcess)GetProcAddress(hNtdll, <span class="hljs-string">&quot;NtQueryInformationProcess&quot;</span>);<br>    <span class="hljs-keyword">if</span> (!NtQueryInformationProcess) &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;hello\n&quot;</span>);<br>        system(<span class="hljs-string">&quot;pause&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-comment">// 4. è°ƒç”¨å‡½æ•°æŸ¥è¯¢è°ƒè¯•ç«¯å£ï¼ˆ0x7 = ProcessDebugPortï¼‰</span><br>    DWORD debugPort = <span class="hljs-number">0</span>;<br>    NTSTATUS status = NtQueryInformationProcess(<br>        GetCurrentProcess(),<br>        <span class="hljs-number">0x7</span>,  <span class="hljs-comment">// ProcessDebugPort</span><br>        &amp;debugPort,<br>        <span class="hljs-keyword">sizeof</span>(debugPort),<br>        <span class="hljs-literal">NULL</span><br>    );<br><br>    <span class="hljs-comment">// 5. ä¸¥æ ¼æŒ‰ç…§ä½ çš„é€»è¾‘è¾“å‡º</span><br>    <span class="hljs-keyword">if</span> (debugPort)<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;bye\n&quot;</span>);<br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;hello\n&quot;</span>);<br><br>    system(<span class="hljs-string">&quot;pause&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>ä¸‹é¢æ˜¯IDAçš„åæ±‡ç¼–ç»“æœ</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm"><span class="hljs-symbol">.text:</span>000000014007E130 sub_14007E130   proc <span class="hljs-built_in">near</span>               <span class="hljs-comment">; CODE XREF: sub_14007920Bâ†‘j</span><br><span class="hljs-symbol">.text:</span>000000014007E130                                         <span class="hljs-comment">; DATA XREF: .pdata:00000001401AB818â†“o</span><br><span class="hljs-symbol">.text:</span>000000014007E130<br><span class="hljs-symbol">.text:</span>000000014007E130 var_180         = <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">180h</span><br><span class="hljs-symbol">.text:</span>000000014007E130 var_160         = <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">160h</span><br><span class="hljs-symbol">.text:</span>000000014007E130 var_150         = <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">150h</span><br><span class="hljs-symbol">.text:</span>000000014007E130 hModule         = <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">148h</span><br><span class="hljs-symbol">.text:</span>000000014007E130 var_128         = <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">128h</span><br><span class="hljs-symbol">.text:</span>000000014007E130 var_10C         = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">10Ch</span><br><span class="hljs-symbol">.text:</span>000000014007E130 var_EC          = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">0ECh</span><br><span class="hljs-symbol">.text:</span>000000014007E130 var_18          = <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">18h</span><br><span class="hljs-symbol">.text:</span>000000014007E130<br><span class="hljs-symbol">.text:</span>000000014007E130 <span class="hljs-comment">; __unwind &#123; // j___GSHandlerCheck</span><br><span class="hljs-symbol">.text:</span>000000014007E130                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">rbp</span><br><span class="hljs-symbol">.text:</span>000000014007E132                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">rdi</span><br><span class="hljs-symbol">.text:</span>000000014007E133                 <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">rsp</span>, <span class="hljs-number">178h</span><br><span class="hljs-symbol">.text:</span>000000014007E13A                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rbp</span>, [<span class="hljs-built_in">rsp</span>+<span class="hljs-number">30h</span>]<br><span class="hljs-symbol">.text:</span>000000014007E13F                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rdi</span>, [<span class="hljs-built_in">rsp</span>+<span class="hljs-number">180h</span>+var_150]<br><span class="hljs-symbol">.text:</span>000000014007E144                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-number">22h</span> <span class="hljs-comment">; &#x27;&quot;&#x27;</span><br><span class="hljs-symbol">.text:</span>000000014007E149                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">0CCCCCCCCh</span><br><span class="hljs-symbol">.text:</span>000000014007E14E                 <span class="hljs-keyword">rep</span> <span class="hljs-keyword">stosd</span><br><span class="hljs-symbol">.text:</span>000000014007E150                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">cs</span>:__security_cookie<br><span class="hljs-symbol">.text:</span>000000014007E157                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">rbp</span><br><span class="hljs-symbol">.text:</span>000000014007E15A                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">rbp</span>+<span class="hljs-number">150h</span>+var_18], <span class="hljs-built_in">rax</span><br><span class="hljs-symbol">.text:</span>000000014007E161                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rcx</span>, unk_1401B80A2<br><span class="hljs-symbol">.text:</span>000000014007E168                 <span class="hljs-keyword">call</span>    sub_14007A313<br><span class="hljs-symbol">.text:</span>000000014007E16D                 <span class="hljs-keyword">nop</span><br><span class="hljs-symbol">.text:</span>000000014007E16E                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rcx</span>, ModuleName <span class="hljs-comment">; &quot;ntdll.dll&quot;</span><br><span class="hljs-symbol">.text:</span>000000014007E175                 <span class="hljs-keyword">call</span>    <span class="hljs-built_in">cs</span>:GetModuleHandleW	<span class="hljs-comment">;æ­¤å¤„åŠ è½½ntdllåº“</span><br><span class="hljs-symbol">.text:</span>000000014007E17B                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">rbp</span>+<span class="hljs-number">150h</span>+hModule], <span class="hljs-built_in">rax</span><br><span class="hljs-symbol">.text:</span>000000014007E17F                 <span class="hljs-keyword">cmp</span>     [<span class="hljs-built_in">rbp</span>+<span class="hljs-number">150h</span>+hModule], <span class="hljs-number">0</span><br><span class="hljs-symbol">.text:</span>000000014007E184                 <span class="hljs-keyword">jnz</span>     short loc_14007E1A7<br><span class="hljs-symbol">.text:</span>000000014007E186                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rcx</span>, aHello     <span class="hljs-comment">; &quot;hello\n&quot;</span><br><span class="hljs-symbol">.text:</span>000000014007E18D                 <span class="hljs-keyword">call</span>    sub_14007886F<br><span class="hljs-symbol">.text:</span>000000014007E192                 <span class="hljs-keyword">nop</span><br><span class="hljs-symbol">.text:</span>000000014007E193                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rcx</span>, aPause     <span class="hljs-comment">; &quot;pause&quot;</span><br><span class="hljs-symbol">.text:</span>000000014007E19A                 <span class="hljs-keyword">call</span>    sub_140078810<br><span class="hljs-symbol">.text:</span>000000014007E19F                 <span class="hljs-keyword">nop</span><br><span class="hljs-symbol">.text:</span>000000014007E1A0                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>000000014007E1A2                 <span class="hljs-keyword">jmp</span>     loc_14007E240<br><span class="hljs-symbol">.text:</span>000000014007E1A7 <span class="hljs-comment">; ---------------------------------------------------------------------------</span><br><span class="hljs-symbol">.text:</span>000000014007E1A7<br><span class="hljs-symbol">.text:</span>000000014007E1A7 loc_14007E1A7:                          <span class="hljs-comment">; CODE XREF: sub_14007E130+54â†‘j</span><br><span class="hljs-symbol">.text:</span>000000014007E1A7                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rdx</span>, ProcName   <span class="hljs-comment">; &quot;NtQueryInformationProcess&quot;</span><br><span class="hljs-symbol">.text:</span>000000014007E1AE                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rcx</span>, [<span class="hljs-built_in">rbp</span>+<span class="hljs-number">150h</span>+hModule] <span class="hljs-comment">; hModule</span><br><span class="hljs-symbol">.text:</span>000000014007E1B2                 <span class="hljs-keyword">call</span>    <span class="hljs-built_in">cs</span>:GetProcAddress	<span class="hljs-comment">;æ­¤å¤„è·å–NtQueryInformationProcesså‡½æ•°åœ°å€</span><br><span class="hljs-symbol">.text:</span>000000014007E1B8                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">rbp</span>+<span class="hljs-number">150h</span>+var_128], <span class="hljs-built_in">rax</span>	<span class="hljs-comment">;æ­¤å¤„æŠŠå‡½æ•°åœ°å€ä¼ ç»™å±€éƒ¨å˜é‡</span><br><span class="hljs-symbol">.text:</span>000000014007E1BC                 <span class="hljs-keyword">cmp</span>     [<span class="hljs-built_in">rbp</span>+<span class="hljs-number">150h</span>+var_128], <span class="hljs-number">0</span><br><span class="hljs-symbol">.text:</span>000000014007E1C1                 <span class="hljs-keyword">jnz</span>     short loc_14007E1E1<br><span class="hljs-symbol">.text:</span>000000014007E1C3                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rcx</span>, aHello     <span class="hljs-comment">; &quot;hello\n&quot;</span><br><span class="hljs-symbol">.text:</span>000000014007E1CA                 <span class="hljs-keyword">call</span>    sub_14007886F<br><span class="hljs-symbol">.text:</span>000000014007E1CF                 <span class="hljs-keyword">nop</span><br><span class="hljs-symbol">.text:</span>000000014007E1D0                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rcx</span>, aPause     <span class="hljs-comment">; &quot;pause&quot;</span><br><span class="hljs-symbol">.text:</span>000000014007E1D7                 <span class="hljs-keyword">call</span>    sub_140078810<br><span class="hljs-symbol">.text:</span>000000014007E1DC                 <span class="hljs-keyword">nop</span><br><span class="hljs-symbol">.text:</span>000000014007E1DD                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>000000014007E1DF                 <span class="hljs-keyword">jmp</span>     short loc_14007E240<br><span class="hljs-symbol">.text:</span>000000014007E1E1 <span class="hljs-comment">; ---------------------------------------------------------------------------</span><br><span class="hljs-symbol">.text:</span>000000014007E1E1<br><span class="hljs-symbol">.text:</span>000000014007E1E1 loc_14007E1E1:                          <span class="hljs-comment">; CODE XREF: sub_14007E130+91â†‘j</span><br><span class="hljs-symbol">.text:</span>000000014007E1E1                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">rbp</span>+<span class="hljs-number">150h</span>+var_10C], <span class="hljs-number">0</span><br><span class="hljs-symbol">.text:</span>000000014007E1E8                 <span class="hljs-keyword">call</span>    <span class="hljs-built_in">cs</span>:GetCurrentProcess	<br><span class="hljs-symbol">.text:</span>000000014007E1EE                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">rsp</span>+<span class="hljs-number">180h</span>+var_160], <span class="hljs-number">0</span><br><span class="hljs-symbol">.text:</span>000000014007E1F7                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">r9d</span>, <span class="hljs-number">4</span>	<span class="hljs-comment">;ç¼“å†²åŒºå¤§å°</span><br><span class="hljs-symbol">.text:</span>000000014007E1FD                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">r8</span>, [<span class="hljs-built_in">rbp</span>+<span class="hljs-number">150h</span>+var_10C]	<span class="hljs-comment">;æ¥æ”¶ç»“æœçš„ç¼“å†²åŒº</span><br><span class="hljs-symbol">.text:</span>000000014007E201                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">edx</span>, <span class="hljs-number">7</span>	<span class="hljs-comment">;æŒ‡å®šæŸ¥è¯¢çš„ä¿¡æ¯ç±»å‹</span><br><span class="hljs-symbol">.text:</span>000000014007E206                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rcx</span>, <span class="hljs-built_in">rax</span>	<span class="hljs-comment">;æŸ¥è¯¢çš„è¿›ç¨‹å¥æŸ„</span><br><span class="hljs-symbol">.text:</span>000000014007E209                 <span class="hljs-keyword">call</span>    [<span class="hljs-built_in">rbp</span>+<span class="hljs-number">150h</span>+var_128]	<span class="hljs-comment">;è°ƒç”¨NtQueryInformationProcess</span><br><span class="hljs-symbol">.text:</span>000000014007E20C                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">rbp</span>+<span class="hljs-number">150h</span>+var_EC], <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>000000014007E20F                 <span class="hljs-keyword">cmp</span>     [<span class="hljs-built_in">rbp</span>+<span class="hljs-number">150h</span>+var_10C], <span class="hljs-number">0</span><br><span class="hljs-symbol">.text:</span>000000014007E213                 <span class="hljs-keyword">jz</span>      short loc_14007E224<br><span class="hljs-symbol">.text:</span>000000014007E215                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rcx</span>, aBye       <span class="hljs-comment">; &quot;bye\n&quot;</span><br><span class="hljs-symbol">.text:</span>000000014007E21C                 <span class="hljs-keyword">call</span>    sub_14007886F<br><span class="hljs-symbol">.text:</span>000000014007E221                 <span class="hljs-keyword">nop</span><br><span class="hljs-symbol">.text:</span>000000014007E222                 <span class="hljs-keyword">jmp</span>     short loc_14007E231<br><span class="hljs-symbol">.text:</span>000000014007E224 <span class="hljs-comment">; ---------------------------------------------------------------------------</span><br><span class="hljs-symbol">.text:</span>000000014007E224<br><span class="hljs-symbol">.text:</span>000000014007E224 loc_14007E224:                          <span class="hljs-comment">; CODE XREF: sub_14007E130+E3â†‘j</span><br><span class="hljs-symbol">.text:</span>000000014007E224                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rcx</span>, aHello     <span class="hljs-comment">; &quot;hello\n&quot;</span><br><span class="hljs-symbol">.text:</span>000000014007E22B                 <span class="hljs-keyword">call</span>    sub_14007886F<br><span class="hljs-symbol">.text:</span>000000014007E230                 <span class="hljs-keyword">nop</span><br><span class="hljs-symbol">.text:</span>000000014007E231<br><span class="hljs-symbol">.text:</span>000000014007E231 loc_14007E231:                          <span class="hljs-comment">; CODE XREF: sub_14007E130+F2â†‘j</span><br><span class="hljs-symbol">.text:</span>000000014007E231                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rcx</span>, aPause     <span class="hljs-comment">; &quot;pause&quot;</span><br><span class="hljs-symbol">.text:</span>000000014007E238                 <span class="hljs-keyword">call</span>    sub_140078810<br><span class="hljs-symbol">.text:</span>000000014007E23D                 <span class="hljs-keyword">nop</span><br><span class="hljs-symbol">.text:</span>000000014007E23E                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>000000014007E240<br><span class="hljs-symbol">.text:</span>000000014007E240 loc_14007E240:                          <span class="hljs-comment">; CODE XREF: sub_14007E130+72â†‘j</span><br><span class="hljs-symbol">.text:</span>000000014007E240                                         <span class="hljs-comment">; sub_14007E130+AFâ†‘j</span><br><span class="hljs-symbol">.text:</span>000000014007E240                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rdi</span>, <span class="hljs-built_in">rax</span><br><span class="hljs-symbol">.text:</span>000000014007E243                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rcx</span>, [<span class="hljs-built_in">rbp</span>+<span class="hljs-number">150h</span>+var_180]<br><span class="hljs-symbol">.text:</span>000000014007E247                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rdx</span>, unk_140171FF0<br><span class="hljs-symbol">.text:</span>000000014007E24E                 <span class="hljs-keyword">call</span>    sub_140079A35<br><span class="hljs-symbol">.text:</span>000000014007E253                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">rdi</span><br><span class="hljs-symbol">.text:</span>000000014007E256                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rcx</span>, [<span class="hljs-built_in">rbp</span>+<span class="hljs-number">150h</span>+var_18]<br><span class="hljs-symbol">.text:</span>000000014007E25D                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">rcx</span>, <span class="hljs-built_in">rbp</span>        <span class="hljs-comment">; StackCookie</span><br><span class="hljs-symbol">.text:</span>000000014007E260                 <span class="hljs-keyword">call</span>    j___security_check_cookie<br><span class="hljs-symbol">.text:</span>000000014007E265                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rsp</span>, [<span class="hljs-built_in">rbp</span>+<span class="hljs-number">148h</span>]<br><span class="hljs-symbol">.text:</span>000000014007E26C                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">rdi</span><br><span class="hljs-symbol">.text:</span>000000014007E26D                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">rbp</span><br><span class="hljs-symbol">.text:</span>000000014007E26E                 <span class="hljs-keyword">retn</span><br><span class="hljs-symbol">.text:</span>000000014007E26E <span class="hljs-comment">; &#125; // starts at 14007E130</span><br><span class="hljs-symbol">.text:</span>000000014007E26E sub_14007E130   endp<br><span class="hljs-symbol">.text:</span>000000014007E26E<br></code></pre></td></tr></table></figure>

<p>ç‰¹å¾åº”è¯¥æ˜¯ call    cs:GetModuleHandleWã€call    cs:GetProcAddressã€ call    cs:GetCurrentProcess</p>
</li>
<li><p>åº”å¯¹æ–¹æ³•ï¼š</p>
<p>scyllahideä¹Ÿæ˜¯æ”¯æŒåNtQueryInformationProcessåè°ƒè¯•çš„ï¼Œæ‰‹åŠ¨ç»•è¿‡ä¸€èˆ¬æ˜¯æ›´æ”¹ç¼“å†²åŒºçš„å€¼ä¸æ ‡å‡†å€¼çš„æ¯”è¾ƒç»“æœï¼Œå½“ç„¶åœ¨DSç»™çš„æºç ä¸­å› ä¸ºåŠ å…¥äº†ä¸€äº›é”™è¯¯å¤„ç†ï¼ˆå¦‚ntdllè½½å…¥å¤±è´¥å°±è·³è¿‡åè°ƒè¯•ï¼‰ï¼Œå¯ä»¥é€šè¿‡äººä¸ºæ”¹åŠ¨é”™è¯¯åˆ¤æ–­çš„ç»“æœæ¥å®ç°ç›´æ¥è·³è¿‡åè°ƒè¯•</p>
</li>
</ul>
<h3 id="GetLastError"><a href="#GetLastError" class="headerlink" title="GetLastError"></a>GetLastError</h3><ul>
<li><p>è¿™ä¸ªå‡½æ•°ç”¨äºè·å–æœ€è¿‘ä¸€æ¬¡å¼‚å¸¸çš„è¿”å›å€¼ã€‚ä½¿ç”¨çš„æ–¹æ³•ä¸€èˆ¬æ˜¯æ•…æ„æ„é€ å¼‚å¸¸ï¼Œå¦‚æœå¤„äºè¢«è°ƒè¯•çŠ¶æ€ï¼Œè°ƒè¯•å™¨ä¼šæ•è·å¼‚å¸¸å¯¼è‡´è¿”å›çš„é”™è¯¯ç å’Œé¢„æœŸçš„ä¸ç¬¦ã€‚</p>
</li>
<li><p>æ•ˆæœï¼š</p>
<p><img src="/../images/image-20250802173635007.png" alt="IDA"></p>
<p><img src="/../images/image-20250802173655097.png" alt="XDbg"></p>
</li>
<li><p>åº”å¯¹æ–¹æ³•ï¼š</p>
<p>å¯ä»¥çœ‹åˆ°ï¼ŒGetLastErrorä¹‹åï¼Œä¼šæŠŠè¿”å›å€¼å’Œé¢„è®¾çš„å€¼è¿›è¡Œæ¯”è¾ƒï¼Œæ‰€ä»¥ä¿®æ”¹cmpåçš„zfå°±å¯ä»¥äº†ã€‚ç”±äºGetLastErrorçš„è‡ªç”±åº¦æ¯”è¾ƒé«˜ï¼ˆè§¦å‘å¼‚å¸¸çš„æ–¹æ³•å¤šæ ·ï¼‰ï¼Œæ‰€ä»¥scyllahideåº”è¯¥æ˜¯ä¸æ”¯æŒçš„ï¼ˆç¬”è€…æ²¡æœ‰è®¤å‡ºä»€ä¹ˆç›¸å…³çš„è®¾ç½®ï¼‰</p>
</li>
</ul>
<h2 id="æ•°æ®æ£€æµ‹"><a href="#æ•°æ®æ£€æµ‹" class="headerlink" title="æ•°æ®æ£€æµ‹"></a>æ•°æ®æ£€æµ‹</h2><h3 id="BeingDebugged"><a href="#BeingDebugged" class="headerlink" title="BeingDebugged"></a>BeingDebugged</h3><ul>
<li><p>BeingDebuggedæ˜¯PEBçš„æˆå‘˜å˜é‡ä¹‹ä¸€ï¼Œç”¨äºæè¿°è¿›ç¨‹æ˜¯å¦å¤„äºè¢«è°ƒè¯•çŠ¶æ€ï¼Œä¸º1æ—¶è¡¨ç¤ºå¤„äºè¢«è°ƒè¯•çŠ¶æ€ã€‚</p>
<p>PEBç»“æ„ä½“å…·ä½“å¦‚ä¸‹ï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs C"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">PEB</span> &#123;</span><br>  BYTE                          Reserved1[<span class="hljs-number">2</span>];<br>  BYTE                          BeingDebugged;<span class="hljs-comment">//åç§»ä¸º2</span><br>  BYTE                          Reserved2[<span class="hljs-number">1</span>];<br>  PVOID                         Reserved3[<span class="hljs-number">2</span>];<br>  PPEB_LDR_DATA                 Ldr;<br>  PRTL_USER_PROCESS_PARAMETERS  ProcessParameters;<br>  PVOID                         Reserved4[<span class="hljs-number">3</span>];<br>  PVOID                         AtlThunkSListPtr;<br>  PVOID                         Reserved5;<br>  ULONG                         Reserved6;<br>  PVOID                         Reserved7;<br>  ULONG                         Reserved8;<br>  ULONG                         AtlThunkSListPtr32;<br>  PVOID                         Reserved9[<span class="hljs-number">45</span>];<br>  BYTE                          Reserved10[<span class="hljs-number">96</span>];<br>  PPS_POST_PROCESS_INIT_ROUTINE PostProcessInitRoutine;<br>  BYTE                          Reserved11[<span class="hljs-number">128</span>];<br>  PVOID                         Reserved12[<span class="hljs-number">1</span>];<br>  ULONG                         SessionId;<br>&#125; PEB, *PPEB;<br></code></pre></td></tr></table></figure>
</li>
<li><p>åè°ƒè¯•æ‰‹æ®µé€šå¸¸æ˜¯è®¿é—®è¿›ç¨‹çš„è¯¥å‚æ•°ï¼ˆå¦‚WINAPIçš„IsDebuggerPresent()ï¼‰æ¥åˆ¤æ–­æ˜¯å¦å¤„äºè¢«è°ƒè¯•çŠ¶æ€ã€‚32ä½ä¸‹ï¼ŒPEBç”¨FS:[0x30]è¡¨ç¤ºï¼›64ä½ä¸‹ï¼ŒPEBç”¨FS:[0x60]è¡¨ç¤ºã€‚åŠ ä¸Šåç§»2å°±æ˜¯å¯¹BeingDebuggedçš„è®¿é—®äº†ï¼ˆè¿™å°±æ˜¯è¿™ç§æ–¹æ³•çš„ç‰¹å¾äº†ï¼‰</p>
</li>
<li><p>æ•ˆæœå›¾ï¼š</p>
<p><img src="/../images/image-20250802180316105.png" alt="IDA"></p>
<p><img src="/../images/image-20250802180438104.png" alt="XDbg"></p>
</li>
<li><p>åº”å¯¹æ–¹æ³•ï¼š</p>
<p>scyllahideå¯ç»•è¿‡ï¼Œæ‰‹åŠ¨ç»•è¿‡åªéœ€è¦åœ¨è®¿é—®æŒ‡ä»¤ä¸‹æ–¹çš„cmpåä¿®æ”¹ZFå³å¯</p>
</li>
</ul>
<h3 id="NTGlobalFlag"><a href="#NTGlobalFlag" class="headerlink" title="NTGlobalFlag"></a>NTGlobalFlag</h3><ul>
<li><p>NTGlobalFlagä¹Ÿæ˜¯PEBç»“æ„ä½“çš„æˆå‘˜ï¼Œä½†æ˜¯æ˜¯éå…¬å¼€çš„ï¼ˆå› æ­¤ä¸Šæ–‡çš„PEBç»“æ„ä½“å®šä¹‰ä¸­çœ‹ä¸åˆ°ï¼‰ã€‚32ä½ä¸‹ï¼Œå®ƒä½äºPEBåç§»0x68å¤„ï¼Œ64ä½ä¸‹ï¼Œå®ƒä½äºPEBåç§»0xBCå¤„ï¼ˆç‰¹å¾ï¼‰ã€‚å®ƒæœ¬æ˜¯æè¿°è¿›ç¨‹å †ç®¡ç†çš„ï¼Œä½†æ˜¯ç”±äºè°ƒè¯•å™¨ä¸­çš„è¿›ç¨‹åˆ›å»ºå †çš„æ–¹å¼å’Œæ­£å¸¸æƒ…å†µæœ‰æ‰€ä¸åŒï¼Œè¢«è°ƒè¯•æ—¶è¯¥å€¼ä¼šè¢«è®¾ä¸º0x70ï¼ˆåˆä¸€ä¸ªç‰¹å¾ï¼‰ï¼Œå› æ­¤ä¹Ÿè¢«ç”¨æ¥åˆ¤æ–­æ˜¯å¦è¢«è°ƒè¯•</p>
</li>
<li><p>æ•ˆæœï¼š</p>
<p><img src="/../images/image-20250802181920666.png" alt="IDA"></p>
<p><img src="/../images/image-20250802181950005.png" alt="XDbg"></p>
</li>
<li><p>åº”å¯¹æ–¹æ³•ï¼š</p>
<p>syllahideå¯ä»¥ç»•è¿‡ï¼Œä¹Ÿå¯ä»¥åœ¨ä¸‹é¢çš„æ¯”è¾ƒé€»è¾‘ï¼ˆå› ä¸ºæ˜¯å†…è”æ±‡ç¼–ï¼Œæ‰€ä»¥æ¯”è¾ƒé€»è¾‘çš„å®ç°ä¼šæœ‰ä¸åŒï¼‰åä¿®æ”¹ZFç»•è¿‡</p>
</li>
</ul>
<h2 id="è¿›ç¨‹æ£€æµ‹"><a href="#è¿›ç¨‹æ£€æµ‹" class="headerlink" title="è¿›ç¨‹æ£€æµ‹"></a>è¿›ç¨‹æ£€æµ‹</h2><h3 id="FindWindow"><a href="#FindWindow" class="headerlink" title="FindWindow"></a>FindWindow</h3><ul>
<li><p>å®é™…ä¸Šæ˜¯çª—å£æ£€æµ‹ï¼Œè¿™ä¸ªå‡½æ•°è·å–çš„æ˜¯è¿›ç¨‹çª—å£çš„ç±»åæˆ–è€…æ ‡ç­¾ï¼Œé€šè¿‡ä¸é¢„æœŸçš„åå­—è¿›è¡Œæ¯”è¾ƒæ¥åˆ¤æ–­æ˜¯å¦å¤„äºè¢«è°ƒè¯•çŠ¶æ€ã€‚ç”±äºä½¿ç”¨çš„æ˜¯ç³»ç»Ÿå‡½æ•°ï¼Œæ‰€ä»¥å®é™…ä¸Šä¹Ÿå±äºWINAPIæ£€æµ‹ï¼Œä½†æ˜¯ä¸é‡è¦ã€‚ç‰¹å¾å’ŒWINAPIæ£€æµ‹ä¸€æ ·ï¼Œä¼šæœ‰æ˜æ˜¾çš„æ ‡è®°</p>
</li>
<li><p>æ•ˆæœï¼š</p>
<p><img src="/../images/image-20250802184919847.png" alt="IDA"></p>
<p><img src="/../images/image-20250802185121993.png" alt="XDbg"></p>
</li>
<li><p>æœ¬ä¾‹çš„ç¨‹åºåˆ›å»ºäº†ä¸€ä¸ªåˆ¤æ–­å‡½æ•°ï¼Œåœ¨ä¸»å‡½æ•°ä¸­æ˜¯å°†è¿”å›å€¼teståæ¥åˆ¤æ–­æ˜¯å¦è¢«è°ƒè¯•çš„ï¼Œæ‰€ä»¥åªéœ€è¦ä¿®æ”¹ä¸»å‡½æ•°ä¸­çš„test eax,eaxåçš„ZFå°±å¯ä»¥å®ç°ç»•è¿‡äº†ã€‚scyllahideåº”è¯¥æ˜¯ä¸æ”¯æŒçš„</p>
</li>
</ul>
<h3 id="çˆ¶è¿›ç¨‹æ£€æµ‹"><a href="#çˆ¶è¿›ç¨‹æ£€æµ‹" class="headerlink" title="çˆ¶è¿›ç¨‹æ£€æµ‹"></a>çˆ¶è¿›ç¨‹æ£€æµ‹</h3><ul>
<li><p>åŸç†æ˜¯æ­£å¸¸ç¨‹åºåŒå‡»è¿è¡Œçˆ¶è¿›ç¨‹ä¸ºexplorer.exeï¼Œè€Œæ‹–è¿›è°ƒè¯•å™¨æ‰“å¼€çˆ¶è¿›ç¨‹ä¸ºè°ƒè¯•å™¨ï¼Œé€šè¿‡æ¯”è¾ƒè·å¾—çš„çˆ¶è¿›ç¨‹åå’Œé¢„è®¾çš„çˆ¶è¿›ç¨‹åå¯ä»¥åˆ¤æ–­æ˜¯å¦å¤„äºè¢«è°ƒè¯•çŠ¶æ€ã€‚ä¸€èˆ¬ä¼šé€šè¿‡éå†è¿›ç¨‹æˆ–è€…é€šè¿‡NtQueryInfomationProcessæŸ¥è¯¢æ¥å®ç°ã€‚ç‰¹å¾æ˜¯å‡ºç°å¤§é‡å’Œè¿›ç¨‹ç›¸å…³çš„apiï¼Œå¦‚éå†è¿›ç¨‹æ—¶ä¼šè°ƒç”¨CreateToolhelp32Snapshotã€th32ParentProcessIDã€Process32Nextç­‰ï¼ŒNtQueryInfomationProcessæŸ¥è¯¢ä¼šå‡ºç°QueryFullProcessImageNameAæˆ–è€…å…¶ä»–ç›¸å…³å‡½æ•°ä¸è°ƒè¯•å™¨åç§°å­—ç¬¦ä¸²åŒæ—¶å‡ºç°çš„æƒ…å†µ</p>
</li>
<li><p>æ•ˆæœï¼š</p>
<p><img src="/../images/image-20250802200208452.png" alt="IDAæ˜¾å¼ä½“ç°"></p>
<p><img src="/../images/image-20250802200407372.png" alt="XDbgè·³è½¬è¡¨ä¸­ä½“ç°"></p>
<p><img src="/../images/image-20250802201532370.png" alt="IDA"></p>
<p><img src="/../images/image-20250802201557678.png" alt="XDbg"></p>
</li>
<li><p>å®æµ‹scyllahideç»•è¿‡ä¸äº†ç¬¬ä¸€ç§æ–¹æ³•ä½†å¯ä»¥ç»•è¿‡ç¬¬äºŒç§æ–¹æ³•ã€‚æ‰‹åŠ¨ç»•è¿‡ä¹Ÿå¯ä»¥ï¼Œä¸»è¦åŸºäºåç»­å¯¹è¿›ç¨‹åçš„åˆ¤æ–­ï¼Œä¿®æ”¹åˆ¤æ–­ç»“æœå³å¯ç»•è¿‡</p>
</li>
</ul>
<h3 id="ç‰¹å¾ç æ£€æµ‹"><a href="#ç‰¹å¾ç æ£€æµ‹" class="headerlink" title="ç‰¹å¾ç æ£€æµ‹"></a>ç‰¹å¾ç æ£€æµ‹</h3><ul>
<li><p>æœ‰çš„è°ƒè¯•å™¨åœ¨å†…å­˜ä¸­ä¼šæœ‰ç‰¹å¾ç ï¼Œé€šè¿‡éå†è¿›ç¨‹å’Œæœç´¢ç‰¹å¾ç å¯ä»¥åˆ¤æ–­æ˜¯å¦è¢«è°ƒè¯•ã€‚è¿™ç§æƒ…å†µä¼šæ¯”è¾ƒå¤æ‚ï¼Œéš¾ç‚¹åº”è¯¥åœ¨è¯†åˆ«ä¸Šã€‚ä¸€æ–¹é¢å¯ä»¥é€šè¿‡åˆ†ææ˜¯å¦å‡ºç°ç‰¹å¾ç ï¼ˆå¯èƒ½ä¼šæ˜¯å¾ˆæ˜æ˜¾çš„ä¸€è¿ä¸²æ•°å­—åˆå§‹åŒ–ï¼‰ï¼Œå¦ä¸€æ–¹é¢éå†è¿›ç¨‹ä¼šå‡ºç°çˆ¶è¿›ç¨‹æ£€æµ‹ä¸­æåŠçš„apiï¼Œä½†æ˜¯è¿™äº›ä¸€èˆ¬ä¸ä¼šå‡ºç°åœ¨ä¸»å‡½æ•°ä¸­ï¼Œéœ€è¦è·Ÿè¿›å‡½æ•°æŸ¥çœ‹ã€‚</p>
<p>ç‰¹å¾ç ç¤ºä¾‹ï¼š</p>
<p><img src="/../images/image-20250802211300649.png" alt="IDA"></p>
<p><img src="/../images/image-20250802211316100.png" alt="XDbg"></p>
</li>
<li><p>scyllahideä¸€èˆ¬ç»•è¿‡ä¸äº†ï¼Œå¯ä»¥åœ¨ä¸»å‡½æ•°æ¶‰åŠåˆ¤æ–­ç»“æœçš„é€»è¾‘ä¸­è¿›è¡Œæ”¹åŠ¨ç»•è¿‡ã€‚</p>
</li>
</ul>
]]></content>
      <categories>
        <category>Reverseå­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>Reverse</tag>
      </tags>
  </entry>
  <entry>
    <title>Day11:èŠ±æŒ‡ä»¤</title>
    <url>/2025/07/31/Day11-%E8%8A%B1%E6%8C%87%E4%BB%A4/</url>
    <content><![CDATA[<p>èŠ±æŒ‡ä»¤</p>
<span id="more"></span>

<h2 id="èŠ±æŒ‡ä»¤"><a href="#èŠ±æŒ‡ä»¤" class="headerlink" title="èŠ±æŒ‡ä»¤"></a>èŠ±æŒ‡ä»¤</h2><ul>
<li><p>åˆå«åƒåœ¾æŒ‡ä»¤ï¼Œä¸å½±å“ç¨‹åºåŸå§‹é€»è¾‘ï¼Œä½†ä¼šå¹²æ‰°IDAåç¼–è¯‘æˆ–è€…åæ±‡ç¼–ã€‚</p>
</li>
<li><p>åŸç†ï¼š</p>
<p>å› ä¸ºåç¼–è¯‘å™¨å¤šæ˜¯é™æ€åˆ†æçš„ï¼Œä¸ä¼šé€šè¿‡æ‰§è¡Œæ¥åˆ†æé€»è¾‘ï¼Œåªä¼šæ ¹æ®åæ±‡ç¼–å‡ºæ¥çš„æŒ‡ä»¤åˆ†æï¼Œå› æ­¤æœ‰ç©ºå¯ä¹˜ï¼šä¾‹å¦‚å¯ä»¥é€šè¿‡å†…è”æ±‡ç¼–ä¸å®Œæ•´æŒ‡ä»¤ä½†æ˜¯è·³è¿‡ä¸å®Œæ•´æŒ‡ä»¤æ¥æ¨¡ç³ŠæŒ‡ä»¤è¾¹ç•Œã€å†…è”æ±‡ç¼–æ°¸è·³æ°¸ä¸è·³åˆ†æ”¯æ¥è¯¯å¯¼è¿è¡Œé€»è¾‘åˆ†æã€å†…è”æ±‡ç¼–æ— æ„ä¹‰æŒ‡ä»¤è¯¯å¯¼ä¸»è¦é€»è¾‘</p>
</li>
<li><p>æ˜¾è‘—ç‰¹å¾æ˜¯å‡ºç°çº¢è‰²è¡Œï¼Œè€Œåº”å¯¹æ–¹æ³•æ˜¯é€‰ä¸­èŠ±æŒ‡ä»¤æ‰€åœ¨çš„åŒºåŸŸæ”¹ä¸ºâ€œnopâ€ï¼ˆç©ºæŒ‡ä»¤ï¼‰</p>
</li>
</ul>
<h3 id="æ’è·³å‹"><a href="#æ’è·³å‹" class="headerlink" title="æ’è·³å‹"></a>æ’è·³å‹</h3><ul>
<li><p>å³é€šè¿‡é¢„è®¾ZFä½ä¸º1ï¼Œä½¿jzæ’æ‰§è¡Œã€‚å®æµ‹IDA9.0.241217ä¸ä¼šæŠ¥çº¢ï¼Œä¹Ÿå°±æ˜¯æ··æ·†å¤±æ•ˆï¼Œæ‰€ä»¥å°±çœ‹çœ‹æºç å§</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs C"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;windows.h&gt;</span></span><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>	_asm&#123;<br>		xor eax, eax;<br>		jz s;<br>		add esp, <span class="hljs-number">0x11</span>;<br>	s:<br>	&#125;;<br>	<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;hello\n&quot;</span>);<br>	system(<span class="hljs-string">&quot;pause&quot;</span>);<br>	<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h3 id="call-retç›¸æ¶ˆå‹"><a href="#call-retç›¸æ¶ˆå‹" class="headerlink" title="call-retç›¸æ¶ˆå‹"></a>call-retç›¸æ¶ˆå‹</h3><ul>
<li><p>æ¥çœ‹æ•ˆæœ</p>
<p><img src="/../images/image-20250731203000820.png" alt="æŠ¥çº¢"></p>
</li>
<li><p>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨å‡½æ•°ä¸­é—´å‡ºç°äº†sp-analysis failedï¼Œè€Œä¸Šé¢ä¸€æ¡å°±æ˜¯retnï¼Œæ˜æ˜¾ä¸å¯¹ã€‚</p>
<p>å¾€å‰çœ‹ï¼Œrep stosdåˆå§‹åŒ–åï¼Œcalläº†$+5ï¼Œå³å½“å‰ä½ç½®+5&#x3D;0046308Cï¼Œä¹Ÿå°±æ˜¯ä¸‹ä¸€æ¡çš„add</p>
<p>ç„¶åç»™espçš„å€¼+7ï¼ˆcallçš„æ—¶å€™push eipå³push 0046308cäº†ï¼‰</p>
<p>æ­¤æ—¶espå­˜æ”¾å€¼ä¸º0046308c+7&#x3D;00463093ï¼Œæ‰€ä»¥retnæ—¶ä¼špop 00463093ï¼Œç¨‹åºè·³åˆ°00463093</p>
<p>å¾€ä¸‹çœ‹ï¼Œ00463093æ­£æ˜¯æ²¡è¯†åˆ«å‡ºæ¥çš„ä¸‰ä¸ªæ•°çš„æœ€åä¸€ä¸ªï¼Œä¸‹é¢è¿˜æœ‰ä¸€ä¸ªoffsetæ²¡æœ‰æŒ‡ä»¤ã€‚</p>
<p>ç¬¬ä¸‰ä¸ªæ•°68hå’Œoffsetç»“åˆåˆšå¥½æ˜¯push offsetï¼Œå¯¹åº”ä¸Šäº†ä¸‹é¢çš„callï¼ˆå‡½æ•°ä¼ å‚ï¼‰</p>
</li>
<li><p>é€‰ä¸­æ²¡è¯†åˆ«çš„ä¸‰ä¸ªæ•°ï¼ŒæŒ‰â€œUâ€ï¼ˆundefine)ï¼Œå¯ä»¥çœ‹åˆ°ä¸‰ä¸ªæ•°åˆ†å¼€äº†</p>
<p><img src="/../images/image-20250731203817109.png" alt="æŒ‰U"></p>
</li>
<li><p>é€‰ä¸­db 68hå’Œdd offset aHelloï¼ŒæŒ‰Cè½¬åŒ–ä¸ºæ±‡ç¼–æŒ‡ä»¤ï¼Œå¯ä»¥çœ‹åˆ°push offsetæ¢å¤äº†</p>
<p><img src="/../images/image-20250731204815374.png" alt="æ¢å¤push"></p>
</li>
<li><p>é€‰ä¸­call $+5åˆ°db 34hï¼Œå³é”®é€‰æ‹©â€Fill with NOPsâ€œï¼ˆå®æµ‹db 34hä¼šnopä¸å¹²å‡€ï¼Œè¦é€‰ä¸­åˆ°db 34hä¸‹ä¸€è¡Œï¼‰</p>
<p><img src="/../images/image-20250731204858702.png" alt="NOP"></p>
</li>
<li><p>å¯ä»¥çœ‹åˆ°å‡½æ•°å˜æˆè¿™æ ·ï¼Œè¿™æ˜¯å› ä¸ºæ’å…¥äº†retnå¯¼è‡´å‡½æ•°èŒƒå›´åˆ†æé”™è¯¯ï¼Œéœ€è¦çº æ­£</p>
<p><img src="/../images/image-20250731205500606.png" alt="NOPå®Œ"></p>
</li>
<li><p>ç‚¹å‡»å‡½æ•°åï¼Œç„¶åå³é”®edit fuctionï¼ŒæŠŠend addressæ”¹æˆæœ«å°¾é‚£ä¸ªçœŸæ­£çš„retnçš„åœ°å€å°±OKäº†</p>
<p><img src="/../images/image-20250731205807130.png" alt="çº æ­£å‡½æ•°èŒƒå›´"></p>
</li>
</ul>
<h3 id="jz-æ“ä½œæ•°ä¸å…¨å‹"><a href="#jz-æ“ä½œæ•°ä¸å…¨å‹" class="headerlink" title="jz-æ“ä½œæ•°ä¸å…¨å‹"></a>jz-æ“ä½œæ•°ä¸å…¨å‹</h3><ul>
<li><p>è¿™ç§æƒ…å†µä¸‹ä¼šå‡ºç°å’Œä¸Šä¸€ç§ä¸€æ ·çš„æŒ‡ä»¤è¯†åˆ«é”™è¯¯çš„é—®é¢˜ï¼Œä¸”çœ‹å›¾ï¼š</p>
<p><img src="/../images/image-20250801002342967.png" alt="å›¾"></p>
</li>
<li><p>è¿™æ˜¯æŒ‰ç…§MSVS C++åˆå§‹åŒ–è§„åˆ™è·³è½¬åï¼Œåœ¨æœ¬æ¥mainå‡½æ•°çš„åœ°æ–¹çš„æˆªå›¾ã€‚ä½†æ˜¯è·³è½¬è¿‡ç¨‹ä¸­ä¼šå‘ç°ï¼Œè·³è½¬åˆ°mainå‡½æ•°çš„ä»£ç æ˜¯jmp loc_xxxxxxè€Œä¸æ˜¯jmp sub_xxxxxxã€‚ä½†æ˜¯ç›®å‰è¿˜ä¸å½±å“ï¼Œå…ˆåˆ†ææŠ¥é”™çš„åœ°æ–¹ã€‚</p>
</li>
<li><p>å¯ä»¥çœ‹åˆ° xor ebp,[eax+50h] å¤„æŠ¥çº¢äº†ï¼Œå¹¶ä¸”ä¸‹é¢æ˜¯ä¸€æ®µæ²¡åˆ†æå‡ºæ¥çš„æ•°å’Œå­—ç¬¦ä¸²â€pauseâ€ï¼Œä¸‹é¢è¿›è¡Œåˆ†æ</p>
</li>
<li><p>é¦–å…ˆï¼Œrep stosdåˆå§‹åŒ–åï¼Œè¿›è¡Œäº†ä¸€ä¸ªæ’è·³ï¼Œè·³è½¬çš„åœ°æ–¹æ˜¯0046308Eï¼Œåœ¨ xor ebp,[eax+50h] è¿™æ¡æŒ‡ä»¤é‡Œï¼Œæ‰€ä»¥è¿™é‡Œçº¢äº†</p>
</li>
<li><p>æŠŠ xor ebp,[eax+50h] è¿™æ¡æŒ‡ä»¤undefineä¸€ä¸‹</p>
<p><img src="/../images/image-20250801002409823.png" alt="undefineä¸€ä¸‹"></p>
</li>
<li><p>æ ¹æ®é€»è¾‘ï¼Œç¨‹åºæ˜¯è‚¯å®šä¼šè·³åˆ°0046308Eçš„ï¼Œæ‰€ä»¥å‰é¢çš„ä»£ç å†—ä½™ï¼Œç›´æ¥nopæ‰ã€‚é€‰ä¸­ xor eax,eax åˆ°0046308Eï¼ˆæ ¹æ®ä¸Šä¸€ç§ç±»å‹çš„ç»éªŒï¼Œè¦å¤šè¦†ç›–ä¸€ä½æ‰èƒ½åˆšå¥½nopæ‰ç›®æ ‡ä»£ç ï¼‰</p>
<p><img src="/../images/image-20250801002510740.png" alt="NOP"></p>
</li>
<li><p>nopå®Œæˆåï¼ˆå¦‚æœæœ‰db 90hå°±æŒ‰â€Câ€œè½¬æˆcodeï¼‰å°±ä¼šå‘ç°ä¸‹é¢æ²¡åˆ†æçš„æ•°ç«‹åˆ»åˆ†æå‡ºæŒ‡ä»¤äº†</p>
<p><img src="/../images/image-20250801002536258.png" alt="å»æ··æ·†æˆåŠŸ"></p>
</li>
<li><p>ä½†æ˜¯è¿˜æ²¡å®Œï¼Œæ­¤æ—¶æŒ‰F5æ˜¯æ— æ³•åç¼–è¯‘çš„ï¼Œå› ä¸ºæŠ¥é”™çš„åœ°æ–¹æ˜¯loc_xxxxxxèŒƒå›´é‡Œçš„ï¼Œä¸æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯å‰é¢è¯´çš„jmp loc_xxxxxxè€Œä¸æ˜¯jmp sub_xxxxxxçš„é—®é¢˜äº†ã€‚è¿™é‡Œå¯ä»¥çœ‹å‡ºï¼ŒIDAè¿™ç±»æ··æ·†ä¼šå¯¼è‡´IDAæŠŠå‡½æ•°è¯†åˆ«æˆä¸€ä¸ªå¼•ç”¨è€Œä¸æ˜¯å‡½æ•°ã€‚</p>
</li>
<li><p>åˆ°æœ€å¼€å§‹push ebpå¼€è¾Ÿæ ˆå¸§çš„å¼•ç”¨loc_463070å¤„ï¼ŒæŠŠå®ƒundefineä¸€ä¸‹ï¼Œå†æŒ‰â€œPâ€é‡æ–°åˆ†æä¸€ä¸‹ï¼Œå°±å¯ä»¥å¾—åˆ°mainå‡½æ•°äº†</p>
<p><img src="/../images/image-20250801002703125.png" alt="ä¿®å¤çš„mainå‡½æ•°"></p>
</li>
<li><p>è¿™ç±»æœ‰ä¸€ä¸ªç‰¹å¾å°±æ˜¯jz loc_xxxxxx+1ï¼Œæ®æ­¤å¯ä»¥å¿«é€Ÿæ‰¾åˆ°åŠ äº†æ··æ·†çš„åœ°æ–¹</p>
</li>
</ul>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ul>
<li>ä¸Šè¿°ä¸‰ç§ï¼ˆå®é™…ä¸Šæœ‰æ··æ·†æ•ˆæœçš„åªæœ‰ä¸¤ç§ï¼‰æ˜¯æ¯”è¾ƒåŸºç¡€çš„èŠ±æŒ‡ä»¤ã€‚è¯†åˆ«èŠ±æŒ‡ä»¤çš„è¦ç‚¹ä¸»è¦æ˜¯çœ‹çº¢è‰²é”™è¯¯ï¼Œä¹Ÿå¯ä»¥ç»“åˆä¸€äº›ç‰¹å¾æ¥è¯†åˆ«ã€‚è§£å†³æ–¹æ³•å°±æ˜¯nopæ‰æ··æ·†ä»£ç ã€‚</li>
<li>åœ¨å®é™…è®¾è®¡é¢˜ç›®æ—¶ï¼Œç¬”è€…æ„å¤–å‘ç°äº†ä¸€äº›æ›´å¼ºåŠ›çš„æ··æ·†ï¼Œå•å•æ˜¯åœ¨ä¸Šè¿°ä¸‰ç§ç±»å‹çš„åŸºç¡€ä¸ŠåŠ ä¸€ç‚¹å…¶ä»–æŒ‡ä»¤ï¼Œå°±ä¼šå¯¼è‡´ä¸€ä¸ªå‡½æ•°å®Œå…¨æ— æ³•è¢«è¯†åˆ«ï¼ˆè¢«æ”¾åœ¨rdataæ®µè€Œä¸æ˜¯textæ®µçš„é‚£ç§ï¼‰ï¼Œä½†æ˜¯ç¨‹åºè¿˜èƒ½æ­£å¸¸æ‰§è¡Œï¼Œè€ŒæŠ¥é”™çš„åœ°æ–¹åœ¨æ— æ³•è¯†åˆ«çš„å‡½æ•°çš„ä¸Šçº§å‡½æ•°é‡Œï¼ˆè·³è½¬åˆ°è¿™ä¸ªå‡½æ•°çš„é‚£ä¸ªå‡½æ•°ï¼‰ï¼Œå¯èƒ½è¦ç»“åˆAIæ‰èƒ½å®ç°å¿«æ·çš„åˆ†æã€‚å› æ­¤ï¼ŒèŠ±æŒ‡ä»¤è¿˜æ˜¯ä¸€ä¸ªå…·æœ‰æŒ‘æˆ˜æ€§çš„æ··æ·†æ–¹å¼ï¼ˆå½“ç„¶ä¹Ÿå¯èƒ½æ˜¯ç¬”è€…å¤ªèœäº†æ²¡çŸ³ç²’ï¼‰</li>
</ul>
]]></content>
      <categories>
        <category>Reverseå­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>Reverse</tag>
      </tags>
  </entry>
  <entry>
    <title>Day1:x86æ±‡ç¼–æ¡†æ¶ã€æ•°æ®ç±»å‹ã€åŸºæœ¬è¿ç®—ã€ä½è¿ç®—</title>
    <url>/2025/07/05/Day1-x86%E6%B1%87%E7%BC%96%E6%A1%86%E6%9E%B6/</url>
    <content><![CDATA[<p>vs2022æ±‡ç¼–ç¯å¢ƒã€x86æ±‡ç¼–æ¡†æ¶ã€æ•°æ®ç±»å‹ã€åŸºæœ¬è¿ç®—ã€ä½è¿ç®—</p>
<span id="more"></span>

<h2 id="åœ¨vs2022ä¸­ç¼–å†™æ±‡ç¼–ä»£ç "><a href="#åœ¨vs2022ä¸­ç¼–å†™æ±‡ç¼–ä»£ç " class="headerlink" title="åœ¨vs2022ä¸­ç¼–å†™æ±‡ç¼–ä»£ç "></a>åœ¨vs2022ä¸­ç¼–å†™æ±‡ç¼–ä»£ç </h2><ul>
<li><p>æ–°å»ºä¸€ä¸ªç©ºé¡¹ç›®</p>
</li>
<li><p>åœ¨å·¥å…·æ çš„â€œå·¥å…·â€é€‰é¡¹ä¸­é€‰æ‹©â€œè·å–å·¥å…·å’ŒåŠŸèƒ½â€ï¼Œåœ¨â€œä½¿ç”¨C++çš„æ¡Œé¢å¼€å‘â€ä¸­å‹¾é€‰â€œWindows 10 SDKâ€ä»¥åŠâ€œMSVC v142 -VS 2015 C++ç”Ÿæˆå·¥å…·â€ï¼Œç„¶åå®‰è£…è¿™äº›æ–°å‹¾é€‰çš„é€‰é¡¹ï¼Œæ›´æ–°VS2022</p>
<p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-07-05%20233157.png" alt="å‹¾é€‰é€‰é¡¹"></p>
</li>
<li><p>å³é”®æ–°å»ºçš„ç©ºé¡¹ç›®ï¼Œé€‰æ‹©æœ€ä¸‹æ–¹çš„â€œå±æ€§â€ï¼Œåœ¨å¼¹å‡ºæ¥çš„é¡µé¢ä¸­é€‰æ‹©â€œå¸¸è§„â€ï¼Œç„¶åå°†å¹³å°ç‰ˆæœ¬æ”¹æˆwindows10ï¼Œå¯èƒ½éœ€è¦æ”¹ä¹Ÿå¯èƒ½ä¸éœ€è¦</p>
<p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-07-05%20233305.png" alt="å±æ€§é¡µ"></p>
</li>
<li><p>å³é”®æ–°å»ºçš„ç©ºé¡¹ç›®ï¼Œé€‰æ‹©â€œç”Ÿæˆä¾èµ–æ€§â€ï¼Œç„¶åæ˜¯â€œç”Ÿæˆè‡ªå®šä¹‰â€ï¼Œåœ¨ç•Œé¢ä¸­é€‰æ‹©masm</p>
<p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-07-05%20233422.png" alt="ç”Ÿæˆè‡ªå®šä¹‰"></p>
</li>
<li><p>ç„¶åå°±å¯ä»¥æ–°å»ºä¸€ä¸ª.asmæºæ–‡ä»¶äº†ã€‚æ–°å»ºå®Œæˆåï¼Œå³é”®æºæ–‡ä»¶é€‰æ‹©â€œå±æ€§â€ï¼Œç„¶ååœ¨â€œå¸¸è§„â€é‡Œæ£€æŸ¥é¡¹ç±»å‹æ˜¯å¦ä¸ºâ€œMicrosoft Macro Assemblerâ€</p>
<p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-07-05%20233723.png" alt="å¸¸è§„"></p>
</li>
<li><p>ä»¥ä¸Šæ˜¯é’ˆå¯¹æŠ¥é”™è¿›è¡Œçš„å°è¯•ä¿®æ­£æ€»ç»“ï¼Œå¯èƒ½æœ‰å¤šä½™æˆ–è€…ä¸è¶³ä¹‹å¤„</p>
</li>
</ul>
<h2 id="x86æ±‡ç¼–æ¡†æ¶-MASM"><a href="#x86æ±‡ç¼–æ¡†æ¶-MASM" class="headerlink" title="x86æ±‡ç¼–æ¡†æ¶(MASM)"></a>x86æ±‡ç¼–æ¡†æ¶(MASM)</h2><ul>
<li><p>xxxxxxxxxx2Â 1int num[2][2] &#x3D; { {1,2},{3,4} };2printf(â€œ%d,%d,%d,%dâ€, num[0][0], num[0][1], num[1][0], num[1][1]);c</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm"><span class="hljs-comment">;é¢„å¤„ç†</span><br><span class="hljs-meta">.586</span><br><span class="hljs-meta">.model</span> flat,stdcall<br><br><span class="hljs-comment">;åŒ…å«çš„é“¾æ¥åº“</span><br>includelib ucrt<span class="hljs-number">.</span>lib<br>includelib legacy_stdio_definitions<span class="hljs-number">.</span>lib<br>includelib kernel32<span class="hljs-number">.</span>lib<br>includelib user32<span class="hljs-number">.</span>lib<br><br><span class="hljs-comment">;å¤–éƒ¨å‡½æ•°å£°æ˜</span><br><span class="hljs-meta">extern</span> printf:proc<br><br><span class="hljs-comment">;æ•°æ®æ®µ</span><br><span class="hljs-meta">.data</span><br>szHello <span class="hljs-built_in">db</span> <span class="hljs-string">&#x27;HelloWorld!&#x27;</span>,<span class="hljs-number">0</span><br><br><span class="hljs-comment">;ä»£ç æ®µ</span><br><span class="hljs-meta">.code</span><br><span class="hljs-comment">;å‡½æ•°å£°æ˜</span><br>main proc<br>	<span class="hljs-keyword">lea</span> <span class="hljs-built_in">eax</span>,szHello<br>	<span class="hljs-keyword">push</span> <span class="hljs-built_in">eax</span><br>	<span class="hljs-keyword">call</span> printf<br>	<span class="hljs-keyword">add</span> <span class="hljs-built_in">esp</span>,<span class="hljs-number">4</span><br>main endp<br>end<br></code></pre></td></tr></table></figure>

<ul>
<li><p>é‡ç‚¹å¦‚ä¸‹ï¼š</p>
</li>
<li><p>é“¾æ¥åº“å£°æ˜</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm">includelib NameOfLib<span class="hljs-number">.</span>lib<br></code></pre></td></tr></table></figure>
</li>
<li><p>ä¸åŒçš„æ®µ</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.NameOfSection</span><br><span class="hljs-comment">;æ®µæ‰€åŒ…å«çš„æ•°æ®</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>å‡½æ•°æ ¼å¼</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm">functionName proc å‚æ•°å<span class="hljs-number">1</span>:å‚æ•°ç±»å‹ï¼Œå‚æ•°å<span class="hljs-number">2</span>:å‚æ•°ç±»å‹...<br>	<span class="hljs-comment">;æ±‡ç¼–ä»£ç </span><br>functionName endp<br></code></pre></td></tr></table></figure>
</li>
<li><p>åœ¨ä¸€ä¸ªasmæ–‡ä»¶æœ«å°¾ï¼Œéœ€è¦</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm">end			<span class="hljs-comment">;ç”¨äºæ— å…¥å£ç‚¹ï¼Œå³éå¯æ‰§è¡Œæ–‡ä»¶ï¼Œä¸éœ€è¦ä¸»å‡½æ•°æ—¶</span><br>end main	<span class="hljs-comment">;ç”¨äºå¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¿…é¡»æŒ‡å®šå…¥å£ç‚¹(å¦‚mainå‡½æ•°)æ—¶</span><br></code></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h2 id="æ•°æ®ç±»å‹"><a href="#æ•°æ®ç±»å‹" class="headerlink" title="æ•°æ®ç±»å‹"></a>æ•°æ®ç±»å‹</h2><table>
<thead>
<tr>
<th align="center">ç±»å‹åç§°</th>
<th align="center">ç®€å†™</th>
<th align="center">å¯¹åº”ç±»å‹</th>
<th align="center">å ç”¨å­—èŠ‚æ•°</th>
</tr>
</thead>
<tbody><tr>
<td align="center">BYTE</td>
<td align="center">db</td>
<td align="center">char</td>
<td align="center">1</td>
</tr>
<tr>
<td align="center">WORD</td>
<td align="center">dw</td>
<td align="center">short</td>
<td align="center">2</td>
</tr>
<tr>
<td align="center">DWORD</td>
<td align="center">dd</td>
<td align="center">int</td>
<td align="center">4</td>
</tr>
<tr>
<td align="center">QWORD</td>
<td align="center">dq</td>
<td align="center">long long</td>
<td align="center">8</td>
</tr>
</tbody></table>
<h2 id="åŸºæœ¬è¿ç®—"><a href="#åŸºæœ¬è¿ç®—" class="headerlink" title="åŸºæœ¬è¿ç®—"></a>åŸºæœ¬è¿ç®—</h2><ul>
<li><p>æ•°æ®ä¼ é€æŒ‡ä»¤</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm"><span class="hljs-keyword">mov</span> dest,src		<span class="hljs-comment">;dest=src</span><br><br><span class="hljs-comment">;eax=1ç¤ºä¾‹</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">eax</span>,<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>åœ°å€ä¼ é€æŒ‡ä»¤</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm"><span class="hljs-keyword">lea</span> dest,[addr]		<span class="hljs-comment">;dest=addr</span><br><br><span class="hljs-comment">;eax=77E75F38ç¤ºä¾‹</span><br><span class="hljs-keyword">lea</span> <span class="hljs-built_in">eax</span>,77E75F38<br></code></pre></td></tr></table></figure>
</li>
<li><p>åŠ æ³•</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm"><span class="hljs-keyword">add</span> dest,src	<span class="hljs-comment">;dest=dest+src</span><br><br><span class="hljs-comment">;1+1=2ç¤ºä¾‹ï¼Œæœ€åeaxé‡Œä¸º2</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">eax</span>,<span class="hljs-number">1</span><br><span class="hljs-keyword">add</span> <span class="hljs-built_in">eax</span>,<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>è‡ªå¢</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm"><span class="hljs-keyword">inc</span> dest		<span class="hljs-comment">;dest=dest+1</span><br><br><span class="hljs-comment">;eax++ç¤ºä¾‹</span><br><span class="hljs-keyword">inc</span> <span class="hljs-built_in">eax</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>å‡æ³•</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm"><span class="hljs-keyword">sub</span> dest,src	<span class="hljs-comment">;dest=dest-src</span><br><br><span class="hljs-comment">;6-2=4ç¤ºä¾‹ï¼Œæœ€åeaxé‡Œä¸º4</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">eax</span>,<span class="hljs-number">6</span><br><span class="hljs-keyword">sub</span> <span class="hljs-built_in">eax</span>,<span class="hljs-number">2</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>è‡ªå‡</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm"><span class="hljs-keyword">dec</span> dest		<span class="hljs-comment">;dest=dest-1</span><br><br><span class="hljs-comment">;eax--ç¤ºä¾‹</span><br><span class="hljs-keyword">dec</span> <span class="hljs-built_in">eax</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>ä¹˜æ³•</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm"><span class="hljs-comment">;åˆ†ä¸ºmul(æ— ç¬¦å·)å’Œimul(æœ‰ç¬¦å·)</span><br><span class="hljs-comment">;ä¹˜æ³•ç»“æœå­˜æ”¾åœ¨edxå’Œeaxä¸­(edx:eax)ï¼Œä½ä½eaxï¼Œé«˜ä½edxã€‚æœªæŒ‡å®šæ—¶ï¼Œeaxé»˜è®¤ä½œä¸ºä¸€ä¸ªå› æ•°</span><br><span class="hljs-keyword">mul</span> src				<span class="hljs-comment">;edx:eax=eax*src</span><br><span class="hljs-keyword">imul</span> src			<span class="hljs-comment">;edx:eax=eax*src</span><br><span class="hljs-keyword">imul</span> dest,src		<span class="hljs-comment">;dest=dest*src</span><br><span class="hljs-keyword">imul</span> dest,src,imm	<span class="hljs-comment">;dest=src*imm</span><br><br><span class="hljs-comment">;4*2=8ç¤ºä¾‹ï¼Œeax*ebx</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">eax</span>,<span class="hljs-number">4</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ebx</span>,<span class="hljs-number">2</span><br><span class="hljs-keyword">mul</span> <span class="hljs-built_in">ebx</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>é™¤æ³•</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm"><span class="hljs-comment">;åˆ†ä¸ºdiv(æ— ç¬¦å·)å’Œidiv(æœ‰ç¬¦å·)</span><br><span class="hljs-comment">;è¢«é™¤æ•°æ”¾åœ¨edx:eaxä¸­ï¼Œé™¤æ•°ä»»æ„ï¼Œå•†å­˜æ”¾åœ¨eaxä¸­ï¼Œä½™æ•°å­˜æ”¾åœ¨edxä¸­</span><br><span class="hljs-keyword">div</span> src			<span class="hljs-comment">;edx:eax%src=eax...edx</span><br><span class="hljs-keyword">idiv</span> src		<span class="hljs-comment">;edx:eax%src=eax...edx</span><br><br><span class="hljs-comment">;101%2...1ç¤ºä¾‹</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">eax</span>,<span class="hljs-number">101</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">edx</span>,<span class="hljs-number">0</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ebx</span>,<span class="hljs-number">2</span><br><span class="hljs-keyword">div</span> <span class="hljs-built_in">ebx</span><br></code></pre></td></tr></table></figure></li>
</ul>
<h2 id="ä½è¿ç®—"><a href="#ä½è¿ç®—" class="headerlink" title="ä½è¿ç®—"></a>ä½è¿ç®—</h2><ul>
<li><p>ä¸</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm"><span class="hljs-keyword">and</span> dest,src		<span class="hljs-comment">;dest=dest &amp; src</span><br><br><span class="hljs-comment">;1&amp;2=0ç¤ºä¾‹</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">eax</span>,<span class="hljs-number">1</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ebx</span>,<span class="hljs-number">2</span><br><span class="hljs-keyword">and</span> <span class="hljs-built_in">eax</span>,<span class="hljs-built_in">ebx</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>æˆ–</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm"><span class="hljs-keyword">or</span> dest,src			<span class="hljs-comment">;dest=dest | src</span><br><br><span class="hljs-comment">;1|2=3ç¤ºä¾‹</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">eax</span>,<span class="hljs-number">1</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ebx</span>,<span class="hljs-number">2</span><br><span class="hljs-keyword">or</span> <span class="hljs-built_in">eax</span>,<span class="hljs-built_in">ebx</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>å–å</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm"><span class="hljs-keyword">not</span> dest			<span class="hljs-comment">;dest=~dest</span><br><br><span class="hljs-comment">;not 00000001=11111110ç¤ºä¾‹</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">eax</span>,<span class="hljs-number">1</span><br><span class="hljs-keyword">not</span> <span class="hljs-built_in">eax</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>å¼‚æˆ–</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm"><span class="hljs-keyword">xor</span> dest,src		<span class="hljs-comment">;dest=dest^src</span><br><br><span class="hljs-comment">;1^2=3ç¤ºä¾‹</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">eax</span>,<span class="hljs-number">1</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ebx</span>,<span class="hljs-number">2</span><br><span class="hljs-keyword">xor</span> <span class="hljs-built_in">eax</span>,<span class="hljs-built_in">ebx</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>å·¦ç§»ï¼Œå³ç§»</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm"><span class="hljs-comment">;å·¦ç§»</span><br><span class="hljs-keyword">shl</span> dest,count		<span class="hljs-comment">;dest=dest&lt;&lt;count</span><br><br><span class="hljs-comment">;1&lt;&lt;3=8ç¤ºä¾‹</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">eax</span>,<span class="hljs-number">1</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">cl</span>,<span class="hljs-number">3</span><br><span class="hljs-keyword">shl</span> <span class="hljs-built_in">eax</span>,<span class="hljs-built_in">cl</span><br><br><span class="hljs-comment">;å³ç§»</span><br><span class="hljs-keyword">shr</span> dest,count		<span class="hljs-comment">;dest=dest&gt;&gt;count</span><br><br><span class="hljs-comment">;8&gt;&gt;3=1ç¤ºä¾‹</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">eax</span>,<span class="hljs-number">8</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">cl</span>,<span class="hljs-number">3</span><br><span class="hljs-keyword">shr</span> <span class="hljs-built_in">eax</span>,<span class="hljs-built_in">cl</span><br></code></pre></td></tr></table></figure></li>
</ul>
]]></content>
      <categories>
        <category>Reverseå­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>Reverse</tag>
      </tags>
  </entry>
  <entry>
    <title>Day10:å£³ä¸è„±å£³ï¼ˆäºŒï¼‰</title>
    <url>/2025/07/30/Day10-%E5%A3%B3%E4%B8%8E%E8%84%B1%E5%A3%B3%EF%BC%88%E4%BA%8C%EF%BC%89/</url>
    <content><![CDATA[<p>äºŒæ¬¡æ–­ç‚¹æ³•ã€ä¸€æ¬¡æ–­ç‚¹æ³•ã€ç‰¹å¾æŸ¥æ‰¾æ³•ï¼ˆå‡åŸºäºXdbgï¼‰ã€Dllæ‰‹åŠ¨è„±å£³</p>
<span id="more"></span>

<h2 id="å¯»æ‰¾OEPçš„æ–¹æ³•ï¼ˆäºŒï¼‰"><a href="#å¯»æ‰¾OEPçš„æ–¹æ³•ï¼ˆäºŒï¼‰" class="headerlink" title="å¯»æ‰¾OEPçš„æ–¹æ³•ï¼ˆäºŒï¼‰"></a>å¯»æ‰¾OEPçš„æ–¹æ³•ï¼ˆäºŒï¼‰</h2><h3 id="äºŒæ¬¡æ–­ç‚¹æ³•"><a href="#äºŒæ¬¡æ–­ç‚¹æ³•" class="headerlink" title="äºŒæ¬¡æ–­ç‚¹æ³•"></a>äºŒæ¬¡æ–­ç‚¹æ³•</h3><ul>
<li><p>åˆå«å†…å­˜é•œåƒæ³•ï¼ŒåŸç†æ˜¯å£³ç¨‹åºè§£ææ—¶ä¼šä».rsrcæ®µè·å–èµ„æºï¼Œè§£æåå›åˆ°ä»£ç æ®µï¼Œå› æ­¤å¯ä»¥é€šè¿‡ç°åœ¨.rsrcæ®µè®¾ç½®å†…å­˜è¯»å–æ–­ç‚¹ï¼Œç„¶ååœ¨ä»£ç æ®µ(.text&#x2F;.code)è®¾ç½®å†…å­˜å†™å…¥æ–­ç‚¹æ¥ç›‘æ§å£³ç¨‹åºæ‰§è¡Œã€‚</p>
</li>
<li><p>é€šå¸¸è¿™ä¸ªæ–¹æ³•æ˜¯åŸºäºOllyDbgçš„ï¼Œä½†æ˜¯ä»åŸç†å‡ºå‘Xdbgä¹Ÿä¸æ˜¯ä¸èƒ½ç”¨ã€‚é™¤äº†æœ‰ä¸€æ­¥æ˜¯åœ¨OllyDbgä¸­è®¾ç½®å¿½ç•¥æ‰€æœ‰å¼‚å¸¸ï¼ŒXdbgå¥½åƒæ²¡æœ‰è¿™ä¸ªè®¾ç½®é€‰é¡¹ï¼Œä½†æ˜¯ç»è¿‡å®æµ‹æ˜¯å¯ä»¥ç”¨è¿™ä¸ªæ–¹æ³•åœ¨Xdbgè„±upxå£³çš„ã€‚</p>
</li>
<li><p>Upxè„±å£³ç¤ºä¾‹ï¼š</p>
<ul>
<li><p>Xdbgè½½å…¥ç¨‹åºï¼Œå…ˆåœ¨â€œæ–­ç‚¹â€æ¨¡å—æŠŠé¢„è®¾çš„æ–­ç‚¹åˆ é™¤ï¼Œé¿å…ç¨‹åºåœ¨éå…³æ³¨çš„å¼‚å¸¸å¤„ï¼ˆæ–­ç‚¹å¤„ï¼‰åœä¸‹</p>
<p><img src="/../images/image-20250730155018782.png" alt="ç§»é™¤æ–­ç‚¹"></p>
</li>
<li><p>ç„¶ååˆ°â€œå†…å­˜æ˜ å°„â€æ¨¡å—æ‰¾åˆ°ç¨‹åºçš„.rsrcï¼ˆæ³¨æ„æ‰€å±æ–¹ä¸ºç”¨æˆ·ï¼‰ï¼Œä¸‹ä¸€æ¬¡æ€§å†…å­˜è¯»å–æ–­ç‚¹</p>
<p><img src="/../images/image-20250730155602928.png" alt="ä¸‹å†…å­˜è¯»å–æ–­ç‚¹"></p>
</li>
<li><p>shift+F9è¿è¡Œï¼Œç„¶ååœ¨ä¸Šæ–¹çš„upx0å¤„ä¸‹ä¸€æ¬¡æ€§å†…å­˜å†™å…¥æ–­ç‚¹</p>
<p><img src="/../images/image-20250730155656485.png" alt="ä¸‹å†…å­˜å†™å…¥æ–­ç‚¹"></p>
</li>
<li><p>shift+F9è¿è¡Œï¼Œå›åˆ°â€œCPUâ€æ¨¡å—ï¼Œä¼šå‘ç°ä¸‹æ–¹ä¸è¿œå¤„å°±æœ‰ä¸€ä¸ªå¤§è·³ï¼ˆéš”å¾—æœ‰ç‚¹è¿œæˆªä¸åˆ°eipå’Œå¤§è·³çš„åŒæ¡†å›¾ï¼‰ï¼Œåœ¨å¤§è·³å‰ä¸‹æ–­ç‚¹ï¼ŒF9è¿è¡Œåˆ°æ–­ç‚¹å¤„ï¼Œç„¶åæ­¥è¿›å°±å¯ä»¥åˆ°è¾¾OEPäº†</p>
</li>
</ul>
</li>
<li><p>ä½†æ˜¯æœ‰ä¸€ç‚¹å¥‡æ€ªçš„åœ°æ–¹ï¼šç»“åˆupxçš„è§£æåŸç†ï¼Œupxå¥½åƒæ˜¯ä»upx1æ®µåŠ è½½æ•°æ®è§£æåˆ°upx0æ®µçš„ï¼ˆAIè¯´çš„ï¼Œä¸ç¡®å®šå¯¹ä¸å¯¹ï¼‰ï¼Œæ‰€ä»¥æŒ‰é“ç†ï¼Œåœ¨upx1å¤„ä¸‹å†…å­˜è¯»å–æ–­ç‚¹ä¸æ˜¯ä¹Ÿæœ‰ç±»ä¼¼çš„ç›‘æ§æ•ˆæœå—ï¼Ÿä½†æ˜¯å®æµ‹è¿™æ ·å­ä¼šè·‘é£ğŸ¤”æœ‰è¿‡ä¸€ä¸ªæƒ³æ³•å°±æ˜¯ï¼Œå› ä¸ºåœ¨upx1æ®µä¸‹äº†è¯»å–æ–­ç‚¹ï¼Œå£³ç¨‹åºè§£æå‰ä¸­æ–­äº†ï¼Œç„¶ååˆåœ¨upx0æ®µä¸‹å†™å…¥æ–­ç‚¹ï¼Œç„¶åæŒ‰é“ç†åº”è¯¥åœåœ¨è§£æç„¶åå†™å…¥è¿™ä¸€æ­¥ï¼Œå°±æ˜¯è§£æäº†è¿˜æ²¡å†™å…¥ï¼Œæˆ–è€…è¯´åˆšåˆšå†™å…¥ä¸€æ¬¡ï¼Œé‚£è¿™æ ·ä¹Ÿä¸è‡³äºç›´æ¥è°ƒè¯•ç»ˆæ­¢å§ğŸ¤”</p>
</li>
</ul>
<h3 id="ä¸€æ¬¡æ–­ç‚¹æ³•ï¼ˆäºŒæ¬¡æ–­ç‚¹æ³•plus"><a href="#ä¸€æ¬¡æ–­ç‚¹æ³•ï¼ˆäºŒæ¬¡æ–­ç‚¹æ³•plus" class="headerlink" title="ä¸€æ¬¡æ–­ç‚¹æ³•ï¼ˆäºŒæ¬¡æ–­ç‚¹æ³•plus)"></a>ä¸€æ¬¡æ–­ç‚¹æ³•ï¼ˆäºŒæ¬¡æ–­ç‚¹æ³•plus)</h3><ul>
<li><p>è¿™ä¸ªæ–¹æ³•æ˜¯åŸºäºäºŒæ¬¡æ–­ç‚¹æ³•å’Œupxå®æµ‹å‡ºæ¥çš„ï¼Œå› ä¸ºæ ¹æ®å£³ç¨‹åºè§£æçš„åŸç†ï¼Œæœ€ç»ˆéƒ½ä¼šå‘ç”Ÿå‘å†…å­˜å†™å…¥è§£æå®Œçš„æ•°æ®çš„æ“ä½œï¼Œæ‰€ä»¥ç›´æ¥åœ¨å†™å…¥çš„åœ°æ–¹ä¸‹å†…å­˜å†™å…¥æ–­ç‚¹ï¼Œè¿™æ ·è°ƒè¯•å™¨ä¸­æ–­çš„åœ°æ–¹å°±ç¦»OEPä¸è¿œäº†ï¼ˆæ¥è¿‘å£³ç¨‹åºè§£æçš„å°¾å£°ï¼Œä½†è¿˜æ˜¯è¿œåˆ°æˆªä¸åˆ°eipå’Œå¤§è·³çš„åŒæ¡†å›¾ï¼‰</p>
</li>
<li><p>ç¤ºä¾‹</p>
<ul>
<li><p>é¦–å…ˆï¼ŒåŒæ ·è¦å…ˆå»æ‰é¢„è®¾æ–­ç‚¹</p>
<p><img src="/../images/image-20250730163429021.png" alt="å»æ‰é¢„è®¾æ–­ç‚¹"></p>
</li>
<li><p>ç„¶ååœ¨â€œå†…å­˜æ˜ å°„â€æ¨¡å—ç»™upx0ä¸‹ä¸€æ¬¡æ€§å†…å­˜å†™å…¥æ–­ç‚¹&#x2F;ç»™upx1ä¸‹ä¸€æ¬¡æ€§å†…å­˜è¯»å–æ–­ç‚¹</p>
<p><img src="/../images/image-20250730164034182.png" alt="ä¸‹å†…å­˜å†™å…¥æ–­ç‚¹"></p>
</li>
<li><p>shift+F9è¿è¡Œï¼Œä¸­æ–­çš„åœ°æ–¹å°±å·®ä¸å¤šæ˜¯å£³ç¨‹åºè§£æå†™å…¥&#x2F;å¼€å§‹è§£æçš„åœ°æ–¹äº†ï¼Œåœ¨ä¸‹æ–¹å¤§è·³å‰F2æ–­ç‚¹+F9è¿è¡Œä¸€æ­¥åˆ°ä½ï¼Œç„¶åå°±å¯ä»¥è·³è½¬åˆ°OEPäº†</p>
</li>
</ul>
</li>
</ul>
<h3 id="ç‰¹å¾æŸ¥æ‰¾æ³•"><a href="#ç‰¹å¾æŸ¥æ‰¾æ³•" class="headerlink" title="ç‰¹å¾æŸ¥æ‰¾æ³•"></a>ç‰¹å¾æŸ¥æ‰¾æ³•</h3><ul>
<li><p>å€ŸåŠ©ç‰¹å¾æŒ‡ä»¤popadï¼Œåœ¨ç¨‹åºåŒºåŸŸæœç´¢æŒ‡ä»¤ï¼Œç„¶åä¸‹æ–­ç‚¹è¿è¡Œè‡³æ­¤ï¼Œå†æ¥ç€è¿è¡Œåˆ°OEPå¤„</p>
</li>
<li><p>ç¤ºä¾‹ï¼š</p>
<ul>
<li><p>F9è¿è¡Œåˆ°ç¨‹åºåŒºåŸŸï¼Œæ­¤æ—¶æ–­åœ¨pushad</p>
<p><img src="/../images/image-20250730165414432.png" alt="F9è¿è¡Œ"></p>
</li>
<li><p>å³é”®åœ¨å½“å‰åŒºåŸŸæœç´¢å‘½ä»¤popad</p>
<p><img src="/../images/image-20250730165457171.png" alt="æœç´¢"></p>
</li>
<li><p>åŒå‡»æœç´¢ç»“æœè·³è½¬ï¼Œä¸‹æ–¹ä¸è¿œå¤„å°±æ˜¯åˆ°OEPçš„å¤§è·³äº†ã€‚ç›´æ¥åœ¨jmpå‰ä¸€æ¡æŒ‡ä»¤ä¸‹æ–­ç‚¹ï¼ŒF9åˆ°æ­¤ï¼Œç„¶åæ­¥è¿›</p>
<p><img src="/../images/image-20250730165636809.png" alt="æœç´¢ç»“æœ"></p>
</li>
</ul>
</li>
</ul>
<h2 id="Dllæ‰‹åŠ¨è„±å£³"><a href="#Dllæ‰‹åŠ¨è„±å£³" class="headerlink" title="Dllæ‰‹åŠ¨è„±å£³"></a>Dllæ‰‹åŠ¨è„±å£³</h2><ul>
<li><p>è‹¥å‡ºç°Dllç¨‹åºåŠ å£³çš„æƒ…å†µï¼Œå¯ä»¥å…ˆæŠŠDllç¨‹åºè½¬åŒ–æˆexeç¨‹åºï¼Œç„¶åä½¿ç”¨å’Œexeæ‰‹åŠ¨è„±å£³ä¸€æ ·çš„æ­¥éª¤å³å¯</p>
</li>
<li><p>ç¤ºä¾‹ï¼š</p>
<ul>
<li><p>ç”¨DIEæ‰“å¼€Dllç¨‹åºï¼Œå¯ä»¥çœ‹åˆ°æ˜¾ç¤ºåŠ äº†upxå£³</p>
<p><img src="/../images/image-20250730224157270.png" alt="DIEæŸ¥çœ‹"></p>
</li>
<li><p>ç‚¹å‡»â€œåŒºå—â€ä¸‹æ–¹çš„â€œ&gt;â€ï¼Œæ‰“å¼€æ–‡ä»¶ç»“æ„ç•Œé¢</p>
<p><img src="/../images/image-20250730224231764.png" alt="æ–‡ä»¶ç»“æ„é¡µé¢"></p>
</li>
<li><p>å–æ¶ˆå‹¾é€‰å³ä¸Šè§’â€åªè¯»â€œï¼Œç„¶åç‚¹å‡»IMAGE_FILE_HEADERï¼Œå–æ¶ˆå‹¾é€‰â€æ ‡å¿—â€œä¸­çš„â€Dllâ€œï¼ˆå›¾ä¸­æœªå–æ¶ˆï¼‰</p>
<p><img src="/../images/image-20250730224435928.png" alt="å–æ¶ˆå‹¾é€‰Dll"></p>
<p>æ­¤æ—¶å¯ä»¥å‘ç°ï¼ŒCharacteristicsçš„å€¼å˜äº†</p>
</li>
<li><p>ç„¶åæŠŠdllåç¼€æ”¹æˆexeå°±å¯ä»¥æŒ‰ç…§exeæ‰‹åŠ¨è„±å£³çš„æ­¥éª¤è¿›è¡Œè„±å£³äº†</p>
</li>
</ul>
</li>
</ul>
]]></content>
      <categories>
        <category>Reverseå­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>Reverse</tag>
      </tags>
  </entry>
  <entry>
    <title>0xGame2025Week3WriteUp</title>
    <url>/2025/10/28/0xGame2025Week3ReverseWriteUp/</url>
    <content><![CDATA[<p>0xGame2025 Week3 Reverseæ–¹å‘å…¨è§£&amp;è¯¦è§£</p>
<span id="more"></span>

<h2 id="easyApp"><a href="#easyApp" class="headerlink" title="easyApp"></a>easyApp</h2><blockquote>
<p>è€ƒç‚¹ï¼šapké€†å‘ã€å·¥å…·åº”ç”¨ã€base64ç¼–ç è§£ç ã€z3æ±‚è§£</p>
</blockquote>
<ul>
<li><p>é™„ä»¶ç¨‹åºæ˜¯ä¸ªapkï¼Œåœ¨æ¨¡æ‹Ÿå™¨ä¸­è¿è¡Œå¦‚å›¾ï¼Œæ¨æµ‹æŒ‰é’®ä¼šè§¦å‘flagæ£€éªŒé€»è¾‘ï¼š</p>
<p><img src="/../images/image-20251028215843640.png" alt="æ¨¡æ‹Ÿå™¨è¿è¡Œ"></p>
</li>
<li><p>ç”¨JEBæ‰“å¼€apkï¼Œæ‰¾åˆ°MainActivityå¹¶å³é”®è§£æåï¼Œå¾—åˆ°JAVAä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.example.easyapp;<br><br><span class="hljs-keyword">import</span> android.content.Context;<br><span class="hljs-keyword">import</span> android.os.Bundle;<br><span class="hljs-keyword">import</span> android.util.Base64;<br><span class="hljs-keyword">import</span> android.view.View;<br><span class="hljs-keyword">import</span> android.widget.Button;<br><span class="hljs-keyword">import</span> android.widget.EditText;<br><span class="hljs-keyword">import</span> android.widget.Toast;<br><span class="hljs-keyword">import</span> androidx.activity.ComponentActivity;<br><span class="hljs-keyword">import</span> dalvik.system.DexClassLoader;<br><span class="hljs-keyword">import</span> java.io.File;<br><span class="hljs-keyword">import</span> java.io.FileOutputStream;<br><span class="hljs-keyword">import</span> java.io.InputStream;<br><span class="hljs-keyword">import</span> java.io.OutputStream;<br><span class="hljs-keyword">import</span> java.lang.reflect.Method;<br><span class="hljs-keyword">import</span> kotlin.Metadata;<br><span class="hljs-keyword">import</span> kotlin.collections.ArraysKt;<br><span class="hljs-keyword">import</span> kotlin.io.ByteStreamsKt;<br><span class="hljs-keyword">import</span> kotlin.jvm.functions.Function1;<br><span class="hljs-keyword">import</span> kotlin.jvm.internal.Intrinsics;<br><span class="hljs-keyword">import</span> kotlin.text.Charsets;<br><span class="hljs-keyword">import</span> kotlin.text.StringsKt;<br><br><span class="hljs-meta">@Metadata(d1 = &#123;&quot;\u0000\&quot;\n\u0002\u0018\u0002\n\u0002\u0018\u0002\n\u0002\b\u0002\n\u0002\u0010\u0002\n\u0000\n\u0002\u0018\u0002\n\u0000\n\u0002\u0010\u000E\n\u0002\u0010\u0012\n\u0000\b\u0007\u0018\u00002\u00020\u0001B\u0005Â¢\u0006\u0002\u0010\u0002J\u0012\u0010\u0003\u001A\u00020\u00042\b\u0010\u0005\u001A\u0004\u0018\u00010\u0006H\u0014J\f\u0010\u0007\u001A\u00020\b*\u00020\tH\u0002Â¨\u0006\n&quot;&#125;, d2 = &#123;&quot;Lcom/example/easyapp/MainActivity;&quot;, &quot;Landroidx/activity/ComponentActivity;&quot;, &quot;()V&quot;, &quot;onCreate&quot;, &quot;&quot;, &quot;savedInstanceState&quot;, &quot;Landroid/os/Bundle;&quot;, &quot;toHexString&quot;, &quot;&quot;, &quot;&quot;, &quot;app_release&quot;&#125;, k = 1, mv = &#123;1, 9, 0&#125;, xi = 0x30)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ComponentActivity</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> $stable;<br><br>    <span class="hljs-keyword">static</span> &#123;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span>  <span class="hljs-comment">// androidx.activity.ComponentActivity</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(Bundle arg3)</span> &#123;<br>        <span class="hljs-built_in">super</span>.onCreate(arg3);<br>        <span class="hljs-built_in">this</span>.setContentView(layout.activity_main);<br>        <span class="hljs-type">EditText</span> <span class="hljs-variable">v3</span> <span class="hljs-operator">=</span> (EditText)<span class="hljs-built_in">this</span>.findViewById(id.flagInput);<br>        ((Button)<span class="hljs-built_in">this</span>.findViewById(id.button)).setOnClickListener((View arg2) -&gt; MainActivity.onCreate$lambda$<span class="hljs-number">0</span>(v3, <span class="hljs-built_in">this</span>, arg2));  <span class="hljs-comment">// è¿™é‡Œå°†Clickå’ŒonCreate$lambda$0ç»‘å®šèµ·æ¥äº†</span><br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> onCreate$lambda$<span class="hljs-number">0</span>(EditText arg6, MainActivity arg7, View arg8) &#123;<br>        <span class="hljs-type">boolean</span> v6_4;  <span class="hljs-comment">// v8_1çš„è¿”å›å€¼æµå‘v6_4</span><br>        Intrinsics.checkNotNullParameter(arg7, <span class="hljs-string">&quot;this$0&quot;</span>);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">v6</span> <span class="hljs-operator">=</span> arg6.getText().toString();  <span class="hljs-comment">// v6å­˜æ”¾äº†è¾“å…¥çš„flag</span><br>        <span class="hljs-type">File</span> <span class="hljs-variable">v8</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(arg7.getCacheDir(), <span class="hljs-string">&quot;dex.zip&quot;</span>);<br>        <span class="hljs-type">InputStream</span> <span class="hljs-variable">v0</span> <span class="hljs-operator">=</span> arg7.getAssets().open(<span class="hljs-string">&quot;dex.zip&quot;</span>);  <span class="hljs-comment">// æ‰“å¼€äº†asset/dex.zip</span><br>        Intrinsics.checkNotNullExpressionValue(v0, <span class="hljs-string">&quot;open(...)&quot;</span>);<br>        ByteStreamsKt.copyTo$<span class="hljs-keyword">default</span>(v0, ((OutputStream)<span class="hljs-keyword">new</span> <span class="hljs-title class_">FileOutputStream</span>(v8)), <span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-literal">null</span>);<br>        <span class="hljs-keyword">if</span>(v6.length() == <span class="hljs-number">42</span>) &#123;<br>            <span class="hljs-type">Method</span> <span class="hljs-variable">v8_1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DexClassLoader</span>(v8.getAbsolutePath(), arg7.getCacheDir().getAbsolutePath(), <span class="hljs-literal">null</span>, arg7.getClassLoader()).loadClass(<span class="hljs-string">&quot;com.example.easyapp.Secret&quot;</span>).getDeclaredMethod(<span class="hljs-string">&quot;check&quot;</span>, String.class);  <span class="hljs-comment">// v8æŒ‡å‘äº†dexä¸­çš„com.example.easyapp.Secretçš„checkæ–¹æ³•</span><br>            <span class="hljs-type">String</span> <span class="hljs-variable">v1</span> <span class="hljs-operator">=</span> v6.substring(<span class="hljs-number">0</span>, <span class="hljs-number">26</span>);  <span class="hljs-comment">// flagè¢«æˆªæ–­ï¼Œæˆªæ–­çš„éƒ¨åˆ†æµå‘v1</span><br>            Intrinsics.checkNotNullExpressionValue(v1, <span class="hljs-string">&quot;this as java.lang.Stringâ€¦ing(startIndex, endIndex)&quot;</span>);<br>            <span class="hljs-type">byte</span>[] v1_1 = v1.getBytes(Charsets.UTF_8);  <span class="hljs-comment">// flagæˆªæ–­éƒ¨åˆ†æµå‘v1_1</span><br>            Intrinsics.checkNotNullExpressionValue(((Object)v1_1), <span class="hljs-string">&quot;this as java.lang.String).getBytes(charset)&quot;</span>);<br>            <span class="hljs-type">String</span> <span class="hljs-variable">v1_2</span> <span class="hljs-operator">=</span> Base64.encodeToString(v1_1, <span class="hljs-number">0</span>);  <span class="hljs-comment">// flagæˆªæ–­éƒ¨åˆ†è¢«è¿›è¡Œäº†baseç¼–ç ï¼Œæµå‘v1_2</span><br>            Intrinsics.checkNotNullExpressionValue(v1_2, <span class="hljs-string">&quot;encodeToString(...)&quot;</span>);<br>            <span class="hljs-type">String</span> <span class="hljs-variable">v1_3</span> <span class="hljs-operator">=</span> StringsKt.trim(((CharSequence)v1_2)).toString();  <span class="hljs-comment">// ç¼–ç åçš„flagæˆªæ–­éƒ¨åˆ†æµå‘v1_3</span><br>            <span class="hljs-type">String</span> <span class="hljs-variable">v6_1</span> <span class="hljs-operator">=</span> v6.substring(<span class="hljs-number">26</span>);  <span class="hljs-comment">// flagçš„å‰©ä½™éƒ¨åˆ†æµå‘äº†v6_1</span><br>            Intrinsics.checkNotNullExpressionValue(v6_1, <span class="hljs-string">&quot;this as java.lang.String).substring(startIndex)&quot;</span>);<br>            <span class="hljs-type">byte</span>[] v6_2 = v6_1.getBytes(Charsets.UTF_8);  <span class="hljs-comment">// flagçš„å‰©ä½™éƒ¨åˆ†ä»v6_1æµå‘äº†v6_2</span><br>            Intrinsics.checkNotNullExpressionValue(((Object)v6_2), <span class="hljs-string">&quot;this as java.lang.String).getBytes(charset)&quot;</span>);<br>            <span class="hljs-keyword">if</span>(v1_3.equals(<span class="hljs-string">&quot;MHhHYW1le0RvX3kwdV9sMHYzX2FuZHIwMWQ=&quot;</span>)) &#123;  <span class="hljs-comment">// æ­¤å¤„ä¸ºv1_3çš„æ£€éªŒé€»è¾‘</span><br>                <span class="hljs-type">Object</span> <span class="hljs-variable">v6_3</span> <span class="hljs-operator">=</span> v8_1.invoke(<span class="hljs-literal">null</span>, arg7.toHexString(v6_2));  <span class="hljs-comment">// v6_2ç»è¿‡toHexStringå¤„ç†åä½œä¸ºv8_1ï¼Œå³dex:com.example.easyapp.Secret.checkçš„å‚æ•°</span><br>                Intrinsics.checkNotNull(v6_3, <span class="hljs-string">&quot;null cannot be cast to non-null type kotlin.Boolean&quot;</span>);<br>                v6_4 = ((Boolean)v6_3).booleanValue();  <span class="hljs-comment">// v8_1çš„è¿”å›å€¼æµå‘v6_4</span><br>            &#125;<br>            <span class="hljs-keyword">else</span> &#123;<br>                v6_4 = <span class="hljs-literal">false</span>;<br>            &#125;<br><br>            <span class="hljs-keyword">if</span>(v6_4) &#123;  <span class="hljs-comment">// v6_4å†³å®šäº†æœ€åçš„è¾“å‡ºï¼šRight/Oh no no</span><br>                Toast.makeText(((Context)arg7), <span class="hljs-string">&quot;Right!&quot;</span>, <span class="hljs-number">0</span>).show();<br>                <span class="hljs-keyword">return</span>;<br>            &#125;<br><br>            Toast.makeText(((Context)arg7), <span class="hljs-string">&quot;Oh no no&quot;</span>, <span class="hljs-number">0</span>).show();<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br><br>        Toast.makeText(((Context)arg7), <span class="hljs-string">&quot;Length wrong!&quot;</span>, <span class="hljs-number">0</span>).show();<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String <span class="hljs-title function_">toHexString</span><span class="hljs-params">(<span class="hljs-type">byte</span>[] arg11)</span> &#123;<br>        <span class="hljs-keyword">return</span> ArraysKt.joinToString$<span class="hljs-keyword">default</span>(arg11, <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, <span class="hljs-number">0</span>, <span class="hljs-literal">null</span>, ((Function1)MainActivity.toHexString<span class="hljs-number">.1</span>.INSTANCE), <span class="hljs-number">30</span>, <span class="hljs-literal">null</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°ï¼Œflagè¢«æ‹†åˆ†æˆä¸¤éƒ¨åˆ†è¿›è¡Œæ£€éªŒï¼Œå‰26ä¸ªå­—ç¬¦ç»è¿‡base64ç¼–ç åä¸â€MHhHYW1le0RvX3kwdV9sMHYzX2FuZHIwMWQ&#x3D;â€æ¯”å¯¹ï¼Œå‰©ä¸‹éƒ¨åˆ†ç”±dexä¸­çš„com.example.easyapp.Secret.checkæ–¹æ³•æ£€éªŒã€‚ç¬¬ä¸€éƒ¨åˆ†å¯ä»¥å€ŸåŠ©<a href="https://cyberchef.org/">CyberChef</a>è§£å¯†ï¼š</p>
<p><img src="/../images/image-20251023214651101.png" alt="ç¬¬ä¸€éƒ¨åˆ†flag"></p>
</li>
<li><p>ç°åœ¨æ¥åˆ†æflagç¬¬äºŒéƒ¨åˆ†çš„æ£€éªŒã€‚åœ¨JEBå·¦ä¸Šè§’å·¥ç¨‹æµè§ˆå™¨ä¸­æ‰¾åˆ°asset&#x2F;dex.zip&#x2F;dex.bin</p>
<p><img src="/../images/image-20251024093910480.png" alt="æ‰¾åˆ°dex.bin"></p>
<p>Secretç±»è§£æåå¾—åˆ°ï¼š</p>
<p><img src="/../images/image-20251023215359432.png" alt="Secretç±»"></p>
<p>å…¶ä¸­checkçš„é€»è¾‘ç­‰ä»·ä¸ºä¸€ä¸ªä¸‰å…ƒä¸€æ¬¡å¤§æ•°æ–¹ç¨‹ç»„ï¼Œä¸‰ä¸ªå…ƒä»flagçš„ç¬¬äºŒéƒ¨åˆ†æˆªå–ï¼š</p>
<p>v0 &#x3D; substring(flagPart2[0:16])<br>v3 &#x3D; substring(flagPart2[8:24])<br>v4 &#x3D; substring(flagPart2:[16:32])</p>
<p>v3 + 3 * v0 - 27454419028250566601 &#x3D; 0<br>2 * v4 - 5 * v3 + 20616666104378640363 &#x3D; 0<br>v0 + 4 * v4 - 0x1dce62be9f0fa2f6c &#x3D; 0</p>
<p>å¯ä»¥ä½¿ç”¨z3æ±‚è§£ã€‚è§£å¯†è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> z3 <span class="hljs-keyword">import</span> *<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">v0 v3 v4åˆ†åˆ«å­˜æ”¾[0:16],[8:24],[16:32]ä¸‹æ ‡çš„å­—ç¬¦ï¼ŒBigIntegerå°†è¿™äº›å­—ç¬¦è½¬æˆåå…­è¿›åˆ¶æ•°ï¼Œæ¯ä¸ªåå…­è¿›åˆ¶æ•°4ä½ï¼Œæ‰€ä»¥æ¯ä¸ªå˜é‡æ˜¯64ä½</span><br><span class="hljs-string">éœ€è¦å…³æ³¨ä¸¤ä¸¤å˜é‡ä¹‹é—´æœ‰32ä½çš„é‡å </span><br><span class="hljs-string">æ‰€ä»¥å¯ä»¥å°†ä¸‰ä¸ª64ä½å˜é‡åˆ†æˆ4ä¸ª32ä½å˜é‡æ¥å¤„ç†</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-comment"># å®šä¹‰4ä¸ª32ä½å˜é‡</span><br>u=BitVec(<span class="hljs-string">&#x27;u&#x27;</span>,<span class="hljs-number">32</span>)  <span class="hljs-comment"># v0çš„é«˜32ä½</span><br>v=BitVec(<span class="hljs-string">&#x27;v&#x27;</span>,<span class="hljs-number">32</span>)  <span class="hljs-comment"># v0çš„ä½32ä½ï¼Œä¹Ÿæ˜¯v3çš„é«˜32ä½</span><br>w=BitVec(<span class="hljs-string">&#x27;w&#x27;</span>,<span class="hljs-number">32</span>)  <span class="hljs-comment"># v3çš„ä½32ä½ï¼Œä¹Ÿæ˜¯v4çš„é«˜32ä½</span><br>t=BitVec(<span class="hljs-string">&#x27;t&#x27;</span>,<span class="hljs-number">32</span>)  <span class="hljs-comment"># v4çš„ä½32ä½</span><br><br><span class="hljs-comment"># é€šè¿‡æ‹¼æ¥32ä½å˜é‡æ„é€ 64ä½å˜é‡</span><br>v0=Concat(u,v) <span class="hljs-comment">#v0=u&lt;&lt;32|v</span><br>v3=Concat(v,w) <span class="hljs-comment">#v3=v&lt;&lt;32|w</span><br>v4=Concat(w,t) <span class="hljs-comment">#v4=w&lt;&lt;32|t</span><br><br><span class="hljs-comment">#å®šä¹‰å¸¸é‡</span><br>A=BitVecVal(<span class="hljs-number">27454419028250566601</span>,<span class="hljs-number">64</span>)<br>B=BitVecVal(-<span class="hljs-number">20616666104378640363</span>,<span class="hljs-number">64</span>)<br>C=BitVecVal(<span class="hljs-number">0x1dce62be9f0fa2f6c</span>,<span class="hljs-number">64</span>)<br><br><span class="hljs-comment">#å»ºç«‹çº¦æŸ</span><br>s=Solver()<br>s.add(v3+<span class="hljs-number">3</span>*v0==A)<br>s.add(<span class="hljs-number">2</span>*v4-<span class="hljs-number">5</span>*v3==B)<br>s.add(v0+<span class="hljs-number">4</span>*v4==C)<br><br><span class="hljs-keyword">if</span> s.check()==unsat:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;æ— è§£&quot;</span>)<br><span class="hljs-keyword">while</span> s.check()==sat:<br>    model=s.model()<br>    u_val=model[u].as_long()<br>    v_val=model[v].as_long()<br>    w_val=model[w].as_long()<br>    t_val=model[t].as_long()<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;found solution:&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;u: <span class="hljs-subst">&#123;u_val:08x&#125;</span>&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;v: <span class="hljs-subst">&#123;v_val:08x&#125;</span>&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;w: <span class="hljs-subst">&#123;w_val:08x&#125;</span>&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;t: <span class="hljs-subst">&#123;t_val:08x&#125;</span>&quot;</span>)<br><br>    <span class="hljs-comment"># å°†32ä½å˜é‡è¿˜åŸæˆå­—ç¬¦</span><br>    result=(u_val&lt;&lt;<span class="hljs-number">96</span>)|(v_val&lt;&lt;<span class="hljs-number">64</span>)|(w_val&lt;&lt;<span class="hljs-number">32</span>)|t_val<br><br>    hex_str=<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;result:032x&#125;</span>&quot;</span><br>    flag_bytes=<span class="hljs-built_in">bytes</span>.fromhex(hex_str)<br>    flag=flag_bytes.decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;flag: <span class="hljs-subst">&#123;flag&#125;</span>&quot;</span>)<br>	<br>    <span class="hljs-comment">#æ’é™¤å·²æœ‰çš„è§£</span><br>    s.add(Or(u!=u_val,v!=v_val,w!=w_val,t!=t_val))<br>    <br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">found solution:</span><br><span class="hljs-string">u: 5f346e64</span><br><span class="hljs-string">v: 5f646578</span><br><span class="hljs-string">w: 5f6c6f61</span><br><span class="hljs-string">t: 6465727d</span><br><span class="hljs-string">flag: _4nd_dex_loader&#125;</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure></li>
</ul>
<blockquote>
<p>flagï¼š0xGame{Do_y0u_l0v3_andr01d_4nd_dex_loader}</p>
</blockquote>
<h2 id="Minesweepr"><a href="#Minesweepr" class="headerlink" title="Minesweepr"></a>Minesweepr</h2><blockquote>
<p>è€ƒç‚¹ï¼šwebé€†å‘ã€jsé€†å‘</p>
</blockquote>
<ul>
<li><p>é™„ä»¶æ˜¯htmlæ–‡ä»¶å’Œjsæ–‡ä»¶ï¼Œæ¨æµ‹æ˜¯ä¸€ä¸ªwebé€†å‘é¢˜ã€‚htmlæ‰“å¼€æ˜¯ä¸€ä¸ªæ‰«é›·æ¸¸æˆç½‘é¡µã€‚å› ä¸ºjsä¸»è¦ç”¨æ¥å¤„ç†ç½‘é¡µäº¤äº’ï¼Œæ‰€ä»¥é‡ç‚¹å…³æ³¨jsæ–‡ä»¶çš„å†…å®¹</p>
<p><img src="/../images/image-20251023083351084.png" alt="æ‰«é›·æ¸¸æˆ"></p>
</li>
<li><p>ç½‘é¡µæŒ‰F12æ‰“å¼€å¼€å‘äººå‘˜å·¥å…·ï¼Œå¯ä»¥åœ¨å·¥å…·æ æºä»£ç æ¨¡å—çœ‹jsè„šæœ¬ã€‚æœç´¢â€flagâ€å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªå¯ç–‘çš„å‡½æ•°ï¼š</p>
<p><img src="/../images/image-20251024112642390.png" alt="jsè„šæœ¬ä¸å¯ç–‘å‡½æ•°"></p>
<p>è¿™é‡Œå‡½æ•°åå’Œå˜é‡åéƒ½ä¸æ˜¯æœ‰æ„ä¹‰çš„ï¼Œä¸å¥½é˜…è¯»ï¼Œå¯ä»¥åŒå‡»é«˜äº®æ¥è¿½è¸ªæ•°æ®æµã€‚</p>
<p>åˆ†æå¯ä»¥å‘ç°ï¼Œ0x55ea57è¢«è°ƒç”¨äº†å¾ˆå¤šæ¬¡ï¼Œè¿½è¸ªè¿™ä¸ªå€¼å¯ä»¥åˆ°è¾¾0x183cï¼Œè¿™ä¸ªå‡½æ•°è´Ÿè´£ä»0xca50ä¸­åŠ è½½å€¼è¿”å›ï¼Œè¿™ç®—æ˜¯ä¸€ä¸ªå…¨å±€çš„æ··æ·†æ‰‹æ®µäº†</p>
<p><img src="/../images/image-20251024162443124.png" alt="0x55ea57è¢«è°ƒç”¨äº†å¤šæ¬¡"></p>
<p><img src="/../images/image-20251024162904166.png" alt="0x183cå‡½æ•°"></p>
<p>æ ¹æ®0x183cçš„ä»£ç å¯ä»¥æ‰¾åˆ°0xca50çš„å­—ç¬¦ä¸²è¡¨0x1193d5ï¼Œè¡¨ä¸­å°±å¯ä»¥ç´¢å¼•å‡ºå¯†é’¥winModal:message2ï¼šâ€WebIsInterestingâ€äº†ï¼Œä»¥åŠå¯†æ–‡â€g\x1d%(\x1e,\x15@SA\x5cFD\x0fWJn]P}^}\x0c\x12\x07_]AGYC^o\x04\x00yA-ZGT\x16U\x0eâ€ï¼ˆ0x183cçš„ç´¢å¼•ç®—æ³•æœ‰ç‚¹å¥‡æ€ªï¼Œå¥½åƒç´¢å¼•ä¸åˆ°æ­£ç¡®çš„ä½ç½®ä¸Šï¼Œæ²¡ææ‡‚ï¼‰</p>
<p>è€Œ0x172ca4çš„è§£å¯†é€»è¾‘å¯ä»¥ç­‰ä»·å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc)):<br>	flag+=enc[i]^key[i%<span class="hljs-built_in">len</span>(key)]<br></code></pre></td></tr></table></figure>

<p>å› æ­¤å¯ä»¥å¾—åˆ°è§£å¯†è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">enc=<span class="hljs-string">&quot;g\x1d%(\x1e,\x15@SA\x5cFD\x0fWJn]P&#125;^&#125;\x0c\x12\x07_]AGYC^o\x04\x00yA-ZGT\x16U\x0e&quot;</span><br>key=<span class="hljs-string">&quot;WebIsInteresting&quot;</span><br>flag=<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc)):<br>    flag+=<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(enc[i])^<span class="hljs-built_in">ord</span>(key[i%<span class="hljs-built_in">len</span>(key)]))<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure></li>
</ul>
<blockquote>
<p>flagï¼š0xGame{463950f9-9824-4bfb-8230-98ab02d431d0}</p>
</blockquote>
<h2 id="ezVBS"><a href="#ezVBS" class="headerlink" title="ezVBS"></a>ezVBS</h2><blockquote>
<p>è€ƒç‚¹ï¼šVBSé€†å‘ã€VBSå»æ··æ·†</p>
</blockquote>
<ul>
<li><p>é™„ä»¶ç¨‹åºæ˜¯ä¸ªVBSæ–‡ä»¶ï¼Œè¿è¡Œæ˜¾ç¤ºï¼š</p>
<p><img src="/../images/image-20251024165818790.png" alt="è¿è¡ŒVBS"></p>
</li>
<li><p>ç”¨è®°äº‹æœ¬æ‰“å¼€VBSä¼šå‘ç°æ˜¯ä¸€å †å¥‡æ€ªçš„å­—ç¬¦ï¼ŒæŸ¥äº†ä¸€ä¸‹è¯´æ˜¯åŠ äº†æ··æ·†</p>
<p><img src="/../images/image-20251024170022478.png" alt="è®°äº‹æœ¬æ‰“å¼€"></p>
<p>å‚è€ƒ<a href="https://blog.csdn.net/Daphneohh/article/details/143783257">VBSä»£ç æ··æ·†</a>ï¼Œå¯ä»¥ä½¿ç”¨å»æ··æ·†è„šæœ¬è¿›è¡Œå»æ··æ·†ï¼Œä½¿ç”¨æ–¹æ³•è§é“¾æ¥ï¼š</p>
<figure class="highlight vbscript"><table><tr><td class="code"><pre><code class="hljs vbscript"><span class="hljs-keyword">Option</span> <span class="hljs-keyword">Explicit</span><br> <br><span class="hljs-keyword">Function</span> Defuscator(vbs)<br>	<span class="hljs-keyword">Dim</span> t<br>	t = <span class="hljs-built_in">InStr</span>(<span class="hljs-number">1</span>, vbs, <span class="hljs-string">&quot;Execute&quot;</span>, <span class="hljs-number">1</span>)<br>	t = <span class="hljs-built_in">Mid</span>(vbs, t + <span class="hljs-built_in">Len</span>(<span class="hljs-string">&quot;Execute&quot;</span>)) <br>	t = <span class="hljs-built_in">Eval</span>(t)<br>	Defuscator = t<br><span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span><br> <br><span class="hljs-keyword">Dim</span> fso, i<br><span class="hljs-keyword">Const</span> ForReading = <span class="hljs-number">1</span><br><span class="hljs-keyword">Set</span> fso = <span class="hljs-built_in">CreateObject</span>(<span class="hljs-string">&quot;Scripting.FileSystemObject&quot;</span>)<br><span class="hljs-keyword">For</span> i = <span class="hljs-number">0</span> <span class="hljs-keyword">To</span> WScript.Arguments.Count - <span class="hljs-number">1</span> <br>	<span class="hljs-keyword">Dim</span> FileName<br>	FileName = WScript.Arguments(i)<br>	<span class="hljs-keyword">Dim</span> MyFile<br>	<span class="hljs-keyword">Set</span> MyFile = fso.OpenTextFile(FileName, ForReading)<br>	<span class="hljs-keyword">Dim</span> vbs<br>	vbs = MyFile.ReadAll	<br>	WScript.Echo Defuscator(vbs)<br>	MyFile.Close<br><span class="hljs-keyword">Next</span><br> <br><span class="hljs-keyword">Set</span> fso = <span class="hljs-literal">Nothing</span><br></code></pre></td></tr></table></figure>

<p>ç„¶åå¯ä»¥å¾—åˆ°å¦‚ä¸‹çš„ä»£ç ï¼š</p>
<figure class="highlight vbscript"><table><tr><td class="code"><pre><code class="hljs vbscript">Microsoft (R) Windows Script Host Version <span class="hljs-number">5.812</span><br>ç‰ˆæƒæ‰€æœ‰(C) Microsoft Corporationã€‚ä¿ç•™æ‰€æœ‰æƒåˆ©ã€‚<br><br>code = <span class="hljs-string">&quot;Function l(str):Dim i,j,k,r:j=Len(str):r=&quot;&quot;&quot;&quot;:For i=1 to j:k=Asc(Mid(str,i,1)):If k&gt;=33 And k&lt;=126 Then:r=r&amp;Chr(33+((k+14)Mod 94)):Else:r=r&amp;Chr(k):End If:Next:l=r:End Function:Execute l(&quot;&quot;DEC l x?AFEq@IWQt?E6C J@FC &gt;6DD286i QX i q2D6ec%23=6 l Q7Ie&#123;&amp;*d2Eh=?H&gt;5b%3BKF#JZp:A(w!s@)+z|uvr&#x27;ax^&quot;&quot;&quot;&quot;;$C6tD9`g&#125;y&lt;8_Gfc~4qQ i 7=28 l QH2+2pJ&#125;vsyhrH&#123;7&#125;5K*r?J&amp;DpyE$&gt;&#123;&amp;_HB&#125;z&gt;&#123;*u?J%g:J#|:d&amp;tp|w_52glQ i 6?4 l QQ i u@C : l ` %@ &#123;6?WDECX $E6A b i :7 : Z a kl &#123;6?WDECX %96? i 3:Eq=@4&lt; l pD4W|:5WDEC[ :[ `XX Y ade Y ade Z pD4W|:5WDEC[ : Z `[ `XX Y ade Z pD4W|:5WDEC[ : Z a[ `XX i 4` l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ec Y ecXX |@5 ec Z `[ `X i 4a l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ecXX |@5 ec Z `[ `X i 4b l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - ecX |@5 ec Z `[ `X i 4c l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt;X |@5 ec Z `[ `X i 6?4 l 6?4 U 4` U 4a U 4b U 4c i t=D6 i x7 : Z ` kl &#123;6?WDECX %96? i 3:Eq=@4&lt; l pD4W|:5WDEC[ :[ `XX Y ade Y ade Z pD4W|:5WDEC[ : Z `[ `XX Y ade i 4` l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ec Y ecXX |@5 ec Z `[ `X i 4a l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ecXX |@5 ec Z `[ `X i 4b l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - ecX |@5 ec Z `[ `X i 6?4 l 6?4 U 4` U 4a U 4b U QlQ i t=D6 i 3:Eq=@4&lt; l pD4W|:5WDEC[ :[ `XX Y ade Y ade i 4` l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ec Y ecXX |@5 ec Z `[ `X i 4a l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ecXX |@5 ec Z `[ `X i 6?4 l 6?4 U 4` U 4a U QlQ U QlQ i t?5 x7 i t?5 x7 i &#125;6IE i xu 6?4 l 7=28 %96? i |D8q@I Q*@FC 7=28 :D 4@CC64EPQ i t=D6 i |D8q@I Q*@FC 7=28 :D :?4@CC64EPQ i t?5 x7&quot;&quot;)&quot;</span><br><span class="hljs-keyword">Execute</span> code<br>code = <span class="hljs-string">&quot;Function l(str):Dim i,j,k,r:j=Len(str):r=&quot;&quot;&quot;&quot;:For i=1 to j:k=Asc(Mid(str,i,1)):If k&gt;=33 And k&lt;=126 Then:r=r&amp;Chr(33+((k+14)Mod 94)):Else:r=r&amp;Chr(k):End If:Next:l=r:End Function:Execute l(&quot;&quot;DEC l x?AFEq@IWQt?E6C J@FC 7=28i QX i q2D6ec%23=6 l QeHB)IvGyC%c~&quot;&quot;&quot;&quot;&gt;&#125;twp^h@fg&#x27;qZ`=+#s4EdAFa2(_5Du&#123;Jr$86;z79&amp;:x|*!&lt;Kb?3Q i 7=28 l Q^^H5q&#x27;Z2CGvJ+(fdZyaE#:vz=(faCy28#^H$=xwE#GKE+_f$CvZB@zHa`&#x27;%2qxpJs^6Esgb&amp;+AHF=:&amp;6#&#x27;p2+AHD+zHJ`gr2=yaE#GKEq(@Eq&#x27;p9qg&gt;&#123;ZgwEq(fFq&#x27;f7Z^H8ZAH9`G27~BHu#&#x27;&gt;9CGv7Cy28#&#x27;CEZ(;dZzH5q&#x27;&quot;&quot;&quot;&quot;Eq(f2=AH8#(fz#x%D#yp2=EllQ i 6?4 l QQ i u@C : l ` %@ &#123;6?WDECX $E6A b i :7 : Z a kl &#123;6?WDECX %96? i 3:Eq=@4&lt; l pD4W|:5WDEC[ :[ `XX Y ade Y ade Z pD4W|:5WDEC[ : Z `[ `XX Y ade Z pD4W|:5WDEC[ : Z a[ `XX i 4` l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ec Y ecXX |@5 ec Z `[ `X i 4a l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ecXX |@5 ec Z `[ `X i 4b l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - ecX |@5 ec Z `[ `X i 4c l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt;X |@5 ec Z `[ `X i 6?4 l 6?4 U 4` U 4a U 4b U 4c i t=D6 i x7 : Z ` kl &#123;6?WDECX %96? i 3:Eq=@4&lt; l pD4W|:5WDEC[ :[ `XX Y ade Y ade Z pD4W|:5WDEC[ : Z `[ `XX Y ade i 4` l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ec Y ecXX |@5 ec Z `[ `X i 4a l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ecXX |@5 ec Z `[ `X i 4b l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - ecX |@5 ec Z `[ `X i 6?4 l 6?4 U 4` U 4a U 4b U QlQ i t=D6 i 3:Eq=@4&lt; l pD4W|:5WDEC[ :[ `XX Y ade Y ade i 4` l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ec Y ecXX |@5 ec Z `[ `X i 4a l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ecXX |@5 ec Z `[ `X i 6?4 l 6?4 U 4` U 4a U QlQ U QlQ i t?5 x7 i t?5 x7 i &#125;6IE i xu 6?4 l 7=28 %96? i |D8q@I DEC i t=D6 i |D8q@I Q*@FC 7=28 :D :?4@CC64EPQ i |D8q@I 6?4 i t?5 x7&quot;&quot;)&quot;</span><br><span class="hljs-keyword">Set</span> objFSO = <span class="hljs-built_in">CreateObject</span>(<span class="hljs-string">&quot;Scripting.FileSystemObject&quot;</span>)<br>strScriptPath = WScript.ScriptFullName<br>strTextToWrite = code<br>objFSO.OpenTextFile(strScriptPath, <span class="hljs-number">2</span>, <span class="hljs-literal">True</span>).WriteLine(strTextToWrite)<br></code></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°codeä¸­æœ‰ä¸€äº›å¯è¯»æ˜æ–‡ï¼Œåé¢åˆæ˜¯ä¸€å¤§ä¸²å¥‡æ€ªçš„å­—ç¬¦ã€‚æ¨æµ‹è¿˜æœ‰ä¸€å±‚æ··æ·†ï¼Œå¯è¯»æ˜æ–‡å³ä¸ºè§£å¯†å‡½æ•°ã€‚è®©AIç»™å‡ºè§£å¯†è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">l</span>(<span class="hljs-params">encrypted_str</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;VBScript l å‡½æ•°çš„ Python å®ç°&quot;&quot;&quot;</span><br>    result = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(encrypted_str)):<br>        k = <span class="hljs-built_in">ord</span>(encrypted_str[i])<br>        <span class="hljs-keyword">if</span> <span class="hljs-number">33</span> &lt;= k &lt;= <span class="hljs-number">126</span>:<br>            <span class="hljs-comment"># ä¸ VBScript ç›¸åŒçš„ç®—æ³•</span><br>            result += <span class="hljs-built_in">chr</span>(<span class="hljs-number">33</span> + ((k + <span class="hljs-number">14</span>) % <span class="hljs-number">94</span>))<br>        <span class="hljs-keyword">else</span>:<br>            result += <span class="hljs-built_in">chr</span>(k)<br>    <span class="hljs-keyword">return</span> result<br><br><br><span class="hljs-comment"># ä½ çš„åŠ å¯†å­—ç¬¦ä¸²</span><br>encrypted_strings = [<br>    <span class="hljs-string">&quot;DEC l x?AFEq@IWQt?E6C J@FC &gt;6DD286i QX i q2D6ec%23=6 l Q7Ie&#123;&amp;*d2Eh=?H&gt;5b%3BKF#JZp:A(w!s@)+z|uvr&#x27;ax^\&quot;\&quot;\&quot;\&quot;;$C6tD9`g&#125;y&lt;8_Gfc~4qQ i 7=28 l QH2+2pJ&#125;vsyhrH&#123;7&#125;5K*r?J&amp;DpyE$&gt;&#123;&amp;_HB&#125;z&gt;&#123;*u?J%g:J#|:d&amp;tp|w_52glQ i 6?4 l QQ i u@C : l ` %@ &#123;6?WDECX $E6A b i :7 : Z a kl &#123;6?WDECX %96? i 3:Eq=@4&lt; l pD4W|:5WDEC[ :[ `XX Y ade Y ade Z pD4W|:5WDEC[ : Z `[ `XX Y ade Z pD4W|:5WDEC[ : Z a[ `XX i 4` l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ec Y ecXX |@5 ec Z `[ `X i 4a l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ecXX |@5 ec Z `[ `X i 4b l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - ecX |@5 ec Z `[ `X i 4c l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt;X |@5 ec Z `[ `X i 6?4 l 6?4 U 4` U 4a U 4b U 4c i t=D6 i x7 : Z ` kl &#123;6?WDECX %96? i 3:Eq=@4&lt; l pD4W|:5WDEC[ :[ `XX Y ade Y ade Z pD4W|:5WDEC[ : Z `[ `XX Y ade i 4` l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ec Y ecXX |@5 ec Z `[ `X i 4a l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ecXX |@5 ec Z `[ `X i 4b l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - ecX |@5 ec Z `[ `X i 6?4 l 6?4 U 4` U 4a U 4b U QlQ i t=D6 i 3:Eq=@4&lt; l pD4W|:5WDEC[ :[ `XX Y ade Y ade i 4` l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ec Y ecXX |@5 ec Z `[ `X i 4a l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ecXX |@5 ec Z `[ `X i 6?4 l 6?4 U 4` U 4a U QlQ U QlQ i t?5 x7 i t?5 x7 i &#125;6IE i xu 6?4 l 7=28 %96? i |D8q@I Q*@FC 7=28 :D 4@CC64EPQ i t=D6 i |D8q@I Q*@FC 7=28 :D :?4@CC64EPQ i t?5 x7&quot;</span>,<br><br>    <span class="hljs-string">&quot;DEC l x?AFEq@IWQt?E6C J@FC 7=28i QX i q2D6ec%23=6 l QeHB)IvGyC%c~\&quot;\&quot;\&quot;\&quot;&gt;&#125;twp^h@fg&#x27;qZ`=+#s4EdAFa2(_5Du&#123;Jr$86;z79&amp;:x|*!&lt;Kb?3Q i 7=28 l Q^^H5q&#x27;Z2CGvJ+(fdZyaE#:vz=(faCy28#^H$=xwE#GKE+_f$CvZB@zHa`&#x27;%2qxpJs^6Esgb&amp;+AHF=:&amp;6#&#x27;p2+AHD+zHJ`gr2=yaE#GKEq(@Eq&#x27;p9qg&gt;&#123;ZgwEq(fFq&#x27;f7Z^H8ZAH9`G27~BHu#&#x27;&gt;9CGv7Cy28#&#x27;CEZ(;dZzH5q&#x27;\&quot;\&quot;\&quot;\&quot;Eq(f2=AH8#(fz#x%D#yp2=EllQ i 6?4 l QQ i u@C : l ` %@ &#123;6?WDECX $E6A b i :7 : Z a kl &#123;6?WDECX %96? i 3:Eq=@4&lt; l pD4W|:5WDEC[ :[ `XX Y ade Y ade Z pD4W|:5WDEC[ : Z `[ `XX Y ade Z pD4W|:5WDEC[ : Z a[ `XX i 4` l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ec Y ecXX |@5 ec Z `[ `X i 4a l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ecXX |@5 ec Z `[ `X i 4b l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - ecX |@5 ec Z `[ `X i 4c l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt;X |@5 ec Z `[ `X i 6?4 l 6?4 U 4` U 4a U 4b U 4c i t=D6 i x7 : Z ` kl &#123;6?WDECX %96? i 3:Eq=@4&lt; l pD4W|:5WDEC[ :[ `XX Y ade Y ade Z pD4W|:5WDEC[ : Z `[ `XX Y ade i 4` l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ec Y ecXX |@5 ec Z `[ `X i 4a l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ecXX |@5 ec Z `[ `X i 4b l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - ecX |@5 ec Z `[ `X i 6?4 l 6?4 U 4` U 4a U 4b U QlQ i t=D6 i 3:Eq=@4&lt; l pD4W|:5WDEC[ :[ `XX Y ade Y ade i 4` l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ec Y ecXX |@5 ec Z `[ `X i 4a l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ecXX |@5 ec Z `[ `X i 6?4 l 6?4 U 4` U 4a U QlQ U QlQ i t?5 x7 i t?5 x7 i &#125;6IE i xu 6?4 l 7=28 %96? i |D8q@I DEC i t=D6 i |D8q@I Q*@FC 7=28 :D :?4@CC64EPQ i |D8q@I 6?4 i t?5 x7&quot;</span><br>]<br><br><span class="hljs-comment"># è§£å¯†å¹¶æ˜¾ç¤ºç»“æœ</span><br><span class="hljs-keyword">for</span> i, encrypted <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(encrypted_strings, <span class="hljs-number">1</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;è§£å¯†ç¬¬ <span class="hljs-subst">&#123;i&#125;</span> ä¸ªå­—ç¬¦ä¸²:&quot;</span>)<br>    decrypted = l(encrypted)<br>    <span class="hljs-built_in">print</span>(decrypted)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n&quot;</span> + <span class="hljs-string">&quot;=&quot;</span> * <span class="hljs-number">80</span> + <span class="hljs-string">&quot;\n&quot;</span>)<br></code></pre></td></tr></table></figure>

<p>è¾“å‡ºï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">è§£å¯†ç¬¬ <span class="hljs-number">1</span> ä¸ªå­—ç¬¦ä¸²:<br><span class="hljs-built_in">str</span> = InputBox(<span class="hljs-string">&quot;Enter your message: &quot;</span>) : Base64Table = <span class="hljs-string">&quot;fx6LUY5at9lnwmd3TbqzuRy+AipWHPDoXZKMFGCV2I/QQQQjSreEsh18NJkg0v74OcB&quot;</span> : flag = <span class="hljs-string">&quot;waZaAyNGDJ9CwLfNdzYCnyUsAJtSmLU0wqNKmLYFnyT8iyRMi5UEAMH0da8=&quot;</span> : enc = <span class="hljs-string">&quot;&quot;</span> : For i = <span class="hljs-number">1</span> To Len(<span class="hljs-built_in">str</span>) Step <span class="hljs-number">3</span> : <span class="hljs-keyword">if</span> i + <span class="hljs-number">2</span> &lt;= Len(<span class="hljs-built_in">str</span>) Then : bitBlock = Asc(Mid(<span class="hljs-built_in">str</span>, i, <span class="hljs-number">1</span>)) * <span class="hljs-number">256</span> * <span class="hljs-number">256</span> + Asc(Mid(<span class="hljs-built_in">str</span>, i + <span class="hljs-number">1</span>, <span class="hljs-number">1</span>)) * <span class="hljs-number">256</span> + Asc(Mid(<span class="hljs-built_in">str</span>, i + <span class="hljs-number">2</span>, <span class="hljs-number">1</span>)) : c1 = Mid(Base64Table, Int(bitBlock \ (<span class="hljs-number">64</span> * <span class="hljs-number">64</span> * <span class="hljs-number">64</span>)) Mod <span class="hljs-number">64</span> + <span class="hljs-number">1</span>, <span class="hljs-number">1</span>) : c2 = Mid(Base64Table, Int(bitBlock \ (<span class="hljs-number">64</span> * <span class="hljs-number">64</span>)) Mod <span class="hljs-number">64</span> + <span class="hljs-number">1</span>, <span class="hljs-number">1</span>) : c3 = Mid(Base64Table, Int(bitBlock \ <span class="hljs-number">64</span>) Mod <span class="hljs-number">64</span> + <span class="hljs-number">1</span>, <span class="hljs-number">1</span>) : c4 = Mid(Base64Table, Int(bitBlock) Mod <span class="hljs-number">64</span> + <span class="hljs-number">1</span>, <span class="hljs-number">1</span>) : enc = enc &amp; c1 &amp; c2 &amp; c3 &amp; c4 : Else : If i + <span class="hljs-number">1</span> &lt;= Len(<span class="hljs-built_in">str</span>) Then : bitBlock = Asc(Mid(<span class="hljs-built_in">str</span>, i, <span class="hljs-number">1</span>)) * <span class="hljs-number">256</span> * <span class="hljs-number">256</span> + Asc(Mid(<span class="hljs-built_in">str</span>, i + <span class="hljs-number">1</span>, <span class="hljs-number">1</span>)) * <span class="hljs-number">256</span> : c1 = Mid(Base64Table, Int(bitBlock \ (<span class="hljs-number">64</span> * <span class="hljs-number">64</span> * <span class="hljs-number">64</span>)) Mod <span class="hljs-number">64</span> + <span class="hljs-number">1</span>, <span class="hljs-number">1</span>) : c2 = Mid(Base64Table, Int(bitBlock \ (<span class="hljs-number">64</span> * <span class="hljs-number">64</span>)) Mod <span class="hljs-number">64</span> + <span class="hljs-number">1</span>, <span class="hljs-number">1</span>) : c3 = Mid(Base64Table, Int(bitBlock \ <span class="hljs-number">64</span>) Mod <span class="hljs-number">64</span> + <span class="hljs-number">1</span>, <span class="hljs-number">1</span>) : enc = enc &amp; c1 &amp; c2 &amp; c3 &amp; <span class="hljs-string">&quot;=&quot;</span> : Else : bitBlock = Asc(Mid(<span class="hljs-built_in">str</span>, i, <span class="hljs-number">1</span>)) * <span class="hljs-number">256</span> * <span class="hljs-number">256</span> : c1 = Mid(Base64Table, Int(bitBlock \ (<span class="hljs-number">64</span> * <span class="hljs-number">64</span> * <span class="hljs-number">64</span>)) Mod <span class="hljs-number">64</span> + <span class="hljs-number">1</span>, <span class="hljs-number">1</span>) : c2 = Mid(Base64Table, Int(bitBlock \ (<span class="hljs-number">64</span> * <span class="hljs-number">64</span>)) Mod <span class="hljs-number">64</span> + <span class="hljs-number">1</span>, <span class="hljs-number">1</span>) : enc = enc &amp; c1 &amp; c2 &amp; <span class="hljs-string">&quot;=&quot;</span> &amp; <span class="hljs-string">&quot;=&quot;</span> : End If : End If : Next : IF enc = flag Then : MsgBox <span class="hljs-string">&quot;Your flag is correct!&quot;</span> : Else : MsgBox <span class="hljs-string">&quot;Your flag is incorrect!&quot;</span> : End If<br><br>================================================================================<br><br>è§£å¯†ç¬¬ <span class="hljs-number">2</span> ä¸ªå­—ç¬¦ä¸²:<br><span class="hljs-built_in">str</span> = InputBox(<span class="hljs-string">&quot;Enter your flag: &quot;</span>) : Base64Table = <span class="hljs-string">&quot;6wqXxGvJrT4OQQQQmNEHA/9o78VB+1lZRDct5pu2aW0dsFLyCSgejKfhUiIMYPkz3nb&quot;</span> : flag = <span class="hljs-string">&quot;//wdBV+arvGyZW75+J2tRiGKlW72rJagR/wSlIHtRvztZ07SrG+qoKw21VTaBIAyD/etD83UZpwuliUeRVAaZpwsZKwy18CalJ2tRvztBWotBVAhB8mL+8HtBW7uBV7f+/wg+pwh1vafOqwFRVmhrvGfrJagRVrt+Wj5+KwdBVQQQQtBW7alpwgRW7KRITsRJAalt==&quot;</span> : enc = <span class="hljs-string">&quot;&quot;</span> : For i = <span class="hljs-number">1</span> To Len(<span class="hljs-built_in">str</span>) Step <span class="hljs-number">3</span> : <span class="hljs-keyword">if</span> i + <span class="hljs-number">2</span> &lt;= Len(<span class="hljs-built_in">str</span>) Then : bitBlock = Asc(Mid(<span class="hljs-built_in">str</span>, i, <span class="hljs-number">1</span>)) * <span class="hljs-number">256</span> * <span class="hljs-number">256</span> + Asc(Mid(<span class="hljs-built_in">str</span>, i + <span class="hljs-number">1</span>, <span class="hljs-number">1</span>)) * <span class="hljs-number">256</span> + Asc(Mid(<span class="hljs-built_in">str</span>, i + <span class="hljs-number">2</span>, <span class="hljs-number">1</span>)) : c1 = Mid(Base64Table, Int(bitBlock \ (<span class="hljs-number">64</span> * <span class="hljs-number">64</span> * <span class="hljs-number">64</span>)) Mod <span class="hljs-number">64</span> + <span class="hljs-number">1</span>, <span class="hljs-number">1</span>) : c2 = Mid(Base64Table, Int(bitBlock \ (<span class="hljs-number">64</span> * <span class="hljs-number">64</span>)) Mod <span class="hljs-number">64</span> + <span class="hljs-number">1</span>, <span class="hljs-number">1</span>) : c3 = Mid(Base64Table, Int(bitBlock \ <span class="hljs-number">64</span>) Mod <span class="hljs-number">64</span> + <span class="hljs-number">1</span>, <span class="hljs-number">1</span>) : c4 = Mid(Base64Table, Int(bitBlock) Mod <span class="hljs-number">64</span> + <span class="hljs-number">1</span>, <span class="hljs-number">1</span>) : enc = enc &amp; c1 &amp; c2 &amp; c3 &amp; c4 : Else : If i + <span class="hljs-number">1</span> &lt;= Len(<span class="hljs-built_in">str</span>) Then : bitBlock = Asc(Mid(<span class="hljs-built_in">str</span>, i, <span class="hljs-number">1</span>)) * <span class="hljs-number">256</span> * <span class="hljs-number">256</span> + Asc(Mid(<span class="hljs-built_in">str</span>, i + <span class="hljs-number">1</span>, <span class="hljs-number">1</span>)) * <span class="hljs-number">256</span> : c1 = Mid(Base64Table, Int(bitBlock \ (<span class="hljs-number">64</span> * <span class="hljs-number">64</span> * <span class="hljs-number">64</span>)) Mod <span class="hljs-number">64</span> + <span class="hljs-number">1</span>, <span class="hljs-number">1</span>) : c2 = Mid(Base64Table, Int(bitBlock \ (<span class="hljs-number">64</span> * <span class="hljs-number">64</span>)) Mod <span class="hljs-number">64</span> + <span class="hljs-number">1</span>, <span class="hljs-number">1</span>) : c3 = Mid(Base64Table, Int(bitBlock \ <span class="hljs-number">64</span>) Mod <span class="hljs-number">64</span> + <span class="hljs-number">1</span>, <span class="hljs-number">1</span>) : enc = enc &amp; c1 &amp; c2 &amp; c3 &amp; <span class="hljs-string">&quot;=&quot;</span> : Else : bitBlock = Asc(Mid(<span class="hljs-built_in">str</span>, i, <span class="hljs-number">1</span>)) * <span class="hljs-number">256</span> * <span class="hljs-number">256</span> : c1 = Mid(Base64Table, Int(bitBlock \ (<span class="hljs-number">64</span> * <span class="hljs-number">64</span> * <span class="hljs-number">64</span>)) Mod <span class="hljs-number">64</span> + <span class="hljs-number">1</span>, <span class="hljs-number">1</span>) : c2 = Mid(Base64Table, Int(bitBlock \ (<span class="hljs-number">64</span> * <span class="hljs-number">64</span>)) Mod <span class="hljs-number">64</span> + <span class="hljs-number">1</span>, <span class="hljs-number">1</span>) : enc = enc &amp; c1 &amp; c2 &amp; <span class="hljs-string">&quot;=&quot;</span> &amp; <span class="hljs-string">&quot;=&quot;</span> : End If : End If : Next : IF enc = flag Then : MsgBox <span class="hljs-built_in">str</span> : Else : MsgBox <span class="hljs-string">&quot;Your flag is incorrect!&quot;</span> : MsgBox enc : End If<br><br>================================================================================<br></code></pre></td></tr></table></figure>

<p>è§£å¯†å‡ºæ¥æ˜¯ä¸¤æ®µä»£ç ã€‚ä½†æ˜¯ä»£ç ç»™çš„baseè¡¨ä¸æ˜¯å¾ˆå¯¹ï¼Œç¬¬2æ®µä»£ç ä¸­åˆ é™¤baseè¡¨ä¸­é—´è¿ç»­QQQQçš„å‡ ä¸ªå¯ä»¥è§£å¯†å‡ºä¸€äº›ç±»ä¼¼æç¤ºçš„ä¸œè¥¿</p>
<p><img src="/../images/image-20251024172111827.png" alt="ç±»ä¼¼æç¤ºçš„ä¸œè¥¿"></p>
<p>ç¬¬1æ®µä»£ç çš„ç¼–ç è¡¨è¿›è¡ŒåŒæ ·çš„ä¿®æ”¹å°±å¾—åˆ°äº†flagï¼š</p>
<p><img src="/../images/image-20251024172507953.png" alt="å¾—åˆ°flag"></p>
</li>
</ul>
<blockquote>
<p>flagï¼š0xGame{bf00591f-a1cb-4191-b41d-d4eecda0b798}</p>
</blockquote>
<h2 id="Worldâ€™s-end-BlackBox"><a href="#Worldâ€™s-end-BlackBox" class="headerlink" title="Worldâ€™s_end_BlackBox"></a>Worldâ€™s_end_BlackBox</h2><blockquote>
<p>è€ƒç‚¹ï¼šåŠ¨æ€è°ƒè¯•ã€é­”æ”¹RC4ç®—æ³•</p>
</blockquote>
<ul>
<li><p>é™„ä»¶ç¨‹åºè¿è¡Œå¦‚å›¾ï¼š</p>
<p><img src="/../images/image-20251024175918607.png" alt="é™„ä»¶ç¨‹åºè¿è¡Œ"></p>
</li>
<li><p>ç”¨IDAæ‰“å¼€ï¼Œmainå‡½æ•°ç”±äºç±»çš„å½±å“ä¸å¥½åˆ†æï¼Œå…ˆè¿›è¡Œç®€å•çš„å˜é‡åä¼˜åŒ–ï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs C"><span class="hljs-type">int</span> __fastcall <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **argv, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **envp)</span><br>&#123;<br>  __int64 v3; <span class="hljs-comment">// rax</span><br>  __int64 v4; <span class="hljs-comment">// rax</span><br>  __int64 v5; <span class="hljs-comment">// rax</span><br>  __int64 v6; <span class="hljs-comment">// rax</span><br>  __int64 v7; <span class="hljs-comment">// rax</span><br>  __int64 v8; <span class="hljs-comment">// rax</span><br>  __int64 v9; <span class="hljs-comment">// rax</span><br>  __int64 v10; <span class="hljs-comment">// rax</span><br>  __int64 v11; <span class="hljs-comment">// rax</span><br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::iterator __for_end; <span class="hljs-comment">// [rsp+20h] [rbp-60h] BYREF</span><br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::iterator __for_begin; <span class="hljs-comment">// [rsp+28h] [rbp-58h] BYREF</span><br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt; EndFlag; <span class="hljs-comment">// [rsp+30h] [rbp-50h] BYREF</span><br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> encrypted_message; <span class="hljs-comment">// [rsp+50h] [rbp-30h] BYREF</span><br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> key; <span class="hljs-comment">// [rsp+70h] [rbp-10h] BYREF</span><br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> flag; <span class="hljs-comment">// [rsp+90h] [rbp+10h] BYREF</span><br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> v19; <span class="hljs-comment">// [rsp+B0h] [rbp+30h] BYREF</span><br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt;::value_type __x; <span class="hljs-comment">// [rsp+D0h] [rbp+50h] BYREF</span><br>  <span class="hljs-type">char</span> c; <span class="hljs-comment">// [rsp+D7h] [rbp+57h]</span><br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> *__for_range; <span class="hljs-comment">// [rsp+D8h] [rbp+58h]</span><br><br>  _main(argc, argv, envp);<br>  SetConsoleOutputCP(<span class="hljs-number">0xFDE9u</span>);<br>  basicString((__int64)&amp;flag);<br>  basicString((__int64)&amp;key);<br>  v3 = operateOut(pOut, &amp;unk_408078);<br>  stdOut(v3, out);<br>  v4 = operateOut(pOut, &amp;unk_408160);<br>  stdOut(v4, out);<br>  getLine(pIn, &amp;key);                           <span class="hljs-comment">// è·å–å¯†ç </span><br>  <span class="hljs-keyword">if</span> ( getLength(&amp;key) != <span class="hljs-number">12</span> )                  <span class="hljs-comment">// é•¿åº¦åˆ¤æ–­</span><br>  &#123;<br>    v5 = operateOut(pOut, <span class="hljs-string">&quot;Length Error!&quot;</span>);<br>    stdOut(v5, out);<br>    system(<span class="hljs-string">&quot;pause&quot;</span>);<br>    <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>  &#125;<br>  KeyGenerate(&amp;v19, &amp;KeyEnc[abi:cxx11], &amp;DeKey[abi:cxx11]);<span class="hljs-comment">// keyçš„ç”Ÿæˆç®—æ³•</span><br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::operator=(&amp;TrueKey[abi:cxx11], &amp;v19);<br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::~<span class="hljs-built_in">string</span>(&amp;v19);<br>  <span class="hljs-keyword">if</span> ( <span class="hljs-built_in">std</span>::operator!=&lt;<span class="hljs-type">char</span>&gt;(&amp;key, &amp;TrueKey[abi:cxx11]) )<span class="hljs-comment">// å‡ºç°äº†æ£€éªŒé€»è¾‘ï¼Œå¯ä»¥ä»è¿™é‡Œç›´æ¥è·å–åˆ°çœŸæ­£çš„key</span><br>  &#123;<br>    v6 = operateOut(pOut, &amp;unk_4081A2);         <span class="hljs-comment">// keyé”™è¯¯æ—¶çš„è¾“å‡º</span><br>    stdOut(v6, out);<br>    system(<span class="hljs-string">&quot;pause&quot;</span>);<br>    <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>  &#125;<br>  v7 = operateOut(pOut, &amp;Congratulation);       <span class="hljs-comment">// keyæ­£ç¡®æ—¶çš„è¾“å‡º</span><br>  stdOut(v7, out);<br>  v8 = operateOut(pOut, &amp;unk_408212);<br>  stdOut(v8, out);<br>  getLine(pIn, &amp;flag);                          <span class="hljs-comment">// è·å–flagçš„è¾“å…¥</span><br>  <span class="hljs-keyword">if</span> ( getLength(&amp;flag) != <span class="hljs-number">51</span> )<br>  &#123;<br>    v9 = operateOut(pOut, <span class="hljs-string">&quot;Length Error!&quot;</span>);<br>    stdOut(v9, out);<br>    system(<span class="hljs-string">&quot;pause&quot;</span>);<br>    <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>  &#125;<br>  encrypt(&amp;encrypted_message, &amp;flag, &amp;key);     <span class="hljs-comment">// åŠ å¯†ç®—æ³•ï¼Œå¯†é’¥å³ä¸ºå‰æ–‡çš„key</span><br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt;::<span class="hljs-built_in">vector</span>(&amp;EndFlag);<br>  __for_range = &amp;encrypted_message;<br>  __for_begin._M_current = (<span class="hljs-type">char</span> *)<span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::begin(&amp;encrypted_message);<br>  __for_end._M_current = (<span class="hljs-type">char</span> *)<span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::end(__for_range);<br>  <span class="hljs-keyword">while</span> ( __gnu_cxx::operator!=&lt;<span class="hljs-type">char</span> *,<span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>&gt;(&amp;__for_begin, &amp;__for_end) )<br>  &#123;<br>    c = *__gnu_cxx::__normal_iterator&lt;<span class="hljs-type">char</span> *,<span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>&gt;::operator*(&amp;__for_begin);<br>    __x = (<span class="hljs-type">unsigned</span> __int8)c;<br>    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt;::push_back(&amp;EndFlag, &amp;__x);<br>    __gnu_cxx::__normal_iterator&lt;<span class="hljs-type">char</span> *,<span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>&gt;::operator++(&amp;__for_begin);<br>  &#125;<br>  <span class="hljs-keyword">if</span> ( <span class="hljs-built_in">std</span>::operator==&lt;<span class="hljs-type">int</span>,<span class="hljs-built_in">std</span>::allocator&lt;<span class="hljs-type">int</span>&gt;&gt;(&amp;KALEIDXSCOPE, &amp;EndFlag) )<span class="hljs-comment">// æ£€éªŒåŠ å¯†ç»“æœ</span><br>  &#123;<br>    v10 = operateOut(pOut, <span class="hljs-string">&quot;All Perfect!&quot;</span>);<br>    stdOut(v10, out);<br>    system(<span class="hljs-string">&quot;pause&quot;</span>);<br>    <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>  &#125;<br>  v11 = operateOut(pOut, <span class="hljs-string">&quot;Try again!&quot;</span>);<br>  stdOut(v11, out);<br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt;::~<span class="hljs-built_in">vector</span>(&amp;EndFlag);<br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::~<span class="hljs-built_in">string</span>(&amp;encrypted_message);<br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::~<span class="hljs-built_in">string</span>(&amp;key);<br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::~<span class="hljs-built_in">string</span>(&amp;flag);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-comment">//åŠ å¯†å‡½æ•°</span><br><span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> *__cdecl <span class="hljs-title function_">modifiedRC4</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> *__return_ptr retstr, <span class="hljs-type">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> *plaintext, <span class="hljs-type">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> *key)</span><br>&#123;<br>  <span class="hljs-type">size_t</span> v3; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">size_t</span> length; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">char</span> v5; <span class="hljs-comment">// bl</span><br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt;::reference List; <span class="hljs-comment">// rax</span><br>  __int64 v8; <span class="hljs-comment">// [rsp+0h] [rbp-80h] BYREF</span><br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt; k; <span class="hljs-comment">// [rsp+20h] [rbp-60h] BYREF</span><br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt; s; <span class="hljs-comment">// [rsp+40h] [rbp-40h] BYREF</span><br>  <span class="hljs-built_in">std</span>::allocator&lt;<span class="hljs-type">int</span>&gt; __a; <span class="hljs-comment">// [rsp+66h] [rbp-1Ah] BYREF</span><br>  <span class="hljs-type">char</span> v12; <span class="hljs-comment">// [rsp+67h] [rbp-19h] BYREF</span><br>  <span class="hljs-type">size_t</span> i; <span class="hljs-comment">// [rsp+68h] [rbp-18h]</span><br><br>  <span class="hljs-built_in">std</span>::allocator&lt;<span class="hljs-type">int</span>&gt;::allocator((<span class="hljs-built_in">std</span>::allocator&lt;<span class="hljs-type">int</span>&gt; *<span class="hljs-type">const</span>)&amp;v8 + <span class="hljs-number">102</span>);<br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt;::<span class="hljs-built_in">vector</span>(&amp;s, <span class="hljs-number">0x100u</span>LL, &amp;__a);<br>  <span class="hljs-built_in">std</span>::allocator&lt;<span class="hljs-type">int</span>&gt;::~allocator(&amp;__a);<br>  rc4_ksa(&amp;s, key);                             <span class="hljs-comment">// RC4å¯†é’¥è°ƒåº¦ç®—æ³•</span><br>  v3 = <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::size(plaintext);<br>  rc4_prga(&amp;k, &amp;s, v3);                         <span class="hljs-comment">// RC4ä¼ªéšæœºæ•°ç”Ÿæˆç®—æ³•</span><br>  <span class="hljs-built_in">std</span>::allocator&lt;<span class="hljs-type">char</span>&gt;::allocator(&amp;v12);<br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::basic_string(retstr, &amp;unk_408037, &amp;v12);<br>  <span class="hljs-built_in">std</span>::allocator&lt;<span class="hljs-type">char</span>&gt;::~allocator(&amp;v12);<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0LL</span>; ; ++i )<br>  &#123;<br>    length = <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::size(plaintext);<br>    <span class="hljs-keyword">if</span> ( i &gt;= length )<br>      <span class="hljs-keyword">break</span>;<br>    v5 = *(_BYTE *)StrMakeList(plaintext, i);<br>    List = IntMakeList(&amp;k, i);<br>    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::operator+=(retstr, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)(<span class="hljs-type">char</span>)(v5 ^ *(_BYTE *)List ^ <span class="hljs-number">7</span>));<span class="hljs-comment">// é­”æ”¹çš„åœ°æ–¹åœ¨è¿™</span><br>  &#125;<br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt;::~<span class="hljs-built_in">vector</span>(&amp;k);<br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt;::~<span class="hljs-built_in">vector</span>(&amp;s);<br>  <span class="hljs-keyword">return</span> retstr;<br>&#125;<br><br><span class="hljs-comment">//å¯†é’¥è°ƒåº¦ç®—æ³•</span><br><span class="hljs-type">void</span> __cdecl <span class="hljs-title function_">rc4_ksa</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt; *s, <span class="hljs-type">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> *key)</span><br>&#123;<br>  <span class="hljs-type">int</span> *M_current; <span class="hljs-comment">// rbx</span><br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt;::iterator v3; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">int</span> v4; <span class="hljs-comment">// ebx</span><br>  <span class="hljs-type">unsigned</span> __int64 v5; <span class="hljs-comment">// rdx</span><br>  _BYTE *List; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">char</span> v7; <span class="hljs-comment">// dl</span><br>  <span class="hljs-type">int</span> *s_j; <span class="hljs-comment">// rbx</span><br>  <span class="hljs-type">int</span> *s_i; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">size_t</span> i; <span class="hljs-comment">// [rsp+20h] [rbp-60h]</span><br>  <span class="hljs-type">int</span> j; <span class="hljs-comment">// [rsp+2Ch] [rbp-54h]</span><br><br>  M_current = <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt;::end(s)._M_current;<br>  v3._M_current = <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt;::begin(s)._M_current;<br>  <span class="hljs-built_in">std</span>::iota&lt;__gnu_cxx::__normal_iterator&lt;<span class="hljs-type">int</span> *,<span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt;&gt;,<span class="hljs-type">int</span>&gt;(<br>    v3,<br>    (__gnu_cxx::__normal_iterator&lt;<span class="hljs-type">int</span>*,<span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt; &gt;)M_current,<br>    <span class="hljs-number">0</span>);<br>  j = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0LL</span>; i &lt;= <span class="hljs-number">255</span>; ++i )<br>  &#123;<br>    v4 = *IntMakeList(s, i) + j;<br>    v5 = i % getLength(key);<br>    List = (_BYTE *)StrMakeList(key, v5);<br>    v7 = v4 + *List;<br>    LODWORD(List) = (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)((v4 + (<span class="hljs-type">char</span>)*List) &gt;&gt; <span class="hljs-number">31</span>) &gt;&gt; <span class="hljs-number">24</span>;<br>    j = (<span class="hljs-type">unsigned</span> __int8)((_BYTE)List + v7) - (_DWORD)List;<br>    s_j = IntMakeList(s, j);<br>    s_i = IntMakeList(s, i);<br>    <span class="hljs-built_in">std</span>::swap&lt;<span class="hljs-type">int</span>&gt;(s_i, s_j);<br>  &#125;<br>&#125;<br><br><span class="hljs-comment">//ä¼ªéšæœºæ•°ç”Ÿæˆç®—æ³•</span><br><span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt; *__cdecl <span class="hljs-title function_">rc4_prga</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt; *__return_ptr retstr, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt; *s, <span class="hljs-type">size_t</span> length)</span><br>&#123;<br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt;::reference v3; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">int</span> *v4; <span class="hljs-comment">// rbx</span><br>  <span class="hljs-type">int</span> *v5; <span class="hljs-comment">// rax</span><br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt;::reference v6; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt;::value_type *v7; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">size_t</span> r; <span class="hljs-comment">// [rsp+30h] [rbp-50h]</span><br>  <span class="hljs-type">int</span> j; <span class="hljs-comment">// [rsp+38h] [rbp-48h]</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [rsp+3Ch] [rbp-44h]</span><br><br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt;::<span class="hljs-built_in">vector</span>(retstr);<br>  i = <span class="hljs-number">0</span>;<br>  j = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">for</span> ( r = <span class="hljs-number">0LL</span>; r &lt; length; ++r )<br>  &#123;<br>    i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span>;<br>    v3 = IntMakeList(s, i);<br>    j = (<span class="hljs-type">unsigned</span> __int8)(((<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)((j + *v3) &gt;&gt; <span class="hljs-number">31</span>) &gt;&gt; <span class="hljs-number">24</span>) + j + *(_BYTE *)v3)<br>      - ((<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)((j + *v3) &gt;&gt; <span class="hljs-number">31</span>) &gt;&gt; <span class="hljs-number">24</span>);<br>    v4 = IntMakeList(s, j);<br>    v5 = IntMakeList(s, i);<br>    <span class="hljs-built_in">std</span>::swap&lt;<span class="hljs-type">int</span>&gt;(v5, v4);<br>    LODWORD(v4) = *IntMakeList(s, i);<br>    v6 = IntMakeList(s, j);<br>    v7 = IntMakeList(<br>           s,<br>           (<span class="hljs-type">int</span>)((<span class="hljs-type">unsigned</span> __int8)(((<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)(((<span class="hljs-type">int</span>)v4 + *v6) &gt;&gt; <span class="hljs-number">31</span>) &gt;&gt; <span class="hljs-number">24</span>) + (_BYTE)v4 + *(_BYTE *)v6)<br>               - ((<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)(((<span class="hljs-type">int</span>)v4 + *v6) &gt;&gt; <span class="hljs-number">31</span>) &gt;&gt; <span class="hljs-number">24</span>)));<br>    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt;::push_back(retstr, v7);<br>  &#125;<br>  <span class="hljs-keyword">return</span> retstr;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°å‡½æ•°å¯¹è¾“å…¥çš„æ•°æ®è¿›è¡Œäº†é­”æ”¹çš„RC4åŠ å¯†ï¼Œä½†å®é™…ä¸Šæ²¡æœ‰æ”¹å˜RC4åŠ è§£å¯†åŒä¸€ä¸ªå‡½æ•°çš„æ€§è´¨ï¼Œæ‰€ä»¥è§£å¯†åªéœ€è¦å¤ç°è¿™ä¸ªä»£ç å³å¯</p>
<p>ä¸‹é¢å…ˆè·å–å¯†é’¥å’ŒåŠ å¯†åçš„flagæ•°æ®ã€‚åœ¨mainå‡½æ•°ç¬¬ä¸€ä¸ªgetlineå¤„ä¸‹æ–­ç‚¹ï¼Œå¼€å§‹åŠ¨æ€è°ƒè¯•</p>
<p><img src="/../images/image-20251024200050353.png" alt="ç¬¬ä¸€ä¸ªgetlineå¤„ä¸‹æ–­ç‚¹"></p>
<p>éšä¾¿è¾“å…¥ä¸€ä¸ªå­—ç¬¦åä¼šåˆ°é•¿åº¦æ£€æµ‹ï¼Œè¦æ±‚è¾“å…¥çš„å¯†ç é•¿åº¦è¦ç­‰äº12ï¼Œå¯ä»¥è¾“å…¥12ä¸ªå­—ç¬¦ä¹Ÿå¯ä»¥åç»­åˆ°è¿™ä¸ªcmpçš„æ—¶å€™æ”¹jzç»•è¿‡</p>
<p><img src="/../images/image-20251024200525655.png" alt="é•¿åº¦æ£€æµ‹"></p>
<p>è¿‡äº†é•¿åº¦æ£€æµ‹åå°±å¯ä»¥ä¸€ç›´è¿è¡Œåˆ°keyæ£€éªŒå¤„ï¼ŒåŒå‡»ç”Ÿæˆçš„å¯†é’¥çš„å˜é‡å(TrueKey)å°±å¯ä»¥å¾—åˆ°çœŸæ­£çš„keyäº†ï¼ˆä»</p>
<p>hexçª—å£å¯ä»¥çœ‹åˆ°keyå³ä¸ºâ€XaleidscopiXâ€ï¼‰</p>
<p><img src="/../images/image-20251024202016786.png" alt="è¿è¡Œåˆ°keyæ£€éªŒå¤„"></p>
<p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-10-24%20200936.png" alt="çœŸæ­£çš„key"></p>
<p>ç„¶åè¿˜éœ€è¦è·å¾—çœŸæ­£flagçš„åŠ å¯†æ•°æ®ã€‚å¾€ä¸‹ç»•è¿‡keyæ£€éªŒï¼Œè¿è¡Œåˆ°jzçš„æ—¶å€™å†æ”¹ä¸€ä¸‹ZFæ ‡å¿—ä½ï¼ˆæ­¤å¤„åº”å½“è·³è½¬ï¼‰</p>
<p><img src="/../images/image-20251024202256140.png" alt="ç»•è¿‡keyæ£€éªŒ(å·²ç»•è¿‡)"></p>
<p>ç»•è¿‡åç»ˆç«¯è¿˜æœ‰æç¤º</p>
<p><img src="/../images/image-20251024202606398.png" alt="æç¤º"></p>
<p>æ¥ä¸‹æ¥è¿è¡Œåˆ°ç¬¬äºŒä¸ªgetlineï¼Œéšä¾¿è¾“å‡ ä¸ªæ•°æ®ï¼ˆæœ‰é•¿åº¦æ£€éªŒï¼Œæœ€å¥½æ˜¯è¾“å…¥51ä¸ªå­—ç¬¦ï¼Œçœçš„ç»•è¿‡é•¿åº¦æ£€éªŒï¼‰ã€‚ç„¶åç»§ç»­è¿è¡Œåˆ°åŠ å¯†ç»“æœçš„æ£€éªŒå¤„</p>
<p><img src="/../images/image-20251024203359348.png" alt="è¿è¡Œåˆ°åŠ å¯†ç»“æœæ£€éªŒå¤„"></p>
<p>å…¶ä¸­KALEIDXSCOPEçš„ç¬¬ä¸€ä¸ªoffsetå°±æ˜¯æ­£ç¡®çš„flagåŠ å¯†åçš„æ•°æ®</p>
<p><img src="/../images/image-20251024203510922.png" alt="KALEIDXSCOPEç¬¬ä¸€ä¸ªoffset(unk_2692A10)"></p>
<p><img src="/../images/image-20251024203610635.png" alt="æ­£ç¡®flagåŠ å¯†åçš„æ•°æ®"></p>
<p>è§£å¯†è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">rc4_decrypt</span>(<span class="hljs-params">data, key</span>):<br>    S = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))<br>    j = <span class="hljs-number">0</span><br>    out = []<br><br>    <span class="hljs-comment"># Key-scheduling algorithm (KSA)</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        j = (j + S[i] + key[i % <span class="hljs-built_in">len</span>(key)]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br><br>    <span class="hljs-comment"># Pseudo-random generation algorithm (PRGA)</span><br>    i = <span class="hljs-number">0</span><br>    j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> data:<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        j = (j + S[i]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br>        K = S[(S[i] + S[j]) % <span class="hljs-number">256</span>]<br>        out.append(K)<br><br>    <span class="hljs-keyword">return</span> out<br><br>enc=[<span class="hljs-number">0x000000FC</span>, <span class="hljs-number">0x000000EA</span>, <span class="hljs-number">0x00000015</span>, <span class="hljs-number">0x0000002C</span>, <span class="hljs-number">0x00000086</span>, <span class="hljs-number">0x00000038</span>, <span class="hljs-number">0x0000003F</span>, <span class="hljs-number">0x000000F3</span>, <span class="hljs-number">0x00000092</span>, <span class="hljs-number">0x000000CE</span>, <span class="hljs-number">0x000000DA</span>, <span class="hljs-number">0x0000008E</span>, <span class="hljs-number">0x00000048</span>, <span class="hljs-number">0x000000D3</span>, <span class="hljs-number">0x00000007</span>, <span class="hljs-number">0x0000009F</span>, <span class="hljs-number">0x000000D9</span>, <span class="hljs-number">0x00000057</span>, <span class="hljs-number">0x000000B1</span>, <span class="hljs-number">0x000000EE</span>, <span class="hljs-number">0x00000041</span>, <span class="hljs-number">0x0000009A</span>, <span class="hljs-number">0x0000004D</span>, <span class="hljs-number">0x000000C5</span>, <span class="hljs-number">0x00000065</span>, <span class="hljs-number">0x0000006A</span>, <span class="hljs-number">0x000000FF</span>, <span class="hljs-number">0x000000C9</span>, <span class="hljs-number">0x0000005D</span>, <span class="hljs-number">0x00000034</span>, <span class="hljs-number">0x000000AD</span>, <span class="hljs-number">0x000000EA</span>, <span class="hljs-number">0x000000B1</span>, <span class="hljs-number">0x00000020</span>, <span class="hljs-number">0x0000004B</span>, <span class="hljs-number">0x000000DC</span>, <span class="hljs-number">0x000000BD</span>, <span class="hljs-number">0x000000D2</span>, <span class="hljs-number">0x00000035</span>, <span class="hljs-number">0x00000002</span>, <span class="hljs-number">0x00000084</span>, <span class="hljs-number">0x00000035</span>, <span class="hljs-number">0x00000071</span>, <span class="hljs-number">0x000000EC</span>, <span class="hljs-number">0x000000E0</span>, <span class="hljs-number">0x00000048</span>, <span class="hljs-number">0x0000008E</span>, <span class="hljs-number">0x000000EA</span>, <span class="hljs-number">0x0000007B</span>, <span class="hljs-number">0x000000AA</span>, <span class="hljs-number">0x000000CF</span>]<br>_key=<span class="hljs-string">&quot;XaleidscopiX&quot;</span><br>key=[]<br>flag=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> _key:<br>    key.append(<span class="hljs-built_in">ord</span>(i))<br><span class="hljs-comment">#print(key)</span><br><br>keystream=rc4_decrypt(enc, key)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc)):<br>    flag.append(enc[i]^keystream[i]^<span class="hljs-number">7</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#x27;</span>.join([<span class="hljs-built_in">chr</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> flag]))<br></code></pre></td></tr></table></figure></li>
</ul>
<blockquote>
<p>flagï¼š0xGame{RC4_15_4_b4s1c&amp;fl3x1bl3_3ncrYp710n4lg0r17hm}</p>
</blockquote>
<h2 id="Q-â‰§â–½â‰¦-T"><a href="#Q-â‰§â–½â‰¦-T" class="headerlink" title="Q(â‰§â–½â‰¦)T"></a>Q(â‰§â–½â‰¦)T</h2><blockquote>
<p>è€ƒç‚¹ï¼šQTç¨‹åºé€†å‘ã€crackmeã€åŠ¨æ€è°ƒè¯•ã€RC4ã€å“ˆå¸Œæ ¡éªŒ</p>
</blockquote>
<ul>
<li><p>é™„ä»¶ç¨‹åºè¿è¡Œå¦‚å›¾ï¼Œæ˜¯ä¸ªåºåˆ—å·ç”Ÿæˆå™¨ï¼š</p>
<p><img src="/../images/image-20251024212602045.png" alt="è¿è¡Œ"></p>
</li>
<li><p>ç”¨IDAæ‰“å¼€ï¼Œå‡ºç°çš„æ˜¯startå‡½æ•°ï¼Œ çœ‹ä¸å‡ºä»€ä¹ˆä¸œè¥¿æ¥</p>
<p><img src="/../images/image-20251024214150526.png" alt="startå‡½æ•°"></p>
<p>shift+F12çœ‹çœ‹å­—ç¬¦ä¸²è¡¨ï¼Œå¯ä»¥å‘ç°ä¸¤ä¸²å¯ç–‘çš„å­—ç¬¦ä¸²</p>
<p><img src="/../images/image-20251024214208963.png" alt="å¯ç–‘çš„å­—ç¬¦ä¸²"></p>
<p>è·Ÿè¸ªè¿‡å»å¯ä»¥æ‰¾åˆ°è¿™æ ·ä¸€ä¸ªå‡½æ•°</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs C"><span class="hljs-type">void</span> __fastcall <span class="hljs-title function_">sub_140001890</span><span class="hljs-params">(__int64 a1, __int64 a2, __int64 a3, __int64 a4)</span><br>&#123;<br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v5; <span class="hljs-comment">// rax</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v6; <span class="hljs-comment">// [rsp+80h] [rbp-1F8h] BYREF</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v7; <span class="hljs-comment">// [rsp+88h] [rbp-1F0h]</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v8; <span class="hljs-comment">// [rsp+90h] [rbp-1E8h] BYREF</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v9; <span class="hljs-comment">// [rsp+98h] [rbp-1E0h]</span><br>  __int64 Block; <span class="hljs-comment">// [rsp+A0h] [rbp-1D8h] BYREF</span><br>  <span class="hljs-type">const</span> <span class="hljs-type">char</span> *v11; <span class="hljs-comment">// [rsp+A8h] [rbp-1D0h]</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v12[<span class="hljs-number">4</span>]; <span class="hljs-comment">// [rsp+B0h] [rbp-1C8h] BYREF</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v13[<span class="hljs-number">4</span>]; <span class="hljs-comment">// [rsp+D0h] [rbp-1A8h] BYREF</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v14[<span class="hljs-number">4</span>]; <span class="hljs-comment">// [rsp+F0h] [rbp-188h] BYREF</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v15; <span class="hljs-comment">// [rsp+110h] [rbp-168h] BYREF</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v16[<span class="hljs-number">4</span>]; <span class="hljs-comment">// [rsp+130h] [rbp-148h] BYREF</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v17[<span class="hljs-number">2</span>]; <span class="hljs-comment">// [rsp+150h] [rbp-128h] BYREF</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v18; <span class="hljs-comment">// [rsp+160h] [rbp-118h]</span><br>  __m128i v19[<span class="hljs-number">2</span>]; <span class="hljs-comment">// [rsp+170h] [rbp-108h] BYREF</span><br>  __m128i v20; <span class="hljs-comment">// [rsp+190h] [rbp-E8h] BYREF</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v21[<span class="hljs-number">4</span>]; <span class="hljs-comment">// [rsp+1B0h] [rbp-C8h] BYREF</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v22[<span class="hljs-number">2</span>]; <span class="hljs-comment">// [rsp+1D0h] [rbp-A8h] BYREF</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v23; <span class="hljs-comment">// [rsp+1E0h] [rbp-98h]</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v24[<span class="hljs-number">4</span>]; <span class="hljs-comment">// [rsp+1F0h] [rbp-88h] BYREF</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v25[<span class="hljs-number">13</span>]; <span class="hljs-comment">// [rsp+210h] [rbp-68h] BYREF</span><br><br>  ((<span class="hljs-type">void</span> (__fastcall *)(<span class="hljs-type">void</span> *, <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 **, _QWORD, <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 **))QLineEdit::text)(<br>    QLineEdit::text,<br>    v25,<br>    *(_QWORD *)(*(_QWORD *)(a4 + <span class="hljs-number">40</span>) + <span class="hljs-number">16LL</span>),<br>    v25);<br>  QString::trimmed_helper(QLineEdit::text, v25, v25, v12);<br>  <span class="hljs-keyword">if</span> ( v25[<span class="hljs-number">0</span>] &amp;&amp; !_InterlockedSub(v25[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>    <span class="hljs-built_in">free</span>(QLineEdit::text);<br>  ((<span class="hljs-type">void</span> (__fastcall *)(<span class="hljs-type">void</span> *, <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 **, _QWORD, <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 **))QLineEdit::text)(<br>    QLineEdit::text,<br>    v25,<br>    *(_QWORD *)(*(_QWORD *)(a4 + <span class="hljs-number">40</span>) + <span class="hljs-number">24LL</span>),<br>    v13);<br>  <span class="hljs-keyword">if</span> ( v12[<span class="hljs-number">2</span>] == (<span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *)<span class="hljs-number">4</span> )<br>  &#123;<br>    QString::toUtf8_helper(QLineEdit::text, v25, v12, v14);<br>    Block = (__int64)v14[<span class="hljs-number">2</span>];<br>    v11 = (<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)v14[<span class="hljs-number">1</span>];<br>    QCryptographicHash::hash(&amp;Block, v25, &amp;Block, &amp;v15, <span class="hljs-number">4LL</span>);<br>    sub_140001620((__int64)&amp;Block, (__int64)v25, a4, (__int64)v16);<br>    Block = <span class="hljs-number">64LL</span>;<br>    v11 = <span class="hljs-string">&quot;c94201919ec7463313c747d0a27fabcabf1400fa1e9a64d36a6b1a7e7b12ae68&quot;</span>;<br>    QString::fromUtf8(&amp;Block, v25, &amp;Block, v17);<br>    <span class="hljs-keyword">if</span> ( v18 == v16[<span class="hljs-number">2</span>]<br>      &amp;&amp; (v8 = v18, v6 = v18, v9 = v16[<span class="hljs-number">1</span>], v7 = v17[<span class="hljs-number">1</span>], (<span class="hljs-type">unsigned</span> __int8)QtPrivate::equalStrings(&amp;Block, v25, &amp;v6, &amp;v8)) )<br>    &#123;<br>      QString::toUtf8_helper(&amp;Block, v25, v13, v19);<br>      sub_1400016F0((__int64)&amp;Block, (__int64)v25, a4, &amp;v20, v19, (__int64)v14);<br>      sub_140001620((__int64)&amp;Block, (__int64)v25, a4, (__int64)v21);<br>      Block = <span class="hljs-number">72LL</span>;<br>      v11 = <span class="hljs-string">&quot;af33da5e152c15863b3a03c87601899a37d51b8b8168f65aca65352d3669e91959300ccb&quot;</span>;<br>      QString::fromUtf8(&amp;Block, v25, &amp;Block, v22);<br>      <span class="hljs-keyword">if</span> ( v23 == v21[<span class="hljs-number">2</span>]<br>        &amp;&amp; (v8 = v23, v9 = v21[<span class="hljs-number">1</span>],<br>                      v6 = v23,<br>                      v7 = v22[<span class="hljs-number">1</span>],<br>                      (<span class="hljs-type">unsigned</span> __int8)QtPrivate::equalStrings(&amp;Block, v25, &amp;v6, &amp;v8)) )<br>      &#123;<br>        Block = <span class="hljs-number">21LL</span>;<br>        v11 = (<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)&amp;unk_1400061D8;<br>        QString::fromUtf8(&amp;Block, v25, &amp;Block, v25);<br>        Block = <span class="hljs-number">12LL</span>;<br>        v11 = (<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)&amp;unk_1400061EE;<br>        QString::fromUtf8(&amp;Block, v25, &amp;Block, v24);<br>        QMessageBox::information(&amp;Block, v25, v24, a4, v25, <span class="hljs-number">1024LL</span>);<br>      &#125;<br>      <span class="hljs-keyword">else</span><br>      &#123;<br>        Block = <span class="hljs-number">22LL</span>;<br>        v11 = (<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)&amp;unk_1400061C1;<br>        QString::fromUtf8(&amp;Block, v25, &amp;Block, v25);<br>        Block = <span class="hljs-number">12LL</span>;<br>        v11 = (<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)&amp;unk_140006104;<br>        QString::fromUtf8(&amp;Block, v25, &amp;Block, v24);<br>        QMessageBox::warning(&amp;Block, v25, v24, a4, v25, <span class="hljs-number">1024LL</span>);<br>      &#125;<br>      <span class="hljs-keyword">if</span> ( v24[<span class="hljs-number">0</span>] &amp;&amp; !_InterlockedSub(v24[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>        <span class="hljs-built_in">free</span>(&amp;Block);<br>      <span class="hljs-keyword">if</span> ( v25[<span class="hljs-number">0</span>] &amp;&amp; !_InterlockedSub(v25[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>        <span class="hljs-built_in">free</span>(&amp;Block);<br>      <span class="hljs-keyword">if</span> ( v22[<span class="hljs-number">0</span>] &amp;&amp; !_InterlockedSub(v22[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>        <span class="hljs-built_in">free</span>(&amp;Block);<br>      <span class="hljs-keyword">if</span> ( v21[<span class="hljs-number">0</span>] &amp;&amp; !_InterlockedSub(v21[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>        <span class="hljs-built_in">free</span>(&amp;Block);<br>      <span class="hljs-keyword">if</span> ( v20.m128i_i64[<span class="hljs-number">0</span>] &amp;&amp; !_InterlockedSub((<span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *)v20.m128i_i64[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>        <span class="hljs-built_in">free</span>(&amp;Block);<br>      <span class="hljs-keyword">if</span> ( !v19[<span class="hljs-number">0</span>].m128i_i64[<span class="hljs-number">0</span>] || _InterlockedSub((<span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *)v19[<span class="hljs-number">0</span>].m128i_i64[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>        <span class="hljs-keyword">goto</span> LABEL_45;<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>      Block = <span class="hljs-number">25LL</span>;<br>      v11 = (<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)&amp;unk_140006159;<br>      QString::fromUtf8(&amp;Block, v25, &amp;Block, v25);<br>      Block = <span class="hljs-number">12LL</span>;<br>      v11 = (<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)&amp;unk_140006104;<br>      QString::fromUtf8(&amp;Block, v25, &amp;Block, v24);<br>      QMessageBox::warning(&amp;Block, v25, v24, a4, v25, <span class="hljs-number">1024LL</span>);<br>      <span class="hljs-keyword">if</span> ( v24[<span class="hljs-number">0</span>] &amp;&amp; !_InterlockedSub(v24[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>        <span class="hljs-built_in">free</span>(&amp;Block);<br>      <span class="hljs-keyword">if</span> ( !v25[<span class="hljs-number">0</span>] || _InterlockedSub(v25[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>        <span class="hljs-keyword">goto</span> LABEL_45;<br>    &#125;<br>    <span class="hljs-built_in">free</span>(&amp;Block);<br>LABEL_45:<br>    <span class="hljs-keyword">if</span> ( v17[<span class="hljs-number">0</span>] &amp;&amp; !_InterlockedSub(v17[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>      <span class="hljs-built_in">free</span>(&amp;Block);<br>    <span class="hljs-keyword">if</span> ( v16[<span class="hljs-number">0</span>] &amp;&amp; !_InterlockedSub(v16[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>      <span class="hljs-built_in">free</span>(&amp;Block);<br>    <span class="hljs-keyword">if</span> ( v15 &amp;&amp; !_InterlockedSub(v15, <span class="hljs-number">1u</span>) )<br>      <span class="hljs-built_in">free</span>(&amp;Block);<br>    <span class="hljs-keyword">if</span> ( v14[<span class="hljs-number">0</span>] &amp;&amp; !_InterlockedSub(v14[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>      <span class="hljs-built_in">free</span>(&amp;Block);<br>    <span class="hljs-keyword">goto</span> LABEL_10;<br>  &#125;<br>  Block = <span class="hljs-number">35LL</span>;<br>  v11 = (<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)&amp;unk_1400060E0;<br>  QString::fromUtf8(&amp;Block, v25, &amp;Block, v25);<br>  Block = <span class="hljs-number">12LL</span>;<br>  v11 = (<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)&amp;unk_140006104;<br>  QString::fromUtf8(&amp;Block, v25, &amp;Block, v24);<br>  QMessageBox::warning(&amp;Block, v25, v24, a4, v25, <span class="hljs-number">1024LL</span>);<br>  <span class="hljs-keyword">if</span> ( v24[<span class="hljs-number">0</span>] &amp;&amp; !_InterlockedSub(v24[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>  &#123;<br>    <span class="hljs-built_in">free</span>(&amp;Block);<br>    v5 = v25[<span class="hljs-number">0</span>];<br>    <span class="hljs-keyword">if</span> ( !v25[<span class="hljs-number">0</span>] )<br>      <span class="hljs-keyword">goto</span> LABEL_10;<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    v5 = v25[<span class="hljs-number">0</span>];<br>    <span class="hljs-keyword">if</span> ( !v25[<span class="hljs-number">0</span>] )<br>      <span class="hljs-keyword">goto</span> LABEL_10;<br>  &#125;<br>  <span class="hljs-keyword">if</span> ( !_InterlockedSub(v5, <span class="hljs-number">1u</span>) )<br>    <span class="hljs-built_in">free</span>(&amp;Block);<br>LABEL_10:<br>  <span class="hljs-keyword">if</span> ( v13[<span class="hljs-number">0</span>] &amp;&amp; !_InterlockedSub(v13[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>    <span class="hljs-built_in">free</span>(&amp;Block);<br>  <span class="hljs-keyword">if</span> ( v12[<span class="hljs-number">0</span>] )<br>  &#123;<br>    <span class="hljs-keyword">if</span> ( !_InterlockedSub(v12[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>      <span class="hljs-built_in">free</span>(&amp;Block);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>ç¨‹åºçš„å›¾å½¢åŒ–ç•Œé¢æ˜¯QTå®ç°çš„ï¼Œå¼•å…¥äº†QTçš„å¾ˆå¤šç±»ï¼Œæ‰€ä»¥é˜…è¯»éš¾åº¦è¿˜æ˜¯æœ‰ç‚¹å¤§çš„ã€‚å€ŸåŠ©AIä¼˜åŒ–ä¸€ä¸‹ä»¥åŠä¸€ç‚¹ç‚¹åŠ¨æ€è°ƒè¯•è¾…åŠ©åˆ†æå¯ä»¥å¾—åˆ°ï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-type">void</span> __fastcall <span class="hljs-title function_">check</span><span class="hljs-params">(__int64 a1, __int64 a2, __int64 a3, __int64 mainWindows)</span><br>&#123;<br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v5; <span class="hljs-comment">// rax</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v6; <span class="hljs-comment">// [rsp+80h] [rbp-1F8h] BYREF</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v7; <span class="hljs-comment">// [rsp+88h] [rbp-1F0h]</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v8; <span class="hljs-comment">// [rsp+90h] [rbp-1E8h] BYREF</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v9; <span class="hljs-comment">// [rsp+98h] [rbp-1E0h]</span><br>  __int64 Block; <span class="hljs-comment">// [rsp+A0h] [rbp-1D8h] BYREF</span><br>  <span class="hljs-type">const</span> <span class="hljs-type">char</span> *stringData; <span class="hljs-comment">// [rsp+A8h] [rbp-1D0h]</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *usernameUtf8[<span class="hljs-number">4</span>]; <span class="hljs-comment">// [rsp+B0h] [rbp-1C8h] BYREF</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *passwordUtf8[<span class="hljs-number">4</span>]; <span class="hljs-comment">// [rsp+D0h] [rbp-1A8h] BYREF</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *usernameBytes[<span class="hljs-number">4</span>]; <span class="hljs-comment">// [rsp+F0h] [rbp-188h] BYREF</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *usernameHash; <span class="hljs-comment">// [rsp+110h] [rbp-168h] BYREF</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *usernameHashHex[<span class="hljs-number">4</span>]; <span class="hljs-comment">// [rsp+130h] [rbp-148h] BYREF</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v17[<span class="hljs-number">2</span>]; <span class="hljs-comment">// [rsp+150h] [rbp-128h] BYREF</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *expectedUserHashSize; <span class="hljs-comment">// [rsp+160h] [rbp-118h]</span><br>  __m128i passwordBytes[<span class="hljs-number">2</span>]; <span class="hljs-comment">// [rsp+170h] [rbp-108h] BYREF</span><br>  __m128i v20; <span class="hljs-comment">// [rsp+190h] [rbp-E8h] BYREF</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v21[<span class="hljs-number">4</span>]; <span class="hljs-comment">// [rsp+1B0h] [rbp-C8h] BYREF</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v22[<span class="hljs-number">2</span>]; <span class="hljs-comment">// [rsp+1D0h] [rbp-A8h] BYREF</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v23; <span class="hljs-comment">// [rsp+1E0h] [rbp-98h]</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v24[<span class="hljs-number">4</span>]; <span class="hljs-comment">// [rsp+1F0h] [rbp-88h] BYREF</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *tempBuffer[<span class="hljs-number">13</span>]; <span class="hljs-comment">// [rsp+210h] [rbp-68h] BYREF</span><br><br>  (QLineEdit::text)(QLineEdit::text, tempBuffer, *(*(mainWindows + <span class="hljs-number">40</span>) + <span class="hljs-number">16LL</span>), tempBuffer);<br>  QString::trimmed_helper(QLineEdit::text, tempBuffer, tempBuffer, usernameUtf8);<br>  <span class="hljs-keyword">if</span> ( tempBuffer[<span class="hljs-number">0</span>] &amp;&amp; !_InterlockedSub(tempBuffer[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>    <span class="hljs-built_in">free</span>(QLineEdit::text);<br>  (QLineEdit::text)(QLineEdit::text, tempBuffer, *(*(mainWindows + <span class="hljs-number">40</span>) + <span class="hljs-number">24LL</span>), passwordUtf8);<br>  <span class="hljs-keyword">if</span> ( usernameUtf8[<span class="hljs-number">2</span>] == <span class="hljs-number">4</span> )                   <span class="hljs-comment">// é•¿åº¦æ£€éªŒ</span><br>  &#123;<br>    QString::toUtf8_helper(QLineEdit::text, tempBuffer, usernameUtf8, usernameBytes);<br>    Block = usernameBytes[<span class="hljs-number">2</span>];<br>    stringData = usernameBytes[<span class="hljs-number">1</span>];<br>    QCryptographicHash::hash(&amp;Block, tempBuffer, &amp;Block, &amp;usernameHash, <span class="hljs-number">4LL</span>);<span class="hljs-comment">// æ±‚è¾“å…¥çš„ç”¨æˆ·åhash</span><br>    toHex(&amp;Block, tempBuffer, mainWindows, usernameHashHex);<br>    Block = <span class="hljs-number">64LL</span>;<br>    stringData = <span class="hljs-string">&quot;c94201919ec7463313c747d0a27fabcabf1400fa1e9a64d36a6b1a7e7b12ae68&quot;</span>;<span class="hljs-comment">// é¢„è®¾å“ˆå¸Œå€¼</span><br>    QString::fromUtf8(&amp;Block, tempBuffer, &amp;Block, v17);<br>    <span class="hljs-keyword">if</span> ( expectedUserHashSize == usernameHashHex[<span class="hljs-number">2</span>]<br>      &amp;&amp; (v8 = expectedUserHashSize,<br>          v6 = expectedUserHashSize,<br>          v9 = usernameHashHex[<span class="hljs-number">1</span>],<br>          v7 = v17[<span class="hljs-number">1</span>],<br>          QtPrivate::equalStrings(&amp;Block, tempBuffer, &amp;v6, &amp;v8)) )<span class="hljs-comment">// ç”¨æˆ·åæ£€éªŒ</span><br>    &#123;<br>      QString::toUtf8_helper(&amp;Block, tempBuffer, passwordUtf8, passwordBytes);<br>      RC4(&amp;Block, tempBuffer, mainWindows, &amp;v20, passwordBytes, usernameBytes);<br>      toHex(&amp;Block, tempBuffer, mainWindows, v21);<br>      Block = <span class="hljs-number">72LL</span>;<br>      stringData = <span class="hljs-string">&quot;af33da5e152c15863b3a03c87601899a37d51b8b8168f65aca65352d3669e91959300ccb&quot;</span>;<br>      QString::fromUtf8(&amp;Block, tempBuffer, &amp;Block, v22);<br>      <span class="hljs-keyword">if</span> ( v23 == v21[<span class="hljs-number">2</span>]<br>        &amp;&amp; (v8 = v23, v9 = v21[<span class="hljs-number">1</span>], v6 = v23, v7 = v22[<span class="hljs-number">1</span>], QtPrivate::equalStrings(&amp;Block, tempBuffer, &amp;v6, &amp;v8)) )<span class="hljs-comment">// éªŒè¯é€šè¿‡</span><br>      &#123;<br>        Block = <span class="hljs-number">21LL</span>;<br>        stringData = &amp;unk_7FF7F2EB61D8;<br>        QString::fromUtf8(&amp;Block, tempBuffer, &amp;Block, tempBuffer);<br>        Block = <span class="hljs-number">12LL</span>;<br>        stringData = &amp;unk_7FF7F2EB61EE;<br>        QString::fromUtf8(&amp;Block, tempBuffer, &amp;Block, v24);<br>        QMessageBox::information(&amp;Block, tempBuffer, v24, mainWindows, tempBuffer, <span class="hljs-number">1024LL</span>);<br>      &#125;<br>      <span class="hljs-keyword">else</span>                                      <span class="hljs-comment">// å¯†ç éªŒè¯ä¸é€šè¿‡</span><br>      &#123;<br>        Block = <span class="hljs-number">22LL</span>;<br>        stringData = &amp;unk_7FF7F2EB61C1;<br>        QString::fromUtf8(&amp;Block, tempBuffer, &amp;Block, tempBuffer);<br>        Block = <span class="hljs-number">12LL</span>;<br>        stringData = &amp;unk_7FF7F2EB6104;<br>        QString::fromUtf8(&amp;Block, tempBuffer, &amp;Block, v24);<br>        QMessageBox::warning(&amp;Block, tempBuffer, v24, mainWindows, tempBuffer, <span class="hljs-number">1024LL</span>);<br>      &#125;<br>      <span class="hljs-keyword">if</span> ( v24[<span class="hljs-number">0</span>] &amp;&amp; !_InterlockedSub(v24[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>        <span class="hljs-built_in">free</span>(&amp;Block);<br>      <span class="hljs-keyword">if</span> ( tempBuffer[<span class="hljs-number">0</span>] &amp;&amp; !_InterlockedSub(tempBuffer[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>        <span class="hljs-built_in">free</span>(&amp;Block);<br>      <span class="hljs-keyword">if</span> ( v22[<span class="hljs-number">0</span>] &amp;&amp; !_InterlockedSub(v22[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>        <span class="hljs-built_in">free</span>(&amp;Block);<br>      <span class="hljs-keyword">if</span> ( v21[<span class="hljs-number">0</span>] &amp;&amp; !_InterlockedSub(v21[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>        <span class="hljs-built_in">free</span>(&amp;Block);<br>      <span class="hljs-keyword">if</span> ( v20.m128i_i64[<span class="hljs-number">0</span>] &amp;&amp; !_InterlockedSub(v20.m128i_i64[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>        <span class="hljs-built_in">free</span>(&amp;Block);<br>      <span class="hljs-keyword">if</span> ( !passwordBytes[<span class="hljs-number">0</span>].m128i_i64[<span class="hljs-number">0</span>] || _InterlockedSub(passwordBytes[<span class="hljs-number">0</span>].m128i_i64[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>        <span class="hljs-keyword">goto</span> LABEL_45;<br>    &#125;<br>    <span class="hljs-keyword">else</span>                                        <span class="hljs-comment">// ç”¨æˆ·åéªŒè¯ä¸é€šè¿‡</span><br>    &#123;<br>      Block = <span class="hljs-number">25LL</span>;<br>      stringData = &amp;unk_7FF7F2EB6159;<br>      QString::fromUtf8(&amp;Block, tempBuffer, &amp;Block, tempBuffer);<br>      Block = <span class="hljs-number">12LL</span>;<br>      stringData = &amp;unk_7FF7F2EB6104;<br>      QString::fromUtf8(&amp;Block, tempBuffer, &amp;Block, v24);<br>      QMessageBox::warning(&amp;Block, tempBuffer, v24, mainWindows, tempBuffer, <span class="hljs-number">1024LL</span>);<br>      <span class="hljs-keyword">if</span> ( v24[<span class="hljs-number">0</span>] &amp;&amp; !_InterlockedSub(v24[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>        <span class="hljs-built_in">free</span>(&amp;Block);<br>      <span class="hljs-keyword">if</span> ( !tempBuffer[<span class="hljs-number">0</span>] || _InterlockedSub(tempBuffer[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>        <span class="hljs-keyword">goto</span> LABEL_45;<br>    &#125;<br>    <span class="hljs-built_in">free</span>(&amp;Block);<br>LABEL_45:<br>    <span class="hljs-keyword">if</span> ( v17[<span class="hljs-number">0</span>] &amp;&amp; !_InterlockedSub(v17[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>      <span class="hljs-built_in">free</span>(&amp;Block);<br>    <span class="hljs-keyword">if</span> ( usernameHashHex[<span class="hljs-number">0</span>] &amp;&amp; !_InterlockedSub(usernameHashHex[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>      <span class="hljs-built_in">free</span>(&amp;Block);<br>    <span class="hljs-keyword">if</span> ( usernameHash &amp;&amp; !_InterlockedSub(usernameHash, <span class="hljs-number">1u</span>) )<br>      <span class="hljs-built_in">free</span>(&amp;Block);<br>    <span class="hljs-keyword">if</span> ( usernameBytes[<span class="hljs-number">0</span>] &amp;&amp; !_InterlockedSub(usernameBytes[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>      <span class="hljs-built_in">free</span>(&amp;Block);<br>    <span class="hljs-keyword">goto</span> LABEL_10;<br>  &#125;<br>  Block = <span class="hljs-number">35LL</span>;<br>  stringData = &amp;unk_7FF7F2EB60E0;<br>  QString::fromUtf8(&amp;Block, tempBuffer, &amp;Block, tempBuffer);<br>  Block = <span class="hljs-number">12LL</span>;<br>  stringData = &amp;unk_7FF7F2EB6104;<br>  QString::fromUtf8(&amp;Block, tempBuffer, &amp;Block, v24);<br>  QMessageBox::warning(&amp;Block, tempBuffer, v24, mainWindows, tempBuffer, <span class="hljs-number">1024LL</span>);<br>  <span class="hljs-keyword">if</span> ( v24[<span class="hljs-number">0</span>] &amp;&amp; !_InterlockedSub(v24[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>  &#123;<br>    <span class="hljs-built_in">free</span>(&amp;Block);<br>    v5 = tempBuffer[<span class="hljs-number">0</span>];<br>    <span class="hljs-keyword">if</span> ( !tempBuffer[<span class="hljs-number">0</span>] )<br>      <span class="hljs-keyword">goto</span> LABEL_10;<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    v5 = tempBuffer[<span class="hljs-number">0</span>];<br>    <span class="hljs-keyword">if</span> ( !tempBuffer[<span class="hljs-number">0</span>] )<br>      <span class="hljs-keyword">goto</span> LABEL_10;<br>  &#125;<br>  <span class="hljs-keyword">if</span> ( !_InterlockedSub(v5, <span class="hljs-number">1u</span>) )<br>    <span class="hljs-built_in">free</span>(&amp;Block);<br>LABEL_10:<br>  <span class="hljs-keyword">if</span> ( passwordUtf8[<span class="hljs-number">0</span>] &amp;&amp; !_InterlockedSub(passwordUtf8[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>    <span class="hljs-built_in">free</span>(&amp;Block);<br>  <span class="hljs-keyword">if</span> ( usernameUtf8[<span class="hljs-number">0</span>] )<br>  &#123;<br>    <span class="hljs-keyword">if</span> ( !_InterlockedSub(usernameUtf8[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>      <span class="hljs-built_in">free</span>(&amp;Block);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°ç”¨æˆ·åé‡‡ç”¨çš„æ˜¯å“ˆå¸Œæ£€éªŒï¼Œå¯†ç é‡‡ç”¨çš„æ˜¯RC4æ£€éªŒï¼Œå¯†é’¥ä¸ºç”¨æˆ·åã€‚</p>
<p>å¯†ç æ£€éªŒå¥—åœ¨ç”¨æˆ·åæ£€éªŒé‡Œï¼Œæ‰€ä»¥ç¬¬ä¸€æ­¥å…ˆè§£å‡ºç”¨æˆ·åã€‚å€ŸåŠ©åœ¨çº¿è§£å¯†ç½‘ç«™<a href="https://hashes.com/zh/decrypt/hash">MD5 åœ¨ç·šå…è²»è§£å¯†</a>å¯ä»¥å¾—åˆ°ç”¨æˆ·åâ€Kathâ€ï¼š</p>
<p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-10-20%20215617.png" alt="sha256è§£å¯†å¾—åˆ°ç”¨æˆ·å"></p>
<p>æ¥ä¸‹æ¥æ±‚è§£å¯†ç ã€‚RC4å‡½æ•°å¦‚ä¸‹ï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs C">__m128i *__fastcall <span class="hljs-title function_">RC4</span><span class="hljs-params">(</span><br><span class="hljs-params">        __int64 a1,</span><br><span class="hljs-params">        __int64 a2,</span><br><span class="hljs-params">        __int64 a3,</span><br><span class="hljs-params">        __m128i *a4,</span><br><span class="hljs-params">        <span class="hljs-type">const</span> __m128i *passwordBytes,</span><br><span class="hljs-params">        __int64 usernameBytes)</span><br>&#123;<br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v6; <span class="hljs-comment">// rax</span><br>  __int64 v7; <span class="hljs-comment">// rdx</span><br>  <span class="hljs-type">bool</span> v8; <span class="hljs-comment">// zf</span><br>  <span class="hljs-type">int</span> keyLength; <span class="hljs-comment">// r11d</span><br>  <span class="hljs-type">int</span> *sBoxPtr; <span class="hljs-comment">// r8</span><br>  __m128i initVal; <span class="hljs-comment">// xmm0</span><br>  __m128i *sBoxInitPtr; <span class="hljs-comment">// rax</span><br>  __m128i v15; <span class="hljs-comment">// xmm2</span><br>  __m128i currentVal; <span class="hljs-comment">// xmm1</span><br>  __int64 keyBytes; <span class="hljs-comment">// rdi</span><br>  <span class="hljs-type">int</span> i_ksa; <span class="hljs-comment">// ecx</span><br>  <span class="hljs-type">int</span> j_ksa; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v20; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">int</span> sBoxVal; <span class="hljs-comment">// r10d</span><br>  __int64 sum; <span class="hljs-comment">// kr00_8</span><br>  __int64 passwordIndex; <span class="hljs-comment">// r12</span><br>  <span class="hljs-type">int</span> j; <span class="hljs-comment">// ebp</span><br>  __int64 i; <span class="hljs-comment">// rdi</span><br>  <span class="hljs-type">int</span> temp; <span class="hljs-comment">// eax</span><br>  __int64 v27; <span class="hljs-comment">// kr08_8</span><br>  <span class="hljs-type">char</span> v28; <span class="hljs-comment">// r14</span><br>  _DWORD S[<span class="hljs-number">256</span>]; <span class="hljs-comment">// [rsp+20h] [rbp-438h] BYREF</span><br>  <span class="hljs-type">char</span> v31; <span class="hljs-comment">// [rsp+420h] [rbp-38h] BYREF</span><br><br>  v6 = passwordBytes-&gt;m128i_i64[<span class="hljs-number">0</span>];<br>  v7 = passwordBytes[<span class="hljs-number">1</span>].m128i_i64[<span class="hljs-number">0</span>];<br>  v8 = passwordBytes-&gt;m128i_i64[<span class="hljs-number">0</span>] == <span class="hljs-number">0</span>;<br>  *a4 = _mm_loadu_si128(passwordBytes);<br>  a4[<span class="hljs-number">1</span>].m128i_i64[<span class="hljs-number">0</span>] = v7;<br>  <span class="hljs-keyword">if</span> ( !v8 )<br>    _InterlockedAdd(v6, <span class="hljs-number">1u</span>);<br>  keyLength = *(usernameBytes + <span class="hljs-number">16</span>);<br>  sBoxPtr = S;<br>  initVal = _mm_load_si128(&amp;xmmword_7FF7F2EB6200);<br>  sBoxInitPtr = S;<br>  v15 = _mm_load_si128(&amp;xmmword_7FF7F2EB6210);<br>  <span class="hljs-keyword">do</span><br>  &#123;<br>    currentVal = initVal;<br>    ++sBoxInitPtr;<br>    initVal = _mm_add_epi32(initVal, v15);<br>    sBoxInitPtr[<span class="hljs-number">-1</span>] = currentVal;<br>  &#125;<br>  <span class="hljs-keyword">while</span> ( sBoxInitPtr != &amp;v31 );<br>  keyBytes = *(usernameBytes + <span class="hljs-number">8</span>);<br>  i_ksa = <span class="hljs-number">0</span>;<br>  j_ksa = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">do</span>                                            <span class="hljs-comment">// RC4_KSA</span><br>  &#123;<br>    v20 = i_ksa;<br>    sBoxVal = *sBoxPtr;<br>    ++i_ksa;<br>    ++sBoxPtr;<br>    sum = sBoxVal + j_ksa + *(keyBytes + v20 % keyLength);<br>    j_ksa = (HIBYTE(sum) + sum) - HIBYTE(HIDWORD(sum));<span class="hljs-comment">// j = j % 256</span><br>    *(sBoxPtr - <span class="hljs-number">1</span>) = S[j_ksa];<br>    S[j_ksa] = sBoxVal;<br>  &#125;<br>  <span class="hljs-keyword">while</span> ( i_ksa != <span class="hljs-number">256</span> );<br>  <span class="hljs-keyword">if</span> ( passwordBytes[<span class="hljs-number">1</span>].m128i_i64[<span class="hljs-number">0</span>] &gt; <span class="hljs-number">0</span> )      <span class="hljs-comment">// RC4_PRGAå’ŒRC4decrypt</span><br>  &#123;<br>    passwordIndex = <span class="hljs-number">0LL</span>;<br>    j = <span class="hljs-number">0</span>;<br>    LODWORD(i) = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">do</span><br>    &#123;<br>      i = ((i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span>);<br>      temp = S[i];<br>      j = (temp + j) % <span class="hljs-number">256</span>;<br>      S[i] = S[j];<br>      S[j] = temp;<br>      v27 = S[i] + temp;<br>      v28 = *(passwordBytes-&gt;m128i_i64[<span class="hljs-number">1</span>] + passwordIndex) ^ S[(HIBYTE(v27) + v27) - HIBYTE(HIDWORD(v27))];<span class="hljs-comment">// v28 = passwordBytes[passwordIndex] ^ S[(S[i]+S[j])%256]</span><br>      <span class="hljs-keyword">if</span> ( !a4-&gt;m128i_i64[<span class="hljs-number">0</span>] || *a4-&gt;m128i_i64[<span class="hljs-number">0</span>] &gt; <span class="hljs-number">1</span> )<br>        QByteArray::reallocData(i, passwordBytes, a4[<span class="hljs-number">1</span>].m128i_i64[<span class="hljs-number">0</span>], a4, <span class="hljs-number">1LL</span>, *initVal.m128i_i64);<br>      *(a4-&gt;m128i_i64[<span class="hljs-number">1</span>] + passwordIndex++) = v28;<br>    &#125;<br>    <span class="hljs-keyword">while</span> ( passwordBytes[<span class="hljs-number">1</span>].m128i_i64[<span class="hljs-number">0</span>] &gt; passwordIndex );<br>  &#125;<br>  <span class="hljs-keyword">return</span> a4;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹å‡ºæ˜¯æ ‡å‡†çš„RC4ï¼Œç›´æ¥å¤ç°åŠ å¯†å‡½æ•°å³å¯ã€‚è§£å¯†è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">rc4_ksa</span>(<span class="hljs-params">key</span>):<br>    S = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))<br>    j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        j = (j + S[i] + key[i % <span class="hljs-built_in">len</span>(key)]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br>    <span class="hljs-keyword">return</span> S<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rc4_prga</span>(<span class="hljs-params">S, n</span>):<br>    i = j = <span class="hljs-number">0</span><br>    keystream = []<br>    S = S[:]  <span class="hljs-comment"># copy</span><br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        j = (j + S[i]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br>        k = S[(S[i] + S[j]) % <span class="hljs-number">256</span>]<br>        keystream.append(k)<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(keystream)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rc4_decrypt</span>(<span class="hljs-params">key, ciphertext</span>):<br>    S = rc4_ksa(key)<br>    ks = rc4_prga(S, <span class="hljs-built_in">len</span>(ciphertext))<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(c ^ k <span class="hljs-keyword">for</span> c, k <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(ciphertext, ks))<br><br>key = <span class="hljs-string">b&quot;Kath&quot;</span><br>cipher = <span class="hljs-string">&quot;af33da5e152c15863b3a03c87601899a37d51b8b8168f65aca65352d3669e91959300ccb&quot;</span><br><br><span class="hljs-comment"># è½¬æˆbytes</span><br>ciphertext = <span class="hljs-built_in">bytes</span>.fromhex(cipher)<br><br><span class="hljs-comment"># è§£å¯†</span><br>plaintext = rc4_decrypt(key, ciphertext)<br><br><span class="hljs-comment"># è¾“å‡º</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Plaintext:&quot;</span>, plaintext)<br><br></code></pre></td></tr></table></figure></li>
</ul>
<blockquote>
<p>flagï¼š0xGame{ce5e5621-3d6b-4429-b72a-957abf353390}</p>
</blockquote>
<h2 id="Calamity-Fortune"><a href="#Calamity-Fortune" class="headerlink" title="Calamity_Fortune"></a>Calamity_Fortune</h2><blockquote>
<p><del>è¿™é¢˜ï¼Œå“ˆå“ˆï¼Œæ•°æ®æå–é”™äº†é¢˜ç›®æˆªæ­¢æäº¤48åˆ†é’Ÿåæˆ‘æ‰å‘ç°è¿™ä¸ªé—®é¢˜è§£å‡ºflagğŸ˜„ğŸ« æˆ‘æ°¸è¿œéƒ½ä¸ä¼šåŸè°…æˆ‘è‡ªå·±äº†ğŸ˜„å“ˆå“ˆå“ˆå“ˆ</del></p>
<p>è€ƒç‚¹ï¼šå‡½æ•°é‡å†™ã€å¤æ‚åŠ å¯†ç®—æ³•é€†å‘ã€åŠ¨æ€è°ƒè¯•ç»•è¿‡ç¨‹åºæœºåˆ¶</p>
</blockquote>
<ul>
<li><p>é™„ä»¶ç¨‹åºåŒå‡»è¿è¡Œä¼šæç¤ºå¦‚å›¾</p>
<p><img src="/../images/image-20251021220052848.png" alt="åŒå‡»æç¤º"></p>
<p>ç„¶è€Œï¼Œéšä¾¿è¾“ä¸€ä¸ªæ•°å­—çš„è¯ä¼šé—ªé€€</p>
</li>
<li><p>ç¨‹åºç”¨IDAæ‰“å¼€ï¼Œmainå‡½æ•°åç¼–è¯‘å¦‚ä¸‹ï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs C"><span class="hljs-type">int</span> __fastcall <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **argv, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **envp)</span><br>&#123;<br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v3; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">int</span> v4; <span class="hljs-comment">// ebx</span><br>  <span class="hljs-type">int</span> v5; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">int</span> v6; <span class="hljs-comment">// ecx</span><br>  __int64 v7; <span class="hljs-comment">// rbx</span><br>  <span class="hljs-type">char</span> v8; <span class="hljs-comment">// cl</span><br>  <span class="hljs-type">int</span> v10; <span class="hljs-comment">// [rsp+20h] [rbp-58h] BYREF</span><br>  <span class="hljs-type">char</span> v11[<span class="hljs-number">9</span>]; <span class="hljs-comment">// [rsp+27h] [rbp-51h] BYREF</span><br>  _QWORD v12[<span class="hljs-number">5</span>]; <span class="hljs-comment">// [rsp+30h] [rbp-48h]</span><br>  <span class="hljs-type">int</span> v13; <span class="hljs-comment">// [rsp+58h] [rbp-20h]</span><br>  __int16 v14; <span class="hljs-comment">// [rsp+5Ch] [rbp-1Ch]</span><br><br>  sub_401600(argc, argv, envp);<br>  SetConsoleOutputCP(<span class="hljs-number">0xFDE9u</span>);<br>  SetConsoleCP(<span class="hljs-number">0xFDE9u</span>);<br>  v3 = time64(<span class="hljs-number">0LL</span>);<br>  srand(v3);<br>  v10 = <span class="hljs-number">0</span>;<br>  v4 = rand();<br>  <span class="hljs-built_in">puts</span>(&amp;Buffer);<br>  v5 = <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;v10);<br>  v6 = <span class="hljs-number">1</span>;<br>  <span class="hljs-keyword">if</span> ( v5 == <span class="hljs-number">1</span> )<br>  &#123;<br>    <span class="hljs-keyword">if</span> ( v10 == v4 % <span class="hljs-number">100</span> + <span class="hljs-number">1</span> )<br>    &#123;<br>      MessageBoxA(<span class="hljs-number">0LL</span>, <span class="hljs-string">&quot;You guessed right! Is it really right?&quot;</span>, <span class="hljs-string">&quot;Result&quot;</span>, <span class="hljs-number">0</span>);<br>      <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>      v7 = <span class="hljs-number">0LL</span>;<br>      <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;You guessed it wrong!&quot;</span>);<br>      <span class="hljs-built_in">puts</span>(&amp;byte_405098);<br>      v12[<span class="hljs-number">0</span>] = <span class="hljs-number">0xD0F0C00002B1973L</span>L;<br>      v12[<span class="hljs-number">1</span>] = <span class="hljs-number">0x182B1A043E1F082BL</span>L;<br>      v12[<span class="hljs-number">2</span>] = <span class="hljs-number">0x151236080A0D071CL</span>L;<br>      v12[<span class="hljs-number">3</span>] = <span class="hljs-number">0xA150C0111330622L</span>L;<br>      v12[<span class="hljs-number">4</span>] = <span class="hljs-number">0xD2B190804073E26L</span>L;<br>      v13 = <span class="hljs-number">251992113</span>;<br>      v14 = <span class="hljs-number">5130</span>;<br>      <span class="hljs-built_in">strcpy</span>(v11, <span class="hljs-string">&quot;Calamity&quot;</span>);<br>      <span class="hljs-keyword">do</span><br>      &#123;<br>        v8 = *((_BYTE *)v12 + v7) ^ v11[v7 &amp; <span class="hljs-number">7</span>];<br>        ++v7;<br>        <span class="hljs-built_in">putchar</span>(v8);<br>      &#125;<br>      <span class="hljs-keyword">while</span> ( v7 != <span class="hljs-number">46</span> );<br>      <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">return</span> v6;<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>v12çœ‹ç€åƒå¯†æ–‡ï¼Œçš„ç¡®æ˜¯å¯†æ–‡ï¼Œä½†ä¸æ˜¯flagçš„å¯†æ–‡ï¼Œå› ä¸ºå®ƒåœ¨è¾“å…¥é”™è¯¯çš„æç¤ºé‡Œã€‚æš‚æ—¶æ²¡æœ‰å‘ç°flagæ£€éªŒå‡½æ•°ï¼Œå°è¯•å…ˆç»•è¿‡æ•°å­—æ£€éªŒ</p>
<p>åœ¨æ±‡ç¼–çª—å£æ‰¾åˆ°æ•°å­—åˆ¤æ–­è¯­å¥ï¼ˆå¯ä»¥åœ¨åç¼–è¯‘ç•Œé¢é€‰ä¸­åˆ¤æ–­è¯­å¥æ‰€åœ¨è¡Œï¼Œå³é”®Jump to Disasmåˆ°è¾¾ï¼‰</p>
<p><img src="/../images/image-20251021220816989.png" alt="åˆ¤æ–­è¯­å¥çš„æ±‡ç¼–"></p>
<p>å¯ä»¥çœ‹åˆ°è¿™æ˜¯ä¸€ä¸ªjzï¼Œåªéœ€è¦åœ¨æ‰§è¡Œåˆ°è¿™å¥ä½†æ˜¯è¿˜æ²¡æ­¥è¿‡æ—¶ï¼Œä¿®æ”¹ZFæ ‡å¿—ä½å³å¯ç»•è¿‡ã€‚åœ¨æ­¤å¤„F2ä¸‹æ–­ç‚¹ï¼Œå¼€å§‹åŠ¨è°ƒç¨‹åºã€‚éšä¾¿è¾“ä¸ªæ•°å­—ï¼ŒæŒ‰å›è½¦</p>
<p><img src="/../images/image-20251021220921683.png" alt="éšä¾¿è¾“ä¸ªæ•°å­—"></p>
<p>æ­¤æ—¶ç¨‹åºåœåœ¨jzå¤„ï¼Œå³æˆ‘ä»¬ä¸‹æ–­ç‚¹çš„åœ°æ–¹</p>
<p><img src="/../images/image-20251021221202643.png" alt="åœåœ¨jzå¤„"></p>
<p>åœ¨å³ä¸Šä¾§å¯„å­˜å™¨çª—å£æ‰¾åˆ°ZF</p>
<p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-10-21%20221235.png" alt="æ‰¾åˆ°ZF"></p>
<p>åŒå‡»ZFæŠŠå®ƒçš„å€¼æ”¹æˆ0x1</p>
<p><img src="/../images/image-20251021221613970.png" alt="ä¿®æ”¹ZFæ ‡å¿—ä½"></p>
<p>å¯ä»¥çœ‹åˆ°jzè¯­å¥å¤„æœ‰ä¸€æ¡ç®­å¤´å‡ºæ¥äº†</p>
<p><img src="/../images/image-20251021221637985.png" alt="ç»¿è‰²ç®­å¤´"></p>
<p>F8æ‰§è¡Œjzè·³è½¬ï¼Œè·Ÿè¸ªç¨‹åºæ‰§è¡Œæµã€‚å¯ä»¥çœ‹åˆ°ç¨‹åºè¿è¡Œåˆ°ä¸€ä¸ªç±»ä¼¼è¾“å‡ºå‡½æ•°çš„åœ°æ–¹</p>
<p><img src="/../images/image-20251021222114925.png" alt="ç±»ä¼¼è¾“å‡ºå‡½æ•°çš„åœ°æ–¹"></p>
<p>è¿™æ—¶å€™ï¼Œåœ¨è¿™é‡Œå¤šè¯•å‡ æ¬¡ä¼šå‘ç°MessageBoxAå¯ä»¥æ­¥å…¥ã€‚å½“ç„¶è¦æ˜¯æ­¥è¿‡è¿™ä¸ªcall MessageBoxAä¼šå‘ç°ç¨‹åºæ²¡æœ‰å¼¹å‡ºçª—å£ï¼Œå€’æ˜¯ç»ˆç«¯è¾“å‡ºäº†æ–°çš„å¥å­ï¼Œååˆ†å¯ç–‘</p>
<p><img src="/../images/image-20251021222341398.png" alt="ç»ˆç«¯çš„æ–°è¾“å‡º"></p>
<p>æ‰€ä»¥åœ¨ç¨‹åºæ‰§è¡Œåˆ°call cs:MessageBoxAè¿™å¥çš„æ—¶å€™æŒ‰F7æ­¥å…¥ï¼Œå°±ä¼šå‘ç°è¿™ä¸ªMessageBoxAåˆ«æœ‰æ´å¤©</p>
<p><img src="/../images/image-20251021222417932.png" alt="åˆ«æœ‰æ´å¤©"></p>
<p>è¿™æ˜¾ç„¶ä¸åƒæ˜¯MessageBoxAåº”è¯¥æœ‰çš„æ“ä½œã€‚å¯ä»¥çœ‹åˆ°ä¸€ä¸ªå¯ç–‘çš„åœ°å€è¢«æ”¾åˆ°äº†raxé‡Œï¼Œè·Ÿè¸ªè¿™ä¸ªjmpçœ‹çœ‹ï¼ˆjmp raxå¤„F7æ­¥å…¥ï¼‰</p>
<p><img src="/../images/image-20251021222757420.png" alt="jmpå"></p>
<p>å¯ä»¥çœ‹åˆ°ç¨‹åºè¿è¡Œåˆ°äº†ä¸€ä¸ªæ–°å‡½æ•°ï¼ŒF5åç¼–è¯‘ï¼Œåç¼–è¯‘ä»£ç å¦‚ä¸‹ï¼ˆå‡½æ•°æœ‰å¤šä¸ªæ¨¡å—çš„åŠ å¯†å¤„ç†ï¼Œè¿˜æ˜¯å¾ˆå¤æ‚çš„ï¼Œä»¥ä¸‹æ˜¯ç»è¿‡å˜é‡åä¼˜åŒ–çš„ä»£ç ï¼‰</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs C">__int64 <span class="hljs-title function_">realMain</span><span class="hljs-params">()</span><br>&#123;<br>  <span class="hljs-type">char</span> v0; <span class="hljs-comment">// dl</span><br>  <span class="hljs-type">char</span> *v1; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">char</span> v2; <span class="hljs-comment">// dl</span><br>  <span class="hljs-type">char</span> *i; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">int</span> v4; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">unsigned</span> __int8 *pFlag1; <span class="hljs-comment">// r9</span><br>  _BYTE *pFlag; <span class="hljs-comment">// rdx</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v7; <span class="hljs-comment">// esi</span><br>  <span class="hljs-type">char</span> v8; <span class="hljs-comment">// dl</span><br>  <span class="hljs-type">char</span> *j; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> *p_block0; <span class="hljs-comment">// r10</span><br>  <span class="hljs-type">unsigned</span> __int8 *current_1; <span class="hljs-comment">// rdx</span><br>  <span class="hljs-type">int</span> shift; <span class="hljs-comment">// ecx</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> temp_2; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> temp_1; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> cureent_block; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> delta; <span class="hljs-comment">// r11d</span><br>  <span class="hljs-type">int</span> key_value; <span class="hljs-comment">// ebp</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> prev_block; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> *block; <span class="hljs-comment">// r8</span><br>  <span class="hljs-type">int</span> rounds; <span class="hljs-comment">// ecx</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> next; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> oriDelta; <span class="hljs-comment">// ecx</span><br>  <span class="hljs-type">unsigned</span> __int8 *encrypted_bytes_1; <span class="hljs-comment">// r10</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> *v24; <span class="hljs-comment">// rdi</span><br>  _DWORD *v25; <span class="hljs-comment">// r8</span><br>  _DWORD *v26; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">int</span> shift_1; <span class="hljs-comment">// ecx</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v28; <span class="hljs-comment">// edx</span><br>  _BYTE *v29; <span class="hljs-comment">// r9</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v30; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">unsigned</span> __int64 k; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">char</span> v32; <span class="hljs-comment">// dl</span><br>  _BYTE *current1; <span class="hljs-comment">// rbx</span><br>  <span class="hljs-type">int</span> randNum; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> tmp; <span class="hljs-comment">// r8</span><br>  _BYTE *target; <span class="hljs-comment">// rdx</span><br>  <span class="hljs-type">unsigned</span> __int8 *v37; <span class="hljs-comment">// rdx</span><br>  <span class="hljs-type">unsigned</span> __int8 *end; <span class="hljs-comment">// rbx</span><br>  <span class="hljs-type">unsigned</span> __int8 *current; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">char</span> *v40; <span class="hljs-comment">// rcx</span><br>  <span class="hljs-type">int</span> m; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v42; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">char</span> n; <span class="hljs-comment">// dl</span><br>  <span class="hljs-type">char</span> v44; <span class="hljs-comment">// dl</span><br>  <span class="hljs-type">char</span> *ii; <span class="hljs-comment">// rax</span><br>  _QWORD key[<span class="hljs-number">2</span>]; <span class="hljs-comment">// [rsp+20h] [rbp-218h] BYREF</span><br>  <span class="hljs-type">char</span> notice2[<span class="hljs-number">22</span>]; <span class="hljs-comment">// [rsp+30h] [rbp-208h] BYREF</span><br>  __int16 v49; <span class="hljs-comment">// [rsp+46h] [rbp-1F2h] BYREF</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> block0; <span class="hljs-comment">// [rsp+50h] [rbp-1E8h] BYREF</span><br>  <span class="hljs-type">int</span> v51; <span class="hljs-comment">// [rsp+54h] [rbp-1E4h] BYREF</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> block10; <span class="hljs-comment">// [rsp+78h] [rbp-1C0h]</span><br>  _BYTE encrypted_bytes[<span class="hljs-number">44</span>]; <span class="hljs-comment">// [rsp+80h] [rbp-1B8h] BYREF</span><br>  <span class="hljs-type">int</span> v54; <span class="hljs-comment">// [rsp+ACh] [rbp-18Ch] BYREF</span><br>  _BYTE flag[<span class="hljs-number">44</span>]; <span class="hljs-comment">// [rsp+B0h] [rbp-188h] BYREF</span><br>  <span class="hljs-type">char</span> v56; <span class="hljs-comment">// [rsp+DCh] [rbp-15Ch] BYREF</span><br>  _QWORD enc[<span class="hljs-number">7</span>]; <span class="hljs-comment">// [rsp+E0h] [rbp-158h] BYREF</span><br>  <span class="hljs-type">int</span> v58; <span class="hljs-comment">// [rsp+118h] [rbp-120h]</span><br>  _BYTE base64_output[<span class="hljs-number">59</span>]; <span class="hljs-comment">// [rsp+120h] [rbp-118h] BYREF</span><br>  _BYTE end_1[<span class="hljs-number">5</span>]; <span class="hljs-comment">// [rsp+15Bh] [rbp-DDh] BYREF</span><br>  <span class="hljs-type">char</span> temp[<span class="hljs-number">64</span>]; <span class="hljs-comment">// [rsp+160h] [rbp-D8h] BYREF</span><br>  <span class="hljs-type">char</span> notice1[<span class="hljs-number">85</span>]; <span class="hljs-comment">// [rsp+1A0h] [rbp-98h] BYREF</span><br>  _BYTE v63[<span class="hljs-number">3</span>]; <span class="hljs-comment">// [rsp+1F5h] [rbp-43h] BYREF</span><br><br>  v0 = <span class="hljs-number">79</span>;<br>  enc[<span class="hljs-number">0</span>] = <span class="hljs-number">0x280D30732B077874L</span>L;<br>  enc[<span class="hljs-number">1</span>] = <span class="hljs-number">0x242D00103573060BL</span>L;<br>  enc[<span class="hljs-number">2</span>] = <span class="hljs-number">0x141C3406727D2F73L</span>L;<br>  enc[<span class="hljs-number">3</span>] = <span class="hljs-number">0xA71137676362833L</span>L;<br>  enc[<span class="hljs-number">4</span>] = <span class="hljs-number">0xE232B242F04742AL</span>L;<br>  enc[<span class="hljs-number">5</span>] = <span class="hljs-number">0x2F373F03033D7310L</span>L;<br>  enc[<span class="hljs-number">6</span>] = <span class="hljs-number">0x77067C3612772D7DL</span>L;<br>  qmemcpy(key, <span class="hljs-string">&quot;Calamity_Fortune&quot;</span>, <span class="hljs-keyword">sizeof</span>(key));<br>  qmemcpy(<br>    notice1,<br>    <span class="hljs-string">&quot;Ofqni`&#x27;jfcb&#x27;ns&#x27;sont&#x27;afu+&#x27;sob&#x27;tretbvrbis&#x27;bidu~wsnhi&#x27;tohrkc&#x27;eb&#x27;f&#x27;wnbdb&#x27;ha&#x27;dflb&#x27;ahu&#x27;~hry&quot;</span>,<br>    <span class="hljs-keyword">sizeof</span>(notice1));<br>  v1 = notice1;<br>  v58 = <span class="hljs-number">0x37233104</span>;<br>  <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>  &#123;<br>    *v1++ = v0 ^ <span class="hljs-number">7</span>;<br>    <span class="hljs-keyword">if</span> ( v63 == v1 )<br>      <span class="hljs-keyword">break</span>;<br>    v0 = *v1;<br>  &#125;<br>  <span class="hljs-built_in">puts</span>(notice1);                                <span class="hljs-comment">// Having made it this far,......</span><br>  v2 = <span class="hljs-number">87</span>;<br>  qmemcpy(notice2, <span class="hljs-string">&quot;Wkbftb&#x27;Niwrs&#x27;~hru&#x27;akf`&quot;</span>, <span class="hljs-keyword">sizeof</span>(notice2));<br>  <span class="hljs-keyword">for</span> ( i = notice2; ; v2 = *i )<br>  &#123;<br>    *i++ = v2 ^ <span class="hljs-number">7</span>;<br>    <span class="hljs-keyword">if</span> ( i == &amp;v49 )<br>      <span class="hljs-keyword">break</span>;<br>  &#125;<br>  <span class="hljs-built_in">puts</span>(notice2);                                <span class="hljs-comment">// Please input your flag</span><br>  <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%44s&quot;</span>, flag);<br>  v4 = flag[<span class="hljs-number">0</span>];<br>  v56 = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">if</span> ( !flag[<span class="hljs-number">0</span>] )<br>    <span class="hljs-keyword">goto</span> LABEL_11;<br>  pFlag1 = flag;<br>  pFlag = flag;<br>  <span class="hljs-keyword">do</span><br>    v7 = <span class="hljs-number">1</span> - flag + pFlag++;<br>  <span class="hljs-keyword">while</span> ( *pFlag );<br>  <span class="hljs-keyword">if</span> ( v7 != <span class="hljs-number">44</span> )<br>  &#123;<br>LABEL_11:                                       <span class="hljs-comment">// é”™è¯¯æ—¶çš„è¾“å‡º</span><br>    v8 = <span class="hljs-number">75</span>;<br>    qmemcpy(temp, <span class="hljs-string">&quot;Kbi`so&#x27;Buuhu&amp;&quot;</span>, <span class="hljs-number">13</span>);<br>    <span class="hljs-keyword">for</span> ( j = temp; ; v8 = *j )<br>    &#123;<br>      *j++ = v8 ^ <span class="hljs-number">7</span>;<br>      <span class="hljs-keyword">if</span> ( &amp;temp[<span class="hljs-number">13</span>] == j )<br>        <span class="hljs-keyword">break</span>;<br>    &#125;<br>    <span class="hljs-built_in">puts</span>(temp);                                 <span class="hljs-comment">// é”™è¯¯æ—¶çš„è¾“å‡º</span><br>    <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>  &#125;<br>  p_block0 = &amp;block0;<br>  <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )                                   <span class="hljs-comment">// bytesToBlockï¼Œè½¬æˆuint32_t</span><br>  &#123;<br>    current_1 = pFlag1;<br>    shift = <span class="hljs-number">0</span>;<br>    temp_2 = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>    &#123;<br>      temp_1 = v4 &lt;&lt; shift;<br>      shift += <span class="hljs-number">8</span>;<br>      ++current_1;<br>      temp_2 |= temp_1;<br>      <span class="hljs-keyword">if</span> ( shift == <span class="hljs-number">32</span> )<br>        <span class="hljs-keyword">break</span>;<br>      v4 = *current_1;<br>    &#125;<br>    pFlag1 += <span class="hljs-number">4</span>;<br>    *p_block0++ = temp_2;<br>    <span class="hljs-keyword">if</span> ( &amp;v56 == pFlag1 )<br>      <span class="hljs-keyword">break</span>;<br>    v4 = *pFlag1;<br>  &#125;<br>  cureent_block = block10;<br>  delta = <span class="hljs-number">0x9E3779B9</span>;<br>  key_value = <span class="hljs-number">0x616C6143</span>;<br>  prev_block = block0;<br>  <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )                                   <span class="hljs-comment">// xxtea</span><br>  &#123;<br>    block = &amp;block0;<br>    <span class="hljs-keyword">for</span> ( rounds = <span class="hljs-number">0</span>; ; ++rounds )<br>    &#123;<br>      next = block[<span class="hljs-number">1</span>];<br>      ++block;<br>      cureent_block = prev_block<br>                    + (((cureent_block ^ *(key + (((delta &gt;&gt; <span class="hljs-number">2</span>) ^ rounds) &amp; <span class="hljs-number">3</span>))) + (next ^ delta)) ^ (((<span class="hljs-number">4</span> * next) ^ (cureent_block &gt;&gt; <span class="hljs-number">5</span>)) + ((<span class="hljs-number">16</span> * cureent_block) ^ (next &gt;&gt; <span class="hljs-number">3</span>))));<br>      *(block - <span class="hljs-number">1</span>) = cureent_block;<br>      <span class="hljs-keyword">if</span> ( rounds == <span class="hljs-number">9</span> )<br>        <span class="hljs-keyword">break</span>;<br>      prev_block = *block;<br>    &#125;<br>    prev_block = block0;<br>    oriDelta = delta;<br>    delta -= <span class="hljs-number">0x61C88647</span>;<br>    cureent_block = block10<br>                  + ((((cureent_block &gt;&gt; <span class="hljs-number">5</span>) ^ (<span class="hljs-number">4</span> * block0)) + ((<span class="hljs-number">16</span> * cureent_block) ^ (block0 &gt;&gt; <span class="hljs-number">3</span>))) ^ ((block0 ^ oriDelta) + (key_value ^ cureent_block)));<br>    block10 = cureent_block;<br>    <span class="hljs-keyword">if</span> ( delta == <span class="hljs-number">0xCC623AF3</span> )<br>      <span class="hljs-keyword">break</span>;<br>    key_value = *(key + (((delta &gt;&gt; <span class="hljs-number">2</span>) ^ <span class="hljs-number">0xA</span>) &amp; <span class="hljs-number">3</span>));<br>  &#125;<br>  encrypted_bytes_1 = encrypted_bytes;<br>  v24 = &amp;v51;                                   <span class="hljs-comment">// blockToBytesï¼Œuint32_tè½¬æˆbytes</span><br>  v25 = encrypted_bytes;<br>  <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>  &#123;<br>    v26 = v25;<br>    <span class="hljs-keyword">for</span> ( shift_1 = <span class="hljs-number">0</span>; shift_1 != <span class="hljs-number">32</span>; shift_1 += <span class="hljs-number">8</span> )<br>    &#123;<br>      v26 = (v26 + <span class="hljs-number">1</span>);<br>      v28 = prev_block &gt;&gt; shift_1;<br>      *(v26 - <span class="hljs-number">1</span>) = v28;<br>    &#125;<br>    <span class="hljs-keyword">if</span> ( &amp;v54 == ++v25 )<br>      <span class="hljs-keyword">break</span>;<br>    prev_block = *v24++;<br>  &#125;<br>  qmemcpy(temp, <span class="hljs-string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span>, <span class="hljs-keyword">sizeof</span>(temp));<br>  v29 = base64_output;<br>  <span class="hljs-keyword">do</span>                                            <span class="hljs-comment">// base64encode</span><br>  &#123;<br>    v30 = *encrypted_bytes_1 &lt;&lt; <span class="hljs-number">16</span>;<br>    <span class="hljs-keyword">if</span> ( v7 != <span class="hljs-number">1</span> )<br>    &#123;<br>      v30 |= encrypted_bytes_1[<span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">8</span>;<br>      <span class="hljs-keyword">if</span> ( v7 &gt; <span class="hljs-number">2</span> )<br>        v30 |= encrypted_bytes_1[<span class="hljs-number">2</span>];<br>    &#125;<br>    <span class="hljs-keyword">for</span> ( k = <span class="hljs-number">0LL</span>; k != <span class="hljs-number">4</span>; ++k )<br>    &#123;<br>      v32 = <span class="hljs-number">61</span>;<br>      <span class="hljs-keyword">if</span> ( k &lt;= v7 )<br>        v32 = temp[(v30 &gt;&gt; (<span class="hljs-number">-6</span> * k + <span class="hljs-number">18</span>)) &amp; <span class="hljs-number">0x3F</span>];<br>      v29[k] = v32;<br>    &#125;<br>    encrypted_bytes_1 += <span class="hljs-number">3</span>;<br>    v29 += <span class="hljs-number">4</span>;<br>    v7 -= <span class="hljs-number">3</span>;<br>  &#125;<br>  <span class="hljs-keyword">while</span> ( (&amp;v54 + <span class="hljs-number">1</span>) != encrypted_bytes_1 );<br>  current1 = end_1;<br>  end_1[<span class="hljs-number">1</span>] = <span class="hljs-number">0</span>;<br>  srand(<span class="hljs-number">0x65u</span>);                                 <span class="hljs-comment">// shuffle</span><br>  <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>  &#123;<br>    randNum = rand();<br>    tmp = *current1;<br>    target = &amp;base64_output[randNum % (<span class="hljs-number">60</span> - end_1 + current1)];<br>    *current1 = *target;<br>    *target = tmp;<br>    v37 = current1 - <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">if</span> ( base64_output == current1 - <span class="hljs-number">1</span> )<br>      <span class="hljs-keyword">break</span>;<br>    --current1;<br>  &#125;<br>  end = current1 + <span class="hljs-number">59</span>;<br>  current = v37;<br>  <span class="hljs-keyword">do</span>                                            <span class="hljs-comment">// xor</span><br>    *current++ ^= <span class="hljs-number">0x45u</span>;<br>  <span class="hljs-keyword">while</span> ( end != current );<br>  v40 = enc + <span class="hljs-number">1</span>;<br>  <span class="hljs-keyword">for</span> ( m = <span class="hljs-number">116</span>; ; m = *v40++ )<br>  &#123;<br>    <span class="hljs-keyword">if</span> ( *v37 != m )                            <span class="hljs-comment">// é”™è¯¯å¤„ç†çš„è¾“å‡º</span><br>    &#123;<br>      qmemcpy(temp, <span class="hljs-string">&quot;Dfkfjns~&amp;&#x27;wkbftb&#x27;su~&#x27;f`fni&quot;</span>, <span class="hljs-number">26</span>);<br>      v42 = temp;<br>      <span class="hljs-keyword">for</span> ( n = <span class="hljs-number">68</span>; ; n = *v42 )<br>      &#123;<br>        *v42++ = n ^ <span class="hljs-number">7</span>;<br>        <span class="hljs-keyword">if</span> ( &amp;temp[<span class="hljs-number">26</span>] == v42 )<br>          <span class="hljs-keyword">break</span>;<br>      &#125;<br>      <span class="hljs-built_in">puts</span>(temp);<br>      <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>    &#125;                                           <span class="hljs-comment">// é”™è¯¯å¤„ç†çš„è¾“å‡º</span><br>    <span class="hljs-keyword">if</span> ( end == ++v37 )<br>      <span class="hljs-keyword">break</span>;<br>  &#125;<br>  v44 = <span class="hljs-number">65</span>;<br>  qmemcpy(temp, <span class="hljs-string">&quot;Ahusrib&amp;@hhc&#x27;Krdl&amp;&quot;</span>, <span class="hljs-number">18</span>);<br>  <span class="hljs-keyword">for</span> ( ii = temp; ; v44 = *ii )<br>  &#123;<br>    *ii++ = v44 ^ <span class="hljs-number">7</span>;<br>    <span class="hljs-keyword">if</span> ( &amp;temp[<span class="hljs-number">18</span>] == ii )<br>      <span class="hljs-keyword">break</span>;<br>  &#125;<br>  <span class="hljs-built_in">puts</span>(temp);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">1LL</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>å‡½æ•°å‡ºç°åœ¨ç¨‹åºè¾“å…¥flagçš„æç¤ºä¹‹åï¼Œåº”è¯¥å°±æ˜¯flagæ£€éªŒå‡½æ•°äº†ã€‚å‡½æ•°ä½¿ç”¨äº†å¾ˆå¤šåŠ å¯†æ‰‹æ®µï¼Œç”šè‡³è¿æç¤ºè¯éƒ½æ˜¯å®æ—¶è§£å¯†çš„ã€‚å¯ä»¥çœ‹åˆ°å¯¹è¾“å…¥çš„flagä¾æ¬¡è¿›è¡Œäº†æ ¼å¼è½¬æ¢ã€é­”æ”¹XXTEAåŠ å¯†ã€æ ¼å¼è½¬æ¢ã€base64ç¼–ç ã€shuffleæ´—ç‰Œç®—æ³•æ‰“ä¹±ã€å¼‚æˆ–å¤„ç†ï¼Œæœ€åæ‰å’Œé¢„è®¾çš„å¯†æ–‡è¿›è¡Œæ¯”è¾ƒæ£€éªŒã€‚</p>
<p>è¿™é‡Œç»™å‡ºä¸€ä¸ªAIå¤ç°çš„ã€ç»è¿‡æµ‹è¯•ç­‰ä»·çš„è„šæœ¬ï¼Œæ–¹ä¾¿ç†è§£è¿™ä¸ªå¤æ‚çš„ç®—æ³•ï¼ˆè¢«å‡½æ•°æ”¹å†™æ•´æ€•äº†ï¼Œæ‰€ä»¥éšæœºæ•°ç”Ÿæˆç®—æ³•ä¹Ÿå¤ç°äº†ï¼‰ï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs C"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span><br><br><span class="hljs-comment">// MSVC-compatible rand</span><br><span class="hljs-type">static</span> <span class="hljs-type">uint32_t</span> rand_seed;<br><span class="hljs-type">void</span> <span class="hljs-title function_">custom_srand</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> seed)</span> &#123; rand_seed = seed; &#125;<br><span class="hljs-type">uint32_t</span> <span class="hljs-title function_">custom_rand</span><span class="hljs-params">()</span> &#123;<br>    rand_seed = rand_seed * <span class="hljs-number">214013</span> + <span class="hljs-number">2531011</span>;<br>    <span class="hljs-keyword">return</span> (rand_seed &gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0x7FFF</span>;<br>&#125;<br><br><span class="hljs-comment">// XXTEA encryption (as in realMain)</span><br><span class="hljs-type">void</span> <span class="hljs-title function_">encrypt_xxtea_variant</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> block[<span class="hljs-number">11</span>], <span class="hljs-type">const</span> <span class="hljs-type">uint32_t</span> key[<span class="hljs-number">4</span>])</span> &#123;<br>    <span class="hljs-type">uint32_t</span> cureent_block = block[<span class="hljs-number">10</span>];<br>    <span class="hljs-type">uint32_t</span> delta = <span class="hljs-number">0x9E3779B9U</span>;<br>    <span class="hljs-type">uint32_t</span> key_value = <span class="hljs-number">0x616C6143U</span>; <span class="hljs-comment">// åˆå§‹å€¼ï¼Œä½†ç¬¬ä¸€è½®å†…å¾ªç¯ä¸ç”¨å®ƒ</span><br>    <span class="hljs-type">uint32_t</span> prev_block = block[<span class="hljs-number">0</span>];<br><br>    <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>) &#123;<br>        <span class="hljs-type">uint32_t</span>* bptr = &amp;block[<span class="hljs-number">0</span>];<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> rounds = <span class="hljs-number">0</span>; ; ++rounds) &#123;<br>            <span class="hljs-type">uint32_t</span> next = bptr[<span class="hljs-number">1</span>];<br>            ++bptr;<br>            <span class="hljs-type">uint32_t</span> k = key[((delta &gt;&gt; <span class="hljs-number">2</span>) ^ rounds) &amp; <span class="hljs-number">3</span>];<br>            <span class="hljs-type">uint32_t</span> term1 = (cureent_block ^ k) + (next ^ delta);<br>            <span class="hljs-type">uint32_t</span> term2 = (<span class="hljs-number">4</span> * next ^ (cureent_block &gt;&gt; <span class="hljs-number">5</span>)) + (<span class="hljs-number">16</span> * cureent_block ^ (next &gt;&gt; <span class="hljs-number">3</span>));<br>            cureent_block = prev_block + (term1 ^ term2);<br>            *(bptr - <span class="hljs-number">1</span>) = cureent_block;<br>            <span class="hljs-keyword">if</span> (rounds == <span class="hljs-number">9</span>) <span class="hljs-keyword">break</span>;<br>            prev_block = *bptr; <span class="hljs-comment">// æ­¤æ—¶ *bptr å°šæœªè¢«ä¿®æ”¹ï¼ˆæ˜¯åŸå§‹å€¼ï¼‰</span><br>        &#125;<br><br>        prev_block = block[<span class="hljs-number">0</span>];<br>        <span class="hljs-type">uint32_t</span> oriDelta = delta;<br>        delta -= <span class="hljs-number">0x61C88647U</span>;<br>        key_value = key[((oriDelta &gt;&gt; <span class="hljs-number">2</span>) ^ <span class="hljs-number">0xA</span>) &amp; <span class="hljs-number">3</span>];<br>        <span class="hljs-type">uint32_t</span> term1 = ((cureent_block &gt;&gt; <span class="hljs-number">5</span>) ^ (<span class="hljs-number">4</span> * block[<span class="hljs-number">0</span>])) + ((<span class="hljs-number">16</span> * cureent_block) ^ (block[<span class="hljs-number">0</span>] &gt;&gt; <span class="hljs-number">3</span>));<br>        <span class="hljs-type">uint32_t</span> term2 = (block[<span class="hljs-number">0</span>] ^ oriDelta) + (key_value ^ cureent_block);<br>        cureent_block = block[<span class="hljs-number">10</span>] + (term1 ^ term2);<br>        block[<span class="hljs-number">10</span>] = cureent_block;<br><br>        <span class="hljs-keyword">if</span> (delta == <span class="hljs-number">0xCC623AF3U</span>) <span class="hljs-keyword">break</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// Base64 encode 44 bytes -&gt; 60 chars</span><br><span class="hljs-type">void</span> <span class="hljs-title function_">base64_encode</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">uint8_t</span>* input, <span class="hljs-type">char</span>* output)</span> &#123;<br>    <span class="hljs-type">const</span> <span class="hljs-type">char</span>* table = <span class="hljs-string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">44</span>; i += <span class="hljs-number">3</span>) &#123;<br>        <span class="hljs-type">uint32_t</span> val = (input[i] &lt;&lt; <span class="hljs-number">16</span>) |<br>            ((i + <span class="hljs-number">1</span> &lt; <span class="hljs-number">44</span> ? input[i + <span class="hljs-number">1</span>] : <span class="hljs-number">0</span>) &lt;&lt; <span class="hljs-number">8</span>) |<br>            ((i + <span class="hljs-number">2</span> &lt; <span class="hljs-number">44</span> ? input[i + <span class="hljs-number">2</span>] : <span class="hljs-number">0</span>));<br>        output[<span class="hljs-number">0</span>] = table[(val &gt;&gt; <span class="hljs-number">18</span>) &amp; <span class="hljs-number">0x3F</span>];<br>        output[<span class="hljs-number">1</span>] = table[(val &gt;&gt; <span class="hljs-number">12</span>) &amp; <span class="hljs-number">0x3F</span>];<br>        output[<span class="hljs-number">2</span>] = (i + <span class="hljs-number">1</span> &lt; <span class="hljs-number">44</span>) ? table[(val &gt;&gt; <span class="hljs-number">6</span>) &amp; <span class="hljs-number">0x3F</span>] : <span class="hljs-string">&#x27;=&#x27;</span>;<br>        output[<span class="hljs-number">3</span>] = (i + <span class="hljs-number">2</span> &lt; <span class="hljs-number">44</span>) ? table[val &amp; <span class="hljs-number">0x3F</span>] : <span class="hljs-string">&#x27;=&#x27;</span>;<br>        output += <span class="hljs-number">4</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-comment">// Step 1: Input flag</span><br>    <span class="hljs-type">char</span> flag[<span class="hljs-number">45</span>] = <span class="hljs-string">&quot;0xGame&#123;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&#125;&quot;</span>;<span class="hljs-comment">//æµ‹è¯•æ ·ä¾‹</span><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Input flag: %s\n&quot;</span>, flag);<br><br>    <span class="hljs-comment">// Step 2: Convert to 11 uint32_t (little-endian)</span><br>    <span class="hljs-type">uint32_t</span> blocks[<span class="hljs-number">11</span>];<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">11</span>; i++) &#123;<br>        blocks[i] = (<span class="hljs-type">uint8_t</span>)flag[i * <span class="hljs-number">4</span>] |<br>            ((<span class="hljs-type">uint8_t</span>)flag[i * <span class="hljs-number">4</span> + <span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">8</span>) |<br>            ((<span class="hljs-type">uint8_t</span>)flag[i * <span class="hljs-number">4</span> + <span class="hljs-number">2</span>] &lt;&lt; <span class="hljs-number">16</span>) |<br>            ((<span class="hljs-type">uint8_t</span>)flag[i * <span class="hljs-number">4</span> + <span class="hljs-number">3</span>] &lt;&lt; <span class="hljs-number">24</span>);<br>    &#125;<br><br>    <span class="hljs-comment">// Step 3: XXTEA encrypt</span><br>    <span class="hljs-type">uint32_t</span> key[<span class="hljs-number">4</span>] = &#123;<br>        <span class="hljs-number">0x616C6143</span>, <span class="hljs-comment">// &#x27;C&#x27;,&#x27;a&#x27;,&#x27;l&#x27;,&#x27;a&#x27;</span><br>        <span class="hljs-number">0x7974696D</span>, <span class="hljs-comment">// &#x27;m&#x27;,&#x27;i&#x27;,&#x27;t&#x27;,&#x27;y&#x27;</span><br>        <span class="hljs-number">0x726F465F</span>, <span class="hljs-comment">// &#x27;_&#x27;,&#x27;F&#x27;,&#x27;o&#x27;,&#x27;r&#x27;</span><br>        <span class="hljs-number">0x656E7574</span>  <span class="hljs-comment">// &#x27;t&#x27;,&#x27;u&#x27;,&#x27;n&#x27;,&#x27;e&#x27;</span><br>    &#125;;<br>    encrypt_xxtea_variant(blocks, key);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;TEA encrypted blocks (hex, little-endian order):\n&quot;</span>);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">11</span>; i++) &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%08x\n&quot;</span>, blocks[i]);<br>    &#125;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n&quot;</span>);<br>    <span class="hljs-comment">// Step 4: Convert back to bytes (little-endian)</span><br>    <span class="hljs-type">uint8_t</span> encrypted_bytes[<span class="hljs-number">44</span>];<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">11</span>; i++) &#123;<br>        encrypted_bytes[i * <span class="hljs-number">4</span>] = blocks[i] &amp; <span class="hljs-number">0xFF</span>;<br>        encrypted_bytes[i * <span class="hljs-number">4</span> + <span class="hljs-number">1</span>] = (blocks[i] &gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xFF</span>;<br>        encrypted_bytes[i * <span class="hljs-number">4</span> + <span class="hljs-number">2</span>] = (blocks[i] &gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xFF</span>;<br>        encrypted_bytes[i * <span class="hljs-number">4</span> + <span class="hljs-number">3</span>] = (blocks[i] &gt;&gt; <span class="hljs-number">24</span>) &amp; <span class="hljs-number">0xFF</span>;<br>    &#125;<br><br>    <span class="hljs-comment">// Step 5: Base64 encode</span><br>    <span class="hljs-type">char</span> base64_str[<span class="hljs-number">61</span>] = &#123; <span class="hljs-number">0</span> &#125;;<br>    base64_encode(encrypted_bytes, base64_str);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Base64: %s\n&quot;</span>, base64_str);<br><br>    <span class="hljs-comment">// Step 6: Shuffle (Fisher-Yates, i=59 downto 1)</span><br>    custom_srand(<span class="hljs-number">0x65</span>);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">59</span>; i &gt;= <span class="hljs-number">1</span>; i--) &#123;<br>        <span class="hljs-type">int</span> j = custom_rand() % (i + <span class="hljs-number">1</span>);<br>        <span class="hljs-comment">// Swap base64_str[i] and base64_str[j]</span><br>        <span class="hljs-type">char</span> tmp = base64_str[i];<br>        base64_str[i] = base64_str[j];<br>        base64_str[j] = tmp;<br>    &#125;<br><br>    <span class="hljs-comment">// Output shuffled result (before XOR)</span><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;After shuffle (before XOR): %s\n&quot;</span>, base64_str);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Hex dump:\n&quot;</span>);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">60</span>; i++) &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%02x &quot;</span>, (<span class="hljs-type">uint8_t</span>)base64_str[i]);<br>        <span class="hljs-keyword">if</span> ((i + <span class="hljs-number">1</span>) % <span class="hljs-number">16</span> == <span class="hljs-number">0</span>) <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-number">60</span> % <span class="hljs-number">16</span> != <span class="hljs-number">0</span>) <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n&quot;</span>);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n&quot;</span>);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">60</span>; i++) &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%02x &quot;</span>, (<span class="hljs-type">uint8_t</span>)base64_str[i] ^ <span class="hljs-number">0x45</span>);<br>    &#125;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>è§£å¯†æ€è·¯ï¼šå¼‚æˆ–æ¨¡å—ç›´æ¥ä¸€æ¨¡ä¸€æ ·åœ°é‡å¤ä¸€éå³å¯ï¼›shuffleæ¨¡å—å¯ä»¥å…ˆä»åŠ å¯†ç®—æ³•è·å¾—éšæœºæ•°åºåˆ—ï¼Œè¿™æ ·æ–¹ä¾¿ä»åå¾€å‰ç´¢å¼•è¿˜åŸï¼›å‰©ä¸‹çš„çœ‹è„šæœ¬å§ğŸ« ï¼ˆå¯¹äº†ï¼Œè¦æ³¨æ„encæ•°æ®è¦ä»æ ˆä¸Šæå–ï¼Œç¬”è€…è®©AIä»åç¼–è¯‘çš„ä»£ç é‡Œæå–ï¼Œè‚‰çœ¼æ£€éªŒæ²¡å‘ç°bytesæˆªå–é”™äº†ï¼Œæµªè´¹äº†å¥½å¤šæ—¶é—´ï¼‰</p>
</li>
<li><p>è§£å¯†è„šæœ¬ï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs C"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span><br><br><span class="hljs-comment">// ========== ä½ æä¾›çš„è§£å¯†å‡½æ•° ==========</span><br><span class="hljs-type">void</span> <span class="hljs-title function_">decrypt_xxtea_variant</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> block[<span class="hljs-number">11</span>], <span class="hljs-type">const</span> <span class="hljs-type">uint32_t</span> key[<span class="hljs-number">4</span>])</span> &#123;<br>    <span class="hljs-type">const</span> <span class="hljs-type">int</span> TOTAL_ROUNDS = <span class="hljs-number">10</span>;<br>    <span class="hljs-type">uint32_t</span> delta = <span class="hljs-number">0xCC623AF3U</span>;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> round = <span class="hljs-number">0</span>; round &lt; TOTAL_ROUNDS; round++) &#123;<br>        <span class="hljs-type">uint32_t</span> oriDelta = delta + <span class="hljs-number">0x61C88647U</span>;<br>        <span class="hljs-type">uint32_t</span> key_value = key[((oriDelta &gt;&gt; <span class="hljs-number">2</span>) ^ <span class="hljs-number">0xA</span>) &amp; <span class="hljs-number">3</span>];<br><br>        <span class="hljs-type">uint32_t</span> C9 = block[<span class="hljs-number">9</span>];<br>        <span class="hljs-type">uint32_t</span> C0 = block[<span class="hljs-number">0</span>];<br>        <span class="hljs-type">uint32_t</span> term1 = ((C9 &gt;&gt; <span class="hljs-number">5</span>) ^ (<span class="hljs-number">4</span> * C0)) + ((<span class="hljs-number">16</span> * C9) ^ (C0 &gt;&gt; <span class="hljs-number">3</span>));<br>        <span class="hljs-type">uint32_t</span> term2 = (C0 ^ oriDelta) + (key_value ^ C9);<br>        <span class="hljs-type">uint32_t</span> G = term1 ^ term2;<br>        <span class="hljs-type">uint32_t</span> original_block10 = block[<span class="hljs-number">10</span>] - G;<br><br>        <span class="hljs-type">uint32_t</span> saved_block10 = original_block10;<br><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">9</span>; i &gt;= <span class="hljs-number">0</span>; i--) &#123;<br>            <span class="hljs-type">uint32_t</span> next = (i == <span class="hljs-number">9</span>) ? saved_block10 : block[i + <span class="hljs-number">1</span>];<br>            <span class="hljs-type">uint32_t</span> prev_C = (i == <span class="hljs-number">0</span>) ? saved_block10 : block[i - <span class="hljs-number">1</span>];<br><br>            <span class="hljs-type">uint32_t</span> k = key[((oriDelta &gt;&gt; <span class="hljs-number">2</span>) ^ i) &amp; <span class="hljs-number">3</span>];<br>            <span class="hljs-type">uint32_t</span> part1 = (prev_C ^ k) + (next ^ oriDelta);<br>            <span class="hljs-type">uint32_t</span> part2 = (<span class="hljs-number">4</span> * next ^ (prev_C &gt;&gt; <span class="hljs-number">5</span>)) + (<span class="hljs-number">16</span> * prev_C ^ (next &gt;&gt; <span class="hljs-number">3</span>));<br>            <span class="hljs-type">uint32_t</span> H = part1 ^ part2;<br><br>            block[i] = block[i] - H;<br>        &#125;<br><br>        block[<span class="hljs-number">10</span>] = original_block10;<br>        delta += <span class="hljs-number">0x61C88647U</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-type">const</span> <span class="hljs-type">char</span>* table = <span class="hljs-string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span>;<br><span class="hljs-type">int</span> <span class="hljs-title function_">base64_decode</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span>* input, <span class="hljs-type">uint8_t</span>* output)</span> &#123;<br>    <span class="hljs-type">int</span> out_len = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">60</span>; i += <span class="hljs-number">4</span>) &#123;<br>        <span class="hljs-type">uint32_t</span> val = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">4</span>; j++) &#123;<br>            <span class="hljs-type">const</span> <span class="hljs-type">char</span>* p = <span class="hljs-built_in">strchr</span>(table, input[i + j]);<br>            <span class="hljs-keyword">if</span> (p) val = (val &lt;&lt; <span class="hljs-number">6</span>) | (p - table);<br>            <span class="hljs-keyword">else</span> val &lt;&lt;= <span class="hljs-number">6</span>;<br>        &#125;<br>        output[out_len++] = (val &gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xFF</span>;<br>        <span class="hljs-keyword">if</span> (input[i + <span class="hljs-number">2</span>] != <span class="hljs-string">&#x27;=&#x27;</span>) output[out_len++] = (val &gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xFF</span>;<br>        <span class="hljs-keyword">if</span> (input[i + <span class="hljs-number">3</span>] != <span class="hljs-string">&#x27;=&#x27;</span>) output[out_len++] = val &amp; <span class="hljs-number">0xFF</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> out_len;<br>&#125;<br><br><span class="hljs-type">void</span> <span class="hljs-title function_">deshuffle</span><span class="hljs-params">(<span class="hljs-type">char</span>* cipher, <span class="hljs-type">uint32_t</span>* rand_seq)</span> &#123;<br>    <span class="hljs-comment">// é€†åºéå†ï¼št ä» 58 åˆ° 0</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> t = <span class="hljs-number">58</span>; t &gt;= <span class="hljs-number">0</span>; t--) &#123;<br>        <span class="hljs-type">int</span> i = <span class="hljs-number">59</span> - t;          <span class="hljs-comment">// åŠ å¯†æ—¶çš„ i</span><br>        <span class="hljs-type">int</span> j = rand_seq[t];     <span class="hljs-comment">// åŠ å¯†æ—¶çš„ j</span><br>        <span class="hljs-comment">// å†æ¬¡äº¤æ¢ cipher[i] å’Œ cipher[j]</span><br>        <span class="hljs-type">char</span> temp = cipher[i];<br>        cipher[i] = cipher[j];<br>        cipher[j] = temp;<br>    &#125;<br>&#125;<br><span class="hljs-comment">// ========== ä¸»ç¨‹åº ==========</span><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-comment">// Step 1: ä½¿ç”¨ä½ æä¾›çš„ 60 å­—èŠ‚ç›®æ ‡å¯†æ–‡</span><br>    <span class="hljs-type">uint8_t</span> encrypted_target_bytes[<span class="hljs-number">60</span>] = &#123;<br>        <span class="hljs-number">0x74</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x28</span>,<br>        <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0x24</span>,<br>        <span class="hljs-number">0x73</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0x14</span>,<br>        <span class="hljs-number">0x33</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x0A</span>,<br>        <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x4</span>, <span class="hljs-number">0x2f</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x2b</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0xe</span>,<br>        <span class="hljs-number">0x10</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x2F</span>,<br>        <span class="hljs-number">0x7D</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x77</span>,<br>        <span class="hljs-number">0x04</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x37</span><br>    &#125;;<br><br>    <span class="hljs-comment">// Step 2: XOR 0x45 å¾—åˆ° shuffled base64 å­—ç¬¦ä¸²</span><br>    <span class="hljs-type">char</span> shuffled_b64[<span class="hljs-number">60</span>] = &#123; <span class="hljs-number">0</span> &#125;;<br>    <span class="hljs-comment">//printf(&quot;step1: xor\n&quot;);</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">60</span>; i++) &#123;<br>        shuffled_b64[i] = encrypted_target_bytes[i] ^ <span class="hljs-number">0x45</span>;<br>        <span class="hljs-comment">//printf(&quot;%c&quot;, shuffled_b64[i]);</span><br>    &#125;<br>    <span class="hljs-comment">//printf(&quot;\nstep2: deshuffle\n&quot;);</span><br>    <span class="hljs-comment">// Step 3: ä½¿ç”¨ä½ æä¾›çš„ rand() åºåˆ—ï¼ˆåŸå§‹å€¼ï¼Œæœªå–æ¨¡ï¼‰</span><br>    <span class="hljs-type">uint32_t</span> rand_seq[<span class="hljs-number">59</span>] = &#123;<br>        <span class="hljs-number">8</span>, <span class="hljs-number">46</span>, <span class="hljs-number">21</span>, <span class="hljs-number">19</span>, <span class="hljs-number">35</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">7</span>, <span class="hljs-number">37</span>, <span class="hljs-number">17</span>,<br>        <span class="hljs-number">33</span>, <span class="hljs-number">13</span>, <span class="hljs-number">17</span>, <span class="hljs-number">10</span>, <span class="hljs-number">34</span>, <span class="hljs-number">34</span>, <span class="hljs-number">6</span>, <span class="hljs-number">20</span>, <span class="hljs-number">35</span>, <span class="hljs-number">10</span>,<br>        <span class="hljs-number">22</span>, <span class="hljs-number">21</span>, <span class="hljs-number">7</span>, <span class="hljs-number">16</span>, <span class="hljs-number">6</span>, <span class="hljs-number">18</span>, <span class="hljs-number">30</span>, <span class="hljs-number">32</span>, <span class="hljs-number">6</span>, <span class="hljs-number">2</span>,<br>        <span class="hljs-number">9</span>, <span class="hljs-number">0</span>, <span class="hljs-number">7</span>, <span class="hljs-number">4</span>, <span class="hljs-number">23</span>, <span class="hljs-number">18</span>, <span class="hljs-number">18</span>, <span class="hljs-number">16</span>, <span class="hljs-number">15</span>, <span class="hljs-number">15</span>,<br>        <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">16</span>, <span class="hljs-number">3</span>, <span class="hljs-number">13</span>, <span class="hljs-number">13</span>, <span class="hljs-number">9</span>, <span class="hljs-number">2</span>, <span class="hljs-number">11</span>, <span class="hljs-number">10</span>,<br>        <span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">0</span>, <span class="hljs-number">3</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span><br>    &#125;;<br>    deshuffle(shuffled_b64, rand_seq);<br>    <span class="hljs-comment">//for (int i = 0; i &lt; 60; i++) &#123;</span><br>        <span class="hljs-comment">//printf(&quot;%c&quot;, shuffled_b64[i]);</span><br>    <span class="hljs-comment">//&#125;</span><br>    <span class="hljs-type">char</span> original_b64[<span class="hljs-number">61</span>] = &#123; <span class="hljs-number">0</span> &#125;;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">60</span>; i++) &#123;<br>        original_b64[i] = shuffled_b64[i];<br>    &#125;<br>    original_b64[<span class="hljs-number">60</span>] = <span class="hljs-string">&#x27;\0&#x27;</span>;<br>    <span class="hljs-comment">//printf(&quot;\n&quot;);</span><br><br>    <span class="hljs-comment">// Step 4: Base64 è§£ç </span><br>    <span class="hljs-type">uint8_t</span> encrypted_bytes[<span class="hljs-number">44</span>];<br>    <span class="hljs-type">int</span> decoded_len = base64_decode(original_b64, encrypted_bytes);<br>    <span class="hljs-keyword">if</span> (decoded_len != <span class="hljs-number">44</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>    &#125;<br><br>    <span class="hljs-comment">// Step 5: é‡ç»„ä¸º 11 ä¸ª uint32_tï¼ˆå°ç«¯åºï¼‰</span><br>    <span class="hljs-type">uint32_t</span> block[<span class="hljs-number">11</span>];<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">11</span>; i++) &#123;<br>        block[i] = ((<span class="hljs-type">uint32_t</span>)encrypted_bytes[i * <span class="hljs-number">4</span> + <span class="hljs-number">0</span>] &lt;&lt; <span class="hljs-number">0</span>) |<br>            ((<span class="hljs-type">uint32_t</span>)encrypted_bytes[i * <span class="hljs-number">4</span> + <span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">8</span>) |<br>            ((<span class="hljs-type">uint32_t</span>)encrypted_bytes[i * <span class="hljs-number">4</span> + <span class="hljs-number">2</span>] &lt;&lt; <span class="hljs-number">16</span>) |<br>            ((<span class="hljs-type">uint32_t</span>)encrypted_bytes[i * <span class="hljs-number">4</span> + <span class="hljs-number">3</span>] &lt;&lt; <span class="hljs-number">24</span>);<br>    &#125;<br><br>    <span class="hljs-comment">// Step 6: è®¾ç½®å¯†é’¥ &quot;Calamity_Fortune&quot;ï¼ˆ16 å­—èŠ‚ï¼‰</span><br>    <span class="hljs-type">uint32_t</span> key[<span class="hljs-number">4</span>] = &#123;<br>        <span class="hljs-number">0x616C6143U</span>,<br>        <span class="hljs-number">0x7974696DU</span>,<br>        <span class="hljs-number">0x726F465FU</span>,<br>        <span class="hljs-number">0x656E7574U</span><br>    &#125;;<br><br>    <span class="hljs-comment">// Step 7: è°ƒç”¨ä½ æä¾›çš„è§£å¯†å‡½æ•°</span><br>    decrypt_xxtea_variant(block, key);<br><br>    <span class="hljs-comment">// Step 8: è½¬å› flag å­—ç¬¦ä¸²ï¼ˆå°ç«¯ï¼‰</span><br>    <span class="hljs-type">char</span> flag[<span class="hljs-number">45</span>] = &#123; <span class="hljs-number">0</span> &#125;;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">11</span>; i++) &#123;<br>        flag[i * <span class="hljs-number">4</span> + <span class="hljs-number">0</span>] = (block[i] &gt;&gt; <span class="hljs-number">0</span>) &amp; <span class="hljs-number">0xFF</span>;<br>        flag[i * <span class="hljs-number">4</span> + <span class="hljs-number">1</span>] = (block[i] &gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xFF</span>;<br>        flag[i * <span class="hljs-number">4</span> + <span class="hljs-number">2</span>] = (block[i] &gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xFF</span>;<br>        flag[i * <span class="hljs-number">4</span> + <span class="hljs-number">3</span>] = (block[i] &gt;&gt; <span class="hljs-number">24</span>) &amp; <span class="hljs-number">0xFF</span>;<br>    &#125;<br><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Flag: %s\n&quot;</span>, flag);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<blockquote>
<p>flagï¼š0xGame{f279c1e7-8b0d-4a3b-9c6f-5e4d2a1b0c89}</p>
</blockquote>
]]></content>
      <categories>
        <category>WriteUp&amp;å¤ç°</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>WriteUp</tag>
        <tag>Reverse</tag>
      </tags>
  </entry>
  <entry>
    <title>Day16:Z3æ±‚è§£å™¨</title>
    <url>/2025/08/21/Day16-Z3/</url>
    <content><![CDATA[<p>z3æ±‚è§£å™¨</p>
<span id="more"></span>

<h2 id="åŸºæœ¬æ•°æ®ç±»å‹"><a href="#åŸºæœ¬æ•°æ®ç±»å‹" class="headerlink" title="åŸºæœ¬æ•°æ®ç±»å‹"></a>åŸºæœ¬æ•°æ®ç±»å‹</h2><ul>
<li>Intï¼šæ•´æ•°</li>
<li>BitVecï¼šäºŒè¿›åˆ¶æ•°æ®ï¼ˆå¦‚BitVec(â€˜aâ€™,8)ï¼š8ä¸ªæ¯”ç‰¹ä½çš„ä¸€ä¸ªå˜é‡aï¼‰</li>
<li>Realï¼šæœ‰ç†æ•°</li>
<li>Boolï¼šå¸ƒå°”å€¼</li>
<li>Arrayï¼šæ•°ç»„</li>
</ul>
<h2 id="åŸºæœ¬æµç¨‹"><a href="#åŸºæœ¬æµç¨‹" class="headerlink" title="åŸºæœ¬æµç¨‹"></a>åŸºæœ¬æµç¨‹</h2><h3 id="è®¾å˜é‡"><a href="#è®¾å˜é‡" class="headerlink" title="è®¾å˜é‡"></a>è®¾å˜é‡</h3><ul>
<li>ä½¿ç”¨åŸºæœ¬æ•°æ®ç±»å‹æ¥å£°æ˜å˜é‡ï¼Œå¦‚ï¼šx&#x3D;Int(â€˜xâ€™)</li>
</ul>
<h3 id="åˆ›å»ºæ±‚è§£å™¨"><a href="#åˆ›å»ºæ±‚è§£å™¨" class="headerlink" title="åˆ›å»ºæ±‚è§£å™¨"></a>åˆ›å»ºæ±‚è§£å™¨</h3><ul>
<li>ä½¿ç”¨å‡½æ•°Solve()åˆ›å»ºä¸€ä¸ªæ±‚è§£å™¨ï¼šs&#x3D;Solver()</li>
</ul>
<h3 id="æ·»åŠ çº¦æŸæ¡ä»¶"><a href="#æ·»åŠ çº¦æŸæ¡ä»¶" class="headerlink" title="æ·»åŠ çº¦æŸæ¡ä»¶"></a>æ·»åŠ çº¦æŸæ¡ä»¶</h3><ul>
<li>ä½¿ç”¨å‡½æ•°add()æ·»åŠ çº¦æŸæ¡ä»¶ï¼šs.add(ä¸€ä¸ªæ–¹ç¨‹&#x2F;ä¸ç­‰å¼)</li>
</ul>
<h3 id="åˆ¤æ–­æ˜¯å¦æœ‰è§£"><a href="#åˆ¤æ–­æ˜¯å¦æœ‰è§£" class="headerlink" title="åˆ¤æ–­æ˜¯å¦æœ‰è§£"></a>åˆ¤æ–­æ˜¯å¦æœ‰è§£</h3><ul>
<li>ä½¿ç”¨å‡½æ•°check()æ£€æŸ¥æ˜¯å¦æœ‰è§£ï¼Œæœ‰è§£è¿”å›â€™satâ€™ï¼Œæ— è§£è¿”å›â€™unsatâ€™</li>
</ul>
<h3 id="å–è§£çš„äº¤é›†"><a href="#å–è§£çš„äº¤é›†" class="headerlink" title="å–è§£çš„äº¤é›†"></a>å–è§£çš„äº¤é›†</h3><ul>
<li>ä½¿ç”¨å‡½æ•°model()å–æ»¡è¶³æ¯ä¸ªæ¡ä»¶çš„è§£çš„äº¤é›†ï¼Œè¿”å›çš„æ˜¯å­—å…¸ï¼Œç”¨model[å˜é‡å]å¯ä»¥å¾—åˆ°å˜é‡çš„è§£</li>
</ul>
<h3 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h3><p>è§£æ–¹ç¨‹{x,y|30x+15y&#x3D;675,12x+5y&#x3D;265}</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> z3 <span class="hljs-keyword">import</span> *<br><br>x=Int(<span class="hljs-string">&#x27;x&#x27;</span>)<br>y=Int(<span class="hljs-string">&#x27;y&#x27;</span>)<br><br>s=Solver()<br>s.add(<span class="hljs-number">30</span>*x+<span class="hljs-number">15</span>*y==<span class="hljs-number">675</span>)<br>s.add(<span class="hljs-number">12</span>*x+<span class="hljs-number">5</span>*y==<span class="hljs-number">265</span>)<br><span class="hljs-keyword">if</span> s.check()==sat:<br>    <span class="hljs-built_in">print</span>(s.model())<br><span class="hljs-comment">#å¾—åˆ°è§£[x = 20, y = 5]</span><br></code></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>Reverseå­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>Reverse</tag>
      </tags>
  </entry>
  <entry>
    <title>Day13:åè°ƒè¯•ï¼ˆäºŒï¼‰</title>
    <url>/2025/08/03/Day13-%E5%8F%8D%E8%B0%83%E8%AF%95%EF%BC%88%E4%BA%8C%EF%BC%89/</url>
    <content><![CDATA[<p>æ—¶é—´å·®æ£€æµ‹ã€æ–­ç‚¹æ£€æµ‹</p>
<span id="more"></span>

<h2 id="æ—¶é—´å·®æ£€æµ‹"><a href="#æ—¶é—´å·®æ£€æµ‹" class="headerlink" title="æ—¶é—´å·®æ£€æµ‹"></a>æ—¶é—´å·®æ£€æµ‹</h2><ul>
<li>CPUçš„è¿è¡Œååˆ†è¿…é€Ÿï¼Œä¸€æ®µä»£ç å¯èƒ½åœ¨å‡ æ¯«ç§’å†…å°±å¯ä»¥æ‰§è¡Œå®Œæ¯•ï¼Œä½†æ˜¯è°ƒè¯•çš„æ—¶å€™ï¼Œä»£ç è¿è¡Œæ—¶é—´ä¼šæ˜¾è‘—åœ°å˜æ…¢ï¼Œè¿™å°±æ˜¯æ—¶é—´å·®æ£€æµ‹çš„åŸç†ã€‚æ—¶é—´å·®æ£€æµ‹ä¸»è¦é€šè¿‡è®¡ç®—æ—¶é—´å·®ç„¶åä¸é¢„è®¾çš„å€¼æ¯”è¾ƒå®ç°ã€‚</li>
</ul>
<h3 id="RDTSCæŒ‡ä»¤è®¡ç®—"><a href="#RDTSCæŒ‡ä»¤è®¡ç®—" class="headerlink" title="RDTSCæŒ‡ä»¤è®¡ç®—"></a>RDTSCæŒ‡ä»¤è®¡ç®—</h3><ul>
<li><p>rdtscæ˜¯ä¸€ä¸ªæ±‡ç¼–æŒ‡ä»¤ï¼Œç”¨äºå°†æ—¶é—´è¯»å…¥edx:eaxå¯„å­˜å™¨ï¼ˆé«˜32ä½ï¼šä½32ä½ï¼‰ã€‚é€šè¿‡å–ä¸¤æ¬¡æ—¶é—´æŠŠç»“æœç›¸å‡å¯ä»¥å¾—åˆ°ä¸€ä¸ªæ—¶é—´å·®ã€‚æ˜¾è‘—ç‰¹å¾å°±æ˜¯rdtscæŒ‡ä»¤</p>
</li>
<li><p>æ•ˆæœï¼š</p>
<p><img src="/../images/image-20250803103503205.png" alt="IDA"></p>
<p><img src="/../images/image-20250803103510223.png" alt="XDbg"></p>
</li>
<li><p>åº”å¯¹æ–¹æ³•ï¼š</p>
<p>æ ¹æ®ç¨‹åºçš„é€»è¾‘ï¼Œå¯ä»¥åœ¨è®¡ç®—å‡ºæ—¶é—´å·®å¹¶æ¯”è¾ƒä¹‹åæ”¹å˜æ¯”è¾ƒç»“æœã€‚</p>
</li>
</ul>
<h3 id="GetTickCountè®¡ç®—"><a href="#GetTickCountè®¡ç®—" class="headerlink" title="GetTickCountè®¡ç®—"></a>GetTickCountè®¡ç®—</h3><ul>
<li><p>åŸç†å’ŒRDTSCç±»ä¼¼ï¼Œåªä¸è¿‡æ—¶é—´å·®é‡‡ç”¨GetTickCountè®¡ç®—ã€‚GetTickCountä¹Ÿæ˜¯WINAPIï¼Œä¼šæœ‰æ˜æ˜¾æ ‡è®°ã€‚</p>
</li>
<li><p>æ•ˆæœï¼š</p>
<p><img src="/../images/image-20250803110132263.png" alt="IDA"></p>
<p><img src="/../images/image-20250803110151704.png" alt="XDbg"></p>
</li>
<li><p>åº”å¯¹æ–¹æ³•ï¼š</p>
<p>ä¿®æ”¹æ¯”è¾ƒç»“æœå³å¯</p>
</li>
</ul>
<h3 id="QueryPerformanceCounterè®¡ç®—"><a href="#QueryPerformanceCounterè®¡ç®—" class="headerlink" title="QueryPerformanceCounterè®¡ç®—"></a>QueryPerformanceCounterè®¡ç®—</h3><ul>
<li><p>åŸç†ç±»ä¼¼ï¼Œåªæ˜¯é‡‡ç”¨QueryPerformanceCounterè®¡ç®—ï¼Œä¹Ÿæ˜¯WINAPIï¼Œæ¯”è¾ƒå¥½è¯†åˆ«</p>
</li>
<li><p>æ•ˆæœï¼š</p>
<p><img src="/../images/image-20250803111252719.png" alt="IDA"></p>
<p><img src="/../images/image-20250803111302239.png" alt="XDbg"></p>
</li>
<li><p>åº”å¯¹æ–¹æ³•ï¼š</p>
<p>ä¿®æ”¹æ¯”è¾ƒç»“æœå³å¯</p>
</li>
</ul>
<h2 id="æ–­ç‚¹æ£€æµ‹"><a href="#æ–­ç‚¹æ£€æµ‹" class="headerlink" title="æ–­ç‚¹æ£€æµ‹"></a>æ–­ç‚¹æ£€æµ‹</h2><ul>
<li>æ–­ç‚¹æ˜¯è°ƒè¯•çš„ä¸€ä¸ªæ˜¾è‘—ç‰¹ç‚¹ã€‚æ–­ç‚¹å¯ä»¥åˆ†ä¸ºè½¯ä»¶æ–­ç‚¹ã€ç¡¬ä»¶æ–­ç‚¹å’Œå†…å­˜æ–­ç‚¹ã€‚è½¯ä»¶æ–­ç‚¹é€šè¿‡å°†ç›®æ ‡ä»£ç ä¿®æ”¹ä¸ºä¸­æ–­æŒ‡ä»¤ï¼ˆX86\X64ä¸‹ä¸€èˆ¬ä¸ºINT3\0xCCï¼‰å®ç°ï¼›ç¡¬ä»¶æ–­ç‚¹é€šè¿‡å°†æŒ‡ä»¤åœ°å€å†™å…¥è°ƒè¯•å¯„å­˜å™¨çš„DR0-DR3ç›‘æ§åœ°å€è®¿é—®æ¥å®ç°ï¼›å†…å­˜æ–­ç‚¹é€šè¿‡ä¿®æ”¹å†…å­˜é¡µï¼ˆä¸€ç‰‡ç‰‡å†…å­˜åŒºåŸŸï¼‰çš„è®¿é—®æƒé™å®ç°ã€‚ä¸‰è€…çš„å®ç°æ–¹æ³•éƒ½ä¼šè§¦å‘å¼‚å¸¸è®©è°ƒè¯•å™¨æ•è·è¿›è€Œä¸­æ–­ã€‚åè°ƒè¯•çš„æ–­ç‚¹æ£€æµ‹ä¸»è¦åˆ©ç”¨è½¯ä»¶æ–­ç‚¹å’Œç¡¬ä»¶æ–­ç‚¹ï¼Œå†…å­˜æ–­ç‚¹ç”±äºé’ˆå¯¹å†…å­˜åŒºåŸŸè€Œéå…·ä½“æŒ‡ä»¤ï¼Œç²¾åº¦å¤ªä½ï¼Œä¸€èˆ¬ä¸è€ƒè™‘ã€‚</li>
</ul>
<h3 id="è½¯ä»¶æ–­ç‚¹æ£€æµ‹"><a href="#è½¯ä»¶æ–­ç‚¹æ£€æµ‹" class="headerlink" title="è½¯ä»¶æ–­ç‚¹æ£€æµ‹"></a>è½¯ä»¶æ–­ç‚¹æ£€æµ‹</h3><ul>
<li><p>å¸¸è§æ‰‹æ®µæ˜¯åœ¨å†…å­˜åŒºåŸŸæœç´¢0xCCï¼ˆä½¿ç”¨æ±‡ç¼–æŒ‡ä»¤repnz scasbï¼‰</p>
</li>
<li><p>æ•ˆæœï¼š</p>
<p><img src="/../images/image-20250803184326511.png" alt="IDA"></p>
<p><img src="/../images/image-20250803184332179.png" alt="XDbg"></p>
</li>
<li><p>å› ä¸ºè¿›è¡Œäº†æ¯”è¾ƒï¼Œæ‰€ä»¥ä¿®æ”¹æ¯”è¾ƒç»“æœå³å¯ç»•è¿‡</p>
</li>
</ul>
<h3 id="ç¡¬ä»¶æ–­ç‚¹æ£€æµ‹"><a href="#ç¡¬ä»¶æ–­ç‚¹æ£€æµ‹" class="headerlink" title="ç¡¬ä»¶æ–­ç‚¹æ£€æµ‹"></a>ç¡¬ä»¶æ–­ç‚¹æ£€æµ‹</h3><ul>
<li><p>å¸¸è§æ‰‹æ®µæ˜¯è·å–DRå¯„å­˜å™¨çš„å€¼å¹¶å’Œ0æ¯”è¾ƒã€‚ç‰¹å¾æ˜¯GetThreadContextå‡½æ•°ï¼ˆæˆ–è€…å…¶ä»–ThreadContextç›¸å…³çš„å‡½æ•°ï¼‰å’Œä¸0çš„æ¯”è¾ƒ</p>
</li>
<li><p>æ•ˆæœï¼š</p>
<p><img src="/../images/image-20250803190042096.png" alt="IDA"></p>
<p><img src="/../images/image-20250803190057497.png" alt="XDbg"></p>
</li>
<li><p>åº”å¯¹æ–¹æ³•ï¼š</p>
<p>è¿˜æ˜¯è¿›è¡Œäº†æ¯”è¾ƒï¼Œä¿®æ”¹æ¯”è¾ƒç»“æœç»•è¿‡</p>
</li>
</ul>
]]></content>
      <categories>
        <category>Reverseå­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>Reverse</tag>
      </tags>
  </entry>
  <entry>
    <title>Day17:pythoné€†å‘</title>
    <url>/2025/10/05/Day17-python%E9%80%86%E5%90%91/</url>
    <content><![CDATA[<p>pycé€†å‘ï¼Œpythonå¯æ‰§è¡Œæ–‡ä»¶é€†å‘</p>
<span id="more"></span>

<h2 id="pycæ–‡ä»¶"><a href="#pycæ–‡ä»¶" class="headerlink" title="pycæ–‡ä»¶"></a>pycæ–‡ä»¶</h2><ul>
<li>pycæ–‡ä»¶æ˜¯pyæ–‡ä»¶ç¼–è¯‘è¿‡ç¨‹ä¸­äº§ç”Ÿçš„ä¸­é—´æ–‡ä»¶ï¼Œæ˜¯ä¸€ç§äºŒè¿›åˆ¶æ–‡ä»¶ã€‚pycæ–‡ä»¶å¯ä»¥ç”±pythonè™šæ‹Ÿæœºç›´æ¥æ‰§è¡Œã€‚ä¸åŒç‰ˆæœ¬çš„pythonç¼–è¯‘å‡ºæ¥çš„pycæ–‡ä»¶æ˜¯ä¸åŒçš„</li>
</ul>
<h3 id="pycæ–‡ä»¶ç»“æ„"><a href="#pycæ–‡ä»¶ç»“æ„" class="headerlink" title="pycæ–‡ä»¶ç»“æ„"></a>pycæ–‡ä»¶ç»“æ„</h3><ul>
<li><p>ä¸€ä¸ªpycæ–‡ä»¶ç”±ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ç»„æˆï¼š</p>
<p><img src="/../images/image-20251005201501358.png" alt="pycæ–‡ä»¶æ ¼å¼(å›¾ç‰‡æˆªå–è‡ªCTF wiki)"></p>
<p>å…¶ä¸­CodeObjectæ˜¯ç»è¿‡åºåˆ—åŒ–å¤„ç†çš„pythonæºç çš„äºŒè¿›åˆ¶ç </p>
</li>
</ul>
<h3 id="pycå­—èŠ‚ç "><a href="#pycå­—èŠ‚ç " class="headerlink" title="pycå­—èŠ‚ç "></a>pycå­—èŠ‚ç </h3><ul>
<li><p>pycæ–‡ä»¶æ˜¯äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå› æ­¤ä¹Ÿå¯ä»¥è¿›è¡Œåæ±‡ç¼–ã€‚pycæ–‡ä»¶æœ‰ä¸“é—¨çš„æ±‡ç¼–ä»£ç ï¼Œå°±åƒjavaæœ‰smaliæ±‡ç¼–ä¸€æ ·ã€‚</p>
</li>
<li><p>ä¸‹é¢æ˜¯ä¸€ä¸ªpycæ–‡ä»¶çš„åæ±‡ç¼–ä»£ç </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><code class="hljs plaintext">åŸä»£ç è¡Œå·|æŒ‡ä»¤çš„åç§»|æŒ‡ä»¤ç¬¦å·|æŒ‡ä»¤å‚æ•°ï¼ˆç´¢å¼•å€¼ï¼‰|å‚æ•°å®é™…å€¼	     <br>  0           0 RESUME                   0<br><br>  1           2 LOAD_CONST               0 (&lt;code object add at 0x00000186246D3770, file &quot;test.py&quot;, line 1&gt;)<br>              4 MAKE_FUNCTION            0<br>              6 STORE_NAME               0 (add)//æŠŠaddå‡½æ•°å­˜å…¥å‡½æ•°è¡¨ï¼Œç»™ç´¢å¼•å€¼0<br><br>  3           8 PUSH_NULL<br>             10 LOAD_NAME                1 (print)//åŠ è½½å‡½æ•°è¡¨ç´¢å¼•ä¸º1çš„å‡½æ•°print<br>             12 LOAD_CONST               1 (&#x27;hello python&#x27;)//åŠ è½½å¸¸é‡è¡¨ç´¢å¼•ä¸º1çš„&quot;hello python&quot;<br>             14 CALL                     1//callç´¢å¼•ä¸º1çš„å‡½æ•°print<br>             22 POP_TOP<br><br>  4          24 PUSH_NULL<br>             26 LOAD_NAME                1 (print)<br>             28 PUSH_NULL<br>             30 LOAD_NAME                0 (add)<br>             32 LOAD_CONST               2 (1)<br>             34 LOAD_CONST               3 (2)<br>             36 CALL                     2<br>             44 CALL                     1<br>             52 POP_TOP<br>             54 RETURN_CONST             4 (None)<br><br>Disassembly of &lt;code object add at 0x00000186246D3770, file &quot;test.py&quot;, line 1&gt;:<br>  1           0 RESUME                   0<br><br>  2           2 LOAD_FAST                0 (a)<br>              4 LOAD_FAST                1 (b)<br>              6 BINARY_OP                0 (+)<br>             10 RETURN_VALUE<br><br></code></pre></td></tr></table></figure>

<p>å¯¹ä¸Šé¢çš„ä¸€äº›æŒ‡ä»¤è¿›è¡Œè§£é‡Šï¼š</p>
<ul>
<li>LOAD_CONSTç”¨äºåŠ è½½å¸¸é‡ï¼Œåé¢è·Ÿç€çš„æ•°å­—æ˜¯å¸¸é‡åœ¨å¸¸é‡è¡¨ä¸­çš„ç´¢å¼•</li>
<li>LOAD_NAMEç”¨äºåŠ è½½å‡½æ•°ï¼Œåé¢è·Ÿç€çš„æ•°å­—æ˜¯å‡½æ•°åœ¨å‡½æ•°è¡¨ä¸­çš„ç´¢å¼•</li>
<li>LOAD_FASTç”¨äºåŠ è½½å±€éƒ¨å˜é‡ï¼ˆå¦‚å‡½æ•°å®šä¹‰æ—¶å€™çš„å‚æ•°æˆ–è€…å†…éƒ¨å˜é‡ï¼‰</li>
<li>å¯ä»¥æ³¨æ„åˆ°LOAD_NAMEæ€»æ˜¯å…ˆäºLOAD_CONSTçš„ï¼Œå³å‡½æ•°æ¯”å‚æ•°å…ˆä¸€æ­¥åŠ è½½</li>
<li>pythonè™šæ‹Ÿæœºæ˜¯åŸºäºæ ˆçš„ï¼Œæ‰€ä»¥å¯ä»¥çœ‹åˆ°POPç­‰å­—çœ¼ï¼ŒLOADç³»åˆ—æ“ä½œå®é™…ä¸Šæ˜¯å…¥æ ˆæ“ä½œ</li>
</ul>
</li>
</ul>
<h3 id="pycæ–‡ä»¶é€†å‘"><a href="#pycæ–‡ä»¶é€†å‘" class="headerlink" title="pycæ–‡ä»¶é€†å‘"></a>pycæ–‡ä»¶é€†å‘</h3><ul>
<li>æœªç»è¿‡æ··æ·†çš„pycæ–‡ä»¶ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡åœ¨çº¿å·¥å…·ï¼ˆå¦‚ï¼š<a href="https://www.lddgo.net/string/pyc-compile-decompile">åœ¨çº¿Python pycæ–‡ä»¶ç¼–è¯‘ä¸åç¼–è¯‘</a>ï¼‰æˆ–è€…uncompyle6ã€decompyle3ï¼ˆå‡å¯é€šè¿‡pip installå®‰è£…ï¼‰è½¬æˆpythonä»£ç </li>
<li>pycæ–‡ä»¶çš„æ··æ·†ï¼Œå°±ç±»ä¼¼èŠ±æŒ‡ä»¤ï¼Œé€šè¿‡åœ¨æ±‡ç¼–å±‚é¢æ’å…¥åƒåœ¾æŒ‡ä»¤å¹²æ‰°é™æ€åˆ†æã€‚è§£å†³åŠæ³•å°±æ˜¯ä¿®æ”¹äºŒè¿›åˆ¶æ–‡ä»¶ï¼ŒæŠŠåƒåœ¾æŒ‡ä»¤çš„äºŒè¿›åˆ¶ç ç»™åˆ é™¤ã€‚å¯ä»¥çœ‹çœ‹è¿™ç¯‡ï¼š<a href="https://zhuanlan.zhihu.com/p/145811103"> Pythonä»£ç ä¿æŠ¤ | pyc æ··æ·†ä»å…¥é—¨åˆ°å·¥å…·å®ç° - çŸ¥ä¹</a></li>
</ul>
<h2 id="pythonå¯æ‰§è¡Œæ–‡ä»¶"><a href="#pythonå¯æ‰§è¡Œæ–‡ä»¶" class="headerlink" title="pythonå¯æ‰§è¡Œæ–‡ä»¶"></a>pythonå¯æ‰§è¡Œæ–‡ä»¶</h2><ul>
<li><p>pythonæ–‡ä»¶å¯ä»¥è¢«æ‰“åŒ…æˆå¯æ‰§è¡Œæ–‡ä»¶ï¼Œé»˜è®¤å›¾æ ‡é•¿è¿™æ ·ï¼š</p>
<p><img src="/../images/image-20251005213749587.png" alt="å›¾æ ‡"></p>
</li>
<li><p>å¯¹äºæ­¤ç±»é—®é¢˜ï¼Œå…ˆä½¿ç”¨<a href="https://github.com/extremecoders-re/pyinstxtractor">pyinstxtractor</a>è§£åŒ…ç¨‹åºï¼ˆè¿™é‡Œæ‹¿ä¸€ä¸ªä¸çŸ¥é“å“ªé‡Œæ¥çš„pythonexeæ–‡ä»¶ä¸¾ä¾‹ï¼‰ï¼š</p>
<p><img src="/../images/image-20251005214956424.png" alt="è§£åŒ…"></p>
<p>pyinstxtractorä¼šæŠŠå¯æ‰§è¡Œæ–‡ä»¶è§£åŒ…åˆ°å¸¦åç¼€extractedçš„ä¸€ä¸ªæ–‡ä»¶å¤¹é‡Œï¼Œé™¤æ­¤ä¹‹å¤–å¯ä»¥çœ‹åˆ°ï¼Œç¨‹åºä¼šç»™å‡ºå¯èƒ½çš„å…¥å£æ–‡ä»¶ï¼Œä»¥åŠå¯æ‰§è¡Œæ–‡ä»¶çš„pythonç‰ˆæœ¬ï¼Œç„¶åå°±å¯ä»¥åˆ†æè¿™äº›pycæ–‡ä»¶äº†</p>
</li>
<li><p>pythonæ–‡ä»¶è¢«æ‰“åŒ…çš„æ—¶å€™è¿˜å¯ä»¥æŒ‡å®šåŠ å¯†å‚æ•°ï¼Œè§£å¯†çš„æ—¶å€™æ ¹æ®æ‰“åŒ…çš„pyinstallerç‰ˆæœ¬å¯ä»¥åˆ†ä¸ºä¸¤ç§ï¼Œå¤§äº4.0çš„å’Œå°äº4.0çš„ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„è„šæœ¬è§£å¯†ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">//å¤§äº<span class="hljs-number">4.0</span>ç‰ˆæœ¬<br><span class="hljs-keyword">import</span> tinyaes<br><span class="hljs-keyword">import</span> zlib<br><br>CRYPT_BLOCK_SIZE=<span class="hljs-number">16</span><br><br>key = butes(<span class="hljs-string">&#x27;here_be_your_key&#x27;</span>,<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br><br>inf=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;here_be_your_file_name&#x27;</span>,<span class="hljs-string">&#x27;rb&#x27;</span>)<br>outf=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;here_be_your_output_file&#x27;</span>,<span class="hljs-string">&#x27;wb&#x27;</span>)<br><br>iv=inf.read(CRYPT_BLOCK_SIZE)<br><br>cipher=tinyaes.AES(key,iv)<br><br>plaintext=zlib.decompress(cipher.CTR_xcrypt_buffer(inf.read()))<br><br>outf.write(<span class="hljs-string">b&#x27;\x55\x0d\x0d\x0a\0\0\0\0\0\0\0\0\0\0\0\0&#x27;</span>)<span class="hljs-comment">#here be your magic number from pyfile in the same dir,16bytes</span><br><br>outf.write(plaintext)<br><br>inf.close()<br>outf.close()<br><br>//å°äº<span class="hljs-number">4.0</span>ç‰ˆæœ¬<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">import</span> zlib<br><br>CRYPT_BLOCK_SIZE=<span class="hljs-number">16</span><br><br>key=<span class="hljs-string">b&#x27;here_be_your_key&#x27;</span><br><br>inf=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;here_be_your_cryptedfile_name&#x27;</span>,<span class="hljs-string">&#x27;rb&#x27;</span>)<br>outf=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;here_be_your_output_file_name&#x27;</span>,<span class="hljs-string">&#x27;wb&#x27;</span>)<br><br>iv=inf.read(CRYPT_BLOCK_SIZE)<br><br>cipher-AES.new(key,AES.MODE_CFB,iv)<br><br>plaintext=zlib.decompress(cipher,hecrypt(inf.read()))<br> <br>outf.write(<span class="hljs-string">&#x27;here_be_your_magicnumber&#x27;</span>)<span class="hljs-comment">#8bytes</span><br><br>outf.write(plaintext)<br><br>inf.close()<br>outf.close()<br></code></pre></td></tr></table></figure>

<p>ä»£ç é‡Œé¢çš„keyå¯ä»¥æ‰¾å¯ç–‘çš„pycæ–‡ä»¶è½¬æˆpythonä»£ç æŸ¥çœ‹ï¼Œè€Œç‰ˆæœ¬å¯ä»¥é€šè¿‡æŸ¥çœ‹pyimod01_archive.pycå¯¼å…¥çš„åŠ å¯†åº“æ¥è¯†åˆ«ï¼ˆä¸Šé¢ä¸¤ä¸ªç‰ˆæœ¬çš„è„šæœ¬å¯¼å…¥çš„åŠ å¯†åº“åˆ†åˆ«æ˜¯tinyaeså’ŒAESï¼Œæ˜¯ä¸ä¸€æ ·çš„ï¼‰</p>
</li>
</ul>
]]></content>
      <categories>
        <category>Reverseå­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>Reverse</tag>
      </tags>
  </entry>
  <entry>
    <title>Day14:IDApythonä¸SMC</title>
    <url>/2025/08/05/Day14-IDApython%E4%B8%8ESMC/</url>
    <content><![CDATA[<p>IDApythonAPIã€SMCè‡ªä¿®æ”¹ä»£ç </p>
<span id="more"></span>

<h2 id="IDApython"><a href="#IDApython" class="headerlink" title="IDApython"></a>IDApython</h2><ul>
<li>å…ˆè´´ä¸Šå®˜æ–¹æ–‡æ¡£ï¼š <a href="https://python.docs.hex-rays.com/index.html">https://python.docs.hex-rays.com/index.html</a></li>
</ul>
<h3 id="åŸºç¡€API"><a href="#åŸºç¡€API" class="headerlink" title="åŸºç¡€API"></a>åŸºç¡€API</h3><ul>
<li>idc.here() &#x2F; idc.get_screen_ea()ï¼šè¿”å›å…‰æ ‡æ‰€åœ¨å¤„çš„åœ°å€</li>
<li>idc.get_inf_attr(INF_MIN_EA) &#x2F; idc.get_inf_attr(INF_MAX_EA)ï¼šè¿”å›æœ€å°&#x2F;æœ€å¤§åœ°å€ï¼ˆæ²¡æœ‰éšæœºåŒ–åœ°å€æƒ…å†µä¸‹ï¼‰</li>
<li>idc.generate_disasm_line(ea,0)ï¼šè¿”å›eaæ‰€åœ¨å¤„çš„æ±‡ç¼–æŒ‡ä»¤</li>
<li>idc.prev_head(ea)&#x2F;next_head(ea)ï¼šè¿”å›eaå¤„ä¸Šä¸€æ¡&#x2F;ä¸‹ä¸€æ¡æŒ‡ä»¤åœ°å€</li>
<li>idc.print_insn_mnem(ea)ï¼šæ‰“å°eaå¤„çš„åŠ©è®°ç¬¦ï¼ˆå³mov,addä»€ä¹ˆçš„ï¼‰</li>
<li>idc.print_operand(ea,n)ï¼šæ‰“å°eaå¤„ç¬¬nä¸ªæ“ä½œæ•°ï¼ˆn&#x3D;0æˆ–è€…1ï¼‰</li>
</ul>
<h3 id="æ®µç›¸å…³API"><a href="#æ®µç›¸å…³API" class="headerlink" title="æ®µç›¸å…³API"></a>æ®µç›¸å…³API</h3><ul>
<li>idautils.Segments()ï¼šè¿”å›æ®µèµ·å§‹åœ°å€åˆ—è¡¨</li>
<li>idc.get_segm_name(ea)ï¼šè¿”å›eaæ‰€åœ¨æ®µçš„åå­—</li>
<li>idc.get_segm_start(ea)&#x2F;get_segm_end(ea)ï¼šè¿”å›eaæ‰€åœ¨æ®µçš„èµ·å§‹åœ°å€&#x2F;ç»“æŸåœ°å€</li>
<li>idc.get_next_seg(ea)ï¼šè¿”å›eaæ‰€åœ¨æ®µçš„ä¸‹ä¸€ä¸ªæ®µçš„èµ·å§‹åœ°å€</li>
</ul>
<h3 id="å‡½æ•°ç›¸å…³API"><a href="#å‡½æ•°ç›¸å…³API" class="headerlink" title="å‡½æ•°ç›¸å…³API"></a>å‡½æ•°ç›¸å…³API</h3><ul>
<li>idautils.Functions(start_addr,end_addr)ï¼šè¿”å›åœ°å€é—´çš„å‡½æ•°å¯¹è±¡ï¼ˆä¸å†™å‚æ•°å°±æ˜¯æ‰€æœ‰å‡½æ•°å¯¹è±¡ï¼‰</li>
<li>idautils.FuncItems(ea)ï¼šè¿”å›eaæ‰€åœ¨å‡½æ•°æ‰€æœ‰æŒ‡ä»¤çš„åœ°å€ï¼ˆç›¸å½“äºåœ°å€åˆ—è¡¨ï¼‰</li>
<li>idaapi.get_func(ea)ï¼šè·å¾—eaæ‰€åœ¨å‡½æ•°çš„å¯¹è±¡ï¼ˆå«æœ‰å¦‚start_eaã€end_eaã€sizeç­‰å±æ€§ï¼‰</li>
<li>idc.get_func_name(ea)ï¼šè¿”å›eaæ‰€åœ¨å‡½æ•°çš„åå­—</li>
<li>idc.get_func_attr(ea,FUNCATTR_START) &#x2F; idc.get_func_attr(ea,FUNCATTR_END)ï¼šè¿”å›eaæ‰€åœ¨å‡½æ•°çš„èµ·å§‹åœ°å€&#x2F;ç»“æŸåœ°å€</li>
<li>idc.get_next_func(ea) &#x2F; idc.get_prev_func(ea)ï¼šè¿”å›eaæ‰€åœ¨å‡½æ•°çš„ä¸Šä¸€ä¸ª&#x2F;ä¸‹ä¸€ä¸ªå‡½æ•°çš„èµ·å§‹åœ°å€</li>
</ul>
<h3 id="æŒ‡ä»¤ç›¸å…³API"><a href="#æŒ‡ä»¤ç›¸å…³API" class="headerlink" title="æŒ‡ä»¤ç›¸å…³API"></a>æŒ‡ä»¤ç›¸å…³API</h3><ul>
<li>ida_ua.insn_t()ï¼Œè¿”å›ä¸€ä¸ªç©ºçš„æŒ‡ä»¤å¯¹è±¡ï¼ˆæˆ–è€…è¯´åˆ›å»ºä¸€ä¸ªç©ºçš„æŒ‡ä»¤å¯¹è±¡ï¼‰ï¼ŒåŒ…å«å‡½æ•°çš„ä¸€äº›å±æ€§</li>
<li>idaapi.decode_insn(out,ea)ï¼Œè§£æeaæ‰€åœ¨å¤„çš„æŒ‡ä»¤ï¼ŒæŠŠè§£æçš„ç»“æœç»™outï¼ˆoutå¿…é¡»æ˜¯ä¸€ä¸ªæŒ‡ä»¤å¯¹è±¡ï¼‰<ul>
<li>out.eaï¼šæŒ‡ä»¤çš„èµ·å§‹åœ°å€</li>
<li>out.sizeï¼šæŒ‡ä»¤å ç”¨çš„å­—èŠ‚æ•°</li>
<li>out.get_cannon_mnemonic()ï¼šæŒ‡ä»¤çš„åŠ©è®°ç¬¦</li>
<li>out.itypeï¼šåŠ©è®°ç¬¦çš„åè¿›åˆ¶ç </li>
</ul>
</li>
</ul>
<h3 id="æ“ä½œæ•°ç›¸å…³API"><a href="#æ“ä½œæ•°ç›¸å…³API" class="headerlink" title="æ“ä½œæ•°ç›¸å…³API"></a>æ“ä½œæ•°ç›¸å…³API</h3><ul>
<li>idc.get_operand_value(ea,n)ï¼šè¿”å›eaå¤„ç¬¬nä¸ªæ“ä½œæ•°çš„å€¼</li>
<li>idc.get_operand_type(ea,n)ï¼šè¿”å›eaå¤„ç¬¬nä¸ªæ“ä½œæ•°çš„ç±»å‹</li>
</ul>
<h3 id="æ•°æ®è¯»å†™ç›¸å…³API"><a href="#æ•°æ®è¯»å†™ç›¸å…³API" class="headerlink" title="æ•°æ®è¯»å†™ç›¸å…³API"></a>æ•°æ®è¯»å†™ç›¸å…³API</h3><ul>
<li>idc.get_bytes(ea,size)ï¼šè¿”å›eaå¤„sizeå¤§å°çš„bytes</li>
<li>idc.patch_byte(ea,content)ï¼šä¿®æ”¹eaå¤„çš„1å­—èŠ‚ä¸ºcontent</li>
<li>idc.patch_word(ea,content)ï¼šä¿®æ”¹eaå¤„çš„2å­—èŠ‚ä¸ºcontent</li>
<li>idc.patch_dword(ea,content)ï¼šä¿®æ”¹eaå¤„çš„4å­—èŠ‚ä¸ºcontent</li>
<li>idc.patch_qword(ea,content)ï¼šä¿®æ”¹eaå¤„çš„8å­—èŠ‚ä¸ºcontent</li>
</ul>
<h3 id="è°ƒè¯•ç›¸å…³API"><a href="#è°ƒè¯•ç›¸å…³API" class="headerlink" title="è°ƒè¯•ç›¸å…³API"></a>è°ƒè¯•ç›¸å…³API</h3><ul>
<li><p>ida_dbg.load_debugger(â€œlocalâ€,0)ï¼šå¯åŠ¨è°ƒè¯•å™¨</p>
</li>
<li><p>ida_dbg.add_bpt(ea)ï¼šåœ¨eaå¤„ä¸‹æ–­ç‚¹</p>
</li>
<li><p>ida_dbg.del_bpt(ea)ï¼šåˆ é™¤eaå¤„æ–­ç‚¹</p>
</li>
<li><p>ida_dbg.start_process(path,args,sdir)ï¼šå¯åŠ¨è°ƒè¯•è¿›ç¨‹ï¼Œå‚æ•°å¯¹åº”è·¯å¾„ã€å‘½ä»¤è¡Œå‚æ•°ã€å·¥ä½œç›®å½•</p>
</li>
<li><p>ida_dbg.step_into()ï¼šå•æ­¥æ­¥å…¥</p>
</li>
<li><p>ida_dbg.step_over()ï¼šå•æ­¥æ­¥è¿‡</p>
</li>
<li><p>ida_dbg.step_until_ret()ï¼šè¿è¡Œåˆ°è¿”å›</p>
</li>
<li><p>idc.get_reg_value(regname)ï¼šè·å–regnameå¯„å­˜å™¨çš„å€¼</p>
</li>
<li><p>idc.set_reg_value(value,regname)ï¼šè®¾ç½®regnameå¯„å­˜å™¨çš„å€¼</p>
</li>
</ul>
<h3 id="å…¶ä»–æ“ä½œç›¸å…³API"><a href="#å…¶ä»–æ“ä½œç›¸å…³API" class="headerlink" title="å…¶ä»–æ“ä½œç›¸å…³API"></a>å…¶ä»–æ“ä½œç›¸å…³API</h3><ul>
<li><p>idautils.XrefsFrom(ea)ï¼šè¿”å›eaå¤„å¼•ç”¨çš„å¯¹è±¡ï¼ˆæœ‰å±æ€§frmã€toã€typeï¼‰</p>
</li>
<li><p>idautils.XrefsTo(ea)ï¼šè¿”å›æ‰€æœ‰å¼•ç”¨eaå¤„çš„å¯¹è±¡ï¼ˆæœ‰å±æ€§frmã€toã€typeï¼‰ï¼ˆCtrl+Xï¼‰</p>
<p>ç¤ºä¾‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> idautils,idaapi<br><span class="hljs-keyword">for</span> xref <span class="hljs-keyword">in</span> idautils.XrefsTo(here()):<br>    <span class="hljs-built_in">print</span>(xref.to)<span class="hljs-comment">#here()</span><br>    <span class="hljs-built_in">print</span>(xref.frm)<span class="hljs-comment">#è°ƒç”¨here()çš„å‡½æ•°åœ°å€</span><br><span class="hljs-keyword">for</span> xref <span class="hljs-keyword">in</span> idautils.XrefsFrom(here()):<br>    <span class="hljs-built_in">print</span>(xref.frm)<span class="hljs-comment">#here()</span><br>    <span class="hljs-built_in">print</span>(xref.to)<span class="hljs-comment">#here()å¼•ç”¨çš„å‡½æ•°åœ°å€</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>idautils.Strings()ï¼šè¿”å›åŒ…å«æ‰€æœ‰å­—ç¬¦ä¸²çš„å¯¹è±¡ï¼ˆæœ‰å±æ€§eaã€lengthã€strtypeï¼‰ï¼ˆshift+F12ï¼‰</p>
</li>
<li><p>idc.get_strlit_contents(ea)ï¼šè¿”å›eaå¤„çš„å­—ç¬¦ä¸²</p>
<p>ç¤ºä¾‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> idc,idautils<br><span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> idautils.Strings():<br>    string=idc.get_strlit_contents(s.ea)<br>    <span class="hljs-built_in">print</span>(string)<br><span class="hljs-comment">#æ‰“å°æ‰€æœ‰å­—ç¬¦ä¸²</span><br></code></pre></td></tr></table></figure></li>
</ul>
<h2 id="è‡ªä¿®æ”¹ä»£ç ï¼ˆSMCï¼‰"><a href="#è‡ªä¿®æ”¹ä»£ç ï¼ˆSMCï¼‰" class="headerlink" title="è‡ªä¿®æ”¹ä»£ç ï¼ˆSMCï¼‰"></a>è‡ªä¿®æ”¹ä»£ç ï¼ˆSMCï¼‰</h2><ul>
<li><p>è‡ªä¿®æ”¹ä»£ç ï¼ˆSelf-Modifying-Codeï¼‰æŒ‡æŸéƒ¨åˆ†ä»£ç ä»¥åŠ å¯†åçš„å½¢å¼å­˜åœ¨äºç¨‹åºä¸­ï¼Œç¨‹åºæ‰§è¡Œåˆ°è¿™éƒ¨åˆ†ä»£ç çš„æ—¶å€™æ‰ä¼šè¿›è¡ŒåŠ¨æ€è§£å¯†ï¼Œå’ŒåŠ å£³æœ‰ç‚¹å¼‚æ›²åŒå·¥ã€‚å¸¸ç”¨æ¥åŠ å¯†å…³é”®é€»è¾‘ï¼Œä½¿å…¶ä¸å¯ç›´æ¥é™æ€åˆ†æ</p>
</li>
<li><p>ç‰¹å¾ï¼š</p>
<p>ç¨‹åºä¸­å­˜åœ¨å¯¹ç¨‹åºè‡ªèº«æŸéƒ¨åˆ†çš„è¿ç®—ï¼Œä¸€èˆ¬è¿˜éœ€è¦VirtualProtect() &#x2F; mprotect()æ¥æ”¹å˜å†…å­˜çš„å±æ€§ä»¥ä¾¿å°†è§£å¯†åçš„ä»£ç æ•°æ®å†™å…¥å†…å­˜ï¼Œæˆ–è€…ä½¿ç”¨VirtualAllocæŠŠè§£å¯†åçš„ä»£ç æ•°æ®å†™å…¥å †ä¸­æ‰§è¡Œï¼ˆä¸ºäº†é¿å…APIæš´éœ²ï¼Œè¿˜å¯èƒ½ä¼šæ–°å¢ä¸€ä¸ªæœ‰RWXå±æ€§çš„æ®µæ¥å­˜æ”¾åŠ å¯†åçš„ä»£ç ï¼‰ã€‚</p>
</li>
<li><p>åº”å¯¹æ–¹æ³•æœ‰ä¸¤ç§ï¼šä¸€ç§æ˜¯åŠ¨æ€è°ƒè¯•å¾—åˆ°è§£å¯†åçš„å…³é”®é€»è¾‘ï¼Œå¦ä¸€ç§æ˜¯ä½¿ç”¨è„šæœ¬è§£å¯†å…³é”®é€»è¾‘åå†è¦†ç›–å›å»</p>
<ul>
<li><p>ç¤ºä¾‹ï¼š2021-ç¾ŠåŸæ¯-babysmc</p>
<p>PSï¼šæœ¬æ¥æƒ³è¦è‡ªå·±å†™ä¸€ä¸ªç®€å•ç¨‹åºè¯•è¯•æ‰‹çš„ï¼Œç ”ç©¶äº†åŠä¸ªä¸‹åˆæ²¡ç ”ç©¶å‡ºæ¥ï¼Œç¨‹åºä¿®æ­£åˆ°è§£å¯†å‡½æ•°å¯ä»¥è§£å¯†å‡ºæ­£ç¡®ä»£ç äº†ï¼Œä½†æ˜¯è°ƒç”¨å…³é”®é€»è¾‘checkçš„æ—¶å€™è«åå…¶å¦™è·‘é£äº†ï¼Œåœ¨é‚£ä¸ªå®‰å…¨æ£€æŸ¥çš„ä½ç½®ï¼Œè·³è½¬ååƒæ˜¯ä¸ªç•¸å½¢å‡½æ•°ï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯æ”¹å†…å­˜å±æ€§çš„æ—¶å€™å½±å“åˆ°äº†ï¼Œæ‰€ä»¥åªèƒ½å»æ‰¾ç½‘ä¸Šçš„é¢˜ç›®äº†</p>
</li>
<li><p>è¿™æ˜¯ä¼˜åŒ–åçš„ä¸»å‡½æ•°ï¼š</p>
<p><img src="/../images/image-20250805234429100.png" alt="ä¸»å‡½æ•°"></p>
<p>ä¼˜åŒ–çš„æ¥æºå°±æ˜¯ï¼Œencçš„ä½ç½®æ˜¯ä¸€å›¢æ•°å­—ï¼Œè€Œloc_7FF6BF081D00å¤„å¼€å§‹æ˜¯æ­£å¸¸ä»£ç ï¼ŒåŠ ä¸Šå¯¹ä¸‹é¢çš„decryptå‡½æ•°çš„åˆ†æï¼Œå¯ä»¥ç¡®å®šencå°±æ˜¯è¢«åŠ å¯†åçš„first_part</p>
</li>
<li><p>è¿™æ˜¯decryptå‡½æ•°ï¼š</p>
<p><img src="/../images/image-20250805234728191.png" alt="decryptå‡½æ•°"></p>
<p>éå¸¸æ˜æ˜¾åœ°è°ƒç”¨äº†VirtualProtectå‡½æ•°ï¼Œè§£å¯†é€»è¾‘å¾ˆç®€å•ï¼Œå°±æ˜¯roråå¼‚æˆ–0x5aï¼ˆroræŸ¥å‡ºæ¥æ˜¯å¾ªç¯å³ç§»ï¼Œ3å°±æ˜¯å³ç§»çš„ä½æ•°äº†ï¼Œè¿™ç‚¹çœ‹æ±‡ç¼–å¯èƒ½æ›´æ¸…æ™°ç‚¹ï¼‰</p>
</li>
<li><p>ä¸‹é¢å°±æ˜¯ä»Šå¤©çš„æˆæœå±•ç¤ºäº†ï¼ˆrorç”±DSååŠ©å®ç°ï¼‰ï¼ŒSMCè§£å¯†è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> idautils,idc,idaapi<br><br>enc=idc.get_bytes(<span class="hljs-number">0x00007FF6BF081085</span>,<span class="hljs-number">0x00007FF6BF081D00</span>-<span class="hljs-number">0x00007FF6BF081085</span>)<br>loc=<span class="hljs-number">0x00007FF6BF081085</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ror</span>(<span class="hljs-params">value, shift, bits=<span class="hljs-number">8</span></span>):<br>    shift %= bits  <span class="hljs-comment"># ç¡®ä¿ä½ç§»é‡åœ¨æœ‰æ•ˆèŒƒå›´å†…</span><br>    <span class="hljs-keyword">return</span> (value &gt;&gt; shift) | ((value &lt;&lt; (bits - shift)) &amp; ((<span class="hljs-number">1</span> &lt;&lt; bits) - <span class="hljs-number">1</span>))<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> enc:<br>    idc.patch_byte(loc,(ror(i,<span class="hljs-number">3</span>)^<span class="hljs-number">0x5a</span>)&amp;<span class="hljs-number">0xff</span>)<br>    loc+=<span class="hljs-number">1</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;done&quot;</span>)<br></code></pre></td></tr></table></figure>
</li>
<li><p>æœ¬æ¥æ˜¯è¦å†™å®Œçš„ï¼Œä½†æ˜¯first_partçš„å‡½æ•°è§£æå®Œå¥½å‡ ç™¾è¡Œäº†ï¼Œæ˜¯æˆ‘çœ‹ä¸æ‡‚çš„åŠ å¯†ğŸ« å»æ‰¾WPï¼Œå‘ç°æ˜¯éå¸¸æ··æ·†çš„base64ï¼Œè¿˜åŠ äº†å¼‚æˆ–ï¼Œä½†æ˜¯æˆ‘æ²¡çœ‹å‡ºé€»è¾‘ï¼Œç´¢æ€§ç‚¹åˆ°ä¸ºæ­¢ï¼Œæ”¹å¤©æŠŠç¼–ç å’Œå¯†ç çš„éƒ¨åˆ†è¡¥ä¸Šå†è¯´ã€‚</p>
</li>
<li><p>æœ¬æ¥ä¹Ÿå°è¯•äº†åŠ¨è°ƒè§£å¯†ï¼Œä½†æ˜¯è°ƒç€è°ƒç€ç»™æˆ‘ä¸‹èµ·ä¸œè¥¿æ¥äº†ï¼Œè™½ç„¶é“¾æ¥çœ‹ç€æ˜¯å¾®è½¯çš„ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰ç‚¹æ€•ï¼Œå°±èˆå¼ƒè¿™ä¸ªæ–¹æ³•äº†ï¼ˆä¸‹çš„æ˜¯kernel.pdbå¥½åƒï¼ŒDSè¯´æ˜¯ç¼ºå¤±ç¬¦å·æ–‡ä»¶ğŸ« ğŸ« ï¼‰</p>
</li>
</ul>
</li>
</ul>
]]></content>
      <categories>
        <category>Reverseå­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>Reverse</tag>
      </tags>
  </entry>
  <entry>
    <title>Day15:æŒ‡ä»¤è™šæ‹ŸåŒ–</title>
    <url>/2025/08/06/Day15-%E6%8C%87%E4%BB%A4%E8%99%9A%E6%8B%9F%E5%8C%96/</url>
    <content><![CDATA[<p>æŒ‡ä»¤è™šæ‹ŸåŒ–ã€å®ç°ä¸€ä¸ªå°å‹è™šæ‹Ÿæœºç¨‹åºã€VMé€†å‘å®è·µ</p>
<span id="more"></span>

<h2 id="ä»€ä¹ˆæ˜¯æŒ‡ä»¤è™šæ‹ŸåŒ–"><a href="#ä»€ä¹ˆæ˜¯æŒ‡ä»¤è™šæ‹ŸåŒ–" class="headerlink" title="ä»€ä¹ˆæ˜¯æŒ‡ä»¤è™šæ‹ŸåŒ–"></a>ä»€ä¹ˆæ˜¯æŒ‡ä»¤è™šæ‹ŸåŒ–</h2><ul>
<li><p>CPUå‚å•†åœ¨å¼€å‘CPUå‰ä¼šåˆ¶å®šä¸€ä¸ªè§„èŒƒï¼Œå»ºç«‹èµ·æ•°æ®å’Œæ“ä½œçš„å¯¹åº”å…³ç³»ï¼ˆå¦‚x86-64è§„å®š0x30å¯¹åº”å¼‚æˆ–æ“ä½œï¼‰ï¼Œè€Œè¿™ä¸ªæ•°æ®åˆå¯ä»¥æ ¹æ®æ“ä½œå‘½åå‡ºæ±‡ç¼–æŒ‡ä»¤ï¼ˆå¦‚0x30å‘½åä¸ºxorï¼‰ï¼Œå› æ­¤æœ‰äº†æ•°æ®ä¸æ“ä½œçš„å¯¹åº”å…³ç³»å’Œæ±‡ç¼–æŒ‡ä»¤ä¸æ“ä½œçš„å¯¹åº”å…³ç³»ï¼Œç§°ä¹‹ä¸ºæŒ‡ä»¤é›†ã€‚CPUå¯ä»¥è§†ä½œä¸€ä¸ªè§£é‡Šå™¨ï¼Œè´Ÿè´£è¯»å–æ•°æ®æˆ–è€…æ±‡ç¼–æŒ‡ä»¤ç„¶åå¸¦åŠ¨æœºå™¨äº§ç”Ÿæ“ä½œã€‚</p>
</li>
<li><p>é€šä¿—çš„è®²ï¼ŒæŒ‡ä»¤è™šæ‹ŸåŒ–å®é™…ä¸Šå°±æ˜¯è‡ªå®šä¹‰æŒ‡ä»¤é›†å¹¶ä¸ºè‡ªå·±çš„æŒ‡ä»¤é›†æ„å»ºè§£é‡Šå™¨ï¼Œç”¨è‡ªå®šä¹‰çš„æŒ‡ä»¤å®ç°ç¨‹åºçš„è¿‡ç¨‹ã€‚è¿™ä¸ªè¿‡ç¨‹åˆ©ç”¨é«˜çº§è¯­è¨€ä»£ç å®ç°ï¼Œä¹Ÿå°±æ˜¯ç”¨è½¯ä»¶æ¥æ¨¡æ‹Ÿç¡¬ä»¶ï¼Œç±»ä¼¼äºè™šæ‹Ÿæœºï¼Œå› æ­¤ç§°ä¹‹ä¸ºæŒ‡ä»¤è™šæ‹ŸåŒ–ã€‚</p>
</li>
<li><p>å®ç°æŒ‡ä»¤è™šæ‹ŸåŒ–ï¼Œéœ€è¦å®šä¹‰å¯„å­˜å™¨å˜é‡ï¼ˆè‡³å°‘éœ€è¦ä¸€ä¸ªEIPæ¥æŒ‡å‘è¿è¡Œçš„æŒ‡ä»¤ï¼‰ã€å†…å­˜ç©ºé—´æ•°ç»„ã€è§£é‡Šå™¨å’ŒæŒ‡ä»¤æ•°ç»„ã€‚</p>
</li>
<li><p>å®ç°è‡ªå®šä¹‰æŒ‡ä»¤é›†çš„è§£é‡Šå™¨ï¼Œå¯ä»¥é‡‡ç”¨Cè¯­è¨€çš„switchï¼ˆå…¶ä¸­codeæ˜¯è‡ªå®šä¹‰æŒ‡ä»¤ï¼Œé€šè¿‡å¾ªç¯è¾“å…¥ï¼‰ï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-comment">//è§£é‡Šå™¨ï¼š1è¾“å‡º11111ï¼Œ2è¾“å‡º22222ï¼Œ3è¾“å‡º33333</span><br><span class="hljs-keyword">switch</span>(code):<br><span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br>	<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;11111&quot;</span>);<br>	<span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<br>	print(<span class="hljs-string">&quot;22222&quot;</span>);<br>	<span class="hljs-keyword">break</span>:<br><span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:<br>	print(<span class="hljs-string">&quot;33333&quot;</span>);<br>	<span class="hljs-keyword">break</span>;<br></code></pre></td></tr></table></figure></li>
</ul>
<h2 id="å®ç°ä¸€ä¸ªå°å‹è™šæ‹Ÿæœºç¨‹åº"><a href="#å®ç°ä¸€ä¸ªå°å‹è™šæ‹Ÿæœºç¨‹åº" class="headerlink" title="å®ç°ä¸€ä¸ªå°å‹è™šæ‹Ÿæœºç¨‹åº"></a>å®ç°ä¸€ä¸ªå°å‹è™šæ‹Ÿæœºç¨‹åº</h2><ul>
<li>å°è¯•ç¼–å†™ä¸€ä¸ªè¾“å…¥ä¸¤ä¸ªæ•°ï¼Œè¾“å‡ºå’Œçš„ç¨‹åº</li>
</ul>
<h3 id="å£°æ˜è™šæ‹Ÿç¡¬ä»¶ç»“æ„ä½“"><a href="#å£°æ˜è™šæ‹Ÿç¡¬ä»¶ç»“æ„ä½“" class="headerlink" title="å£°æ˜è™šæ‹Ÿç¡¬ä»¶ç»“æ„ä½“"></a>å£°æ˜è™šæ‹Ÿç¡¬ä»¶ç»“æ„ä½“</h3><figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span>&#123;</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> r1;<span class="hljs-comment">//å¯„å­˜å™¨r1</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> r2;<span class="hljs-comment">//å¯„å­˜å™¨r2</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> eip;<span class="hljs-comment">//å¯„å­˜å™¨eip</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> mem[<span class="hljs-number">256</span>];<span class="hljs-comment">//è™šæ‹Ÿå†…å­˜æ•°ç»„</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> code[<span class="hljs-number">1024</span>];<span class="hljs-comment">//æŒ‡ä»¤æ•°ç»„</span><br>&#125; VM;<br></code></pre></td></tr></table></figure>

<h3 id="å®šä¹‰æŒ‡ä»¤é›†"><a href="#å®šä¹‰æŒ‡ä»¤é›†" class="headerlink" title="å®šä¹‰æŒ‡ä»¤é›†"></a>å®šä¹‰æŒ‡ä»¤é›†</h3><ul>
<li>ä½¿ç”¨op1ã€op2è¡¨ç¤ºæŒ‡ä»¤åé¢è·Ÿçš„æ“ä½œæ•°ï¼Œå¯„å­˜å™¨ä½œä¸ºéšå¼å‚æ•°ä¸ä¼šå‡ºç°åœ¨codeä¸­</li>
</ul>
<table>
<thead>
<tr>
<th align="center">æŒ‡ä»¤</th>
<th align="center">ä½¿ç”¨æ ¼å¼</th>
<th align="center">å¯¹åº”æ±‡ç¼–æŒ‡ä»¤&#x2F;ä¼ªä»£ç </th>
<th align="center">æ“ä½œè§£è¯»</th>
</tr>
</thead>
<tbody><tr>
<td align="center">0x10</td>
<td align="center">0x10,op1</td>
<td align="center">mov r1,mem[op1]</td>
<td align="center">r1&#x3D;mem[op1]</td>
</tr>
<tr>
<td align="center">0x11</td>
<td align="center">0x11,op1</td>
<td align="center">mov r2,mem[op1]</td>
<td align="center">r2&#x3D;mem[op1]</td>
</tr>
<tr>
<td align="center">0x20</td>
<td align="center">0x20</td>
<td align="center">add r1,r2</td>
<td align="center">r1+&#x3D;r2</td>
</tr>
<tr>
<td align="center">0x30</td>
<td align="center">0x30,op1,op2</td>
<td align="center">scanf-&gt;mem[op1],mem[op2]</td>
<td align="center">è¾“å…¥ç»™mem[op1]ï¼Œmem[op2]</td>
</tr>
<tr>
<td align="center">0x40</td>
<td align="center">0x40</td>
<td align="center">printf r1</td>
<td align="center">è¾“å‡ºr1çš„å€¼</td>
</tr>
<tr>
<td align="center">0x50</td>
<td align="center">0x50</td>
<td align="center">ret</td>
<td align="center">return 1</td>
</tr>
</tbody></table>
<h3 id="ç¼–å†™è§£é‡Šå™¨"><a href="#ç¼–å†™è§£é‡Šå™¨" class="headerlink" title="ç¼–å†™è§£é‡Šå™¨"></a>ç¼–å†™è§£é‡Šå™¨</h3><figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">vm_run</span><span class="hljs-params">(VM* vm)</span> &#123;<br>    <span class="hljs-type">char</span> opcode;<span class="hljs-comment">//ç”¨æ¥å­˜æ”¾æŒ‡ä»¤</span><br>    <span class="hljs-type">char</span> op1, op2;<span class="hljs-comment">//ç”¨æ¥å­˜æ”¾æ“ä½œæ•°</span><br><br>    <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>) &#123;<br>        opcode = vm-&gt;code[vm-&gt;eip];<span class="hljs-comment">//è¯»å–eipæŒ‡å‘çš„æŒ‡ä»¤</span><br><br>        <span class="hljs-keyword">switch</span> (opcode) &#123;<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">0x10</span>:<br>            op1 = vm-&gt;code[vm-&gt;eip + <span class="hljs-number">1</span>];<span class="hljs-comment">//è·å–æ“ä½œæ•°</span><br>            vm-&gt;r1 = vm-&gt;mem[op1];<span class="hljs-comment">//r1=mem[op1]</span><br>            vm-&gt;eip += <span class="hljs-number">2</span>;<span class="hljs-comment">//è·³è½¬åˆ°ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼ˆæŒ‡ä»¤+æ“ä½œæ•°å 2ä¸ªç´¢å¼•ä½ï¼‰</span><br>            <span class="hljs-keyword">break</span>;<br><br>        <span class="hljs-keyword">case</span> <span class="hljs-number">0x11</span>:<br>            op1 = vm-&gt;code[vm-&gt;eip + <span class="hljs-number">1</span>];<span class="hljs-comment">//è·å–æ“ä½œæ•°</span><br>            vm-&gt;r2 = vm-&gt;mem[op1];<span class="hljs-comment">//r2=mem[op1]</span><br>            vm-&gt;eip += <span class="hljs-number">2</span>;<span class="hljs-comment">//è·³è½¬åˆ°ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼ˆæŒ‡ä»¤+æ“ä½œæ•°å 2ä¸ªç´¢å¼•ä½ï¼‰</span><br>            <span class="hljs-keyword">break</span>;<br><br>        <span class="hljs-keyword">case</span> <span class="hljs-number">0x20</span>:<br>            vm-&gt;r1 += vm-&gt;r2;<span class="hljs-comment">//r1+=r2</span><br>            vm-&gt;eip += <span class="hljs-number">1</span>;<span class="hljs-comment">//è·³è½¬åˆ°ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼ˆåªæœ‰æŒ‡ä»¤ï¼Œå 1ä¸ªç´¢å¼•ä½ï¼‰</span><br>            <span class="hljs-keyword">break</span>;<br><br>        <span class="hljs-keyword">case</span> <span class="hljs-number">0x30</span>:<br>            op1 = vm-&gt;code[vm-&gt;eip + <span class="hljs-number">1</span>];<span class="hljs-comment">//è·å–æ“ä½œæ•°1</span><br>            op2 = vm-&gt;code[vm-&gt;eip + <span class="hljs-number">2</span>];<span class="hljs-comment">//è·å–æ“ä½œæ•°2</span><br>            <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d %d&quot;</span>, &amp;vm-&gt;mem[op1], &amp;vm-&gt;mem[op2]);<span class="hljs-comment">//è¾“å…¥ç»™mem[op1]ï¼Œmem[op2]</span><br>            vm-&gt;eip += <span class="hljs-number">3</span>;<span class="hljs-comment">//è·³è½¬åˆ°ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼ˆæŒ‡ä»¤+æ“ä½œæ•°å 3ä¸ªç´¢å¼•ä½ï¼‰</span><br>            <span class="hljs-keyword">break</span>;<br><br>        <span class="hljs-keyword">case</span> <span class="hljs-number">0x40</span>:<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d&quot;</span>, vm-&gt;r1);<span class="hljs-comment">//è¾“å‡ºr1çš„å€¼</span><br>            vm-&gt;eip += <span class="hljs-number">1</span>;<span class="hljs-comment">//è·³è½¬åˆ°ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼ˆåªæœ‰æŒ‡ä»¤ï¼Œå 1ä¸ªç´¢å¼•ä½ï¼‰</span><br>            <span class="hljs-keyword">break</span>;<br><br>        <span class="hljs-keyword">case</span> <span class="hljs-number">0x50</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<span class="hljs-comment">//å¾ªç¯ç»ˆæ­¢ï¼Œå‡½æ•°è¿”å›ï¼Œè™šæ‹Ÿæœºå…³æœº</span><br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="æŒ‡ä»¤æ•°ç»„"><a href="#æŒ‡ä»¤æ•°ç»„" class="headerlink" title="æŒ‡ä»¤æ•°ç»„"></a>æŒ‡ä»¤æ•°ç»„</h3><figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> code[]=&#123;<br>	<span class="hljs-number">0x30</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x1</span>,<span class="hljs-comment">//è¾“å…¥ç»™mem[0]ï¼Œmem[1]</span><br>    <span class="hljs-number">0x10</span>,<span class="hljs-number">0x0</span>,<span class="hljs-comment">//r1=mem[0]</span><br>    <span class="hljs-number">0x11</span>,<span class="hljs-number">0x1</span>,<span class="hljs-comment">//r2=mem[1]</span><br>    <span class="hljs-number">0x20</span>,<span class="hljs-comment">//r1+=r2</span><br>    <span class="hljs-number">0x40</span>,<span class="hljs-comment">//è¾“å‡ºr1çš„å€¼</span><br>    <span class="hljs-number">0x50</span><span class="hljs-comment">//è™šæ‹Ÿæœºå…³æœº</span><br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="å®Œæ•´ç¨‹åº"><a href="#å®Œæ•´ç¨‹åº" class="headerlink" title="å®Œæ•´ç¨‹åº"></a>å®Œæ•´ç¨‹åº</h3><figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;windows.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><br><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span>&#123;</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> r1;<span class="hljs-comment">//å¯„å­˜å™¨r1</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> r2;<span class="hljs-comment">//å¯„å­˜å™¨r2</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> eip;<span class="hljs-comment">//å¯„å­˜å™¨eip</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> mem[<span class="hljs-number">256</span>];<span class="hljs-comment">//è™šæ‹Ÿå†…å­˜æ•°ç»„</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> code[<span class="hljs-number">1024</span>];<span class="hljs-comment">//æŒ‡ä»¤æ•°ç»„</span><br>&#125; VM;<br><br><span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> code[]=&#123;<br>	<span class="hljs-number">0x30</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x1</span>,<span class="hljs-comment">//è¾“å…¥ç»™mem[0]ï¼Œmem[1]</span><br>    <span class="hljs-number">0x10</span>,<span class="hljs-number">0x0</span>,<span class="hljs-comment">//r1=mem[0]</span><br>    <span class="hljs-number">0x11</span>,<span class="hljs-number">0x1</span>,<span class="hljs-comment">//r2=mem[1]</span><br>    <span class="hljs-number">0x20</span>,<span class="hljs-comment">//r1+=r2</span><br>    <span class="hljs-number">0x40</span>,<span class="hljs-comment">//è¾“å‡ºr1çš„å€¼</span><br>    <span class="hljs-number">0x50</span><span class="hljs-comment">//è™šæ‹Ÿæœºå…³æœº</span><br>&#125;;<br><br>VM* <span class="hljs-title function_">vm_new</span><span class="hljs-params">()</span> &#123;<br>    VM* vm = (VM*)<span class="hljs-built_in">malloc</span>(<span class="hljs-keyword">sizeof</span>(VM));<span class="hljs-comment">//ä¸ºè™šæ‹Ÿç¡¬ä»¶ç»“æ„ä½“ç”³è¯·ç©ºé—´</span><br>    <span class="hljs-built_in">memset</span>(vm, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(VM));<span class="hljs-comment">//åˆå§‹åŒ–ç»“æ„ä½“</span><br>    <span class="hljs-built_in">memcpy</span>(vm-&gt;code, code, <span class="hljs-keyword">sizeof</span>(code));<span class="hljs-comment">//åˆå§‹åŒ–code</span><br>    <span class="hljs-keyword">return</span> vm;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">vm_run</span><span class="hljs-params">(VM* vm)</span> &#123;<br>    <span class="hljs-type">char</span> opcode;<span class="hljs-comment">//ç”¨æ¥å­˜æ”¾æŒ‡ä»¤</span><br>    <span class="hljs-type">char</span> op1, op2;<span class="hljs-comment">//ç”¨æ¥å­˜æ”¾æ“ä½œæ•°</span><br><br>    <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>) &#123;<br>        opcode = vm-&gt;code[vm-&gt;eip];<span class="hljs-comment">//è¯»å–eipæŒ‡å‘çš„æŒ‡ä»¤</span><br><br>        <span class="hljs-keyword">switch</span> (opcode) &#123;<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">0x10</span>:<br>            op1 = vm-&gt;code[vm-&gt;eip + <span class="hljs-number">1</span>];<span class="hljs-comment">//è·å–æ“ä½œæ•°</span><br>            vm-&gt;r1 = vm-&gt;mem[op1];<span class="hljs-comment">//r1=mem[op1]</span><br>            vm-&gt;eip += <span class="hljs-number">2</span>;<span class="hljs-comment">//è·³è½¬åˆ°ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼ˆæŒ‡ä»¤+æ“ä½œæ•°å 2ä¸ªç´¢å¼•ä½ï¼‰</span><br>            <span class="hljs-keyword">break</span>;<br><br>        <span class="hljs-keyword">case</span> <span class="hljs-number">0x11</span>:<br>            op1 = vm-&gt;code[vm-&gt;eip + <span class="hljs-number">1</span>];<span class="hljs-comment">//è·å–æ“ä½œæ•°</span><br>            vm-&gt;r2 = vm-&gt;mem[op1];<span class="hljs-comment">//r2=mem[op1]</span><br>            vm-&gt;eip += <span class="hljs-number">2</span>;<span class="hljs-comment">//è·³è½¬åˆ°ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼ˆæŒ‡ä»¤+æ“ä½œæ•°å 2ä¸ªç´¢å¼•ä½ï¼‰</span><br>            <span class="hljs-keyword">break</span>;<br><br>        <span class="hljs-keyword">case</span> <span class="hljs-number">0x20</span>:<br>            vm-&gt;r1 += vm-&gt;r2;<span class="hljs-comment">//r1+=r2</span><br>            vm-&gt;eip += <span class="hljs-number">1</span>;<span class="hljs-comment">//è·³è½¬åˆ°ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼ˆåªæœ‰æŒ‡ä»¤ï¼Œå 1ä¸ªç´¢å¼•ä½ï¼‰</span><br>            <span class="hljs-keyword">break</span>;<br><br>        <span class="hljs-keyword">case</span> <span class="hljs-number">0x30</span>:<br>            op1 = vm-&gt;code[vm-&gt;eip + <span class="hljs-number">1</span>];<span class="hljs-comment">//è·å–æ“ä½œæ•°1</span><br>            op2 = vm-&gt;code[vm-&gt;eip + <span class="hljs-number">2</span>];<span class="hljs-comment">//è·å–æ“ä½œæ•°2</span><br>            <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d %d&quot;</span>, &amp;vm-&gt;mem[op1], &amp;vm-&gt;mem[op2]);<span class="hljs-comment">//è¾“å…¥ç»™mem[op1]ï¼Œmem[op2]</span><br>            vm-&gt;eip += <span class="hljs-number">3</span>;<span class="hljs-comment">//è·³è½¬åˆ°ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼ˆæŒ‡ä»¤+æ“ä½œæ•°å 3ä¸ªç´¢å¼•ä½ï¼‰</span><br>            <span class="hljs-keyword">break</span>;<br><br>        <span class="hljs-keyword">case</span> <span class="hljs-number">0x40</span>:<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d&quot;</span>, vm-&gt;r1);<span class="hljs-comment">//è¾“å‡ºr1çš„å€¼</span><br>            vm-&gt;eip += <span class="hljs-number">1</span>;<span class="hljs-comment">//è·³è½¬åˆ°ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼ˆåªæœ‰æŒ‡ä»¤ï¼Œå 1ä¸ªç´¢å¼•ä½ï¼‰</span><br>            <span class="hljs-keyword">break</span>;<br><br>        <span class="hljs-keyword">case</span> <span class="hljs-number">0x50</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<span class="hljs-comment">//å¾ªç¯ç»ˆæ­¢ï¼Œå‡½æ•°è¿”å›ï¼Œè™šæ‹Ÿæœºå…³æœº</span><br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    VM* vm = vm_new();<span class="hljs-comment">//ç”Ÿæˆä¸€ä¸ªè™šæ‹Ÿæœº</span><br>    <span class="hljs-keyword">if</span> (vm_run(vm))<span class="hljs-comment">//è¿è¡Œè™šæ‹Ÿæœº</span><br>        system(<span class="hljs-string">&quot;pause&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="ç®€å•ç¤ºä¾‹çš„é€†å‘"><a href="#ç®€å•ç¤ºä¾‹çš„é€†å‘" class="headerlink" title="ç®€å•ç¤ºä¾‹çš„é€†å‘"></a>ç®€å•ç¤ºä¾‹çš„é€†å‘</h2><ul>
<li><p>VMé¢˜æœ€æ˜¾è‘—çš„ç‰¹å¾åº”è¯¥å°±æ˜¯è™šæ‹Ÿç¡¬ä»¶ç»“æ„ä½“çš„åˆå§‹åŒ–å’Œè§£é‡Šå™¨äº†ã€‚è§£å†³è¿™ç±»é—®é¢˜ï¼Œéœ€è¦å…ˆå¤åˆ»å‡ºä¸€ä¸ªè§£é‡Šå™¨ï¼Œé€šè¿‡åœ¨è§£é‡Šå™¨ä¸­å¢åŠ æ‰“å°åˆ†æå‡ºçš„ä»£ç çš„æ“ä½œï¼Œæ¥å¾—åˆ°å»è™šæ‹ŸåŒ–çš„åŸç¨‹åºï¼Œè¿›è€Œå¯ä»¥æ­£å¸¸é€†å‘åˆ†æ</p>
</li>
<li><p>å…ˆæ¥çœ‹mainå‡½æ•°ï¼š</p>
<p><img src="/../images/image-20250806232124465.png" alt="mainå‡½æ•°"></p>
<p>ä¸‹é¢ä¸‰ä¸ªå¸¦å­—ç¬¦ä¸²çš„å‡½æ•°å¯ä»¥çœ‹å‡ºæ˜¯printfå’Œsystem</p>
</li>
<li><p>çœ‹çœ‹v1&#x3D;åé¢çš„å‡½æ•°</p>
<p><img src="/../images/image-20250806232516529.png" alt="v1&#x3D;åé¢çš„å‡½æ•°"></p>
<p>ç›®å‰æ²¡ä»€ä¹ˆæ˜æ˜¾çš„VMç‰¹å¾</p>
</li>
<li><p>å†çœ‹çœ‹ifæ‹¬å·é‡Œçš„å‡½æ•°</p>
<p><img src="/../images/image-20250806232613438.png" alt="ifæ‹¬å·é‡Œçš„å‡½æ•°"></p>
<p>çœ‹åˆ°å‡ºç°switchäº†ï¼Œå¼€å§‹æ¨æµ‹æ˜¯VMçš„è§£é‡Šå™¨</p>
<p>å›åˆ°ä¸Šä¸€ä¸ªå‡½æ•°ï¼Œå‘ç°ç¡®å®å’ŒVMçš„åˆå§‹åŒ–å‡½æ•°å¾ˆåƒï¼Œæœ€åé¢ä¸€ä¸ªå‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°å¯¹åº”å‡ºæ¥çš„æ˜¯ä¸€å †æ•°å­—ï¼Œå’Œåˆå§‹åŒ–codeå¯¹åº”ä¸Šäº†</p>
<p><img src="/../images/image-20250806232947764.png" alt="ä¸€å †æ•°å­—"></p>
</li>
<li><p>OKï¼Œé‚£å°±å¯¹ä¼ªä»£ç è¿›è¡Œä¸€ç‚¹ç‚¹ä¼˜åŒ–ï¼Œç„¶åå¼€å§‹åˆ†æè§£é‡Šå™¨</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-comment">//æ¨æµ‹è™šæ‹Ÿç¡¬ä»¶ç»“æ„ä½“</span><br>__int64 __fastcall <span class="hljs-title function_">vm_run</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> *vm)</span><br>&#123;<br>  sub_140001940(&amp;unk_1401150A2);<br>  <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>  &#123;<br>    <span class="hljs-keyword">switch</span> ( *((_BYTE *)vm + vm[<span class="hljs-number">2</span>] + <span class="hljs-number">268</span>) )<span class="hljs-comment">//vm+268æ˜¯codeæ‰€åœ¨ï¼Œç»“åˆä¸‹æ–‡åˆ†æï¼ŒåŠ ä¸Švm[2]å°±æ„æˆäº†code[eip]</span><br>    &#123;<br>      <span class="hljs-keyword">case</span> <span class="hljs-number">0x10</span>:<br>        *vm = *((<span class="hljs-type">char</span> *)vm + vm[<span class="hljs-number">2</span>] + <span class="hljs-number">269</span>);<span class="hljs-comment">//*vm=code[eip+1]ï¼Œvmåº”è¯¥æ˜¯ä¸€ä¸ªå¯„å­˜å™¨ï¼Œè¿™å¥æ˜¯mov r1,op1</span><br>        vm[<span class="hljs-number">2</span>] += <span class="hljs-number">2</span>;<span class="hljs-comment">//æ¯ä¸ªcaseéƒ½æœ‰ï¼Œæ¨æµ‹æ˜¯eipã€‚+=2ï¼Œè¯´æ˜æœ‰ä¸€ä¸ªæ“ä½œæ•°                            </span><br>        <span class="hljs-keyword">break</span>;<br>      <span class="hljs-keyword">case</span> <span class="hljs-number">0x11</span>:<br>        vm[<span class="hljs-number">1</span>] = *((<span class="hljs-type">char</span> *)vm + vm[<span class="hljs-number">2</span>] + <span class="hljs-number">269</span>);<span class="hljs-comment">//vm[1]=code[eip+1]ï¼Œvm[1]åº”è¯¥ä¹Ÿæ˜¯ä¸€ä¸ªå¯„å­˜å™¨,è¿™å¥æ˜¯mov r2,op1</span><br>        vm[<span class="hljs-number">2</span>] += <span class="hljs-number">2</span>;<span class="hljs-comment">//æœ‰ä¸€ä¸ªæ“ä½œæ•°</span><br>        <span class="hljs-keyword">break</span>;<br>      <span class="hljs-keyword">case</span> <span class="hljs-number">0x20</span>:<br>        *((_BYTE *)vm + *((<span class="hljs-type">char</span> *)vm + vm[<span class="hljs-number">2</span>] + <span class="hljs-number">269</span>) + <span class="hljs-number">12</span>) = *((_BYTE *)vm + vm[<span class="hljs-number">2</span>] + <span class="hljs-number">270</span>);<br>            <span class="hljs-comment">//*((char *)vm + vm[2] + 269)æ˜¯code[eip+1]ï¼Œå³op1ï¼Œæ‰€ä»¥å·¦è¾¹æ˜¯vm+12+op1ï¼Œæ¨æµ‹vm+12æ˜¯è™šæ‹Ÿå†…å­˜ï¼Œåˆšå¥½è·¨è¿‡ä¸‰ä¸ªè¿ç»­çš„intå‹å¯„å­˜å™¨</span><br>            <span class="hljs-comment">//å³è¾¹å³vm+vm[2]+268+2å³code[eip+2]ï¼Œå³op2</span><br>        vm[<span class="hljs-number">2</span>] += <span class="hljs-number">3</span>;<span class="hljs-comment">//æœ‰ä¸¤ä¸ªæ“ä½œæ•°</span><br>        <span class="hljs-keyword">break</span>;<br>      <span class="hljs-keyword">case</span> <span class="hljs-number">0x30</span>:<br>        *((_BYTE *)vm + *vm + <span class="hljs-number">12</span>) ^= *((_BYTE *)vm + <span class="hljs-number">4</span>);<span class="hljs-comment">//mem[r1]^=r2</span><br>        ++vm[<span class="hljs-number">2</span>];<span class="hljs-comment">//æ— æ“ä½œæ•°</span><br>        <span class="hljs-keyword">break</span>;<br>      <span class="hljs-keyword">case</span> <span class="hljs-number">0x40</span>:<br>        sub_140001610(&amp;unk_1400D74B0, vm + <span class="hljs-number">3</span>);<span class="hljs-comment">//unkè¿™ä¸ªæ˜¯%5sï¼Œæ‰€ä»¥è¿™æ˜¯scanfã€‚è¿™é‡Œçš„vmæ˜¯intï¼ŒåŠ ä¸‰è·³è¿‡äº†å•ä¸ªå¯„å­˜å™¨ï¼Œæ˜¯mem[0]</span><br>        ++vm[<span class="hljs-number">2</span>];<span class="hljs-comment">//æ— æ“ä½œæ•°</span><br>        <span class="hljs-keyword">break</span>;<br>      <span class="hljs-keyword">case</span> <span class="hljs-number">0x50</span>:<br>        <span class="hljs-keyword">return</span> sub_1400D4430(vm + <span class="hljs-number">3</span>, (<span class="hljs-type">char</span> *)vm + *((<span class="hljs-type">char</span> *)vm + vm[<span class="hljs-number">2</span>] + <span class="hljs-number">269</span>) + <span class="hljs-number">12</span>, *((<span class="hljs-type">char</span> *)vm + vm[<span class="hljs-number">2</span>] + <span class="hljs-number">270</span>));<br>            <span class="hljs-comment">//ä¸‰ä¸ªå‚æ•°åˆ†åˆ«ä¸ºmem[0],mem[op1],op2ï¼Œæ¨æµ‹æ˜¯memcmpï¼ˆæ€ä¹ˆæ²¡æš—ç¤ºæ“ä½œæ•°ä¸ªæ•°</span><br>      <span class="hljs-keyword">default</span>:<br>        <span class="hljs-keyword">continue</span>;<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>æ¨æµ‹è™šæ‹Ÿç¡¬ä»¶ç»“æ„ä½“å¦‚ä¸‹ï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span>&#123;</span><br>   	<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> r1;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> r2;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> eip;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> mem[<span class="hljs-number">268</span><span class="hljs-number">-3</span>*<span class="hljs-number">4</span>=<span class="hljs-number">256</span>];<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> code[<span class="hljs-number">36</span>];<br>&#125; VM;<br></code></pre></td></tr></table></figure>
</li>
<li><p>å¸¦è¾“å‡ºåˆ†æå‡ºæ¥çš„ä»£ç çš„è§£é‡Šå™¨å¦‚ä¸‹ï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs C"><span class="hljs-type">int</span> <span class="hljs-title function_">vm_run</span><span class="hljs-params">(VM* vm)</span> &#123;<br>    <span class="hljs-type">char</span> opcode;<br>    <span class="hljs-type">char</span> op1, op2;<br>    <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>) &#123;<br>        opcode = vm-&gt;code[vm-&gt;eip];<br><br>        <span class="hljs-keyword">switch</span> (opcode) &#123;<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">0x10</span>:<br>            vm-&gt;r1 = code[vm-&gt;eip + <span class="hljs-number">1</span>];<br>            vm-&gt;eip += <span class="hljs-number">2</span>;<br>            <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;mov r1,&quot;</span> &lt;&lt; vm-&gt;r1 &lt;&lt; <span class="hljs-built_in">endl</span>;<br>            <span class="hljs-keyword">break</span>;<br><br>        <span class="hljs-keyword">case</span> <span class="hljs-number">0x11</span>:<br>            vm-&gt;r2 = code[vm-&gt;eip + <span class="hljs-number">1</span>];<br>            vm-&gt;eip += <span class="hljs-number">2</span>;<br>            <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;mov r2,&quot;</span> &lt;&lt; vm-&gt;r2 &lt;&lt; <span class="hljs-built_in">endl</span>;<br>            <span class="hljs-keyword">break</span>;<br><br>        <span class="hljs-keyword">case</span> <span class="hljs-number">0x20</span>:<br>            op1 = code[vm-&gt;eip + <span class="hljs-number">1</span>];<br>            op2 = code[vm-&gt;eip + <span class="hljs-number">2</span>];<br>            vm-&gt;mem[op1] = op2;<br>            vm-&gt;eip += <span class="hljs-number">3</span>;<br>            <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;mov mem[&quot;</span> &lt;&lt; (<span class="hljs-type">int</span>)op1 &lt;&lt; <span class="hljs-string">&quot;],&quot;</span> &lt;&lt; op2 &lt;&lt; <span class="hljs-built_in">endl</span>;<br>            <span class="hljs-keyword">break</span>;<br><br>        <span class="hljs-keyword">case</span> <span class="hljs-number">0x30</span>:<br>            vm-&gt;mem[vm-&gt;r1] ^= vm-&gt;r2;<br>            ++vm-&gt;eip;<br>            <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;xor mem[&quot;</span> &lt;&lt; vm-&gt;r1 &lt;&lt; <span class="hljs-string">&quot;],&quot;</span> &lt;&lt; vm-&gt;r2 &lt;&lt; <span class="hljs-built_in">endl</span>;<br>            <span class="hljs-keyword">break</span>;<br><br>        <span class="hljs-keyword">case</span> <span class="hljs-number">0x40</span>:<br>            <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%5s&quot;</span>, &amp;vm-&gt;mem[<span class="hljs-number">0</span>]);<br>            ++vm-&gt;eip;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;scanf mem\n&quot;</span>);<br>            <span class="hljs-keyword">break</span>;<br><br>        <span class="hljs-keyword">case</span> <span class="hljs-number">0x50</span>:<br>            op1 = code[vm-&gt;eip + <span class="hljs-number">1</span>];<br>            op2 = code[vm-&gt;eip + <span class="hljs-number">2</span>];<br>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">memcmp</span>(&amp;vm-&gt;mem[<span class="hljs-number">0</span>], &amp;vm-&gt;mem[op1], op2);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>å®Œæ•´çš„è„šæœ¬ï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;windows.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;iostream&gt;</span></span><br>using namespace <span class="hljs-built_in">std</span>;<br><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> &#123;</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> r1;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> r2;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> eip;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> mem[<span class="hljs-number">256</span>];<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> code[<span class="hljs-number">36</span>];<br>&#125; VM ;<br><br><span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> code[] = &#123;<br>    <span class="hljs-number">0x20</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0x40</span>,<br>    <span class="hljs-number">0x11</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x04</span>,<br>    <span class="hljs-number">0x30</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x05</span><br>&#125;;<br><br>VM* <span class="hljs-title function_">vm_new</span><span class="hljs-params">()</span> &#123;<br>    VM* vm = (VM*)<span class="hljs-built_in">malloc</span>(<span class="hljs-keyword">sizeof</span>(VM));<br>    <span class="hljs-built_in">memset</span>(vm, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(VM));<br>    <span class="hljs-built_in">memcpy</span>(vm-&gt;code, code, <span class="hljs-keyword">sizeof</span>(code));<br>    <span class="hljs-keyword">return</span> vm;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">vm_run</span><span class="hljs-params">(VM* vm)</span> &#123;<br>    <span class="hljs-type">char</span> opcode;<br>    <span class="hljs-type">char</span> op1, op2;<br>    <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>) &#123;<br>        opcode = vm-&gt;code[vm-&gt;eip];<br><br>        <span class="hljs-keyword">switch</span> (opcode) &#123;<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">0x10</span>:<br>            vm-&gt;r1 = code[vm-&gt;eip + <span class="hljs-number">1</span>];<br>            vm-&gt;eip += <span class="hljs-number">2</span>;<br>            <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;mov r1,&quot;</span> &lt;&lt; vm-&gt;r1 &lt;&lt; <span class="hljs-built_in">endl</span>;<br>            <span class="hljs-keyword">break</span>;<br><br>        <span class="hljs-keyword">case</span> <span class="hljs-number">0x11</span>:<br>            vm-&gt;r2 = code[vm-&gt;eip + <span class="hljs-number">1</span>];<br>            vm-&gt;eip += <span class="hljs-number">2</span>;<br>            <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;mov r2,&quot;</span> &lt;&lt; vm-&gt;r2 &lt;&lt; <span class="hljs-built_in">endl</span>;<br>            <span class="hljs-keyword">break</span>;<br><br>        <span class="hljs-keyword">case</span> <span class="hljs-number">0x20</span>:<br>            op1 = code[vm-&gt;eip + <span class="hljs-number">1</span>];<br>            op2 = code[vm-&gt;eip + <span class="hljs-number">2</span>];<br>            vm-&gt;mem[op1] = op2;<br>            vm-&gt;eip += <span class="hljs-number">3</span>;<br>            <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;mov mem[&quot;</span> &lt;&lt; (<span class="hljs-type">int</span>)op1 &lt;&lt; <span class="hljs-string">&quot;],&quot;</span> &lt;&lt; op2 &lt;&lt; <span class="hljs-built_in">endl</span>;<br>            <span class="hljs-keyword">break</span>;<br><br>        <span class="hljs-keyword">case</span> <span class="hljs-number">0x30</span>:<br>            vm-&gt;mem[vm-&gt;r1] ^= vm-&gt;r2;<br>            ++vm-&gt;eip;<br>            <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;xor mem[&quot;</span> &lt;&lt; vm-&gt;r1 &lt;&lt; <span class="hljs-string">&quot;],&quot;</span> &lt;&lt; vm-&gt;r2 &lt;&lt; <span class="hljs-built_in">endl</span>;<br>            <span class="hljs-keyword">break</span>;<br><br>        <span class="hljs-keyword">case</span> <span class="hljs-number">0x40</span>:<br>            <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%5s&quot;</span>, &amp;vm-&gt;mem[<span class="hljs-number">0</span>]);<br>            ++vm-&gt;eip;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;scanf mem\n&quot;</span>);<br>            <span class="hljs-keyword">break</span>;<br><br>        <span class="hljs-keyword">case</span> <span class="hljs-number">0x50</span>:<br>            op1 = code[vm-&gt;eip + <span class="hljs-number">1</span>];<br>            op2 = code[vm-&gt;eip + <span class="hljs-number">2</span>];<br>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">memcmp</span>(&amp;vm-&gt;mem[<span class="hljs-number">0</span>], &amp;vm-&gt;mem[op1], op2);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    VM* vm = vm_new();<br>    <span class="hljs-keyword">if</span> (vm_run(vm))<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;failed\n&quot;</span>);<br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;good\n&quot;</span>);<br>    <br>    system(<span class="hljs-string">&quot;pause&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>è¿™æ ·æˆ‘ä»¬å¾—åˆ°äº†åŸç¨‹åºçš„æ±‡ç¼–ä»£ç ï¼ˆå‚æ‚ç€å¥‡æ€ªçš„ä»£ç ï¼‰</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm"><span class="hljs-keyword">mov</span> mem[<span class="hljs-number">16</span>],H<br><span class="hljs-keyword">mov</span> mem[<span class="hljs-number">17</span>],e<br><span class="hljs-keyword">mov</span> mem[<span class="hljs-number">18</span>],l<br><span class="hljs-keyword">mov</span> mem[<span class="hljs-number">19</span>],l<br><span class="hljs-keyword">mov</span> mem[<span class="hljs-number">20</span>],o<br><span class="hljs-number">12345</span><br>scanf mem<br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">r2</span>,<span class="hljs-number">33</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">r1</span>,<span class="hljs-number">0</span><br><span class="hljs-keyword">xor</span> mem[<span class="hljs-number">0</span>],<span class="hljs-number">33</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">r1</span>,<span class="hljs-number">1</span><br><span class="hljs-keyword">xor</span> mem[<span class="hljs-number">1</span>],<span class="hljs-number">33</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">r1</span>,<span class="hljs-number">2</span><br><span class="hljs-keyword">xor</span> mem[<span class="hljs-number">2</span>],<span class="hljs-number">33</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">r1</span>,<span class="hljs-number">3</span><br><span class="hljs-keyword">xor</span> mem[<span class="hljs-number">3</span>],<span class="hljs-number">33</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">r1</span>,<span class="hljs-number">4</span><br><span class="hljs-keyword">xor</span> mem[<span class="hljs-number">4</span>],<span class="hljs-number">33</span><br>failed<br></code></pre></td></tr></table></figure>
</li>
<li><p>å¯ä»¥çœ‹åˆ°ï¼Œç¨‹åºå…ˆæŠŠâ€Helloâ€ä¼ ç»™äº†memçš„ä¸€ç‰‡åŒºåŸŸï¼Œç„¶åè·å–è¾“å…¥ï¼ŒæŠŠè¾“å…¥çš„æ•°ä¸33å¼‚æˆ–ï¼Œæœ€åæ‰§è¡Œè¿”å›å¤„çš„åˆ¤æ–­ã€‚è¿”å›å¤„æ˜¯å¯¹æ¯”mem[0]å’Œmem[op1]ï¼Œå¯¹æ¯”op2ä½ï¼Œç»“åˆcodeæœ€åå‡ ä½ï¼ŒçŸ¥é“æ˜¯å¯¹æ¯”mem[0]å’Œmem[16]ï¼Œå¯¹æ¯”5ä½ã€‚æ‰€ä»¥è¦æ±‚çš„è¾“å…¥æ˜¯â€Helloâ€é€ä½å¼‚æˆ–çš„ç»“æœï¼ˆä¸å¯è§å­—ç¬¦ï¼Œå°è¯•è¾“å…¥å¤±è´¥ï¼‰</p>
</li>
</ul>
]]></content>
      <categories>
        <category>Reverseå­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>Reverse</tag>
      </tags>
  </entry>
  <entry>
    <title>0xGame2025Week4WriteUp</title>
    <url>/2025/11/16/0xGame2025Week4ReverseWriteUp/</url>
    <content><![CDATA[<p>0xGame2025 Week4 Reverseæ–¹å‘å…¨è§£&amp;è¯¦è§£</p>
<span id="more"></span>

<h2 id="é•œæ¸ŠæŠ˜æ"><a href="#é•œæ¸ŠæŠ˜æ" class="headerlink" title="é•œæ¸ŠæŠ˜æ"></a>é•œæ¸ŠæŠ˜æ</h2><blockquote>
<p>è€ƒç‚¹ï¼šnativeå±‚é€†å‘ï¼ŒAES</p>
</blockquote>
<ul>
<li><p>é™„ä»¶apkè¿è¡Œèµ·æ¥æ˜¯è¿™æ ·ï¼š</p>
<p><img src="/../images/image-20251029221337039.png" alt="è¿è¡Œé™„ä»¶apk"></p>
</li>
<li><p>JEBæ‰“å¼€ï¼Œå¯ä»¥å¾—åˆ°ä¸‹é¢è¿™äº›MainActivityå’Œç›¸å…³å‡½æ•°çš„å†…å®¹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.example.easynative;<br><br><span class="hljs-keyword">import</span> android.content.Context;<br><span class="hljs-keyword">import</span> android.os.Bundle;<br><span class="hljs-keyword">import</span> android.view.View;<br><span class="hljs-keyword">import</span> android.widget.Button;<br><span class="hljs-keyword">import</span> android.widget.EditText;<br><span class="hljs-keyword">import</span> android.widget.Toast;<br><span class="hljs-keyword">import</span> androidx.activity.ComponentActivity;<br><span class="hljs-keyword">import</span> java.io.InputStream;<br><span class="hljs-keyword">import</span> kotlin.Metadata;<br><span class="hljs-keyword">import</span> kotlin.io.ByteStreamsKt;<br><span class="hljs-keyword">import</span> kotlin.jvm.internal.Intrinsics;<br><br><span class="hljs-meta">@Metadata(d1 = &#123;&quot;\u0000\u0018\n\u0002\u0018\u0002\n\u0002\u0018\u0002\n\u0002\b\u0002\n\u0002\u0010\u0002\n\u0000\n\u0002\u0018\u0002\n\u0000\b\u0007\u0018\u00002\u00020\u0001B\u0005Â¢\u0006\u0002\u0010\u0002J\u0012\u0010\u0003\u001A\u00020\u00042\b\u0010\u0005\u001A\u0004\u0018\u00010\u0006H\u0014Â¨\u0006\u0007&quot;&#125;, d2 = &#123;&quot;Lcom/example/easynative/MainActivity;&quot;, &quot;Landroidx/activity/ComponentActivity;&quot;, &quot;()V&quot;, &quot;onCreate&quot;, &quot;&quot;, &quot;savedInstanceState&quot;, &quot;Landroid/os/Bundle;&quot;, &quot;app_release&quot;&#125;, k = 1, mv = &#123;1, 9, 0&#125;, xi = 0x30)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ComponentActivity</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> $stable;<br><br>    <span class="hljs-keyword">static</span> &#123;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span>  <span class="hljs-comment">// androidx.activity.ComponentActivity</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(Bundle arg3)</span> &#123;<br>        <span class="hljs-built_in">super</span>.onCreate(arg3);<br>        <span class="hljs-built_in">this</span>.setContentView(layout.activity_main);<br>        <span class="hljs-type">EditText</span> <span class="hljs-variable">v3</span> <span class="hljs-operator">=</span> (EditText)<span class="hljs-built_in">this</span>.findViewById(id.flagInput);<br>        ((Button)<span class="hljs-built_in">this</span>.findViewById(id.button)).setOnClickListener((View arg2) -&gt; MainActivity.onCreate$lambda$<span class="hljs-number">0</span>(v3, <span class="hljs-built_in">this</span>, arg2));<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> onCreate$lambda$<span class="hljs-number">0</span>(EditText arg2, MainActivity arg3, View arg4) &#123;<br>        Intrinsics.checkNotNullParameter(arg3, <span class="hljs-string">&quot;this$0&quot;</span>);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">v2</span> <span class="hljs-operator">=</span> arg2.getText().toString();<br>        <span class="hljs-type">InputStream</span> <span class="hljs-variable">v4</span> <span class="hljs-operator">=</span> arg3.getAssets().open(<span class="hljs-string">&quot;secret.bin&quot;</span>);<br>        Intrinsics.checkNotNullExpressionValue(v4, <span class="hljs-string">&quot;open(...)&quot;</span>);<br>        <span class="hljs-type">byte</span>[] v4_1 = ByteStreamsKt.readBytes(v4);<br>        <span class="hljs-keyword">if</span>(((CharSequence)v2).length() &gt; <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-type">Context</span> <span class="hljs-variable">v1</span> <span class="hljs-operator">=</span> (Context)arg3;<br>            <span class="hljs-keyword">if</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">FlagChecker</span>(v1, v2).check(v4_1)) &#123;  <span class="hljs-comment">// v4ä»secret.binä¸­è¢«è¯»å–å‡ºæ¥ï¼Œè¯»å–çš„å†…å®¹ç»™äº†v4_1ä½œä¸ºcheckçš„å‚æ•°ï¼Œè¾“å…¥çš„å†…å®¹ä½œä¸ºFlagCheckerçš„ç¬¬äºŒä¸ªå‚æ•°</span><br>                Toast.makeText(v1, ((CharSequence)arg3.getString(string.correct)), <span class="hljs-number">0</span>).show();<br>                <span class="hljs-keyword">return</span>;<br>            &#125;<br><br>            Toast.makeText(v1, ((CharSequence)arg3.getString(string.wrong)), <span class="hljs-number">0</span>).show();<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">package</span> com.example.easynative;<br><br><span class="hljs-keyword">import</span> android.content.Context;<br><span class="hljs-keyword">import</span> java.security.Key;<br><span class="hljs-keyword">import</span> java.security.spec.AlgorithmParameterSpec;<br><span class="hljs-keyword">import</span> javax.crypto.Cipher;<br><span class="hljs-keyword">import</span> javax.crypto.spec.IvParameterSpec;<br><span class="hljs-keyword">import</span> javax.crypto.spec.SecretKeySpec;<br><span class="hljs-keyword">import</span> kotlin.Metadata;<br><span class="hljs-keyword">import</span> kotlin.jvm.internal.DefaultConstructorMarker;<br><span class="hljs-keyword">import</span> kotlin.jvm.internal.Intrinsics;<br><span class="hljs-keyword">import</span> kotlin.text.Charsets;<br><br><span class="hljs-meta">@Metadata(d1 = &#123;&quot;\u0000.\n\u0002\u0018\u0002\n\u0002\u0010\u0000\n\u0000\n\u0002\u0018\u0002\n\u0000\n\u0002\u0010\u000E\n\u0002\b\u0002\n\u0002\u0010\u000B\n\u0000\n\u0002\u0010\u0012\n\u0002\b\u0002\n\u0002\u0010\b\n\u0002\b\u0005\b\u0007\u0018\u0000 \u00112\u00020\u0001:\u0001\u0011B\u0015\u0012\u0006\u0010\u0002\u001A\u00020\u0003\u0012\u0006\u0010\u0004\u001A\u00020\u0005Â¢\u0006\u0002\u0010\u0006J\u000E\u0010\u0007\u001A\u00020\b2\u0006\u0010\t\u001A\u00020\nJ\u0019\u0010\u000B\u001A\u00020\b2\u0006\u0010\f\u001A\u00020\r2\u0006\u0010\u000E\u001A\u00020\nH\u0086 J\u001E\u0010\u000F\u001A\u00020\n2\u0006\u0010\u0004\u001A\u00020\u00052\u0006\u0010\u0010\u001A\u00020\n2\u0006\u0010\t\u001A\u00020\nR\u000E\u0010\u0002\u001A\u00020\u0003X\u0082\u0004Â¢\u0006\u0002\n\u0000R\u000E\u0010\u0004\u001A\u00020\u0005X\u0082\u0004Â¢\u0006\u0002\n\u0000Â¨\u0006\u0012&quot;&#125;, d2 = &#123;&quot;Lcom/example/easynative/FlagChecker;&quot;, &quot;&quot;, &quot;context&quot;, &quot;Landroid/content/Context;&quot;, &quot;plainText&quot;, &quot;&quot;, &quot;(Landroid/content/Context;Ljava/lang/String;)V&quot;, &quot;check&quot;, &quot;&quot;, &quot;iv&quot;, &quot;&quot;, &quot;compare&quot;, &quot;length&quot;, &quot;&quot;, &quot;data&quot;, &quot;encrypt&quot;, &quot;key&quot;, &quot;Companion&quot;, &quot;app_release&quot;&#125;, k = 1, mv = &#123;1, 9, 0&#125;, xi = 0x30)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FlagChecker</span> &#123;<br>    <span class="hljs-meta">@Metadata(d1 = &#123;&quot;\u0000\f\n\u0002\u0018\u0002\n\u0002\u0010\u0000\n\u0002\b\u0002\b\u0086\u0003\u0018\u00002\u00020\u0001B\u0007\b\u0002Â¢\u0006\u0002\u0010\u0002Â¨\u0006\u0003&quot;&#125;, d2 = &#123;&quot;Lcom/example/easynative/FlagChecker$Companion;&quot;, &quot;&quot;, &quot;()V&quot;, &quot;app_release&quot;&#125;, k = 1, mv = &#123;1, 9, 0&#125;, xi = 0x30)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Companion</span> &#123;<br>        <span class="hljs-keyword">private</span> <span class="hljs-title function_">Companion</span><span class="hljs-params">()</span> &#123;<br>        &#125;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-title function_">Companion</span><span class="hljs-params">(DefaultConstructorMarker arg1)</span> &#123;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> $stable;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Companion Companion;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Context context;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String plainText;<br><br>    <span class="hljs-keyword">static</span> &#123;<br>        FlagChecker.Companion = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Companion</span>(<span class="hljs-literal">null</span>);<br>        FlagChecker.$stable = <span class="hljs-number">8</span>;<br>        System.loadLibrary(<span class="hljs-string">&quot;easynative&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">FlagChecker</span><span class="hljs-params">(Context arg2, String arg3)</span> &#123;<br>        Intrinsics.checkNotNullParameter(arg2, <span class="hljs-string">&quot;context&quot;</span>);<br>        Intrinsics.checkNotNullParameter(arg3, <span class="hljs-string">&quot;plainText&quot;</span>);<br>        <span class="hljs-built_in">super</span>();<br>        <span class="hljs-built_in">this</span>.context = arg2;<br>        <span class="hljs-built_in">this</span>.plainText = arg3;  <span class="hljs-comment">// è¾“å…¥çš„å†…å®¹è¢«èµ‹å€¼ç»™plaintext</span><br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">check</span><span class="hljs-params">(<span class="hljs-type">byte</span>[] arg4)</span> &#123;  <span class="hljs-comment">// å‚æ•°æ˜¯ä»secret.binè¯»å–çš„å†…å®¹</span><br>        Intrinsics.checkNotNullParameter(((Object)arg4), <span class="hljs-string">&quot;iv&quot;</span>);  <span class="hljs-comment">// arg4å³ä»secret.binè¯»å–çš„å†…å®¹è¢«æ ‡è¯†ä¸ºiv</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">v0</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>.context.getString(string.key);  <span class="hljs-comment">// v0ä¸ºstring.key</span><br>        Intrinsics.checkNotNullExpressionValue(v0, <span class="hljs-string">&quot;getString(...)&quot;</span>);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">v1</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>.plainText;  <span class="hljs-comment">// v1æ˜¯è¾“å…¥çš„å†…å®¹plaintext</span><br>        <span class="hljs-type">byte</span>[] v0_1 = v0.getBytes(Charsets.UTF_8);  <span class="hljs-comment">// v0è¯»å–ä¸ºbytes</span><br>        Intrinsics.checkNotNullExpressionValue(((Object)v0_1), <span class="hljs-string">&quot;this as java.lang.String).getBytes(charset)&quot;</span>);<br>        <span class="hljs-type">byte</span>[] v4 = <span class="hljs-built_in">this</span>.encrypt(v1, v0_1, arg4);  <span class="hljs-comment">// ä¸‰ä¸ªå‚æ•°åˆ†åˆ«ä¸ºï¼šè¾“å…¥çš„plaintextï¼Œstring.keyï¼Œä»secret.binè¯»å–çš„iv</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.compare(v4.length, v4);  <span class="hljs-comment">// compareä»nativeå±‚easynative.soå¯¼å…¥</span><br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">native</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">compare</span><span class="hljs-params">(<span class="hljs-type">int</span> arg1, <span class="hljs-type">byte</span>[] arg2)</span> &#123;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">byte</span>[] encrypt(String arg3, <span class="hljs-type">byte</span>[] arg4, <span class="hljs-type">byte</span>[] arg5) &#123;<br>        Intrinsics.checkNotNullParameter(arg3, <span class="hljs-string">&quot;plainText&quot;</span>);  <span class="hljs-comment">// æ­¤å¤„å†æ¬¡å¯¹å‚æ•°è¿›è¡Œäº†æ ‡è¯†</span><br>        Intrinsics.checkNotNullParameter(((Object)arg4), <span class="hljs-string">&quot;key&quot;</span>);<br>        Intrinsics.checkNotNullParameter(((Object)arg5), <span class="hljs-string">&quot;iv&quot;</span>);<br>        <span class="hljs-type">SecretKeySpec</span> <span class="hljs-variable">v0</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SecretKeySpec</span>(arg4, <span class="hljs-string">&quot;AES&quot;</span>);  <span class="hljs-comment">// åŠ å¯†ç®—æ³•AESï¼ŒCTRæ¨¡å¼</span><br>        <span class="hljs-type">Cipher</span> <span class="hljs-variable">v4</span> <span class="hljs-operator">=</span> Cipher.getInstance(<span class="hljs-string">&quot;AES/CTR/NoPadding&quot;</span>);<br>        v4.init(<span class="hljs-number">1</span>, ((Key)v0), ((AlgorithmParameterSpec)<span class="hljs-keyword">new</span> <span class="hljs-title class_">IvParameterSpec</span>(arg5)));<br>        <span class="hljs-type">byte</span>[] v3 = arg3.getBytes(Charsets.UTF_8);<br>        Intrinsics.checkNotNullExpressionValue(((Object)v3), <span class="hljs-string">&quot;this as java.lang.String).getBytes(charset)&quot;</span>);<br>        <span class="hljs-type">byte</span>[] v3_1 = v4.doFinal(v3);<br>        Intrinsics.checkNotNull(((Object)v3_1));<br>        <span class="hljs-keyword">return</span> v3_1;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°Mainactivityä½¿ç”¨äº†FlagCheckeræ¥æ ¡éªŒï¼Œè€ŒFlagCheckerå¯¹è¾“å…¥çš„å†…å®¹è¿›è¡Œäº†AESåŠ å¯†ï¼Œç„¶åç”¨nativeå±‚çš„compareå‡½æ•°æ¥æ£€éªŒåŠ å¯†ç»“æœã€‚ä¸‹é¢æ˜¯nativeå±‚compareå‡½æ•°çš„å†…å®¹(IDAä¸­æ˜¾ç¤ºçš„å‡½æ•°åæ˜¯checkè€Œécompare)ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><code class="hljs c++"><span class="hljs-function">__int64 __fastcall <span class="hljs-title">check</span><span class="hljs-params">(JNIEnv *a1, __int64 a2, <span class="hljs-type">int</span> a3, <span class="hljs-type">void</span> *a4)</span></span><br><span class="hljs-function"></span>&#123;<br>  __int64 v5; <span class="hljs-comment">// x0</span><br>  __int64 i; <span class="hljs-comment">// x9</span><br>  <span class="hljs-type">int</span> v7; <span class="hljs-comment">// w11</span><br>  <span class="hljs-type">int</span> v8; <span class="hljs-comment">// w10</span><br><br>  v5 = (__int64)(*a1)-&gt;<span class="hljs-built_in">GetByteArrayElements</span>(a1, a4, <span class="hljs-number">0LL</span>);<br>  <span class="hljs-keyword">if</span> ( a3 != <span class="hljs-number">48</span> )<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0LL</span>; i != <span class="hljs-number">48</span>; ++i )<br>  &#123;<br>    v7 = (<span class="hljs-type">unsigned</span> __int8)byte_5A2[i];<br>    v8 = *(<span class="hljs-type">unsigned</span> __int8 *)(v5 + i) ^ (<span class="hljs-type">unsigned</span> __int8)i;<br>    <span class="hljs-keyword">if</span> ( v8 != v7 )<br>      <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>  &#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">1LL</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°compareå‡½æ•°æ˜¯å…ˆæ‹¿AESåŠ å¯†ç»“æœå¼‚æˆ–ç´¢å¼•åæ‰è¿›è¡Œæ ¡éªŒçš„ï¼Œæ‰€ä»¥è§£å¯†åº”è¯¥æ‹¿compareä¸­çš„å¯†æ–‡å’Œç´¢å¼•å¼‚æˆ–å¾—åˆ°AESåŠ å¯†çš„æ•°æ®ï¼Œç„¶åæ‰¾å‡ºkeyå’Œivè¿›è¡ŒAESè§£å¯†ã€‚</p>
<p>è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><br>enc=[<span class="hljs-number">0x38</span>, <span class="hljs-number">0xEA</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x8B</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x9E</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0xC5</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0xF0</span>, <span class="hljs-number">0x9D</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0xA7</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0xE5</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0xA5</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0xFC</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x8B</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0xF7</span>]<br><span class="hljs-comment">#å…ˆå¯¹æ•°æ®è¿›è¡Œå¼‚æˆ–è¿˜åŸ</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc)):<br>    enc[i]=enc[i]^i<br><span class="hljs-comment">#æå–AESç›¸å…³å‚æ•°</span><br>key=<span class="hljs-string">b&quot;0xgame-SecretKey&quot;</span><br>iv=<span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-string">&quot;8A A5 61 0C 74 41 1B 11 A3 53 68 DE 56 BF 6A B3&quot;</span>)<br><span class="hljs-comment">#AESè§£å¯†</span><br>cipher=AES.new(key, AES.MODE_CTR, nonce=<span class="hljs-string">b&#x27;&#x27;</span>, initial_value=iv)<br>flag=cipher.decrypt(<span class="hljs-built_in">bytes</span>(enc))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;flag: &quot;</span>,flag.decode())<br></code></pre></td></tr></table></figure></li>
</ul>
<blockquote>
<p>flagï¼š0xGame{Native_1s_also_1nt3r3st1ng_ef492d80a257c}</p>
</blockquote>
<h2 id="å¤œé›€ä¹‹æ­Œ"><a href="#å¤œé›€ä¹‹æ­Œ" class="headerlink" title="å¤œé›€ä¹‹æ­Œ"></a>å¤œé›€ä¹‹æ­Œ</h2><blockquote>
<p>è€ƒç‚¹ï¼šè¿·å®«é¢˜ï¼ŒåŠ¨æ€è°ƒè¯•ï¼Œåè°ƒè¯•</p>
</blockquote>
<ul>
<li><p>é™„ä»¶ç¨‹åºè¿è¡Œèµ·æ¥æ˜¯è¿™æ ·çš„ï¼š</p>
<p><img src="/../images/image-20251105204720304.png" alt="è¿è¡Œ"></p>
<p>ç”¨IDAæ‰“å¼€ï¼Œé€šè¿‡Shift+F12å­—ç¬¦ä¸²çª—å£å¯ä»¥æ‰¾åˆ°ä¸€äº›ä¿¡æ¯å®šä½mainå‡½æ•°çš„ä½ç½®</p>
<p><img src="/../images/image-20251105205201725.png" alt="å­—ç¬¦ä¸²çª—å£çš„ä¿¡æ¯"></p>
<p>mainå‡½æ•°æœ‰ä¸€å¤§ä¸²çš„å¾ªç¯è¯­å¥ï¼Œç»“åˆä¸Šå›¾ç»ˆç«¯è¾“å‡ºçš„WASDå¯ä»¥æ¨æµ‹è¿™æ˜¯ä¸€é“è¿·å®«é€†å‘é¢˜ã€‚#æ˜¯è¿·å®«çš„å¢™ï¼Œç»ˆç«¯æ˜¾ç¤ºçš„æ˜¯è¿·å®«çš„ä¸€å°éƒ¨åˆ†ï¼Œåœ¨ç»ˆç«¯æŒ‰ä¸‹WASDå¯ä»¥æ§åˆ¶Pç§»åŠ¨ã€‚æ‰€ä»¥ç¬¬ä¸€æ­¥è¦æå–è¿·å®«</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-comment">//mainå‡½æ•°</span><br>__int64 <span class="hljs-title function_">sub_7FF6645A1D2B</span><span class="hljs-params">()</span><br>&#123;<br>  <span class="hljs-type">int</span> v0; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">int</span> v1; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">int</span> v2; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">int</span> v3; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">int</span> v5; <span class="hljs-comment">// [rsp+28h] [rbp-8h]</span><br>  <span class="hljs-type">int</span> v6; <span class="hljs-comment">// [rsp+2Ch] [rbp-4h]</span><br><br>  sub_7FF7EC581FC0();<br>  sub_7FF7EC581B30();<br>  sub_7FF7EC5815B6();<br>  v6 = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">do</span><br>  &#123;<br>    sub_7FF7EC581C5F();<br>    sub_7FF7EC5815B6();<br>    <span class="hljs-built_in">puts</span>(&amp;aWasdEsc);<br>    v5 = getch();<br>    sub_7FF7EC583060(<span class="hljs-string">&quot;%c\n&quot;</span>, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v5);<br><br>    <span class="hljs-keyword">if</span> ( v5 == <span class="hljs-number">119</span> )<br>    &#123;<br>LABEL_19:<br>      sub_7FF7EC581BB7(<span class="hljs-number">0LL</span>, <span class="hljs-number">0xFFFFFFFFL</span>L);<br>      v0 = v6++;<br>      byte_7FF7EC58E0E0[v0] = <span class="hljs-number">119</span>;<br>      <span class="hljs-keyword">continue</span>;<br>    &#125;<br>    <span class="hljs-keyword">if</span> ( v5 &lt;= <span class="hljs-number">119</span> )<br>    &#123;<br>      <span class="hljs-keyword">if</span> ( v5 == <span class="hljs-number">115</span> )<br>        <span class="hljs-keyword">goto</span> LABEL_22;<br>      <span class="hljs-keyword">if</span> ( v5 &lt;= <span class="hljs-number">115</span> )<br>      &#123;<br>        <span class="hljs-keyword">if</span> ( v5 == <span class="hljs-number">100</span> )<br>          <span class="hljs-keyword">goto</span> LABEL_21;<br>        <span class="hljs-keyword">if</span> ( v5 &lt;= <span class="hljs-number">100</span> )<br>        &#123;<br>          <span class="hljs-keyword">if</span> ( v5 == <span class="hljs-number">97</span> )<br>            <span class="hljs-keyword">goto</span> LABEL_20;<br>          <span class="hljs-keyword">if</span> ( v5 &lt;= <span class="hljs-number">97</span> )<br>          &#123;<br>            <span class="hljs-keyword">if</span> ( v5 == <span class="hljs-number">87</span> )<br>              <span class="hljs-keyword">goto</span> LABEL_19;<br>            <span class="hljs-keyword">if</span> ( v5 &lt;= <span class="hljs-number">87</span> )<br>            &#123;<br>              <span class="hljs-keyword">if</span> ( v5 == <span class="hljs-number">83</span> )<br>              &#123;<br>LABEL_22:<br>                sub_7FF7EC581BB7(<span class="hljs-number">0LL</span>, <span class="hljs-number">1LL</span>);<br>                v3 = v6++;<br>                byte_7FF7EC58E0E0[v3] = <span class="hljs-number">115</span>;<br>                <span class="hljs-keyword">continue</span>;<br>              &#125;<br>              <span class="hljs-keyword">if</span> ( v5 &lt;= <span class="hljs-number">83</span> )<br>              &#123;<br>                <span class="hljs-keyword">if</span> ( v5 == <span class="hljs-number">68</span> )<br>                &#123;<br>LABEL_21:<br>                  sub_7FF7EC581BB7(<span class="hljs-number">1LL</span>, <span class="hljs-number">0LL</span>);<br>                  v2 = v6++;<br>                  byte_7FF7EC58E0E0[v2] = <span class="hljs-number">100</span>;<br>                  <span class="hljs-keyword">continue</span>;<br>                &#125;<br>                <span class="hljs-keyword">if</span> ( v5 &lt;= <span class="hljs-number">68</span> )<br>                &#123;<br>                  <span class="hljs-keyword">if</span> ( v5 == <span class="hljs-number">27</span> )<br>                    <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>                  <span class="hljs-keyword">if</span> ( v5 == <span class="hljs-number">65</span> )<br>                  &#123;<br>LABEL_20:<br>                    sub_7FF7EC581BB7(<span class="hljs-number">0xFFFFFFFFL</span>L, <span class="hljs-number">0LL</span>);<br>                    v1 = v6++;<br>                    byte_7FF7EC58E0E0[v1] = <span class="hljs-number">97</span>;<br>                  &#125;<br>                &#125;<br>              &#125;<br>            &#125;<br>          &#125;<br>        &#125;<br>      &#125;<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">while</span> ( dword_7FF7EC58E0C4 != dword_7FF7EC58E0D4 || dword_7FF7EC58E0C8 != dword_7FF7EC58E0D8 );<br>  sub_7FF7EC583060(<span class="hljs-string">&quot;Congratulations your flag is: 0xGame&#123;md5(your_path)&#125; (lowercase)&quot;</span>);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>ç‚¹è¿›LABEL_19ä¸‹çš„ç¬¬ä¸€ä¸ªå‡½æ•°å¯ä»¥çœ‹åˆ°ä¸€ä¸ªæ¯”è¾ƒé€»è¾‘</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c">__int64 __fastcall <span class="hljs-title function_">sub_7FF7EC581BB7</span><span class="hljs-params">(<span class="hljs-type">int</span> a1, <span class="hljs-type">int</span> a2)</span><br>&#123;<br>  <span class="hljs-type">int</span> v3; <span class="hljs-comment">// [rsp+24h] [rbp-Ch]</span><br>  <span class="hljs-type">int</span> v4; <span class="hljs-comment">// [rsp+28h] [rbp-8h]</span><br>  <span class="hljs-type">int</span> v5; <span class="hljs-comment">// [rsp+2Ch] [rbp-4h]</span><br><br>  v5 = dword_7FF7EC58E0C4 + a1;<br>  v4 = dword_7FF7EC58E0C8 + a2;<br>  v3 = dword_7FF7EC58E0C4 + a1 + <span class="hljs-number">101</span> * (dword_7FF7EC58E0C8 + a2);<br>  <span class="hljs-keyword">if</span> ( byte_7FF7EC589040[v3] == <span class="hljs-number">35</span> )<span class="hljs-comment">//æ¯”è¾ƒé€»è¾‘</span><br>  &#123;<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;ä¸èƒ½ç§»åŠ¨åˆ°å¢™å£&quot;</span>);<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    byte_7FF7EC589040[<span class="hljs-number">101</span> * dword_7FF7EC58E0C8 + dword_7FF7EC58E0C4] = <span class="hljs-number">32</span>;<br>    dword_7FF7EC58E0C4 = v5;<br>    dword_7FF7EC58E0C8 = v4;<br>    byte_7FF7EC589040[v3] = <span class="hljs-number">80</span>;<br>  &#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>åœ¨Hex Viewè·Ÿéšæ¯”è¾ƒé€»è¾‘ä¸­çš„è¿™ä¸ªæ•°ç»„çš„åœ°å€(7FF7EC589040)å¯ä»¥çœ‹åˆ°è¿·å®«ï¼š</p>
<p><img src="/../images/image-20251105210910030.png" alt="è¿·å®«"></p>
<p>ä½†æ˜¯æå–å‡ºè¿·å®«ä¼šå‘ç°ï¼Œè¿™ä¸ªè¿·å®«å’Œç›´æ¥è¿è¡Œç¨‹åºæ—¶ç»ˆç«¯æ˜¾ç¤ºçš„è¿·å®«ä¸ä¸€æ ·</p>
<p>æ¨æµ‹ç¨‹åºåŠ äº†åè°ƒè¯•ã€‚æœ€ç›´æ¥çš„ç»•è¿‡æ–¹æ³•å°±æ˜¯ç”¨xdbgè°ƒè¯•ï¼Œç”¨æ’ä»¶ScyllaHideç›´æ¥ç»•è¿‡åè°ƒè¯•æ£€æµ‹ã€‚åœ¨è½¬å‚¨æ‰¾åˆ°ç›¸åŒçš„åœ°å€å¯ä»¥å¾—åˆ°çœŸæ­£çš„è¿·å®«</p>
<p><img src="/../images/image-20251105212443210.png" alt="çœŸæ­£çš„è¿·å®«"></p>
<p>é€‰ä¸­è¿·å®«åœ°å›¾æ•°æ®å³é”®äºŒè¿›åˆ¶ä¿å­˜åˆ°æ–‡ä»¶ï¼ŒæŠŠæ–‡ä»¶æ ¼å¼æ”¹ä¸ºtxt</p>
<p><img src="/../images/image-20251105213100678.png" alt="ä¿å­˜è¿·å®«åœ°å›¾"></p>
<p>ç„¶åå°±å¯ä»¥è®©AIå†™ä¸ªè§£è¿·å®«è„šæœ¬è§£å‡ºè·¯å¾„ï¼ŒæŒ‰ç…§ç¨‹åºçš„æç¤ºæŠŠè·¯å¾„è¿›è¡ŒMD5åŠ å¯†å°±å¯ä»¥å¾—åˆ°flagäº†</p>
</li>
<li><p>è§£è¿·å®«è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> deque<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">solve_maze</span>(<span class="hljs-params">maze, start, end, wall=<span class="hljs-string">&#x27;#&#x27;</span>, free=<span class="hljs-string">&#x27; &#x27;</span></span>):<br>    <span class="hljs-string">&quot;&quot;&quot;Maze solver using BFS&quot;&quot;&quot;</span><br>    directions = &#123;<br>        (-<span class="hljs-number">1</span>, <span class="hljs-number">0</span>): <span class="hljs-string">&#x27;w&#x27;</span>,  <span class="hljs-comment"># up</span><br>        (<span class="hljs-number">1</span>, <span class="hljs-number">0</span>): <span class="hljs-string">&#x27;s&#x27;</span>,   <span class="hljs-comment"># down  </span><br>        (<span class="hljs-number">0</span>, -<span class="hljs-number">1</span>): <span class="hljs-string">&#x27;a&#x27;</span>,  <span class="hljs-comment"># left</span><br>        (<span class="hljs-number">0</span>, <span class="hljs-number">1</span>): <span class="hljs-string">&#x27;d&#x27;</span>    <span class="hljs-comment"># right</span><br>    &#125;<br>    <br>    rows, cols = <span class="hljs-built_in">len</span>(maze), <span class="hljs-built_in">len</span>(maze[<span class="hljs-number">0</span>])<br>    visited = [[<span class="hljs-literal">False</span>] * cols <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(rows)]<br>    <br>    <span class="hljs-comment"># BFS</span><br>    queue = deque([(start[<span class="hljs-number">0</span>], start[<span class="hljs-number">1</span>], <span class="hljs-string">&quot;&quot;</span>)])<br>    visited[start[<span class="hljs-number">0</span>]][start[<span class="hljs-number">1</span>]] = <span class="hljs-literal">True</span><br>    <br>    <span class="hljs-keyword">while</span> queue:<br>        row, col, path = queue.popleft()<br>        <br>        <span class="hljs-keyword">if</span> (row, col) == end:<br>            <span class="hljs-keyword">return</span> path<br>        <br>        <span class="hljs-keyword">for</span> dr, dc <span class="hljs-keyword">in</span> directions.keys():<br>            new_row, new_col = row + dr, col + dc<br>            <br>            <span class="hljs-keyword">if</span> (<span class="hljs-number">0</span> &lt;= new_row &lt; rows <span class="hljs-keyword">and</span> <span class="hljs-number">0</span> &lt;= new_col &lt; cols <span class="hljs-keyword">and</span> <br>                <span class="hljs-keyword">not</span> visited[new_row][new_col] <span class="hljs-keyword">and</span> <br>                maze[new_row][new_col] != wall):<br>                <br>                visited[new_row][new_col] = <span class="hljs-literal">True</span><br>                new_path = path + directions[(dr, dc)]<br>                queue.append((new_row, new_col, new_path))<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br><span class="hljs-comment"># Load maze and solve</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;final_maze.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    maze = [<span class="hljs-built_in">list</span>(line.strip()) <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> f]<br><br>start = (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>)<br>end = (<span class="hljs-number">99</span>, <span class="hljs-number">99</span>)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Maze size: <span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(maze)&#125;</span> x <span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(maze[<span class="hljs-number">0</span>])&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Start: <span class="hljs-subst">&#123;start&#125;</span>, End: <span class="hljs-subst">&#123;end&#125;</span>&quot;</span>)<br><br><span class="hljs-comment"># Solve the maze</span><br>solution = solve_maze(maze, start, end, wall=<span class="hljs-string">&#x27;#&#x27;</span>, free=<span class="hljs-string">&#x27; &#x27;</span>)<br><br><span class="hljs-keyword">if</span> solution:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Solution found!&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Path length: <span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(solution)&#125;</span>&quot;</span>)<br>    <br>    <span class="hljs-comment"># Print FULL path</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;\nFULL PATH:&quot;</span>)<br>    <span class="hljs-built_in">print</span>(solution)<br>    <br>    <span class="hljs-comment"># Save full path</span><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;maze_solution.txt&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> f:<br>        f.write(solution)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;\nFull path saved to maze_solution.txt&quot;</span>)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;No solution found!&quot;</span>)<br></code></pre></td></tr></table></figure></li>
</ul>
<blockquote>
<p>flagï¼š0xGame{44fc4bc18c87b3992af1d7726185ed36}</p>
</blockquote>
<h2 id="ç»¯æƒ³å¤©åˆ™"><a href="#ç»¯æƒ³å¤©åˆ™" class="headerlink" title="ç»¯æƒ³å¤©åˆ™"></a>ç»¯æƒ³å¤©åˆ™</h2><blockquote>
<p>è€ƒç‚¹ï¼šunityé€†å‘æ”¹æ¸¸æˆæœºåˆ¶</p>
</blockquote>
<ul>
<li><p>é™„ä»¶æ˜¯ä¸ªunityæ¸¸æˆ</p>
<p><img src="/../images/image-20251105213705664.png" alt="unityæ¸¸æˆ"></p>
<p>bossè¡€æ¡å¾ˆåšï¼Œæ€ä¹ˆæ‰“éƒ½æ‰“ä¸è¿‡ï¼Œè§’è‰²å¾ˆå®¹æ˜“æ­»ã€‚æ‰€ä»¥è€ƒè™‘æ”¹æ¸¸æˆæœºåˆ¶</p>
</li>
<li><p>å‚è€ƒ<a href="https://blog.csdn.net/xianyu_yuan/article/details/140899803">ä»å‡ºé¢˜åˆ°åšé¢˜â€”â€”æµ…æ¢Unityæ¸¸æˆé€†å‘</a>ï¼Œæ‰¾åˆ°IWANNATENSHIFUMOã®INESBATTLE\I WANNA TENSHI FUMOã®FIGHT WITH INES_Data\Managed\Assembly-CSharp.dllï¼Œç”¨dnspyæ‰“å¼€è¿›è¡Œä¿®æ”¹ã€‚ä¿®æ”¹æ€è·¯æ˜¯ç»™è§’è‰²åŠ ä¸Šé”è¡€å’Œä¸€å‡»æ¯™å‘½buffï¼Œä¿®æ”¹çš„ç±»æ˜¯CharacterStatsï¼Œè‡³äºæ€ä¹ˆä¿®æ”¹å¯ä»¥æŠŠæ•´ä¸ªç±»çš„ä»£ç å‘ç»™AIé—®æ€ä¹ˆæ”¹é”è¡€å’Œä¸€å‡»æ¯™å‘½ï¼Œå› ä¸ºé™„ä»¶ç¨‹åºå·¥ç¨‹æ¯”è¾ƒå¤§ï¼Œæ²¡æœ‰ä¸Šä¸‹æ–‡çš„è¯ä¸å¥½æè¿°ï¼Œæ­¤å¤„çœç•¥ä¿®æ”¹æ–¹æ¡ˆäº†ã€‚ä¿®æ”¹æ–¹æ³•æ˜¯åœ¨ç±»ä»£ç é¡µå³é”®é€‰æ‹©ç¼–è¾‘ç±»</p>
<p><img src="/../images/image-20251105220015560.png" alt="å³é”®ç¼–è¾‘ç±»"></p>
<p>ä¿®æ”¹å®Œç‚¹å‡»å³ä¸‹è§’çš„ç¼–è¯‘å³å¯ã€‚æ­¤å¤–ï¼Œç¬”è€…åœ¨ç¼–è¯‘çš„æ—¶å€™é‡åˆ°äº†ä¸€äº›æŠ¥é”™ï¼šrandomâ€™is anbiguous reference between â€˜unityengine.randomâ€™and â€˜system.randomï¼Œæ­¤æ—¶æŠŠä»£ç ä¸­æ‰€æœ‰çš„Random.Rangeéƒ½æ”¹æˆUnityEngine.Random.Rangeå³å¯ã€‚</p>
<p>ä¿®æ”¹å®Œæˆåï¼Œé‡æ–°è¿è¡Œæ¸¸æˆå°±å¯ä»¥é€Ÿé€šå¾—åˆ°flagäº†</p>
<p><img src="/../images/image-20251105220511591.png" alt="é€Ÿé€š"></p>
</li>
</ul>
<blockquote>
<p>flagï¼š0xGame{TenshiSamaSaiko_IWANNATENSHIFUMO_INESBATTLE}</p>
</blockquote>
<h2 id="å¹»è§†è°ƒå¾‹"><a href="#å¹»è§†è°ƒå¾‹" class="headerlink" title="å¹»è§†è°ƒå¾‹"></a>å¹»è§†è°ƒå¾‹</h2><blockquote>
<p>è€ƒç‚¹ï¼šå‡½æ•°é‡å†™ï¼ŒRC4ï¼ŒTEA</p>
</blockquote>
<ul>
<li><p>é™„ä»¶ç¨‹åºè¿è¡Œèµ·æ¥æ˜¯å¾ˆå¸¸è§„çš„è¾“å…¥flagæç¤ºï¼š</p>
<p><img src="/../images/image-20251106193030935.png" alt="å¸¸è§„"></p>
<p>ç”¨IDAæ‰“å¼€ï¼ŒShift+F12å¯ä»¥çœ‹åˆ°å¯ç–‘å­—ç¬¦ä¸²</p>
<p><img src="/../images/image-20251106193216226.png" alt="å¯ç–‘å­—ç¬¦ä¸²"></p>
<p>è·Ÿè¸ªå¯ç–‘å­—ç¬¦ä¸²å¯ä»¥æ‰¾åˆ°mainå‡½æ•°</p>
<p><img src="/../images/image-20251106193251339.png" alt="mainå‡½æ•°"></p>
<p>ç®€å•ä¼˜åŒ–ä¸€ä¸‹</p>
<p><img src="/../images/image-20251106193416659.png" alt="ä¼˜åŒ–åçš„mainå‡½æ•°"></p>
<p>å¯ä»¥çœ‹åˆ°å‡½æ•°å¯¹è¾“å…¥çš„å†…å®¹è¿›è¡Œäº†RC4åŠ å¯†åæ‰æ ¡éªŒã€‚ä½†æ˜¯ä½œä¸ºç¬¬å››å‘¨çš„é¢˜ç›®ï¼Œè¿™æ ·å­æ˜¾ç„¶è¿˜æ˜¯å¤ªç›´ç™½äº†ã€‚åŠ¨è°ƒä¸€ä¸‹å¯ä»¥å‘ç°ï¼Œstrcmpå‡½æ•°è¢«é‡å†™äº†</p>
<p><img src="/../images/image-20251106195811100.png" alt="è·Ÿè¸ªstrcmp1"></p>
<p><img src="/../images/image-20251106195827424.png" alt="è·Ÿè¸ªstrcmp2"></p>
<p><img src="/../images/image-20251106195843505.png" alt="è·Ÿè¸ªstrcmp3"></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œstrcmpæœ€åè¢«å¯¼å‘äº†sub_140003000ï¼Œå‡½æ•°åç¼–è¯‘å¦‚ä¸‹ï¼ˆç»è¿‡ä¼˜åŒ–ï¼‰ï¼Œæ˜¯ä¸ªTEAåŠ å¯†</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs C">_BOOL8 __fastcall <span class="hljs-title function_">sub_140003000</span><span class="hljs-params">(<span class="hljs-type">void</span> *a1, _DWORD *a2)</span><br>&#123;<br>  _DWORD Buf2[<span class="hljs-number">14</span>]; <span class="hljs-comment">// [rsp+20h] [rbp-60h] BYREF</span><br>  _DWORD *key; <span class="hljs-comment">// [rsp+58h] [rbp-28h]</span><br>  <span class="hljs-type">void</span> *Buf1; <span class="hljs-comment">// [rsp+60h] [rbp-20h]</span><br>  <span class="hljs-type">int</span> j; <span class="hljs-comment">// [rsp+6Ch] [rbp-14h]</span><br>  <span class="hljs-type">int</span> sum; <span class="hljs-comment">// [rsp+70h] [rbp-10h]</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> p2; <span class="hljs-comment">// [rsp+74h] [rbp-Ch]</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> p1; <span class="hljs-comment">// [rsp+78h] [rbp-8h]</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [rsp+7Ch] [rbp-4h]</span><br><br>  Buf1 = a1;<br>  key = a2;<br>  Buf2[<span class="hljs-number">0</span>] = <span class="hljs-number">1111022553</span>;<br>  Buf2[<span class="hljs-number">1</span>] = <span class="hljs-number">987309029</span>;<br>  Buf2[<span class="hljs-number">2</span>] = <span class="hljs-number">-1041056711</span>;<br>  Buf2[<span class="hljs-number">3</span>] = <span class="hljs-number">979189025</span>;<br>  Buf2[<span class="hljs-number">4</span>] = <span class="hljs-number">189565873</span>;<br>  Buf2[<span class="hljs-number">5</span>] = <span class="hljs-number">173973774</span>;<br>  Buf2[<span class="hljs-number">6</span>] = <span class="hljs-number">1090109393</span>;<br>  Buf2[<span class="hljs-number">7</span>] = <span class="hljs-number">-591836169</span>;<br>  Buf2[<span class="hljs-number">8</span>] = <span class="hljs-number">-394857933</span>;<br>  Buf2[<span class="hljs-number">9</span>] = <span class="hljs-number">668605093</span>;<br>  Buf2[<span class="hljs-number">10</span>] = <span class="hljs-number">0xB952BACB</span>;<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">9</span>; ++i )<br>  &#123;<br>    sum = <span class="hljs-number">0</span>;<br>    p1 = *((_DWORD *)Buf1 + i);<br>    p2 = *((_DWORD *)Buf1 + i + <span class="hljs-number">1</span>);<br>    sum = <span class="hljs-number">0x9E3779B9</span>;<br>    <span class="hljs-keyword">for</span> ( j = <span class="hljs-number">0</span>; j &lt;= <span class="hljs-number">31</span>; ++j )<br>    &#123;<br>      p1 += (sum + p2) ^ (*key + <span class="hljs-number">16</span> * p2) ^ ((p2 &gt;&gt; <span class="hljs-number">5</span>) + key[<span class="hljs-number">1</span>]);<br>      sum -= <span class="hljs-number">0x61C88647</span>;<br>      p2 += (sum + p1) ^ (key[<span class="hljs-number">2</span>] + <span class="hljs-number">16</span> * p1) ^ ((p1 &gt;&gt; <span class="hljs-number">5</span>) + key[<span class="hljs-number">3</span>]);<br>    &#125;<br>    *((_DWORD *)Buf1 + i) = p1;<br>    *((_DWORD *)Buf1 + i + <span class="hljs-number">1</span>) = p2;<br>  &#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-built_in">memcmp</span>(Buf1, Buf2, <span class="hljs-number">0x2Cu</span>LL) != <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>æ‰€ä»¥ï¼Œå®Œæ•´çš„åŠ å¯†æµç¨‹æ˜¯å…ˆRC4å†TEAï¼ŒTEAçš„keyæ˜¯mainå‡½æ•°ä¸­strcmpçš„å‚æ•°str2ï¼Œå¯†æ–‡æ˜¯TEAæœ€åé¢å‡ºç°çš„Buf2ã€‚</p>
<p>è¿˜æœ‰ä¸€äº›éœ€è¦å…³æ³¨çš„ç‚¹ï¼šç¨‹åºäº‹å®ä¸Šè¿›è¡Œäº†ä¸¤æ¬¡RC4åŠ å¯†ï¼Œç¬¬ä¸€æ¬¡æ˜¯ä¸ºäº†è¾“å‡ºâ€input your flag:â€ï¼Œç¬¬äºŒæ¬¡æ‰æ˜¯åŠ å¯†è¾“å…¥çš„å†…å®¹ã€‚æ‰€ä»¥ï¼ŒåŠ¨è°ƒæ—¶åœ¨å‡½æ•°è¿›è¡Œè¾“å‡ºåã€ç¬¬äºŒæ¬¡RC4åŠ å¯†å‰æ‰èƒ½æå–å‡ºçœŸçš„Sç›’</p>
<p>åœ¨åç¼–è¯‘å‡ºæ¥çš„å‡½æ•°çš„åŸºç¡€ä¸Šå¯ä»¥å†™å‡ºè§£å¯†è„šæœ¬ï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs C"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdint.h&gt;</span></span><br><span class="hljs-type">void</span> <span class="hljs-title function_">RC4_decrypt</span><span class="hljs-params">(<span class="hljs-type">char</span> *a1, <span class="hljs-type">int</span> a2)</span> &#123;<br>    <span class="hljs-comment">//ç›´æ¥æå–Sç›’</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> byte_140008060[<span class="hljs-number">256</span>] = &#123;<br>    <span class="hljs-number">0x99</span>, <span class="hljs-number">0x9B</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0xF6</span>, <span class="hljs-number">0x8B</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0xBD</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x87</span>, <br>    <span class="hljs-number">0x2C</span>, <span class="hljs-number">0xB5</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0xA5</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0xAA</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x4E</span>, <br>    <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x8A</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0xF3</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0xD3</span>, <span class="hljs-number">0xA0</span>, <span class="hljs-number">0x2D</span>, <br>    <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0xFA</span>, <span class="hljs-number">0xD0</span>, <span class="hljs-number">0xC5</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0xDF</span>, <span class="hljs-number">0xB3</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x8E</span>, <span class="hljs-number">0xB4</span>, <br>    <span class="hljs-number">0x8C</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0xD2</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0xAD</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0x77</span>, <br>    <span class="hljs-number">0x4B</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0xC8</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0xF9</span>, <span class="hljs-number">0xA2</span>, <span class="hljs-number">0xE0</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0xE1</span>, <br>    <span class="hljs-number">0xCD</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0xF0</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0x9D</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0xCA</span>, <br>    <span class="hljs-number">0x89</span>, <span class="hljs-number">0xA8</span>, <span class="hljs-number">0xD5</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0xBB</span>, <span class="hljs-number">0xE3</span>, <span class="hljs-number">0xB2</span>, <span class="hljs-number">0x9F</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0xB6</span>, <span class="hljs-number">0xA3</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0xEB</span>, <br>    <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x8F</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0xA6</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0xE5</span>, <span class="hljs-number">0xC0</span>, <span class="hljs-number">0xF5</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0xE9</span>, <br>    <span class="hljs-number">0x3F</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0xA4</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0xEC</span>, <span class="hljs-number">0xE7</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0xDB</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0xED</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x51</span>, <br>    <span class="hljs-number">0xFB</span>, <span class="hljs-number">0xD4</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0xC9</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0xDD</span>, <span class="hljs-number">0xCF</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0xFC</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x7D</span>, <br>    <span class="hljs-number">0x7C</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0xDA</span>, <span class="hljs-number">0xB0</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0xAE</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x7A</span>, <br>    <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0xC4</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0xAC</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0xA7</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0xB1</span>, <br>    <span class="hljs-number">0xE6</span>, <span class="hljs-number">0xB8</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xF4</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0xBA</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0xB7</span>, <span class="hljs-number">0x3B</span>, <br>    <span class="hljs-number">0x35</span>, <span class="hljs-number">0xA1</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x2B</span>, <br>    <span class="hljs-number">0xCC</span>, <span class="hljs-number">0xB9</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0xA9</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0xEA</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0xBC</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x9E</span><br>&#125;;<br>    <span class="hljs-type">unsigned</span> __int8 v3; <span class="hljs-comment">// [rsp+0h] [rbp-10h]</span><br>    <span class="hljs-type">int</span> i; <span class="hljs-comment">// [rsp+4h] [rbp-Ch]</span><br>    <span class="hljs-type">int</span> v5; <span class="hljs-comment">// [rsp+8h] [rbp-8h]</span><br>    <span class="hljs-type">int</span> v6; <span class="hljs-comment">// [rsp+Ch] [rbp-4h]</span><br><br>    v6 = <span class="hljs-number">0</span>;<br>    v5 = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; a2; ++i )<br>    &#123;<br>        v6 = (v6 + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span>;<br>        v5 = (byte_140008060[v6] + v5) % <span class="hljs-number">256</span>;<br>        v3 = byte_140008060[v6];<br>        byte_140008060[v6] = byte_140008060[v5];<br>        byte_140008060[v5] = v3;<br>        *(<span class="hljs-type">char</span> *)(i + a1) = byte_140008060[(<span class="hljs-type">unsigned</span> __int8)(byte_140008060[v6] + byte_140008060[v5])] ^ *(<span class="hljs-type">char</span> *)(a1 + i);<br>    &#125;<br>&#125;<br><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;<br>  	<span class="hljs-comment">//ç”¨ä½œkeyçš„str2</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> Str2[<span class="hljs-number">44</span>] = &#123;<br>    <span class="hljs-number">0x9F</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0xF0</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0xC0</span>, <span class="hljs-number">0xA4</span>, <span class="hljs-number">0xF6</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x55</span>, <br>    <span class="hljs-number">0x80</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0xEC</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0xC8</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x25</span>, <br>    <span class="hljs-number">0x7B</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0xE9</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0xC7</span><br>    &#125;;<br>    <br>    <span class="hljs-comment">//ä¸‹é¢æ˜¯åœ¨åç¼–è¯‘TEAçš„åŸºç¡€ä¸Šæ”¹çš„ï¼Œç›´æ¥è§£å¯†Buf2</span><br>    <span class="hljs-type">uint32_t</span> Buf2[<span class="hljs-number">14</span>]; <span class="hljs-comment">// [rsp+20h] [rbp-60h] BYREF</span><br>    <span class="hljs-type">uint32_t</span> *key; <span class="hljs-comment">// [rsp+58h] [rbp-28h]</span><br>    <span class="hljs-comment">//void *Buf1; // [rsp+60h] [rbp-20h]</span><br>    <span class="hljs-type">int</span> j; <span class="hljs-comment">// [rsp+6Ch] [rbp-14h]</span><br>    <span class="hljs-type">int</span> sum; <span class="hljs-comment">// [rsp+70h] [rbp-10h]</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> p2; <span class="hljs-comment">// [rsp+74h] [rbp-Ch]</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> p1; <span class="hljs-comment">// [rsp+78h] [rbp-8h]</span><br>    <span class="hljs-type">int</span> i; <span class="hljs-comment">// [rsp+7Ch] [rbp-4h]</span><br><br>    <span class="hljs-comment">//Buf1 = a1;</span><br>    key = (<span class="hljs-type">uint32_t</span> *)Str2;<br>    Buf2[<span class="hljs-number">0</span>] = <span class="hljs-number">1111022553</span>;<br>    Buf2[<span class="hljs-number">1</span>] = <span class="hljs-number">987309029</span>;<br>    Buf2[<span class="hljs-number">2</span>] = <span class="hljs-number">-1041056711</span>;<br>    Buf2[<span class="hljs-number">3</span>] = <span class="hljs-number">979189025</span>;<br>    Buf2[<span class="hljs-number">4</span>] = <span class="hljs-number">189565873</span>;<br>    Buf2[<span class="hljs-number">5</span>] = <span class="hljs-number">173973774</span>;<br>    Buf2[<span class="hljs-number">6</span>] = <span class="hljs-number">1090109393</span>;<br>    Buf2[<span class="hljs-number">7</span>] = <span class="hljs-number">-591836169</span>;<br>    Buf2[<span class="hljs-number">8</span>] = <span class="hljs-number">-394857933</span>;<br>    Buf2[<span class="hljs-number">9</span>] = <span class="hljs-number">668605093</span>;<br>    Buf2[<span class="hljs-number">10</span>] = <span class="hljs-number">0xB952BACB</span>;<br>    <span class="hljs-comment">//è¿™é‡ŒåŸæ¥æ˜¯ä»&lt;Buf[0],Buf[1]&gt;åˆ°&lt;Buf[9],Buf[10]&gt;ä¸€å¯¹ä¸€å¯¹åŠ å¯†ï¼Œç°åœ¨åè¿‡æ¥ä»&lt;Buf[9],Buf[10]&gt;å¼€å§‹åˆ°&lt;Buf[0],Buf[1]&gt;</span><br>    <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">9</span>; i &gt;= <span class="hljs-number">0</span>; --i )<br>    &#123;<br>        sum = <span class="hljs-number">0</span>;<br>        p1 = *((<span class="hljs-type">uint32_t</span>*)Buf2 + i);<br>        p2 = *((<span class="hljs-type">uint32_t</span>*)Buf2 + i + <span class="hljs-number">1</span>);<br>        sum = <span class="hljs-number">0x9E3779B9</span>;<br>        <span class="hljs-comment">//æ¨¡æ‹Ÿæ­£å‘åŠ å¯†å¾—åˆ°æœ€åçš„sumå€¼</span><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; i++)&#123;<br>            sum-=<span class="hljs-number">0x61C88647</span>;<br>        &#125;<br>        <span class="hljs-comment">//p1ï¼Œp2çš„å¤„ç†é¡ºåºè°ƒæ¢ï¼ŒåŠ å‡è°ƒæ¢ï¼ŒsumåŠ å‡è°ƒæ¢</span><br>        <span class="hljs-keyword">for</span> ( j = <span class="hljs-number">0</span>; j &lt;= <span class="hljs-number">31</span>; ++j )<br>        &#123;<br>        p2 -= (sum + p1) ^ (key[<span class="hljs-number">2</span>] + <span class="hljs-number">16</span> * p1) ^ ((p1 &gt;&gt; <span class="hljs-number">5</span>) + key[<span class="hljs-number">3</span>]);<br>        sum += <span class="hljs-number">0x61C88647</span>;<br>        p1 -= (sum + p2) ^ (*key + <span class="hljs-number">16</span> * p2) ^ ((p2 &gt;&gt; <span class="hljs-number">5</span>) + key[<span class="hljs-number">1</span>]);<br>        &#125;<br>        *((<span class="hljs-type">uint32_t</span>*)Buf2 + i) = p1;<br>        *((<span class="hljs-type">uint32_t</span>*)Buf2 + i + <span class="hljs-number">1</span>) = p2;<br>    &#125;<br>    RC4_decrypt((<span class="hljs-type">char</span> *)Buf2,<span class="hljs-number">44</span>);<br>    <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">44</span>;i++)<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>,((<span class="hljs-type">char</span> *)Buf2)[i]);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<blockquote>
<p>flagï¼š0xGame{20994d4d-30ab-4918-b00a-5ca6ae138613}</p>
</blockquote>
<h2 id="èŠ±é¸Ÿé£æœˆ"><a href="#èŠ±é¸Ÿé£æœˆ" class="headerlink" title="èŠ±é¸Ÿé£æœˆ"></a>èŠ±é¸Ÿé£æœˆ</h2><blockquote>
<p>è€ƒç‚¹ï¼šèŠ±æŒ‡ä»¤ï¼Œé­”æ”¹base64ï¼Œå¼‚æˆ–ï¼ŒåŠ¨æ€è°ƒè¯•</p>
</blockquote>
<ul>
<li><p>é™„ä»¶ç¨‹åºè¿è¡Œèµ·æ¥æ˜¯è¿™æ ·çš„ï¼š</p>
<p><img src="/../images/image-20251107170326209.png" alt="è¿è¡Œç¨‹åº"></p>
<p>ç”¨IDAæ‰“å¼€ï¼ŒShift+F12åœ¨å­—ç¬¦ä¸²çª—å£å¯ä»¥æ‰¾åˆ°ç±»ä¼¼base64ç¼–ç è¡¨çš„å¯ç–‘å­—ç¬¦ä¸²</p>
<p><img src="/../images/image-20251107171007199.png" alt="å¯ç–‘çš„å­—ç¬¦ä¸²"></p>
<p>éšåå¯ä»¥è·Ÿè¸ªåˆ°è¿™æ ·ä¸€ä¸ªè²Œä¼¼base64ç¼–ç çš„å‡½æ•°</p>
<p><img src="/../images/image-20251107171139700.png" alt="è·Ÿè¸ªåˆ°ä¸€ä¸ªç±»ä¼¼base64ç¼–ç çš„å‡½æ•°"></p>
<p>é€‰ä¸­å‡½æ•°åæŒ‰Xå›æº¯ä¸Šå±‚å‡½æ•°ï¼Œä¼šå‘ç°æ— æ³•åç¼–è¯‘äº†ï¼Œæ ˆå¸§æŠ¥é”™</p>
<p><img src="/../images/image-20251107171338976.png" alt="æ ˆå¸§æŠ¥é”™"></p>
<p>åœ¨æŠ¥é”™çš„é™„è¿‘å¯ä»¥çœ‹åˆ°åæ±‡ç¼–å¤±è´¥çš„ä¸€å †æ•°å­—ï¼Œä»¥åŠä¸€ä¸ªå…¸å‹çš„jnz+jzèŠ±æŒ‡ä»¤</p>
<p>é€‰ä¸­ä¸Šå›¾ä¸­çš„loc_4012F2æŒ‰Uå¯ä»¥å¾—åˆ°ä¸‹å›¾</p>
<p><img src="/../images/image-20251107172247039.png" alt="undefine"></p>
<p>æ­¤æ—¶åªéœ€è¦æŠŠjnzå’Œjzä»¥åŠåé¢çš„0E8hç»™nopæ‰å³å¯ï¼Œå†é€‰ä¸­unk_4012F3æŒ‰Cå³å¯å¾—åˆ°ä¿®æ­£åçš„æ±‡ç¼–ä»£ç </p>
<p><img src="/../images/image-20251107172437327.png" alt="ä¿®æ­£åçš„æ±‡ç¼–ä»£ç "></p>
<p>åŒæ ·çš„èŠ±æŒ‡ä»¤å¤§æ¦‚æœ‰3ä¸ªï¼Œå»é™¤åå¯ä»¥åœ¨ä¸Šæ–‡æ‰¾åˆ°å¦ä¸€ä¸ªæŠ¥é”™</p>
<p><img src="/../images/image-20251107173258987.png" alt="å¦ä¸€ä¸ªæŠ¥é”™"></p>
<p>è¿™é‡Œå¯ä»¥å‘ç°æŠ¥é”™å¤„çš„ä¸Šä¸€å¥æ˜¯retnï¼Œæ‰€ä»¥æŠŠä¸‹é¢çš„loc_4012C0å³é”®create function</p>
<p><img src="/../images/image-20251107173428095.png" alt="create function"></p>
<p>ç„¶åå†å›è¿‡å¤´çœ‹è¿™ä¸ªæŠ¥é”™ï¼Œå‰é¢ä¸è¿œæœ‰ä¸€ä¸ªå¾ˆå¯ç–‘çš„call $+5ï¼Œæ˜¾ç„¶æ˜¯äººä¸ºä¿®æ”¹çš„</p>
<p><img src="/../images/image-20251112220409411.png" alt="å¯ç–‘çš„call $+5"></p>
<p>ä»”ç»†åˆ†æè¿™æ®µæ±‡ç¼–ä»£ç ä¼šå‘ç°ï¼Œè¿™ä¹Ÿæ˜¯ä¸€ä¸ªèŠ±æŒ‡ä»¤</p>
<p><img src="/../images/image-20251112220643619.png" alt="åˆ†ææ±‡ç¼–ä»£ç "></p>
<p>å®é™…ä¸Šç¨‹åºåœ¨jzå¤„ä¸è·³ç›´æ¥retnåï¼Œä¼šå›åˆ°xor eax,1è¿™ä¸€è¡Œï¼ŒåŸå› æ˜¯ï¼šcall $+5å³call 0x0040122Dï¼Œåˆå³push rip(0x0040122D)  jmp 0x0040122Dï¼Œæ‰€ä»¥retnåç¨‹åºå›åˆ°æ ˆä¸Šçš„rip(0x0040122D)å¤„ï¼Œå³xor eax,1ã€‚IDAåç¼–è¯‘ä¼šè¢«è¿™ä¸ªretnç»™æ¬ºéª—ï¼Œè¯¯ä»¥ä¸ºå‡½æ•°åˆ°æ­¤ç»“æŸï¼Œå…¶å®åé¢è¿˜æœ‰ä¸€äº›å†…å®¹ã€‚æ‰€ä»¥ç›´æ¥å§loc_401223è¿™ä¸€æ•´æ®µnopæ‰ï¼Œå°±å¯ä»¥å¾—åˆ°å®Œæ•´çš„åç¼–è¯‘ä»£ç </p>
<p><img src="/../images/image-20251113211300972.png" alt="å®Œæ•´çš„åç¼–è¯‘ä»£ç "></p>
<p>ä¼˜åŒ–ä¸€ä¸‹è¿™ä¸ªå‡½æ•°å’Œä¸Šæ–‡çš„ç±»ä¼¼baseç¼–ç çš„å‡½æ•°çš„å‘½åï¼Œå¯ä»¥å¾—åˆ°ã€‚</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs C"><span class="hljs-type">int</span> <span class="hljs-title function_">sub_4012C0</span><span class="hljs-params">()</span><br>&#123;<br>  <span class="hljs-type">char</span> *v0; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v1; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v2; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v3; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v5; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v6; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v7; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v8; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">int</span> v9; <span class="hljs-comment">// [esp-4h] [ebp-ECh]</span><br>  <span class="hljs-type">int</span> v10; <span class="hljs-comment">// [esp+10h] [ebp-D8h] BYREF</span><br>  <span class="hljs-type">int</span> v11; <span class="hljs-comment">// [esp+14h] [ebp-D4h]</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [esp+18h] [ebp-D0h]</span><br>  _BYTE v13[<span class="hljs-number">100</span>]; <span class="hljs-comment">// [esp+1Ch] [ebp-CCh] BYREF</span><br>  _BYTE v14[<span class="hljs-number">100</span>]; <span class="hljs-comment">// [esp+80h] [ebp-68h] BYREF</span><br><br>  v11 = <span class="hljs-number">0x81428113</span>;<br>  v0 = sub_401000((<span class="hljs-type">int</span>)&amp;unk_422054);<br>  sub_401670(v0);<br>  v1 = sub_401000((<span class="hljs-type">int</span>)&amp;unk_422068);<br>  sub_4016B0(v1, (<span class="hljs-type">char</span>)&amp;v10);<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; ++i )<br>  &#123;<br>    v11 = <span class="hljs-number">21106755</span> * v11 + <span class="hljs-number">1126795285</span>;<br>    v11 ^= __ROL4__(<br>             v10,<br>             i * (byte_422007 + byte_422004)<br>           % (byte_422008<br>            + byte_422004<br>            + byte_422005 * byte_422008<br>            + byte_422AA0 * (byte_422002 + byte_422006 + byte_422003)<br>            - byte_422005 * byte_422005));<br>  &#125;<br>  <span class="hljs-keyword">if</span> ( v11 == <span class="hljs-number">0xA745DA5D</span> )<br>  &#123;<br>    v2 = sub_401000((<span class="hljs-type">int</span>)&amp;unk_42206C);<br>    sub_401670(v2);<br>    v5 = sub_401000((<span class="hljs-type">int</span>)&amp;unk_422094);<br>    sub_401670(v5);<br>    v6 = sub_401000((<span class="hljs-type">int</span>)&amp;unk_4220A4);<br>    sub_4016B0(v6, (<span class="hljs-type">char</span>)v14);<br>    XORencrypt(v14, v10, byte_422004 + byte_422002 + byte_422008 * byte_422003);<br>    baseEncode((<span class="hljs-type">int</span>)v14, (<span class="hljs-type">int</span>)v13, byte_422005 + byte_422001 + byte_422008 * byte_422003);<br>    v9 = byte_422004 * byte_422003 * byte_422002;<br>    v7 = sub_401000((<span class="hljs-type">int</span>)&amp;unk_4220A8);<br>    <span class="hljs-keyword">if</span> ( sub_40B460(v13, v7, v9) )<br>      v8 = sub_401000((<span class="hljs-type">int</span>)&amp;unk_4220FC);<br>    <span class="hljs-keyword">else</span><br>      v8 = sub_401000((<span class="hljs-type">int</span>)&amp;unk_4220E8);<br>    sub_401670(v8);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    v3 = sub_401000((<span class="hljs-type">int</span>)&amp;unk_422080);<br>    sub_401670(v3);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>å…¶ä¸­byte_42200xçš„å€¼éƒ½æ˜¯x+1ï¼Œæ‰€ä»¥å¯ä»¥è¿›ä¸€æ­¥ä¼˜åŒ–</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs C"><span class="hljs-type">int</span> <span class="hljs-title function_">sub_4012C0</span><span class="hljs-params">()</span><br>&#123;<br>  <span class="hljs-type">char</span> *v0; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v1; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v2; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v3; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v5; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v6; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v7; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v8; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">int</span> v9; <span class="hljs-comment">// [esp-4h] [ebp-ECh]</span><br>  <span class="hljs-type">int</span> v10; <span class="hljs-comment">// [esp+10h] [ebp-D8h] BYREF</span><br>  <span class="hljs-type">int</span> v11; <span class="hljs-comment">// [esp+14h] [ebp-D4h]</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [esp+18h] [ebp-D0h]</span><br>  _BYTE v13[<span class="hljs-number">100</span>]; <span class="hljs-comment">// [esp+1Ch] [ebp-CCh] BYREF</span><br>  _BYTE v14[<span class="hljs-number">100</span>]; <span class="hljs-comment">// [esp+80h] [ebp-68h] BYREF</span><br><br>  v11 = <span class="hljs-number">0x81428113</span>;<br>  v0 = sub_401000((<span class="hljs-type">int</span>)&amp;unk_422054);<br>  sub_401670(v0);<br>  v1 = sub_401000((<span class="hljs-type">int</span>)&amp;unk_422068);<br>  sub_4016B0(v1, (<span class="hljs-type">char</span>)&amp;v10);<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; ++i )<br>  &#123;<br>    v11 = <span class="hljs-number">0x1421043</span> * v11 + <span class="hljs-number">0x43298815</span>;<br>    v11 ^= __ROL4__(v10, i * (<span class="hljs-number">8</span> + <span class="hljs-number">5</span>) % (<span class="hljs-number">9</span> + <span class="hljs-number">5</span> + <span class="hljs-number">6</span> * <span class="hljs-number">9</span> + <span class="hljs-number">0</span> * (<span class="hljs-number">3</span> + <span class="hljs-number">7</span> + <span class="hljs-number">4</span>) - <span class="hljs-number">6</span> * <span class="hljs-number">6</span>));<br>  &#125;<br>  <span class="hljs-keyword">if</span> ( v11 == <span class="hljs-number">0xA745DA5D</span> )<br>  &#123;<br>    v2 = sub_401000((<span class="hljs-type">int</span>)&amp;unk_42206C);<br>    sub_401670(v2);<br>    v5 = sub_401000((<span class="hljs-type">int</span>)&amp;unk_422094);<br>    sub_401670(v5);<br>    v6 = sub_401000((<span class="hljs-type">int</span>)&amp;unk_4220A4);<br>    sub_4016B0(v6, (<span class="hljs-type">char</span>)v14);<br>    XORencrypt(v14, v10, <span class="hljs-number">5</span> + <span class="hljs-number">3</span> + <span class="hljs-number">9</span> * <span class="hljs-number">4</span>);<br>    baseEncode((<span class="hljs-type">int</span>)v14, (<span class="hljs-type">int</span>)v13, <span class="hljs-number">6</span> + <span class="hljs-number">2</span> + <span class="hljs-number">9</span> * <span class="hljs-number">4</span>);<br>    v9 = <span class="hljs-number">5</span> * <span class="hljs-number">4</span> * <span class="hljs-number">3</span>;<br>    v7 = sub_401000((<span class="hljs-type">int</span>)&amp;unk_4220A8);<br>    <span class="hljs-keyword">if</span> ( sub_40B460(v13, v7, v9) )<br>      v8 = sub_401000((<span class="hljs-type">int</span>)&amp;unk_4220FC);<br>    <span class="hljs-keyword">else</span><br>      v8 = sub_401000((<span class="hljs-type">int</span>)&amp;unk_4220E8);<br>    sub_401670(v8);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    v3 = sub_401000((<span class="hljs-type">int</span>)&amp;unk_422080);<br>    sub_401670(v3);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>åŠ¨è°ƒå¯ä»¥å‘ç°ç¨‹åºçš„æç¤ºè¯æ˜¯å®æ—¶è§£å¯†çš„ï¼Œsub_401000æ˜¯è§£å¯†å‡½æ•°ï¼Œsub_401670æ˜¯è¾“å‡ºå‡½æ•°ï¼Œsub_4016B0æ˜¯è¾“å…¥å‡½æ•°ã€‚ä¸‹é¢æ˜¯å…·ä½“è¿‡ç¨‹ï¼š</p>
<p>åœ¨å‡½æ•°çš„å¼€å¤´ä¸‹æ–­ç‚¹ï¼Œå¼€å§‹è°ƒè¯•ã€‚ç¨‹åºåœåœ¨äº†ä¸‹å›¾è¿™ä¸ªåœ°æ–¹ï¼Œå¯ä»¥çœ‹åˆ°éšåæœ‰ä¸€äº›å¥‡æ€ªçš„æ•°æ®ï¼Œç›´æ¥nopæ‰</p>
<p><img src="/../images/image-20251107211205450.png" alt="å¥‡æ€ªçš„æ•°æ®"></p>
<p><img src="/../images/image-20251107211234103.png" alt="nopæ‰"></p>
<p>ç»§ç»­è¿è¡Œç¨‹åºä¼šå‘ç°æ‰§è¡Œè¿‡sub_7C1670ï¼ˆå¯¹åº”é™æ€åˆ†ææ—¶çš„sub_401670ï¼ŒåŠ¨æ€è°ƒè¯•æ¢åŸºå€äº†æ‰€ä»¥åœ°å€å‰ä¸¤ä½æœ‰äº›ä¸åŒï¼‰åç¨‹åºä¼šæœ‰æç¤ºè¾“å‡ºï¼Œå› æ­¤æ¨æ–­sub_7C1670æ˜¯print</p>
<p><img src="/../images/image-20251107212238679.png" alt="æç¤ºè¾“å‡º"></p>
<p>è€Œè§‚å¯Ÿé™æ€åˆ†ææ—¶çš„ä»£ç å¯ä»¥å‘ç°ï¼Œsub_401000å‡ ä¹å’Œsub_401670æ˜¯åŒæ—¶å‡ºç°çš„ï¼ŒåŠ¨æ€è°ƒè¯•å¯¹åº”çš„sub_7C1000å‡½æ•°åç¼–è¯‘å¦‚ä¸‹</p>
<p><img src="/../images/image-20251107212753102.png" alt="sub_7C1000åç¼–è¯‘"></p>
<p>åŒæ—¶å¯ä»¥å‘ç°byte_7E3440æ­¤æ—¶å­˜å‚¨çš„æ­£å¥½æ˜¯Input key (Hex) ï¼ˆæ­¤æ—¶å·²ç»æ­¥è¿‡è¿™ä¸ªå‡½æ•°äº†ï¼Œæ‰€ä»¥byte_7E3440å·²ç»è¢«å¤„ç†è¿‡äº†ï¼‰:</p>
<p><img src="/../images/image-20251107212917688.png" alt="byte_7E3440"></p>
<p>æ‰€ä»¥å¯ä»¥æ¨æµ‹æç¤ºè¯æ˜¯å®æ—¶è§£å¯†çš„ï¼Œsub_401000æ˜¯è§£å¯†å‡½æ•°</p>
<p>æ¥ä¸‹æ¥è¿˜æœ‰ä¸ªsub_7C16B0ï¼Œæ¨æµ‹æ˜¯scanf</p>
<p><img src="/../images/image-20251107215116511.png" alt="sub_7C16B0"></p>
<p>åœ¨åŠ¨æ€è°ƒè¯•éšåçš„ä»£ç é‡Œï¼Œä¼šå‘ç°è¿˜æœ‰èŠ±æŒ‡ä»¤ï¼ˆæœ‰ä¸¤å¤„ï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯é™æ€åˆ†ææ—¶çš„å»æ··æ·†æ²¡æœ‰ä¿å­˜ï¼‰</p>
<p><img src="/../images/image-20251107215446744.png" alt="èŠ±æŒ‡ä»¤"></p>
<p>åŒæ ·çš„æ“ä½œnopæ‰åï¼Œåç¼–è¯‘å¾—åˆ°</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs C"><span class="hljs-type">void</span> <span class="hljs-title function_">sub_7C12C0</span><span class="hljs-params">()</span><br>&#123;<br>  <span class="hljs-type">char</span> *v0; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v1; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v2; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v3; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v4; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v5; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v6; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v7; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">int</span> v8; <span class="hljs-comment">// [esp-4h] [ebp-ECh]</span><br>  <span class="hljs-type">int</span> v9; <span class="hljs-comment">// [esp+10h] [ebp-D8h] BYREF</span><br>  <span class="hljs-type">int</span> v10; <span class="hljs-comment">// [esp+14h] [ebp-D4h]</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [esp+18h] [ebp-D0h]</span><br>  _BYTE v12[<span class="hljs-number">100</span>]; <span class="hljs-comment">// [esp+1Ch] [ebp-CCh] BYREF</span><br>  _BYTE v13[<span class="hljs-number">100</span>]; <span class="hljs-comment">// [esp+80h] [ebp-68h] BYREF</span><br><br>  v10 = <span class="hljs-number">0x81428113</span>;<br>  v0 = decodeNotice((<span class="hljs-type">int</span>)&amp;unk_7E2054);<br>  print(v0);<br>  v1 = decodeNotice((<span class="hljs-type">int</span>)&amp;unk_7E2068);<br>  <span class="hljs-built_in">scanf</span>(v1, (<span class="hljs-type">char</span>)&amp;v9);<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; ++i )<br>  &#123;<br>    v10 = <span class="hljs-number">0x1421043</span> * v10 + <span class="hljs-number">0x43298815</span>;<br>    v10 ^= __ROL4__(v9, i * (<span class="hljs-number">8</span> + <span class="hljs-number">5</span>) % (<span class="hljs-number">9</span> + <span class="hljs-number">5</span> + <span class="hljs-number">6</span> * <span class="hljs-number">9</span> + <span class="hljs-number">0</span> * (<span class="hljs-number">3</span> + <span class="hljs-number">7</span> + <span class="hljs-number">4</span>) - <span class="hljs-number">6</span> * <span class="hljs-number">6</span>));<br>  &#125;<br>  <span class="hljs-keyword">if</span> ( v10 == <span class="hljs-number">0xA745DA5D</span> )<br>  &#123;<br>    v2 = decodeNotice((<span class="hljs-type">int</span>)&amp;unk_7E206C);<br>    print(v2);<br>    v4 = decodeNotice((<span class="hljs-type">int</span>)&amp;unk_7E2094);<br>    print(v4);<br>    v5 = decodeNotice((<span class="hljs-type">int</span>)&amp;unk_7E20A4);<br>    <span class="hljs-built_in">scanf</span>(v5, (<span class="hljs-type">char</span>)v13);<br>    XORencrypt((<span class="hljs-type">int</span>)v13, v9, <span class="hljs-number">5</span> + <span class="hljs-number">3</span> + <span class="hljs-number">9</span> * <span class="hljs-number">4</span>);<br>    baseEncode((<span class="hljs-type">int</span>)v13, (<span class="hljs-type">int</span>)v12, <span class="hljs-number">6</span> + <span class="hljs-number">2</span> + <span class="hljs-number">9</span> * <span class="hljs-number">4</span>);<br>    v8 = <span class="hljs-number">5</span> * <span class="hljs-number">4</span> * <span class="hljs-number">3</span>;<br>    v6 = decodeNotice((<span class="hljs-type">int</span>)&amp;unk_7E20A8);<br>    <span class="hljs-keyword">if</span> ( sub_7CB460(v12, v6, v8) )<br>      v7 = decodeNotice((<span class="hljs-type">int</span>)&amp;unk_7E20FC);<br>    <span class="hljs-keyword">else</span><br>      v7 = decodeNotice((<span class="hljs-type">int</span>)&amp;unk_7E20E8);<br>    print(v7);<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    v3 = decodeNotice((<span class="hljs-type">int</span>)&amp;unk_7E2080);<br>    print(v3);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>æ­¤æ—¶å¾—åˆ°æ›´åŠ æ¸…æ™°çš„ä»£ç äº†ï¼ŒåŒæ—¶å¯ä»¥å‘ç°ç¨‹åºé¦–å…ˆå¯¹è¾“å…¥çš„keyè¿›è¡Œäº†æ ¡éªŒã€‚</p>
<p>ä¸ºäº†ç»§ç»­äº†è§£ç¨‹åºé€»è¾‘ï¼Œè¿™é‡Œé€‰æ‹©ä¿®æ”¹ifè¯­å¥æ¡ä»¶çš„åˆ¤æ–­ç»“æœæ¥ç»•è¿‡keyæ£€éªŒï¼Œåªéœ€è¦åœ¨cmpåä¿®æ”¹ZFæ ‡å¿—ä½ï¼Œè®©jnzä¸æˆç«‹å³å¯</p>
<p><img src="/../images/image-20251107220443790.png" alt="ç»•è¿‡keyæ£€éªŒ"></p>
<p><img src="/../images/image-20251107220708346.png" alt="æˆåŠŸç»•è¿‡keyæ£€éªŒ"></p>
<p>ç»§ç»­è¿è¡Œç¨‹åºä¼šæœ‰è¾“å…¥flagçš„æç¤º</p>
<p><img src="/../images/image-20251107220805016.png" alt="è¾“å…¥flagçš„æç¤º"></p>
<p>è‡³æ­¤ï¼Œå¯ä»¥çŒœå‡ºç¨‹åºçš„å¤§è‡´é€»è¾‘ï¼šæ¥æ”¶ä¸€ä¸ªkeyå¹¶è¿›è¡Œæ£€éªŒï¼Œæ£€éªŒæˆåŠŸåˆ™ç»§ç»­æ£€éªŒflagï¼ŒåŒæ—¶éœ€è¦æ³¨æ„keyä¼šä½œä¸ºflagæ£€éªŒçš„ä¸€ä¸ªå‚æ•°ã€‚ä¸‹é¢æ˜¯ä¼˜åŒ–åçš„æœ€ç»ˆä»£ç </p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs C"><span class="hljs-type">void</span> <span class="hljs-title function_">sub_7C12C0</span><span class="hljs-params">()</span><br>&#123;<br>  <span class="hljs-type">char</span> *v0; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v1; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v2; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v3; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v4; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v5; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *targetResult; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v7; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">int</span> v8; <span class="hljs-comment">// [esp-4h] [ebp-ECh]</span><br>  <span class="hljs-type">int</span> key; <span class="hljs-comment">// [esp+10h] [ebp-D8h] BYREF</span><br>  <span class="hljs-type">int</span> v10; <span class="hljs-comment">// [esp+14h] [ebp-D4h]</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [esp+18h] [ebp-D0h]</span><br>  _BYTE encodedInput[<span class="hljs-number">100</span>]; <span class="hljs-comment">// [esp+1Ch] [ebp-CCh] BYREF</span><br>  _BYTE input[<span class="hljs-number">100</span>]; <span class="hljs-comment">// [esp+80h] [ebp-68h] BYREF</span><br><br>  v10 = <span class="hljs-number">0x81428113</span>;<br>  v0 = decodeNotice((<span class="hljs-type">int</span>)&amp;unk_7E2054);          <span class="hljs-comment">// input key</span><br>  print(v0);<br>  v1 = decodeNotice((<span class="hljs-type">int</span>)&amp;unk_7E2068);<br>  <span class="hljs-built_in">scanf</span>(v1, (<span class="hljs-type">char</span>)&amp;key);<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; ++i )<br>  &#123;<br>    v10 = <span class="hljs-number">0x1421043</span> * v10 + <span class="hljs-number">0x43298815</span>;<br>    v10 ^= __ROL4__(key, i * (<span class="hljs-number">8</span> + <span class="hljs-number">5</span>) % (<span class="hljs-number">9</span> + <span class="hljs-number">5</span> + <span class="hljs-number">6</span> * <span class="hljs-number">9</span> + <span class="hljs-number">0</span> * (<span class="hljs-number">3</span> + <span class="hljs-number">7</span> + <span class="hljs-number">4</span>) - <span class="hljs-number">6</span> * <span class="hljs-number">6</span>));<br>  &#125;<br>  <span class="hljs-keyword">if</span> ( v10 == <span class="hljs-number">0xA745DA5D</span> )<br>  &#123;<br>    v2 = decodeNotice((<span class="hljs-type">int</span>)&amp;unk_7E206C);        <span class="hljs-comment">// key is correct</span><br>    print(v2);<br>    v4 = decodeNotice((<span class="hljs-type">int</span>)&amp;unk_7E2094);        <span class="hljs-comment">// input flag</span><br>    print(v4);<br>    v5 = decodeNotice((<span class="hljs-type">int</span>)&amp;unk_7E20A4);<br>    <span class="hljs-built_in">scanf</span>(v5, (<span class="hljs-type">char</span>)input);<br>    XORencrypt((<span class="hljs-type">int</span>)input, key, <span class="hljs-number">5</span> + <span class="hljs-number">3</span> + <span class="hljs-number">9</span> * <span class="hljs-number">4</span>);<br>    baseEncode((<span class="hljs-type">int</span>)input, (<span class="hljs-type">int</span>)encodedInput, <span class="hljs-number">6</span> + <span class="hljs-number">2</span> + <span class="hljs-number">9</span> * <span class="hljs-number">4</span>);<br>    v8 = <span class="hljs-number">5</span> * <span class="hljs-number">4</span> * <span class="hljs-number">3</span>;<br>    targetResult = decodeNotice((<span class="hljs-type">int</span>)&amp;unk_7E20A8);<span class="hljs-comment">// æ­¤å¤„è§£å¯†çš„å€¼è¢«ç”¨æ¥å’Œè¾“å…¥å€¼çš„åŠ å¯†ç»“æœè¿›è¡Œæ¯”è¾ƒäº†ï¼Œæ‰€ä»¥æ¨æµ‹æ˜¯çœŸæ­£çš„flagå¯†æ–‡</span><br>    <span class="hljs-keyword">if</span> ( <span class="hljs-built_in">strcmp</span>(encodedInput, targetResult, v8) )<br>      v7 = decodeNotice((<span class="hljs-type">int</span>)&amp;unk_7E20FC);<br>    <span class="hljs-keyword">else</span><br>      v7 = decodeNotice((<span class="hljs-type">int</span>)&amp;unk_7E20E8);<br>    print(v7);<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    v3 = decodeNotice((<span class="hljs-type">int</span>)&amp;unk_7E2080);<br>    print(v3);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>targetResultä¹Ÿæ˜¯å®æ—¶è§£å¯†çš„ç»“æœï¼Œæ‰€ä»¥å¯ä»¥åŠ¨è°ƒæå–</p>
<p>ç¨‹åºçš„åŠ å¯†æµç¨‹æ˜¯å…ˆXORencryptå†baseEncodeï¼Œæ‰€ä»¥è§£å¯†è¦å…ˆbaseDecodeå†XORencã€‚baseEncodeä¼˜åŒ–åå¦‚ä¸‹ï¼Œå¯ä»¥å‘ç°ä¸æ˜¯æ ‡å‡†çš„base64ç¼–ç </p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs C"><span class="hljs-type">int</span> __cdecl <span class="hljs-title function_">baseEncode</span><span class="hljs-params">(<span class="hljs-type">int</span> input, <span class="hljs-type">int</span> output, <span class="hljs-type">int</span> length)</span><br>&#123;<br>  <span class="hljs-type">int</span> result; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> code2; <span class="hljs-comment">// [esp+Ah] [ebp-56h]</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [esp+Ch] [ebp-54h]</span><br>  <span class="hljs-type">char</span> code4; <span class="hljs-comment">// [esp+12h] [ebp-4Eh]</span><br>  <span class="hljs-type">char</span> code3; <span class="hljs-comment">// [esp+13h] [ebp-4Dh]</span><br>  <span class="hljs-type">int</span> v8; <span class="hljs-comment">// [esp+14h] [ebp-4Ch]</span><br>  <span class="hljs-type">int</span> v9; <span class="hljs-comment">// [esp+14h] [ebp-4Ch]</span><br>  <span class="hljs-type">char</span> baseTable[<span class="hljs-number">68</span>]; <span class="hljs-comment">// [esp+18h] [ebp-48h] BYREF</span><br><br>  v8 = <span class="hljs-number">0</span>;<br>  <span class="hljs-built_in">strcpy</span>(baseTable, <span class="hljs-string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span>);<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; length; i += <span class="hljs-number">3</span> )<br>  &#123;<br>    code3 = baseTable[((*(i + input + <span class="hljs-number">1</span>) &gt;&gt; <span class="hljs-number">4</span>) | (<span class="hljs-number">16</span> * *(i + input))) &amp; <span class="hljs-number">63</span>];<span class="hljs-comment">// baseTable[((input[i+1]&gt;&gt;4)|(input[i]&lt;&lt;4))&amp;63]</span><br>    <span class="hljs-keyword">if</span> ( i + <span class="hljs-number">1</span> &gt;= length )<br>      code3 = <span class="hljs-string">&#x27;=&#x27;</span>;<br>    <span class="hljs-keyword">else</span><br>      code2 = baseTable[((*(i + input + <span class="hljs-number">2</span>) &gt;&gt; <span class="hljs-number">6</span>) | (<span class="hljs-number">4</span> * *(i + input + <span class="hljs-number">1</span>))) &amp; <span class="hljs-number">63</span>];<span class="hljs-comment">// baseTable[((input[i+2]&gt;&gt;6)|(input[i+1]&lt;&lt;2))&amp;63]</span><br>    <span class="hljs-keyword">if</span> ( i + <span class="hljs-number">2</span> &gt;= length )<br>      code4 = <span class="hljs-string">&#x27;=&#x27;</span>;<br>    <span class="hljs-keyword">else</span><br>      code4 = baseTable[*(i + input + <span class="hljs-number">2</span>) &amp; <span class="hljs-number">63</span>]; <span class="hljs-comment">// baseTable[input[i+2]&amp;63]</span><br>    *(v8 + output) = baseTable[(*(i + input) &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">63</span>];<span class="hljs-comment">// baseTable[(input[i]&gt;&gt;2)&amp;63]</span><br>    v9 = v8 + <span class="hljs-number">1</span>;<br>    *(v9 + output) = code2;<br>    *(++v9 + output) = code3;<br>    *(++v9 + output) = code4;<br>    v8 = v9 + <span class="hljs-number">1</span>;<br>    result = i + <span class="hljs-number">3</span>;<br>  &#125;<br>  *(v8 + output) = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>æ ‡å‡†base64ç¼–ç æ˜¯æŒ‰ç…§å­—ç¬¦é¡ºåºï¼ŒæŠŠ3ä¸ª8bitçš„charè½¬æˆ4ä¸ª6bitï¼Œå³</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs C">code1=baseTable[input[i]&gt;&gt;<span class="hljs-number">2</span>];<br>code2=baseTable[(input[i]&lt;&lt;<span class="hljs-number">6</span>)|(input[i+<span class="hljs-number">1</span>]&gt;&gt;<span class="hljs-number">4</span>)];<br>code3=baseTable[(input[i+<span class="hljs-number">1</span>]&lt;&lt;<span class="hljs-number">4</span>)|(input[i+<span class="hljs-number">2</span>]&gt;&gt;<span class="hljs-number">6</span>)];<br>code4=baseTable[input[i+<span class="hljs-number">2</span>]&lt;&lt;<span class="hljs-number">2</span>];<br></code></pre></td></tr></table></figure>

<p>è€Œç¨‹åºé‡Œcode2å’Œcode3é¡ºåºåäº†</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs C">code1=baseTable[(input[i]&gt;&gt;<span class="hljs-number">2</span>)&amp;<span class="hljs-number">63</span>];<br>code2=baseTable[((input[i+<span class="hljs-number">1</span>]&lt;&lt;<span class="hljs-number">2</span>)|(input[i+<span class="hljs-number">2</span>]&gt;&gt;<span class="hljs-number">6</span>))&amp;<span class="hljs-number">63</span>];<br>code3=baseTable[((input[i]&lt;&lt;<span class="hljs-number">4</span>)|(input[i+<span class="hljs-number">1</span>]&gt;&gt;<span class="hljs-number">4</span>))&amp;<span class="hljs-number">63</span>];<br>code4=baseTable[input[i+<span class="hljs-number">2</span>]&amp;<span class="hljs-number">63</span>];<br><span class="hljs-comment">//PSï¼šè¿™é‡Œå› ä¸º&amp;äº†63ï¼Œæ‰€ä»¥æ‹¼æˆ8ä½çš„codeè¢«æˆªæ‰äº†é«˜2ä½ï¼Œå‰©ä¸‹6ä½</span><br></code></pre></td></tr></table></figure>

<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œç¨‹åºçš„é­”æ”¹base64ç¼–ç å’Œæ ‡å‡†base64ç¼–ç çš„ä¸åŒç‚¹åœ¨äºï¼Œç¼–ç æ—¶ç½®æ¢äº†ç¬¬2ã€3ä¸ªå­—ç¬¦ã€‚å› æ­¤æˆ‘ä»¬æ­¤å¤„çš„è§£å¯†å°±æ˜¯æŠŠæ¯4ä¸ªå­—ç¬¦çš„ç¬¬2ã€3ä¸ªå­—ç¬¦äº’æ¢ä½ç½®ï¼Œç„¶åä½¿ç”¨æ ‡å‡†base64è§£ç å³å¯ã€‚ä¸‹é¢æ˜¯basedecodeçš„è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><br>enc=[<span class="hljs-number">0x4D</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x3D</span>]<br>basedecoded=<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(enc),<span class="hljs-number">4</span>):<br>    basedecoded+=<span class="hljs-built_in">chr</span>(enc[i])<br>    basedecoded+=<span class="hljs-built_in">chr</span>(enc[i+<span class="hljs-number">2</span>])<br>    basedecoded+=<span class="hljs-built_in">chr</span>(enc[i+<span class="hljs-number">1</span>])<br>    basedecoded+=<span class="hljs-built_in">chr</span>(enc[i+<span class="hljs-number">3</span>])<br><span class="hljs-built_in">print</span>(basedecoded)<br><span class="hljs-comment">#MPADcG3tP3Q4v3MpNbB1PGWxcHctvHx1NaV9JTPtaSc57iIlNu5xJWS5Imw=</span><br>xorencoded=base64.b64decode(basedecoded)<br></code></pre></td></tr></table></figure>

<p>æ¥ä¸‹æ¥æ˜¯XORdecryptã€‚é¦–å…ˆéœ€è¦å¾—åˆ°å¯†é’¥ï¼Œæ—¢ç„¶ç¨‹åºç»™äº†å¯†é’¥çš„æ£€éªŒç®—æ³•ï¼Œå¯ä»¥å¤ç°è¿™ä¸ªç®—æ³•æ¥çˆ†ç ´å¯†é’¥ã€‚ä¸‹é¢æ˜¯çˆ†ç ´è„šæœ¬ï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs C"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> __ROL4__(x, y)   ((((x) <span class="hljs-string">&lt;&lt; (y)) | ((x) &gt;</span>&gt; (32 - (y))))&amp;0xFFFFFFFF)</span><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v9,key;<br>    <span class="hljs-keyword">for</span>(key=<span class="hljs-number">0</span>;key&lt;=<span class="hljs-number">0xFFFFFFFF</span>;key++)&#123;<br>        v9 = <span class="hljs-number">0x81428113</span>;<br>        <span class="hljs-keyword">for</span> ( <span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; ++i )<br>        &#123;<br>            v9 = <span class="hljs-number">0x1421043</span> * v9 + <span class="hljs-number">0x43298815</span>;<br>            v9 ^= __ROL4__(key, i * (<span class="hljs-number">8</span> + <span class="hljs-number">5</span>) % (<span class="hljs-number">9</span> + <span class="hljs-number">5</span> + <span class="hljs-number">6</span> * <span class="hljs-number">9</span> + <span class="hljs-number">0</span> * (<span class="hljs-number">3</span> + <span class="hljs-number">7</span> + <span class="hljs-number">4</span>) - <span class="hljs-number">6</span> * <span class="hljs-number">6</span>));<br>        &#125;<br>        <span class="hljs-keyword">if</span> ( v9 == <span class="hljs-number">0xA745DA5D</span> )<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;key: 0x%08x\n&quot;</span>,key);<br>        &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><span class="hljs-comment">//key: 0x98bf3b77</span><br></code></pre></td></tr></table></figure>

<p>ç„¶åæ˜¯XORè§£å¯†ï¼Œç”±äºå¼‚æˆ–è¿‡ç¨‹ä¸­ä¸æ¶‰åŠå¯†æ–‡å‰åä½ï¼Œåªæ˜¯å•çº¯ä½¿ç”¨keyï¼Œæ‰€ä»¥åªéœ€è¦å¤ç°å¼‚æˆ–è¿‡ç¨‹å°±è¡Œäº†ã€‚ä½†æ˜¯ç…§æŠ„ä¹Ÿä¸æ˜¯å¾ˆå¯¹ï¼ŒXORencryptä½¿ç”¨keyçš„æ—¶å€™æ˜¯è¿›è¡Œäº†å–ä½æ“ä½œï¼ŒæŠŠkeyåˆ†æˆäº†å››ä¸ªéƒ¨åˆ†çš„ï¼Œæ‰€ä»¥è¿™éƒ¨åˆ†è¦å•ç‹¬æ‹¿å‡ºæ¥å¤„ç†ã€‚è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">XORdecrypt</span>(<span class="hljs-params">data, key</span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">44</span>):<br>        key_byte=(key &gt;&gt; (<span class="hljs-number">8</span> * (i % <span class="hljs-number">4</span>)))&amp;<span class="hljs-number">0xff</span><span class="hljs-comment">#å•ç‹¬å¤„ç†æ¯æ¬¡ä½¿ç”¨çš„keyï¼Œæ¯æ¬¡åªå–å››åˆ†ä¹‹ä¸€ï¼Œç›´æ¥æŠ„åŸä»£ç æ²¡æœ‰&amp;0xffçš„è¯ä¼šè§£å¯†å¤±è´¥ã€‚</span><br>        data[i]^=key_byte<br>        data[i]=data[i]&amp;<span class="hljs-number">0xff</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">44</span>):<br>        key_byte=(key &gt;&gt; (<span class="hljs-number">8</span> * (j % <span class="hljs-number">4</span>)))&amp;<span class="hljs-number">0xff</span><br>        data[j]^=((key_byte &gt;&gt; <span class="hljs-number">4</span>) | (<span class="hljs-number">16</span> * key_byte))<br>        data[j]=data[j]&amp;<span class="hljs-number">0xff</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(data)<br></code></pre></td></tr></table></figure>

<p>å®Œæ•´è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">XORdecrypt</span>(<span class="hljs-params">data, key</span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">44</span>):<br>        key_byte=(key &gt;&gt; (<span class="hljs-number">8</span> * (i % <span class="hljs-number">4</span>)))&amp;<span class="hljs-number">0xff</span><br>        data[i]^=key_byte<br>        data[i]=data[i]&amp;<span class="hljs-number">0xff</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">44</span>):<br>        key_byte=(key &gt;&gt; (<span class="hljs-number">8</span> * (j % <span class="hljs-number">4</span>)))&amp;<span class="hljs-number">0xff</span><br>        data[j]^=((key_byte &gt;&gt; <span class="hljs-number">4</span>) | (<span class="hljs-number">16</span> * key_byte))<br>        data[j]=data[j]&amp;<span class="hljs-number">0xff</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(data)<br><br>enc=[<span class="hljs-number">0x4D</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x3D</span>]<br>basedecoded=<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(enc),<span class="hljs-number">4</span>):<br>    basedecoded+=<span class="hljs-built_in">chr</span>(enc[i])<br>    basedecoded+=<span class="hljs-built_in">chr</span>(enc[i+<span class="hljs-number">2</span>])<br>    basedecoded+=<span class="hljs-built_in">chr</span>(enc[i+<span class="hljs-number">1</span>])<br>    basedecoded+=<span class="hljs-built_in">chr</span>(enc[i+<span class="hljs-number">3</span>])<br><span class="hljs-comment">#print(basedecoded)</span><br>xorencoded=base64.b64decode(basedecoded)<br><span class="hljs-comment">#print(len(xorencoded))</span><br>flag=XORdecrypt(<span class="hljs-built_in">list</span>(xorencoded),<span class="hljs-number">0x98bf3b77</span>)<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure></li>
</ul>
<blockquote>
<p>flagï¼š0xGame{e8778581-e94f-48d5-943e-69ff46f54d1f}</p>
</blockquote>
<h2 id="äº‘æ¶ˆé›¾æ•£"><a href="#äº‘æ¶ˆé›¾æ•£" class="headerlink" title="äº‘æ¶ˆé›¾æ•£"></a>äº‘æ¶ˆé›¾æ•£</h2><blockquote>
<p>è€ƒç‚¹ï¼šå¤æ‚ç¨‹åºåˆ†æï¼Œé­”æ”¹RC4</p>
<p>éš¾ç‚¹åœ¨äºå¤æ‚ï¼Œæ²¡æœ‰å…¶ä»–å¥—è·¯</p>
</blockquote>
<ul>
<li><p>é™„ä»¶ç»™äº†ä¸€ä¸ªimg.exeå’Œenc.bmpã€‚bmpæ˜¯ä¸€ç§å›¾ç‰‡æ ¼å¼ï¼Œæ¨æµ‹img.exeæ˜¯bmpå›¾ç‰‡åŠ å¯†ç¨‹åºï¼Œenc.bmpæ˜¯åŠ å¯†çš„å›¾ç‰‡ï¼Œè¦æ±‚é€†å‘åŠ å¯†ç¨‹åºè¿›è€Œè§£å¯†å›¾ç‰‡</p>
</li>
<li><p>img.exeç”¨IDAæ‰“å¼€ï¼Œshift+F12å¯ä»¥æ‰¾åˆ°â€enc.bmpâ€</p>
<p><img src="/../images/image-20251115195827438.png" alt="å­—ç¬¦ä¸²è¡¨çš„enc.bmp"></p>
<p>è·Ÿè¸ªå¯ä»¥åˆ°è¿™æ ·ä¸€ä¸ªå‡½æ•°</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs C">__int64 __fastcall <span class="hljs-title function_">sub_140001936</span><span class="hljs-params">(<span class="hljs-type">int</span> a1, <span class="hljs-type">int</span> a2)</span><br>&#123;<br>  <span class="hljs-type">int</span> v2; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v3; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v4; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v5; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v6; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v7; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v8; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v9; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v10; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v11; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v12; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v13; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v14; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v15; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v16; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v17; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v18; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v19; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v20; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v21; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v22; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v23; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v24; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v25; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v26; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v27; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v28; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v29; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v30; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v31; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v32; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v33; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v34; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v35; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v36; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v37; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v38; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v39; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v40; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v41; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v42; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v43; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v44; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v45; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v46; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v47; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v48; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v49; <span class="hljs-comment">// r9d</span><br>  __int64 v51; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v52; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v53; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v54; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v55; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v56; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v57; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v58; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v59; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v60; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v61; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v62; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v63; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v64; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v65; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v66; <span class="hljs-comment">// [rsp+8h] [rbp-78h]</span><br>  __int64 v67; <span class="hljs-comment">// [rsp+10h] [rbp-70h]</span><br>  _BYTE v68[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [rsp+20h] [rbp-60h] BYREF</span><br>  _BYTE v69[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [rsp+40h] [rbp-40h] BYREF</span><br>  _BYTE v70[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [rsp+60h] [rbp-20h] BYREF</span><br>  _BYTE v71[<span class="hljs-number">44</span>]; <span class="hljs-comment">// [rsp+80h] [rbp+0h] BYREF</span><br>  <span class="hljs-type">char</span> v72; <span class="hljs-comment">// [rsp+ACh] [rbp+2Ch] BYREF</span><br>  <span class="hljs-type">char</span> v73; <span class="hljs-comment">// [rsp+ADh] [rbp+2Dh] BYREF</span><br>  <span class="hljs-type">char</span> v74; <span class="hljs-comment">// [rsp+AEh] [rbp+2Eh] BYREF</span><br>  <span class="hljs-type">char</span> v75; <span class="hljs-comment">// [rsp+AFh] [rbp+2Fh] BYREF</span><br>  _BYTE v76[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [rsp+B0h] [rbp+30h] BYREF</span><br>  _BYTE v77[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [rsp+D0h] [rbp+50h] BYREF</span><br>  _BYTE v78[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [rsp+F0h] [rbp+70h] BYREF</span><br>  _BYTE v79[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [rsp+110h] [rbp+90h] BYREF</span><br>  <span class="hljs-type">char</span> *v80; <span class="hljs-comment">// [rsp+130h] [rbp+B0h]</span><br>  <span class="hljs-type">char</span> *v81; <span class="hljs-comment">// [rsp+138h] [rbp+B8h]</span><br>  <span class="hljs-type">char</span> *v82; <span class="hljs-comment">// [rsp+140h] [rbp+C0h]</span><br>  <span class="hljs-type">char</span> *v83; <span class="hljs-comment">// [rsp+148h] [rbp+C8h]</span><br><br>  sub_140001D70();<br>  v83 = &amp;v72;<br>  sub_140004130(a1, a2, <span class="hljs-string">&quot;E:\\WorkSpace\\Lab\\0xGame 2025&quot;</span>, v71, &amp;v72, v2);<br>  sub_140003580(a1, a2, v3, &amp;v72, v4, v5);<br>  v82 = &amp;v73;<br>  sub_140004130(a1, a2, <span class="hljs-string">&quot;flag.bmp&quot;</span>, v70, &amp;v73, v6);<br>  sub_140003580(a1, a2, v7, &amp;v73, v8, v9);<br>  v81 = &amp;v74;<br>  sub_140004130(a1, a2, <span class="hljs-string">&quot;enc.bmp&quot;</span>, v69, &amp;v74, v10);<br>  sub_140003580(a1, a2, v11, &amp;v74, v12, v13);<br>  v80 = &amp;v75;<br>  sub_140004130(a1, a2, <span class="hljs-string">&quot;114514puiqneravcixpbhqn;afnv-92piwgspdifjv&quot;</span>, v68, &amp;v75, v14);<br>  sub_140003580(a1, a2, v15, &amp;v75, v16, v17);<br>  sub_140004670(a1, a2, v71, v77, <span class="hljs-string">&quot;\\&quot;</span>, v18, v51);<br>  sub_140004620(a1, a2, v77, v76, v70, v19, v52);<br>  sub_140004210(a1, a2, v76, v70, v20, v21, v53);<br>  sub_1400041E0(a1, a2, v22, v76, v23, v24, v54);<br>  sub_1400041E0(a1, a2, v25, v77, v26, v27, v55);<br>  sub_140004670(a1, a2, v71, v79, <span class="hljs-string">&quot;\\&quot;</span>, v28, v56);<br>  sub_140004620(a1, a2, v79, v78, v69, v29, v57);<br>  sub_140004210(a1, a2, v78, v69, v30, v31, v58);<br>  sub_1400041E0(a1, a2, v32, v78, v33, v34, v59);<br>  sub_1400041E0(a1, a2, v35, v79, v36, v37, v60);<br>  sub_14000164D(a1, a2, v69, v70, v68, <span class="hljs-number">1</span>, v61, v66, v67);<br>  sub_1400041E0(a1, a2, v38, v68, v39, v40, v62);<br>  sub_1400041E0(a1, a2, v41, v69, v42, v43, v63);<br>  sub_1400041E0(a1, a2, v44, v70, v45, v46, v64);<br>  sub_1400041E0(a1, a2, v47, v71, v48, v49, v65);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>å€ŸåŠ©AIå¯ä»¥ä¼˜åŒ–å¾—åˆ°ï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs C">__int64 __fastcall <span class="hljs-title function_">sub_140001936</span><span class="hljs-params">(<span class="hljs-type">char</span> *input, <span class="hljs-type">char</span> *output)</span><br>&#123;<br>  <span class="hljs-type">int</span> v2; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v3; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v4; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v5; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v6; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v7; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v8; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v9; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v10; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v11; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v12; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v13; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v14; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v15; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v16; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v17; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v18; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v19; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v20; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v21; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v22; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v23; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v24; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v25; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v26; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v27; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v28; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v29; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v30; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v31; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v32; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v33; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v34; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v35; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v36; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v37; <span class="hljs-comment">// r9d</span><br>  _BYTE v39[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [rsp+20h] [rbp-60h] BYREF</span><br>  _BYTE outputFilename[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [rsp+40h] [rbp-40h] BYREF</span><br>  _BYTE v41[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [rsp+60h] [rbp-20h] BYREF</span><br>  _BYTE v42[<span class="hljs-number">44</span>]; <span class="hljs-comment">// [rsp+80h] [rbp+0h] BYREF</span><br>  <span class="hljs-type">char</span> v43; <span class="hljs-comment">// [rsp+ACh] [rbp+2Ch] BYREF</span><br>  <span class="hljs-type">char</span> v44; <span class="hljs-comment">// [rsp+ADh] [rbp+2Dh] BYREF</span><br>  <span class="hljs-type">char</span> v45; <span class="hljs-comment">// [rsp+AEh] [rbp+2Eh] BYREF</span><br>  <span class="hljs-type">char</span> v46; <span class="hljs-comment">// [rsp+AFh] [rbp+2Fh] BYREF</span><br>  _BYTE v47[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [rsp+B0h] [rbp+30h] BYREF</span><br>  _BYTE v48[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [rsp+D0h] [rbp+50h] BYREF</span><br>  _BYTE v49[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [rsp+F0h] [rbp+70h] BYREF</span><br>  _BYTE v50[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [rsp+110h] [rbp+90h] BYREF</span><br>  <span class="hljs-type">char</span> *v51; <span class="hljs-comment">// [rsp+130h] [rbp+B0h]</span><br>  <span class="hljs-type">char</span> *v52; <span class="hljs-comment">// [rsp+138h] [rbp+B8h]</span><br>  <span class="hljs-type">char</span> *v53; <span class="hljs-comment">// [rsp+140h] [rbp+C0h]</span><br>  <span class="hljs-type">char</span> *v54; <span class="hljs-comment">// [rsp+148h] [rbp+C8h]</span><br><br>  sub_140001D70();<br>  v54 = &amp;v43;<br>  constructString(input, output, <span class="hljs-string">&quot;E:\\WorkSpace\\Lab\\0xGame 2025&quot;</span>, v42, &amp;v43, v2);<br>  nothing();                                    <span class="hljs-comment">// ä»€ä¹ˆä¹Ÿæ²¡æœ‰çš„ä¸€ä¸ªå‡½æ•°</span><br>  v53 = &amp;v44;<br>  constructString(input, output, <span class="hljs-string">&quot;flag.bmp&quot;</span>, v41, &amp;v44, v3);<br>  nothing();<br>  v52 = &amp;v45;<br>  constructString(input, output, <span class="hljs-string">&quot;enc.bmp&quot;</span>, outputFilename, &amp;v45, v4);<br>  nothing();<br>  v51 = &amp;v46;<br>  constructString(input, output, <span class="hljs-string">&quot;114514puiqneravcixpbhqn;afnv-92piwgspdifjv&quot;</span>, v39, &amp;v46, v5);<br>  nothing();<br>  makePath1(input, output, v42, v48, <span class="hljs-string">&quot;\\&quot;</span>, v6);<br>  makePath2(input, output, v48, v47, v41, v7);<br>  makePath3(input, output, v47, v41, v8, v9);<br>  clearup(input, output, v10, v47, v11, v12);<br>  clearup(input, output, v13, v48, v14, v15);<br>  makePath1(input, output, v42, v50, <span class="hljs-string">&quot;\\&quot;</span>, v16);<br>  makePath2(input, output, v50, v49, outputFilename, v17);<br>  makePath3(input, output, v49, outputFilename, v18, v19);<br>  clearup(input, output, v20, v49, v21, v22);<br>  clearup(input, output, v23, v50, v24, v25);<br>  encrypt(input, output, outputFilename, v41, v39, <span class="hljs-number">1</span>);<br>  clearup(input, output, v26, v39, v27, v28);<br>  clearup(input, output, v29, outputFilename, v30, v31);<br>  clearup(input, output, v32, v41, v33, v34);<br>  clearup(input, output, v35, v42, v36, v37);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>è¿™é‡Œå®é™…ä¸Šæ˜¯åœ¨åˆå§‹åŒ–æ–‡ä»¶ç›¸å…³çš„ä¿¡æ¯ï¼Œç¨‹åºåº”è¯¥æ˜¯ä»E:\WorkSpace\Lab\0xGame 2025ä¸‹è·å–flag.bmpï¼ŒåŠ å¯†åè¾“å‡ºä¸ºenc.bmpã€‚é‚£ä¸€ä¸²å­—ç¬¦ä¸²åº”è¯¥æ˜¯encryptå‡½æ•°ä½¿ç”¨çš„å¯†é’¥ã€‚encpytå‡½æ•°ä¼˜åŒ–åæ˜¯è¿™æ ·çš„ï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs C">__int64 __fastcall <span class="hljs-title function_">encrypt</span><span class="hljs-params">(</span><br><span class="hljs-params">        <span class="hljs-built_in">std</span>::istream *input,</span><br><span class="hljs-params">        <span class="hljs-type">char</span> *output,</span><br><span class="hljs-params">        __int64 outputFilename,</span><br><span class="hljs-params">        __int64 inputfilename,</span><br><span class="hljs-params">        __int64 a5,</span><br><span class="hljs-params">        <span class="hljs-type">char</span> a6)</span><br>&#123;<br>  __int64 v6; <span class="hljs-comment">// rdx</span><br>  __int64 v7; <span class="hljs-comment">// rdx</span><br>  __int64 v9; <span class="hljs-comment">// rax</span><br>  __int64 v10; <span class="hljs-comment">// rdx</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v11; <span class="hljs-comment">// ebx</span><br>  <span class="hljs-type">int</span> v12; <span class="hljs-comment">// eax</span><br>  __int64 v13; <span class="hljs-comment">// rdx</span><br>  __int64 v14; <span class="hljs-comment">// rdx</span><br>  __int64 v15; <span class="hljs-comment">// rdx</span><br>  __int64 v17; <span class="hljs-comment">// [rsp+20h] [rbp-60h] BYREF</span><br>  <span class="hljs-type">int</span> v18; <span class="hljs-comment">// [rsp+28h] [rbp-58h]</span><br>  <span class="hljs-type">unsigned</span> __int16 v19; <span class="hljs-comment">// [rsp+2Eh] [rbp-52h]</span><br>  __int64 v20; <span class="hljs-comment">// [rsp+52h] [rbp-2Eh] BYREF</span><br>  _BYTE output_file_buffer[<span class="hljs-number">224</span>]; <span class="hljs-comment">// [rsp+60h] [rbp-20h] BYREF</span><br>  __int64 v22; <span class="hljs-comment">// [rsp+140h] [rbp+C0h] BYREF</span><br>  _BYTE input_file_buffer[<span class="hljs-number">232</span>]; <span class="hljs-comment">// [rsp+250h] [rbp+1D0h] BYREF</span><br>  __int64 v24; <span class="hljs-comment">// [rsp+338h] [rbp+2B8h] BYREF</span><br>  __int64 outputBuffer; <span class="hljs-comment">// [rsp+448h] [rbp+3C8h]</span><br>  __int64 v26; <span class="hljs-comment">// [rsp+450h] [rbp+3D0h]</span><br>  <span class="hljs-type">int</span> v27; <span class="hljs-comment">// [rsp+45Ch] [rbp+3DCh]</span><br>  __int64 header_buffer; <span class="hljs-comment">// [rsp+460h] [rbp+3E0h]</span><br>  __int64 header_buffer_size; <span class="hljs-comment">// [rsp+468h] [rbp+3E8h]</span><br><br>  <span class="hljs-built_in">std</span>::ifstream::basic_ifstream(input, output, inputfilename, input_file_buffer, <span class="hljs-number">4LL</span>);<br>  <span class="hljs-built_in">std</span>::ofstream::basic_ofstream(input, output, outputFilename, output_file_buffer, <span class="hljs-number">4LL</span>);<br>  <span class="hljs-keyword">if</span> ( <span class="hljs-built_in">std</span>::ios::operator!(input, output, v6, &amp;v24) || <span class="hljs-built_in">std</span>::ios::operator!(input, output, v7, &amp;v22) )<br>  &#123;                                             <span class="hljs-comment">// é”™è¯¯å¤„ç†</span><br>    v9 = <span class="hljs-built_in">std</span>::operator&lt;&lt;&lt;<span class="hljs-built_in">std</span>::char_traits&lt;<span class="hljs-type">char</span>&gt;&gt;(input, output, &amp;unk_7FF770D06000, &amp;<span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span>);<br>    <span class="hljs-built_in">std</span>::ostream::operator&lt;&lt;(input, output, &amp;<span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>&lt;<span class="hljs-type">char</span>,<span class="hljs-built_in">std</span>::char_traits&lt;<span class="hljs-type">char</span>&gt;&gt;, v9);<br>    v11 = <span class="hljs-number">0</span>;<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    header_buffer_size = <span class="hljs-number">1024LL</span>;<br>    header_buffer = operator new[](input);<br>    <span class="hljs-built_in">std</span>::istream::read(input, output, &amp;v20);    <span class="hljs-comment">// è·å–bitmap_file_header</span><br>    <span class="hljs-built_in">std</span>::istream::read(input, output, &amp;v17);    <span class="hljs-comment">// è·å–bitmap_info_header</span><br>    <span class="hljs-built_in">std</span>::istream::read(input, output, header_buffer);<br>    <span class="hljs-built_in">std</span>::ostream::write(input, output, &amp;v20);<br>    <span class="hljs-built_in">std</span>::ostream::write(input, output, &amp;v17);<br>    <span class="hljs-built_in">std</span>::ostream::write(input, output, header_buffer);<br>    <span class="hljs-keyword">if</span> ( header_buffer )<br>      operator delete[](input);<br>    v12 = HIDWORD(v17) * v19 + <span class="hljs-number">31</span>;<br>    <span class="hljs-keyword">if</span> ( v12 &lt; <span class="hljs-number">0</span> )<br>      v12 = HIDWORD(v17) * v19 + <span class="hljs-number">62</span>;<br>    v27 = <span class="hljs-number">4</span> * (v12 &gt;&gt; <span class="hljs-number">5</span>);<br>    v26 = (v27 * abs32(v18));<br>    outputBuffer = operator new[](input);<br>    <span class="hljs-built_in">std</span>::istream::read(input, output, outputBuffer);<br>    <span class="hljs-built_in">std</span>::ifstream::close(input, output, v13, input_file_buffer);<br>    <span class="hljs-keyword">if</span> ( a6 )<br>      modifiedRC4(input, output, v26, outputBuffer, a5);<br>    <span class="hljs-built_in">std</span>::ostream::write(input, output, outputBuffer);<br>    <span class="hljs-built_in">std</span>::ofstream::close(input, output, v14, output_file_buffer);<br>    <span class="hljs-keyword">if</span> ( outputBuffer )<br>      operator delete[](input);<br>    v11 = <span class="hljs-number">1</span>;<br>  &#125;<br>  <span class="hljs-built_in">std</span>::ofstream::~ofstream(input, output, v10, output_file_buffer);<br>  <span class="hljs-built_in">std</span>::ifstream::~ifstream(input, output, v15, input_file_buffer);<br>  <span class="hljs-keyword">return</span> v11;<br>&#125;<br><br><span class="hljs-comment">//modifiedRC4</span><br>__int64 __fastcall <span class="hljs-title function_">modifiedRC4</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> *a1, __int64 a2, <span class="hljs-type">int</span> numOfDataBytes, __int64 outputBuffer, __int64 a5)</span><br>&#123;<br>  <span class="hljs-type">unsigned</span> __int64 v5; <span class="hljs-comment">// rax</span><br>  _BYTE *v6; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">char</span> v7; <span class="hljs-comment">// dl</span><br>  __int64 result; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [rsp+24h] [rbp-Ch]</span><br>  <span class="hljs-type">int</span> j; <span class="hljs-comment">// [rsp+24h] [rbp-Ch]</span><br>  <span class="hljs-type">int</span> k; <span class="hljs-comment">// [rsp+24h] [rbp-Ch]</span><br>  <span class="hljs-type">int</span> j_sbox; <span class="hljs-comment">// [rsp+28h] [rbp-8h]</span><br>  <span class="hljs-type">int</span> j_; <span class="hljs-comment">// [rsp+28h] [rbp-8h]</span><br>  <span class="hljs-type">int</span> i_sbox; <span class="hljs-comment">// [rsp+2Ch] [rbp-4h]</span><br>  <span class="hljs-type">int</span> i_; <span class="hljs-comment">// [rsp+2Ch] [rbp-4h]</span><br><br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">255</span>; ++i )<br>    S[i] = i;<br>  i_sbox = <span class="hljs-number">0</span>;<br>  j_sbox = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">for</span> ( j = <span class="hljs-number">0</span>; j &lt;= <span class="hljs-number">255</span>; ++j )<br>  &#123;<br>    i_sbox = (i_sbox + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span>;<br>    a2 = S[i_sbox] + j_sbox;<br>    v5 = sub_7FF770D032B0(a1, a2, j_sbox, a5);<br>    v6 = sub_7FF770D033D0(a1, a2, i_sbox % v5, a5);<br>    v7 = a2 + *v6;<br>    LODWORD(v6) = ((a2 + *v6) &gt;&gt; <span class="hljs-number">31</span>) &gt;&gt; <span class="hljs-number">24</span>;<br>    j_sbox = (v6 + v7) - v6;<br>    swapbytes(a1, a2, &amp;S[j_sbox], &amp;S[i_sbox]);<br>  &#125;<br>  i_ = <span class="hljs-number">0</span>;<br>  j_ = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">for</span> ( k = <span class="hljs-number">0</span>; ; ++k )<br>  &#123;<br>    result = ((numOfDataBytes / <span class="hljs-number">256</span>) &lt;&lt; <span class="hljs-number">8</span>);<br>    <span class="hljs-keyword">if</span> ( k &gt;= result )<br>      <span class="hljs-keyword">break</span>;<br>    i_ = (i_ + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span>;<br>    j_ = (S[i_] + j_) % <span class="hljs-number">256</span>;<br>    swapbytes(a1, a2, &amp;S[j_], &amp;S[i_]);<br>    swapBytes(<br>      a1,<br>      a2,<br>      (((k / <span class="hljs-number">256</span>) &lt;&lt; <span class="hljs-number">8</span>) + j_ + outputBuffer),   <span class="hljs-comment">// outputBuffer[((k/256)&lt;&lt;8)+j_]</span><br>      (outputBuffer + ((k / <span class="hljs-number">256</span>) &lt;&lt; <span class="hljs-number">8</span>) + i_));  <span class="hljs-comment">// outputBuffer[((k/256)&lt;&lt;8)+i_]</span><br>  &#125;<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>ä»IDAçš„åç¼–è¯‘ç»“æœé‡Œå¯ä»¥å¾—åˆ°ä¸€äº›å¤§è‡´çš„å°è±¡ï¼šencryptå‡½æ•°åˆšå¼€å§‹å¯¹æ–‡ä»¶è¿›è¡Œäº†ä¸‰æ¬¡è¯»ä¸å†™ï¼Œé‡‡ç”¨çš„åŠ å¯†æ–¹å¼æ˜¯ç±»ä¼¼RC4çš„ç®—æ³•ï¼Œä½†æ˜¯ç›¸è¾ƒäºæ ‡å‡†RC4ï¼Œæ­¤å¤„åªæ˜¯å•çº¯çš„ç½®æ¢ï¼Œæ²¡æœ‰å¼‚æˆ–æ“ä½œã€‚ä¸ºäº†è¿›ä¸€æ­¥ç†è§£ç¨‹åºï¼Œæ¥ä¸‹æ¥å…ˆç ”ç©¶è¯»å†™æ–‡ä»¶çš„æ“ä½œé€»è¾‘ã€‚</p>
<p>ç®€å•äº†è§£ä¸€ä¸‹bmpæ–‡ä»¶æ ¼å¼ï¼Œå¯ä»¥çŸ¥é“æ–‡ä»¶å¼€å¤´å‰0x36hæ˜¯æ–‡ä»¶å¤´ï¼Œè¿™ä¸€éƒ¨åˆ†è‚¯å®šæ˜¯ä¸ä¼šæ€ä¹ˆå˜çš„ï¼Œå¦åˆ™å°±ä¼šæ”¹å˜æ–‡ä»¶çš„æ ¼å¼äº†ã€‚åœ¨ç”µè„‘é‡Œå¤åˆ»ä¸€ä¸ªä¸€æ‘¸ä¸€æ ·çš„è·¯å¾„ï¼Œè‡ªå·±åˆ›å»ºä¸€ä¸ªflag.bmpè¿è¡Œimg.exeå¯ä»¥å¾—åˆ°enc.bmpï¼Œæ­¤æ—¶ç”¨åå…­è¿›åˆ¶ç¼–è¾‘å™¨æ‰“å¼€ä¸¤ä¸ªæ–‡ä»¶å¯ä»¥å‘ç°å®ƒä»¬ä¹‹é—´å·®äº†1024bytesï¼Œæ›´å‡†ç¡®çš„è¯´ï¼Œæ˜¯åŠ å¯†åçš„æ–‡ä»¶æ¯”åŠ å¯†å‰å¤šäº†1024bytesã€‚</p>
<p>ä¸‹é¢è½¬ç”¨xdbgã€‚å¯¹ç…§IDAå¯ä»¥æ‰¾åˆ°è¯»å†™æ–‡ä»¶çš„ä½ç½®ï¼Œåˆ†æç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs X86asm">00007FF6077B164D | <span class="hljs-number">55</span>                  | <span class="hljs-keyword">PUSH</span> <span class="hljs-built_in">RBP</span>                                                 | encrypt<br>00007FF6077B164E | <span class="hljs-number">53</span>                  | <span class="hljs-keyword">PUSH</span> <span class="hljs-built_in">RBX</span>                                                 |<br>00007FF6077B164F | <span class="hljs-number">48</span>:81EC <span class="hljs-number">78040000</span>    | <span class="hljs-keyword">SUB</span> <span class="hljs-built_in">RSP</span>,<span class="hljs-number">478</span>                                              |<br>00007FF6077B1656 | <span class="hljs-number">48</span>:8DAC24 <span class="hljs-number">80000000</span>  | <span class="hljs-keyword">LEA</span> <span class="hljs-built_in">RBP</span>,<span class="hljs-built_in">QWORD</span> <span class="hljs-built_in">PTR</span> <span class="hljs-built_in">SS</span>:[<span class="hljs-built_in">RSP</span>+<span class="hljs-number">80</span>]                            | [<span class="hljs-built_in">rsp</span>+<span class="hljs-number">80</span>]:_register_onexit_function+<span class="hljs-number">210</span><br>00007FF6077B165E | <span class="hljs-number">48</span>:<span class="hljs-number">898D</span> <span class="hljs-number">10040000</span>    | <span class="hljs-keyword">MOV</span> <span class="hljs-built_in">QWORD</span> <span class="hljs-built_in">PTR</span> <span class="hljs-built_in">SS</span>:[<span class="hljs-built_in">RBP</span>+<span class="hljs-number">410</span>],<span class="hljs-built_in">RCX</span>                           |<br>00007FF6077B1665 | <span class="hljs-number">48</span>:<span class="hljs-number">8995</span> <span class="hljs-number">18040000</span>    | <span class="hljs-keyword">MOV</span> <span class="hljs-built_in">QWORD</span> <span class="hljs-built_in">PTR</span> <span class="hljs-built_in">SS</span>:[<span class="hljs-built_in">RBP</span>+<span class="hljs-number">418</span>],<span class="hljs-built_in">RDX</span>                           |<br>00007FF6077B166C | 4C:<span class="hljs-number">8985</span> <span class="hljs-number">20040000</span>    | <span class="hljs-keyword">MOV</span> <span class="hljs-built_in">QWORD</span> <span class="hljs-built_in">PTR</span> <span class="hljs-built_in">SS</span>:[<span class="hljs-built_in">RBP</span>+<span class="hljs-number">420</span>],<span class="hljs-built_in">R8</span>                            |<br>00007FF6077B1673 | <span class="hljs-number">44</span>:89C8             | <span class="hljs-keyword">MOV</span> <span class="hljs-built_in">EAX</span>,<span class="hljs-built_in">R9D</span>                                              |<br>00007FF6077B1676 | <span class="hljs-number">8885</span> <span class="hljs-number">28040000</span>       | <span class="hljs-keyword">MOV</span> <span class="hljs-built_in">BYTE</span> <span class="hljs-built_in">PTR</span> <span class="hljs-built_in">SS</span>:[<span class="hljs-built_in">RBP</span>+<span class="hljs-number">428</span>],<span class="hljs-built_in">AL</span>                             |<br>00007FF6077B167C | <span class="hljs-number">48</span>:8B95 <span class="hljs-number">10040000</span>    | <span class="hljs-keyword">MOV</span> <span class="hljs-built_in">RDX</span>,<span class="hljs-built_in">QWORD</span> <span class="hljs-built_in">PTR</span> <span class="hljs-built_in">SS</span>:[<span class="hljs-built_in">RBP</span>+<span class="hljs-number">410</span>]                           |<br>00007FF6077B1683 | <span class="hljs-number">48</span>:8D85 D0010000    | <span class="hljs-keyword">LEA</span> <span class="hljs-built_in">RAX</span>,<span class="hljs-built_in">QWORD</span> <span class="hljs-built_in">PTR</span> <span class="hljs-built_in">SS</span>:[<span class="hljs-built_in">RBP</span>+1D0]                           |<br>00007FF6077B168A | <span class="hljs-number">41</span>:B8 <span class="hljs-number">04000000</span>      | <span class="hljs-keyword">MOV</span> <span class="hljs-built_in">R8D</span>,<span class="hljs-number">4</span>                                                |<br>00007FF6077B1690 | <span class="hljs-number">48</span>:89C1             | <span class="hljs-keyword">MOV</span> <span class="hljs-built_in">RCX</span>,<span class="hljs-built_in">RAX</span>                                              | <span class="hljs-built_in">rcx</span>:&amp;<span class="hljs-string">&quot;E:\\WorkSpace\\Lab\\0xGame 2025\\flag.bmp&quot;</span>, <span class="hljs-built_in">rax</span>:&amp;<span class="hljs-string">&quot;E:\\WorkSpace\\Lab\\0xGame 2025\\flag.bmp&quot;</span><br>00007FF6077B1693 | E8 E0050000         | <span class="hljs-keyword">CALL</span> &lt;<span class="hljs-keyword">JMP</span>.&amp;<span class="hljs-keyword">std</span>::basic_ifstream&lt;char, <span class="hljs-keyword">std</span>::char_traits&lt;<span class="hljs-number">ch</span> | é”™è¯¯å¤„ç†<br>00007FF6077B1698 | <span class="hljs-number">48</span>:8B95 <span class="hljs-number">18040000</span>    | <span class="hljs-keyword">MOV</span> <span class="hljs-built_in">RDX</span>,<span class="hljs-built_in">QWORD</span> <span class="hljs-built_in">PTR</span> <span class="hljs-built_in">SS</span>:[<span class="hljs-built_in">RBP</span>+<span class="hljs-number">418</span>]                           |<br>00007FF6077B169F | <span class="hljs-number">48</span>:8D45 E0          | <span class="hljs-keyword">LEA</span> <span class="hljs-built_in">RAX</span>,<span class="hljs-built_in">QWORD</span> <span class="hljs-built_in">PTR</span> <span class="hljs-built_in">SS</span>:[<span class="hljs-built_in">RBP</span>-<span class="hljs-number">20</span>]                            | [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">20</span>]:<span class="hljs-string">&quot;E:\\WorkSpace\\Lab\\0xGame 2025\\flag.bmp&quot;</span><span class="hljs-string">&quot;</span><br><span class="hljs-string">00007FF6077B16A3 | 41:B8 04000000      | MOV R8D,4                                                |</span><br><span class="hljs-string">00007FF6077B16A9 | 48:89C1             | MOV RCX,RAX                                              | rcx:&amp;&quot;</span>E:\\WorkSpace\\Lab\\0xGame <span class="hljs-number">2025</span>\\flag<span class="hljs-number">.</span>bmp<span class="hljs-string">&quot;, rax:&amp;&quot;</span>E:\\WorkSpace\\Lab\\0xGame <span class="hljs-number">2025</span>\\flag<span class="hljs-number">.</span>bmp<span class="hljs-string">&quot;</span><br><span class="hljs-string">00007FF6077B16AC | E8 AF050000         | CALL &lt;JMP.&amp;std::basic_ofstream&lt;char, std::char_traits&lt;ch |</span><br><span class="hljs-string">00007FF6077B16B1 | 48:8D85 D0010000    | LEA RAX,QWORD PTR SS:[RBP+1D0]                           |</span><br><span class="hljs-string">00007FF6077B16B8 | 48:05 E8000000      | ADD RAX,E8                                               | rax:&amp;&quot;</span>E:\\WorkSpace\\Lab\\0xGame <span class="hljs-number">2025</span>\\flag<span class="hljs-number">.</span>bmp<span class="hljs-string">&quot;</span><br><span class="hljs-string">00007FF6077B16BE | 48:89C1             | MOV RCX,RAX                                              | rcx:&amp;&quot;</span>E:\\WorkSpace\\Lab\\0xGame <span class="hljs-number">2025</span>\\flag<span class="hljs-number">.</span>bmp<span class="hljs-string">&quot;, rax:&amp;&quot;</span>E:\\WorkSpace\\Lab\\0xGame <span class="hljs-number">2025</span>\\flag<span class="hljs-number">.</span>bmp<span class="hljs-string">&quot;</span><br><span class="hljs-string">00007FF6077B16C1 | E8 DA050000         | CALL &lt;JMP.&amp;std::basic_ios&lt;char, std::char_traits&lt;char&gt; &gt; |</span><br><span class="hljs-string">00007FF6077B16C6 | 84C0                | TEST AL,AL                                               |</span><br><span class="hljs-string">00007FF6077B16C8 | 75 16               | JNE img.7FF6077B16E0                                     |</span><br><span class="hljs-string">00007FF6077B16CA | 48:8D45 E0          | LEA RAX,QWORD PTR SS:[RBP-20]                            | [rbp-20]:&quot;</span>E:\\WorkSpace\\Lab\\0xGame <span class="hljs-number">2025</span>\\flag<span class="hljs-number">.</span>bmp<span class="hljs-string">&quot;&quot;</span><br>00007FF6077B16CE | <span class="hljs-number">48</span>:<span class="hljs-number">05</span> E0000000      | <span class="hljs-keyword">ADD</span> <span class="hljs-built_in">RAX</span>,E0                                               | <span class="hljs-built_in">rax</span>:&amp;<span class="hljs-string">&quot;E:\\WorkSpace\\Lab\\0xGame 2025\\flag.bmp&quot;</span><br>00007FF6077B16D4 | <span class="hljs-number">48</span>:89C1             | <span class="hljs-keyword">MOV</span> <span class="hljs-built_in">RCX</span>,<span class="hljs-built_in">RAX</span>                                              | <span class="hljs-built_in">rcx</span>:&amp;<span class="hljs-string">&quot;E:\\WorkSpace\\Lab\\0xGame 2025\\flag.bmp&quot;</span>, <span class="hljs-built_in">rax</span>:&amp;<span class="hljs-string">&quot;E:\\WorkSpace\\Lab\\0xGame 2025\\flag.bmp&quot;</span><br>00007FF6077B16D7 | E8 C4050000         | <span class="hljs-keyword">CALL</span> &lt;<span class="hljs-keyword">JMP</span>.&amp;<span class="hljs-keyword">std</span>::basic_ios&lt;char, <span class="hljs-keyword">std</span>::char_traits&lt;char&gt; &gt; |<br>00007FF6077B16DC | 84C0                | <span class="hljs-keyword">TEST</span> <span class="hljs-built_in">AL</span>,<span class="hljs-built_in">AL</span>                                               |<br>00007FF6077B16DE | <span class="hljs-number">74</span> <span class="hljs-number">07</span>               | <span class="hljs-keyword">JE</span> img<span class="hljs-number">.</span>7FF6077B16E7                                      |<br>00007FF6077B16E0 | B8 <span class="hljs-number">01000000</span>         | <span class="hljs-keyword">MOV</span> <span class="hljs-built_in">EAX</span>,<span class="hljs-number">1</span>                                                |<br>00007FF6077B16E5 | EB <span class="hljs-number">05</span>               | <span class="hljs-keyword">JMP</span> img<span class="hljs-number">.</span>7FF6077B16EC                                     |<br>00007FF6077B16E7 | B8 <span class="hljs-number">00000000</span>         | <span class="hljs-keyword">MOV</span> <span class="hljs-built_in">EAX</span>,<span class="hljs-number">0</span>                                                |<br>00007FF6077B16EC | 84C0                | <span class="hljs-keyword">TEST</span> <span class="hljs-built_in">AL</span>,<span class="hljs-built_in">AL</span>                                               |<br>00007FF6077B16EE | <span class="hljs-number">74</span> <span class="hljs-number">32</span>               | <span class="hljs-keyword">JE</span> img<span class="hljs-number">.</span>7FF6077B1722                                      |<br>00007FF6077B16F0 | <span class="hljs-number">48</span>:8D15 <span class="hljs-number">09490000</span>    | <span class="hljs-keyword">LEA</span> <span class="hljs-built_in">RDX</span>,<span class="hljs-built_in">QWORD</span> <span class="hljs-built_in">PTR</span> <span class="hljs-built_in">DS</span>:[7FF6077B6000]                      | <span class="hljs-built_in">rdx</span>:&amp;<span class="hljs-string">&quot;E:\\WorkSpace\\Lab\\0xGame 2025\\enc.bmp&quot;</span>, 00007FF6077B6000:u8<span class="hljs-string">&quot;æ— æ³•æ‰“å¼€æ–‡ä»¶ï¼&quot;</span>ame <span class="hljs-number">2025</span>\\enc<span class="hljs-number">.</span>bmp<span class="hljs-string">&quot;</span><br><span class="hljs-string">00007FF6077B16F7 | 48:8B05 024F0000    | MOV RAX,QWORD PTR DS:[&lt;&amp;std::cerr&gt;]                      | rax:&amp;&quot;</span>E:\\WorkSpace\\Lab\\0xGame <span class="hljs-number">2025</span>\\flag<span class="hljs-number">.</span>bmp<span class="hljs-string">&quot;</span><br><span class="hljs-string">00007FF6077B16FE | 48:89C1             | MOV RCX,RAX                                              | rcx:&amp;&quot;</span>E:\\WorkSpace\\Lab\\0xGame <span class="hljs-number">2025</span>\\flag<span class="hljs-number">.</span>bmp<span class="hljs-string">&quot;, rax:&amp;&quot;</span>E:\\WorkSpace\\Lab\\0xGame <span class="hljs-number">2025</span>\\flag<span class="hljs-number">.</span>bmp<span class="hljs-string">&quot;</span><br><span class="hljs-string">00007FF6077B1701 | E8 22050000         | CALL &lt;JMP.&amp;std::basic_ostream&lt;char, std::char_traits&lt;cha |</span><br><span class="hljs-string">00007FF6077B1706 | 48:89C1             | MOV RCX,RAX                                              | rcx:&amp;&quot;</span>E:\\WorkSpace\\Lab\\0xGame <span class="hljs-number">2025</span>\\flag<span class="hljs-number">.</span>bmp<span class="hljs-string">&quot;, rax:&amp;&quot;</span>E:\\WorkSpace\\Lab\\0xGame <span class="hljs-number">2025</span>\\flag<span class="hljs-number">.</span>bmp<span class="hljs-string">&quot;</span><br><span class="hljs-string">00007FF6077B1709 | 48:8B05 004F0000    | MOV RAX,QWORD PTR DS:[&lt;&amp;JMP.&amp;std::basic_ostream&lt;char, st | rax:&amp;&quot;</span>E:\\WorkSpace\\Lab\\0xGame <span class="hljs-number">2025</span>\\flag<span class="hljs-number">.</span>bmp<span class="hljs-string">&quot;</span><br><span class="hljs-string">00007FF6077B1710 | 48:89C2             | MOV RDX,RAX                                              | rdx:&amp;&quot;</span>E:\\WorkSpace\\Lab\\0xGame <span class="hljs-number">2025</span>\\enc<span class="hljs-number">.</span>bmp<span class="hljs-string">&quot;, rax:&amp;&quot;</span>E:\\WorkSpace\\Lab\\0xGame <span class="hljs-number">2025</span>\\flag<span class="hljs-number">.</span>bmp<span class="hljs-string">&quot;</span><br><span class="hljs-string">00007FF6077B1713 | E8 70050000         | CALL &lt;JMP.&amp;std::ostream::operator&lt;&lt;(std::ostream&amp; (*)(st |</span><br><span class="hljs-string">00007FF6077B1718 | BB 00000000         | MOV EBX,0                                                |</span><br><span class="hljs-string">00007FF6077B171D | E9 BD010000         | JMP img.7FF6077B18DF                                     |</span><br><span class="hljs-string">00007FF6077B1722 | 48:C785 E8030000 00 | MOV QWORD PTR SS:[RBP+3E8],400                           |</span><br><span class="hljs-string">00007FF6077B172D | B9 00040000         | MOV ECX,400                                              |</span><br><span class="hljs-string">00007FF6077B1732 | E8 D9040000         | CALL &lt;JMP.&amp;operator new[](unsigned long long)&gt;           |</span><br><span class="hljs-string">00007FF6077B1737 | 48:8985 E0030000    | MOV QWORD PTR SS:[RBP+3E0],RAX                           |</span><br><span class="hljs-string">00007FF6077B173E | 48:8D55 D2          | LEA RDX,QWORD PTR SS:[RBP-2E]                            | RBP-2Eï¼šè¾“å…¥æµç¼“å†²åŒº1ï¼ˆå­˜æ”¾headerï¼‰</span><br><span class="hljs-string">00007FF6077B1742 | 48:8D85 D0010000    | LEA RAX,QWORD PTR SS:[RBP+1D0]                           |</span><br><span class="hljs-string">00007FF6077B1749 | 41:B8 0E000000      | MOV R8D,E                                                | è¯»å–é•¿åº¦ï¼šEh</span><br><span class="hljs-string">00007FF6077B174F | 48:89C1             | MOV RCX,RAX                                              | rcx:&amp;&quot;</span>E:\\WorkSpace\\Lab\\0xGame <span class="hljs-number">2025</span>\\flag<span class="hljs-number">.</span>bmp<span class="hljs-string">&quot;, rax:&amp;&quot;</span>E:\\WorkSpace\\Lab\\0xGame <span class="hljs-number">2025</span>\\flag<span class="hljs-number">.</span>bmp<span class="hljs-string">&quot;</span><br><span class="hljs-string">00007FF6077B1752 | E8 41050000         | CALL &lt;JMP.&amp;std::istream::read(char*, long long)&gt;         | è¯»å…¥header</span><br><span class="hljs-string">00007FF6077B1757 | 48:8D55 A0          | LEA RDX,QWORD PTR SS:[RBP-60]                            | RBP-60ï¼šè¾“å…¥æµç¼“å†²åŒº2ï¼ˆå­˜æ”¾header infoï¼‰</span><br><span class="hljs-string">00007FF6077B175B | 48:8D85 D0010000    | LEA RAX,QWORD PTR SS:[RBP+1D0]                           |</span><br><span class="hljs-string">00007FF6077B1762 | 41:B8 28000000      | MOV R8D,28                                               | è¯»å–é•¿åº¦ï¼š28h</span><br><span class="hljs-string">00007FF6077B1768 | 48:89C1             | MOV RCX,RAX                                              | rcx:&amp;&quot;</span>E:\\WorkSpace\\Lab\\0xGame <span class="hljs-number">2025</span>\\flag<span class="hljs-number">.</span>bmp<span class="hljs-string">&quot;, rax:&amp;&quot;</span>E:\\WorkSpace\\Lab\\0xGame <span class="hljs-number">2025</span>\\flag<span class="hljs-number">.</span>bmp<span class="hljs-string">&quot;</span><br><span class="hljs-string">00007FF6077B176B | E8 28050000         | CALL &lt;JMP.&amp;std::istream::read(char*, long long)&gt;         | è¯»å…¥header info</span><br><span class="hljs-string">00007FF6077B1770 | 48:8B95 E0030000    | MOV RDX,QWORD PTR SS:[RBP+3E0]                           | [rbp-3E0]ï¼šè¾“å…¥æµç¼“å†²åŒº3ï¼ˆå­˜æ”¾æ–‡ä»¶å¤´åçš„1024bytes)</span><br><span class="hljs-string">00007FF6077B1777 | 48:8D85 D0010000    | LEA RAX,QWORD PTR SS:[RBP+1D0]                           |</span><br><span class="hljs-string">00007FF6077B177E | 41:B8 00040000      | MOV R8D,400                                              | è¯»å–é•¿åº¦ï¼š400h</span><br><span class="hljs-string">00007FF6077B1784 | 48:89C1             | MOV RCX,RAX                                              | rcx:&amp;&quot;</span>E:\\WorkSpace\\Lab\\0xGame <span class="hljs-number">2025</span>\\flag<span class="hljs-number">.</span>bmp<span class="hljs-string">&quot;, rax:&amp;&quot;</span>E:\\WorkSpace\\Lab\\0xGame <span class="hljs-number">2025</span>\\flag<span class="hljs-number">.</span>bmp<span class="hljs-string">&quot;</span><br><span class="hljs-string">00007FF6077B1787 | E8 0C050000         | CALL &lt;JMP.&amp;std::istream::read(char*, long long)&gt;         | è¯»å…¥æ–‡ä»¶å¤´åçš„1024bytes</span><br><span class="hljs-string">00007FF6077B178C | 48:8D55 D2          | LEA RDX,QWORD PTR SS:[RBP-2E]                            | [rbp-2E]ï¼šwriteå‚æ•°ï¼ˆheaderï¼‰</span><br><span class="hljs-string">00007FF6077B1790 | 48:8D45 E0          | LEA RAX,QWORD PTR SS:[RBP-20]                            | [rbp-20]:&quot;</span>E:\\WorkSpace\\Lab\\0xGame <span class="hljs-number">2025</span>\\flag<span class="hljs-number">.</span>bmp<span class="hljs-string">&quot;&quot;</span><br>00007FF6077B1794 | <span class="hljs-number">41</span>:B8 0E000000      | <span class="hljs-keyword">MOV</span> <span class="hljs-built_in">R8D</span>,E                                                |<br>00007FF6077B179A | <span class="hljs-number">48</span>:89C1             | <span class="hljs-keyword">MOV</span> <span class="hljs-built_in">RCX</span>,<span class="hljs-built_in">RAX</span>                                              | <span class="hljs-built_in">rcx</span>:&amp;<span class="hljs-string">&quot;E:\\WorkSpace\\Lab\\0xGame 2025\\flag.bmp&quot;</span>, <span class="hljs-built_in">rax</span>:&amp;<span class="hljs-string">&quot;E:\\WorkSpace\\Lab\\0xGame 2025\\flag.bmp&quot;</span><br>00007FF6077B179D | E8 EE040000         | <span class="hljs-keyword">CALL</span> &lt;<span class="hljs-keyword">JMP</span>.&amp;<span class="hljs-keyword">std</span>::ostream::write(char const*, long long)&gt;  | <br>00007FF6077B17A2 | <span class="hljs-number">48</span>:8D55 A0          | <span class="hljs-keyword">LEA</span> <span class="hljs-built_in">RDX</span>,<span class="hljs-built_in">QWORD</span> <span class="hljs-built_in">PTR</span> <span class="hljs-built_in">SS</span>:[<span class="hljs-built_in">RBP</span>-<span class="hljs-number">60</span>]                            | [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">60</span>]:<span class="hljs-string">&quot;114514puiqneravcixpbhqn;afnv-92piwgspdifjv&quot;</span><br>00007FF6077B17A6 | <span class="hljs-number">48</span>:8D45 E0          | <span class="hljs-keyword">LEA</span> <span class="hljs-built_in">RAX</span>,<span class="hljs-built_in">QWORD</span> <span class="hljs-built_in">PTR</span> <span class="hljs-built_in">SS</span>:[<span class="hljs-built_in">RBP</span>-<span class="hljs-number">20</span>]                            | [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">20</span>]:<span class="hljs-string">&quot;E:\\WorkSpace\\Lab\\0xGame 2025\\flag.bmp&quot;</span><span class="hljs-string">&quot;</span><br><span class="hljs-string">00007FF6077B17AA | 41:B8 28000000      | MOV R8D,28                                               | 28:&#x27;(&#x27;</span><br><span class="hljs-string">00007FF6077B17B0 | 48:89C1             | MOV RCX,RAX                                              | rcx:&amp;&quot;</span>E:\\WorkSpace\\Lab\\0xGame <span class="hljs-number">2025</span>\\flag<span class="hljs-number">.</span>bmp<span class="hljs-string">&quot;, rax:&amp;&quot;</span>E:\\WorkSpace\\Lab\\0xGame <span class="hljs-number">2025</span>\\flag<span class="hljs-number">.</span>bmp<span class="hljs-string">&quot;</span><br><span class="hljs-string">00007FF6077B17B3 | E8 D8040000         | CALL &lt;JMP.&amp;std::ostream::write(char const*, long long)&gt;  |</span><br><span class="hljs-string">00007FF6077B17B8 | 48:8B95 E0030000    | MOV RDX,QWORD PTR SS:[RBP+3E0]                           |</span><br><span class="hljs-string">00007FF6077B17BF | 48:8D45 E0          | LEA RAX,QWORD PTR SS:[RBP-20]                            | [rbp-20]:&quot;</span>E:\\WorkSpace\\Lab\\0xGame <span class="hljs-number">2025</span>\\flag<span class="hljs-number">.</span>bmp<span class="hljs-string">&quot;&quot;</span><br>00007FF6077B17C3 | <span class="hljs-number">41</span>:B8 <span class="hljs-number">00040000</span>      | <span class="hljs-keyword">MOV</span> <span class="hljs-built_in">R8D</span>,<span class="hljs-number">400</span>                                              |<br>00007FF6077B17C9 | <span class="hljs-number">48</span>:89C1             | <span class="hljs-keyword">MOV</span> <span class="hljs-built_in">RCX</span>,<span class="hljs-built_in">RAX</span>                                              | <span class="hljs-built_in">rcx</span>:&amp;<span class="hljs-string">&quot;E:\\WorkSpace\\Lab\\0xGame 2025\\flag.bmp&quot;</span>, <span class="hljs-built_in">rax</span>:&amp;<span class="hljs-string">&quot;E:\\WorkSpace\\Lab\\0xGame 2025\\flag.bmp&quot;</span><br>00007FF6077B17CC | E8 BF040000         | <span class="hljs-keyword">CALL</span> &lt;<span class="hljs-keyword">JMP</span>.&amp;<span class="hljs-keyword">std</span>::ostream::write(char const*, long long)&gt;  |<br>00007FF6077B17D1 | <span class="hljs-number">48</span>:83BD E0030000 <span class="hljs-number">00</span> | <span class="hljs-keyword">CMP</span> <span class="hljs-built_in">QWORD</span> <span class="hljs-built_in">PTR</span> <span class="hljs-built_in">SS</span>:[<span class="hljs-built_in">RBP</span>+3E0],<span class="hljs-number">0</span>                             |<br>00007FF6077B17D9 | <span class="hljs-number">74</span> 0F               | <span class="hljs-keyword">JE</span> img<span class="hljs-number">.</span>7FF6077B17EA                                      |<br>00007FF6077B17DB | <span class="hljs-number">48</span>:8B85 E0030000    | <span class="hljs-keyword">MOV</span> <span class="hljs-built_in">RAX</span>,<span class="hljs-built_in">QWORD</span> <span class="hljs-built_in">PTR</span> <span class="hljs-built_in">SS</span>:[<span class="hljs-built_in">RBP</span>+3E0]                           |<br>00007FF6077B17E2 | <span class="hljs-number">48</span>:89C1             | <span class="hljs-keyword">MOV</span> <span class="hljs-built_in">RCX</span>,<span class="hljs-built_in">RAX</span>                                              | <span class="hljs-built_in">rcx</span>:&amp;<span class="hljs-string">&quot;E:\\WorkSpace\\Lab\\0xGame 2025\\flag.bmp&quot;</span>, <span class="hljs-built_in">rax</span>:&amp;<span class="hljs-string">&quot;E:\\WorkSpace\\Lab\\0xGame 2025\\flag.bmp&quot;</span><br>00007FF6077B17E5 | E8 <span class="hljs-number">36040000</span>         | <span class="hljs-keyword">CALL</span> &lt;<span class="hljs-keyword">JMP</span>.&amp;operator delete[](void*)&gt;                     |<br>00007FF6077B17EA | 8B55 A4             | <span class="hljs-keyword">MOV</span> <span class="hljs-built_in">EDX</span>,<span class="hljs-built_in">DWORD</span> <span class="hljs-built_in">PTR</span> <span class="hljs-built_in">SS</span>:[<span class="hljs-built_in">RBP</span>-5C]                            |<br>00007FF6077B17ED | 0FB745 AE           | <span class="hljs-keyword">MOVZX</span> <span class="hljs-built_in">EAX</span>,<span class="hljs-built_in">WORD</span> <span class="hljs-built_in">PTR</span> <span class="hljs-built_in">SS</span>:[<span class="hljs-built_in">RBP</span>-<span class="hljs-number">52</span>]                           |<br>00007FF6077B17F1 | 0FB7C0              | <span class="hljs-keyword">MOVZX</span> <span class="hljs-built_in">EAX</span>,<span class="hljs-built_in">AX</span>                                             |<br>00007FF6077B17F4 | 0FAFC2              | <span class="hljs-keyword">IMUL</span> <span class="hljs-built_in">EAX</span>,<span class="hljs-built_in">EDX</span>                                             |<br>00007FF6077B17F7 | 83C0 1F             | <span class="hljs-keyword">ADD</span> <span class="hljs-built_in">EAX</span>,1F                                               |<br>00007FF6077B17FA | 8D50 1F             | <span class="hljs-keyword">LEA</span> <span class="hljs-built_in">EDX</span>,<span class="hljs-built_in">QWORD</span> <span class="hljs-built_in">PTR</span> <span class="hljs-built_in">DS</span>:[<span class="hljs-built_in">RAX</span>+1F]                            |<br>00007FF6077B17FD | 85C0                | <span class="hljs-keyword">TEST</span> <span class="hljs-built_in">EAX</span>,<span class="hljs-built_in">EAX</span>                                             |<br>00007FF6077B17FF | 0F48C2              | <span class="hljs-keyword">CMOVS</span> <span class="hljs-built_in">EAX</span>,<span class="hljs-built_in">EDX</span>                                            |<br>00007FF6077B1802 | C1F8 <span class="hljs-number">05</span>             | <span class="hljs-keyword">SAR</span> <span class="hljs-built_in">EAX</span>,<span class="hljs-number">5</span>                                                |<br>00007FF6077B1805 | C1E0 <span class="hljs-number">02</span>             | <span class="hljs-keyword">SHL</span> <span class="hljs-built_in">EAX</span>,<span class="hljs-number">2</span>                                                |<br>00007FF6077B1808 | <span class="hljs-number">8985</span> DC030000       | <span class="hljs-keyword">MOV</span> <span class="hljs-built_in">DWORD</span> <span class="hljs-built_in">PTR</span> <span class="hljs-built_in">SS</span>:[<span class="hljs-built_in">RBP</span>+3DC],<span class="hljs-built_in">EAX</span>                           |<br>00007FF6077B180E | 8B45 A8             | <span class="hljs-keyword">MOV</span> <span class="hljs-built_in">EAX</span>,<span class="hljs-built_in">DWORD</span> <span class="hljs-built_in">PTR</span> <span class="hljs-built_in">SS</span>:[<span class="hljs-built_in">RBP</span>-<span class="hljs-number">58</span>]                            |<br>00007FF6077B1811 | <span class="hljs-number">99</span>                  | <span class="hljs-keyword">CDQ</span>                                                      |<br>00007FF6077B1812 | 31D0                | <span class="hljs-keyword">XOR</span> <span class="hljs-built_in">EAX</span>,<span class="hljs-built_in">EDX</span>                                              |<br>00007FF6077B1814 | 29D0                | <span class="hljs-keyword">SUB</span> <span class="hljs-built_in">EAX</span>,<span class="hljs-built_in">EDX</span>                                              |<br>00007FF6077B1816 | 0FAF85 DC030000     | <span class="hljs-keyword">IMUL</span> <span class="hljs-built_in">EAX</span>,<span class="hljs-built_in">DWORD</span> <span class="hljs-built_in">PTR</span> <span class="hljs-built_in">SS</span>:[<span class="hljs-built_in">RBP</span>+3DC]                          |<br>00007FF6077B181D | <span class="hljs-number">48</span>:<span class="hljs-number">98</span>               | <span class="hljs-keyword">CDQE</span>                                                     |<br>00007FF6077B181F | <span class="hljs-number">48</span>:<span class="hljs-number">8985</span> D0030000    | <span class="hljs-keyword">MOV</span> <span class="hljs-built_in">QWORD</span> <span class="hljs-built_in">PTR</span> <span class="hljs-built_in">SS</span>:[<span class="hljs-built_in">RBP</span>+3D0],<span class="hljs-built_in">RAX</span>                           |<br>00007FF6077B1826 | <span class="hljs-number">48</span>:8B85 D0030000    | <span class="hljs-keyword">MOV</span> <span class="hljs-built_in">RAX</span>,<span class="hljs-built_in">QWORD</span> <span class="hljs-built_in">PTR</span> <span class="hljs-built_in">SS</span>:[<span class="hljs-built_in">RBP</span>+3D0]                           |<br>00007FF6077B182D | <span class="hljs-number">48</span>:89C1             | <span class="hljs-keyword">MOV</span> <span class="hljs-built_in">RCX</span>,<span class="hljs-built_in">RAX</span>                                              | <span class="hljs-built_in">rcx</span>:&amp;<span class="hljs-string">&quot;E:\\WorkSpace\\Lab\\0xGame 2025\\flag.bmp&quot;</span>, <span class="hljs-built_in">rax</span>:&amp;<span class="hljs-string">&quot;E:\\WorkSpace\\Lab\\0xGame 2025\\flag.bmp&quot;</span><br>00007FF6077B1830 | E8 DB030000         | <span class="hljs-keyword">CALL</span> &lt;<span class="hljs-keyword">JMP</span>.&amp;operator new[](unsigned long long)&gt;           |<br>00007FF6077B1835 | <span class="hljs-number">48</span>:<span class="hljs-number">8985</span> C8030000    | <span class="hljs-keyword">MOV</span> <span class="hljs-built_in">QWORD</span> <span class="hljs-built_in">PTR</span> <span class="hljs-built_in">SS</span>:[<span class="hljs-built_in">RBP</span>+3C8],<span class="hljs-built_in">RAX</span>                           | <span class="hljs-number">111</span><br>00007FF6077B183C | <span class="hljs-number">48</span>:8B8D D0030000    | <span class="hljs-keyword">MOV</span> <span class="hljs-built_in">RCX</span>,<span class="hljs-built_in">QWORD</span> <span class="hljs-built_in">PTR</span> <span class="hljs-built_in">SS</span>:[<span class="hljs-built_in">RBP</span>+3D0]                           |<br>00007FF6077B1843 | <span class="hljs-number">48</span>:8B95 C8030000    | <span class="hljs-keyword">MOV</span> <span class="hljs-built_in">RDX</span>,<span class="hljs-built_in">QWORD</span> <span class="hljs-built_in">PTR</span> <span class="hljs-built_in">SS</span>:[<span class="hljs-built_in">RBP</span>+3C8]                           | <span class="hljs-number">111</span><br>00007FF6077B184A | <span class="hljs-number">48</span>:8D85 D0010000    | <span class="hljs-keyword">LEA</span> <span class="hljs-built_in">RAX</span>,<span class="hljs-built_in">QWORD</span> <span class="hljs-built_in">PTR</span> <span class="hljs-built_in">SS</span>:[<span class="hljs-built_in">RBP</span>+1D0]                           |<br>00007FF6077B1851 | <span class="hljs-number">49</span>:89C8             | <span class="hljs-keyword">MOV</span> <span class="hljs-built_in">R8</span>,<span class="hljs-built_in">RCX</span>                                               | <span class="hljs-built_in">r8</span>:&amp;<span class="hljs-string">&quot;114514puiqneravcixpbhqn;afnv-92piwgspdifjv&quot;</span>, <span class="hljs-built_in">rcx</span>:&amp;<span class="hljs-string">&quot;E:\\WorkSpace\\Lab\\0xGame 2025\\flag.bmp&quot;</span><span class="hljs-string">&quot;</span><br><span class="hljs-string">00007FF6077B1854 | 48:89C1             | MOV RCX,RAX                                              | rcx:&amp;&quot;</span>E:\\WorkSpace\\Lab\\0xGame <span class="hljs-number">2025</span>\\flag<span class="hljs-number">.</span>bmp<span class="hljs-string">&quot;, rax:&amp;&quot;</span>E:\\WorkSpace\\Lab\\0xGame <span class="hljs-number">2025</span>\\flag<span class="hljs-number">.</span>bmp<span class="hljs-string">&quot;</span><br><span class="hljs-string">00007FF6077B1857 | E8 3C040000         | CALL &lt;JMP.&amp;std::istream::read(char*, long long)&gt;         |</span><br><span class="hljs-string">00007FF6077B185C | 48:8D85 D0010000    | LEA RAX,QWORD PTR SS:[RBP+1D0]                           |</span><br><span class="hljs-string">00007FF6077B1863 | 48:89C1             | MOV RCX,RAX                                              | rcx:&amp;&quot;</span>E:\\WorkSpace\\Lab\\0xGame <span class="hljs-number">2025</span>\\flag<span class="hljs-number">.</span>bmp<span class="hljs-string">&quot;, rax:&amp;&quot;</span>E:\\WorkSpace\\Lab\\0xGame <span class="hljs-number">2025</span>\\flag<span class="hljs-number">.</span>bmp<span class="hljs-string">&quot;</span><br><span class="hljs-string">00007FF6077B1866 | E8 15040000         | CALL &lt;JMP.&amp;std::basic_ifstream&lt;char, std::char_traits&lt;ch |</span><br><span class="hljs-string">00007FF6077B186B | 80BD 28040000 00    | CMP BYTE PTR SS:[RBP+428],0                              |</span><br><span class="hljs-string">00007FF6077B1872 | 74 24               | JE img.7FF6077B1898                                      |</span><br><span class="hljs-string">00007FF6077B1874 | 48:8B85 D0030000    | MOV RAX,QWORD PTR SS:[RBP+3D0]                           |</span><br><span class="hljs-string">00007FF6077B187B | 89C1                | MOV ECX,EAX                                              |</span><br><span class="hljs-string">00007FF6077B187D | 48:8B95 20040000    | MOV RDX,QWORD PTR SS:[RBP+420]                           |</span><br><span class="hljs-string">00007FF6077B1884 | 48:8B85 C8030000    | MOV RAX,QWORD PTR SS:[RBP+3C8]                           | å…³æ³¨æ­¤å¤„[rbp+3C8]ï¼Œç–‘ä¼¼å­˜æ”¾å¤„ç†åçš„æ•°æ®çš„ç¼“å†²åŒº</span><br><span class="hljs-string">00007FF6077B188B | 49:89D0             | MOV R8,RDX                                               | r8:&amp;&quot;</span>114514puiqneravcixpbhqn<span class="hljs-comment">;afnv-92piwgspdifjv&quot;, rdx:&amp;&quot;E:\\WorkSpace\\Lab\\0xGame 2025\\enc.bmp&quot;v&quot;</span><br>00007FF6077B188E | 89CA                | <span class="hljs-keyword">MOV</span> <span class="hljs-built_in">EDX</span>,<span class="hljs-built_in">ECX</span>                                              |<br>00007FF6077B1890 | <span class="hljs-number">48</span>:89C1             | <span class="hljs-keyword">MOV</span> <span class="hljs-built_in">RCX</span>,<span class="hljs-built_in">RAX</span>                                              | <span class="hljs-built_in">rcx</span>:&amp;<span class="hljs-string">&quot;E:\\WorkSpace\\Lab\\0xGame 2025\\flag.bmp&quot;</span>, <span class="hljs-built_in">rax</span>:&amp;<span class="hljs-string">&quot;E:\\WorkSpace\\Lab\\0xGame 2025\\flag.bmp&quot;</span><br>00007FF6077B1893 | E8 A8FBFFFF         | <span class="hljs-keyword">CALL</span> img<span class="hljs-number">.</span>7FF6077B1440                                    | modifiedRC4<br>00007FF6077B1898 | <span class="hljs-number">48</span>:8B8D D0030000    | <span class="hljs-keyword">MOV</span> <span class="hljs-built_in">RCX</span>,<span class="hljs-built_in">QWORD</span> <span class="hljs-built_in">PTR</span> <span class="hljs-built_in">SS</span>:[<span class="hljs-built_in">RBP</span>+3D0]                           |<br>00007FF6077B189F | <span class="hljs-number">48</span>:8B95 C8030000    | <span class="hljs-keyword">MOV</span> <span class="hljs-built_in">RDX</span>,<span class="hljs-built_in">QWORD</span> <span class="hljs-built_in">PTR</span> <span class="hljs-built_in">SS</span>:[<span class="hljs-built_in">RBP</span>+3C8]                           | [<span class="hljs-built_in">rbp</span>+3C8]ï¼šè¾“å‡ºçš„å›¾åƒæ•°æ®<br>00007FF6077B18A6 | <span class="hljs-number">48</span>:8D45 E0          | <span class="hljs-keyword">LEA</span> <span class="hljs-built_in">RAX</span>,<span class="hljs-built_in">QWORD</span> <span class="hljs-built_in">PTR</span> <span class="hljs-built_in">SS</span>:[<span class="hljs-built_in">RBP</span>-<span class="hljs-number">20</span>]                            | [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">20</span>]:<span class="hljs-string">&quot;E:\\WorkSpace\\Lab\\0xGame 2025\\flag.bmp&quot;</span><span class="hljs-string">&quot;</span><br><span class="hljs-string">00007FF6077B18AA | 49:89C8             | MOV R8,RCX                                               | R8ï¼šæ•°æ®é•¿åº¦</span><br><span class="hljs-string">00007FF6077B18AD | 48:89C1             | MOV RCX,RAX                                              | rcx:&amp;&quot;</span>E:\\WorkSpace\\Lab\\0xGame <span class="hljs-number">2025</span>\\flag<span class="hljs-number">.</span>bmp<span class="hljs-string">&quot;, rax:&amp;&quot;</span>E:\\WorkSpace\\Lab\\0xGame <span class="hljs-number">2025</span>\\flag<span class="hljs-number">.</span>bmp<span class="hljs-string">&quot;</span><br><span class="hljs-string">00007FF6077B18B0 | E8 DB030000         | CALL &lt;JMP.&amp;std::ostream::write(char const*, long long)&gt;  | å†™å…¥åŠ å¯†åçš„æ•°æ®</span><br><span class="hljs-string">00007FF6077B18B5 | 48:8D45 E0          | LEA RAX,QWORD PTR SS:[RBP-20]                            | [rbp-20]:&quot;</span>E:\\WorkSpace\\Lab\\0xGame <span class="hljs-number">2025</span>\\flag<span class="hljs-number">.</span>bmp<span class="hljs-string">&quot;&quot;</span><br>00007FF6077B18B9 | <span class="hljs-number">48</span>:89C1             | <span class="hljs-keyword">MOV</span> <span class="hljs-built_in">RCX</span>,<span class="hljs-built_in">RAX</span>                                              | <span class="hljs-built_in">rcx</span>:&amp;<span class="hljs-string">&quot;E:\\WorkSpace\\Lab\\0xGame 2025\\flag.bmp&quot;</span>, <span class="hljs-built_in">rax</span>:&amp;<span class="hljs-string">&quot;E:\\WorkSpace\\Lab\\0xGame 2025\\flag.bmp&quot;</span><br>00007FF6077B18BC | E8 A7030000         | <span class="hljs-keyword">CALL</span> &lt;<span class="hljs-keyword">JMP</span>.&amp;<span class="hljs-keyword">std</span>::basic_ofstream&lt;char, <span class="hljs-keyword">std</span>::char_traits&lt;<span class="hljs-number">ch</span> |<br>00007FF6077B18C1 | <span class="hljs-number">48</span>:83BD C8030000 <span class="hljs-number">00</span> | <span class="hljs-keyword">CMP</span> <span class="hljs-built_in">QWORD</span> <span class="hljs-built_in">PTR</span> <span class="hljs-built_in">SS</span>:[<span class="hljs-built_in">RBP</span>+3C8],<span class="hljs-number">0</span>                             |<br>00007FF6077B18C9 | <span class="hljs-number">74</span> 0F               | <span class="hljs-keyword">JE</span> img<span class="hljs-number">.</span>7FF6077B18DA                                      |<br>00007FF6077B18CB | <span class="hljs-number">48</span>:8B85 C8030000    | <span class="hljs-keyword">MOV</span> <span class="hljs-built_in">RAX</span>,<span class="hljs-built_in">QWORD</span> <span class="hljs-built_in">PTR</span> <span class="hljs-built_in">SS</span>:[<span class="hljs-built_in">RBP</span>+3C8]                           |<br>00007FF6077B18D2 | <span class="hljs-number">48</span>:89C1             | <span class="hljs-keyword">MOV</span> <span class="hljs-built_in">RCX</span>,<span class="hljs-built_in">RAX</span>                                              | <span class="hljs-built_in">rcx</span>:&amp;<span class="hljs-string">&quot;E:\\WorkSpace\\Lab\\0xGame 2025\\flag.bmp&quot;</span>, <span class="hljs-built_in">rax</span>:&amp;<span class="hljs-string">&quot;E:\\WorkSpace\\Lab\\0xGame 2025\\flag.bmp&quot;</span><br>00007FF6077B18D5 | E8 <span class="hljs-number">46030000</span>         | <span class="hljs-keyword">CALL</span> &lt;<span class="hljs-keyword">JMP</span>.&amp;operator delete[](void*)&gt;                     | <br>00007FF6077B18DA | BB <span class="hljs-number">01000000</span>         | <span class="hljs-keyword">MOV</span> <span class="hljs-built_in">EBX</span>,<span class="hljs-number">1</span>                                                |<br>00007FF6077B18DF | <span class="hljs-number">48</span>:8D45 E0          | <span class="hljs-keyword">LEA</span> <span class="hljs-built_in">RAX</span>,<span class="hljs-built_in">QWORD</span> <span class="hljs-built_in">PTR</span> <span class="hljs-built_in">SS</span>:[<span class="hljs-built_in">RBP</span>-<span class="hljs-number">20</span>]                            | [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">20</span>]:<span class="hljs-string">&quot;E:\\WorkSpace\\Lab\\0xGame 2025\\flag.bmp&quot;</span><span class="hljs-string">&quot;</span><br><span class="hljs-string">00007FF6077B18E3 | 48:89C1             | MOV RCX,RAX                                              | rcx:&amp;&quot;</span>E:\\WorkSpace\\Lab\\0xGame <span class="hljs-number">2025</span>\\flag<span class="hljs-number">.</span>bmp<span class="hljs-string">&quot;, rax:&amp;&quot;</span>E:\\WorkSpace\\Lab\\0xGame <span class="hljs-number">2025</span>\\flag<span class="hljs-number">.</span>bmp<span class="hljs-string">&quot;</span><br><span class="hljs-string">00007FF6077B18E6 | E8 6D030000         | CALL &lt;JMP.&amp;std::basic_ofstream&lt;char, std::char_traits&lt;ch |</span><br><span class="hljs-string">00007FF6077B18EB | 48:8D85 D0010000    | LEA RAX,QWORD PTR SS:[RBP+1D0]                           |</span><br><span class="hljs-string">00007FF6077B18F2 | 48:89C1             | MOV RCX,RAX                                              | rcx:&amp;&quot;</span>E:\\WorkSpace\\Lab\\0xGame <span class="hljs-number">2025</span>\\flag<span class="hljs-number">.</span>bmp<span class="hljs-string">&quot;, rax:&amp;&quot;</span>E:\\WorkSpace\\Lab\\0xGame <span class="hljs-number">2025</span>\\flag<span class="hljs-number">.</span>bmp<span class="hljs-string">&quot;</span><br><span class="hljs-string">00007FF6077B18F5 | E8 76030000         | CALL &lt;JMP.&amp;std::basic_ifstream&lt;char, std::char_traits&lt;ch |</span><br><span class="hljs-string">00007FF6077B18FA | 89D8                | MOV EAX,EBX                                              |</span><br><span class="hljs-string">00007FF6077B18FC | EB 2E               | JMP img.7FF6077B192C                                     |</span><br><span class="hljs-string">00007FF6077B18FE | 48:89C3             | MOV RBX,RAX                                              | rax:&amp;&quot;</span>E:\\WorkSpace\\Lab\\0xGame <span class="hljs-number">2025</span>\\flag<span class="hljs-number">.</span>bmp<span class="hljs-string">&quot;</span><br><span class="hljs-string">00007FF6077B1901 | 48:8D45 E0          | LEA RAX,QWORD PTR SS:[RBP-20]                            | [rbp-20]:&quot;</span>E:\\WorkSpace\\Lab\\0xGame <span class="hljs-number">2025</span>\\flag<span class="hljs-number">.</span>bmp<span class="hljs-string">&quot;&quot;</span><br>00007FF6077B1905 | <span class="hljs-number">48</span>:89C1             | <span class="hljs-keyword">MOV</span> <span class="hljs-built_in">RCX</span>,<span class="hljs-built_in">RAX</span>                                              | <span class="hljs-built_in">rcx</span>:&amp;<span class="hljs-string">&quot;E:\\WorkSpace\\Lab\\0xGame 2025\\flag.bmp&quot;</span>, <span class="hljs-built_in">rax</span>:&amp;<span class="hljs-string">&quot;E:\\WorkSpace\\Lab\\0xGame 2025\\flag.bmp&quot;</span><br>00007FF6077B1908 | E8 4B030000         | <span class="hljs-keyword">CALL</span> &lt;<span class="hljs-keyword">JMP</span>.&amp;<span class="hljs-keyword">std</span>::basic_ofstream&lt;char, <span class="hljs-keyword">std</span>::char_traits&lt;<span class="hljs-number">ch</span> |<br>00007FF6077B190D | EB <span class="hljs-number">03</span>               | <span class="hljs-keyword">JMP</span> img<span class="hljs-number">.</span>7FF6077B1912                                     |<br>00007FF6077B190F | <span class="hljs-number">48</span>:89C3             | <span class="hljs-keyword">MOV</span> <span class="hljs-built_in">RBX</span>,<span class="hljs-built_in">RAX</span>                                              | <span class="hljs-built_in">rax</span>:&amp;<span class="hljs-string">&quot;E:\\WorkSpace\\Lab\\0xGame 2025\\flag.bmp&quot;</span><br>00007FF6077B1912 | <span class="hljs-number">48</span>:8D85 D0010000    | <span class="hljs-keyword">LEA</span> <span class="hljs-built_in">RAX</span>,<span class="hljs-built_in">QWORD</span> <span class="hljs-built_in">PTR</span> <span class="hljs-built_in">SS</span>:[<span class="hljs-built_in">RBP</span>+1D0]                           |<br>00007FF6077B1919 | <span class="hljs-number">48</span>:89C1             | <span class="hljs-keyword">MOV</span> <span class="hljs-built_in">RCX</span>,<span class="hljs-built_in">RAX</span>                                              | <span class="hljs-built_in">rcx</span>:&amp;<span class="hljs-string">&quot;E:\\WorkSpace\\Lab\\0xGame 2025\\flag.bmp&quot;</span>, <span class="hljs-built_in">rax</span>:&amp;<span class="hljs-string">&quot;E:\\WorkSpace\\Lab\\0xGame 2025\\flag.bmp&quot;</span><br>00007FF6077B191C | E8 4F030000         | <span class="hljs-keyword">CALL</span> &lt;<span class="hljs-keyword">JMP</span>.&amp;<span class="hljs-keyword">std</span>::basic_ifstream&lt;char, <span class="hljs-keyword">std</span>::char_traits&lt;<span class="hljs-number">ch</span> |<br>00007FF6077B1921 | <span class="hljs-number">48</span>:89D8             | <span class="hljs-keyword">MOV</span> <span class="hljs-built_in">RAX</span>,<span class="hljs-built_in">RBX</span>                                              | <span class="hljs-built_in">rax</span>:&amp;<span class="hljs-string">&quot;E:\\WorkSpace\\Lab\\0xGame 2025\\flag.bmp&quot;</span><br>00007FF6077B1924 | <span class="hljs-number">48</span>:89C1             | <span class="hljs-keyword">MOV</span> <span class="hljs-built_in">RCX</span>,<span class="hljs-built_in">RAX</span>                                              | <span class="hljs-built_in">rcx</span>:&amp;<span class="hljs-string">&quot;E:\\WorkSpace\\Lab\\0xGame 2025\\flag.bmp&quot;</span>, <span class="hljs-built_in">rax</span>:&amp;<span class="hljs-string">&quot;E:\\WorkSpace\\Lab\\0xGame 2025\\flag.bmp&quot;</span><br>00007FF6077B1927 | E8 <span class="hljs-number">74140000</span>         | <span class="hljs-keyword">CALL</span> &lt;<span class="hljs-keyword">JMP</span>.&amp;_Unwind_Resume&gt;                               |<br>00007FF6077B192C | <span class="hljs-number">48</span>:81C4 <span class="hljs-number">78040000</span>    | <span class="hljs-keyword">ADD</span> <span class="hljs-built_in">RSP</span>,<span class="hljs-number">478</span>                                              |<br>00007FF6077B1933 | 5B                  | <span class="hljs-keyword">POP</span> <span class="hljs-built_in">RBX</span>                                                  |<br>00007FF6077B1934 | <span class="hljs-number">5D</span>                  | <span class="hljs-keyword">POP</span> <span class="hljs-built_in">RBP</span>                                                  |<br>00007FF6077B1935 | C3                  | <span class="hljs-keyword">RET</span>                                                      |<br></code></pre></td></tr></table></figure>

<p>é€šè¿‡è·Ÿè¸ªä¸‰æ¬¡readçš„å‚æ•°ï¼ˆæŸ¥çœ‹è¯»å…¥å†…å­˜çš„æ•°æ®ï¼‰å¯ä»¥å‘ç°ï¼Œç¨‹åºé™¤äº†è¯»å–æ–‡ä»¶å¤´ä¹‹å¤–è¿˜è¯»å–äº†éšåçš„1024bytesã€‚è¿™åˆšå¼€å§‹å…¶å®åªæ˜¯ä¸€ä¸ªçŒœæƒ³ï¼Œä½†æ˜¯é€šè¿‡ä¿®æ”¹è‡ªå·±åˆ›å»ºçš„flag.bmpæ–‡ä»¶å¤´åçš„éƒ¨åˆ†æ•°æ®å¯ä»¥éªŒè¯çŒœæƒ³</p>
<p><img src="/../images/image-20251118205855685.png" alt="ä¿®æ”¹æ–‡ä»¶æ•°æ®"></p>
<p><img src="/../images/image-20251118205930373.png" alt="è¾“å…¥æµç¼“å†²åŒº3è¯»å–çš„æ­£æ˜¯æ–‡ä»¶å¤´åçš„1024bytes"></p>
<p>ç»§ç»­è¿è¡Œç¨‹åºï¼Œå¯ä»¥å‘ç°ç”Ÿæˆçš„enc.bmpä¸­ä¿ç•™äº†è¿™ä¸€éƒ¨åˆ†ä¿®æ”¹åçš„æ•°æ®ï¼Œäºæ˜¯çŒœæƒ³ç¨‹åºåœ¨åŠ å¯†ç»“æœä¸­ä¿ç•™äº†è¾“å…¥æµç¼“å†²åŒº3çš„1024bytesï¼Œå¯ä»¥é€šè¿‡æ‰©å¤§ä¿®æ”¹çš„æ•°æ®èŒƒå›´æ¥éªŒè¯çŒœæƒ³ï¼ˆè¿™é‡Œé€‰æ‹©è¿›ä¸€æ­¥ä¿®æ”¹flag.bmpé‡Œ1024bytesçš„ç»“å°¾ï¼Œè¿™æ ·å¼€å¤´ç»“å°¾éƒ½æœ‰è¢«ä¿®æ”¹çš„ç‰¹å¾äº†ï¼‰</p>
<p><img src="/../images/image-20251118211132659.png" alt="è¿›ä¸€æ­¥ä¿®æ”¹åŸæ–‡ä»¶æ–‡ä»¶å¤´å1024bytesçš„ç»“å°¾"></p>
<p><img src="/../images/image-20251119154953693.png" alt="åŠ å¯†ç»“æœæ–‡ä»¶å¤´å1024bytesçš„å¼€å¤´"></p>
<p><img src="/../images/image-20251118211217057.png" alt="åŠ å¯†ç»“æœæ–‡ä»¶å¤´å1024bytesçš„ç»“å°¾"></p>
<p>äºæ˜¯åŠ å¯†ç»“æœä¸­å¤šå‡ºæ¥çš„1024bytesæ¥æºå°±æ˜¾è€Œæ˜“è§äº†ã€‚è‡³æ­¤ï¼Œç¨‹åºè¯»å†™æ–‡ä»¶çš„é€»è¾‘åŸºæœ¬å¯ä»¥æ˜ç¡®äº†ï¼šå…ˆä¿ç•™æ–‡ä»¶å¤´ï¼ˆ0-0x36hï¼‰å’Œæ–‡ä»¶å¤´åçš„1024bytesï¼Œç„¶åè¯»å–æ–‡ä»¶å¤´ä¹‹å¤–çš„æ•°æ®ï¼ˆ0x36h-0x3589A9hï¼‰è¿›è¡ŒåŠ å¯†ï¼ŒåŠ å¯†å®Œæˆåå…ˆå‘enc.bmpå†™å…¥äº‹å…ˆä¿ç•™çš„æ–‡ä»¶å¤´å’Œ1024bytesï¼Œå†æ‹¼æ¥ä¸ŠåŠ å¯†åçš„æ•°æ®</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><code class="hljs plaintext">flag.bmp:æ–‡ä»¶å¤´(å¤§å°0x36h)+å›¾ç‰‡æ•°æ®(å¤§å°0x358974h)<br>enc.bmp:æ–‡ä»¶å¤´(å¤§å°0x36h)+å›¾ç‰‡æ•°æ®å‰1024bytes(å¤§å°0x400h)+åŠ å¯†åçš„å›¾ç‰‡æ•°æ®(å¤§å°0x358974h)<br></code></pre></td></tr></table></figure>

<p>è§£å†³å®Œæ–‡ä»¶è¯»å†™é€»è¾‘åˆ†æåï¼Œæ¥ä¸‹æ¥ç€æ‰‹è§£å†³ç®—æ³•é€†å‘ã€‚ä¸‹é¢æ˜¯modefiedRC4çš„è¯¦ç»†åˆ†æ</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs C">__int64 __fastcall <span class="hljs-title function_">modifiedRC4</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> *input, __int64 a2, <span class="hljs-type">int</span> numOfDataBytes, __int64 outputBuffer, __int64 key)</span><br>&#123;<br>  <span class="hljs-type">unsigned</span> __int64 v5; <span class="hljs-comment">// rax</span><br>  _BYTE *v6; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">char</span> v7; <span class="hljs-comment">// dl</span><br>  __int64 numOfEncBytes; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [rsp+24h] [rbp-Ch]</span><br>  <span class="hljs-type">int</span> j; <span class="hljs-comment">// [rsp+24h] [rbp-Ch]</span><br>  <span class="hljs-type">int</span> k; <span class="hljs-comment">// [rsp+24h] [rbp-Ch]</span><br>  <span class="hljs-type">int</span> j_sbox; <span class="hljs-comment">// [rsp+28h] [rbp-8h]</span><br>  <span class="hljs-type">int</span> j_; <span class="hljs-comment">// [rsp+28h] [rbp-8h]</span><br>  <span class="hljs-type">int</span> i_sbox; <span class="hljs-comment">// [rsp+2Ch] [rbp-4h]</span><br>  <span class="hljs-type">int</span> i_; <span class="hljs-comment">// [rsp+2Ch] [rbp-4h]</span><br><br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">255</span>; ++i )<br>    S[i] = i;<br>  i_sbox = <span class="hljs-number">0</span>;<br>  j_sbox = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">for</span> ( j = <span class="hljs-number">0</span>; j &lt;= <span class="hljs-number">255</span>; ++j )<br>  &#123;<br>    i_sbox = (i_sbox + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span>;<br>    a2 = S[i_sbox] + j_sbox;<br>    v5 = sub_7FF7688232B0(input, a2, j_sbox, key);<span class="hljs-comment">// å®é™…ä¸Šreturn key[8]ï¼Œè°ƒè¯•å¯ä»¥å‘ç°v5å³key[8]æ˜¯0x2Aï¼Œå¯¹åº”å¯†é’¥é•¿åº¦</span><br>    v6 = sub_7FF7688233D0(input, a2, i_sbox % v5, key);<span class="hljs-comment">// if(key_len &gt;= i_sbox%key_len ) return key[i_sbox%key_len]</span><br>    v7 = a2 + *v6;                              <span class="hljs-comment">// v7=S[i_sbox] + j_sbox + key[i_sbox%key_len]</span><br>    LODWORD(v6) = ((a2 + *v6) &gt;&gt; <span class="hljs-number">31</span>) &gt;&gt; <span class="hljs-number">24</span>;<br>    j_sbox = (v6 + v7) - v6;                    <span class="hljs-comment">// è¿™ä¸¤æ­¥å®é™…ä¸Šç­‰ä»·ä¸ºj_sbox = j_sboxv7%256</span><br>    swapbytes(input, a2, &amp;S[j_sbox], &amp;S[i_sbox]);<span class="hljs-comment">// å®é™…ä¸Šæ˜¯swapbytes(&amp;S[j_sbox],&amp;S[i_sbox])ï¼Œå‰ä¸¤ä¸ªå‚æ•°æ²¡æœ‰ä½¿ç”¨</span><br>  &#125;<br>  i_ = <span class="hljs-number">0</span>;<br>  j_ = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">for</span> ( k = <span class="hljs-number">0</span>; ; ++k )<br>  &#123;<br>    numOfEncBytes = ((numOfDataBytes / <span class="hljs-number">256</span>) &lt;&lt; <span class="hljs-number">8</span>);<span class="hljs-comment">// æ€»æ•°æ®é‡å¯¹256å‘ä¸‹å–æ•´ï¼Œä¿è¯åŠ å¯†æ•°æ®é‡ä¸º256å€æ•°</span><br>    <span class="hljs-keyword">if</span> ( k &gt;= numOfEncBytes )                   <span class="hljs-comment">// kä»0å¼€å§‹ç›´åˆ°æœ€å¤§åŠ å¯†æ•°æ®é‡</span><br>      <span class="hljs-keyword">break</span>;<br>    i_ = (i_ + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span>;<br>    j_ = (S[i_] + j_) % <span class="hljs-number">256</span>;<br>    swapbytes(input, a2, &amp;S[j_], &amp;S[i_]);<br>    swapBytes(<br>      input,<br>      a2,<br>      (((k / <span class="hljs-number">256</span>) &lt;&lt; <span class="hljs-number">8</span>) + j_ + outputBuffer),   <span class="hljs-comment">// outputBuffer[((k/256)&lt;&lt;8)+j_]ï¼Œæ­¤å¤„(k/256)&lt;&lt;8å³å–æ¯å—256bytesçš„åŸºå€ï¼Œå› æ­¤äº¤æ¢èŒƒå›´æ˜¯å½“å‰æ‰€åœ¨çš„256byteså—</span><br>      (outputBuffer + ((k / <span class="hljs-number">256</span>) &lt;&lt; <span class="hljs-number">8</span>) + i_));  <span class="hljs-comment">// outputBuffer[((k/256)&lt;&lt;8)+i_]</span><br>  &#125;<br>  <span class="hljs-keyword">return</span> numOfEncBytes;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>ç®—æ³•ä¸­ç¬¬ä¸€ã€äºŒä¸ªå¾ªç¯åœ¨åˆå§‹åŒ–Sç›’ï¼Œæ²¡æœ‰å¯¹è¾“å‡ºæ•°æ®outputBufferè¿›è¡Œå¤„ç†ï¼Œç¬¬ä¸‰ä¸ªå¾ªç¯æ‰åˆ©ç”¨Sç›’çš„æ•°æ®æ¥åŠ å¯†outputBufferã€‚åŠ å¯†outputBufferçš„æ—¶å€™ï¼Œè®°å½•äº†åŠ å¯†çš„æ•°æ®é‡ï¼ŒåŠ å¯†è½®æ•°å’ŒåŠ å¯†æ•°æ®é‡ä¸€è‡´ã€‚æ¯è½®åŠ å¯†åŒæ­¥äº¤æ¢äº† i_ å’Œ j_ å¤„çš„Sç›’æ•°æ®ä»¥åŠoutputBufferæ•°æ®ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯outputBufferåœ¨äº¤æ¢çš„æ—¶å€™è¢«åˆ†æˆäº†è‹¥å¹²ä¸ª256byteså—ï¼Œäº¤æ¢åœ¨æ¯ä¸ª256byteså—å†…è¿›è¡Œã€‚æœ€ç›´è§‚çš„è§£å¯†ç®—æ³•æ˜¯è®°å½•ä¸‹æ¯è½®åŠ å¯†ä½¿ç”¨çš„ i_ å’Œ j_ ï¼Œç„¶åé€†åºä½¿ç”¨è¿™äº›ç´¢å¼•å¯¹äº¤æ¢æ•°æ®ã€‚è§£å¯†è„šæœ¬å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params"><span class="hljs-built_in">input</span>,output</span>):<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-built_in">input</span>,<span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        enc=f.read()<br><br>    bmp_header=enc[:<span class="hljs-number">0x36</span>]<span class="hljs-comment">#ä¿ç•™æ–‡ä»¶å¤´</span><br>    enc_data=<span class="hljs-built_in">bytearray</span>(enc[<span class="hljs-number">0x436</span>:])<span class="hljs-comment">#åŠ å¯†æ•°æ®ä¸ºæ–‡ä»¶å¤´+1024bytesåçš„æ•°æ®ï¼Œèµ·å§‹åç§»å³ä¸º0x436</span><br>    data_len=<span class="hljs-built_in">len</span>(enc_data)<br>    aligned_len=(data_len//<span class="hljs-number">256</span>)*<span class="hljs-number">256</span><span class="hljs-comment">#æ€»æ•°æ®é‡å‘ä¸‹å¯¹256å–æ•´ï¼Œå³ä¿è¯æ•°æ®é‡ä¸º256çš„å€æ•°</span><br><br>    key=<span class="hljs-string">&quot;114514puiqneravcixpbhqn;afnv-92piwgspdifjv&quot;</span><br>    key_len=<span class="hljs-built_in">len</span>(key)<br><br>    <span class="hljs-comment">#åˆå§‹åŒ–Sç›’</span><br>    S=<span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))<br>    j_sbox=<span class="hljs-number">0</span><br>    i_sbox=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        i_sbox=(i_sbox+<span class="hljs-number">1</span>)%<span class="hljs-number">256</span><br>        j_sbox=(j_sbox+S[i_sbox]+<span class="hljs-built_in">ord</span>(key[i_sbox%key_len]))%<span class="hljs-number">256</span><br>        S[i_sbox],S[j_sbox]=S[j_sbox],S[i_sbox]<br><br>    <span class="hljs-comment">#è§£å¯†</span><br>    <span class="hljs-comment">#ç”Ÿæˆäº¤æ¢å¯¹</span><br>    i_=<span class="hljs-number">0</span><br>    j_=<span class="hljs-number">0</span><br>    swap_couples=[]<br>    <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(aligned_len):<br>        i_=(i_+<span class="hljs-number">1</span>)%<span class="hljs-number">256</span><br>        j_=(j_+S[i_])%<span class="hljs-number">256</span><br>        S[i_],S[j_]=S[j_],S[i_]<br><br>        base=(k//<span class="hljs-number">256</span>)*<span class="hljs-number">256</span><span class="hljs-comment">#å–æ¯å—256bytesçš„åŸºå€</span><br>        pos1=base+i_<br>        pos2=base+j_<br>        <span class="hljs-keyword">if</span> pos1&lt;aligned_len <span class="hljs-keyword">and</span> pos2&lt;aligned_len:<br>            swap_couples.append((pos1,pos2))<br><br>    <span class="hljs-comment">#é€†åºä½¿ç”¨äº¤æ¢å¯¹ï¼Œè§£å¯†æ•°æ®</span><br>    <span class="hljs-keyword">for</span> pos1,pos2 <span class="hljs-keyword">in</span> <span class="hljs-built_in">reversed</span>(swap_couples):<br>        enc_data[pos1],enc_data[pos2]=enc_data[pos2],enc_data[pos1]<br><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(output,<span class="hljs-string">&#x27;wb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        f.write(bmp_header)<br>        f.write(enc_data)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+]decrypt done!&quot;</span>)<br><br>decrypt(<span class="hljs-string">&quot;enc.bmp&quot;</span>,<span class="hljs-string">&quot;flag.bmp&quot;</span>)<br><br></code></pre></td></tr></table></figure>

<p>è§£å¯†å¯ä»¥å¾—åˆ°ä¸‹å›¾ï¼ˆæ²¡æœ‰å®Œå…¨è§£å¯†æˆåŠŸï¼Œä½†æ˜¯ä¸å½±å“æ‹¿åˆ°flagï¼‰</p>
<p><img src="/../images/flag.bmp" alt="flag.bmp"></p>
</li>
</ul>
<blockquote>
<p>flagï¼š0xGame{5d0e6f18-ebc0-4231-b0e6-a5821327aefd}</p>
</blockquote>
<h2 id="è”·è–‡åœ°ç‹±"><a href="#è”·è–‡åœ°ç‹±" class="headerlink" title="è”·è–‡åœ°ç‹±"></a>è”·è–‡åœ°ç‹±</h2><blockquote>
<p>è€ƒç‚¹ï¼šå¤æ‚ç¨‹åºåˆ†æï¼ŒRSAè§£å¯†</p>
<p>éš¾ç‚¹è¿˜æ˜¯åœ¨äºå¤æ‚</p>
</blockquote>
<ul>
<li><p>é™„ä»¶æ˜¯ä¸€ä¸ªInt.exeï¼Œä¸€ä¸ªæµé‡åŒ…ï¼Œè¿˜æœ‰ä¸¤ä¸ªencæ–‡ä»¶ã€‚è¿è¡Œç¨‹åºä¼šæ˜¾ç¤ºconnect failedç„¶åæ‰“å°ä¸€äº›æ•°æ®åé—ªé€€ï¼ŒåŒæ—¶åŒä¸€ç›®å½•ä¸‹çš„æ–‡ä»¶ä¼šè¢«åŠ å¯†ç”ŸæˆåŠ å¯†æ–‡ä»¶</p>
<p><img src="/../images/image-20251119160128685.png" alt="é™„ä»¶"></p>
<p><img src="/../images/image-20251119160014085.png" alt="è¿è¡Œç¨‹åºæ˜¾ç¤º"></p>
</li>
<li><p>ç”¨IDAæ‰“å¼€ç¨‹åºï¼Œshift+F12å¯ä»¥åœ¨å­—ç¬¦ä¸²çª—å£æ‰¾åˆ°è¿è¡Œç¨‹åºæ—¶æ˜¾ç¤ºçš„â€connect failedâ€ï¼ˆä»¥åŠå…¶ä»–ä¸€äº›çœ‹èµ·æ¥å’Œç½‘ç»œé€šä¿¡æœ‰å…³çš„å­—ç¬¦ä¸²ï¼Œå¦‚â€127.0.0.1â€ï¼Œâ€socket failedâ€ï¼‰</p>
<p><img src="/../images/image-20251119160735550.png" alt="å­—ç¬¦ä¸²çª—å£"></p>
<p>ç„¶åå¯ä»¥è·Ÿè¸ªåˆ°ä¸‹é¢è¿™æ ·ä¸€ä¸ªå¾ˆåƒç½‘ç»œé€šä¿¡çš„å‡½æ•°</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><code class="hljs C++"><span class="hljs-function">__int64 __fastcall <span class="hljs-title">sub_140003D46</span><span class="hljs-params">(__int64 a1, __int64 a2, u_short a3, <span class="hljs-type">int</span> a4)</span></span><br><span class="hljs-function"></span>&#123;<br>  __int64 v4; <span class="hljs-comment">// rbx</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> Error; <span class="hljs-comment">// eax</span><br>  __int64 v6; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v7; <span class="hljs-comment">// ebx</span><br>  __int64 v8; <span class="hljs-comment">// rbx</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v9; <span class="hljs-comment">// eax</span><br>  __int64 v10; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">int</span> v11; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v12; <span class="hljs-comment">// r9d</span><br>  __int64 v13; <span class="hljs-comment">// rbx</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v14; <span class="hljs-comment">// eax</span><br>  __int64 v15; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">int</span> v16; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v17; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v18; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v19; <span class="hljs-comment">// ebx</span><br>  <span class="hljs-type">int</span> v20; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v21; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v22; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">const</span> <span class="hljs-type">char</span> *v23; <span class="hljs-comment">// rax</span><br>  __int64 v24; <span class="hljs-comment">// rbx</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v25; <span class="hljs-comment">// eax</span><br>  __int64 v26; <span class="hljs-comment">// rax</span><br>  __int64 v27; <span class="hljs-comment">// rax</span><br>  __int64 v28; <span class="hljs-comment">// rax</span><br>  __int64 v29; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">int</span> v30; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v31; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v32; <span class="hljs-comment">// r9d</span><br>  __int64 v34[<span class="hljs-number">4</span>]; <span class="hljs-comment">// [rsp+0h] [rbp-80h] BYREF</span><br>  _BYTE v35[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [rsp+20h] [rbp-60h] BYREF</span><br>  sockaddr name; <span class="hljs-comment">// [rsp+40h] [rbp-40h] BYREF</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v37; <span class="hljs-comment">// [rsp+1F4h] [rbp+174h]</span><br>  SOCKET s; <span class="hljs-comment">// [rsp+1F8h] [rbp+178h]</span><br><br>  <span class="hljs-keyword">if</span> ( <span class="hljs-built_in">WSAStartup</span>(<span class="hljs-number">0x202u</span>, (LPWSADATA)&amp;v34[<span class="hljs-number">10</span>]) )<br>  &#123;<br>    v4 = std::<span class="hljs-keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="hljs-type">char</span>&gt;&gt;(a1, a2, <span class="hljs-string">&quot;WSAStartup failed: &quot;</span>, &amp;std::cerr);<br>    Error = <span class="hljs-built_in">WSAGetLastError</span>();<br>    v6 = std::ostream::<span class="hljs-keyword">operator</span>&lt;&lt;(a1, a2, Error, v4);<br>    std::<span class="hljs-keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="hljs-type">char</span>&gt;&gt;(a1, a2, <span class="hljs-string">&quot;\n&quot;</span>, v6);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    s = <span class="hljs-built_in">socket</span>(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>);<br>    <span class="hljs-keyword">if</span> ( s == <span class="hljs-number">-1LL</span> )<br>    &#123;<br>      v8 = std::<span class="hljs-keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="hljs-type">char</span>&gt;&gt;(a1, a2, <span class="hljs-string">&quot;socket failed: &quot;</span>, &amp;std::cerr);<br>      v9 = <span class="hljs-built_in">WSAGetLastError</span>();<br>      v10 = std::ostream::<span class="hljs-keyword">operator</span>&lt;&lt;(a1, a2, v9, v8);<br>      std::<span class="hljs-keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="hljs-type">char</span>&gt;&gt;(a1, a2, <span class="hljs-string">&quot;\n&quot;</span>, v10);<br>      <span class="hljs-built_in">WSACleanup</span>();<br>      <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>      name.sa_family = <span class="hljs-number">2</span>;<br>      *(_WORD *)name.sa_data = <span class="hljs-built_in">htons</span>(a3);<br>      *(_DWORD *)&amp;name.sa_data[<span class="hljs-number">2</span>] = <span class="hljs-built_in">inet_addr</span>(<span class="hljs-string">&quot;127.0.0.1&quot;</span>);<br>      <span class="hljs-keyword">if</span> ( <span class="hljs-built_in">connect</span>(s, &amp;name, <span class="hljs-number">16</span>) == <span class="hljs-number">-1</span> )<br>      &#123;<br>        v13 = std::<span class="hljs-keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="hljs-type">char</span>&gt;&gt;(a1, a2, <span class="hljs-string">&quot;connect failed: &quot;</span>, &amp;std::cerr);<br>        v14 = <span class="hljs-built_in">WSAGetLastError</span>();<br>        v15 = std::ostream::<span class="hljs-keyword">operator</span>&lt;&lt;(a1, a2, v14, v13);<br>        std::<span class="hljs-keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="hljs-type">char</span>&gt;&gt;(a1, a2, <span class="hljs-string">&quot;\n&quot;</span>, v15);<br>        <span class="hljs-built_in">closesocket</span>(s);<br>        <span class="hljs-built_in">WSACleanup</span>();<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>      &#125;<br>      <span class="hljs-keyword">else</span><br>      &#123;<br>        <span class="hljs-built_in">sub_140001760</span>(a1, a2, a4, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v35, v11, v12, v34[<span class="hljs-number">0</span>], v34[<span class="hljs-number">1</span>]);<br>        v19 = <span class="hljs-built_in">sub_1400087B0</span>(a1, a2, v16, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v35, v17, v18, v34[<span class="hljs-number">0</span>]);<br>        v23 = (<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)<span class="hljs-built_in">sub_1400087F0</span>(a1, a2, v20, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v35, v21, v22, v34[<span class="hljs-number">0</span>]);<br>        v37 = <span class="hljs-built_in">send</span>(s, v23, v19, <span class="hljs-number">0</span>);<br>        <span class="hljs-keyword">if</span> ( v37 == <span class="hljs-number">-1</span> )<br>        &#123;<br>          v24 = std::<span class="hljs-keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="hljs-type">char</span>&gt;&gt;(a1, a2, <span class="hljs-string">&quot;send failed: &quot;</span>, &amp;std::cerr);<br>          v25 = <span class="hljs-built_in">WSAGetLastError</span>();<br>          v26 = std::ostream::<span class="hljs-keyword">operator</span>&lt;&lt;(a1, a2, v25, v24);<br>        &#125;<br>        <span class="hljs-keyword">else</span><br>        &#123;<br>          v27 = std::<span class="hljs-keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="hljs-type">char</span>&gt;&gt;(a1, a2, <span class="hljs-string">&quot;Sent &quot;</span>, &amp;std::cout);<br>          v28 = std::ostream::<span class="hljs-keyword">operator</span>&lt;&lt;(a1, a2, v37, v27);<br>          v29 = std::<span class="hljs-keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="hljs-type">char</span>&gt;&gt;(a1, a2, <span class="hljs-string">&quot; bytes: &quot;</span>, v28);<br>          v26 = std::<span class="hljs-keyword">operator</span>&lt;&lt;&lt;<span class="hljs-type">char</span>&gt;(a1, a2, v35, v29);<br>        &#125;<br>        std::<span class="hljs-keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="hljs-type">char</span>&gt;&gt;(a1, a2, <span class="hljs-string">&quot;\n&quot;</span>, v26);<br>        <span class="hljs-built_in">closesocket</span>(s);<br>        <span class="hljs-built_in">WSACleanup</span>();<br>        v7 = <span class="hljs-number">0</span>;<br>        <span class="hljs-built_in">sub_14000B400</span>(a1, a2, v30, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v35, v31, v32, v34[<span class="hljs-number">0</span>]);<br>      &#125;<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">return</span> v7;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>å›æº¯åˆ°ä¸Šçº§å‡½æ•°ï¼Œå¯ä»¥å¾—åˆ°ä¸€ä¸ªå¿«700è¡Œä»£ç çš„å‡½æ•°ã€‚ä»£ç é‡å¤ªå¤§ï¼Œäººå·¥åˆ†æå¾ˆæœ‰éš¾åº¦ï¼Œäºæ˜¯å€ŸåŠ©AIæ¥åˆ†æå¤§è‡´é€»è¾‘ã€‚åœ¨å…³é”®åœ°æ–¹åŠ ä¸Šæ³¨é‡Šåçš„å‡½æ•°å¦‚ä¸‹</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><code class="hljs C++"><span class="hljs-function">__int64 __fastcall <span class="hljs-title">sub_140005769</span><span class="hljs-params">(__int64 a1, __int64 a2, _QWORD *a3, <span class="hljs-type">int</span> a4)</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-type">int</span> v4; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">char</span> v5; <span class="hljs-comment">// bl</span><br>  <span class="hljs-type">int</span> v6; <span class="hljs-comment">// esi</span><br>  <span class="hljs-type">int</span> v7; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v8; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v9; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">char</span> v10; <span class="hljs-comment">// bl</span><br>  <span class="hljs-type">int</span> v11; <span class="hljs-comment">// esi</span><br>  <span class="hljs-type">int</span> v12; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v13; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v14; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">char</span> v15; <span class="hljs-comment">// bl</span><br>  __int64 v16; <span class="hljs-comment">// rsi</span><br>  <span class="hljs-type">int</span> v17; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v18; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v19; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v20; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v21; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v22; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v23; <span class="hljs-comment">// ebx</span><br>  <span class="hljs-type">int</span> v24; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v25; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v26; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v27; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v28; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v29; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v30; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v31; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v32; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v33; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v34; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v35; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v36; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v37; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v38; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v39; <span class="hljs-comment">// r9d</span><br>  __int64 v40; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">int</span> v41; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v42; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v43; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v44; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v45; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v46; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v47; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v48; <span class="hljs-comment">// r9d</span><br>  __int64 v49; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">int</span> v50; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v51; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v52; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v53; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v54; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v55; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v56; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v57; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v58; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v59; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v60; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v61; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v62; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v63; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v64; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v65; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v66; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v67; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v68; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v69; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v70; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v71; <span class="hljs-comment">// r9d</span><br>  __int64 v72; <span class="hljs-comment">// rbx</span><br>  <span class="hljs-type">int</span> v73; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v74; <span class="hljs-comment">// r9d</span><br>  __int64 v75; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">int</span> v76; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v77; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v78; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v79; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v80; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v81; <span class="hljs-comment">// r9d</span><br>  __int64 v82; <span class="hljs-comment">// rbx</span><br>  <span class="hljs-type">int</span> v83; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v84; <span class="hljs-comment">// r9d</span><br>  __int64 v85; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">int</span> v86; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v87; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v88; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v89; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v90; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v91; <span class="hljs-comment">// r9d</span><br>  __int64 v92; <span class="hljs-comment">// rdx</span><br>  <span class="hljs-type">int</span> v93; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v94; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v95; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v96; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v97; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v98; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v99; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v100; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v101; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v102; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v103; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v104; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v105; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v106; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v107; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v108; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v109; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v110; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v111; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v112; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v113; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v114; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v115; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v116; <span class="hljs-comment">// r9d</span><br>  __int64 v117; <span class="hljs-comment">// rdx</span><br>  <span class="hljs-type">int</span> v118; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v119; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v120; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">int</span> v121; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v122; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">char</span> v123; <span class="hljs-comment">// r12</span><br>  <span class="hljs-type">char</span> v124; <span class="hljs-comment">// r13</span><br>  <span class="hljs-type">char</span> v125; <span class="hljs-comment">// r14</span><br>  <span class="hljs-type">char</span> v126; <span class="hljs-comment">// r15</span><br>  <span class="hljs-type">int</span> v127; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v128; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v129; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v130; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v131; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v132; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v133; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v134; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v135; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v136; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v137; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v138; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v139; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v140; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v141; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v142; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v143; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v144; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v145; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v146; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v147; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v148; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v149; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v150; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v151; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v152; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v153; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v154; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v155; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v156; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v157; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">char</span> v158; <span class="hljs-comment">// bl</span><br>  <span class="hljs-type">int</span> v159; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v160; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v161; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v162; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v163; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v164; <span class="hljs-comment">// r9d</span><br>  __int64 v165; <span class="hljs-comment">// rbx</span><br>  <span class="hljs-type">int</span> v166; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v167; <span class="hljs-comment">// r9d</span><br>  __int64 v168; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">int</span> v169; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v170; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v171; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v172; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v173; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v174; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v175; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v176; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v177; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v178; <span class="hljs-comment">// r9d</span><br>  __int64 v179; <span class="hljs-comment">// rdx</span><br>  __int64 v180; <span class="hljs-comment">// rdx</span><br>  <span class="hljs-type">int</span> v181; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v182; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v183; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v184; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v185; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v186; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v187; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">char</span> v188; <span class="hljs-comment">// bl</span><br>  <span class="hljs-type">int</span> v189; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v190; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v191; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v192; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v193; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v194; <span class="hljs-comment">// r9d</span><br>  __int64 v195; <span class="hljs-comment">// rbx</span><br>  <span class="hljs-type">int</span> v196; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v197; <span class="hljs-comment">// r9d</span><br>  __int64 v198; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">int</span> v199; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v200; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v201; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v202; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v203; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v204; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v205; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v206; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v207; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v208; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v209; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v210; <span class="hljs-comment">// r9d</span><br>  __int64 v211; <span class="hljs-comment">// rdx</span><br>  __int64 v212; <span class="hljs-comment">// rdx</span><br>  <span class="hljs-type">int</span> v213; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v214; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v215; <span class="hljs-comment">// r9d</span><br>  __int64 v216; <span class="hljs-comment">// rdx</span><br>  <span class="hljs-type">int</span> v217; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v218; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v219; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v220; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v221; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v222; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v223; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v224; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v225; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v226; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v227; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v228; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v229; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v230; <span class="hljs-comment">// r9d</span><br>  __int64 v232; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v233; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v234; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v235; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v236; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v237; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v238; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v239; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v240; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v241; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v242; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v243; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v244; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v245; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v246; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v247; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v248; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v249; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v250; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v251; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v252; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v253; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v254; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v255; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v256; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v257; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v258; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v259; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v260; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v261; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v262; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v263; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v264; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v265; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v266; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v267; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v268; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v269; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v270; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v271; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v272; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v273; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v274; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v275; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v276; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v277; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v278; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v279; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v280; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v281; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v282; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v283; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  HCRYPTKEY v284; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v285; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v286; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v287; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v288; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v289; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v290; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v291; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v292; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v293; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v294; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v295; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  HCRYPTKEY v296; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v297; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v298; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v299; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v300; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v301; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v302; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span><br>  __int64 v303; <span class="hljs-comment">// [rsp+8h] [rbp-78h]</span><br>  __int64 v304; <span class="hljs-comment">// [rsp+8h] [rbp-78h]</span><br>  __int64 v305; <span class="hljs-comment">// [rsp+8h] [rbp-78h]</span><br>  __int64 v306; <span class="hljs-comment">// [rsp+8h] [rbp-78h]</span><br>  __int64 v307; <span class="hljs-comment">// [rsp+8h] [rbp-78h]</span><br>  __int64 v308; <span class="hljs-comment">// [rsp+8h] [rbp-78h]</span><br>  __int64 v309; <span class="hljs-comment">// [rsp+8h] [rbp-78h]</span><br>  __int64 v310; <span class="hljs-comment">// [rsp+8h] [rbp-78h]</span><br>  __int64 v311; <span class="hljs-comment">// [rsp+8h] [rbp-78h]</span><br>  __int64 v312; <span class="hljs-comment">// [rsp+8h] [rbp-78h]</span><br>  __int64 v313; <span class="hljs-comment">// [rsp+8h] [rbp-78h]</span><br>  __int64 v314; <span class="hljs-comment">// [rsp+8h] [rbp-78h]</span><br>  __int64 v315; <span class="hljs-comment">// [rsp+8h] [rbp-78h]</span><br>  __int64 v316; <span class="hljs-comment">// [rsp+8h] [rbp-78h]</span><br>  __int64 v317; <span class="hljs-comment">// [rsp+8h] [rbp-78h]</span><br>  __int64 v318; <span class="hljs-comment">// [rsp+8h] [rbp-78h]</span><br>  __int64 v319; <span class="hljs-comment">// [rsp+8h] [rbp-78h]</span><br>  __int64 v320; <span class="hljs-comment">// [rsp+8h] [rbp-78h]</span><br>  __int64 v321; <span class="hljs-comment">// [rsp+8h] [rbp-78h]</span><br>  __int64 v322; <span class="hljs-comment">// [rsp+8h] [rbp-78h]</span><br>  __int64 v323; <span class="hljs-comment">// [rsp+8h] [rbp-78h]</span><br>  __int64 v324; <span class="hljs-comment">// [rsp+8h] [rbp-78h]</span><br>  __int64 v325; <span class="hljs-comment">// [rsp+8h] [rbp-78h]</span><br>  __int64 v326; <span class="hljs-comment">// [rsp+8h] [rbp-78h]</span><br>  __int64 v327; <span class="hljs-comment">// [rsp+8h] [rbp-78h]</span><br>  __int64 v328; <span class="hljs-comment">// [rsp+8h] [rbp-78h]</span><br>  __int64 v329; <span class="hljs-comment">// [rsp+8h] [rbp-78h]</span><br>  __int64 v330; <span class="hljs-comment">// [rsp+8h] [rbp-78h]</span><br>  __int64 v331; <span class="hljs-comment">// [rsp+8h] [rbp-78h]</span><br>  __int64 v332; <span class="hljs-comment">// [rsp+8h] [rbp-78h]</span><br>  __int64 v333; <span class="hljs-comment">// [rsp+8h] [rbp-78h]</span><br>  __int64 v334; <span class="hljs-comment">// [rsp+8h] [rbp-78h]</span><br>  __int64 v335; <span class="hljs-comment">// [rsp+8h] [rbp-78h]</span><br>  __int64 v336; <span class="hljs-comment">// [rsp+8h] [rbp-78h]</span><br>  __int64 v337; <span class="hljs-comment">// [rsp+8h] [rbp-78h]</span><br>  __int64 v338; <span class="hljs-comment">// [rsp+8h] [rbp-78h]</span><br>  __int64 v339; <span class="hljs-comment">// [rsp+8h] [rbp-78h]</span><br>  <span class="hljs-type">int</span> v340; <span class="hljs-comment">// [rsp+10h] [rbp-70h]</span><br>  <span class="hljs-type">int</span> v341; <span class="hljs-comment">// [rsp+10h] [rbp-70h]</span><br>  __int64 v342; <span class="hljs-comment">// [rsp+10h] [rbp-70h]</span><br>  <span class="hljs-type">int</span> v343; <span class="hljs-comment">// [rsp+10h] [rbp-70h]</span><br>  <span class="hljs-type">int</span> v344; <span class="hljs-comment">// [rsp+10h] [rbp-70h]</span><br>  __int64 v345; <span class="hljs-comment">// [rsp+10h] [rbp-70h]</span><br>  <span class="hljs-type">char</span> v346; <span class="hljs-comment">// [rsp+30h] [rbp-50h]</span><br>  <span class="hljs-type">char</span> v347; <span class="hljs-comment">// [rsp+38h] [rbp-48h]</span><br>  _BYTE v348[<span class="hljs-number">48</span>]; <span class="hljs-comment">// [rsp+40h] [rbp-40h] BYREF</span><br>  _BYTE v349[<span class="hljs-number">48</span>]; <span class="hljs-comment">// [rsp+70h] [rbp-10h] BYREF</span><br>  <span class="hljs-type">int</span> v350[<span class="hljs-number">124</span>]; <span class="hljs-comment">// [rsp+A0h] [rbp+20h] BYREF</span><br>  <span class="hljs-type">int</span> v351[<span class="hljs-number">124</span>]; <span class="hljs-comment">// [rsp+290h] [rbp+210h] BYREF</span><br>  _BYTE v352[<span class="hljs-number">16</span>]; <span class="hljs-comment">// [rsp+480h] [rbp+400h] BYREF</span><br>  _BYTE v353[<span class="hljs-number">16</span>]; <span class="hljs-comment">// [rsp+490h] [rbp+410h] BYREF</span><br>  BYTE v354[<span class="hljs-number">28</span>]; <span class="hljs-comment">// [rsp+4A0h] [rbp+420h] BYREF</span><br>  BYTE v355[<span class="hljs-number">4</span>]; <span class="hljs-comment">// [rsp+4BCh] [rbp+43Ch] BYREF</span><br>  BYTE pbData[<span class="hljs-number">2</span>]; <span class="hljs-comment">// [rsp+4C0h] [rbp+440h] BYREF</span><br>  __int16 v357; <span class="hljs-comment">// [rsp+4C2h] [rbp+442h]</span><br>  <span class="hljs-type">int</span> v358; <span class="hljs-comment">// [rsp+4C4h] [rbp+444h]</span><br>  <span class="hljs-type">int</span> v359; <span class="hljs-comment">// [rsp+4C8h] [rbp+448h]</span><br>  __int64 v360; <span class="hljs-comment">// [rsp+4CCh] [rbp+44Ch]</span><br>  __int64 v361; <span class="hljs-comment">// [rsp+4D4h] [rbp+454h]</span><br>  __int64 v362; <span class="hljs-comment">// [rsp+4DCh] [rbp+45Ch]</span><br>  __int64 v363; <span class="hljs-comment">// [rsp+4E4h] [rbp+464h]</span><br>  _BYTE IV[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [rsp+4F0h] [rbp+470h] BYREF IV</span><br>  _BYTE key[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [rsp+510h] [rbp+490h] BYREF å¯†é’¥</span><br>  BYTE MODE[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [rsp+530h] [rbp+4B0h] BYREF æ¨¡å¼å‚æ•°</span><br>  BYTE v367[<span class="hljs-number">16</span>]; <span class="hljs-comment">// [rsp+550h] [rbp+4D0h] BYREF</span><br>  BYTE pbBuffer[<span class="hljs-number">8</span>]; <span class="hljs-comment">// [rsp+560h] [rbp+4E0h] BYREF</span><br>  __int64 v369; <span class="hljs-comment">// [rsp+568h] [rbp+4E8h]</span><br>  __int64 v370; <span class="hljs-comment">// [rsp+570h] [rbp+4F0h]</span><br>  __int64 v371; <span class="hljs-comment">// [rsp+578h] [rbp+4F8h]</span><br>  HCRYPTKEY hKey; <span class="hljs-comment">// [rsp+588h] [rbp+508h] BYREF</span><br>  HCRYPTPROV phProv; <span class="hljs-comment">// [rsp+590h] [rbp+510h] BYREF</span><br>  <span class="hljs-type">char</span> v374; <span class="hljs-comment">// [rsp+59Ah] [rbp+51Ah] BYREF</span><br>  <span class="hljs-type">char</span> v375; <span class="hljs-comment">// [rsp+59Bh] [rbp+51Bh] BYREF</span><br>  <span class="hljs-type">char</span> v376; <span class="hljs-comment">// [rsp+59Ch] [rbp+51Ch] BYREF</span><br>  <span class="hljs-type">char</span> v377; <span class="hljs-comment">// [rsp+59Dh] [rbp+51Dh] BYREF</span><br>  <span class="hljs-type">char</span> v378; <span class="hljs-comment">// [rsp+59Eh] [rbp+51Eh] BYREF</span><br>  <span class="hljs-type">char</span> v379; <span class="hljs-comment">// [rsp+59Fh] [rbp+51Fh] BYREF</span><br>  _BYTE v380[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [rsp+5A0h] [rbp+520h] BYREF</span><br>  _BYTE v381[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [rsp+5C0h] [rbp+540h] BYREF</span><br>  _BYTE v382[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [rsp+5E0h] [rbp+560h] BYREF</span><br>  _BYTE v383[<span class="hljs-number">16</span>]; <span class="hljs-comment">// [rsp+600h] [rbp+580h] BYREF</span><br>  _BYTE v384[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [rsp+610h] [rbp+590h] BYREF</span><br>  _BYTE v385[<span class="hljs-number">16</span>]; <span class="hljs-comment">// [rsp+630h] [rbp+5B0h] BYREF</span><br>  _BYTE v386[<span class="hljs-number">16</span>]; <span class="hljs-comment">// [rsp+640h] [rbp+5C0h] BYREF</span><br>  _BYTE v387[<span class="hljs-number">16</span>]; <span class="hljs-comment">// [rsp+650h] [rbp+5D0h] BYREF</span><br>  _BYTE v388[<span class="hljs-number">16</span>]; <span class="hljs-comment">// [rsp+660h] [rbp+5E0h] BYREF</span><br>  _BYTE v389[<span class="hljs-number">16</span>]; <span class="hljs-comment">// [rsp+670h] [rbp+5F0h] BYREF</span><br>  _BYTE v390[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [rsp+680h] [rbp+600h] BYREF</span><br>  _BYTE v391[<span class="hljs-number">16</span>]; <span class="hljs-comment">// [rsp+6A0h] [rbp+620h] BYREF</span><br>  _BYTE v392[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [rsp+6B0h] [rbp+630h] BYREF</span><br>  _BYTE v393[<span class="hljs-number">16</span>]; <span class="hljs-comment">// [rsp+6D0h] [rbp+650h] BYREF</span><br>  _BYTE v394[<span class="hljs-number">48</span>]; <span class="hljs-comment">// [rsp+6E0h] [rbp+660h] BYREF</span><br>  _BYTE v395[<span class="hljs-number">16</span>]; <span class="hljs-comment">// [rsp+710h] [rbp+690h] BYREF</span><br>  _BYTE v396[<span class="hljs-number">16</span>]; <span class="hljs-comment">// [rsp+720h] [rbp+6A0h] BYREF</span><br>  _BYTE v397[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [rsp+730h] [rbp+6B0h] BYREF</span><br>  _BYTE v398[<span class="hljs-number">48</span>]; <span class="hljs-comment">// [rsp+750h] [rbp+6D0h] BYREF</span><br>  _BYTE v399[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [rsp+780h] [rbp+700h] BYREF</span><br>  _BYTE v400[<span class="hljs-number">48</span>]; <span class="hljs-comment">// [rsp+7A0h] [rbp+720h] BYREF</span><br>  _BYTE v401[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [rsp+7D0h] [rbp+750h] BYREF</span><br>  _BYTE v402[<span class="hljs-number">48</span>]; <span class="hljs-comment">// [rsp+7F0h] [rbp+770h] BYREF</span><br>  _BYTE v403[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [rsp+820h] [rbp+7A0h] BYREF</span><br>  _BYTE v404[<span class="hljs-number">48</span>]; <span class="hljs-comment">// [rsp+840h] [rbp+7C0h] BYREF</span><br>  _BYTE v405[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [rsp+870h] [rbp+7F0h] BYREF</span><br>  _BYTE v406[<span class="hljs-number">48</span>]; <span class="hljs-comment">// [rsp+890h] [rbp+810h] BYREF</span><br>  _BYTE v407[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [rsp+8C0h] [rbp+840h] BYREF</span><br>  _BYTE v408[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [rsp+8E0h] [rbp+860h] BYREF</span><br>  _BYTE v409[<span class="hljs-number">48</span>]; <span class="hljs-comment">// [rsp+900h] [rbp+880h] BYREF</span><br>  _BYTE v410[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [rsp+930h] [rbp+8B0h] BYREF</span><br>  _BYTE v411[<span class="hljs-number">40</span>]; <span class="hljs-comment">// [rsp+950h] [rbp+8D0h] BYREF</span><br>  <span class="hljs-type">char</span> *v412; <span class="hljs-comment">// [rsp+978h] [rbp+8F8h]</span><br>  <span class="hljs-type">char</span> *v413; <span class="hljs-comment">// [rsp+980h] [rbp+900h]</span><br>  <span class="hljs-type">char</span> *v414; <span class="hljs-comment">// [rsp+988h] [rbp+908h]</span><br>  <span class="hljs-type">char</span> *v415; <span class="hljs-comment">// [rsp+990h] [rbp+910h]</span><br>  <span class="hljs-type">char</span> *v416; <span class="hljs-comment">// [rsp+998h] [rbp+918h]</span><br>  <span class="hljs-type">char</span> *v417; <span class="hljs-comment">// [rsp+9A0h] [rbp+920h]</span><br>  __int64 v418; <span class="hljs-comment">// [rsp+9A8h] [rbp+928h]</span><br>  BYTE *v419; <span class="hljs-comment">// [rsp+9B0h] [rbp+930h]</span><br>  <span class="hljs-type">char</span> v420; <span class="hljs-comment">// [rsp+9BFh] [rbp+93Fh]</span><br><br>  <span class="hljs-built_in">sub_140006CC0</span>();<br>  v420 = <span class="hljs-number">0</span>;<br>  v5 = <span class="hljs-number">0</span>;<br>  v6 = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">if</span> ( a4 &lt;= <span class="hljs-number">1</span> )                                <span class="hljs-comment">// æ­¤å¤„å¼€å§‹è§£æå‘½ä»¤è¡Œå‚æ•°ï¼Œè¿™æ˜¯ç¬¬ä¸€ä¸ªå‚æ•°çš„å¤„ç†</span><br>  &#123;<br>    v416 = &amp;v375;<br>    v6 = <span class="hljs-number">1</span>;<br>    <span class="hljs-built_in">sub_14000B350</span>(a1, <span class="hljs-number">1</span>, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)&amp;unk_<span class="hljs-number">14000E1</span>D0, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)MODE, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)&amp;v375, v4);<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    v417 = &amp;v374;<br>    v5 = <span class="hljs-number">1</span>;<br>    <span class="hljs-built_in">sub_14000B350</span>(a1, <span class="hljs-number">0</span>, a3[<span class="hljs-number">1</span>], (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)MODE, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)&amp;v374, v4);<br>  &#125;<br>  <span class="hljs-keyword">if</span> ( (_BYTE)v6 )<br>    <span class="hljs-built_in">sub_140009C30</span>(a1, v6, v7, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)&amp;v375, v8, v9);<br>  <span class="hljs-keyword">if</span> ( v5 )<br>    <span class="hljs-built_in">sub_140009C30</span>(a1, v6, v7, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)&amp;v374, v8, v9);<br>  v10 = <span class="hljs-number">0</span>;<br>  v11 = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">if</span> ( a4 &lt;= <span class="hljs-number">2</span> )                                <span class="hljs-comment">// è¿™æ˜¯ç¬¬äºŒä¸ªå‚æ•°çš„å¤„ç†</span><br>  &#123;<br>    v414 = &amp;v377;<br>    v11 = <span class="hljs-number">1</span>;<br>    <span class="hljs-built_in">sub_14000B350</span>(a1, <span class="hljs-number">1</span>, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)&amp;unk_<span class="hljs-number">14000E1</span>D0, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)key, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)&amp;v377, v9);<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    v415 = &amp;v376;<br>    v10 = <span class="hljs-number">1</span>;<br>    <span class="hljs-built_in">sub_14000B350</span>(a1, <span class="hljs-number">0</span>, a3[<span class="hljs-number">2</span>], (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)key, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)&amp;v376, v9);<br>  &#125;<br>  <span class="hljs-keyword">if</span> ( (_BYTE)v11 )<br>    <span class="hljs-built_in">sub_140009C30</span>(a1, v11, v12, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)&amp;v377, v13, v14);<br>  <span class="hljs-keyword">if</span> ( v10 )<br>    <span class="hljs-built_in">sub_140009C30</span>(a1, v11, v12, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)&amp;v376, v13, v14);<br>  v15 = <span class="hljs-number">0</span>;<br>  v16 = <span class="hljs-number">0LL</span>;<br>  <span class="hljs-keyword">if</span> ( a4 &lt;= <span class="hljs-number">3</span> )                                <span class="hljs-comment">// è¿™æ˜¯ç¬¬ä¸‰ä¸ªå‚æ•°çš„å¤„ç†</span><br>  &#123;<br>    v412 = &amp;v379;<br>    v16 = <span class="hljs-number">1LL</span>;<br>    <span class="hljs-built_in">sub_14000B350</span>(a1, <span class="hljs-number">1</span>, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)&amp;unk_<span class="hljs-number">14000E1</span>D0, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)IV, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)&amp;v379, v14);<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    v413 = &amp;v378;<br>    v15 = <span class="hljs-number">1</span>;<br>    <span class="hljs-built_in">sub_14000B350</span>(a1, <span class="hljs-number">0</span>, a3[<span class="hljs-number">3</span>], (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)IV, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)&amp;v378, v14);<br>  &#125;<br>  <span class="hljs-keyword">if</span> ( (_BYTE)v16 )<br>    <span class="hljs-built_in">sub_140009C30</span>(a1, v16, v17, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)&amp;v379, v18, v19);<br>  <span class="hljs-keyword">if</span> ( v15 )<br>    <span class="hljs-built_in">sub_140009C30</span>(a1, v16, v17, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)&amp;v378, v18, v19);<br>  <span class="hljs-keyword">if</span> ( <span class="hljs-built_in">CryptAcquireContextA</span>(&amp;phProv, <span class="hljs-number">0LL</span>, <span class="hljs-number">0LL</span>, <span class="hljs-number">0x18u</span>, <span class="hljs-number">0xF0000000</span>) )<span class="hljs-comment">// ä½¿ç”¨Microsoft CryptoAPIï¼Œ0X18è¡¨ç¤ºPROV_RSA_AESï¼Œç¨‹åºä½¿ç”¨RSAåŠ å¯†å¯†é’¥å’ŒIVå‘é€åˆ°æœåŠ¡å™¨</span><br>  &#123;<br>    <span class="hljs-keyword">if</span> ( a4 &lt;= <span class="hljs-number">3</span> )<br>    &#123;<br>      <span class="hljs-keyword">if</span> ( !<span class="hljs-built_in">CryptGenRandom</span>(phProv, <span class="hljs-number">0x20u</span>, pbBuffer) )<span class="hljs-comment">// ç”Ÿæˆ32å­—èŠ‚éšæœºå¯†é’¥</span><br>      &#123;<br>        v23 = <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">goto</span> LABEL_63;<br>      &#125;<br>      <span class="hljs-keyword">if</span> ( !<span class="hljs-built_in">CryptGenRandom</span>(phProv, <span class="hljs-number">0x10u</span>, v367) )<span class="hljs-comment">// ç”Ÿæˆ16å­—èŠ‚éšæœºIV</span><br>      &#123;<br>        v23 = <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">goto</span> LABEL_63;<br>      &#125;<br>      <span class="hljs-built_in">sub_1400028FE</span>(a1, v16, (__int64)pbBuffer, (__int64)v387, <span class="hljs-number">32</span>);<br>      <span class="hljs-built_in">sub_140005071</span>(a1, v16, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v387, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v386, v56, v57, v232, v308);<span class="hljs-comment">// ç–‘ä¼¼åŠ å¯†å‡½æ•°</span><br>      <span class="hljs-built_in">sub_140003D46</span>(a1, v16, <span class="hljs-number">0x1F90u</span>, (<span class="hljs-type">int</span>)v386);<span class="hljs-comment">// ç–‘ä¼¼ç½‘ç»œé€šä¿¡çš„å‡½æ•°</span><br>      <span class="hljs-built_in">sub_1400029A2</span>(a1, v16, v58, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v386, v59, v60, v243);<br>      <span class="hljs-built_in">sub_1400029A2</span>(a1, v16, v61, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v387, v62, v63, v244);<br>      <span class="hljs-built_in">sub_1400028FE</span>(a1, v16, (__int64)v367, (__int64)v389, <span class="hljs-number">16</span>);<br>      <span class="hljs-built_in">sub_140005071</span>(a1, v16, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v389, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v388, v64, v65, v245, v309);<br>      <span class="hljs-built_in">sub_140003D46</span>(a1, v16, <span class="hljs-number">0x1F90u</span>, (<span class="hljs-type">int</span>)v388);<br>      <span class="hljs-built_in">sub_1400029A2</span>(a1, v16, v66, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v388, v67, v68, v246);<br>      <span class="hljs-built_in">sub_1400029A2</span>(a1, v16, v69, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v389, v70, v71, v247);<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>      <span class="hljs-keyword">if</span> ( <span class="hljs-built_in">sub_14000C650</span>(a1, v16, (<span class="hljs-type">int</span>)<span class="hljs-string">&quot;-d&quot;</span>, (<span class="hljs-type">int</span>)MODE, v21, v22) )<br>        v420 = <span class="hljs-number">1</span>;                               <span class="hljs-comment">// å‘½ä»¤è¡Œå‚æ•°åŒ…å«&quot;-d&quot;çš„æ—¶å€™ï¼Œv449è¢«è®¾ä¸º1ï¼Œè¿›å…¥è§£å¯†æ¨¡å¼</span><br>      <span class="hljs-built_in">sub_14000B130</span>(a1, v16, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)key, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v380, v24, v25, v232, v303);<span class="hljs-comment">// ä»å‘½ä»¤è¡Œè·å–key</span><br>      <span class="hljs-built_in">sub_1400051EC</span>(a1, v16, (__int64)pbBuffer, (<span class="hljs-type">int</span>)v380, v26, v27);<span class="hljs-comment">// å¤„ç†key</span><br>      <span class="hljs-built_in">sub_14000B400</span>(a1, v16, v28, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v380, v29, v30, v233);<br>      <span class="hljs-built_in">sub_14000B130</span>(a1, v16, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)IV, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v381, v31, v32, v234, v304);<span class="hljs-comment">// ä»å‘½ä»¤è¡Œè·å–IV</span><br>      <span class="hljs-built_in">sub_1400051EC</span>(a1, v16, (__int64)v367, (<span class="hljs-type">int</span>)v381, v33, v34);<span class="hljs-comment">// å¤„ç†IV</span><br>      <span class="hljs-built_in">sub_14000B400</span>(a1, v16, v35, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v381, v36, v37, v235);<br>      <span class="hljs-built_in">sub_1400028FE</span>(a1, v16, (__int64)pbBuffer, (__int64)v383, <span class="hljs-number">32</span>);<br>      <span class="hljs-built_in">sub_140001534</span>(a1, v16, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v383, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v382, v38, v39, v236, v305);<br>      v40 = std::<span class="hljs-keyword">operator</span>&lt;&lt;&lt;<span class="hljs-type">char</span>&gt;(a1, v16, v382, &amp;std::cout);<br>      std::ostream::<span class="hljs-keyword">operator</span>&lt;&lt;(a1, v16, &amp;std::endl&lt;<span class="hljs-type">char</span>,std::char_traits&lt;<span class="hljs-type">char</span>&gt;&gt;, v40);<br>      <span class="hljs-built_in">sub_14000B400</span>(a1, v16, v41, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v382, v42, v43, v237);<br>      <span class="hljs-built_in">sub_1400029A2</span>(a1, v16, v44, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v383, v45, v46, v238);<br>      <span class="hljs-built_in">sub_1400028FE</span>(a1, v16, (__int64)v367, (__int64)v385, <span class="hljs-number">16</span>);<br>      <span class="hljs-built_in">sub_140001534</span>(a1, v16, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v385, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v384, v47, v48, v239, v306);<br>      v49 = std::<span class="hljs-keyword">operator</span>&lt;&lt;&lt;<span class="hljs-type">char</span>&gt;(a1, v16, v384, &amp;std::cout);<br>      std::ostream::<span class="hljs-keyword">operator</span>&lt;&lt;(a1, v16, &amp;std::endl&lt;<span class="hljs-type">char</span>,std::char_traits&lt;<span class="hljs-type">char</span>&gt;&gt;, v49);<br>      <span class="hljs-built_in">sub_14000B400</span>(a1, v16, v50, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v384, v51, v52, v240);<br>      <span class="hljs-built_in">sub_1400029A2</span>(a1, v16, v53, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v385, v54, v55, v241);<br>    &#125;<br>    v72 = std::<span class="hljs-keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="hljs-type">char</span>&gt;&gt;(a1, v16, <span class="hljs-string">&quot;Key: &quot;</span>, &amp;std::cout);<br>    <span class="hljs-built_in">sub_1400028FE</span>(a1, v16, (__int64)pbBuffer, (__int64)v391, <span class="hljs-number">32</span>);<br>    <span class="hljs-built_in">sub_140001534</span>(a1, v16, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v391, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v390, v73, v74, v242, v307);<br>    v75 = std::<span class="hljs-keyword">operator</span>&lt;&lt;&lt;<span class="hljs-type">char</span>&gt;(a1, v16, v390, v72);<br>    std::ostream::<span class="hljs-keyword">operator</span>&lt;&lt;(a1, v16, &amp;std::endl&lt;<span class="hljs-type">char</span>,std::char_traits&lt;<span class="hljs-type">char</span>&gt;&gt;, v75);<br>    <span class="hljs-built_in">sub_14000B400</span>(a1, v16, v76, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v390, v77, v78, v248);<br>    <span class="hljs-built_in">sub_1400029A2</span>(a1, v16, v79, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v391, v80, v81, v249);<br>    v82 = std::<span class="hljs-keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="hljs-type">char</span>&gt;&gt;(a1, v16, <span class="hljs-string">&quot;IV: &quot;</span>, &amp;std::cout);<br>    <span class="hljs-built_in">sub_1400028FE</span>(a1, v16, (__int64)v367, (__int64)v393, <span class="hljs-number">16</span>);<br>    <span class="hljs-built_in">sub_140001534</span>(a1, v16, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v393, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v392, v83, v84, v250, v310);<br>    v85 = std::<span class="hljs-keyword">operator</span>&lt;&lt;&lt;<span class="hljs-type">char</span>&gt;(a1, v16, v392, v82);<br>    std::ostream::<span class="hljs-keyword">operator</span>&lt;&lt;(a1, v16, &amp;std::endl&lt;<span class="hljs-type">char</span>,std::char_traits&lt;<span class="hljs-type">char</span>&gt;&gt;, v85);<br>    <span class="hljs-built_in">sub_14000B400</span>(a1, v16, v86, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v392, v87, v88, v251);<br>    <span class="hljs-built_in">sub_1400029A2</span>(a1, v16, v89, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v393, v90, v91, v252);<br>    pbData[<span class="hljs-number">0</span>] = <span class="hljs-number">8</span>;<br>    pbData[<span class="hljs-number">1</span>] = <span class="hljs-number">2</span>;<br>    v357 = <span class="hljs-number">0</span>;<br>    v358 = <span class="hljs-number">26128</span>;<br>    v359 = <span class="hljs-number">32</span>;<br>    v360 = *(_QWORD *)pbBuffer;<br>    v361 = v369;<br>    v362 = v370;<br>    v363 = v371;<br>    *(_DWORD *)v355 = <span class="hljs-number">2</span>;<br>    <span class="hljs-built_in">CryptImportKey</span>(phProv, pbData, <span class="hljs-number">0x2Cu</span>, <span class="hljs-number">0LL</span>, <span class="hljs-number">0</span>, &amp;hKey);<span class="hljs-comment">// å¯¼å…¥å¯†é’¥</span><br>    <span class="hljs-built_in">CryptSetKeyParam</span>(hKey, <span class="hljs-number">4u</span>, v355, <span class="hljs-number">0</span>);        <span class="hljs-comment">// è®¾ç½®å¯†é’¥å‚æ•°</span><br>    <span class="hljs-built_in">CryptSetKeyParam</span>(hKey, <span class="hljs-number">1u</span>, v367, <span class="hljs-number">0</span>);        <span class="hljs-comment">// è®¾ç½®IV</span><br>    std::filesystem::current_path[abi:cxx11](a1, v16, v92, v394);<span class="hljs-comment">// è·å–å½“å‰è·¯å¾„</span><br>    <span class="hljs-built_in">sub_140008E50</span>(a1, v16, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v394, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v354, v93, v94, v253, v311);<br>    v419 = v354;<br>    <span class="hljs-built_in">sub_1400091B0</span>(a1, v16, v95, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v394, v96, v97, v254);<br>    <span class="hljs-built_in">sub_140008E90</span>(a1, v16, (_DWORD)v419, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v395, v98, v99, v255, v312);<br>    <span class="hljs-built_in">sub_140009230</span>(a1, v16, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v395, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v353, v100, v101, v256, v313);<br>    <span class="hljs-built_in">sub_140008EE0</span>(a1, v16, v102, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v395, v103, v104, v257);<br>    <span class="hljs-built_in">sub_140008E90</span>(a1, v16, (_DWORD)v419, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v396, v105, v106, v258, v314);<br>    <span class="hljs-built_in">sub_140008F00</span>(a1, v16, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v396, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v352, v107, v108, v259, v315);<br>    <span class="hljs-built_in">sub_140008EE0</span>(a1, v16, v109, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v396, v110, v111, v260);<br>    <span class="hljs-keyword">while</span> ( (<span class="hljs-type">unsigned</span> __int8)<span class="hljs-built_in">sub_1400092E0</span>(a1, v16, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v352, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v353, v112, v113, v261, v316) )<span class="hljs-comment">// éå†å½“å‰è·¯å¾„ä¸‹çš„æ‰€æœ‰æ–‡ä»¶</span><br>    &#123;<br>      v418 = std::filesystem::__cxx11::directory_iterator::<span class="hljs-keyword">operator</span>*(a1, v16, v216, v353);<br>      <span class="hljs-keyword">if</span> ( (<span class="hljs-type">unsigned</span> __int8)<span class="hljs-built_in">sub_1400082F0</span>(a1, v16, v114, v418, v115, v116, v298) == <span class="hljs-number">1</span> )<br>      &#123;<br>        v120 = <span class="hljs-built_in">sub_140008320</span>(a1, v16, v117, v418, v118, v119, v261);<br>        <span class="hljs-built_in">sub_140009030</span>(a1, v16, v120, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v348, v121, v122, v262, v316);<br>        a1 = <span class="hljs-number">0LL</span>;<br>        v123 = <span class="hljs-number">0</span>;<br>        v124 = <span class="hljs-number">0</span>;<br>        v125 = <span class="hljs-number">0</span>;<br>        v126 = <span class="hljs-number">0</span>;<br>        v347 = <span class="hljs-number">0</span>;<br>        <span class="hljs-built_in">sub_140008440</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v348, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v398, v127, v128, v263, v317);<br>        <span class="hljs-built_in">sub_1400083D0</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v398, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v397, v129, v130, v264, v318);<br>        v16 = <span class="hljs-number">1LL</span>;<br>        <span class="hljs-keyword">if</span> ( (<span class="hljs-type">unsigned</span> __int8)<span class="hljs-built_in">sub_14000C6D0</span>(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)<span class="hljs-string">L&quot;.exe&quot;</span>, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v397, v131, v132, v265, v319) )<span class="hljs-comment">// è·³è¿‡exeæ–‡ä»¶</span><br>          <span class="hljs-keyword">goto</span> LABEL_39;<br>        <span class="hljs-built_in">sub_140008440</span>(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v348, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v400, v134, v135, v266, v316);<br>        a1 = <span class="hljs-number">1LL</span>;<br>        <span class="hljs-built_in">sub_1400083D0</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v400, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v399, v136, v137, v267, v320);<br>        v123 = <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">if</span> ( (<span class="hljs-type">unsigned</span> __int8)<span class="hljs-built_in">sub_14000C6D0</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)<span class="hljs-string">&quot;.&quot;</span>, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v399, v138, v139, v268, v321) )<br>          <span class="hljs-keyword">goto</span> LABEL_39;<br>        <span class="hljs-built_in">sub_140008440</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v348, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v402, v134, v135, v266, v316);<br>        v124 = <span class="hljs-number">1</span>;<br>        <span class="hljs-built_in">sub_1400083D0</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v402, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v401, v140, v141, v269, v322);<br>        v125 = <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">if</span> ( (<span class="hljs-type">unsigned</span> __int8)<span class="hljs-built_in">sub_14000C6D0</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)<span class="hljs-string">L&quot;.dec&quot;</span>, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v401, v142, v143, v270, v323)<span class="hljs-comment">// è·³è¿‡decæ–‡ä»¶</span><br>          || (<span class="hljs-built_in">sub_140008440</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v348, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v404, v134, v135, v266, v316),<br>              v126 = <span class="hljs-number">1</span>,<br>              <span class="hljs-built_in">sub_1400083D0</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v404, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v403, v144, v145, v271, v324),<br>              v347 = <span class="hljs-number">1</span>,<br>              (<span class="hljs-type">unsigned</span> __int8)<span class="hljs-built_in">sub_14000C6D0</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)<span class="hljs-string">&quot;.&quot;</span>, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v403, v146, v147, v272, v325)) )<span class="hljs-comment">// è·³è¿‡å½“å‰ç›®å½•çš„.æ–‡ä»¶</span><br>        &#123;<br>LABEL_39:<br>          v346 = <span class="hljs-number">1</span>;<br>        &#125;<br>        <span class="hljs-keyword">else</span><br>        &#123;<br>          v346 = <span class="hljs-number">0</span>;<br>        &#125;<br>        <span class="hljs-keyword">if</span> ( v347 )<br>          <span class="hljs-built_in">sub_14000C290</span>(a1, <span class="hljs-number">1</span>, v133, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v403, v134, v135, v266);<br>        <span class="hljs-keyword">if</span> ( v126 )<br>          <span class="hljs-built_in">sub_1400091B0</span>(a1, <span class="hljs-number">1</span>, v133, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v404, v134, v135, v266);<br>        <span class="hljs-keyword">if</span> ( v125 )<br>          <span class="hljs-built_in">sub_14000C290</span>(a1, <span class="hljs-number">1</span>, v133, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v401, v134, v135, v266);<br>        <span class="hljs-keyword">if</span> ( v124 )<br>          <span class="hljs-built_in">sub_1400091B0</span>(a1, <span class="hljs-number">1</span>, v133, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v402, v134, v135, v266);<br>        <span class="hljs-keyword">if</span> ( v123 )<br>          <span class="hljs-built_in">sub_14000C290</span>(a1, <span class="hljs-number">1</span>, v133, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v399, v134, v135, v266);<br>        <span class="hljs-keyword">if</span> ( (_BYTE)a1 )<br>          <span class="hljs-built_in">sub_1400091B0</span>(a1, <span class="hljs-number">1</span>, v133, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v400, v134, v135, v266);<br>        <span class="hljs-built_in">sub_14000C290</span>(a1, <span class="hljs-number">1</span>, v133, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v397, v134, v135, v266);<br>        <span class="hljs-built_in">sub_1400091B0</span>(a1, <span class="hljs-number">1</span>, v148, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v398, v149, v150, v273);<br>        <span class="hljs-keyword">if</span> ( !v346 )<br>        &#123;<br>          <span class="hljs-keyword">if</span> ( v420 != <span class="hljs-number">1</span> )                      <span class="hljs-comment">// åŠ å¯†æ¨¡å¼</span><br>          &#123;<br>            <span class="hljs-built_in">sub_140008440</span>(a1, <span class="hljs-number">1</span>, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v348, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v406, v152, v153, v274, v316);<br>            <span class="hljs-built_in">sub_1400083D0</span>(a1, <span class="hljs-number">1</span>, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v406, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v405, v154, v155, v275, v326);<br>            v158 = <span class="hljs-built_in">sub_14000C6D0</span>(a1, <span class="hljs-number">1</span>, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)<span class="hljs-string">&quot;.&quot;</span>, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v405, v156, v157, v276, v327);<br>            <span class="hljs-built_in">sub_14000C290</span>(a1, <span class="hljs-number">1</span>, v159, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v405, v160, v161, v277);<br>            <span class="hljs-built_in">sub_1400091B0</span>(a1, <span class="hljs-number">1</span>, v162, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v406, v163, v164, v278);<br>            <span class="hljs-keyword">if</span> ( !v158 )<br>            &#123;<br>              v165 = std::<span class="hljs-keyword">operator</span>&lt;&lt;&lt;<span class="hljs-type">wchar_t</span>,std::char_traits&lt;<span class="hljs-type">wchar_t</span>&gt;&gt;(a1, <span class="hljs-number">1LL</span>, <span class="hljs-string">L&quot;Encrypting file: &quot;</span>, &amp;std::wcout);<br>              <span class="hljs-built_in">sub_1400083D0</span>(a1, <span class="hljs-number">1</span>, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v348, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v407, v166, v167, v274, v316);<br>              v168 = std::<span class="hljs-keyword">operator</span>&lt;&lt;&lt;<span class="hljs-type">wchar_t</span>&gt;(a1, <span class="hljs-number">1LL</span>, v407, v165);<br>              std::wostream::<span class="hljs-keyword">operator</span>&lt;&lt;(a1, <span class="hljs-number">1LL</span>, &amp;std::endl&lt;<span class="hljs-type">wchar_t</span>,std::char_traits&lt;<span class="hljs-type">wchar_t</span>&gt;&gt;, v168);<br>              <span class="hljs-built_in">sub_14000C290</span>(a1, <span class="hljs-number">1</span>, v169, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v407, v170, v171, v279);<br>              <span class="hljs-built_in">sub_140009030</span>(a1, <span class="hljs-number">1</span>, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v348, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v349, v172, v173, v280, v328);<br>              <span class="hljs-built_in">sub_1400091E0</span>(a1, <span class="hljs-number">1</span>, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)<span class="hljs-string">&quot;.&quot;</span>, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v349, v174, v175, v281, v329);<br>              <span class="hljs-built_in">sub_140009B20</span>(a1, <span class="hljs-number">1</span>, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v348, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v351, <span class="hljs-number">4</span>, v176, v282, v330, v340);<span class="hljs-comment">// è¯»å–è¾“å…¥æ–‡ä»¶</span><br>              <span class="hljs-built_in">sub_140009B60</span>(a1, <span class="hljs-number">1</span>, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v349, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v350, <span class="hljs-number">4</span>, v177, v283, v331, v341);<span class="hljs-comment">// å‡†å¤‡è¾“å‡ºæ–‡ä»¶</span><br>              <span class="hljs-built_in">sub_1400052D0</span>(a1, <span class="hljs-number">1</span>, (<span class="hljs-type">int</span>)v351, hKey, (<span class="hljs-type">int</span>)v350, v178, v284, v332, v342);<span class="hljs-comment">// æ‰§è¡ŒåŠ å¯†</span><br>              std::ofstream::~<span class="hljs-built_in">ofstream</span>(a1, <span class="hljs-number">1LL</span>, v179, v350);<br>              std::ifstream::~ifstream(a1, <span class="hljs-number">1LL</span>, v180, v351);<br>              <span class="hljs-built_in">sub_1400091B0</span>(a1, <span class="hljs-number">1</span>, v181, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v349, v182, v183, v285);<br>            &#125;<br>          &#125;<br>          <span class="hljs-keyword">else</span>                                  <span class="hljs-comment">// è§£å¯†æ¨¡å¼</span><br>          &#123;<br>            <span class="hljs-built_in">sub_140008440</span>(a1, <span class="hljs-number">1</span>, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v348, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v409, v152, v153, v274, v316);<br>            <span class="hljs-built_in">sub_1400083D0</span>(a1, <span class="hljs-number">1</span>, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v409, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v408, v184, v185, v286, v333);<br>            v188 = <span class="hljs-built_in">sub_14000C750</span>(a1, <span class="hljs-number">1</span>, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)<span class="hljs-string">&quot;.&quot;</span>, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v408, v186, v187, v287, v334);<br>            <span class="hljs-built_in">sub_14000C290</span>(a1, <span class="hljs-number">1</span>, v189, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v408, v190, v191, v288);<br>            <span class="hljs-built_in">sub_1400091B0</span>(a1, <span class="hljs-number">1</span>, v192, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v409, v193, v194, v289);<br>            <span class="hljs-keyword">if</span> ( !v188 )<br>            &#123;<br>              v195 = std::<span class="hljs-keyword">operator</span>&lt;&lt;&lt;<span class="hljs-type">wchar_t</span>,std::char_traits&lt;<span class="hljs-type">wchar_t</span>&gt;&gt;(a1, <span class="hljs-number">1LL</span>, <span class="hljs-string">L&quot;Decrypting file: &quot;</span>, &amp;std::wcout);<br>              <span class="hljs-built_in">sub_1400083D0</span>(a1, <span class="hljs-number">1</span>, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v348, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v410, v196, v197, v274, v316);<br>              v198 = std::<span class="hljs-keyword">operator</span>&lt;&lt;&lt;<span class="hljs-type">wchar_t</span>&gt;(a1, <span class="hljs-number">1LL</span>, v410, v195);<br>              std::wostream::<span class="hljs-keyword">operator</span>&lt;&lt;(a1, <span class="hljs-number">1LL</span>, &amp;std::endl&lt;<span class="hljs-type">wchar_t</span>,std::char_traits&lt;<span class="hljs-type">wchar_t</span>&gt;&gt;, v198);<br>              <span class="hljs-built_in">sub_14000C290</span>(a1, <span class="hljs-number">1</span>, v199, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v410, v200, v201, v290);<br>              <span class="hljs-built_in">sub_140009030</span>(a1, <span class="hljs-number">1</span>, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v348, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v349, v202, v203, v291, v335);<br>              <span class="hljs-built_in">sub_1400090C0</span>(a1, <span class="hljs-number">1</span>, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)<span class="hljs-string">L&quot;dec&quot;</span>, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v411, <span class="hljs-number">2</span>, v204, v292, v336, v340);<br>              std::filesystem::__cxx11::path::<span class="hljs-built_in">replace_extension</span>(<br>                (std::filesystem::__cxx11::path *)a1,<br>                (<span class="hljs-type">const</span> std::filesystem::__cxx11::path *)<span class="hljs-number">1</span>);<br>              <span class="hljs-built_in">sub_1400091B0</span>(a1, <span class="hljs-number">1</span>, v205, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v411, v206, v207, v293);<br>              <span class="hljs-built_in">sub_140009B20</span>(a1, <span class="hljs-number">1</span>, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v348, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v351, <span class="hljs-number">4</span>, v208, v294, v337, v343);<span class="hljs-comment">// è¯»å–åŠ å¯†æ–‡ä»¶</span><br>              <span class="hljs-built_in">sub_140009B60</span>(a1, <span class="hljs-number">1</span>, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v349, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v350, <span class="hljs-number">4</span>, v209, v295, v338, v344);<span class="hljs-comment">// å‡†å¤‡è¾“å‡ºæ–‡ä»¶</span><br>              <span class="hljs-built_in">sub_140005522</span>(a1, <span class="hljs-number">1</span>, (<span class="hljs-type">int</span>)v351, hKey, (<span class="hljs-type">int</span>)v350, v210, v296, v339, v345);<span class="hljs-comment">// æ‰§è¡Œè§£å¯†</span><br>              std::ofstream::~<span class="hljs-built_in">ofstream</span>(a1, <span class="hljs-number">1LL</span>, v211, v350);<br>              std::ifstream::~ifstream(a1, <span class="hljs-number">1LL</span>, v212, v351);<br>              <span class="hljs-built_in">sub_1400091B0</span>(a1, <span class="hljs-number">1</span>, v213, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v349, v214, v215, v297);<br>            &#125;<br>          &#125;<br>        &#125;<br>        <span class="hljs-built_in">sub_1400091B0</span>(a1, <span class="hljs-number">1</span>, v151, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v348, v152, v153, v274);<br>      &#125;<br>      std::filesystem::__cxx11::directory_iterator::<span class="hljs-keyword">operator</span>++(a1, v16, v117, v353);<br>    &#125;<br>    <span class="hljs-built_in">sub_140008EE0</span>(a1, v16, v216, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v352, v217, v218, v298);<br>    <span class="hljs-built_in">sub_140008EE0</span>(a1, v16, v219, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v353, v220, v221, v299);<br>    <span class="hljs-built_in">sub_140008EE0</span>(a1, v16, v222, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v354, v223, v224, v300);<br>    <span class="hljs-built_in">CryptDestroyKey</span>(hKey);<br>    <span class="hljs-built_in">CryptReleaseContext</span>(phProv, <span class="hljs-number">0</span>);<br>    v23 = <span class="hljs-number">0</span>;<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    v23 = <span class="hljs-number">1</span>;<br>  &#125;<br>LABEL_63:<br>  <span class="hljs-built_in">sub_14000B400</span>(a1, v16, v20, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)IV, v21, v22, v232);<br>  <span class="hljs-built_in">sub_14000B400</span>(a1, v16, v225, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)key, v226, v227, v301);<br>  <span class="hljs-built_in">sub_14000B400</span>(a1, v16, v228, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)MODE, v229, v230, v302);<br>  <span class="hljs-keyword">return</span> v23;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>ä¸‹é¢æ˜¯ç–‘ä¼¼çš„åŠ å¯†å‡½æ•°çš„å†…å®¹</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><code class="hljs C++"><span class="hljs-function">__int64 __fastcall <span class="hljs-title">sub_140005071</span><span class="hljs-params">(<span class="hljs-type">int</span> a1, <span class="hljs-type">int</span> a2, <span class="hljs-type">int</span> a3, __int64 a4, __int64 a5, <span class="hljs-type">int</span> a6)</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-type">int</span> v6; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v7; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v8; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v9; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v10; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v11; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v12; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v13; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v14; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v15; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v16; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v17; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v18; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v19; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v20; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v21; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v22; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v23; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v24; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v25; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v26; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v27; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v28; <span class="hljs-comment">// r9d</span><br>  __int64 v30; <span class="hljs-comment">// [rsp+0h] [rbp-B0h] BYREF</span><br>  __int64 v31; <span class="hljs-comment">// [rsp+8h] [rbp-A8h]</span><br>  __int64 v32; <span class="hljs-comment">// [rsp+10h] [rbp-A0h]</span><br>  __int64 v33; <span class="hljs-comment">// [rsp+18h] [rbp-98h]</span><br>  _BYTE v34[<span class="hljs-number">16</span>]; <span class="hljs-comment">// [rsp+20h] [rbp-90h] BYREF</span><br>  _BYTE v35[<span class="hljs-number">16</span>]; <span class="hljs-comment">// [rsp+30h] [rbp-80h] BYREF</span><br>  _BYTE v36[<span class="hljs-number">47</span>]; <span class="hljs-comment">// [rsp+40h] [rbp-70h] BYREF</span><br>  <span class="hljs-type">char</span> v37; <span class="hljs-comment">// [rsp+6Fh] [rbp-41h] BYREF</span><br>  _BYTE v38[<span class="hljs-number">47</span>]; <span class="hljs-comment">// [rsp+70h] [rbp-40h] BYREF</span><br>  <span class="hljs-type">char</span> v39; <span class="hljs-comment">// [rsp+9Fh] [rbp-11h] BYREF</span><br>  <span class="hljs-type">char</span> *v40; <span class="hljs-comment">// [rsp+A0h] [rbp-10h]</span><br>  <span class="hljs-type">char</span> *v41; <span class="hljs-comment">// [rsp+A8h] [rbp-8h]</span><br><br>  v41 = (<span class="hljs-type">char</span> *)&amp;v30 + <span class="hljs-number">111</span>;<br>  <span class="hljs-built_in">sub_14000B350</span>(<br>    a1,<br>    a2,<br>    (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)<span class="hljs-string">&quot;1294787702630841806287693875819503767329411267154281759595683996937344294354199&quot;</span>,<br>    (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)(&amp;v30 - <span class="hljs-number">14</span>) + <span class="hljs-number">176</span>,<br>    (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)&amp;v30 - <span class="hljs-number">65</span> + <span class="hljs-number">176</span>,<br>    a6);<br>  <span class="hljs-built_in">sub_1400024EE</span>(a1, a2, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v36, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v35, v6, v7, v30, v31);<br>  <span class="hljs-built_in">sub_14000B400</span>(a1, a2, v8, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v36, v9, v10, v30);<br>  <span class="hljs-built_in">sub_140009C30</span>(a1, a2, v11, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)&amp;v37, v12, v13);<br>  v40 = &amp;v39;<br>  <span class="hljs-built_in">sub_14000B350</span>(a1, a2, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)<span class="hljs-string">&quot;65537&quot;</span>, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v38, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)&amp;v39, v14);<span class="hljs-comment">// 65537æ˜¯å…¸å‹RSAåŠ å¯†çš„ç‰¹å¾ï¼Œå› æ­¤æ¨æµ‹æ­¤å‡½æ•°ä¸ºRSAåŠ å¯†</span><br>  <span class="hljs-built_in">sub_1400024EE</span>(a1, a2, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v38, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v34, v15, v16, v30, v31);<br>  <span class="hljs-built_in">sub_14000B400</span>(a1, a2, v17, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v38, v18, v19, v30);<br>  <span class="hljs-built_in">sub_140009C30</span>(a1, a2, v20, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)&amp;v39, v21, v22);<br>  <span class="hljs-built_in">sub_1400031A0</span>(a1, a2, a3, a4, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v34, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v35, v30, v31, v32, v33);<br>  <span class="hljs-built_in">sub_1400029A2</span>(a1, a2, v23, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v34, v24, v25, v30);<br>  <span class="hljs-built_in">sub_1400029A2</span>(a1, a2, v26, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v35, v27, v28, v30);<br>  <span class="hljs-keyword">return</span> a4;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>å¯ä»¥å¾—åˆ°å¦‚ä¸‹çš„å°è±¡ç‚¹ï¼š</p>
<ul>
<li>ç¨‹åºé€šè¿‡å‚æ•°ä¸ªæ•°åˆ¤æ–­ä½¿ç”¨åŠ å¯†æ¨¡å¼è¿˜æ˜¯è§£å¯†æ¨¡å¼ï¼›</li>
<li>ç¨‹åºåœ¨åŠ å¯†æ¨¡å¼ä¸‹ä¼šéå†åŒä¸€è·¯å¾„ä¸‹çš„æ–‡ä»¶å¹¶è¿›è¡ŒåŠ å¯†ï¼Œè¾“å‡º.encæ–‡ä»¶ï¼ŒåŒæ—¶ç¨‹åºä¼šå°†åŠ å¯†ä½¿ç”¨çš„keyå’ŒIVè¿›è¡ŒRSAåŠ å¯†åå‘é€åˆ°æœåŠ¡å™¨ï¼ˆæ­¤å¤–ç”±äºç½‘ç»œé€šä¿¡å‡½æ•°å‡ºç°äº†127.0.0.1ï¼Œæ¨æµ‹æ˜¯æœ¬åœ°æœåŠ¡å™¨ï¼‰ï¼›</li>
<li>ç¨‹åºåœ¨è§£å¯†æ¨¡å¼ä¸‹åªéœ€è¦ä½¿ç”¨Int.exe -d key IVå°±å¯ä»¥è§£å¯†æ–‡ä»¶ã€‚</li>
</ul>
<p>ç»“åˆé™„ä»¶çš„å½¢å¼ï¼ˆé™„ä»¶åŒ…å«ä¸€ä¸ªæµé‡åŒ…ï¼‰ï¼Œå¯ä»¥æ¨æµ‹æœ¬é¢˜çš„çªç ´å£åœ¨äºåˆ†ææµé‡åŒ…æå–å‡ºRSAåŠ å¯†åçš„keyå’ŒIVï¼Œç„¶åå°±å¯ä»¥è§£å¯†å‡ºkeyå’ŒIVï¼Œä½¿ç”¨ç¨‹åºè‡ªå¸¦çš„è§£å¯†åŠŸèƒ½è§£å¯†æ–‡ä»¶ã€‚</p>
<p>å®‰å…¨èµ·è§ï¼Œç¬¬ä¸€æ­¥å…ˆéªŒè¯çŒœæƒ³ã€‚å€ŸåŠ©AIæ­å»ºä¸€ä¸ªæœ¬åœ°æœåŠ¡å™¨æ¥æ¥æ”¶ç¨‹åºçš„é€šä¿¡æ•°æ®</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># æœ¬åœ°æœåŠ¡å™¨è„šæœ¬</span><br><span class="hljs-comment"># fake_server.py</span><br><span class="hljs-keyword">import</span> socket<br>sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)<br>sock.bind((<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>, <span class="hljs-number">8080</span>))<br>sock.listen(<span class="hljs-number">1</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Listening on 127.0.0.1:8080...&quot;</span>)<br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    conn, addr = sock.accept()<br>    data = conn.recv(<span class="hljs-number">1024</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Received <span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(data)&#125;</span> bytes: <span class="hljs-subst">&#123;data.<span class="hljs-built_in">hex</span>()&#125;</span>&quot;</span>)<br>    conn.close()<br></code></pre></td></tr></table></figure>

<p>å¯ç”¨æœåŠ¡å™¨åï¼Œé€šè¿‡å‘½ä»¤è¡Œè¿è¡ŒInt.exeå¯ä»¥çœ‹åˆ°æœ¬æ¬¡åŠ å¯†ä½¿ç”¨çš„keyå’ŒIVï¼Œä»¥åŠå‘é€çš„åè¿›åˆ¶æ•°æ®</p>
<p><img src="/../images/image-20251123115352743.png" alt="è¿è¡ŒInt.exe"></p>
<p>æœåŠ¡å™¨ä¼šæ¥æ”¶åˆ°å¦‚ä¸‹æ•°æ®ï¼ˆæœåŠ¡å™¨æ¥æ”¶çš„æ•°æ®æ˜¯å‘é€çš„æ•°æ®çš„åå…­è¿›åˆ¶å½¢å¼ï¼‰</p>
<p><img src="/../images/image-20251123115421535.png" alt="æœåŠ¡å™¨æ¥æ”¶åˆ°çš„æ•°æ®"></p>
<p><img src="/../images/image-20251123115509065.png" alt="æœåŠ¡å™¨æ¥æ”¶çš„ç¬¬ä¸€ä¸ªæ•°æ®hexè§£ç åå’Œå‘é€çš„ç¬¬ä¸€ä¸ªæ•°æ®å¯¹åº”ä¸Šäº†"></p>
<p>ç„¶åå‚è€ƒ<a href="https://www.freebuf.com/articles/people/166049.html">RSAåŠ å¯†è§£å¯†åŸç†æ·±åº¦å‰–æ</a>å¯ä»¥å†™å‡ºä¸€ä¸ªè„šæœ¬æ¥è§£å¯†</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-comment">#æ±‚è§£d</span><br>p =gmpy2.mpz(<span class="hljs-number">973424135910675582062565817184635606523</span>)<br>q =gmpy2.mpz( <span class="hljs-number">1330137249390799512563582841814876337813</span>)<br>e =gmpy2.mpz(<span class="hljs-number">65537</span>)<br>phi_n= (p - <span class="hljs-number">1</span>) * (q - <span class="hljs-number">1</span>)<br>d = gmpy2.invert(e, phi_n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;d is:&quot;</span>)<br><span class="hljs-built_in">print</span> (d)<br><br><span class="hljs-comment">#è§£å¯†keyå’ŒIV</span><br>n = gmpy2.mpz(<span class="hljs-number">1294787702630841806287693875819503767329411267154281759595683996937344294354199</span>)<br><span class="hljs-comment">#key_rawæ˜¯æœåŠ¡å™¨æ¥æ”¶çš„ç¬¬ä¸€ä¸ªæ•°æ®ï¼Œå³keyåŠ å¯†æ•°æ®çš„åå…­è¿›åˆ¶æ•°æ®æµ</span><br>key_raw=<span class="hljs-string">&quot;31323532333634383535303738343134373534303233363633363831313039303038333936313636303538303434333331323331383735303239343634393636353236373133353939343233363539&quot;</span><br><span class="hljs-comment">#iv_rawæ˜¯æœåŠ¡å™¨æ¥æ”¶çš„ç¬¬äºŒä¸ªæ•°æ®ï¼Œå³ivåŠ å¯†æ•°æ®çš„åå…­è¿›åˆ¶æ•°æ®æµ</span><br>iv_raw=<span class="hljs-string">&quot;393235323537333232303933353132333132353838343232323434353732343930303235353236393838363134393132323438313237363234363634333434323034333234353839393230383333&quot;</span><br><span class="hljs-comment">#åå…­è¿›åˆ¶è§£ç </span><br>key_hexdec=<span class="hljs-built_in">bytes</span>.fromhex(key_raw)<br>iv_hexdec=<span class="hljs-built_in">bytes</span>.fromhex(iv_raw)<br><br>key_enc = gmpy2.mpz(key_hexdec)<br>IV_enc = gmpy2.mpz(iv_hexdec)<br><br><span class="hljs-comment">#RSAè§£å¯†</span><br>key_dec = <span class="hljs-built_in">pow</span>(key_enc, d, n)<br>IV_dec = <span class="hljs-built_in">pow</span>(IV_enc, d, n)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;key (hex):&quot;</span>, <span class="hljs-built_in">hex</span>(key_dec))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;IV (hex):&quot;</span>, <span class="hljs-built_in">hex</span>(IV_dec))<br></code></pre></td></tr></table></figure>

<p>è¿è¡Œè§£å¯†è„šæœ¬å¾—åˆ°å¦‚ä¸‹ï¼Œkeyå’Œivä¸Int.exeçš„è¾“å‡ºä¸€è‡´</p>
<p><img src="/../images/image-20251123120534447.png" alt="è¿è¡Œè§£å¯†è„šæœ¬"></p>
<p>è‡³æ­¤ï¼Œå¯ä»¥ç¡®å®šå‘é€çš„æ•°æ®ä¸ºkeyå’ŒIVçš„RSAåŠ å¯†ç»“æœï¼ŒæœåŠ¡å™¨æ¥æ”¶çš„æ•°æ®æ˜¯åŠ å¯†ç»“æœçš„åå…­è¿›åˆ¶ç¼–ç æ•°æ®ã€‚</p>
<p>æ¥ä¸‹æ¥åˆ†ææµé‡åŒ…æå–åŠ å¯†æ•°æ®æµï¼ˆéœ€è¦ç”¨åˆ°WireSharkï¼‰ã€‚ç”±äºç¨‹åºå°†æ•°æ®å‘é€åˆ°æœ¬åœ°8080ç«¯å£ï¼Œä¸”æ•°æ®é•¿åº¦å¤§çº¦ä¸º78bytesï¼Œæ ¹æ®è¿™ä¸ªç‰¹å¾å¯ä»¥ç­›é€‰å‡ºkeyå’ŒIVçš„æµé‡</p>
<p><img src="/../images/image-20251123121110864.png" alt="keyçš„æµé‡"></p>
<p><img src="/../images/image-20251123121217193.png" alt="IVçš„æµé‡"></p>
<p>å°†æ‰¾åˆ°çš„ä¸¤ä¸²æ•°æ®å¤åˆ¶åˆ°è„šæœ¬çš„key_rawå’Œiv_rawï¼Œå¯ä»¥è§£å¯†å‡ºkeyå’ŒIV</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-comment">#æ±‚è§£d</span><br>p =gmpy2.mpz(<span class="hljs-number">973424135910675582062565817184635606523</span>)<br>q =gmpy2.mpz( <span class="hljs-number">1330137249390799512563582841814876337813</span>)<br>e =gmpy2.mpz(<span class="hljs-number">65537</span>)<br>phi_n= (p - <span class="hljs-number">1</span>) * (q - <span class="hljs-number">1</span>)<br>d = gmpy2.invert(e, phi_n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;d is:&quot;</span>)<br><span class="hljs-built_in">print</span> (d)<br><br><span class="hljs-comment">#è§£å¯†keyå’ŒIV</span><br>n = gmpy2.mpz(<span class="hljs-number">1294787702630841806287693875819503767329411267154281759595683996937344294354199</span>)<br><span class="hljs-comment">#key_rawæ˜¯æœåŠ¡å™¨æ¥æ”¶çš„ç¬¬ä¸€ä¸ªæ•°æ®ï¼Œå³keyåŠ å¯†æ•°æ®çš„åå…­è¿›åˆ¶æ•°æ®æµ</span><br>key_raw=<span class="hljs-string">&quot;393430353632303933303434363731383332313634363031353936303437303036303837353338373330383137373132363136313931393431323130333436353936333530353534323336333632&quot;</span><br><span class="hljs-comment">#iv_rawæ˜¯æœåŠ¡å™¨æ¥æ”¶çš„ç¬¬äºŒä¸ªæ•°æ®ï¼Œå³ivåŠ å¯†æ•°æ®çš„åå…­è¿›åˆ¶æ•°æ®æµ</span><br>iv_raw=<span class="hljs-string">&quot;323636373435303139343936383836343938363534323735373736393036303037343539343139323635373931333033373337353137333038363234343631363938313438363430393939363639&quot;</span><br><span class="hljs-comment">#åå…­è¿›åˆ¶è§£ç </span><br>key_hexdec=<span class="hljs-built_in">bytes</span>.fromhex(key_raw)<br>iv_hexdec=<span class="hljs-built_in">bytes</span>.fromhex(iv_raw)<br><br>key_enc = gmpy2.mpz(key_hexdec)<br>IV_enc = gmpy2.mpz(iv_hexdec)<br><br><span class="hljs-comment">#RSAè§£å¯†</span><br>key_dec = <span class="hljs-built_in">pow</span>(key_enc, d, n)<br>IV_dec = <span class="hljs-built_in">pow</span>(IV_enc, d, n)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;key (hex):&quot;</span>, <span class="hljs-built_in">hex</span>(key_dec))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;IV (hex):&quot;</span>, <span class="hljs-built_in">hex</span>(IV_dec))<br></code></pre></td></tr></table></figure>

<p><img src="/../images/image-20251123121642123.png" alt="è§£å¯†ç»“æœ"></p>
<p>ç„¶åå°±å¯ä»¥ä½¿ç”¨Int.exe -d key ivè§£å¯†æ–‡ä»¶äº†ï¼ˆæ³¨æ„keyå’ŒIVä¸è¦å¸¦0xï¼‰</p>
<p><img src="/../images/image-20251123121901277.png" alt="ä½¿ç”¨è§£å¯†æ¨¡å¼"></p>
<p><img src="/../images/image-20251123121954674.png" alt="è§£å¯†å‡ºæ¥çš„æ–‡ä»¶"></p>
<p>æ‰“å¼€txt.decæ–‡ä»¶å°±å¯ä»¥æ‰¾åˆ°flagäº†</p>
<p><img src="/../images/image-20251123122045460.png" alt="txt.decæ–‡ä»¶"></p>
</li>
</ul>
<blockquote>
<p>flagï¼š0xGame{I_4m_3o_S1eepy_(Â´ï½&#96;)zzZ_zzZ_zzZ_zzZ}</p>
</blockquote>
]]></content>
      <categories>
        <category>WriteUp&amp;å¤ç°</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>WriteUp</tag>
        <tag>Reverse</tag>
      </tags>
  </entry>
  <entry>
    <title>Day2:å¯»å€æ–¹å¼ã€æ ‡å¿—å¯„å­˜å™¨ã€JCCæŒ‡ä»¤</title>
    <url>/2025/07/07/Day2-%E5%AF%BB%E5%9D%80%E6%96%B9%E5%BC%8F/</url>
    <content><![CDATA[<p>å¯»å€æ–¹å¼ã€æ ‡å¿—å¯„å­˜å™¨ã€JCCæŒ‡ä»¤</p>
<span id="more"></span>

<h2 id="å¯»å€æ–¹å¼"><a href="#å¯»å€æ–¹å¼" class="headerlink" title="å¯»å€æ–¹å¼"></a>å¯»å€æ–¹å¼</h2><table>
<thead>
<tr>
<th align="center">å¯»å€æ–¹å¼</th>
<th align="center">ç¤ºä¾‹</th>
<th align="center">å…¸å‹ç”¨é€”</th>
</tr>
</thead>
<tbody><tr>
<td align="center">ç«‹å³æ•°å¯»å€</td>
<td align="center">mov eax,42</td>
<td align="center">åŠ è½½å¸¸æ•°</td>
</tr>
<tr>
<td align="center">å¯„å­˜å™¨å¯»å€</td>
<td align="center">add eax,ebx</td>
<td align="center">å¯„å­˜å™¨è¿ç®—</td>
</tr>
<tr>
<td align="center">ç›´æ¥å¯»å€</td>
<td align="center">mov eax,[0x8040000]</td>
<td align="center">è®¿é—®å…¨å±€å˜é‡</td>
</tr>
<tr>
<td align="center">å¯„å­˜å™¨é—´æ¥å¯»å€</td>
<td align="center">mov eax,[esi]</td>
<td align="center">æŒ‡é’ˆè§£å¼•ç”¨</td>
</tr>
<tr>
<td align="center">åŸºå€å¯»å€</td>
<td align="center">mov [ebp-4],ecx</td>
<td align="center">æ ˆå¸§å±€éƒ¨å˜é‡</td>
</tr>
<tr>
<td align="center">å˜å€å¯»å€</td>
<td align="center">mov eax,[esi*4]</td>
<td align="center">æ•°ç»„éå†</td>
</tr>
<tr>
<td align="center">åŸºå€å˜å€å¯»å€</td>
<td align="center">mov eax,[ebx+esi*2+8]</td>
<td align="center">ç»“æ„ä½“ï¼Œå¤šç»´æ•°ç»„</td>
</tr>
<tr>
<td align="center">ç›¸å¯¹å¯»å€</td>
<td align="center">jmp label</td>
<td align="center">è·³è½¬ï¼Œå‡½æ•°è°ƒç”¨</td>
</tr>
</tbody></table>
<h2 id="æ ‡å¿—å¯„å­˜å™¨"><a href="#æ ‡å¿—å¯„å­˜å™¨" class="headerlink" title="æ ‡å¿—å¯„å­˜å™¨"></a>æ ‡å¿—å¯„å­˜å™¨</h2><table>
<thead>
<tr>
<th align="center">æ ‡å¿—ä½</th>
<th align="center">åç§°</th>
<th align="center">ä½œç”¨</th>
</tr>
</thead>
<tbody><tr>
<td align="center">CF</td>
<td align="center">Carry Flag è¿›ä½æ ‡å¿—ä½</td>
<td align="center">æœ€é«˜ä½å‘ç”Ÿè¿›ä½&#x2F;å€Ÿä½æ—¶ç½®1</td>
</tr>
<tr>
<td align="center">PF</td>
<td align="center">Parity Flag å¥‡å¶æ ‡å¿—ä½</td>
<td align="center">1çš„ä¸ªæ•°ä¸ºå¶æ•°æ—¶ç½®1</td>
</tr>
<tr>
<td align="center">AF</td>
<td align="center">Auxiliary Carry Flag è¾…åŠ©è¿›ä½æ ‡å¿—ä½</td>
<td align="center">bit3å’Œbit4ä¹‹é—´å‘ç”Ÿè¿›ä½&#x2F;å€Ÿä½æ—¶ç½®1</td>
</tr>
<tr>
<td align="center">ZF</td>
<td align="center">Zoro Flag é›¶æ ‡å¿—ä½</td>
<td align="center">ä¸º0æ—¶ç½®1</td>
</tr>
<tr>
<td align="center">SF</td>
<td align="center">Sign Flag ç¬¦å·æ ‡å¿—ä½</td>
<td align="center">æœ€é«˜ä½ä¸º1(è´Ÿæ•°)æ—¶ç½®1</td>
</tr>
<tr>
<td align="center">OF</td>
<td align="center">Overflow Flag æº¢å‡ºæ ‡å¿—ä½</td>
<td align="center">æœ‰ç¬¦å·æ•°æº¢å‡ºæ—¶ç½®1</td>
</tr>
<tr>
<td align="center">DF</td>
<td align="center">Direction Flag æ–¹å‘æ ‡å¿—ä½</td>
<td align="center">ä¸º1æ—¶ä»é«˜ä½åˆ°ä½ä½å¤„ç†å­—ç¬¦ä¸²ï¼Œstdæ‰“å¼€ï¼Œcldå…³é—­</td>
</tr>
<tr>
<td align="center">IF</td>
<td align="center">Interrupt Flag ä¸­æ–­æ ‡å¿—ä½</td>
<td align="center">ä¸º1æ—¶å¯ä»¥å“åº”ä¸­æ–­è¯·æ±‚ï¼Œstiæ‰“å¼€ï¼Œcliå…³é—­</td>
</tr>
<tr>
<td align="center">TF</td>
<td align="center">Trap Flag é™·é˜±æ ‡å¿—ä½</td>
<td align="center">ä¸º1æ—¶ä¼šè§¦å‘å¼‚å¸¸ï¼Œè¢«è°ƒè¯•å™¨æ•è·ï¼Œç”¨äºå•æ­¥è°ƒè¯•</td>
</tr>
</tbody></table>
<h2 id="JCCæŒ‡ä»¤"><a href="#JCCæŒ‡ä»¤" class="headerlink" title="JCCæŒ‡ä»¤"></a>JCCæŒ‡ä»¤</h2><ul>
<li><p>TESTæŒ‡ä»¤ï¼šTEST op1,op2</p>
<p>å°†ä¸¤ä¸ªæ“ä½œæ•°è¿›è¡Œ&amp;æ“ä½œï¼ˆop1 &amp; op2ï¼‰å¹¶æ›´æ–°æ ‡å¿—ä½ï¼š</p>
<p>CF&#x3D;0ï¼ŒOF&#x3D;0</p>
<p>&amp;ç»“æœä¸º0ï¼šZF&#x3D;1</p>
<p>ç»“æœæœ€é«˜ä½ä¸º1ï¼šSF&#x3D;1</p>
</li>
<li><p>CMPæŒ‡ä»¤ï¼šCMP op1,op2</p>
<p>è¿›è¡Œå‡æ³•æ“ä½œï¼ˆop1 - op2ï¼‰å¹¶æ›´æ–°æ ‡å¿—ä½ï¼š</p>
<p>è‹¥op1 &lt; op2ï¼ˆå‘ç”Ÿå€Ÿä½ï¼‰ï¼ŒCF&#x3D;1</p>
<p>è‹¥å‘ç”Ÿæœ‰ç¬¦å·æº¢å‡ºï¼ŒOF&#x3D;1</p>
<p>op1 &#x3D;&#x3D; op2ï¼ˆç»“æœä¸º0ï¼‰ï¼ŒZF&#x3D;1</p>
<p>op1 &lt; op2ï¼ˆç»“æœä¸ºè´Ÿæ•°ï¼‰ï¼ŒSF&#x3D;1</p>
</li>
<li><p>JCCæŒ‡ä»¤ï¼šJCC Label</p>
<table>
<thead>
<tr>
<th align="center">æŒ‡ä»¤</th>
<th align="center">æ¡ä»¶</th>
<th align="center">æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td align="center">JMP</td>
<td align="center">æ— æ¡ä»¶</td>
<td align="center">æ— æ¡ä»¶è·³è½¬</td>
</tr>
<tr>
<td align="center">JE &#x2F; JZ</td>
<td align="center">ZF&#x3D;1</td>
<td align="center"><strong>J</strong>ump if <strong>E</strong>qual &#x2F; <strong>J</strong>ump if <strong>Z</strong>F</td>
</tr>
<tr>
<td align="center">JNE &#x2F; JNZ</td>
<td align="center">ZF&#x3D;0</td>
<td align="center"><strong>J</strong>ump if <strong>N</strong>ot <strong>E</strong>qual &#x2F; <strong>J</strong>ump if <strong>N</strong>ot <strong>Z</strong>F</td>
</tr>
<tr>
<td align="center">JS</td>
<td align="center">SF&#x3D;1</td>
<td align="center"><strong>J</strong>ump if <strong>S</strong>F</td>
</tr>
<tr>
<td align="center">JNS</td>
<td align="center">SF&#x3D;0</td>
<td align="center"><strong>J</strong>ump if <strong>N</strong>ot <strong>S</strong>F</td>
</tr>
<tr>
<td align="center">JP &#x2F; JPE</td>
<td align="center">PF&#x3D;1</td>
<td align="center"><strong>J</strong>ump if <strong>P</strong>F &#x2F; <strong>J</strong>ump if <strong>P</strong>arity <strong>E</strong>ven</td>
</tr>
<tr>
<td align="center">JNP &#x2F; JPO</td>
<td align="center">PF&#x3D;0</td>
<td align="center"><strong>J</strong>ump if <strong>N</strong>ot <strong>P</strong>F &#x2F; <strong>J</strong>ump if <strong>P</strong>arity <strong>O</strong>dd</td>
</tr>
<tr>
<td align="center">JO</td>
<td align="center">OF&#x3D;1</td>
<td align="center"><strong>J</strong>ump if <strong>O</strong>F</td>
</tr>
<tr>
<td align="center">JNO</td>
<td align="center">OF&#x3D;0</td>
<td align="center"><strong>J</strong>ump if <strong>N</strong>ot <strong>O</strong>F</td>
</tr>
<tr>
<td align="center">JB &#x2F; JNAE &#x2F; JC</td>
<td align="center">CF&#x3D;1</td>
<td align="center"><strong>J</strong>ump if <strong>B</strong>elow &#x2F; <strong>J</strong>ump if <strong>N</strong>ot <strong>A</strong>bove or <strong>E</strong>qual &#x2F; <strong>J</strong>ump if <strong>C</strong>F</td>
</tr>
<tr>
<td align="center">JNB &#x2F; JAE &#x2F; JNC</td>
<td align="center">CF&#x3D;0</td>
<td align="center"><strong>J</strong>ump if <strong>N</strong>ot <strong>B</strong>elow &#x2F; <strong>J</strong>ump if <strong>A</strong>bove or <strong>E</strong>qual &#x2F; <strong>J</strong>ump if <strong>N</strong>ot <strong>C</strong>F</td>
</tr>
<tr>
<td align="center">JBE &#x2F; JNA</td>
<td align="center">CF&#x3D;1 æˆ– ZF&#x3D;1</td>
<td align="center"><strong>J</strong>ump if <strong>B</strong>elow or <strong>E</strong>qual &#x2F; <strong>J</strong>ump if <strong>N</strong>ot <strong>A</strong>bove</td>
</tr>
<tr>
<td align="center">JA &#x2F; JNBE</td>
<td align="center">CF&#x3D;0 ä¸” ZF&#x3D;0</td>
<td align="center"><strong>J</strong>ump if <strong>A</strong>bove &#x2F; <strong>J</strong>ump if <strong>N</strong>ot <strong>B</strong>elow or <strong>E</strong>qual</td>
</tr>
<tr>
<td align="center">JL &#x2F; JNGE</td>
<td align="center">SF â‰  OF</td>
<td align="center"><strong>J</strong>ump if <strong>L</strong>ess &#x2F; <strong>J</strong>ump if <strong>N</strong>ot <strong>G</strong>reater or <strong>E</strong>qual</td>
</tr>
<tr>
<td align="center">JGE &#x2F; JNL</td>
<td align="center">SF &#x3D; OF</td>
<td align="center"><strong>J</strong>ump if <strong>G</strong>reater or <strong>E</strong>qual &#x2F; <strong>J</strong>ump if <strong>N</strong>ot <strong>L</strong>ess</td>
</tr>
<tr>
<td align="center">JLE &#x2F; JNG</td>
<td align="center">ZF&#x3D;1 æˆ– SF â‰  OF</td>
<td align="center"><strong>J</strong>ump if <strong>L</strong>ess or <strong>E</strong>qual &#x2F; <strong>J</strong>ump if <strong>N</strong>ot <strong>G</strong>reater</td>
</tr>
<tr>
<td align="center">JG &#x2F; JNLE</td>
<td align="center">ZF&#x3D;0 ä¸” SF &#x3D; OF</td>
<td align="center"><strong>J</strong>ump if <strong>G</strong>reater &#x2F; <strong>J</strong>ump if <strong>N</strong>ot <strong>L</strong>ess or <strong>E</strong>qual</td>
</tr>
</tbody></table>
</li>
</ul>
]]></content>
      <categories>
        <category>Reverseå­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>Reverse</tag>
      </tags>
  </entry>
  <entry>
    <title>Day4:Linuxæ±‡ç¼–æ¡†æ¶ã€æ“ä½œç³»ç»Ÿä¸æ±‡ç¼–å™¨ã€ä¸»å‡½æ•°è·³è½¬æµç¨‹</title>
    <url>/2025/07/11/Day4-Linux%E6%B1%87%E7%BC%96%E6%A1%86%E6%9E%B6/</url>
    <content><![CDATA[<p>Linuxæ±‡ç¼–æ¡†æ¶ã€æ“ä½œç³»ç»Ÿä¸æ±‡ç¼–å™¨ã€ä¸»å‡½æ•°è·³è½¬æµç¨‹</p>
<span id="more"></span>

<h2 id="Linux-NASM-æ±‡ç¼–æ¡†æ¶"><a href="#Linux-NASM-æ±‡ç¼–æ¡†æ¶" class="headerlink" title="Linux(NASM)æ±‡ç¼–æ¡†æ¶"></a>Linux(NASM)æ±‡ç¼–æ¡†æ¶</h2><ul>
<li><p>Linuxå’ŒWindowsçš„ä¸åŒä¸»è¦æœ‰ï¼š</p>
<ul>
<li><p>ç³»ç»Ÿè°ƒç”¨æ–¹å¼ä¸åŒï¼š</p>
<ul>
<li><p>Windowsæä¾›APIï¼Œå¯ä»¥ç›´æ¥åˆ©ç”¨ç³»ç»Ÿå‡½æ•°</p>
</li>
<li><p>Linuxéœ€è¦ç”¨ç³»ç»Ÿè°ƒç”¨å·è§¦å‘ç³»ç»Ÿè°ƒç”¨ã€‚ç³»ç»Ÿè°ƒç”¨å·å­˜å…¥ç‰¹å®šå¯„å­˜å™¨åä½¿ç”¨è§¦å‘æŒ‡ä»¤ï¼Œè§¦å‘ç³»ç»Ÿè°ƒç”¨</p>
<p>è§¦å‘æŒ‡ä»¤ï¼š</p>
<p>â€‹    32ä½(x86)ï¼šint 0x80</p>
<p>â€‹    64ä½(x64)ï¼šsyscall</p>
<p>å‚æ•°ä¼ é€’ï¼š</p>
<p>â€‹    32ä½ï¼šeaxï¼ˆç³»ç»Ÿè°ƒç”¨å·ï¼‰ï¼Œebxã€ecxã€edxã€esiã€ediã€ebpï¼ˆå‚æ•°ï¼‰ã€‚</p>
<p>â€‹    64ä½ï¼šraxï¼ˆç³»ç»Ÿè°ƒç”¨å·ï¼‰ï¼Œrdiã€rsiã€rdxã€r10ã€r8ã€r9ï¼ˆå‚æ•°ï¼‰ã€‚</p>
<p>32ä½ä¸‹exitç¤ºä¾‹ï¼š</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm"><span class="hljs-keyword">mov</span> <span class="hljs-built_in">eax</span>,<span class="hljs-number">1</span>		<span class="hljs-comment">;32ä½ä¸‹ï¼Œexitçš„ç³»ç»Ÿè°ƒç”¨å·ä¸º1</span><br><span class="hljs-keyword">int</span> <span class="hljs-number">0x80</span>		<span class="hljs-comment">;ç³»ç»Ÿè°ƒç”¨å·å­˜å…¥å¯„å­˜å™¨åï¼Œè§¦å‘ç³»ç»Ÿè°ƒç”¨</span><br></code></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>å¯æ‰§è¡Œæ–‡ä»¶æ ¼å¼ä¸åŒï¼š</p>
<ul>
<li>Windowsä½¿ç”¨PEæ–‡ä»¶æ ¼å¼</li>
<li>Linuxä½¿ç”¨ELFæ–‡ä»¶æ ¼å¼</li>
</ul>
</li>
<li><p>å…¶ä»–ç»†èŠ‚ï¼š</p>
<ul>
<li>Linuxåœ¨æ®µåå‰å¿…é¡»æ·»åŠ sectionï¼Œåªæœ‰.textæ®µæ²¡æœ‰.codeæ®µï¼ˆå®é™…ä¸Šç”±æ±‡ç¼–å™¨å†³å®šï¼Œè¯¦è§ä¸‹ä¸€éƒ¨åˆ†ï¼‰</li>
<li>Linuxä½¿ç”¨0xAä½œä¸ºå­—ç¬¦ä¸²ç»“æŸç¬¦</li>
</ul>
</li>
</ul>
</li>
<li><p>32ä½æ±‡ç¼–æ¡†æ¶</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">section</span> .data<br>	msg <span class="hljs-built_in">db</span> <span class="hljs-string">&quot;HelloWorld&quot;</span>,<span class="hljs-number">0xA</span><br>	len <span class="hljs-built_in">equ</span> $ - msg				<span class="hljs-comment">;ç”¨å˜é‡lenè®°å½•msgçš„é•¿åº¦ï¼ˆ$è¡¨ç¤ºå½“å‰å˜é‡çš„åœ°å€ï¼Œå‡å»msgçš„åœ°å€å°±æ˜¯msgçš„é•¿åº¦ï¼‰</span><br>	<br><span class="hljs-meta">section</span> .text<br>	<span class="hljs-meta">global</span> _start<br><span class="hljs-symbol">_start:</span><br>	<span class="hljs-keyword">mov</span> <span class="hljs-built_in">eax</span>,<span class="hljs-number">4</span>					<span class="hljs-comment">;eaxå­˜æ”¾ç³»ç»Ÿè°ƒç”¨å·4ï¼šsys_write</span><br>	<span class="hljs-keyword">mov</span> <span class="hljs-built_in">ebx</span>,<span class="hljs-number">1</span>					<span class="hljs-comment">;å‚æ•°1ï¼šæ–‡ä»¶æè¿°ç¬¦ï¼Œ1è¡¨ç¤ºæ ‡å‡†è¾“å‡ºstdout</span><br>	<span class="hljs-keyword">mov</span> <span class="hljs-built_in">ecx</span>,msg					<span class="hljs-comment">;å‚æ•°2ï¼šè¦æ‰“å°çš„æ•°æ®åœ°å€</span><br>	<span class="hljs-keyword">mov</span> <span class="hljs-built_in">edx</span>,len					<span class="hljs-comment">;å‚æ•°3ï¼šæ‰“å°çš„å­—èŠ‚æ•°</span><br>	<span class="hljs-keyword">int</span> <span class="hljs-number">0x80</span><br>	<br>	<span class="hljs-keyword">mov</span> <span class="hljs-built_in">eax</span>,<span class="hljs-number">1</span>					<span class="hljs-comment">;eaxå­˜æ”¾ç³»ç»Ÿè°ƒç”¨å·1ï¼šsys_exit</span><br>	<span class="hljs-keyword">mov</span> <span class="hljs-built_in">ebx</span>,<span class="hljs-number">0</span>					<span class="hljs-comment">;å‚æ•°1ï¼šé€€å‡ºçŠ¶æ€ç ï¼ˆ0è¡¨ç¤ºæˆåŠŸï¼‰</span><br>	<span class="hljs-keyword">int</span> <span class="hljs-number">0x80</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>64ä½æ±‡ç¼–æ¡†æ¶</p>
</li>
</ul>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">section</span> .data<br>	msg <span class="hljs-built_in">db</span> <span class="hljs-string">&quot;HelloWorld&quot;</span>,<span class="hljs-number">0xA</span><br>	len <span class="hljs-built_in">equ</span> $ - msg				<br>	<br><span class="hljs-meta">section</span> .text<br>	<span class="hljs-meta">global</span> _start<br><span class="hljs-symbol">_start:</span><br>	<span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>,<span class="hljs-number">1</span>					<span class="hljs-comment">;raxå­˜æ”¾ç³»ç»Ÿè°ƒç”¨å·1ï¼šsys_write</span><br>	<span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>,<span class="hljs-number">1</span>					<span class="hljs-comment">;å‚æ•°1ï¼šæ–‡ä»¶æè¿°ç¬¦ï¼Œ1è¡¨ç¤ºæ ‡å‡†è¾“å‡ºstdout</span><br>	<span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>,msg					<span class="hljs-comment">;å‚æ•°2ï¼šè¦æ‰“å°çš„æ•°æ®åœ°å€</span><br>	<span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>,len					<span class="hljs-comment">;å‚æ•°3ï¼šæ‰“å°çš„å­—èŠ‚æ•°</span><br>	<span class="hljs-keyword">syscall</span><br>	<br>	<span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>,<span class="hljs-number">60</span>					<span class="hljs-comment">;raxå­˜æ”¾ç³»ç»Ÿè°ƒç”¨å·60ï¼šsys_exit</span><br>	<span class="hljs-keyword">xor</span> <span class="hljs-built_in">rdi</span>,<span class="hljs-built_in">rdi</span>					<span class="hljs-comment">;å‚æ•°1ï¼šé€€å‡ºçŠ¶æ€ç ï¼ˆ0è¡¨ç¤ºæˆåŠŸï¼‰</span><br>	<span class="hljs-keyword">syscall</span><br></code></pre></td></tr></table></figure>

<h2 id="æ“ä½œç³»ç»Ÿä¸æ±‡ç¼–å™¨"><a href="#æ“ä½œç³»ç»Ÿä¸æ±‡ç¼–å™¨" class="headerlink" title="æ“ä½œç³»ç»Ÿä¸æ±‡ç¼–å™¨"></a>æ“ä½œç³»ç»Ÿä¸æ±‡ç¼–å™¨</h2><ul>
<li>Windowsï¼šä¸»è¦æœ‰MASMå’ŒNASMä¸¤ç§æ±‡ç¼–å™¨<ul>
<li>MASMï¼ˆMicrosoft Macro Assemblerï¼‰ï¼Œä¸»è¦é›†æˆåœ¨visual studioä¸­<ul>
<li>æ®µåå‰ä¸è¦æ±‚åŠ sectionï¼Œå¯ä»¥ç›´æ¥ç”¨ <strong>.æ®µå</strong> å£°æ˜</li>
<li>æŒ‡ä»¤å­˜æ”¾åœ¨.codeæ®µ</li>
<li>.codeæ®µï¼Œå‡½æ•°ä»¥ <strong>func_name proc</strong> å¼€å§‹ï¼Œä»¥ <strong>func_name endp</strong> ç»“æŸ</li>
<li>ä½¿ç”¨Intelé£æ ¼ï¼Œå³ <strong>æŒ‡ä»¤   ç›®æ ‡æ“ä½œæ•°ï¼Œæºæ“ä½œæ•°</strong></li>
</ul>
</li>
<li>NASMï¼ˆNetwide Assemblerï¼‰ï¼Œè·¨å¹³å°æ±‡ç¼–å™¨ï¼Œæ”¯æŒWindowsã€Linuxã€macOS<ul>
<li>æ®µåå‰è¦æ±‚åŠ sectionï¼Œç”¨ <strong>sectino .æ®µå</strong> å£°æ˜</li>
<li>æŒ‡ä»¤å­˜æ”¾åœ¨.textæ®µ</li>
<li>.textæ®µï¼Œå‡½æ•°ç”¨ <strong>global func_name</strong> å£°æ˜åå†å®šä¹‰ </li>
<li>ä½¿ç”¨Intelé£æ ¼</li>
</ul>
</li>
</ul>
</li>
<li>Linuxï¼šä¸»è¦æœ‰NASMå’ŒGASä¸¤ç§æ±‡ç¼–å™¨<ul>
<li>NASMåŒä¸Š </li>
<li>GASï¼ˆGNU Assemblerï¼‰ï¼ŒLinuxé»˜è®¤æ±‡ç¼–å™¨<ul>
<li>æ®µåå‰è¦æ±‚åŠ .sectionï¼Œç”¨ <strong>.section .æ®µå</strong> å£°æ˜</li>
<li>æŒ‡ä»¤å­˜æ”¾åœ¨.textæ®µ</li>
<li>.textæ®µï¼Œå‡½æ•°ç”¨ <strong>.global func_name</strong> å£°æ˜åå†å®šä¹‰</li>
<li>ä½¿ç”¨AT&amp;Té£æ ¼ï¼Œå³ <strong>æŒ‡ä»¤   æºæ“ä½œæ•°ï¼Œç›®æ ‡æ“ä½œæ•°</strong></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="ä¸»å‡½æ•°è·³è½¬æµç¨‹"><a href="#ä¸»å‡½æ•°è·³è½¬æµç¨‹" class="headerlink" title="ä¸»å‡½æ•°è·³è½¬æµç¨‹"></a>ä¸»å‡½æ•°è·³è½¬æµç¨‹</h2><ul>
<li><p>ç¯å¢ƒï¼švs2022ï¼ŒDebug  x86&#x2F;x64ï¼ŒRelease x86&#x2F;x64</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm"><span class="hljs-comment">;x86 debug è·³è½¬ç‰¹å¾</span><br><span class="hljs-comment">;step1</span><br><span class="hljs-keyword">jmp</span>			<span class="hljs-comment">;ç›´æ¥jmp</span><br><br><span class="hljs-comment">;step2</span><br><span class="hljs-keyword">call</span>		<span class="hljs-comment">;ç¬¬ä¸€ä¸ªcall</span><br><br><span class="hljs-comment">;step3</span><br><span class="hljs-keyword">call</span><br><span class="hljs-keyword">call</span> &lt;--	<span class="hljs-comment">;è¿ç»­ä¸¤ä¸ªcallï¼Œè¿›ç¬¬äºŒä¸ª</span><br><br><span class="hljs-comment">;step4</span><br><span class="hljs-number">2</span>*<span class="hljs-keyword">jz</span>--&gt;<span class="hljs-keyword">call</span><br><span class="hljs-keyword">mov</span><br><span class="hljs-keyword">call</span>		<span class="hljs-comment">;ä¸¤ä¸ªjzæŒ‡å‘çš„åŒä¸€ä¸ªcallä¸”æ­¤callåç´§è·Ÿmovå’Œcall</span><br><br><span class="hljs-comment">;step5</span><br><span class="hljs-keyword">mov</span><br><span class="hljs-keyword">push</span><br><span class="hljs-keyword">mov</span><br><span class="hljs-keyword">push</span><br><span class="hljs-keyword">mov</span><br><span class="hljs-keyword">push</span><br><span class="hljs-keyword">call</span>		<span class="hljs-comment">;è¿ç»­push3ä¸ªå‚æ•°å…¥æ ˆåçš„call</span><br><br><span class="hljs-comment">;step6</span><br><span class="hljs-keyword">jmp</span><br></code></pre></td></tr></table></figure>

<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm"><span class="hljs-comment">;x86 Release è·³è½¬ç‰¹å¾</span><br><span class="hljs-comment">;step1</span><br><span class="hljs-keyword">call</span><br><span class="hljs-keyword">jmp</span>			<span class="hljs-comment">;callåçš„jmp</span><br><br><span class="hljs-comment">;step2</span><br><span class="hljs-keyword">push</span><br><span class="hljs-keyword">push</span><br><span class="hljs-keyword">push</span><br><span class="hljs-keyword">call</span>		<span class="hljs-comment">;è¿ç»­push3ä¸ªå‚æ•°å…¥æ ˆåçš„call</span><br></code></pre></td></tr></table></figure>

<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm"><span class="hljs-comment">;x64 Debug è·³è½¬ç‰¹å¾ </span><br><span class="hljs-comment">;step1</span><br><span class="hljs-keyword">jmp</span>			<span class="hljs-comment">;ç›´æ¥jmp</span><br><br><span class="hljs-comment">;step2</span><br><span class="hljs-keyword">call</span>		<span class="hljs-comment">;ç¬¬ä¸€ä¸ªcall</span><br><br><span class="hljs-comment">;step3</span><br><span class="hljs-keyword">call</span><br><span class="hljs-keyword">call</span> &lt;--	<span class="hljs-comment">;è¿ç»­ä¸¤ä¸ªcallè¿›ç¬¬äºŒä¸ª</span><br><br><span class="hljs-comment">;step4</span><br><span class="hljs-number">2</span>*<span class="hljs-keyword">jz</span>--&gt;<span class="hljs-keyword">call</span><br><span class="hljs-keyword">mov</span><br><span class="hljs-keyword">call</span>		<span class="hljs-comment">;ä¸¤ä¸ªjzæŒ‡å‘çš„åŒä¸€ä¸ªcallä¸”æ­¤callåç´§è·Ÿmovå’Œcall</span><br><br><span class="hljs-comment">;step5</span><br><span class="hljs-keyword">mov</span><br><span class="hljs-keyword">mov</span><br><span class="hljs-keyword">mov</span><br><span class="hljs-keyword">mov</span><br><span class="hljs-keyword">mov</span><br><span class="hljs-keyword">call</span>		<span class="hljs-comment">;è¿ç»­5ä¸ªmovåçš„callï¼ˆä¼ å‚ï¼‰</span><br><br><span class="hljs-comment">;step6</span><br><span class="hljs-keyword">jmp</span>			<span class="hljs-comment">;ç›´æ¥jmp</span><br></code></pre></td></tr></table></figure>

<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm"><span class="hljs-comment">;x64 Release è·³è½¬ç‰¹å¾ </span><br><span class="hljs-comment">;step1</span><br><span class="hljs-keyword">call</span><br><span class="hljs-keyword">jmp</span>			<span class="hljs-comment">;callåçš„jmp</span><br><br><span class="hljs-comment">;step2</span><br><span class="hljs-keyword">mov</span><br><span class="hljs-keyword">mov</span><br><span class="hljs-keyword">mov</span><br><span class="hljs-keyword">call</span><br><span class="hljs-keyword">mov</span><br><span class="hljs-keyword">call</span>		<span class="hljs-comment">;ä¸‰ä¸ªmovåçš„callï¼ˆä¼ å‚ï¼‰ä¸”æ­¤callåç´§è·Ÿmovå’Œcall</span><br></code></pre></td></tr></table></figure></li>
</ul>
]]></content>
      <categories>
        <category>Reverseå­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>Reverse</tag>
      </tags>
  </entry>
  <entry>
    <title>Day3:å‡½æ•°ä¸æ ˆå¸§ã€æ•°ç»„ä¸ä¸²æŒ‡ä»¤ã€å®ä¸ç»“æ„ä½“ã€x64æ±‡ç¼–æ¡†æ¶ã€å†…è”æ±‡ç¼–ä¸æ··åˆç¼–ç¨‹</title>
    <url>/2025/07/08/Day3-%E5%87%BD%E6%95%B0%E4%B8%8E%E5%A0%86%E6%A0%88/</url>
    <content><![CDATA[<p>å‡½æ•°ä¸æ ˆå¸§ã€æ•°ç»„ä¸ä¸²æŒ‡ä»¤ã€å®ä¸ç»“æ„ä½“ã€x64æ±‡ç¼–æ¡†æ¶ã€å†…è”æ±‡ç¼–ä¸æ··åˆç¼–ç¨‹</p>
<span id="more"></span>

<h2 id="å‡½æ•°ä¸æ ˆå¸§"><a href="#å‡½æ•°ä¸æ ˆå¸§" class="headerlink" title="å‡½æ•°ä¸æ ˆå¸§"></a>å‡½æ•°ä¸æ ˆå¸§</h2><ul>
<li><p>â€œæ ˆâ€œæ˜¯å†…å­˜ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œå¯ä»¥ç†è§£ä¸ºè¿ç»­çš„ä¸€å—å†…å­˜ï¼Œå®ƒä¸ºç¨‹åºè¿è¡Œæä¾›äº†ä¸€ä¸ªæš‚æ—¶çš„å­˜æ”¾æ•°æ®çš„åœ°æ–¹ï¼Œåœ°å€ã€æ•°æ®ç­‰å¯ä»¥é€šè¿‡pushæŒ‡ä»¤ä»å¯„å­˜å™¨ä¸­è¢«å¤åˆ¶åˆ°æ ˆä¸­ï¼Œè¿›è€Œå¯„å­˜å™¨å¯ä»¥è¿›è¡Œå…¶ä»–æ“ä½œï¼Œç­‰åˆ°è¿™äº›æ•°æ®å†æ¬¡è¢«éœ€è¦æ—¶å†ä»æ ˆä¸­è¢«popå‡ºæ¥ã€‚æ ˆéµå¾ªå…ˆè¿›åå‡ºçš„è§„åˆ™ï¼Œå…ˆpushçš„åœ¨é«˜åœ°å€ï¼Œåpushçš„åœ¨ä½åœ°å€</p>
</li>
<li><p>åœ¨ç¨‹åºè¿è¡Œæ—¶ï¼Œæ¯ä¸ªå‡½æ•°éƒ½ä¼šæ‹¥æœ‰ç‹¬ç«‹çš„æ ˆå¸§ï¼Œå³ç‹¬ç«‹çš„æ ˆä¸Šçš„ä¸€éƒ¨åˆ†ç©ºé—´ã€‚æœ‰ä¸¤ä¸ªå¯„å­˜å™¨ï¼Œespï¼Œebpï¼ˆx86å³32ä½ç¯å¢ƒä¸‹ï¼‰è´Ÿè´£ç»´æŠ¤å‡½æ•°çš„æ ˆç©ºé—´ã€‚ebpå­˜æ”¾çš„æ˜¯å‡½æ•°æ ˆç©ºé—´çš„æ ˆåŸºå€ï¼Œespå­˜æ”¾çš„æ˜¯å‡½æ•°æ ˆç©ºé—´çš„æ ˆé¡¶ã€‚å¯ä»¥ç†è§£ä¸ºebpæ˜¯æŒ‡å‘å‡½æ•°æ ˆç©ºé—´æœ€é«˜ä½çš„ä¸€ä¸ªæŒ‡é’ˆï¼ˆå› ä¸ºæ ˆç©ºé—´ä»é«˜åœ°å€å¼€å§‹åˆ†é…ï¼Œå› æ­¤æŒ‡å‘çš„æ˜¯æœ€é«˜ä½ï¼Œä½†æ˜¯æ˜¯æ ˆç©ºé—´çš„èµ·å§‹åœ°å€ï¼‰ï¼Œè€Œespæ˜¯æŒ‡å‘å‡½æ•°æ ˆç©ºé—´æœ€ä½ä½çš„ä¸€ä¸ªæŒ‡é’ˆï¼ˆæŒ‡å‘çš„æ˜¯æœ€ä½ä½ï¼Œä½†æ˜¯ä¼šéšç€åç»­æ ˆç©ºé—´çš„æ‰©å……è€Œå˜åŒ–ï¼‰ã€‚</p>
</li>
<li><p>CALLæŒ‡ä»¤ï¼š</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm"><span class="hljs-comment">;callä¸€ä¸ªå‡½æ•°çš„æ—¶å€™ï¼Œä¼šå‘ç”Ÿä»¥ä¸‹å†…å®¹</span><br><span class="hljs-keyword">push</span> è¿”å›åœ°å€ï¼ˆ<span class="hljs-keyword">call</span>æ‰€åœ¨æŒ‡ä»¤çš„ä¸‹ä¸€æ¡ï¼‰<br><span class="hljs-keyword">jmp</span> ç›®æ ‡å‡½æ•°åœ°å€<br></code></pre></td></tr></table></figure>
</li>
<li><p>RETæŒ‡ä»¤ï¼š</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm"><span class="hljs-comment">;å‡½æ•°ç»“æŸæ—¶ï¼ŒRETæŒ‡ä»¤ä¼šå‘ç”Ÿä»¥ä¸‹å†…å®¹</span><br><span class="hljs-keyword">pop</span> <span class="hljs-built_in">eip</span> <span class="hljs-comment">;ä»æ ˆä¸Šå¼¹å‡ºè¿”å›åœ°å€åˆ°eipï¼ˆä¿å­˜ä¸‹ä¸€æ­¥æŒ‡ä»¤åœ°å€çš„å¯„å­˜å™¨ï¼‰</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>æ ˆå¸§ï¼š</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm"><span class="hljs-comment">;è·³è½¬åˆ°æ¯ä¸€ä¸ªå‡½æ•°ï¼Œä¼šå‘ç”Ÿä»¥ä¸‹å†…å®¹ä»¥å¼€è¾Ÿæ ˆå¸§</span><br><span class="hljs-keyword">push</span> <span class="hljs-built_in">ebp</span>			<span class="hljs-comment">;æŠŠä¸Šä¸€ä¸ªå‡½æ•°çš„ebpå€¼æ”¾åˆ°æ ˆä¸Š</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ebp</span>,<span class="hljs-built_in">esp</span>			<span class="hljs-comment">;æŠŠespå€¼ç»™ebpï¼Œå¼€è¾Ÿæ–°å‡½æ•°çš„æ ˆå¸§</span><br><span class="hljs-comment">;å‡½æ•°æ‰§è¡Œå®Œæ¯•åï¼Œä¼šå‘ç”Ÿä»¥ä¸‹å†…å®¹æ¸…ç†æ ˆå¸§</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">esp</span>,<span class="hljs-built_in">ebp</span>			<span class="hljs-comment">;æŠŠebpå€¼ç»™espï¼Œæ¸…ç†å‡½æ•°æ ˆå¸§</span><br><span class="hljs-keyword">pop</span> <span class="hljs-built_in">ebp</span>				<span class="hljs-comment">;æ¢å¤ebpåŸæ¥çš„å€¼ï¼Œå³ä¸Šä¸€ä¸ªå‡½æ•°çš„ebp</span><br><span class="hljs-keyword">ret</span><br></code></pre></td></tr></table></figure></li>
</ul>
<h2 id="æ•°ç»„ä¸ä¸²æŒ‡ä»¤"><a href="#æ•°ç»„ä¸ä¸²æŒ‡ä»¤" class="headerlink" title="æ•°ç»„ä¸ä¸²æŒ‡ä»¤"></a>æ•°ç»„ä¸ä¸²æŒ‡ä»¤</h2><ul>
<li><p>å£°æ˜æ•°ç»„ï¼š</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.data</span>			<span class="hljs-comment">;åœ¨æ•°æ®æ®µå£°æ˜</span><br> szHello <span class="hljs-built_in">db</span> <span class="hljs-string">&#x27;HelloWorld&#x27;</span>,<span class="hljs-number">0</span>			<span class="hljs-comment">;å£°æ˜ä¸€ä¸ªå­—ç¬¦ä¸²</span><br> nNumber <span class="hljs-built_in">dd</span> <span class="hljs-number">20</span> dup(<span class="hljs-number">0</span>)				<span class="hljs-comment">;å£°æ˜ä¸€ä¸ªDWORDæ•°ç»„ï¼Œ20ä½ï¼Œä½¿ç”¨dup()åˆå§‹åŒ–æ•°ç»„å†…å®¹ä¸º0</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>ä½¿ç”¨æ•°ç»„åŸºå€çš„å‡ ç§æ–¹å¼ï¼š</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm"><span class="hljs-keyword">lea</span> <span class="hljs-built_in">eax</span>,szHello<br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ebx</span>,offset Nnumber<br></code></pre></td></tr></table></figure>
</li>
<li><p>è®¿é—®æ•°ç»„æˆå‘˜ï¼š</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm"><span class="hljs-comment">;[æ•°ç»„èµ·å§‹åœ°å€+ç´¢å¼•å¯„å­˜å™¨*æ¯”ä¾‹å› å­+åç§»é‡]ï¼ˆç´¢å¼•å¯„å­˜å™¨ç”¨æ¥å­˜æ”¾ç´¢å¼•å€¼ï¼Œæ¯”ä¾‹å› å­å¯¹åº”ç±»å‹çš„å­—èŠ‚å¤§å°ï¼Œåç§»é‡å¯ç”¨äºç»“æ„ä½“æ•°ç»„ç­‰åœºæ™¯ï¼‰</span><br><span class="hljs-comment">;å¦‚ï¼š</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ebx</span>,offset Array	<span class="hljs-comment">;æŠŠæ•°ç»„åŸºå€ç»™ebx</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">esi</span>,<span class="hljs-number">0</span>				<span class="hljs-comment">;esiç”¨æ¥å½“ç´¢å¼•å¯„å­˜å™¨</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ecx</span>,<span class="hljs-number">10</span>				<span class="hljs-comment">;ecxç”¨æ¥æ”¾ç´¢å¼•ä¸Šé™ï¼ˆecxå¸¸ç”¨ä½œè®¡æ•°å™¨ï¼‰</span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol">loop_start:</span>				<span class="hljs-comment">;åˆ›å»ºä¸€ä¸ªå¾ªç¯</span><br>	<span class="hljs-keyword">mov</span> <span class="hljs-built_in">eax</span>,[<span class="hljs-built_in">ebx</span>+<span class="hljs-built_in">esi</span>*<span class="hljs-number">4</span>]	<span class="hljs-comment">;å–å‡ºæ•°ç»„å†…å®¹æ”¾åˆ°eaxä¸­</span><br>	<span class="hljs-keyword">add</span> <span class="hljs-built_in">esi</span>,<span class="hljs-number">1</span>			<span class="hljs-comment">;ç´¢å¼•é€’å¢</span><br>	<span class="hljs-keyword">cmp</span> <span class="hljs-built_in">esi</span>,<span class="hljs-built_in">ecx</span>			<span class="hljs-comment">;ä¸ç´¢å¼•ä¸Šé™æ¯”è¾ƒï¼Œåˆ¤æ–­æ˜¯å¦éå†å®Œæ•°ç»„</span><br>	<span class="hljs-keyword">jl</span> loop_start		<span class="hljs-comment">;è¿˜æ²¡éå†å®Œæ•°ç»„å°±å¾ªç¯æ“ä½œï¼Œjumpåˆ°loop_startå†èµ°ä¸€é</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>ä¸²æŒ‡ä»¤ï¼š</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm"><span class="hljs-comment">;stosç³»åˆ—:stosb,stosw,stosd,stosqï¼ˆåˆ†åˆ«å¯¹åº”byte,word,dword,qword,åŠŸèƒ½æ˜¯æŠŠal/ax/eax/raxä¸­çš„å†…å®¹å­˜åˆ°edi/rdiï¼‰</span><br><span class="hljs-comment">;lodsç³»åˆ—:lodsb,lodsw,lodsd,lodsqï¼ˆåŒæ ·åˆ†åˆ«å¯¹åº”å››ä¸ªç±»å‹ï¼ŒåŠŸèƒ½æ˜¯æŠŠesi/rsiçš„å†…å®¹åŠ è½½åˆ°al/ax/eax/raxä¸­ï¼‰</span><br><span class="hljs-comment">;movsç³»åˆ—:movsb,movsw,movsd,movsqï¼ˆåŒæ ·åˆ†åˆ«å¯¹åº”å››ä¸ªç±»å‹ï¼ŒåŠŸèƒ½æ˜¯æŠŠesiçš„å†…å®¹å¤åˆ¶åˆ°ediä¸­ï¼‰</span><br><span class="hljs-comment">;cmpsç³»åˆ—:cmpsb,cmpsw,cmpsd,cmpsqï¼ˆåŒæ ·åˆ†åˆ«å¯¹åº”å››ä¸ªç±»å‹ï¼ŒåŠŸèƒ½æ˜¯æ¯”è¾ƒesiå’Œediçš„å†…å®¹å¹¶è®¾ç½®æ ‡å¿—ä½ï¼‰</span><br></code></pre></td></tr></table></figure></li>
</ul>
<h2 id="å®ä¸ç»“æ„ä½“"><a href="#å®ä¸ç»“æ„ä½“" class="headerlink" title="å®ä¸ç»“æ„ä½“"></a>å®ä¸ç»“æ„ä½“</h2><ul>
<li><p>å®ï¼š</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm"><span class="hljs-comment">;æ— å‚å®ä½¿ç”¨å…³é”®å­—EQUï¼Œå¦‚</span><br>PI <span class="hljs-built_in">EQU</span> <span class="hljs-number">3</span>		<span class="hljs-comment">;å®šä¹‰PI=3</span><br><span class="hljs-comment">;å«å‚å®ä½¿ç”¨å…³é”®å­—MACROï¼Œç”¨endmç»“å°¾ï¼Œå¦‚</span><br>Myadd MACRO Number<br>	<span class="hljs-keyword">add</span> <span class="hljs-built_in">eax</span>,Number<br>endm			<span class="hljs-comment">;å®šä¹‰Myaddå‡½æ•°å®ç°eaxåŠ ä¸Šå‚æ•°</span><br><span class="hljs-comment">;å«å‚å®çš„è°ƒç”¨ï¼š</span><br>Myadd&lt;å‚æ•°&gt;<br></code></pre></td></tr></table></figure>
</li>
<li><p>ç»“æ„ä½“ï¼š</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm"><span class="hljs-comment">;ä½¿ç”¨å…³é”®å­—structå’Œendsï¼Œå¦‚</span><br>Point struct<br>	x <span class="hljs-built_in">word</span> ?<br>	y <span class="hljs-built_in">word</span> ?<br>Point ends<br><br><span class="hljs-comment">;å®ä¾‹åŒ–ç»“æ„ä½“</span><br>MyPoint Point&lt;?&gt;	<span class="hljs-comment">;å®ä¾‹åŒ–å‡ºMyPoint</span><br><br><span class="hljs-comment">;è®¿é—®ç»“æ„ä½“æˆå‘˜</span><br><span class="hljs-keyword">mov</span> MyPoint<span class="hljs-number">.</span>x,<span class="hljs-number">123</span><br></code></pre></td></tr></table></figure></li>
</ul>
<h2 id="x64æ±‡ç¼–æ¡†æ¶-MASM"><a href="#x64æ±‡ç¼–æ¡†æ¶-MASM" class="headerlink" title="x64æ±‡ç¼–æ¡†æ¶(MASM)"></a>x64æ±‡ç¼–æ¡†æ¶(MASM)</h2><figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm"><span class="hljs-comment">;x64ç¯å¢ƒä¸‹çš„ä»£ç ï¼Œä¼ å‚çš„æ—¶å€™å…ˆä½¿ç”¨å¯„å­˜å™¨(Windows:rcx,rdx,r8,r9  Linux:rdi,rsi,rdx,rcx,r8,r9)å†ä½¿ç”¨æ ˆ</span><br><span class="hljs-meta">.code</span><br><span class="hljs-comment">;Addå‡½æ•°å£°æ˜</span><br><span class="hljs-keyword">Add</span> proc<br>	<span class="hljs-keyword">push</span> <span class="hljs-built_in">rbp</span><br>	<span class="hljs-keyword">mov</span> <span class="hljs-built_in">rbp</span>,<span class="hljs-built_in">rsp</span><br>	<span class="hljs-keyword">lea</span> <span class="hljs-built_in">rax</span>,[<span class="hljs-built_in">rdi</span> + <span class="hljs-built_in">rsi</span>]		<span class="hljs-comment">;ä»å¯„å­˜å™¨ä¸­å–å‚æ•°</span><br>	<span class="hljs-keyword">pop</span> <span class="hljs-built_in">rbp</span><br>	<span class="hljs-keyword">ret</span><br><span class="hljs-keyword">Add</span> endp<br><br>main proc			<br>	<span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>,<span class="hljs-number">2</span>		<span class="hljs-comment">;æŠŠå‚æ•°ä¼ å…¥å¯„å­˜å™¨ä¸­</span><br>	<span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>,<span class="hljs-number">3</span><br>	<span class="hljs-keyword">call</span> <span class="hljs-keyword">Add</span><br>	<span class="hljs-keyword">ret</span><br>main endp<br>end<br><br><br><span class="hljs-comment">;x86ç¯å¢ƒä¸‹çš„ä»£ç ï¼Œä¼ å‚ä½¿ç”¨æ ˆ</span><br><span class="hljs-meta">.code</span><br><span class="hljs-comment">;Addå‡½æ•°å£°æ˜</span><br><span class="hljs-keyword">Add</span> proc<br>	<span class="hljs-keyword">push</span> <span class="hljs-built_in">ebp</span><br>	<span class="hljs-keyword">mov</span> <span class="hljs-built_in">ebp</span>,<span class="hljs-built_in">esp</span><br>	<span class="hljs-keyword">mov</span> <span class="hljs-built_in">eax</span>,[<span class="hljs-built_in">esp</span>+<span class="hljs-number">8</span>]			<span class="hljs-comment">;ä»æ ˆä¸Šå–å‚æ•°</span><br>	<span class="hljs-keyword">add</span> <span class="hljs-built_in">eax</span>,[<span class="hljs-built_in">esp</span>+<span class="hljs-number">12</span>]<br>	<span class="hljs-keyword">pop</span> <span class="hljs-built_in">ebp</span><br>	<span class="hljs-keyword">ret</span><br><span class="hljs-keyword">Add</span> endp<br><br>main proc<br>	<span class="hljs-keyword">push</span> <span class="hljs-number">3</span>			<span class="hljs-comment">;æŠŠå‚æ•°å‹å…¥æ ˆä¸­</span><br>	<span class="hljs-keyword">push</span> <span class="hljs-number">2</span><br>	<span class="hljs-keyword">call</span> <span class="hljs-keyword">Add</span><br>	<span class="hljs-keyword">add</span> <span class="hljs-built_in">esp</span>,<span class="hljs-number">8</span><br>main endp<br></code></pre></td></tr></table></figure>

<h2 id="å†…è”æ±‡ç¼–ä¸æ··åˆç¼–ç¨‹"><a href="#å†…è”æ±‡ç¼–ä¸æ··åˆç¼–ç¨‹" class="headerlink" title="å†…è”æ±‡ç¼–ä¸æ··åˆç¼–ç¨‹"></a>å†…è”æ±‡ç¼–ä¸æ··åˆç¼–ç¨‹</h2><ul>
<li><p>x86ä¸‹ï¼Œåœ¨Microsoft Visual C++ (MSVC)ç¨‹åºä¸­ä½¿ç”¨æ±‡ç¼–ï¼Œå¯ä»¥é€šè¿‡_asm{}ç›´æ¥å†™åœ¨C++ä»£ç ä¸­:</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    _asm&#123;<br>        <span class="hljs-keyword">xor</span> eax,eax<br>        mov eax,<span class="hljs-number">1</span><br>        add eax,<span class="hljs-number">1</span><br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>x64ä¸‹ï¼Œåœ¨Microsoft Visual C++ (MSVC)ç¨‹åºä¸­ä½¿ç”¨æ±‡ç¼–ï¼Œéœ€è¦ç‹¬ç«‹çš„asmæ–‡ä»¶ï¼Œé€šè¿‡externå£°æ˜ä½¿ç”¨ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-keyword">extern</span> <span class="hljs-string">&quot;C&quot;</span> <span class="hljs-function"><span class="hljs-type">long</span> <span class="hljs-type">long</span> <span class="hljs-title">Add</span><span class="hljs-params">(<span class="hljs-type">long</span> <span class="hljs-type">long</span> number1,<span class="hljs-type">long</span> <span class="hljs-type">long</span> number2)</span></span>;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-type">long</span> <span class="hljs-type">long</span> res=<span class="hljs-built_in">Add</span>(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>);<br>    std::cout&lt;&lt;res&lt;&lt;std::endl;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-comment">//asmæ–‡ä»¶</span><br>.code<br>Add proc<br>    push rbp<br>    mov rbp,rsp<br>    <span class="hljs-keyword">xor</span> rax,rax<br>    add rax,rcx<br>    add rax,rdx<br>    pop rbp<br>    ret<br>Add endp<br>end<br></code></pre></td></tr></table></figure></li>
</ul>
]]></content>
      <categories>
        <category>Reverseå­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>Reverse</tag>
      </tags>
  </entry>
  <entry>
    <title>Day5:å‡½æ•°è°ƒç”¨çº¦å®š</title>
    <url>/2025/07/12/Day5-%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8%E7%BA%A6%E5%AE%9A/</url>
    <content><![CDATA[<p>å‡½æ•°è°ƒç”¨çº¦å®š</p>
<span id="more"></span>

<h2 id="å‡½æ•°è°ƒç”¨çº¦å®š"><a href="#å‡½æ•°è°ƒç”¨çº¦å®š" class="headerlink" title="å‡½æ•°è°ƒç”¨çº¦å®š"></a>å‡½æ•°è°ƒç”¨çº¦å®š</h2><ul>
<li><p>ä¸»è¦æœ‰ä¸‰ç§ï¼šcdeclã€stdcallã€fastcallã€‚ä»¥æ±‚å’Œå‡½æ•°ä¸ºä¾‹</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-comment">//æ±‚å’Œ</span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-type">int</span> <span class="hljs-title function_">sum</span><span class="hljs-params">(<span class="hljs-type">int</span> a,<span class="hljs-type">int</span> b,<span class="hljs-type">int</span> c)</span>&#123;<br>    <span class="hljs-keyword">return</span> a+b+c;<br>&#125;<br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;<br>    <span class="hljs-type">int</span> res=sum(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>,res);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>cdeclï¼šå®Œå…¨æ ˆä¼ å‚ï¼Œå‚æ•°ä»å³å¾€å·¦å…¥æ ˆï¼Œç”±è°ƒç”¨è€…æ¸…ç†å‚æ•°å ç”¨çš„æ ˆç©ºé—´</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm"><span class="hljs-comment">; int __cdecl main()</span><br>_main           proc <span class="hljs-built_in">near</span>               <span class="hljs-comment">; CODE XREF: j__mainâ†‘j</span><br>  <br>var_C           = <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">0Ch</span><br>res             = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">8</span><br>  <br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ebp</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">esp</span><br>                <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0CCh</span><br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ebx</span><br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">esi</span><br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">edi</span><br><span class="hljs-symbol">  </span><br><span class="hljs-symbol">__$EncStackInitStart_2:</span><br>                <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">edi</span>, [<span class="hljs-built_in">ebp</span>+var_C]<br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-number">3</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">0CCCCCCCCh</span><br>                <span class="hljs-keyword">rep</span> <span class="hljs-keyword">stosd</span><br><span class="hljs-symbol">  </span><br><span class="hljs-symbol">__$EncStackInitEnd_2:</span>                   <span class="hljs-comment">; JMC_flag</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, offset _6005466B_entry@cpp<br>                <span class="hljs-keyword">call</span>    j_@__CheckForDebuggerJustMyCode@<span class="hljs-number">4</span> <span class="hljs-comment">; __CheckForDebuggerJustMyCode(x)</span><br>                <span class="hljs-keyword">nop</span><br>                <span class="hljs-keyword">push</span>    <span class="hljs-number">3</span>               <span class="hljs-comment">; å‚æ•°cå…¥æ ˆ</span><br>                <span class="hljs-keyword">push</span>    <span class="hljs-number">2</span>               <span class="hljs-comment">; å‚æ•°bå…¥æ ˆ</span><br>                <span class="hljs-keyword">push</span>    <span class="hljs-number">1</span>               <span class="hljs-comment">; å‚æ•°aå…¥æ ˆ</span><br>                <span class="hljs-keyword">call</span>    j_?sum@@YAHHHH@Z <span class="hljs-comment">; sum(int,int,int)</span><br>                <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0Ch</span>			<span class="hljs-comment">;è¿™é‡Œè°ƒç”¨è€…è¿›è¡Œäº†æ¸…ç†å‚æ•°å ç”¨çš„æ ˆç©ºé—´çš„æ“ä½œ(3ä¸ªå‚æ•°Ã—4å­—èŠ‚)ï¼Œè¢«è°ƒç”¨è€…ä¸è´Ÿè´£</span><br>                <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+res], <span class="hljs-built_in">eax</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+res]<br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br>                <span class="hljs-keyword">push</span>    offset _Format  <span class="hljs-comment">; &quot;%d\n&quot;</span><br>                <span class="hljs-keyword">call</span>    j__printf<br>                <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">8</span><br>                <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">eax</span><br>                <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">edi</span><br>                <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">esi</span><br>                <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ebx</span><br>                <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0CCh</span><br>                <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">esp</span><br>                <span class="hljs-keyword">call</span>    j___RTC_CheckEsp<br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-built_in">ebp</span><br>                <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ebp</span><br>                <span class="hljs-keyword">retn</span><br>_main           endp<br><br><span class="hljs-comment">; int __cdecl sum(int a, int b, int c)</span><br>?sum@@YAHHHH@Z  proc <span class="hljs-built_in">near</span>               <span class="hljs-comment">; CODE XREF: sum(int,int,int)â†‘j</span><br>  <br>a               = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span>  <span class="hljs-number">8</span><br>b               = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span>  <span class="hljs-number">0Ch</span><br>c               = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span>  <span class="hljs-number">10h</span><br>  <br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ebp</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">esp</span><br>                <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0C0h</span>		<span class="hljs-comment">;sumå‡½æ•°è‡ªèº«çš„æ ˆç©ºé—´</span><br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ebx</span><br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">esi</span><br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">edi</span><br><span class="hljs-symbol">  </span><br><span class="hljs-symbol">__$EncStackInitStart:</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">edi</span>, <span class="hljs-built_in">ebp</span><br>                <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-built_in">ecx</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">0CCCCCCCCh</span><br>                <span class="hljs-keyword">rep</span> <span class="hljs-keyword">stosd</span><br><span class="hljs-symbol">  </span><br><span class="hljs-symbol">__$EncStackInitEnd:</span>                     <span class="hljs-comment">; JMC_flag</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, offset _6005466B_entry@cpp<br>                <span class="hljs-keyword">call</span>    j_@__CheckForDebuggerJustMyCode@<span class="hljs-number">4</span> <span class="hljs-comment">; __CheckForDebuggerJustMyCode(x)</span><br>                <span class="hljs-keyword">nop</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+a]<br>                <span class="hljs-keyword">add</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+b]<br>                <span class="hljs-keyword">add</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+c]<br>                <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">edi</span><br>                <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">esi</span><br>                <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ebx</span><br>                <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0C0h</span>		<span class="hljs-comment">;æ¸…ç†è‡ªèº«æ ˆç©ºé—´</span><br>                <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">esp</span><br>                <span class="hljs-keyword">call</span>    j___RTC_CheckEsp<br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-built_in">ebp</span><br>                <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ebp</span><br>                <span class="hljs-keyword">retn</span><br>?sum@@YAHHHH@Z  endp<br></code></pre></td></tr></table></figure>
</li>
<li><p>stdcallï¼šå®Œå…¨æ ˆä¼ å‚ï¼Œå‚æ•°ä»å³å¾€å·¦å…¥æ ˆï¼Œç”±è¢«è°ƒç”¨è€…æ¸…ç†å‚æ•°å ç”¨çš„æ ˆç©ºé—´</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm"><span class="hljs-comment">; int __cdecl main()</span><br>_main           proc <span class="hljs-built_in">near</span>               <span class="hljs-comment">; CODE XREF: j__mainâ†‘j</span><br>  <br>var_C           = <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">0Ch</span><br>res             = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">8</span><br>  <br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ebp</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">esp</span><br>                <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0CCh</span><br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ebx</span><br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">esi</span><br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">edi</span><br><span class="hljs-symbol">  </span><br><span class="hljs-symbol">__$EncStackInitStart_2:</span><br>                <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">edi</span>, [<span class="hljs-built_in">ebp</span>+var_C]<br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-number">3</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">0CCCCCCCCh</span><br>                <span class="hljs-keyword">rep</span> <span class="hljs-keyword">stosd</span><br><span class="hljs-symbol">  </span><br><span class="hljs-symbol">__$EncStackInitEnd_2:</span>                   <span class="hljs-comment">; JMC_flag</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, offset _6005466B_entry@cpp<br>                <span class="hljs-keyword">call</span>    j_@__CheckForDebuggerJustMyCode@<span class="hljs-number">4</span> <span class="hljs-comment">; __CheckForDebuggerJustMyCode(x)</span><br>                <span class="hljs-keyword">nop</span><br>                <span class="hljs-keyword">push</span>    <span class="hljs-number">3</span>               <span class="hljs-comment">; å‚æ•°cå…¥æ ˆ</span><br>                <span class="hljs-keyword">push</span>    <span class="hljs-number">2</span>               <span class="hljs-comment">; å‚æ•°bå…¥æ ˆ</span><br>                <span class="hljs-keyword">push</span>    <span class="hljs-number">1</span>               <span class="hljs-comment">; å‚æ•°aå…¥æ ˆ</span><br>                <span class="hljs-keyword">call</span>    j_?sum@@YGHHHH@Z <span class="hljs-comment">; sum(int,int,int)</span><br>                <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+res], <span class="hljs-built_in">eax</span>		<span class="hljs-comment">;è¿™é‡Œç›´æ¥åˆ°æŠŠè¿”å›å€¼ç»™resäº†ï¼Œè°ƒç”¨è€…ä¸è´Ÿè´£æ¸…ç†å‚æ•°å ç”¨çš„æ ˆç©ºé—´</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+res]<br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br>                <span class="hljs-keyword">push</span>    offset _Format  <span class="hljs-comment">; &quot;%d\n&quot;</span><br>                <span class="hljs-keyword">call</span>    j__printf<br>                <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">8</span><br>                <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">eax</span><br>                <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">edi</span><br>                <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">esi</span><br>                <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ebx</span><br>                <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0CCh</span><br>                <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">esp</span><br>                <span class="hljs-keyword">call</span>    j___RTC_CheckEsp<br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-built_in">ebp</span><br>                <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ebp</span><br>                <span class="hljs-keyword">retn</span><br>_main           endp<br>  <br><span class="hljs-comment">; int __stdcall sum(int a, int b, int c)</span><br>?sum@@YGHHHH@Z  proc <span class="hljs-built_in">near</span>               <span class="hljs-comment">; CODE XREF: sum(int,int,int)â†‘j</span><br>  <br>a               = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span>  <span class="hljs-number">8</span><br>b               = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span>  <span class="hljs-number">0Ch</span><br>c               = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span>  <span class="hljs-number">10h</span><br>  <br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ebp</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">esp</span><br>                <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0C0h</span>		<span class="hljs-comment">;sumçš„æ ˆç©ºé—´</span><br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ebx</span><br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">esi</span><br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">edi</span><br><span class="hljs-symbol">  </span><br><span class="hljs-symbol">__$EncStackInitStart:</span><br>              	 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">edi</span>, <span class="hljs-built_in">ebp</span><br>                <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-built_in">ecx</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">0CCCCCCCCh</span><br>                <span class="hljs-keyword">rep</span> <span class="hljs-keyword">stosd</span><br><span class="hljs-symbol">  </span><br><span class="hljs-symbol">__$EncStackInitEnd:</span>                     <span class="hljs-comment">; JMC_flag</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, offset _6005466B_entry@cpp<br>                <span class="hljs-keyword">call</span>    j_@__CheckForDebuggerJustMyCode@<span class="hljs-number">4</span> <span class="hljs-comment">; __CheckForDebuggerJustMyCode(x)</span><br>                <span class="hljs-keyword">nop</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+a]<br>                <span class="hljs-keyword">add</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+b]<br>                <span class="hljs-keyword">add</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+c]<br>                <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">edi</span><br>                <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">esi</span><br>                <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ebx</span><br>                <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0C0h</span>		<span class="hljs-comment">;æ¸…ç†è‡ªèº«æ ˆç©ºé—´</span><br>                <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">esp</span><br>                <span class="hljs-keyword">call</span>    j___RTC_CheckEsp<br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-built_in">ebp</span><br>                <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ebp</span><br>                <span class="hljs-keyword">retn</span>    <span class="hljs-number">0Ch</span>			<span class="hljs-comment">;è¢«è°ƒç”¨è€…é€šè¿‡è¿”å›æŒ‡ä»¤ç»™espå¢åŠ 0Chï¼Œæ¸…ç†å‚æ•°å ç”¨çš„æ ˆç©ºé—´</span><br>?sum@@YGHHHH@Z  endp<br></code></pre></td></tr></table></figure>
</li>
<li><p>fastcallï¼šå¯„å­˜å™¨+æ ˆä¼ å‚ï¼Œä¼˜å…ˆä½¿ç”¨å¯„å­˜å™¨ï¼Œå‰©ä½™å‚æ•°ä»å³å¾€å·¦å…¥æ ˆï¼Œç”±è¢«è°ƒç”¨è€…æ¸…ç†å‚æ•°å ç”¨çš„æ ˆç©ºé—´</p>
<p>å¯„å­˜å™¨ä¼ å‚ä¼˜å…ˆçº§ï¼š</p>
<p>x86ï¼šecx  edx  æ ˆ</p>
<p>x64ï¼šrcx  rdx  r8  r9  æ ˆ</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm"><span class="hljs-comment">; int __cdecl main()</span><br>_main           proc <span class="hljs-built_in">near</span>               <span class="hljs-comment">; CODE XREF: j__mainâ†‘j</span><br>  <br>var_C           = <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">0Ch</span><br>res             = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">8</span><br>  <br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ebp</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">esp</span><br>                <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0CCh</span><br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ebx</span><br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">esi</span><br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">edi</span><br><span class="hljs-symbol">  </span><br><span class="hljs-symbol">__$EncStackInitStart_2:</span><br>                <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">edi</span>, [<span class="hljs-built_in">ebp</span>+var_C]<br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-number">3</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">0CCCCCCCCh</span><br>                <span class="hljs-keyword">rep</span> <span class="hljs-keyword">stosd</span><br><span class="hljs-symbol">  </span><br><span class="hljs-symbol">__$EncStackInitEnd_2:</span>                   <span class="hljs-comment">; JMC_flag</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, offset _6005466B_entry@cpp<br>                <span class="hljs-keyword">call</span>    j_@__CheckForDebuggerJustMyCode@<span class="hljs-number">4</span> <span class="hljs-comment">; __CheckForDebuggerJustMyCode(x)</span><br>                <span class="hljs-keyword">nop</span><br>                <span class="hljs-keyword">push</span>    <span class="hljs-number">3</span>               <span class="hljs-comment">; å‚æ•°cå…¥æ ˆ</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">edx</span>, <span class="hljs-number">2</span>          <span class="hljs-comment">; å‚æ•°bå­˜å…¥å¯„å­˜å™¨</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-number">1</span>          <span class="hljs-comment">; å‚æ•°aå­˜å…¥å¯„å­˜å™¨</span><br>                <span class="hljs-keyword">call</span>    j_?sum@@YIHHHH@Z <span class="hljs-comment">; sum(int,int,int)</span><br>                <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+res], <span class="hljs-built_in">eax</span>		<span class="hljs-comment">;è¿™é‡Œä¹Ÿæ˜¯æ²¡æœ‰è°ƒç”¨è€…å¯¹å‚æ•°å ç”¨çš„æ ˆç©ºé—´çš„æ¸…ç†</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+res]<br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br>                <span class="hljs-keyword">push</span>    offset _Format  <span class="hljs-comment">; &quot;%d\n&quot;</span><br>                <span class="hljs-keyword">call</span>    j__printf<br>                <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">8</span><br>                <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">eax</span><br>                <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">edi</span><br>                <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">esi</span><br>                <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ebx</span><br>                <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0CCh</span><br>                <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">esp</span><br>                <span class="hljs-keyword">call</span>    j___RTC_CheckEsp<br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-built_in">ebp</span><br>                <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ebp</span><br>                <span class="hljs-keyword">retn</span><br>_main           endp<br><br><span class="hljs-comment">; int __fastcall sum(int a, int b, int c)</span><br>?sum@@YIHHHH@Z  proc <span class="hljs-built_in">near</span>               <span class="hljs-comment">; CODE XREF: sum(int,int,int)â†‘j</span><br>  <br>var_18          = <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">18h</span><br>b               = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">14h</span><br>a               = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">8</span><br>c               = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span>  <span class="hljs-number">8</span><br>  <br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ebp</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">esp</span><br>                <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0D8h</span>		<span class="hljs-comment">;sumå¼€è¾Ÿæ ˆç©ºé—´</span><br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ebx</span><br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">esi</span><br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">edi</span><br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ecx</span><br><span class="hljs-symbol">  </span><br><span class="hljs-symbol">__$EncStackInitStart:</span><br>                <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">edi</span>, [<span class="hljs-built_in">ebp</span>+var_18]<br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-number">6</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">0CCCCCCCCh</span><br>                <span class="hljs-keyword">rep</span> <span class="hljs-keyword">stosd</span><br><span class="hljs-symbol">  </span><br><span class="hljs-symbol">__$EncStackInitEnd:</span><br>                <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ecx</span><br>                <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+b], <span class="hljs-built_in">edx</span><br>                <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+a], <span class="hljs-built_in">ecx</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, offset _6005466B_entry@cpp <span class="hljs-comment">; JMC_flag</span><br>                <span class="hljs-keyword">call</span>    j_@__CheckForDebuggerJustMyCode@<span class="hljs-number">4</span> <span class="hljs-comment">; __CheckForDebuggerJustMyCode(x)</span><br>                <span class="hljs-keyword">nop</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+a]<br>                <span class="hljs-keyword">add</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+b]<br>                <span class="hljs-keyword">add</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+c]<br>                <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">edi</span><br>                <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">esi</span><br>                <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ebx</span><br>                <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0D8h</span>		<span class="hljs-comment">;sumæ¸…ç†æ ˆç©ºé—´</span><br>                <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">esp</span><br>                <span class="hljs-keyword">call</span>    j___RTC_CheckEsp<br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-built_in">ebp</span><br>                <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ebp</span><br>                <span class="hljs-keyword">retn</span>    <span class="hljs-number">4</span>				<span class="hljs-comment">;ç”±äºåªæœ‰ä¸€ä¸ªå‚æ•°è¢«pushåˆ°æ ˆä¸Šï¼Œæ‰€ä»¥è¢«è°ƒç”¨è€…è¿”å›4ï¼Œæ¸…ç†å‚æ•°å ç”¨çš„æ ˆç©ºé—´</span><br>?sum@@YIHHHH@Z  endp<br></code></pre></td></tr></table></figure></li>
</ul>
]]></content>
      <categories>
        <category>Reverseå­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>Reverse</tag>
      </tags>
  </entry>
  <entry>
    <title>Day6:if-elseè¯­å¥è¯†åˆ«ã€switchè¯­å¥è¯†åˆ«ã€å¾ªç¯è¯­å¥è¯†åˆ«</title>
    <url>/2025/07/15/Day6-switch%E8%AF%AD%E5%8F%A5%E8%AF%86%E5%88%AB/</url>
    <content><![CDATA[<p>if-elseè¯­å¥è¯†åˆ«ã€switchè¯­å¥è¯†åˆ«ã€å¾ªç¯è¯­å¥è¯†åˆ«</p>
<span id="more"></span>

<h2 id="if-elseè¯­å¥è¯†åˆ«"><a href="#if-elseè¯­å¥è¯†åˆ«" class="headerlink" title="if-elseè¯­å¥è¯†åˆ«"></a>if-elseè¯­å¥è¯†åˆ«</h2><ul>
<li><p>ç¬¬ä¸€ç§ï¼Œæ•°å€¼æ¯”è¾ƒä½œä¸ºæ¡ä»¶ï¼ˆx86debugä¸ºä¾‹ï¼Œå…¶ä½™ç±»ä¼¼ï¼Œä»…æ˜¯æ¯”è¾ƒæ–¹æ³•ï¼ˆå¦‚ä½¿ç”¨subè€Œä¸æ˜¯cmpï¼‰å’Œæ¨¡å¼ç‰¹å¾ä¸Šçš„å·®å¼‚ï¼‰</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm"><span class="hljs-symbol">.text:</span>004702D0                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_C]<br><span class="hljs-symbol">.text:</span>004702D3                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>004702D4                 <span class="hljs-keyword">push</span>    offset unk_545E50 <span class="hljs-comment">; %d</span><br><span class="hljs-symbol">.text:</span>004702D9                 <span class="hljs-keyword">call</span>    sub_4681E0      <span class="hljs-comment">; scanf</span><br><span class="hljs-symbol">.text:</span>004702DE                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span>004702E1                 <span class="hljs-keyword">cmp</span>     [<span class="hljs-built_in">ebp</span>+var_C], <span class="hljs-number">1</span><br><span class="hljs-symbol">.text:</span>004702E5                 <span class="hljs-keyword">jnz</span>     short loc_4702F6 <span class="hljs-comment">; if [ebp+var_C]!=1, jump to loc_4702f6</span><br><span class="hljs-symbol">.text:</span>004702E7                 <span class="hljs-keyword">push</span>    offset aNEquales1 <span class="hljs-comment">; &quot;n equales 1&quot;</span><br><span class="hljs-symbol">.text:</span>004702EC                 <span class="hljs-keyword">call</span>    sub_468D1B      <span class="hljs-comment">; printf</span><br><span class="hljs-symbol">.text:</span>004702F1                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">4</span><br><span class="hljs-symbol">.text:</span>004702F4                 <span class="hljs-keyword">jmp</span>     short loc_470303<br><span class="hljs-symbol">.text:</span>004702F6 <span class="hljs-comment">; ---------------------------------------------------------------------------</span><br><span class="hljs-symbol">.text:</span>004702F6<br><span class="hljs-symbol">.text:</span>004702F6 loc_4702F6:                             <span class="hljs-comment">; CODE XREF: main+45â†‘j</span><br><span class="hljs-symbol">.text:</span>004702F6                 <span class="hljs-keyword">push</span>    offset aNDoesNotEqual1 <span class="hljs-comment">; &quot;n does not equal 1&quot;</span><br><span class="hljs-symbol">.text:</span>004702FB                 <span class="hljs-keyword">call</span>    sub_468D1B      <span class="hljs-comment">; printf</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470300</span>                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">4</span><br></code></pre></td></tr></table></figure>

<p>æºç ï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> n;<br><span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);<br><span class="hljs-keyword">if</span> (n == <span class="hljs-number">1</span>)<br>	<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;n equales 1&quot;</span>);<br><span class="hljs-keyword">else</span><br>	<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;n does not equal 1&quot;</span>);<br></code></pre></td></tr></table></figure>
</li>
<li><p>ç¬¬äºŒç§ï¼Œå˜é‡ç›´æ¥ä½œä¸ºæ¡ä»¶</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm"><span class="hljs-symbol">.text:</span><span class="hljs-number">00470303</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_18]<br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470306</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470307</span>                 <span class="hljs-keyword">push</span>    offset unk_545E50 <span class="hljs-comment">; %d</span><br><span class="hljs-symbol">.text:</span>0047030C                 <span class="hljs-keyword">call</span>    sub_4681E0      <span class="hljs-comment">; scanf</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470311</span>                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470314</span>                 <span class="hljs-keyword">cmp</span>     [<span class="hljs-built_in">ebp</span>+var_18], <span class="hljs-number">0</span> <span class="hljs-comment">; å’Œ&#x27;0&#x27;æ¯”è¾ƒ</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470318</span>                 <span class="hljs-keyword">jz</span>      short loc_470327 <span class="hljs-comment">; if [ebp+var_18]==0, jump to loc_470327, è·³è¿‡printf</span><br><span class="hljs-symbol">.text:</span>0047031A                 <span class="hljs-keyword">push</span>    offset aJudgeIsNotZero <span class="hljs-comment">; &quot;judge is not zero&quot;</span><br><span class="hljs-symbol">.text:</span>0047031F                 <span class="hljs-keyword">call</span>    sub_468D1B      <span class="hljs-comment">; printf</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470324</span>                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">4</span><br></code></pre></td></tr></table></figure>

<p>æºç ï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> judge;<br><span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;judge);<br><span class="hljs-keyword">if</span> (judge)<br>	<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;judge is not zero&quot;</span>);<br></code></pre></td></tr></table></figure>
</li>
<li><p>ç¬¬ä¸‰ç§ï¼Œè¿”å›å€¼ï¼ˆå‡½æ•°å¼ï¼‰ä½œä¸ºæ¡ä»¶</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm"><span class="hljs-symbol">.text:</span><span class="hljs-number">00470387</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_24]<br><span class="hljs-symbol">.text:</span>0047038A                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>0047038B                 <span class="hljs-keyword">push</span>    offset unk_545E50 <span class="hljs-comment">; %d</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470390</span>                 <span class="hljs-keyword">call</span>    sub_4681E0      <span class="hljs-comment">; scanf</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470395</span>                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470398</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_24]<br><span class="hljs-symbol">.text:</span>0047039B                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span>             <span class="hljs-comment">; è¾“å…¥çš„å€¼å…¥æ ˆï¼Œå³å‡½æ•°ä¼ å‚</span><br><span class="hljs-symbol">.text:</span>0047039C                 <span class="hljs-keyword">call</span>    sub_46B214      <span class="hljs-comment">; è‡ªå®šä¹‰å‡½æ•°</span><br><span class="hljs-symbol">.text:</span>004703A1                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">4</span><br><span class="hljs-symbol">.text:</span>004703A4                 <span class="hljs-keyword">test</span>    <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">eax</span>        <span class="hljs-comment">; 1 &amp; 1 = 0ï¼› 0 &amp; 0 = 1</span><br><span class="hljs-symbol">.text:</span>004703A6                 <span class="hljs-keyword">jz</span>      short loc_4703B5<br><span class="hljs-symbol">.text:</span>004703A8                 <span class="hljs-keyword">push</span>    offset aItS0    <span class="hljs-comment">; &quot;it&#x27;s 0\n&quot;</span><br><span class="hljs-symbol">.text:</span>004703AD                 <span class="hljs-keyword">call</span>    sub_468D1B<br><span class="hljs-symbol">.text:</span>004703B2                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">4</span><br><br><span class="hljs-comment">;sub_46b214</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470110</span> arg_0           = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span>  <span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470110</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470110</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470111</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">esp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470113</span>                 <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0C0h</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470119</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ebx</span><br><span class="hljs-symbol">.text:</span>0047011A                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">esi</span><br><span class="hljs-symbol">.text:</span>0047011B                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">edi</span><br><span class="hljs-symbol">.text:</span>0047011C                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">edi</span>, <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span>0047011E                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-built_in">ecx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470120</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">0CCCCCCCCh</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470125</span>                 <span class="hljs-keyword">rep</span> <span class="hljs-keyword">stosd</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470127</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, offset unk_57500E<br><span class="hljs-symbol">.text:</span>0047012C                 <span class="hljs-keyword">call</span>    sub_46B660<br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470131</span>                 <span class="hljs-keyword">nop</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470132</span>                 <span class="hljs-keyword">cmp</span>     [<span class="hljs-built_in">ebp</span>+arg_0], <span class="hljs-number">0</span>  <span class="hljs-comment">; [ebp+8], eaxåœ¨æ ˆä¸Šçš„ä½ç½®</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470136</span>                 <span class="hljs-keyword">jnz</span>     short loc_470141 <span class="hljs-comment">; eax=0</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470138</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">1</span>          <span class="hljs-comment">; if [ebp+arg_0]==0, eax=1, return 1(eax)</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0047013D</span>                 <span class="hljs-keyword">jmp</span>     short loc_470143<br><span class="hljs-symbol">.text:</span>0047013F <span class="hljs-comment">; ---------------------------------------------------------------------------</span><br><span class="hljs-symbol">.text:</span>0047013F                 <span class="hljs-keyword">jmp</span>     short loc_470143<br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470141</span> <span class="hljs-comment">; ---------------------------------------------------------------------------</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470141</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470141</span> loc_470141:                             <span class="hljs-comment">; CODE XREF: sub_470110+26â†‘j</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470141</span>                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">eax</span>        <span class="hljs-comment">; eax=0</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470143</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470143</span> loc_470143:                             <span class="hljs-comment">; CODE XREF: sub_470110+2Dâ†‘j</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470143</span>                                         <span class="hljs-comment">; sub_470110+2Fâ†‘j</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470143</span>                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">edi</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470144</span>                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">esi</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470145</span>                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ebx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470146</span>                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0C0h</span><br><span class="hljs-symbol">.text:</span>0047014C                 <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">esp</span><br><span class="hljs-symbol">.text:</span>0047014E                 <span class="hljs-keyword">call</span>    sub_46A62A<br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470153</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470155</span>                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470156</span>                 <span class="hljs-keyword">retn</span><br></code></pre></td></tr></table></figure>

<p>æºç </p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">IfZero</span><span class="hljs-params">(<span class="hljs-type">int</span> a)</span> &#123;<br>	<span class="hljs-keyword">if</span> (a == <span class="hljs-number">0</span>)<br>		<span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>	<span class="hljs-keyword">else</span><br>		<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;<br>    <span class="hljs-type">int</span> a;<br>	<span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;a);<br>	<span class="hljs-keyword">if</span>(IfZero(a))<br>		<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;it&#x27;s 0\n&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h2 id="switchè¯­å¥è¯†åˆ«"><a href="#switchè¯­å¥è¯†åˆ«" class="headerlink" title="switchè¯­å¥è¯†åˆ«"></a>switchè¯­å¥è¯†åˆ«</h2><ul>
<li><p>æ¯”è¾ƒç®€å•çš„æƒ…å†µä¸‹ï¼š</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm"><span class="hljs-symbol">.text:</span><span class="hljs-number">00470327</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_24]<br><span class="hljs-symbol">.text:</span>0047032A                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>0047032B                 <span class="hljs-keyword">push</span>    offset unk_545E50 <span class="hljs-comment">; %d</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470330</span>                 <span class="hljs-keyword">call</span>    sub_4681E0      <span class="hljs-comment">; scanf</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470335</span>                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470338</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_24]<br><span class="hljs-symbol">.text:</span>0047033B                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_EC], <span class="hljs-built_in">eax</span> <span class="hljs-comment">; [ebp+var_EC]==[ebp+var_24], ç”¨ä¸´æ—¶å˜é‡[ebp+var_EC]æ¥æ£€éªŒcase</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470341</span>                 <span class="hljs-keyword">cmp</span>     [<span class="hljs-built_in">ebp</span>+var_EC], <span class="hljs-number">1</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470348</span>                 <span class="hljs-keyword">jz</span>      short loc_47035E <span class="hljs-comment">; case1è¾“å‡º</span><br><span class="hljs-symbol">.text:</span>0047034A                 <span class="hljs-keyword">cmp</span>     [<span class="hljs-built_in">ebp</span>+var_EC], <span class="hljs-number">5</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470351</span>                 <span class="hljs-keyword">jz</span>      short loc_470371 <span class="hljs-comment">; case5è¾“å‡º</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470353</span>                 <span class="hljs-keyword">cmp</span>     [<span class="hljs-built_in">ebp</span>+var_EC], <span class="hljs-number">0Ah</span><br><span class="hljs-symbol">.text:</span>0047035A                 <span class="hljs-keyword">jz</span>      short loc_470384 <span class="hljs-comment">; case10è¾“å‡º</span><br><span class="hljs-symbol">.text:</span>0047035C                 <span class="hljs-keyword">jmp</span>     short loc_470395 <span class="hljs-comment">; breakç„¶åsystem(&quot;pause&quot;)</span><br><span class="hljs-symbol">.text:</span>0047035E <span class="hljs-comment">; ---------------------------------------------------------------------------</span><br><span class="hljs-symbol">.text:</span>0047035E<br><span class="hljs-symbol">.text:</span>0047035E loc_47035E:                             <span class="hljs-comment">; CODE XREF: main+A8â†‘j</span><br><span class="hljs-symbol">.text:</span>0047035E                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_24]<br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470361</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470362</span>                 <span class="hljs-keyword">push</span>    offset aNEqualsD <span class="hljs-comment">; &quot;n equals %d&quot;</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470367</span>                 <span class="hljs-keyword">call</span>    sub_468D1B      <span class="hljs-comment">; printf</span><br><span class="hljs-symbol">.text:</span>0047036C                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span>0047036F                 <span class="hljs-keyword">jmp</span>     short loc_470395<br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470371</span> <span class="hljs-comment">; ---------------------------------------------------------------------------</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470371</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470371</span> loc_470371:                             <span class="hljs-comment">; CODE XREF: main+B1â†‘j</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470371</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_24]<br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470374</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470375</span>                 <span class="hljs-keyword">push</span>    offset aNEqualsD <span class="hljs-comment">; &quot;n equals %d&quot;</span><br><span class="hljs-symbol">.text:</span>0047037A                 <span class="hljs-keyword">call</span>    sub_468D1B      <span class="hljs-comment">; printf</span><br><span class="hljs-symbol">.text:</span>0047037F                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470382</span>                 <span class="hljs-keyword">jmp</span>     short loc_470395<br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470384</span> <span class="hljs-comment">; ---------------------------------------------------------------------------</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470384</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470384</span> loc_470384:                             <span class="hljs-comment">; CODE XREF: main+BAâ†‘j</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470384</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_24]<br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470387</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470388</span>                 <span class="hljs-keyword">push</span>    offset aNEqualsD <span class="hljs-comment">; &quot;n equals %d&quot;</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0047038D</span>                 <span class="hljs-keyword">call</span>    sub_468D1B      <span class="hljs-comment">; printf</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470392</span>                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470395</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470395</span> loc_470395:                             <span class="hljs-comment">; CODE XREF: main+BCâ†‘j</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470395</span>                                         <span class="hljs-comment">; main+CFâ†‘j ...</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470395</span>                 <span class="hljs-keyword">push</span>    offset aPause   <span class="hljs-comment">; &quot;pause&quot;</span><br><span class="hljs-symbol">.text:</span>0047039A                 <span class="hljs-keyword">call</span>    sub_46AFAD      <span class="hljs-comment">; system(&quot;pause&quot;)</span><br><span class="hljs-symbol">.text:</span>0047039F                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">4</span><br></code></pre></td></tr></table></figure>

<p>æºç ï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> number;<br><span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;number);<br><span class="hljs-keyword">switch</span> (number) &#123;<br><span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br>	<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;n equals %d&quot;</span>, number);<br>	<span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-number">5</span>:<br>	<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;n equals %d&quot;</span>, number);<br>	<span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-number">10</span>:<br>	<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;n equals %d&quot;</span>, number);<br>	<span class="hljs-keyword">break</span>;<br>&#125;<br>system(<span class="hljs-string">&quot;pause&quot;</span>);<br></code></pre></td></tr></table></figure>
</li>
<li><p>å†å¤æ‚ç‚¹ï¼Œä¼šä¼˜åŒ–å‡ºè·³è½¬è¡¨ï¼Œå³æ¯ä¸ªcaseè·³è½¬çš„åœ°å€ä¼šè¢«é›†åˆæˆä¸€ä¸ªæ•°ç»„ï¼Œåƒè¡¨ä¸€æ ·</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm"><span class="hljs-symbol">.text:</span>004702D3                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>004702D4                 <span class="hljs-keyword">push</span>    offset unk_545E50 <span class="hljs-comment">; %d</span><br><span class="hljs-symbol">.text:</span>004702D9                 <span class="hljs-keyword">call</span>    sub_4681E0      <span class="hljs-comment">; scanf</span><br><span class="hljs-symbol">.text:</span>004702DE                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span>004702E1                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_C]<br><span class="hljs-symbol">.text:</span>004702E4                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_D4], <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>004702EA                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, [<span class="hljs-built_in">ebp</span>+var_D4] <span class="hljs-comment">; æŠŠè¾“å…¥å€¼ä¼ åˆ°ecxï¼Œä¸‹ä¸€æ­¥å‡å»1ï¼Œå‡1çš„åŸå› è§åé¢çš„è§£é‡Š</span><br><span class="hljs-symbol">.text:</span>004702F0                 <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-number">1</span>          <span class="hljs-comment">; switch 67 cases</span><br><span class="hljs-symbol">.text:</span>004702F3                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_D4], <span class="hljs-built_in">ecx</span><br><span class="hljs-symbol">.text:</span>004702F9                 <span class="hljs-keyword">cmp</span>     [<span class="hljs-built_in">ebp</span>+var_D4], <span class="hljs-number">42h</span> <span class="hljs-comment">; æŠŠè¾“å…¥å€¼å’Œ42h(66)æ¯”è¾ƒï¼Œä¸‹ä¸€æ­¥æ˜¯å¤§äº66å°±è·³å‡ºcaseçš„åˆ¤æ–­</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470300</span>                 <span class="hljs-keyword">ja</span>      def_470313      <span class="hljs-comment">; jumptable 00470313 default case, cases 2,4,6-9,12-16,18-66</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470306</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">edx</span>, [<span class="hljs-built_in">ebp</span>+var_D4]<br><span class="hljs-symbol">.text:</span>0047030C                 <span class="hljs-keyword">movzx</span>   <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">ds</span>:byte_470418[<span class="hljs-built_in">edx</span>] <span class="hljs-comment">; è·³è½¬è¡¨ç´¢å¼•å€¼è¡¨ï¼Œå³é¢„åˆ¤äº†è¾“å…¥å€¼çš„èŒƒå›´å¹¶ä¸”ä¸ºæ¯ä¸ªå¯èƒ½çš„å€¼å»ºç«‹äº†ç´¢å¼•å€¼è¡¨ï¼ˆæ¯”å¦‚è¯´ç°åœ¨ç¡®å®šäº†èŒƒå›´æ˜¯0-66ï¼Œå°±æšä¸¾äº†0-66è¿™äº›æ•°å€¼å¯¹åº”çš„ç´¢å¼•ï¼Œç„¶åå†æ ¹æ®ç´¢å¼•æ‰¾åˆ°åº”æ”¹è·³è½¬çš„åœ°å€</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470313</span>                 <span class="hljs-keyword">jmp</span>     <span class="hljs-built_in">ds</span>:jpt_470313[<span class="hljs-built_in">eax</span>*<span class="hljs-number">4</span>] <span class="hljs-comment">; switch jump</span><br><span class="hljs-symbol">.text:</span>0047031A <span class="hljs-comment">; ---------------------------------------------------------------------------</span><br><span class="hljs-symbol">.text:</span>0047031A<br><span class="hljs-symbol">.text:</span>0047031A loc_47031A:                             <span class="hljs-comment">; CODE XREF: sub_4702A0+73â†‘j</span><br><span class="hljs-symbol">.text:</span>0047031A                                         <span class="hljs-comment">; DATA XREF: .text:jpt_470313â†“o</span><br><span class="hljs-symbol">.text:</span>0047031A                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_C] <span class="hljs-comment">; jumptable 00470313 case 1</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0047031D</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>0047031E                 <span class="hljs-keyword">push</span>    offset aNEqualsD <span class="hljs-comment">; &quot;n equals %d&quot;</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470323</span>                 <span class="hljs-keyword">call</span>    sub_468D1B      <span class="hljs-comment">; printf</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470328</span>                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span>0047032B                 <span class="hljs-keyword">jmp</span>     short def_470313 <span class="hljs-comment">; jumptable 00470313 default case, cases 2,4,6-9,12-16,18-66</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0047032D</span> <span class="hljs-comment">; ---------------------------------------------------------------------------</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0047032D</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0047032D</span> loc_47032D:                             <span class="hljs-comment">; CODE XREF: sub_4702A0+73â†‘j</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0047032D</span>                                         <span class="hljs-comment">; DATA XREF: .text:jpt_470313â†“o</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0047032D</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_C] <span class="hljs-comment">; jumptable 00470313 case 5</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470330</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470331</span>                 <span class="hljs-keyword">push</span>    offset aNEqualsD <span class="hljs-comment">; &quot;n equals %d&quot;</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470336</span>                 <span class="hljs-keyword">call</span>    sub_468D1B      <span class="hljs-comment">; printf</span><br><span class="hljs-symbol">.text:</span>0047033B                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span>0047033E                 <span class="hljs-keyword">jmp</span>     short def_470313 <span class="hljs-comment">; jumptable 00470313 default case, cases 2,4,6-9,12-16,18-66</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470340</span> <span class="hljs-comment">; ---------------------------------------------------------------------------</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470340</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470340</span> loc_470340:                             <span class="hljs-comment">; CODE XREF: sub_4702A0+73â†‘j</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470340</span>                                         <span class="hljs-comment">; DATA XREF: .text:jpt_470313â†“o</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470340</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_C] <span class="hljs-comment">; jumptable 00470313 case 10</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470343</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470344</span>                 <span class="hljs-keyword">push</span>    offset aNEqualsD <span class="hljs-comment">; &quot;n equals %d&quot;</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470349</span>                 <span class="hljs-keyword">call</span>    sub_468D1B      <span class="hljs-comment">; printf</span><br><span class="hljs-symbol">.text:</span>0047034E                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470351</span>                 <span class="hljs-keyword">jmp</span>     short def_470313 <span class="hljs-comment">; jumptable 00470313 default case, cases 2,4,6-9,12-16,18-66</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470353</span> <span class="hljs-comment">; ---------------------------------------------------------------------------</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470353</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470353</span> loc_470353:                             <span class="hljs-comment">; CODE XREF: sub_4702A0+73â†‘j</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470353</span>                                         <span class="hljs-comment">; DATA XREF: .text:jpt_470313â†“o</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470353</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_C] <span class="hljs-comment">; jumptable 00470313 case 17</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470356</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470357</span>                 <span class="hljs-keyword">push</span>    offset aNEqualsD <span class="hljs-comment">; &quot;n equals %d&quot;</span><br><span class="hljs-symbol">.text:</span>0047035C                 <span class="hljs-keyword">call</span>    sub_468D1B      <span class="hljs-comment">; printf</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470361</span>                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470364</span>                 <span class="hljs-keyword">jmp</span>     short def_470313 <span class="hljs-comment">; jumptable 00470313 default case, cases 2,4,6-9,12-16,18-66</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470366</span> <span class="hljs-comment">; ---------------------------------------------------------------------------</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470366</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470366</span> loc_470366:                             <span class="hljs-comment">; CODE XREF: sub_4702A0+73â†‘j</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470366</span>                                         <span class="hljs-comment">; DATA XREF: .text:jpt_470313â†“o</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470366</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_C] <span class="hljs-comment">; jumptable 00470313 case 11</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470369</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>0047036A                 <span class="hljs-keyword">push</span>    offset aNEqualsD <span class="hljs-comment">; &quot;n equals %d&quot;</span><br><span class="hljs-symbol">.text:</span>0047036F                 <span class="hljs-keyword">call</span>    sub_468D1B      <span class="hljs-comment">; printf</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470374</span>                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470377</span>                 <span class="hljs-keyword">jmp</span>     short def_470313 <span class="hljs-comment">; jumptable 00470313 default case, cases 2,4,6-9,12-16,18-66</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470379</span> <span class="hljs-comment">; ---------------------------------------------------------------------------</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470379</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470379</span> loc_470379:                             <span class="hljs-comment">; CODE XREF: sub_4702A0+73â†‘j</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470379</span>                                         <span class="hljs-comment">; DATA XREF: .text:jpt_470313â†“o</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470379</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_C] <span class="hljs-comment">; jumptable 00470313 case 67</span><br><span class="hljs-symbol">.text:</span>0047037C                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0047037D</span>                 <span class="hljs-keyword">push</span>    offset aNEqualsD <span class="hljs-comment">; &quot;n equals %d&quot;</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470382</span>                 <span class="hljs-keyword">call</span>    sub_468D1B      <span class="hljs-comment">; printf</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470387</span>                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span>0047038A                 <span class="hljs-keyword">jmp</span>     short def_470313 <span class="hljs-comment">; jumptable 00470313 default case, cases 2,4,6-9,12-16,18-66</span><br><span class="hljs-symbol">.text:</span>0047038C <span class="hljs-comment">; ---------------------------------------------------------------------------</span><br><span class="hljs-symbol">.text:</span>0047038C<br><span class="hljs-symbol">.text:</span>0047038C loc_47038C:                             <span class="hljs-comment">; CODE XREF: sub_4702A0+73â†‘j</span><br><span class="hljs-symbol">.text:</span>0047038C                                         <span class="hljs-comment">; DATA XREF: .text:jpt_470313â†“o</span><br><span class="hljs-symbol">.text:</span>0047038C                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_C] <span class="hljs-comment">; jumptable 00470313 case 3</span><br><span class="hljs-symbol">.text:</span>0047038F                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470390</span>                 <span class="hljs-keyword">push</span>    offset aNEqualsD <span class="hljs-comment">; &quot;n equals %d&quot;</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470395</span>                 <span class="hljs-keyword">call</span>    sub_468D1B      <span class="hljs-comment">; printf</span><br><span class="hljs-symbol">.text:</span>0047039A                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0047039D</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0047039D</span> def_470313:                             <span class="hljs-comment">; CODE XREF: sub_4702A0+60â†‘j</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0047039D</span>                                         <span class="hljs-comment">; sub_4702A0+73â†‘j ...</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0047039D</span>                 <span class="hljs-keyword">push</span>    offset aPause   <span class="hljs-comment">; jumptable 00470313 default case, cases 2,4,6-9,12-16,18-66</span><br><span class="hljs-symbol">.text:</span>004703A2                 <span class="hljs-keyword">call</span>    sub_46AFAD      <span class="hljs-comment">; system</span><br><span class="hljs-symbol">.text:</span>004703A7                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">4</span><br></code></pre></td></tr></table></figure>

<p>æºç </p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> number;<br><span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;number);<br><span class="hljs-keyword">switch</span> (number) &#123;<br><span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br>	<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;n equals %d&quot;</span>, number);<br>	<span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-number">5</span>:<br>	<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;n equals %d&quot;</span>, number);<br>	<span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-number">10</span>:<br>	<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;n equals %d&quot;</span>, number);<br>	<span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-number">17</span>:<br>	<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;n equals %d&quot;</span>, number);<br>	<span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-number">11</span>:<br>	<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;n equals %d&quot;</span>, number);<br>	<span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-number">67</span>:<br>	<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;n equals %d&quot;</span>, number);<br>	<span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:<br>	<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;n equals %d&quot;</span>, number);<br>	<span class="hljs-keyword">break</span>;<br>&#125;<br>system(<span class="hljs-string">&quot;pause&quot;</span>);<br></code></pre></td></tr></table></figure>
</li>
<li><p>å¯¹è·³è½¬è¡¨å’Œç´¢å¼•å€¼è¡¨è¿›è¡Œè¿›ä¸€æ­¥è§£é‡Šï¼š</p>
<p>å…ˆçœ‹è·³è½¬è¡¨ï¼š</p>
<p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-07-16%20000211.png" alt="è·³è½¬è¡¨"></p>
<p>å¯ä»¥çœ‹åˆ°è·³è½¬è¡¨åªæœ‰ç®€å•çš„8ç§æƒ…å†µã€‚ä½†æ˜¯ç¼–è¯‘å™¨ï¼ˆåç¼–è¯‘å™¨ï¼Ÿï¼‰åªèƒ½æ ¹æ®caseçš„æœ€å¤§å€¼ç”¨ç¬¨æ–¹æ³•æšä¸¾å¯èƒ½çš„å€¼ï¼Œè¿™æ—¶å€™ï¼Œå°±å¯ä»¥ç»™è¿™äº›æšä¸¾çš„å€¼åˆ†æˆä¸¤ç§ï¼šä¸€ç§æ˜¯caseé‡Œæœ‰çš„ï¼Œä¸€ç§æ˜¯caseé‡Œæ²¡æœ‰çš„ã€‚çœ‹è·³è½¬è¡¨çš„æœ€åä¸€ä¸ªï¼Œå«defè€Œä¸æ˜¯locï¼Œè¿™ä¸ªå°±æ˜¯ç»™caseé‡Œæ²¡æœ‰çš„æšä¸¾å€¼å‡†å¤‡çš„ã€‚å› ä¸ºåˆ†ä¸ºcaseé‡Œæœ‰çš„å’Œæ²¡æœ‰çš„ï¼Œå› æ­¤ï¼Œcaseé‡Œæœ‰çš„ï¼Œä¼šç»™å‡ºå…·ä½“çš„ç´¢å¼•å€¼ï¼›caseé‡Œæ²¡æœ‰çš„ï¼Œç»Ÿä¸€å¯¼å‘è·³è½¬è¡¨çš„æœ€åä¸€ä¸ªã€‚å†çœ‹ç´¢å¼•å€¼è¡¨ï¼š</p>
<p><img src="/../images/image-20250716001640839.png" alt="ç´¢å¼•å€¼è¡¨"></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œé‡Œé¢æšä¸¾äº†0åˆ°66å¯¹åº”çš„ç´¢å¼•å€¼ã€‚çœ‹æ±‡ç¼–ä»£ç ï¼Œæ˜¯å°†è¾“å…¥çš„å€¼ä½œä¸ºç´¢å¼•å€¼è¡¨çš„ç´¢å¼•æ¥ç”¨çš„ï¼Œç´¢å¼•å‡ºæ¥çš„å€¼å†ä½œä¸ºè·³è½¬è¡¨çš„ç´¢å¼•ã€‚æ³¨æ„çœ‹ï¼Œç´¢å¼•å€¼è¡¨çš„æœ€å°å€¼ä¸º0ï¼Œå› æ­¤ï¼Œè·³è½¬è¡¨å’Œæ•°ç»„ä¸€æ ·ä»0å¼€å§‹ç´¢å¼•ï¼Œè€Œ0-7å¯¹åº”è·³è½¬è¡¨çš„å…«ç§æƒ…å†µã€‚é€šè¿‡è¿›ä¸€æ­¥æŒ–æ˜ä¿¡æ¯ï¼Œè¿˜å¯ä»¥çŸ¥é“è·³è½¬è¡¨æ˜¯æŠŠcaseæŒ‰ç…§ä»å°åˆ°å¤§çš„é¡ºåºæ’åˆ—çš„ã€‚å› æ­¤ï¼Œæœ€å¼€å§‹ä¼šå¯¹è¾“å…¥å€¼æœ‰ä¸€ä¸ªå‡çš„æ“ä½œã€‚è‡³äºä¸ºä»€ä¹ˆå‡1ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ¨æµ‹æœ€å°çš„caseæ˜¯1äº†ï¼Œå› ä¸ºç´¢å¼•ä»0å¼€å§‹ï¼Œè€Œæœ€å°çš„caseåœ¨ç´¢å¼•0å¤„ã€‚</p>
</li>
<li><p>è¿™æ ·è§£é‡Šä¸‹æ¥å¯èƒ½è¿˜æœ‰ç‚¹ç»•ï¼Œæ‰€ä»¥æˆ‘ä»¬æŒ‰ç…§æœºå™¨çš„åŠ¨ä½œèµ°ä¸€éï¼š</p>
<p>é¦–å…ˆï¼ŒæŠŠcaseæŒ‰é¡ºåºæ’å‡ºè·³è½¬è¡¨ã€‚</p>
<p>ç„¶åï¼Œå‡è®¾æˆ‘ä»¬æ‹¿åˆ°è¾“å…¥çš„å€¼ã€‚ä½œä¸ºæœºå™¨ï¼Œæˆ‘ä»¬çŸ¥é“caseæœ‰ï¼š1ï¼Œ3ï¼Œ5ï¼Œ10ï¼Œ17ï¼Œ11ï¼Œ67ï¼Œæ‰€ä»¥å…ˆç»™è¾“å…¥çš„å€¼å‡1ï¼Œä»¥ä¾¿è¿™ä¸ªå€¼æ˜¯1çš„æ—¶å€™æˆ‘ä»¬å¯ä»¥ç´¢å¼•åˆ°è·³è½¬è¡¨ä¸‹æ ‡0å¤„ã€‚åŒæ—¶ï¼Œå¦‚æœè¿™ä¸ªå€¼å¤§äº66ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ç›´æ¥è·³è¿‡caseæ£€æŸ¥ï¼Œç›´æ¥å¯¼å‡ºå»ï¼ˆåˆšå¥½å’Œåœ¨caseæœ€å¤§æœ€å°å€¼èŒƒå›´å†…ä½†ä¸æ˜¯caseçš„å€¼ä¸€æ ·å¯¹å¾…ï¼‰</p>
<p>å†ç„¶åï¼Œæˆ‘ä»¬æšä¸¾0-66çš„å€¼ï¼Œå¹¶ä¸”æŠŠè¿™äº›å€¼å’Œcaseé‡Œæœ‰çš„å€¼ä¸€ä¸€æ¯”è¾ƒï¼Œåˆ†å‡ºä¸¤ç§å€¼ï¼šä¸€ç§åœ¨caseé‡Œï¼Œä¸€ç§ä¸å†caseé‡Œã€‚</p>
<p>okï¼Œç„¶åæˆ‘ä»¬å»ºç«‹ç´¢å¼•å€¼è¡¨ï¼Œç»™åœ¨caseé‡Œçš„æšä¸¾å€¼å¯¹åº”çš„è·³è½¬è¡¨ç´¢å¼•å€¼ï¼Œæ¯”å¦‚è¯´æšä¸¾å€¼2ï¼ˆè¾“å…¥å€¼æ˜¯3ï¼‰ï¼Œåˆšå¥½caseé‡Œæœ‰3ï¼ŒæŒ‰é¡ºåºæ’ç¬¬äºŒï¼Œæˆ‘ä»¬å°±ç»™ç´¢å¼•å€¼1ï¼ˆä»0å¼€å§‹ç´¢å¼•ï¼‰ã€‚å›å¤´çœ‹æˆªå‡ºæ¥çš„ç´¢å¼•å€¼è¡¨ï¼Œåœ¨ä¸‹æ ‡2çš„åœ°æ–¹åˆšå¥½æ˜¯1ï¼ˆæšä¸¾å€¼ç´¢å¼•å‡ºè·³è½¬è¡¨ç´¢å¼•ï¼‰ï¼›ç»™ä¸åœ¨caseé‡Œçš„å€¼ç´¢å¼•åˆ°7ï¼Œå¯¹åº”è·³è½¬è¡¨æœ€åä¸€ä½ï¼ˆä¸ºæ²¡åœ¨caseé‡Œçš„å€¼ä¸“é—¨å‡†å¤‡çš„é‚£ä¸€ä½ï¼‰ã€‚</p>
<p>æœ€åï¼Œæˆ‘ä»¬å°±å‡†å¤‡å¥½æˆ‘ä»¬çš„è§£å†³æ–¹æ¡ˆäº†ï¼Œå¯¹äºä»»æ„è¾“å…¥çš„å€¼æˆ‘ä»¬å°±éƒ½æœ‰å¯¹ç­–äº†ã€‚</p>
</li>
<li><p>è¯·åŠ¡å¿…çœŸæ­£ç†è§£ä¸Šè¿°å†…å®¹ï¼Œå› ä¸ºåœ¨é€†å‘å·¥ç¨‹ä¸­ï¼Œè¿™ä¹ˆç»•çš„æ“ä½œå¾ˆå¸¸è§ã€‚åœ¨PEæ–‡ä»¶ç»“æ„éƒ¨åˆ†ï¼Œæˆ‘ä»¬æˆ–è®¸è¿˜æœ‰æœºä¼šå†æ¥è§¦åˆ°è¿™ä¹ˆç»•çš„æ“ä½œã€‚ï¼ˆå…¶å®åªéœ€è¦å†™å‡ºç¨‹åºæ‹¿åˆ°idaé‡Œç‚¹å¼€è·³è½¬è¡¨å’Œç´¢å¼•å€¼è¡¨ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰çœ‹å‡ çœ¼å°±æ˜ç™½äº†ï¼Œäº²èº«å®è·µæ€»æ¯”é˜…è¯»æ–‡å­—æ¥çš„æœ‰æ•ˆï¼Œå› ä¸ºæ–‡å­—è¿˜å–å†³äºä¹¦å†™è€…çš„è¡¨è¾¾æ°´å¹³(â—â€™â—¡â€™â—)ï¼‰</p>
</li>
</ul>
<h2 id="å¾ªç¯è¯­å¥è¯†åˆ«"><a href="#å¾ªç¯è¯­å¥è¯†åˆ«" class="headerlink" title="å¾ªç¯è¯­å¥è¯†åˆ«"></a>å¾ªç¯è¯­å¥è¯†åˆ«</h2><ul>
<li><p>ç¬¬ä¸€ç§ï¼Œforå¾ªç¯</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm"><span class="hljs-symbol">.text:</span><span class="hljs-number">00464096</span>                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_8], <span class="hljs-number">0</span>  <span class="hljs-comment">; ä¸€ä¸ªå˜é‡åˆå§‹åŒ–ä¸º0</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0046409D</span>                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_14], <span class="hljs-number">1</span> <span class="hljs-comment">; å¦ä¸€ä¸ªå˜é‡åˆå§‹åŒ–ä¸º1</span><br><span class="hljs-symbol">.text:</span>004640A4                 <span class="hljs-keyword">jmp</span>     short loc_4640AF<br><span class="hljs-symbol">.text:</span>004640A6 <span class="hljs-comment">; ---------------------------------------------------------------------------</span><br><span class="hljs-symbol">.text:</span>004640A6<br><span class="hljs-symbol">.text:</span>004640A6 loc_4640A6:                             <span class="hljs-comment">; CODE XREF: sub_464070+4Eâ†“j</span><br><span class="hljs-symbol">.text:</span>004640A6                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_14]<br><span class="hljs-symbol">.text:</span>004640A9                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">1</span>          <span class="hljs-comment">; ç”¨eaxè¿‡æ¸¡ï¼Œç»™[ebp+var_14]åŠ 1</span><br><span class="hljs-symbol">.text:</span>004640AC                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_14], <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>004640AF<br><span class="hljs-symbol">.text:</span>004640AF loc_4640AF:                             <span class="hljs-comment">; CODE XREF: sub_464070+34â†‘j</span><br><span class="hljs-symbol">.text:</span>004640AF                 <span class="hljs-keyword">cmp</span>     [<span class="hljs-built_in">ebp</span>+var_14], <span class="hljs-number">0Ah</span><br><span class="hljs-symbol">.text:</span>004640B3                 <span class="hljs-keyword">jg</span>      short loc_4640C0 <span class="hljs-comment">; [ebp+var_14]å¤§äº0Ahæ—¶è·³è½¬ï¼ˆå‡ºå¾ªç¯ï¼‰</span><br><span class="hljs-symbol">.text:</span>004640B5                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_8]<br><span class="hljs-symbol">.text:</span>004640B8                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_14] <span class="hljs-comment">; ç”¨eaxè¿‡æ¸¡ï¼ŒæŠŠ[ebp+var_14]çš„å€¼åŠ åˆ°[ebp+var_8]ä¸Š</span><br><span class="hljs-symbol">.text:</span>004640BB                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_8], <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>004640BE                 <span class="hljs-keyword">jmp</span>     short loc_4640A6 <span class="hljs-comment">; è·³å›å»ï¼Œå½¢æˆå¾ªç¯</span><br><span class="hljs-symbol">.text:</span>004640C0 <span class="hljs-comment">; ---------------------------------------------------------------------------</span><br><span class="hljs-symbol">.text:</span>004640C0<br><span class="hljs-symbol">.text:</span>004640C0 loc_4640C0:                             <span class="hljs-comment">; CODE XREF: sub_464070+43â†‘j</span><br><span class="hljs-symbol">.text:</span>004640C0                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_8]<br><span class="hljs-symbol">.text:</span>004640C3                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>004640C4                 <span class="hljs-keyword">push</span>    offset aCountD  <span class="hljs-comment">; &quot;count : %d &quot;</span><br><span class="hljs-symbol">.text:</span>004640C9                 <span class="hljs-keyword">call</span>    sub_45DB54      <span class="hljs-comment">; printf</span><br><span class="hljs-symbol">.text:</span>004640CE                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">8</span><br></code></pre></td></tr></table></figure>

<p>æºç </p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> count = <span class="hljs-number">0</span>;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">10</span>; i++) &#123;<br>	count += i;<br>&#125;<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;count : %d &quot;</span>, count);<br></code></pre></td></tr></table></figure>
</li>
<li><p>ç¬¬äºŒç§ï¼Œwhileå¾ªç¯</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm"><span class="hljs-symbol">.text:</span>004640D1                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_8], <span class="hljs-number">0</span>  <span class="hljs-comment">; ä¸€ä¸ªå˜é‡åˆå§‹åŒ–ä¸º0</span><br><span class="hljs-symbol">.text:</span>004640D8                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_20], <span class="hljs-number">0Ah</span> <span class="hljs-comment">; å¦ä¸€ä¸ªå˜é‡åˆå§‹åŒ–ä¸º10</span><br><span class="hljs-symbol">.text:</span>004640DF<br><span class="hljs-symbol">.text:</span>004640DF loc_4640DF:                             <span class="hljs-comment">; CODE XREF: sub_464070+87â†“j</span><br><span class="hljs-symbol">.text:</span>004640DF                 <span class="hljs-keyword">cmp</span>     [<span class="hljs-built_in">ebp</span>+var_20], <span class="hljs-number">0</span><br><span class="hljs-symbol">.text:</span>004640E3                 <span class="hljs-keyword">jle</span>     short loc_4640F9 <span class="hljs-comment">; [ebp+var_20]å°äºç­‰äº0æ—¶è·³è½¬ï¼ˆå‡ºå¾ªç¯ï¼‰</span><br><span class="hljs-symbol">.text:</span>004640E5                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_8]<br><span class="hljs-symbol">.text:</span>004640E8                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_20] <span class="hljs-comment">; eaxè¿‡æ¸¡ï¼ŒæŠŠ[ebp+var_20]å€¼åŠ åˆ°[ebp+var_8]ä¸Š</span><br><span class="hljs-symbol">.text:</span>004640EB                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_8], <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>004640EE                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_20]<br><span class="hljs-symbol">.text:</span>004640F1                 <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">1</span>          <span class="hljs-comment">; eaxè¿‡æ¸¡ï¼Œç»™[ebp+var_20]å‡1</span><br><span class="hljs-symbol">.text:</span>004640F4                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_20], <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>004640F7                 <span class="hljs-keyword">jmp</span>     short loc_4640DF <span class="hljs-comment">; å›è·³ï¼Œå½¢æˆå¾ªç¯</span><br><span class="hljs-symbol">.text:</span>004640F9 <span class="hljs-comment">; ---------------------------------------------------------------------------</span><br><span class="hljs-symbol">.text:</span>004640F9<br><span class="hljs-symbol">.text:</span>004640F9 loc_4640F9:                             <span class="hljs-comment">; CODE XREF: sub_464070+73â†‘j</span><br><span class="hljs-symbol">.text:</span>004640F9                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_8]<br><span class="hljs-symbol">.text:</span>004640FC                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>004640FD                 <span class="hljs-keyword">push</span>    offset aCountD  <span class="hljs-comment">; &quot;count : %d &quot;</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464102</span>                 <span class="hljs-keyword">call</span>    sub_45DB54      <span class="hljs-comment">; printf</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464107</span>                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">8</span><br></code></pre></td></tr></table></figure>

<p>æºç </p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> count = <span class="hljs-number">0</span>;<br><span class="hljs-type">int</span> n = <span class="hljs-number">10</span>;<br><span class="hljs-keyword">while</span> (n &gt; <span class="hljs-number">0</span>) &#123;<br>	count += n;<br>	n--;<br>&#125;<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;count : %d &quot;</span>, count);<br></code></pre></td></tr></table></figure>
</li>
<li><p>ç¬¬ä¸‰ç§ï¼Œdo-whileå¾ªç¯</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm"><span class="hljs-symbol">.text:</span>0046410A                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_8], <span class="hljs-number">0</span>  <span class="hljs-comment">; ä¸€ä¸ªå˜é‡åˆå§‹åŒ–ä¸º0</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464111</span>                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_2C], <span class="hljs-number">0Ah</span> <span class="hljs-comment">; å¦ä¸€ä¸ªå˜é‡åˆå§‹åŒ–ä¸º10</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464118</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464118</span> loc_464118:                             <span class="hljs-comment">; CODE XREF: sub_464070+BEâ†“j</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464118</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_8]<br><span class="hljs-symbol">.text:</span>0046411B                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_2C] <span class="hljs-comment">; eaxè¿‡æ¸¡ï¼ŒæŠŠ[ebp+var_2C]å€¼åŠ åˆ°[ebp+var_8]ä¸Š</span><br><span class="hljs-symbol">.text:</span>0046411E                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_8], <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464121</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_2C]<br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464124</span>                 <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">1</span>          <span class="hljs-comment">; eaxè¿‡æ¸¡ï¼Œç»™[ebp+var_2C]å‡1</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464127</span>                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_2C], <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>0046412A                 <span class="hljs-keyword">cmp</span>     [<span class="hljs-built_in">ebp</span>+var_2C], <span class="hljs-number">0</span><br><span class="hljs-symbol">.text:</span>0046412E                 <span class="hljs-keyword">jg</span>      short loc_464118 <span class="hljs-comment">; [ebp+var_2C]å¤§äº0æ—¶å›è·³</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464130</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_8]<br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464133</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464134</span>                 <span class="hljs-keyword">push</span>    offset aCountD  <span class="hljs-comment">; &quot;count : %d &quot;</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464139</span>                 <span class="hljs-keyword">call</span>    sub_45DB54      <span class="hljs-comment">; printf</span><br><span class="hljs-symbol">.text:</span>0046413E                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">8</span><br></code></pre></td></tr></table></figure>

<p>æºç </p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> count = <span class="hljs-number">0</span>;<br><span class="hljs-type">int</span> i = <span class="hljs-number">10</span>;<br><span class="hljs-keyword">do</span> &#123;<br>	count += i;<br>	i--;<br>&#125; <span class="hljs-keyword">while</span> (i &gt; <span class="hljs-number">0</span>);<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;count : %d &quot;</span>, count);<br></code></pre></td></tr></table></figure></li>
</ul>
]]></content>
      <categories>
        <category>Reverseå­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>Reverse</tag>
      </tags>
  </entry>
  <entry>
    <title>Day7:æ•°ç»„ä¸æŒ‡é’ˆè¯†åˆ«</title>
    <url>/2025/07/17/Day7-%E6%95%B0%E7%BB%84%E4%B8%8E%E6%8C%87%E9%92%88%E8%AF%86%E5%88%AB/</url>
    <content><![CDATA[<p>æ•°ç»„ä¸æŒ‡é’ˆè¯†åˆ«</p>
<span id="more"></span>

<h2 id="æ•°ç»„ä¸æŒ‡é’ˆè¯†åˆ«"><a href="#æ•°ç»„ä¸æŒ‡é’ˆè¯†åˆ«" class="headerlink" title="æ•°ç»„ä¸æŒ‡é’ˆè¯†åˆ«"></a>æ•°ç»„ä¸æŒ‡é’ˆè¯†åˆ«</h2><ul>
<li><p>æ•´å‹ä¸€ç»´æ•°ç»„</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm"><span class="hljs-symbol">.text:</span><span class="hljs-number">00464260</span>                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_14], <span class="hljs-number">1</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464267</span>                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_10], <span class="hljs-number">2</span><br><span class="hljs-symbol">.text:</span>0046426E                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_C], <span class="hljs-number">3</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464275</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_14] <span class="hljs-comment">; æ•°ç»„é¦–åœ°å€</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464278</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span>             <span class="hljs-comment">; ä¼ å‚</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464279</span>                 <span class="hljs-keyword">call</span>    sub_45D447<br><span class="hljs-symbol">.text:</span>0046427E                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">4</span><br><br><span class="hljs-comment">;sub_45D447</span><br><span class="hljs-symbol">.text:</span>004640D0 arg_0           = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span>  <span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span>004640D0<br><span class="hljs-symbol">.text:</span>004640D0                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span>004640D1                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">esp</span><br><span class="hljs-symbol">.text:</span>004640D3                 <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0C0h</span><br><span class="hljs-symbol">.text:</span>004640D9                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ebx</span><br><span class="hljs-symbol">.text:</span>004640DA                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">esi</span><br><span class="hljs-symbol">.text:</span>004640<span class="hljs-built_in">DB</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">edi</span><br><span class="hljs-symbol">.text:</span>004640DC                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">edi</span>, <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span>004640DE                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-built_in">ecx</span><br><span class="hljs-symbol">.text:</span>004640E0                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">0CCCCCCCCh</span><br><span class="hljs-symbol">.text:</span>004640E5                 <span class="hljs-keyword">rep</span> <span class="hljs-keyword">stosd</span><br><span class="hljs-symbol">.text:</span>004640E7                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, offset unk_54D014<br><span class="hljs-symbol">.text:</span>004640EC                 <span class="hljs-keyword">call</span>    sub_45FF35<br><span class="hljs-symbol">.text:</span>004640F1                 <span class="hljs-keyword">nop</span><br><span class="hljs-symbol">.text:</span>004640F2                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">4</span><br><span class="hljs-symbol">.text:</span>004640F7                 <span class="hljs-keyword">shl</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">1</span>          <span class="hljs-comment">; eax=4*2^1=8</span><br><span class="hljs-symbol">.text:</span>004640F9                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, [<span class="hljs-built_in">ebp</span>+arg_0] <span class="hljs-comment">; [ebp+arg_0]æ˜¯ä¼ å…¥çš„å‚æ•°ï¼Œå³æ•°ç»„é¦–åœ°å€</span><br><span class="hljs-symbol">.text:</span>004640FC                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">edx</span>, [<span class="hljs-built_in">ecx</span>+<span class="hljs-built_in">eax</span>]  <span class="hljs-comment">; [ecx+eax]å³[ebp+arg_0+eax]ï¼Œå³[ebp+10h]</span><br><span class="hljs-symbol">.text:</span>004640FF                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">edx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464100</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">4</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464105</span>                 <span class="hljs-keyword">shl</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">0</span>          <span class="hljs-comment">; eax=4*2^0=4</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464108</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, [<span class="hljs-built_in">ebp</span>+arg_0]<br><span class="hljs-symbol">.text:</span>0046410B                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">edx</span>, [<span class="hljs-built_in">ecx</span>+<span class="hljs-built_in">eax</span>]  <span class="hljs-comment">; å³[ebp+0Ch]</span><br><span class="hljs-symbol">.text:</span>0046410E                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">edx</span><br><span class="hljs-symbol">.text:</span>0046410F                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">4</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464114</span>                 <span class="hljs-keyword">imul</span>    <span class="hljs-built_in">ecx</span>, <span class="hljs-built_in">eax</span>, <span class="hljs-number">0</span>     <span class="hljs-comment">; ecx=4*0=0</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464117</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">edx</span>, [<span class="hljs-built_in">ebp</span>+arg_0]<br><span class="hljs-symbol">.text:</span>0046411A                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">edx</span>+<span class="hljs-built_in">ecx</span>]  <span class="hljs-comment">; å³[ebp+8]ï¼Œå³[ebp+arg_0]ï¼Œæ•°ç»„é¦–ä½</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0046411D</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>0046411E                 <span class="hljs-keyword">push</span>    offset aDDD     <span class="hljs-comment">; &quot;%d %d %d&quot;</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464123</span>                 <span class="hljs-keyword">call</span>    sub_45DB5E      <span class="hljs-comment">; printf</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464128</span>                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">10h</span><br><span class="hljs-symbol">.text:</span>0046412B                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">edi</span><br><span class="hljs-symbol">.text:</span>0046412C                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">esi</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0046412D</span>                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ebx</span><br><span class="hljs-symbol">.text:</span>0046412E                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0C0h</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464134</span>                 <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">esp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464136</span>                 <span class="hljs-keyword">call</span>    sub_45F17F<br><span class="hljs-symbol">.text:</span>0046413B                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0046413D</span>                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span>0046413E                 <span class="hljs-keyword">retn</span><br></code></pre></td></tr></table></figure>

<p>æºç </p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-type">void</span> <span class="hljs-title function_">IntShow</span><span class="hljs-params">(<span class="hljs-type">int</span>* n)</span> &#123;<br>	<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d %d %d&quot;</span>, n[<span class="hljs-number">0</span>], n[<span class="hljs-number">1</span>], n[<span class="hljs-number">2</span>]);<br>&#125;<br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;<br>    <span class="hljs-type">int</span> arr[<span class="hljs-number">3</span>] = &#123; <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span> &#125;;<br>	IntShow(arr);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>å­—ç¬¦å‹ä¸€ç»´æ•°ç»„</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm"><span class="hljs-symbol">.text:</span><span class="hljs-number">00464281</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">ds</span>:dword_520E60 <span class="hljs-comment">; &#x27;lleh&#x27;</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464286</span>                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_24], <span class="hljs-built_in">eax</span> <span class="hljs-comment">; ç”¨eaxè¿‡æ¸¡ï¼Œä¼ ç»™å±€éƒ¨å˜é‡</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464289</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">cx</span>, <span class="hljs-built_in">ds</span>:word_520E64 <span class="hljs-comment">; &#x27;o&#x27;</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464290</span>                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_20], <span class="hljs-built_in">cx</span> <span class="hljs-comment">; ç”¨cxè¿‡æ¸¡ï¼Œä¼ ç»™å±€éƒ¨å˜é‡</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464294</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_24]<br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464297</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span>             <span class="hljs-comment">; å‰åŠæ®µçš„åœ°å€å…¥æ ˆ</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464298</span>                 <span class="hljs-keyword">call</span>    sub_45E3AB<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0046429D</span>                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">4</span><br><br><span class="hljs-comment">;sub_45E3AB</span><br><span class="hljs-symbol">.text:</span>00463FC0 arg_0           = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span>  <span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span>00463FC0<br><span class="hljs-symbol">.text:</span>00463FC0                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span>00463FC1                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">esp</span><br><span class="hljs-symbol">.text:</span>00463FC3                 <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0C0h</span><br><span class="hljs-symbol">.text:</span>00463FC9                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ebx</span><br><span class="hljs-symbol">.text:</span>00463FCA                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">esi</span><br><span class="hljs-symbol">.text:</span>00463FCB                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">edi</span><br><span class="hljs-symbol">.text:</span>00463FCC                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">edi</span>, <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span>00463FCE                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-built_in">ecx</span><br><span class="hljs-symbol">.text:</span>00463FD0                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">0CCCCCCCCh</span><br><span class="hljs-symbol">.text:</span>00463FD5                 <span class="hljs-keyword">rep</span> <span class="hljs-keyword">stosd</span><br><span class="hljs-symbol">.text:</span>00463FD7                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, offset unk_54D014<br><span class="hljs-symbol">.text:</span>00463FDC                 <span class="hljs-keyword">call</span>    sub_45FF35<br><span class="hljs-symbol">.text:</span>00463FE1                 <span class="hljs-keyword">nop</span><br><span class="hljs-symbol">.text:</span>00463FE2                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+arg_0] <span class="hljs-comment">; å‚æ•°ä¼ ç»™eax</span><br><span class="hljs-symbol">.text:</span>00463FE5                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>00463FE6                 <span class="hljs-keyword">push</span>    offset aS       <span class="hljs-comment">; &quot;%s&quot;</span><br><span class="hljs-symbol">.text:</span>00463FEB                 <span class="hljs-keyword">call</span>    sub_45DB5E      <span class="hljs-comment">; printf</span><br><span class="hljs-symbol">.text:</span>00463FF0                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span>00463FF3                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">edi</span><br><span class="hljs-symbol">.text:</span>00463FF4                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">esi</span><br><span class="hljs-symbol">.text:</span>00463FF5                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ebx</span><br><span class="hljs-symbol">.text:</span>00463FF6                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0C0h</span><br><span class="hljs-symbol">.text:</span>00463FFC                 <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">esp</span><br><span class="hljs-symbol">.text:</span>00463FFE                 <span class="hljs-keyword">call</span>    sub_45F17F<br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464003</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464005</span>                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464006</span>                 <span class="hljs-keyword">retn</span><br></code></pre></td></tr></table></figure>

<p>æºç </p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-type">void</span> <span class="hljs-title function_">CharShow</span><span class="hljs-params">(<span class="hljs-type">char</span>* n)</span> &#123;<br>	<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s&quot;</span>, n);<br>&#125;<br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;<br>    <span class="hljs-type">char</span> buf[] = &#123; <span class="hljs-string">&quot;hello&quot;</span> &#125;;<br>	CharShow(buf);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>æ•°ç»„ä½œä¸ºè¿”å›å€¼</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm"><span class="hljs-symbol">.text:</span>004642C3                 <span class="hljs-keyword">call</span>    sub_45FC79<br><span class="hljs-symbol">.text:</span>004642C8                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_40], <span class="hljs-built_in">eax</span> <span class="hljs-comment">; ä»è¿”å›å€¼ä¸­å–å‡ºä¼ åˆ°å±€éƒ¨å˜é‡</span><br><span class="hljs-symbol">.text:</span>004642CB                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_40] <span class="hljs-comment">; æ”¾å…¥å¯„å­˜å™¨ä¸­pushä½œä¸ºå‚æ•°</span><br><span class="hljs-symbol">.text:</span>004642CE                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>004642CF                 <span class="hljs-keyword">push</span>    offset aS       <span class="hljs-comment">; &quot;%s&quot;</span><br><span class="hljs-symbol">.text:</span>004642D4                 <span class="hljs-keyword">call</span>    sub_45DB59      <span class="hljs-comment">; printf</span><br><span class="hljs-symbol">.text:</span>004642D9                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">8</span><br><br><span class="hljs-comment">;sub_45FC79</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464020</span> var_14          = <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">14h</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464020</span> var_10          = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">10h</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464020</span> var_C           = <span class="hljs-built_in">word</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">0Ch</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464020</span> var_A           = <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">0Ah</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464020</span> var_4           = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">4</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464020</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464020</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464021</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">esp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464023</span>                 <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0D4h</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464029</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ebx</span><br><span class="hljs-symbol">.text:</span>0046402A                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">esi</span><br><span class="hljs-symbol">.text:</span>0046402B                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">edi</span><br><span class="hljs-symbol">.text:</span>0046402C                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">edi</span>, [<span class="hljs-built_in">ebp</span>+var_14]<br><span class="hljs-symbol">.text:</span>0046402F                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-number">5</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464034</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">0CCCCCCCCh</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464039</span>                 <span class="hljs-keyword">rep</span> <span class="hljs-keyword">stosd</span><br><span class="hljs-symbol">.text:</span>0046403B                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, ___security_cookie<br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464040</span>                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464042</span>                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_4], <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464045</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, offset unk_54E014<br><span class="hljs-symbol">.text:</span>0046404A                 <span class="hljs-keyword">call</span>    sub_45FF35<br><span class="hljs-symbol">.text:</span>0046404F                 <span class="hljs-keyword">nop</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464050</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">ds</span>:dword_521E60 <span class="hljs-comment">; &#x27;oviv&#x27;</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464055</span>                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_10], <span class="hljs-built_in">eax</span> <span class="hljs-comment">; eaxè¿‡æ¸¡ï¼Œä¼ ç»™å±€éƒ¨å˜é‡</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464058</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">cx</span>, <span class="hljs-built_in">ds</span>:word_521E64 <span class="hljs-comment">; &#x27;05&#x27;</span><br><span class="hljs-symbol">.text:</span>0046405F                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_C], <span class="hljs-built_in">cx</span> <span class="hljs-comment">; cxè¿‡æ¸¡ï¼Œä¼ ç»™å±€éƒ¨å˜é‡</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464063</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">dl</span>, <span class="hljs-built_in">ds</span>:byte_521E66<br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464069</span>                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_A], <span class="hljs-built_in">dl</span><br><span class="hljs-symbol">.text:</span>0046406C                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_10] <span class="hljs-comment">; å‰åŠæ®µç»™eaxï¼Œä½œä¸ºè¿”å›å€¼ä¼ é€’</span><br><span class="hljs-symbol">.text:</span>0046406F                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">edx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464070</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464072</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464073</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">edx</span>, dword_4640A0<br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464079</span>                 <span class="hljs-keyword">call</span>    sub_45EC52<br><span class="hljs-symbol">.text:</span>0046407E                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>0046407F                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">edx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464080</span>                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">edi</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464081</span>                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">esi</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464082</span>                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ebx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464083</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, [<span class="hljs-built_in">ebp</span>+var_4]<br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464086</span>                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-built_in">ebp</span>        <span class="hljs-comment">; StackCookie</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464088</span>                 <span class="hljs-keyword">call</span>    j_@__security_check_cookie@<span class="hljs-number">4</span> <span class="hljs-comment">; __security_check_cookie(x)</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0046408D</span>                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0D4h</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464093</span>                 <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">esp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464095</span>                 <span class="hljs-keyword">call</span>    sub_45F17A<br><span class="hljs-symbol">.text:</span>0046409A                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span>0046409C                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0046409D</span>                 <span class="hljs-keyword">retn</span><br></code></pre></td></tr></table></figure>

<p>æºç </p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-type">char</span>* <span class="hljs-title function_">CrZT</span><span class="hljs-params">()</span> &#123;<br>	<span class="hljs-type">char</span> temp[<span class="hljs-number">7</span>] = <span class="hljs-string">&quot;vivo50&quot;</span>;<br>	<span class="hljs-keyword">return</span> temp;<br>&#125;<br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;<br>    <span class="hljs-type">char</span>* p = CrZT();<br>	<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s&quot;</span>, p);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>æ•´å½¢äºŒç»´æ•°ç»„ï¼ˆå’Œä¸€ç»´æ•°ç»„æ²¡æœ‰æœ¬è´¨ä¸Šçš„åŒºåˆ«ï¼Œéƒ½æ˜¯å ç”¨ä¸€æ®µè¿ç»­çš„å†…å­˜ç©ºé—´ï¼‰</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm"><span class="hljs-symbol">.text:</span>004642DC                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_58], <span class="hljs-number">1</span><br><span class="hljs-symbol">.text:</span>004642E3                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_54], <span class="hljs-number">2</span><br><span class="hljs-symbol">.text:</span>004642EA                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_50], <span class="hljs-number">3</span><br><span class="hljs-symbol">.text:</span>004642F1                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_4C], <span class="hljs-number">4</span><br><span class="hljs-symbol">.text:</span>004642F8                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span>004642FD                 <span class="hljs-keyword">shl</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">0</span>          <span class="hljs-comment">; eax=8*2^0=8</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464300</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">ecx</span>, [<span class="hljs-built_in">ebp</span>+<span class="hljs-built_in">eax</span>+var_58] <span class="hljs-comment">; å³[ebp+var_58+8]ï¼Œå³[ebp+var_50]</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464304</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">edx</span>, <span class="hljs-number">4</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464309</span>                 <span class="hljs-keyword">shl</span>     <span class="hljs-built_in">edx</span>, <span class="hljs-number">0</span>          <span class="hljs-comment">; edx=4*2^0=4</span><br><span class="hljs-symbol">.text:</span>0046430C                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ecx</span>+<span class="hljs-built_in">edx</span>]  <span class="hljs-comment">; å³[ebp+var_58+0Ch]ï¼Œå³[ebp+var_4C]</span><br><span class="hljs-symbol">.text:</span>0046430F                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464310</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464315</span>                 <span class="hljs-keyword">shl</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-number">0</span>          <span class="hljs-comment">; ecx=8*2^0=8</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464318</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">edx</span>, [<span class="hljs-built_in">ebp</span>+<span class="hljs-built_in">ecx</span>+var_58] <span class="hljs-comment">; å³[ebp+var_58+8]ï¼Œå³[ebp+var_50]</span><br><span class="hljs-symbol">.text:</span>0046431C                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">4</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464321</span>                 <span class="hljs-keyword">imul</span>    <span class="hljs-built_in">ecx</span>, <span class="hljs-built_in">eax</span>, <span class="hljs-number">0</span>     <span class="hljs-comment">; ecx=0</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464324</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">edx</span>, [<span class="hljs-built_in">edx</span>+<span class="hljs-built_in">ecx</span>]  <span class="hljs-comment">; å³[ebp+var_50]</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464327</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">edx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464328</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0046432D</span>                 <span class="hljs-keyword">imul</span>    <span class="hljs-built_in">ecx</span>, <span class="hljs-built_in">eax</span>, <span class="hljs-number">0</span>     <span class="hljs-comment">; ecx=8*0=0</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464330</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">edx</span>, [<span class="hljs-built_in">ebp</span>+<span class="hljs-built_in">ecx</span>+var_58] <span class="hljs-comment">; å³[ebp+var_58]</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464334</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">4</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464339</span>                 <span class="hljs-keyword">shl</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">0</span>          <span class="hljs-comment">; eax=4*2^0=4</span><br><span class="hljs-symbol">.text:</span>0046433C                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, [<span class="hljs-built_in">edx</span>+<span class="hljs-built_in">eax</span>]  <span class="hljs-comment">; å³[ebp+var_54]</span><br><span class="hljs-symbol">.text:</span>0046433F                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ecx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464340</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">edx</span>, <span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464345</span>                 <span class="hljs-keyword">imul</span>    <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">edx</span>, <span class="hljs-number">0</span>     <span class="hljs-comment">; eax=8*0=0</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464348</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">ecx</span>, [<span class="hljs-built_in">ebp</span>+<span class="hljs-built_in">eax</span>+var_58] <span class="hljs-comment">; å³[ebp+var_58]</span><br><span class="hljs-symbol">.text:</span>0046434C                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">edx</span>, <span class="hljs-number">4</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464351</span>                 <span class="hljs-keyword">imul</span>    <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">edx</span>, <span class="hljs-number">0</span>     <span class="hljs-comment">; ecx=4*0=0</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464354</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, [<span class="hljs-built_in">ecx</span>+<span class="hljs-built_in">eax</span>]  <span class="hljs-comment">; å³[ebp+var_58]</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464357</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ecx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464358</span>                 <span class="hljs-keyword">push</span>    offset aDDDD    <span class="hljs-comment">; &quot;%d,%d,%d,%d&quot;</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0046435D</span>                 <span class="hljs-keyword">call</span>    sub_45DB59      <span class="hljs-comment">; printf</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464362</span>                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">14h</span><br></code></pre></td></tr></table></figure>

<p>æºç </p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> num[<span class="hljs-number">2</span>][<span class="hljs-number">2</span>] = &#123; &#123;<span class="hljs-number">1</span>,<span class="hljs-number">2</span>&#125;,&#123;<span class="hljs-number">3</span>,<span class="hljs-number">4</span>&#125; &#125;;<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d,%d,%d,%d&quot;</span>, num[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>], num[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>], num[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>], num[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>]);<br></code></pre></td></tr></table></figure></li>
</ul>
]]></content>
      <categories>
        <category>Reverseå­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>Reverse</tag>
      </tags>
  </entry>
  <entry>
    <title>Day9:å£³ä¸è„±å£³ï¼ˆä¸€ï¼‰</title>
    <url>/2025/07/29/Day9-%E5%A3%B3%E4%B8%8E%E8%84%B1%E5%A3%B3%EF%BC%88%E4%B8%80%EF%BC%89/</url>
    <content><![CDATA[<p>å£³ã€å£³çš„åŠ è½½è¿‡ç¨‹ã€å·¥å…·è„±å£³ã€æ‰‹åŠ¨è„±å£³æµç¨‹ã€espå®šå¾‹ï¼ˆåŸºäºXdbgï¼‰</p>
<span id="more"></span>

<h2 id="å£³"><a href="#å£³" class="headerlink" title="å£³"></a>å£³</h2><ul>
<li><p>å…ˆçœ‹ctf-wikiå¯¹å£³çš„ä»‹ç»ï¼š</p>
<p><strong>å£³</strong> æ˜¯åœ¨ä¸€äº›è®¡ç®—æœºè½¯ä»¶é‡Œä¸€æ®µä¸“é—¨è´Ÿè´£ä¿æŠ¤è½¯ä»¶ä¸è¢«éæ³•ä¿®æ”¹æˆ–åç¼–è¯‘çš„ç¨‹åºã€‚</p>
<p>å®ƒä»¬ä¸€èˆ¬éƒ½æ˜¯å…ˆäºç¨‹åºè¿è¡Œï¼Œæ‹¿åˆ°æ§åˆ¶æƒï¼Œç„¶åå®Œæˆå®ƒä»¬ä¿æŠ¤è½¯ä»¶çš„ä»»åŠ¡ã€‚</p>
</li>
<li><p>å› æ­¤ï¼ŒåŠ å£³ç¨‹åºåŒ…å«å£³ç¨‹åºå’ŒåŸç¨‹åºä¸¤ä¸ªéƒ¨åˆ†ï¼Œä¸”åŸç¨‹åºåœ¨å£³ç¨‹åºè¿è¡Œåæ‰æ¢å¤åˆ°ç‹¬ç«‹å¯æ‰§è¡Œçš„çŠ¶æ€ã€‚å› æ­¤ï¼Œå¯ä»¥å€ŸåŠ©åŠ¨æ€è°ƒè¯•å™¨åœ¨å£³ç¨‹åºè¿è¡Œå®Œåè¿›è¡Œdumpï¼Œä»è€Œè·å¾—ç‹¬ç«‹å¯æ‰§è¡Œçš„åŸç¨‹åº</p>
</li>
<li><p>å¸¸è§çš„å£³æœ‰å‹ç¼©å£³å’ŒåŠ å¯†å£³ä¸¤ç§ï¼š</p>
<p>å‹ç¼©å£³ï¼šupxã€ASpackã€PECompatç­‰</p>
<p>åŠ å¯†å£³ï¼šVMProtectã€Themidaã€ASProtectorç­‰</p>
</li>
</ul>
<h2 id="å£³çš„åŠ è½½è¿‡ç¨‹"><a href="#å£³çš„åŠ è½½è¿‡ç¨‹" class="headerlink" title="å£³çš„åŠ è½½è¿‡ç¨‹"></a>å£³çš„åŠ è½½è¿‡ç¨‹</h2><ul>
<li>å£³å’ŒåŸç¨‹åºåœ¨é€»è¾‘ä¸ŠåŸºæœ¬æ²¡æœ‰å…³è”ï¼Œå› æ­¤ï¼Œå£³ç¨‹åºåœ¨è§£æåŠ å£³åçš„äºŒè¿›åˆ¶æ–‡ä»¶å‰ï¼Œä¼šå…ˆä¿å­˜å„å¯„å­˜å™¨çš„å€¼ï¼Œé€šå¸¸ç”¨pushad&#x2F;puahfdå®ç°</li>
<li>è§£æå®Œæˆåï¼Œæ˜¯åŸç¨‹åºçš„é€»è¾‘éƒ¨åˆ†ï¼Œæ­¤æ—¶ï¼Œå£³ç¨‹åºç»™å‡ºæ§åˆ¶æƒï¼Œå¯„å­˜å™¨æ¢å¤åˆ°è§£æå‰çš„çŠ¶æ€ï¼Œé€šå¸¸ç”¨popad&#x2F;popfdå®ç°</li>
<li>æœ€åï¼Œç¨‹åºè·³åˆ°åŸç¨‹åºå…¥å£ç‚¹å¼€å§‹æ‰§è¡Œ</li>
</ul>
<h2 id="å·¥å…·è„±å£³"><a href="#å·¥å…·è„±å£³" class="headerlink" title="å·¥å…·è„±å£³"></a>å·¥å…·è„±å£³</h2><ul>
<li><p>ç›´æ¥ä½¿ç”¨å·¥å…·è„±å£³çš„æƒ…å†µä¸»è¦æœ‰ä¸¤ç§ï¼šä¸€ç§æ˜¯æ— ä¿®æ”¹çš„ã€åªä½¿ç”¨åŠ å£³ç¨‹åºåŠ å£³ï¼›å¦ä¸€ç§æ˜¯ä½¿ç”¨åŠ å£³ç¨‹åºåŠ å£³åä¿®æ”¹äº†åŒºå—åçš„ã€‚å‰è€…å¯ä»¥ç›´æ¥ä½¿ç”¨åŠ å£³ç¨‹åºè„±å£³ï¼ˆå¦‚æœå…·å¤‡è„±å£³åŠŸèƒ½çš„è¯ï¼‰ï¼Œåè€…å…ˆä¿®æ”¹åŒºå—åå†ä½¿ç”¨åŠ å£³ç¨‹åºè„±å£³ã€‚</p>
</li>
<li><p>upxæ— ä¿®æ”¹åŠ å£³ç¤ºä¾‹ï¼š</p>
<p>æ‹¿åˆ°å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå…ˆåˆ°DIEæŸ¥çœ‹ï¼Œå‘ç°æœ‰å£³ã€‚å¯¹å£³çš„ä¿¡æ¯æè¿°æ²¡æœ‰å‡ºç°â€œmodifiedâ€å­—çœ¼ï¼Œå› æ­¤åˆ¤æ–­æ˜¯æ— ä¿®æ”¹åŠ å£³ï¼Œç›´æ¥ä½¿ç”¨å·¥å…·è„±å£³</p>
<p><img src="/../images/image-20250729103439484.png" alt="æŸ¥çœ‹å£³ä¿¡æ¯"></p>
<p>ç›´æ¥ä½¿ç”¨upx -dè„±å£³</p>
<p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-07-29%20103724.png" alt="upx-dè„±å£³"></p>
<p>å†æ¬¡ç”¨DIEæ‰“å¼€ï¼Œå‘ç°æ²¡æœ‰è¯†åˆ«å‡ºå£³äº†</p>
<p><img src="/../images/image-20250729104311684.png" alt="è„±å£³åæŸ¥çœ‹å£³ä¿¡æ¯"></p>
</li>
<li><p>upxä¿®æ”¹åŒºå—ååŠ å£³ç¤ºä¾‹ï¼š</p>
<p>å…ˆåˆ°DIEæŸ¥çœ‹å£³ä¿¡æ¯ï¼Œå‘ç°æ˜¯upx modified</p>
<p><img src="/../images/image-20250729110711262.png" alt="æŸ¥çœ‹å£³ä¿¡æ¯"></p>
<p>ç‚¹å‡»â€œåŒºå—â€œä¸‹æ–¹çš„â€&gt;â€œæŸ¥çœ‹åŒºå—ä¿¡æ¯ï¼Œå‘ç°åŒºå—åæœ‰æ”¹åŠ¨</p>
<p><img src="/../images/image-20250729110752177.png" alt="åŒºå—åæ”¹åŠ¨"></p>
<p>010editorä¿®æ”¹åŒºå—å</p>
<p><img src="/../images/image-20250729111002665.png" alt="ä¿®æ”¹åŒºå—å"></p>
<p>å†æ¬¡æŸ¥çœ‹å£³ä¿¡æ¯ï¼Œå˜æˆæ— ä¿®æ”¹åŠ å£³äº†ï¼Œç›´æ¥å·¥å…·è„±å£³</p>
<p><img src="/../images/image-20250729111128932.png" alt="å†æ¬¡æŸ¥çœ‹å£³ä¿¡æ¯"></p>
</li>
</ul>
<h2 id="æ‰‹åŠ¨è„±å£³æµç¨‹"><a href="#æ‰‹åŠ¨è„±å£³æµç¨‹" class="headerlink" title="æ‰‹åŠ¨è„±å£³æµç¨‹"></a>æ‰‹åŠ¨è„±å£³æµç¨‹</h2><ul>
<li><p>æ­¥éª¤ï¼š</p>
<ul>
<li>æŸ¥å£³ï¼šä½¿ç”¨DIEã€ExeinfoPEã€PEiDç­‰å·¥å…·æŸ¥å£³</li>
<li>å¯»æ‰¾ç¨‹åºåŸå…¥å£ç‚¹(OEP)ï¼šé€šè¿‡å„ç§æ–¹æ³•æ‰¾åˆ°å£³ä»£ç ç»“æŸã€ç¨‹åºçœŸæ­£å¼€å§‹çš„åœ°æ–¹</li>
<li>dumpå†…å­˜ï¼šå€ŸåŠ©æ’ä»¶ä»OEPå¼€å§‹dumpå‡ºåŸç¨‹åº</li>
<li>è¾“å…¥è¡¨(IAT)é‡å»ºï¼šå€ŸåŠ©æ’ä»¶é‡å»ºè¾“å…¥è¡¨</li>
<li>å…³é—­ç¨‹åºé‡å®šä½ï¼šä½¿ç”¨DIEç­‰å·¥å…·å…³é—­ç¨‹åºé‡å®šä½</li>
</ul>
</li>
<li><p>å¯»æ‰¾OEPçš„æ–¹æ³•æœ‰å¾ˆå¤šï¼Œè€Œdumpå’ŒIATé‡å»ºä»¥åŠå…³é—­é‡å®šä½çš„æ–¹æ³•åŸºæœ¬å›ºå®šã€‚å…ˆç”¨ä¸€ä¸ªä¾‹å­å±•ç¤ºæ•´ä½“æµç¨‹ï¼Œå†è¯¦ç»†å±•å¼€å¯»æ‰¾OEPçš„æ–¹æ³•ã€‚upxæ‰‹åŠ¨è„±å£³ç¤ºä¾‹ï¼š</p>
<ul>
<li><p>æŸ¥å£³ï¼šæ˜¾ç¤ºæ˜¯upx</p>
<p><img src="/../images/image-20250729133015652.png" alt="æŸ¥å£³"></p>
</li>
<li><p>å¯»æ‰¾OEPï¼š</p>
<p>é‡‡ç”¨espå®šå¾‹æ³•ï¼ˆè¯¦è§ä¸‹æ–‡ï¼‰æ‰¾åˆ°push ebpå¼€å¤´çš„ä¸€æ®µä»£ç </p>
<p><img src="/../images/image-20250729134006853.png" alt="å¯»æ‰¾OEP"></p>
</li>
<li><p>dumpå†…å­˜ï¼š</p>
<p>æ‰“å¼€æ’ä»¶scyllaï¼Œç‚¹å‡»â€œè½¬å‚¨â€æ ä¸­çš„â€œè½¬å‚¨â€ï¼Œä¼šè·å¾—ä¸€ä¸ª_dumpåç¼€çš„exeæ–‡ä»¶</p>
<p><img src="/../images/image-20250729134119537.png" alt="dump"></p>
</li>
<li><p>IATé‡å»ºï¼š</p>
<p>ç‚¹å‡»â€œIATè‡ªåŠ¨æœç´¢â€ï¼Œä¼šæœ‰å¼¹çª—é—®æ˜¯å¦ä½¿ç”¨é«˜çº§æœç´¢ç»“æœï¼Œç‚¹â€œæ˜¯â€ã€‚è¿™æ—¶å€™ï¼ŒVAå’Œâ€œå¤§å°â€ä¸¤ä¸ªæ¡†ä¼šè¢«å¡«å……ã€‚</p>
<p><img src="/../images/image-20250729134901607.png" alt="IATè‡ªåŠ¨æœç´¢"></p>
<p>æ¥ä¸‹æ¥ç‚¹â€œè·å–å¯¼å…¥â€ï¼Œä¸Šæ–¹çš„å¤§æ¡†ä¸­ä¼šå‡ºç°dllç»“å°¾çš„ä¸œè¥¿ï¼Œéœ€è¦æŠŠå¸¦çº¢è‰²Xçš„å–æ¶ˆå‹¾é€‰</p>
<p><img src="/../images/image-20250729134937163.png" alt="è·å–å¯¼å…¥"></p>
<p>ç„¶åç‚¹å‡»ä¿®å¤è½¬å‚¨ï¼Œé€‰æ‹©åˆšåˆšdumpå‡ºæ¥çš„æ–‡ä»¶ï¼Œä¼šå¾—åˆ°ä¸€ä¸ªå†åŠ ä¸Š_SCYçš„exeæ–‡ä»¶ã€‚</p>
<p>æ­¤æ—¶ç¨‹åºå¤§æ¦‚ç‡è¿è¡Œä¸äº†ï¼Œä¼šé—ªé€€ã€‚ä½†æ˜¯å¯¹äºé™æ€åˆ†ææ¥è¯´ï¼Œåˆ°è¿™ä¸€æ­¥å·²ç»è¶³å¤Ÿäº†ã€‚</p>
</li>
<li><p>å…³é—­é‡å®šä½ï¼šæŠŠå¾—åˆ°çš„_dump_SCY.exeæ–‡ä»¶æ‹–åˆ°DIEï¼Œç‚¹å‡»â€œåŒºå—â€æ çš„â€œ&gt;â€ï¼Œä¼šå¼¹å‡ºæ–‡ä»¶ç»“æ„ç•Œé¢</p>
<p><img src="/../images/image-20250729135914719.png" alt="æ–‡ä»¶ç»“æ„ç•Œé¢"></p>
<p>å…ˆå–æ¶ˆå‹¾é€‰å³ä¸Šè§’çš„â€œåªè¯»â€</p>
<p><img src="/../images/image-20250729140239276.png" alt="å–æ¶ˆåªè¯»"></p>
<p>ç‚¹å‡»IMAGE_NT_HEADERSä¸‹çš„IMAGE_FILE_HEADERï¼Œåœ¨â€œæ ‡å¿—â€é€‰é¡¹ä¸­å‹¾é€‰â€œRELOCS_STRIPPEDâ€ï¼ˆå›¾ä¸­æœªå‹¾é€‰ï¼‰</p>
<p><img src="/../images/image-20250729140145721.png" alt="å‹¾é€‰RELOCS_STRIPPED"></p>
<p>å†ç‚¹å‡»IMAGE_OPTIONAL_HEADERSï¼Œæ‰¾åˆ°å¦ä¸€ä¸ªæ ‡å¿—(DllCharacteristics)ï¼Œå–æ¶ˆå‹¾é€‰â€œDYNAMIC_BASEâ€ï¼ˆå›¾ä¸­æœªå–æ¶ˆï¼‰</p>
<p><img src="/../images/image-20250729140545940.png" alt="å–æ¶ˆå‹¾é€‰DYNAMIC_BASE"></p>
<p>è¿™æ ·å­ï¼Œæˆ‘ä»¬çš„ç¨‹åºå°±è„±å®Œå£³å¹¶ä¸”å¯ä»¥æ­£å¸¸è¿è¡Œäº†</p>
</li>
<li><p>PSï¼šå…³äºIATé‡å»ºè¿™ä¸€æ­¥éª¤ï¼Œä¸ºä»€ä¹ˆä¸èƒ½IATè‡ªåŠ¨æœç´¢å†è½¬å‚¨ä¸€æ­¥åˆ°ä½ï¼Ÿ</p>
<p>ç»“åˆAIçš„è§£é‡Šï¼Œä¸ªäººè§è§£æ˜¯IATè‡ªåŠ¨æœç´¢çš„è¿‡ç¨‹å¯èƒ½ä¼šè¿è¡Œç¨‹åºï¼Œå¯¼è‡´åœ°å€åˆ·æ–°ï¼ŒOEPå¤±æ•ˆï¼Œdumpå‡ºæ¥çš„ç¨‹åºä¸å®Œæ•´æˆ–è€…ä¸å¯¹ã€‚å› æ­¤ï¼Œdumpå’ŒIATé‡å»ºå®é™…ä¸Šæ˜¯ä¸¤ä¸ªæ­¥éª¤ï¼Œä¸è¿‡è¢«é›†æˆåˆ°äº†ä¸€ä¸ªç•Œé¢ã€‚å…¶å®è¿˜æœ‰æ‰‹åŠ¨é‡å»ºIATçš„æ–¹æ³•ï¼Œè¿™ç§æƒ…å†µä¸‹å°±ç¡®ç¡®å®å®éœ€è¦å…ˆdumpå†å¯¼å…¥é‡å»ºçš„IATäº†ï¼Œå› ä¸ºåœ¨è°ƒè¯•å™¨ä¸­æ‰¾åˆ°OEPåè¿˜è¦ç»§ç»­æ‰¾IAT</p>
</li>
</ul>
</li>
</ul>
<h2 id="å¯»æ‰¾OEPçš„æ–¹æ³•ï¼ˆä¸€ï¼‰"><a href="#å¯»æ‰¾OEPçš„æ–¹æ³•ï¼ˆä¸€ï¼‰" class="headerlink" title="å¯»æ‰¾OEPçš„æ–¹æ³•ï¼ˆä¸€ï¼‰"></a>å¯»æ‰¾OEPçš„æ–¹æ³•ï¼ˆä¸€ï¼‰</h2><h3 id="ESPå®šå¾‹"><a href="#ESPå®šå¾‹" class="headerlink" title="ESPå®šå¾‹"></a>ESPå®šå¾‹</h3><ul>
<li><p>å‰æ–‡ï¼Œæˆ‘ä»¬çŸ¥é“äº†å£³ç¨‹åºè§£ææ—¶ä¼šæœ‰pushad\popadæˆ–è€…pushfd\popfdçš„æ“ä½œã€‚pushadæ—¶ï¼Œéšç€é€šç”¨å¯„å­˜å™¨å€¼çš„å…¥æ ˆï¼Œespçš„å€¼ä¼šå‘ç”Ÿå˜åŒ–ï¼Œåˆå› ä¸ºæ ˆå¹³è¡¡çš„ç‰¹æ€§ï¼Œæœ€ç»ˆespçš„å€¼ä¼šå›åˆ°pushadåçš„è¿™ä¸ªå€¼ã€‚å› æ­¤ï¼Œå¯ä»¥å€ŸåŠ©è¿™ä¸€ç‚¹ï¼Œç»™pushadåçš„espå€¼ä¸‹ç¡¬ä»¶è®¿é—®æ–­ç‚¹ï¼Œpopadåå°±ä¼šè§¦å‘æ–­ç‚¹ï¼Œä¸­æ–­è°ƒè¯•ï¼Œè¿›è€Œå®ç°è·³è¿‡æ•´ä¸ªå£³è§£æè¿‡ç¨‹ã€‚å½“ç„¶ï¼Œä¸­æ–­å¤„è¿˜ä¸æ˜¯OEPï¼Œä¸€èˆ¬åœ¨ä¸­æ–­å¤„åä¼šæœ‰ä¸€ä¸ªè·¨åº¦æ˜æ˜¾çš„jmpï¼Œç”šè‡³jmpåè¿˜æœ‰ä¸€ä¸ªè·³è½¬è¡¨jmpæ‰ä¼šåˆ°è¾¾çœŸæ­£çš„OEP</p>
</li>
<li><p>å…·ä½“æ“ä½œå¦‚ä¸‹ï¼š</p>
<ul>
<li><p>xdbgæ‰“å¼€ï¼ŒF9åˆ°ç¨‹åºæ‰€åœ¨å†…å­˜åŒºåŸŸ</p>
<p><img src="/../images/image-20250729172225632.png" alt="xdbgæ‰“å¼€"></p>
</li>
<li><p>å¯ä»¥çœ‹åˆ°EIPæ‰€åœ¨å°±æ˜¯pushad</p>
<p><img src="/../images/image-20250729172310628.png" alt="pushad"></p>
</li>
<li><p>F8æ­¥è¿‡ï¼Œespæ›´æ–°</p>
<p><img src="/../images/image-20250729172402698.png" alt="espæ›´æ–°"></p>
</li>
<li><p>åœ¨å³ä¸‹è§’æ ˆçª—å£è®¾ä¸Šç¡¬ä»¶è®¿é—®æ–­ç‚¹</p>
<p><img src="/../images/image-20250729172449826.png" alt="è®¾ç½®ç¡¬ä»¶è®¿é—®æ–­ç‚¹"></p>
</li>
<li><p>ç‚¹å‡»å·¥å…·æ â€œè§†å›¾â€ä¸‹æ–¹çš„â€œ-&gt;â€ï¼Œç¨‹åºä¼šæ‰§è¡Œè¿‡popadã€‚å¯ä»¥çœ‹åˆ°ä¸‹æ–¹ä¸è¿œå¤„æœ‰ä¸ªå¤§è·³</p>
<p><img src="/../images/image-20250729172606653.png" alt="popad"></p>
</li>
<li><p>F8åˆ°å¤§è·³å¤„F7æ­¥å…¥ï¼Œæœ‰è·³è½¬è¡¨ç»§ç»­F7æ­¥å…¥ï¼Œå¯ä»¥çœ‹åˆ°å¼€è¾Ÿæ ˆå¸§æ“ä½œï¼Œè¿™é‡Œå°±æ˜¯OEPäº†ï¼Œåœ¨æ­¤å¤„ç›´æ¥ä½¿ç”¨scylla dumpå‡ºç¨‹åº</p>
<p><img src="/../images/image-20250729172759829.png" alt="OEP"></p>
</li>
</ul>
</li>
</ul>
<h3 id="å•æ­¥è·Ÿè¸ªæ³•"><a href="#å•æ­¥è·Ÿè¸ªæ³•" class="headerlink" title="å•æ­¥è·Ÿè¸ªæ³•"></a>å•æ­¥è·Ÿè¸ªæ³•</h3><ul>
<li>å¦‚åï¼Œå°±æ˜¯ä¸€ç›´æŒ‰F8ï¼Œè®©ç¨‹åºå°½é‡å‘ä¸‹èµ°ï¼Œé‡åˆ°å¾ªç¯å°±è·³è¿‡ï¼Œé‡åˆ°è¿‘callå°±æ­¥å…¥ï¼Œé‡ç‚¹å…³æ³¨å¤§è·³</li>
<li>å‚è€ƒctf-wiki <a href="https://ctf-wiki.org/reverse/platform/windows/unpack/trace/">https://ctf-wiki.org/reverse/platform/windows/unpack/trace/</a></li>
</ul>
]]></content>
      <categories>
        <category>Reverseå­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>Reverse</tag>
      </tags>
  </entry>
  <entry>
    <title>Re:ä»0åˆ°1çš„è„šæœ¬ä¹‹è·¯</title>
    <url>/2025/06/02/Re-%E4%BB%8E0%E5%88%B01%E7%9A%84%E8%84%9A%E6%9C%AC%E4%B9%8B%E8%B7%AF/</url>
    <content><![CDATA[<p>pythonè„šæœ¬åšé¢˜è®°å½•</p>
<span id="more"></span>

<h2 id="SWPUCTF-2021-æ–°ç”Ÿèµ›-fakebase"><a href="#SWPUCTF-2021-æ–°ç”Ÿèµ›-fakebase" class="headerlink" title="[SWPUCTF 2021 æ–°ç”Ÿèµ›]fakebase"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]fakebase</h2><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#ç»™çš„ä»£ç å¦‚ä¸‹ï¼š</span><br>flag = <span class="hljs-string">&#x27;xxxxxxxxxxxxxxxxxxx&#x27;</span><br><br>s_box = <span class="hljs-string">&#x27;qwertyuiopasdfghjkzxcvb123456#$&#x27;</span><br>tmp = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> flag:<br>    tmp += <span class="hljs-built_in">str</span>(<span class="hljs-built_in">bin</span>(<span class="hljs-built_in">ord</span>(i)))[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">8</span>)<br>b1 = <span class="hljs-built_in">int</span>(tmp,<span class="hljs-number">2</span>)<br>s = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">while</span> b1//<span class="hljs-number">31</span> != <span class="hljs-number">0</span>:<br>    s += s_box[b1%<span class="hljs-number">31</span>]<br>    b1 = b1//<span class="hljs-number">31</span><br><br><span class="hljs-built_in">print</span>(s)<br><br><span class="hljs-comment"># s = u#k4ggia61egegzjuqz12jhfspfkay</span><br></code></pre></td></tr></table></figure>

<ul>
<li><p>ä»£ç ä¸­ï¼ŒæŠŠflagé€å­—ç¬¦è½¬åŒ–ä¸ºäºŒè¿›åˆ¶ï¼Œæˆªæ‰å‰ç¼€ï¼Œå¡«å……ä¸º8ä½ï¼Œå†æ‹¼æ¥è¿™äº›äºŒè¿›åˆ¶æ•°å¾—åˆ°tmp</p>
</li>
<li><p>ç„¶åæŠŠtmpè½¬åŒ–ä¸ºåè¿›åˆ¶b1ï¼Œä¸æ–­é™¤31ï¼ŒåŒæ—¶ç”¨ä½™æ•°åšS_boxç´¢å¼•ï¼ŒæŠŠç´¢å¼•å€¼æ‹¼æ¥å¾—åˆ°S</p>
</li>
<li><p>æ‰€ä»¥ï¼Œè§£å¯†æ€è·¯æ˜¯ï¼Œé¦–å…ˆï¼Œè¿˜åŸb1ï¼š</p>
<ul>
<li>b1åˆ©ç”¨åå¾—åˆ°ä¸€ç³»åˆ—ç´¢å¼•å€¼ï¼Œæ‰€ä»¥ç”±ç´¢å¼•å€¼åæ¨b1</li>
<li>é€†åºså¯¹ç…§s_boxå¾—å‡ºç´¢å¼•ï¼ˆä¸ºäº†ä»æœ€åä¸€ä¸ªä½™æ•°å¼€å§‹è¿˜åŸb1ï¼‰å¹¶ç»„æˆä¸€ä¸ªåˆ—è¡¨ã€‚å› ä¸ºå¾ªç¯ç»ˆæ­¢æ¡ä»¶æ˜¯b1&#x2F;&#x2F;31&#x3D;&#x3D;0ï¼Œæ‰€ä»¥æœ€åä¸€æ¬¡é™¤åªåˆ©ç”¨äº†å•†ç­‰äº0ï¼Œè€Œä½™æ•°æœªçŸ¥ï¼Œäºæ˜¯ä»0-30å‡è®¾è¢«å¼ƒæ‰çš„ä½™æ•°ï¼Œæšä¸¾å„ç§å¯èƒ½ã€‚</li>
</ul>
</li>
<li><p>è€Œå¦‚ä½•åˆ¤æ–­å“ªç§å¯èƒ½æ˜¯æˆ‘ä»¬éœ€è¦çš„å‘¢ï¼Ÿå°±éœ€è¦è¿˜åŸå‡ºflagå¹¶åˆ¤æ–­ã€‚æŠŠè¿˜åŸå‡ºæ¥çš„b1è½¬äºŒè¿›åˆ¶ï¼Œå»æ‰å‰ç¼€ï¼Œå¡«å……åˆ°8çš„å€æ•°æ–¹ä¾¿æˆªå–äºŒè¿›åˆ¶æ•°ï¼Œç„¶å8ä¸ª8ä¸ªè¿˜åŸå‡ºå­—ç¬¦ï¼Œæœ€ååˆ¤æ–­æ˜¯ä¸æ˜¯flagå°±è¡Œäº†ã€‚</p>
</li>
<li><p>EXPï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">buf=<span class="hljs-string">&quot;u#k4ggia61egegzjuqz12jhfspfkay&quot;</span><br>s_box = <span class="hljs-string">&#x27;qwertyuiopasdfghjkzxcvb123456#$&#x27;</span><br><br>index_list=[]<br><span class="hljs-comment">#æ±‚ç´¢å¼•å€¼åˆ—è¡¨</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> buf[::-<span class="hljs-number">1</span>]:<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(s_box)):<br>        <span class="hljs-keyword">if</span> i == s_box[j]:<br>           index_list.append(j)<br><span class="hljs-comment">#print(index_list)</span><br><br><span class="hljs-comment">#æšä¸¾è¾¾åˆ°ç»ˆæ­¢æ¡ä»¶æ—¶çš„ä½™æ•°</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">31</span>):<br>    <span class="hljs-comment">#å¼€å§‹è¿˜åŸb1</span><br>    b1=i<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(buf)):<br>        b1=b1*<span class="hljs-number">31</span>+index_list[j]<span class="hljs-comment">#ä¸æ–­åŠ ä½™æ•°ï¼Œä¹˜31</span><br>    tmp=<span class="hljs-built_in">str</span>(<span class="hljs-built_in">bin</span>(b1)[<span class="hljs-number">2</span>:])<span class="hljs-comment">#åŠ å¯†æµç¨‹æ˜¯æŠŠtmpä»2è¿›åˆ¶è½¬10è¿›åˆ¶ï¼Œè¿™é‡Œå°±åç€æ¥ï¼ŒæŠŠb1ä»10è¿›åˆ¶è½¬2è¿›åˆ¶ï¼Œæˆªå»å‰ç¼€</span><br>    tmp=tmp.zfill((<span class="hljs-built_in">len</span>(tmp)//<span class="hljs-number">8</span>+<span class="hljs-number">1</span>)*<span class="hljs-number">8</span>)<span class="hljs-comment">#åŠ å¯†æ—¶å­—ç¬¦è½¬æˆ8ä½2è¿›åˆ¶æ•°ï¼Œåç€æ¥å°±æ˜¯æŠŠ8ä½2è¿›åˆ¶æ•°è½¬ä¸ºå­—ç¬¦ï¼Œæ‰€ä»¥å…ˆæŠŠtmp 8ä½å¯¹é½æ–¹ä¾¿åç»­æˆªå–</span><br>    flag=<span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(tmp),<span class="hljs-number">8</span>):<br>        flag+=<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(tmp[i:i+<span class="hljs-number">8</span>],<span class="hljs-number">2</span>))<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;NSSCTF&#x27;</span> <span class="hljs-keyword">in</span> flag:<br>        <span class="hljs-built_in">print</span>(flag)<br>        <br><span class="hljs-comment">#flag = &quot;NSSCTF&#123;WHAt_BASe31&#125;&quot;</span><br></code></pre></td></tr></table></figure></li>
</ul>
<h2 id="SWPUCTF-2021-æ–°ç”Ÿèµ›-éå¸¸ç®€å•çš„é€»è¾‘é¢˜"><a href="#SWPUCTF-2021-æ–°ç”Ÿèµ›-éå¸¸ç®€å•çš„é€»è¾‘é¢˜" class="headerlink" title="[SWPUCTF 2021 æ–°ç”Ÿèµ›]éå¸¸ç®€å•çš„é€»è¾‘é¢˜"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]éå¸¸ç®€å•çš„é€»è¾‘é¢˜</h2><ul>
<li><p>é¢˜ç›®ç»™çš„ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">flag = <span class="hljs-string">&#x27;xxxxxxxxxxxxxxxxxxxxx&#x27;</span><br>s = <span class="hljs-string">&#x27;wesyvbniazxchjko1973652048@$+-&amp;*&lt;&gt;&#x27;</span><br>result = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(flag)):<br>    s1 = <span class="hljs-built_in">ord</span>(flag[i])//<span class="hljs-number">17</span><br>    s2 = <span class="hljs-built_in">ord</span>(flag[i])%<span class="hljs-number">17</span><br>    result += s[(s1+i)%<span class="hljs-number">34</span>]+s[-(s2+i+<span class="hljs-number">1</span>)%<span class="hljs-number">34</span>]<br><span class="hljs-built_in">print</span>(result)<br><span class="hljs-comment"># result = &#x27;v0b9n1nkajz@j0c4jjo3oi1h1i937b395i5y5e0e$i&#x27;</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>åŠ å¯†æ€è·¯æ˜¯ï¼šé€å­—ç¬¦å–flagï¼Œé€šè¿‡&#x2F;&#x2F;å’Œ%æ“ä½œå¾—åˆ°ä¸¤ä¸ªå€¼s1å’Œs2ï¼ŒæŠŠè¿™ä¸¤ä¸ªå€¼å¤„ç†åï¼Œä½œä¸ºç´¢å¼•åœ¨sä¸­ç´¢å¼•å‡ºå­—ç¬¦ï¼Œæ‹¼æ¥å¾—åˆ°result</p>
</li>
<li><p>é€†ç€æ¥åº”è¯¥æ˜¯æŠŠresulté”™ä½åˆ†å¼€ï¼Œåˆ†æˆå’Œs1æœ‰å…³çš„ä¸å’Œs2æœ‰å…³çš„ï¼Œç„¶åæ±‚å‡ºç´¢å¼•å€¼ï¼Œé€†ä¸¤ä¸ªå–ä½™è¿‡ç¨‹å¾—åˆ°s1å’Œs2ï¼Œå†æŠŠs1å’Œs2è¿ç®—å¾—åˆ°flagå­—ç¬¦</p>
</li>
<li><p>å¾ˆæ˜¾ç„¶ï¼Œè¿™ä¸ªè¿‡ç¨‹ååˆ†å¤æ‚ï¼Œå› ä¸ºæ¶‰åŠå–æ¨¡çš„è¿˜åŸ</p>
</li>
<li><p>æ‰€ä»¥è€ƒè™‘é¡ºç€åŠ å¯†çš„æ€è·¯èµ°ï¼Œä»å¸¸è§çš„å­—ç¬¦åè¿›åˆ¶å€¼æšä¸¾ï¼Œé‡åˆ°åŠ å¯†åç»“æœå’Œresultä¸€æ ·çš„å°±æ‹¿æ¥æ‹¼æ¥flag</p>
</li>
<li><p>EXP:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">s = <span class="hljs-string">&#x27;wesyvbniazxchjko1973652048@$+-&amp;*&lt;&gt;&#x27;</span><br>result = <span class="hljs-string">&#x27;v0b9n1nkajz@j0c4jjo3oi1h1i937b395i5y5e0e$i&#x27;</span><br>tmp=<span class="hljs-string">&#x27;&#x27;</span><br>flag=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-comment">#æå–å‡ºresulté‡Œå’Œs1ã€s2ç›¸å…³çš„å­—ç¬¦</span><br>s1_list=[]<br>s2_list=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(result),<span class="hljs-number">2</span>):<br>    s1_list.append(result[i])<br>    s2_list.append(result[i+<span class="hljs-number">1</span>])<br><span class="hljs-comment">#å¼€å§‹çˆ†ç ´</span><br><span class="hljs-comment">#å…ˆæ±‚å‡ºåŠ å¯†è¿‡ç¨‹ä¸¤ä¸ªç´¢å¼•å€¼</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(s1_list)):<br>    index1=s.index(s1_list[i])<br>    index2=s.index(s2_list[i])<br>    <span class="hljs-comment">#ä»¥ç´¢å¼•å€¼ä¸ºåˆ¤æ–­æ¡ä»¶ï¼Œåœ¨å¸¸è§å­—ç¬¦çš„èŒƒå›´å†…é‡ç°åŠ å¯†è¿‡ç¨‹ï¼ŒåŠ å¯†ç»“æœå’Œç´¢å¼•å€¼ä¸€è‡´å³ä¸ºflagçš„å­—ç¬¦</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">33</span>,<span class="hljs-number">126</span>):<br>        s1=j//<span class="hljs-number">17</span><br>        s2=j%<span class="hljs-number">17</span><br>        <span class="hljs-keyword">if</span> (s1 + i) % <span class="hljs-number">34</span>==index1 <span class="hljs-keyword">and</span> -(s2 + i + <span class="hljs-number">1</span>) % <span class="hljs-number">34</span>==index2:<br>            flag+=<span class="hljs-built_in">chr</span>(j)<br>            <span class="hljs-keyword">break</span><br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment">#flag = &quot;NSSCTF&#123;Fake_RERE_QAQ&#125;&quot;&quot;</span><br></code></pre></td></tr></table></figure></li>
</ul>
<h2 id="SWPUCTF-2021-æ–°ç”Ÿèµ›-re2"><a href="#SWPUCTF-2021-æ–°ç”Ÿèµ›-re2" class="headerlink" title="[SWPUCTF 2021 æ–°ç”Ÿèµ›]re2"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]re2</h2><ul>
<li><p>IDAæ‰“å¼€ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-04-13%20214924.png" alt="RE2"></p>
</li>
<li><p>ç®€å•çš„å­—ç¬¦å¤„ç†ï¼Œå…ˆåˆ¤æ–­å­—ç¬¦æ˜¯å¦åœ¨èŒƒå›´å†…ï¼Œç„¶åé‡‡ç”¨ä¸åŒå¤„ç†æ–¹å¼</p>
</li>
<li><p>ç›´æ¥æ­£å‘åˆ©ç”¨ä»£ç ï¼Œçœç‚¹è„‘å­ã€‚</p>
</li>
<li><p>EXP:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">alpha=<span class="hljs-string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890&#123;&#125;-_&#x27;</span><br>dic=&#123;&#125;<br><span class="hljs-built_in">str</span>=<span class="hljs-string">&#x27;ylqq]aycqyp&#123;&#x27;</span><br>flag=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> alpha:<br>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">ord</span>(i)&lt;=<span class="hljs-number">96</span> <span class="hljs-keyword">or</span> <span class="hljs-built_in">ord</span>(i)&gt;<span class="hljs-number">98</span>) <span class="hljs-keyword">and</span> (<span class="hljs-built_in">ord</span>(i)&lt;=<span class="hljs-number">64</span> <span class="hljs-keyword">or</span> <span class="hljs-built_in">ord</span>(i)&gt;<span class="hljs-number">66</span>):<br>        dic[<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(i)-<span class="hljs-number">2</span>)]=i<br>    <span class="hljs-keyword">else</span>:<br>        dic[<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(i)+<span class="hljs-number">24</span>)]=i<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">str</span>:<br>    flag+=dic[i]<br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment">#flag = &#x27;NSSCTF&#123;nss_caesar&#125;&#x27;</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>ç›´æ¥å¾—å‡ºæ¥çš„ç»“æœæ˜¯{nss_c{es{r}ï¼Œæ˜¾ç„¶ä¸å¯¹ï¼ŒçŒœæµ‹å¯¹åº”å…³ç³»ä¸å”¯ä¸€ã€‚æ‰“å°å‡ºalphaç»è¿‡å¤„ç†åçš„ç»“æœï¼Œå‘ç°â€™{â€˜å’Œâ€™aâ€™éƒ½å¯¹åº”â€™yâ€™ï¼Œæ‰€ä»¥æŠŠæ˜¾ç„¶ä¸å¯¹åŠ²çš„ä¸¤ä¸ªâ€™ { â€˜æ”¹æˆâ€™ a â€˜</p>
</li>
</ul>
<h2 id="WUSTCTF-2020-level1"><a href="#WUSTCTF-2020-level1" class="headerlink" title="[WUSTCTF 2020]level1"></a>[WUSTCTF 2020]level1</h2><ul>
<li><p>é™„ä»¶ç»™äº†ELFæ–‡ä»¶å’Œä¸€ä¸ªtxtï¼Œåæ±‡ç¼–ä»£ç å¦‚ä¸‹ï¼š</p>
<p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-04-14%20214810.png" alt="LEVEL1"></p>
</li>
<li><p>é€»è¾‘å°±æ˜¯ä»flagæ–‡ä»¶é‡Œè¯»æ•°æ®ï¼Œç„¶åå­˜åˆ°ptré‡Œã€‚åé¢æ˜¯ç®€å•çš„å¯é€†å¤„ç†ï¼Œä½†æ˜¯è¦æ³¨æ„ptræ˜¯ä»ä¸‹æ ‡1å¼€å§‹ç”¨çš„ã€‚ç»™çš„txtåº”è¯¥å°±æ˜¯å¤„ç†åçš„ç»“æœï¼ŒæŠŠå®ƒè½¬æˆä¸€ä¸ªåˆ—è¡¨ï¼Œç¬¬ä¸€ä½éšä¾¿å¡«ä¸€ä¸ªæ•°ã€‚ç„¶åé€†ã€‚</p>
</li>
<li><p>EXP:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">output=[<span class="hljs-number">0</span>, <span class="hljs-number">198</span>, <span class="hljs-number">232</span>, <span class="hljs-number">816</span>, <span class="hljs-number">200</span>, <span class="hljs-number">1536</span>, <span class="hljs-number">300</span>, <span class="hljs-number">6144</span>, <span class="hljs-number">984</span>, <span class="hljs-number">51200</span>, <span class="hljs-number">570</span>, <span class="hljs-number">92160</span>, <span class="hljs-number">1200</span>, <span class="hljs-number">565248</span>, <span class="hljs-number">756</span>, <span class="hljs-number">1474560</span>, <span class="hljs-number">800</span>, <span class="hljs-number">6291456</span>, <span class="hljs-number">1782</span>, <span class="hljs-number">65536000</span>]<br>flag=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-built_in">len</span>(output)):<br>    <span class="hljs-keyword">if</span> (i&amp;<span class="hljs-number">1</span>)!=<span class="hljs-number">0</span>:<br>        flag+=<span class="hljs-built_in">chr</span>(output[i]&gt;&gt;i)<br>    <span class="hljs-keyword">else</span>:<br>        flag+=<span class="hljs-built_in">chr</span>(output[i]//i)<br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment">#flag = &#x27;NSSCTF&#123;d9-dE6-20c&#125;&#x27;ï¼ˆæ”¹äº†å‰ç¼€ï¼‰</span><br></code></pre></td></tr></table></figure></li>
</ul>
<h2 id="SWPUCTF-2021-æ–°ç”Ÿèµ›-ç®€ç®€å•å•çš„è§£å¯†"><a href="#SWPUCTF-2021-æ–°ç”Ÿèµ›-ç®€ç®€å•å•çš„è§£å¯†" class="headerlink" title="[SWPUCTF 2021 æ–°ç”Ÿèµ›]ç®€ç®€å•å•çš„è§£å¯†"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]ç®€ç®€å•å•çš„è§£å¯†</h2><ul>
<li><p>ç»™çš„pythonä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64,urllib.parse<br>key = <span class="hljs-string">&quot;HereIsFlagggg&quot;</span><br>flag = <span class="hljs-string">&quot;xxxxxxxxxxxxxxxxxxx&quot;</span><br><br>s_box = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))<br>j = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>    j = (j + s_box[i] + <span class="hljs-built_in">ord</span>(key[i % <span class="hljs-built_in">len</span>(key)])) % <span class="hljs-number">256</span><br>    s_box[i], s_box[j] = s_box[j], s_box[i]<br>res = []<br>i = j = <span class="hljs-number">0</span><br><br><span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> flag:<br>    i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>    j = (j + s_box[i]) % <span class="hljs-number">256</span><br>    s_box[i], s_box[j] = s_box[j], s_box[i]<br>    t = (s_box[i] + s_box[j]) % <span class="hljs-number">256</span><br>    k = s_box[t]<br>    res.append(<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(s) ^ k))<br>cipher = <span class="hljs-string">&quot;&quot;</span>.join(res)<br>crypt = (<span class="hljs-built_in">str</span>(base64.b64encode(cipher.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)), <span class="hljs-string">&#x27;utf-8&#x27;</span>))<br>enc = <span class="hljs-built_in">str</span>(base64.b64decode(crypt),<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>enc = urllib.parse.quote(enc)<br><span class="hljs-built_in">print</span>(enc)<br><span class="hljs-comment"># enc = %C2%A6n%C2%87Y%1Ag%3F%C2%A01.%C2%9C%C3%B7%C3%8A%02%C3%80%C2%92W%C3%8C%C3%BA</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>é‡‡ç”¨çš„åŠ å¯†ç®—æ³•æ˜¯æ ‡å‡†RC4ï¼ŒåŠ å¯†ä¸¤éæ¢å¤æ˜æ–‡ã€‚æœ€åé¢çš„è°ƒç”¨baseçš„ä¸¤è¡Œç»è¿‡è°ƒè¯•å‘ç°ç›¸äº’æŠµæ¶ˆï¼Œæ‰€ä»¥æ•´ä¸ªé€»è¾‘å°±æ˜¯å…ˆRC4åŠ å¯†ï¼Œç„¶åç”¨urllib.parse.quote()æ–¹æ³•ç¼–ç ï¼Œç¼–ç éƒ¨åˆ†ç”¨åŸåº“è‡ªå¸¦çš„urllib.parse.unquote()å°±è¡Œäº†</p>
</li>
<li><p>EXP:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> urllib.parse<br>enc = <span class="hljs-string">&#x27;%C2%A6n%C2%87Y%1Ag%3F%C2%A01.%C2%9C%C3%B7%C3%8A%02%C3%80%C2%92W%C3%8C%C3%BA&#x27;</span><br>buf=urllib.parse.unquote(enc)<br>result=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> buf:<br>    result.append(i)<br><br>key = <span class="hljs-string">&quot;HereIsFlagggg&quot;</span><br>flag = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">RC4</span>(<span class="hljs-params">flag</span>):<br>    s_box = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))<br>    j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        j = (j + s_box[i] + <span class="hljs-built_in">ord</span>(key[i % <span class="hljs-built_in">len</span>(key)])) % <span class="hljs-number">256</span><br>        s_box[i], s_box[j] = s_box[j], s_box[i]<br>    res = []<br>    i = j = <span class="hljs-number">0</span><br><br>    <span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> flag:<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        j = (j + s_box[i]) % <span class="hljs-number">256</span><br>        s_box[i], s_box[j] = s_box[j], s_box[i]<br>        t = (s_box[i] + s_box[j]) % <span class="hljs-number">256</span><br>        k = s_box[t]<br>        res.append(<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(s) ^ k))<br>    cipher = <span class="hljs-string">&quot;&quot;</span>.join(res)<br>    <span class="hljs-keyword">return</span> cipher<br><br>flag+=RC4(result)<br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment"># flag = &#x27;NSSCTF&#123;REAL_EZ_RC4&#125;&#x27;</span><br></code></pre></td></tr></table></figure></li>
</ul>
<h2 id="LitCTF-2023-ez-XOR"><a href="#LitCTF-2023-ez-XOR" class="headerlink" title="[LitCTF 2023]ez_XOR"></a>[LitCTF 2023]ez_XOR</h2><ul>
<li><p>IDAæ‰“å¼€ï¼Œå¦‚å›¾</p>
<p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-04-15%20215658.png" alt="ez_XOR"></p>
</li>
<li><p>ç”¨XORå‡½æ•°å¯¹è¾“å…¥åšå¤„ç†åï¼Œä¸stræ¯”è¾ƒã€‚æ‰“å¼€XORï¼š</p>
<p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-04-15%20215712.png" alt="function_xor"></p>
</li>
<li><p>åŠŸèƒ½å°±æ˜¯éå†å­—ç¬¦ï¼Œå¼‚æˆ–å¤„ç†ï¼Œå†å¼‚æˆ–ä¸€éå°±å¯ä»¥äº†</p>
</li>
<li><p>EXP:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">str</span>=<span class="hljs-string">&#x27;E`&#125;J]OrQF[V8zV:hzpV&#125;fVF[t&#x27;</span><br>flag=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(<span class="hljs-built_in">str</span>)):<br>    flag+=<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(<span class="hljs-built_in">str</span>[i])^<span class="hljs-number">9</span>)<br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment"># flag = &#x27;NSSCTF&#123;XOR_1s_3asy_to_OR&#125;&#x27;(å‰ç¼€åšäº†æ”¹åŠ¨)</span><br></code></pre></td></tr></table></figure></li>
</ul>
<h2 id="HUBUCTF-2022-æ–°ç”Ÿèµ›-simple-RE"><a href="#HUBUCTF-2022-æ–°ç”Ÿèµ›-simple-RE" class="headerlink" title="[HUBUCTF 2022 æ–°ç”Ÿèµ›]simple_RE"></a>[HUBUCTF 2022 æ–°ç”Ÿèµ›]simple_RE</h2><ul>
<li><p>IDAæ‰“å¼€ï¼Œå¦‚å›¾</p>
<p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-04-15%20223128.png" alt="simpleRE"></p>
</li>
<li><p>åŠ å¯†å‡½æ•°çœ‹èµ·æ¥é€»è¾‘å¾ˆå¤æ‚ï¼Œä½†æ˜¯ç‚¹å¼€åå­—å¾ˆå¥‡æ€ªçš„æ•°ç»„ï¼Œå‘ç°ä¸€ä¸ªç¼–ç è¡¨ï¼Œå¯ä»¥æ¨æµ‹æ˜¯base64ç¼–ç ã€‚</p>
<p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-04-15%20223308.png" alt="åŠ å¯†å‡½æ•°"></p>
<p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-04-15%20223321.png" alt="ç¼–ç è¡¨"></p>
</li>
<li><p>å›è¿‡å¤´çœ‹ç»™çš„ç”¨æ¥æ¯”è¾ƒçš„å­—ç¬¦ä¸²ï¼ŒåŸºæœ¬å¯ä»¥ç¡®å®šæ˜¯base64æ¢è¡¨ç¼–ç </p>
<p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-04-15%20223431.png" alt="é¢„è®¾å­—ç¬¦ä¸²"></p>
</li>
<li><p>æ‰¾åˆ°äº†ä¸€ä¸ªå¯ä»¥è‡ªå®šä¹‰ç¼–ç è¡¨çš„pythonåº“cusbase64ï¼Œå¯ä»¥ç”¨configæŒ‡å®šç¼–ç è¡¨ï¼Œè¿™æ ·å°±å®¹æ˜“å¤šäº†</p>
</li>
<li><p>EXP:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> cusbase64<br>table=<span class="hljs-string">&#x27;qvEJAfHmUYjBac+u8Ph5n9Od17FrICL/X0gVtM4Qk6T2z3wNSsyoebilxWKGZpRD&#x27;</span><br>enc=<span class="hljs-string">&#x27;5Mc58bPHLiAx7J8ocJIlaVUxaJvMcoYMaoPMaOfg15c475tscHfM/8==&#x27;</span><br>b=cusbase64.CusBase64()<br>b.config(table)<br>b.decode(enc)<br><span class="hljs-comment">#flag = &#x27;NSSCTF&#123;a8d4347722800e72e34e1aba3fe914ae&#125;&#x27;</span><br></code></pre></td></tr></table></figure></li>
</ul>
<h2 id="NSSCTF-2022-Spring-Recruit-easy-C"><a href="#NSSCTF-2022-Spring-Recruit-easy-C" class="headerlink" title="[NSSCTF 2022 Spring Recruit]easy C"></a>[NSSCTF 2022 Spring Recruit]easy C</h2><ul>
<li><p>é¢˜ç›®ç»™çš„æ˜¯cæºæ–‡ä»¶ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#include &lt;stdio.h&gt;</span><br><span class="hljs-comment">#include &lt;string.h&gt;</span><br><br><span class="hljs-built_in">int</span> main()&#123;<br>    char a[]=<span class="hljs-string">&quot;wwwwwww&quot;</span>;<br>    char b[]=<span class="hljs-string">&quot;d`vxbQd&quot;</span>;<br><br>    //<span class="hljs-keyword">try</span> to find out the flag<br>    printf(<span class="hljs-string">&quot;please input flag:&quot;</span>);<br>    scanf(<span class="hljs-string">&quot; %s&quot;</span>,&amp;a);<br><br>    <span class="hljs-keyword">if</span>(strlen(a)!=<span class="hljs-number">7</span>)&#123;<br>        printf(<span class="hljs-string">&quot;NoNoNo\n&quot;</span>);<br>        system(<span class="hljs-string">&quot;pause&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-built_in">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">7</span>;i++)&#123;<br>        a[i]++;<br>        a[i]=a[i]^<span class="hljs-number">2</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span>(!strcmp(a,b))&#123;<br>        printf(<span class="hljs-string">&quot;good!\n&quot;</span>);<br>        system(<span class="hljs-string">&quot;pause&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br><br>    printf(<span class="hljs-string">&quot;NoNoNo\n&quot;</span>);<br>    system(<span class="hljs-string">&quot;pause&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    //flag è®°å¾—åŒ…ä¸Š NSSCTF&#123;&#125; å†æäº¤!!!<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>åˆ†æé€»è¾‘ï¼ŒæŠŠè¾“å…¥çš„flagæŒ‰å­—ç¬¦å…ˆé€’å¢ï¼Œå†å’Œ2å¼‚æˆ–ï¼Œå¾—åˆ°çš„æ–°æ•°ç»„åº”è¯¥å’Œbä¸€æ ·ã€‚é€†ç€æ¥å°±æ˜¯å…ˆå¼‚æˆ–å†é€’å‡ã€‚</p>
</li>
<li><p>EXPï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">str</span>=<span class="hljs-string">&#x27;d`vxbQd&#x27;</span><br>flag=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">str</span>:<br>    flag+=<span class="hljs-built_in">chr</span>((<span class="hljs-built_in">ord</span>(i)^<span class="hljs-number">2</span>)-<span class="hljs-number">1</span>)<br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment">#flag = &#x27;NSSCTF&#123;easy_Re&#125;&#x27;</span><br></code></pre></td></tr></table></figure></li>
</ul>
<h2 id="NSSCTF-2022-Spring-Recruit-easy-Python"><a href="#NSSCTF-2022-Spring-Recruit-easy-Python" class="headerlink" title="[NSSCTF 2022 Spring Recruit]easy Python"></a>[NSSCTF 2022 Spring Recruit]easy Python</h2><ul>
<li><p>é¢˜ç›®ç»™çš„pyæºç ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> string<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encode</span>(<span class="hljs-params">string,string2</span>):<br>    tmp_str = <span class="hljs-built_in">str</span>()<br>    ret = <span class="hljs-built_in">str</span>()<br>    bit_string_str = string.encode()<br>    remain = <span class="hljs-built_in">len</span>( string ) % <span class="hljs-number">3</span><br>    remain_str = <span class="hljs-built_in">str</span>()<br>    <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> bit_string_str:<br>        b_char = (<span class="hljs-built_in">bin</span>(char)[<span class="hljs-number">2</span>:])<br>        b_char = <span class="hljs-string">&#x27;0&#x27;</span>*(<span class="hljs-number">8</span>-<span class="hljs-built_in">len</span>(b_char)) + b_char<br>        tmp_str += b_char<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(tmp_str)//<span class="hljs-number">6</span>):<br>        temp_nub = <span class="hljs-built_in">int</span>(tmp_str[i*<span class="hljs-number">6</span>:<span class="hljs-number">6</span>*(i+<span class="hljs-number">1</span>)],<span class="hljs-number">2</span>)<br>        ret += string2[temp_nub]<br>    <span class="hljs-keyword">if</span> remain==<span class="hljs-number">2</span>:<br>        remain_str = tmp_str[-<span class="hljs-number">4</span>:] + <span class="hljs-string">&#x27;0&#x27;</span>*<span class="hljs-number">2</span><br>        temp_nub = <span class="hljs-built_in">int</span>(remain_str,<span class="hljs-number">2</span>)<br>        ret += string2[temp_nub] + <span class="hljs-string">&quot;=&quot;</span><br>    <span class="hljs-keyword">elif</span> remain==<span class="hljs-number">1</span>:<br>        remain_str = tmp_str[-<span class="hljs-number">2</span>:] + <span class="hljs-string">&#x27;0&#x27;</span>*<span class="hljs-number">4</span><br>        temp_nub = <span class="hljs-built_in">int</span>(remain_str,<span class="hljs-number">2</span>)<br>        ret += string2[temp_nub] + <span class="hljs-string">&quot;=&quot;</span>*<span class="hljs-number">2</span><br>    <span class="hljs-keyword">return</span> ret.replace(<span class="hljs-string">&quot;=&quot;</span>,<span class="hljs-string">&quot;&quot;</span>)<br><br>res = encode(<span class="hljs-built_in">input</span>(),string.ascii_uppercase+string.ascii_lowercase+string.digits+<span class="hljs-string">&#x27;+/&#x27;</span>)<br><br><span class="hljs-keyword">if</span> res == <span class="hljs-string">&quot;TlNTQ1RGe2Jhc2U2NCEhfQ&quot;</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;good!&quot;</span>)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;bad!&quot;</span>)<br></code></pre></td></tr></table></figure>
</li>
<li><p>ç»†ç»†ä¸€çœ‹ï¼Œencode()é‡Œé¢æœ‰åŠ â€œ&#x3D;â€çš„æ“ä½œï¼Œå¹¶ä¸”ä½¿ç”¨çš„string2æ˜¯å­—æ¯å¤§å°å†™+æ•°å­—+â€™+&#x2F;â€˜ï¼Œæ¨æµ‹æ˜¯base64ï¼Œä½†æ˜¯æ³¨æ„åˆ°encode()è¿”å›çš„æ—¶å€™æŠŠâ€œ&#x3D;â€æ›¿æ¢æˆäº†â€œâ€ï¼Œä¹Ÿå°±æ˜¯åˆ é™¤äº†â€œ&#x3D;&#x3D;â€ï¼Œæ‰€ä»¥è¦æŠŠåé¢ç”¨äºæ¯”è¾ƒçš„ä¹Ÿå°±æ˜¯åŠ å¯†åçš„å­—ç¬¦ä¸²åŠ ä¸Šâ€œ&#x3D;â€</p>
</li>
<li><p>EXP:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pybase64<br><span class="hljs-built_in">str</span>=<span class="hljs-string">&#x27;TlNTQ1RGe2Jhc2U2NCEhfQ==&#x27;</span><br>flag=pybase64.b64decode(<span class="hljs-built_in">str</span>)<br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment">#flag = &#x27;NSSCTF&#123;base64!!&#125;&#x27;</span><br></code></pre></td></tr></table></figure></li>
</ul>
<h2 id="SWPUCTF-2021-æ–°ç”Ÿèµ›-fakerandom"><a href="#SWPUCTF-2021-æ–°ç”Ÿèµ›-fakerandom" class="headerlink" title="[SWPUCTF 2021 æ–°ç”Ÿèµ›]fakerandom"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]fakerandom</h2><ul>
<li><p>ä¾æ—§æ˜¯Pyæºç ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br>flag = <span class="hljs-string">&#x27;xxxxxxxxxxxxxxxxxxxx&#x27;</span><br>random.seed(<span class="hljs-number">1</span>)<br>l = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>    l.append(random.getrandbits(<span class="hljs-number">8</span>))<br>result=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(l)):<br>    random.seed(l[i])<br>    <span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>):<br>        result.append(<span class="hljs-built_in">ord</span>(flag[i*<span class="hljs-number">5</span>+n])^random.getrandbits(<span class="hljs-number">8</span>))<br><span class="hljs-built_in">print</span>(result)<br><span class="hljs-comment"># result = [201, 8, 198, 68, 131, 152, 186, 136, 13, 130, 190, 112, 251, 93, 212, 1, 31, 214, 116, 244]</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>é€»è¾‘å°±æ˜¯ï¼Œç”¨ç”Ÿæˆçš„ä¼ªéšæœºæ•°æ¥å¼‚æˆ–flagçš„ç‰¹å®šä½ã€‚å¼‚æˆ–å¯é€†ï¼Œå·²çŸ¥ç§å­ï¼Œä¼ªéšæœºæ•°å¯ä»¥ç¡®å®šã€‚æ‰€ä»¥åªéœ€è¦åœ¨æºç çš„åŸºç¡€ä¸Šç¨ä½œæ”¹åŠ¨ï¼ŒæŠŠresultå’Œflagçš„ä½ç½®è°ƒæ¢ä¸€ä¸‹å°±å¯ä»¥äº†</p>
</li>
<li><p>EXPï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br>flag = <span class="hljs-string">&#x27;&#x27;</span><br>result = [<span class="hljs-number">201</span>, <span class="hljs-number">8</span>, <span class="hljs-number">198</span>, <span class="hljs-number">68</span>, <span class="hljs-number">131</span>, <span class="hljs-number">152</span>, <span class="hljs-number">186</span>, <span class="hljs-number">136</span>, <span class="hljs-number">13</span>, <span class="hljs-number">130</span>, <span class="hljs-number">190</span>, <span class="hljs-number">112</span>, <span class="hljs-number">251</span>, <span class="hljs-number">93</span>, <span class="hljs-number">212</span>, <span class="hljs-number">1</span>, <span class="hljs-number">31</span>, <span class="hljs-number">214</span>, <span class="hljs-number">116</span>, <span class="hljs-number">244</span>]<br>random.seed(<span class="hljs-number">1</span>)<br>l = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>    l.append(random.getrandbits(<span class="hljs-number">8</span>))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(l)):<br>    random.seed(l[i])<br>    <span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>):<br>        flag+=<span class="hljs-built_in">chr</span>(result[i*<span class="hljs-number">5</span>+n]^random.getrandbits(<span class="hljs-number">8</span>))<br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment">#flag = &#x27;NSSCTF&#123;FakeE_random&#125;&#x27;</span><br></code></pre></td></tr></table></figure></li>
</ul>
<h2 id="HNCTF-2022-Week1-X0r"><a href="#HNCTF-2022-Week1-X0r" class="headerlink" title="[HNCTF 2022 Week1]X0r"></a>[HNCTF 2022 Week1]X0r</h2><ul>
<li><p>IDAæ‰“å¼€ï¼Œmainå‡½æ•°å¦‚ä¸‹ï¼š</p>
<p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-04-22%20214614.png" alt="mainå‡½æ•°"></p>
<p>å¯ä»¥çœ‹å‡ºï¼Œé€»è¾‘å°±æ˜¯å¯¹è¾“å…¥çš„å­—ç¬¦ä¸²æŒ‰å­—ç¬¦å¼‚æˆ–å¤„ç†ï¼Œæœ€åä¸ç»™å®šçš„arræ¯”è¾ƒ</p>
</li>
<li><p>EXPï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">arr=[<span class="hljs-number">0x000003FE</span>, <span class="hljs-number">0x000003EB</span>, <span class="hljs-number">0x000003EB</span>, <span class="hljs-number">0x000003FB</span>, <span class="hljs-number">0x000003E4</span>, <span class="hljs-number">0x000003F6</span>, <span class="hljs-number">0x000003D3</span>, <span class="hljs-number">0x000003D0</span>, <span class="hljs-number">0x00000388</span>, <span class="hljs-number">0x000003CA</span>, <span class="hljs-number">0x000003EF</span>, <span class="hljs-number">0x00000389</span>, <span class="hljs-number">0x000003CB</span>, <span class="hljs-number">0x000003EF</span>, <span class="hljs-number">0x000003CB</span>, <span class="hljs-number">0x00000388</span>, <span class="hljs-number">0x000003EF</span>, <span class="hljs-number">0x000003D5</span>, <span class="hljs-number">0x000003D9</span>, <span class="hljs-number">0x000003CB</span>, <span class="hljs-number">0x000003D1</span>, <span class="hljs-number">0x000003CD</span>]<br>flag=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(arr)):<br>    flag+=<span class="hljs-built_in">chr</span>((arr[i]-<span class="hljs-number">900</span>)^<span class="hljs-number">0x34</span>)<br><span class="hljs-built_in">print</span>(flag)<br>flag = <span class="hljs-string">&#x27;NSSCTF&#123;x0r_1s_s0_easy&#125;&#x27;</span><br></code></pre></td></tr></table></figure></li>
</ul>
<h2 id="HGAME-2023-week1-easyenc"><a href="#HGAME-2023-week1-easyenc" class="headerlink" title="[HGAME 2023 week1]easyenc"></a>[HGAME 2023 week1]easyenc</h2><ul>
<li><p>IDAæ‰“å¼€ï¼Œmainå‡½æ•°å¦‚å›¾</p>
<p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-04-25%20214452.png" alt="mainå‡½æ•°"></p>
</li>
<li><p>å¯ä»¥çœ‹åˆ°é€»è¾‘å°±æ˜¯å…ˆéå†å‡ºè¾“å…¥å­—ç¬¦ä¸²çš„é•¿åº¦ï¼ˆ * ( ( _BYTE *) v9 + v4 )è¿™æ ·çš„æ ¼å¼å¯ä»¥çœ‹æˆï¼šv9[v4]ï¼Œç®—æ˜¯ä¸€ç§ç»éªŒå§ï¼‰ç„¶åå¾ªç¯å¯¹è¾“å…¥çš„å­—ç¬¦ä¸²æŒ‰å­—ç¬¦è¿›è¡Œè¿ç®—ï¼Œæœ€åä¸ç»™å®šçš„æ•°æ®æ¯”è¾ƒã€‚</p>
</li>
<li><p>éš¾ç‚¹åœ¨äºï¼Œç»™çš„æ˜¯10ä¸ªå…ƒç´ çš„æ•°ç»„ï¼Œè€Œè¾“å…¥çš„å­—ç¬¦ä¸²å´è¦æ±‚æ˜¯41ä¸ªå­—ç¬¦ã€‚çœ‹æ¥V7çš„æ ¼å¼ä¸æ˜¯å¾ˆå¯¹ï¼Œè¦æŠŠè¿™ä¹ˆå¤šä½çš„æ•°æ®è¿›è¡Œåˆ’åˆ†æ‰è¡Œã€‚v7æ˜¯DWORDç±»å‹ï¼Œè€Œå‚ä¸è¿ç®—çš„v9ç”¨çš„æ˜¯BYTEç±»å‹ï¼Œ1DWORD&#x3D;4BYTEï¼Œè¦æŠŠv7çš„æ•°åˆ†æˆ4éƒ¨åˆ†ï¼Œè¿™é‡Œçš„æ•°æ®ä¸å¥½æå–ï¼Œå¯ä»¥ç›´æ¥ä¸¢ç»™AIã€‚å½“ç„¶æ‰‹åŠ¨å¤åˆ¶ä¹Ÿå¯ä»¥ã€‚</p>
</li>
<li><p>EXPï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">buf=[<span class="hljs-number">0x9FDFF04</span>,<span class="hljs-number">0xB0F301</span>,<span class="hljs-number">0xADF00500</span>,<span class="hljs-number">0x5170607</span>,<span class="hljs-number">0x17FD17EB</span>,<span class="hljs-number">0x1EE01EA</span>,<span class="hljs-number">0xFA05B1EA</span>,<span class="hljs-number">0xAC170108</span>,<span class="hljs-number">0xFDEA01EC</span>,<span class="hljs-number">0x60705F0</span>]<br>flag=<span class="hljs-string">&#x27;&#x27;</span><br>buf1 = []<br><span class="hljs-keyword">for</span> num <span class="hljs-keyword">in</span> buf:<br>    bytes_data = num.to_bytes(<span class="hljs-number">4</span>, byteorder=<span class="hljs-string">&#x27;little&#x27;</span>)<br>    <span class="hljs-keyword">for</span> byte <span class="hljs-keyword">in</span> bytes_data:<br>        buf1.append(<span class="hljs-built_in">hex</span>(byte))<br><span class="hljs-comment">#print(buf1)</span><br><span class="hljs-keyword">for</span> num <span class="hljs-keyword">in</span> buf1:<br>    tmp=((<span class="hljs-built_in">int</span>(num,<span class="hljs-number">16</span>)+<span class="hljs-number">86</span>)^<span class="hljs-number">0x32</span>)&amp;<span class="hljs-number">0xff</span><br>    flag+=<span class="hljs-built_in">chr</span>(tmp)<br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment">#flag = &#x27;NSSCTF&#123;4ddit1on_is_a_rever5ible_0peration&#125;&#x27;ï¼ˆä¿®æ”¹äº†å‰ç¼€ï¼‰</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>å½“ç„¶å¾—å¤šå­¦ä¸€ç‚¹ï¼Œæ‰€ä»¥æ‰‹æ“v7ï¼Œæ‰¾DSé—®ä¸€ä¸‹æ€ä¹ˆå¤„ç†æ•°æ®ï¼Œå¾—åˆ°å¦‚ä¸Šçš„æ–¹æ³•ã€‚</p>
<ul>
<li><p>ç”¨to_bytesæŠŠv7çš„æ•°è½¬æˆå­—èŠ‚å½¢å¼ï¼ŒbyteorderæŒ‡å®šäº†å°ç«¯åºï¼Œç„¶åhexè½¬æ¢æˆåå…­è¿›åˆ¶æ•°å­˜å…¥æ–°åˆ—è¡¨ã€‚è‡³äºä¸ºä»€ä¹ˆè¦è½¬æˆåå…­è¿›åˆ¶æ•°ï¼Œå’Œä¸‹é¢çš„ä»£ç æœ‰å…³ã€‚</p>
</li>
<li><p>ç„¶åç”¨æ–°åˆ—è¡¨çš„å…ƒç´ è¿›è¡Œé€†è¿ç®—ã€‚å› ä¸ºç›´æ¥ä½¿ç”¨è¿™äº›å…ƒç´ ä¼šè¢«åˆ¤æˆå­—ç¬¦ï¼Œæ‰€ä»¥å‰é¢å…ˆè½¬æˆåå…­è¿›åˆ¶æ•°ï¼Œå†ç”¨intè½¬æˆåè¿›åˆ¶æ•°ï¼Œè¿™æ ·å°±å¯ä»¥æ­£å¸¸è¿ç®—äº†</p>
</li>
<li><p>æœ€åè¿˜è¦&amp;0xffï¼Œå› ä¸ºé€†å‡ºæ¥çš„æ•°æ®æœ‰ç‚¹è¶…å‡ºasciiç èŒƒå›´äº†</p>
</li>
<li><p>è¿˜æœ‰å°±æ˜¯ï¼Œè¿™æ ·å¾—å‡ºæ¥çš„flagå…¶å®ç¼ºäº†ä¸€ä¸ªâ€œ } â€ã€‚å›å¤´çœ‹åç¼–è¯‘çš„ä»£ç ï¼Œé‚£ä¸ªæœªå‘½åçš„ç”¨æ¥è¾“å…¥v9çš„å®é™…ä¸Šä¸æ˜¯çº¯ç²¹çš„scanfé‚£æ ·çš„å‡½æ•°ã€‚é‡Œé¢æœ‰ä¸ªFILEæŒ‡é’ˆï¼Œæ¨æµ‹æ˜¯è¯»æ–‡ä»¶çš„å‡½æ•°ã€‚æ‰€ä»¥è¯»å–çš„å†…å®¹ç»“å°¾æŒ‰é“ç†ä¼šæœ‰â€™\0â€™ã€‚ä½†æ˜¯ï¼ŒåŠ ä¸Šäº†â€™\0â€™ç®—å‡ºæ¥çš„flagä¹Ÿæ²¡æœ‰â€™ } â€˜ã€‚æ‰€ä»¥ï¼Œå‡­å¸¸è¯†åŠ ä¸Šâ€™ } â€˜ã€‚</p>
</li>
</ul>
</li>
</ul>
]]></content>
      <categories>
        <category>Reverseå­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>Reverse</tag>
      </tags>
  </entry>
  <entry>
    <title>Day8:thiscallã€ç±»</title>
    <url>/2025/07/21/Day8-%E7%B1%BB/</url>
    <content><![CDATA[<p>thiscallã€ç±»</p>
<span id="more"></span>

<h2 id="è°ƒç”¨çº¦å®šï¼šthiscall"><a href="#è°ƒç”¨çº¦å®šï¼šthiscall" class="headerlink" title="è°ƒç”¨çº¦å®šï¼šthiscall"></a>è°ƒç”¨çº¦å®šï¼šthiscall</h2><ul>
<li>å¯¹äºC++thisæŒ‡é’ˆçš„ç‰¹æ€§ï¼Œæœ‰ä¸€ç§ä¸“é—¨çš„è°ƒç”¨çº¦å®šå«thiscallï¼Œä¸»è¦ç”¨äºç±»å‡ºç°çš„åœºæ™¯</li>
<li>æ— è®ºx86&#x2F;x64ï¼ŒthisæŒ‡é’ˆå‡ç”±ecx&#x2F;rcxæ‰®æ¼”ï¼ŒæŒ‡å‘å¯¹è±¡çš„å†…å­˜åœ°å€</li>
<li>thiscallç”±è¢«è°ƒç”¨è€…æ¸…ç†å‚æ•°å ç”¨çš„æ ˆç©ºé—´</li>
</ul>
<h2 id="ç±»ï¼ˆä¸€ï¼‰"><a href="#ç±»ï¼ˆä¸€ï¼‰" class="headerlink" title="ç±»ï¼ˆä¸€ï¼‰"></a>ç±»ï¼ˆä¸€ï¼‰</h2><ul>
<li><p>ç®€å•çš„æ„é€ ææ„åˆ†æ</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm"><span class="hljs-comment">;mainå‡½æ•°</span><br><span class="hljs-symbol">.text:</span>004641E0 var_EC          = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">0ECh</span><br><span class="hljs-symbol">.text:</span>004641E0 var_30          = <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">30h</span><br><span class="hljs-symbol">.text:</span>004641E0 var_20          = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">20h</span><br><span class="hljs-symbol">.text:</span>004641E0 var_4           = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">4</span><br><span class="hljs-symbol">.text:</span>004641E0<br><span class="hljs-symbol">.text:</span>004641E0                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span>004641E1                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">esp</span><br><span class="hljs-symbol">.text:</span>004641E3                 <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0F0h</span><br><span class="hljs-symbol">.text:</span>004641E9                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ebx</span><br><span class="hljs-symbol">.text:</span>004641EA                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">esi</span><br><span class="hljs-symbol">.text:</span>004641EB                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">edi</span><br><span class="hljs-symbol">.text:</span>004641EC                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">edi</span>, [<span class="hljs-built_in">ebp</span>+var_30]<br><span class="hljs-symbol">.text:</span>004641EF                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-number">0Ch</span><br><span class="hljs-symbol">.text:</span>004641F4                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">0CCCCCCCCh</span><br><span class="hljs-symbol">.text:</span>004641F9                 <span class="hljs-keyword">rep</span> <span class="hljs-keyword">stosd</span><br><span class="hljs-symbol">.text:</span>004641FB                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, ___security_cookie<br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464200</span>                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464202</span>                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_4], <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464205</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, offset unk_54D014<br><span class="hljs-symbol">.text:</span>0046420A                 <span class="hljs-keyword">call</span>    sub_45FF30<br><span class="hljs-symbol">.text:</span>0046420F                 <span class="hljs-keyword">nop</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464210</span>                 <span class="hljs-keyword">push</span>    offset aXiaoming <span class="hljs-comment">; å‚æ•°&quot;xiaoming&quot;</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464215</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-number">1</span>               <span class="hljs-comment">; å¦ä¸€ä¸ªå‚æ•°</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464217</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">ecx</span>, [<span class="hljs-built_in">ebp</span>+var_20] <span class="hljs-comment">; [ebp+var_20]æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒthisæŒ‡é’ˆæŒ‡å‘è¯¥å¯¹è±¡</span><br><span class="hljs-symbol">.text:</span>0046421A                 <span class="hljs-keyword">call</span>    sub_46062E      <span class="hljs-comment">; æ„é€ å‡½æ•°</span><br><span class="hljs-symbol">.text:</span>0046421F                 <span class="hljs-keyword">nop</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464220</span>                 <span class="hljs-keyword">push</span>    offset aPause   <span class="hljs-comment">; &quot;pause&quot;</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464225</span>                 <span class="hljs-keyword">call</span>    sub_45F98B      <span class="hljs-comment">; system</span><br><span class="hljs-symbol">.text:</span>0046422A                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">4</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0046422D</span>                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_EC], <span class="hljs-number">0</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464237</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">ecx</span>, [<span class="hljs-built_in">ebp</span>+var_20] <span class="hljs-comment">; thisæŒ‡é’ˆ</span><br><span class="hljs-symbol">.text:</span>0046423A                 <span class="hljs-keyword">call</span>    sub_45D38E      <span class="hljs-comment">; ææ„å‡½æ•°</span><br><span class="hljs-symbol">.text:</span>0046423F                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_EC]<br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464245</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">edx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464246</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464248</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464249</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">edx</span>, dword_464274<br><span class="hljs-symbol">.text:</span>0046424F                 <span class="hljs-keyword">call</span>    sub_45EC4D<br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464254</span>                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464255</span>                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">edx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464256</span>                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">edi</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464257</span>                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">esi</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464258</span>                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ebx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464259</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, [<span class="hljs-built_in">ebp</span>+var_4]<br><span class="hljs-symbol">.text:</span>0046425C                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-built_in">ebp</span>        <span class="hljs-comment">; StackCookie</span><br><span class="hljs-symbol">.text:</span>0046425E                 <span class="hljs-keyword">call</span>    j_@__security_check_cookie@<span class="hljs-number">4</span> <span class="hljs-comment">; __security_check_cookie(x)</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464263</span>                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0F0h</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464269</span>                 <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">esp</span><br><span class="hljs-symbol">.text:</span>0046426B                 <span class="hljs-keyword">call</span>    sub_45F175<br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464270</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464272</span>                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464273</span>                 <span class="hljs-keyword">retn</span><br><br><span class="hljs-comment">;æ„é€ å‡½æ•°</span><br><span class="hljs-symbol">.text:</span>00463FC0 var_C           = <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">0Ch</span><br><span class="hljs-symbol">.text:</span>00463FC0 var_8           = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span>00463FC0 arg_0           = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span>  <span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span>00463FC0 arg_4           = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span>  <span class="hljs-number">0Ch</span><br><span class="hljs-symbol">.text:</span>00463FC0<br><span class="hljs-symbol">.text:</span>00463FC0                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span>00463FC1                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">esp</span><br><span class="hljs-symbol">.text:</span>00463FC3                 <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0CCh</span><br><span class="hljs-symbol">.text:</span>00463FC9                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ebx</span><br><span class="hljs-symbol">.text:</span>00463FCA                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">esi</span><br><span class="hljs-symbol">.text:</span>00463FCB                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">edi</span><br><span class="hljs-symbol">.text:</span>00463FCC                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ecx</span><br><span class="hljs-symbol">.text:</span>00463FCD                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">edi</span>, [<span class="hljs-built_in">ebp</span>+var_C]<br><span class="hljs-symbol">.text:</span>00463FD0                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-number">3</span><br><span class="hljs-symbol">.text:</span>00463FD5                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">0CCCCCCCCh</span><br><span class="hljs-symbol">.text:</span>00463FDA                 <span class="hljs-keyword">rep</span> <span class="hljs-keyword">stosd</span><br><span class="hljs-symbol">.text:</span>00463FDC                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ecx</span><br><span class="hljs-symbol">.text:</span>00463FDD                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_8], <span class="hljs-built_in">ecx</span> <span class="hljs-comment">; å½“å‰å¯¹è±¡åœ°å€ä¿å­˜åˆ°[ebp+var_8]</span><br><span class="hljs-symbol">.text:</span>00463FE0                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, offset unk_54D014<br><span class="hljs-symbol">.text:</span>00463FE5                 <span class="hljs-keyword">call</span>    sub_45FF30<br><span class="hljs-symbol">.text:</span>00463FEA                 <span class="hljs-keyword">nop</span><br><span class="hljs-symbol">.text:</span>00463FEB                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_8] <span class="hljs-comment">; ç¬¬ä¸€ä¸ªå¯¹è±¡æˆå‘˜</span><br><span class="hljs-symbol">.text:</span>00463FEE                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, [<span class="hljs-built_in">ebp</span>+arg_0] <span class="hljs-comment">; ç¬¬ä¸€ä¸ªå‚æ•°1</span><br><span class="hljs-symbol">.text:</span>00463FF1                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">eax</span>], <span class="hljs-built_in">ecx</span><br><span class="hljs-symbol">.text:</span>00463FF3                 <span class="hljs-keyword">push</span>    <span class="hljs-number">4</span><br><span class="hljs-symbol">.text:</span>00463FF5                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+arg_4] <span class="hljs-comment">; ç¬¬äºŒä¸ªå‚æ•°&quot;xiaoming&quot;</span><br><span class="hljs-symbol">.text:</span>00463FF8                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>00463FF9                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, [<span class="hljs-built_in">ebp</span>+var_8]<br><span class="hljs-symbol">.text:</span>00463FFC                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-number">4</span>          <span class="hljs-comment">; ç¬¬äºŒä¸ªå¯¹è±¡æˆå‘˜</span><br><span class="hljs-symbol">.text:</span>00463FFF                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ecx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464000</span>                 <span class="hljs-keyword">call</span>    sub_45FCF1      <span class="hljs-comment">; memcpy()</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464005</span>                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0Ch</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464008</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_8] <span class="hljs-comment">; è¿”å›çš„æ˜¯å¯¹è±¡åœ°å€</span><br><span class="hljs-symbol">.text:</span>0046400B                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">edi</span><br><span class="hljs-symbol">.text:</span>0046400C                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">esi</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0046400D</span>                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ebx</span><br><span class="hljs-symbol">.text:</span>0046400E                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0CCh</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464014</span>                 <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">esp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464016</span>                 <span class="hljs-keyword">call</span>    sub_45F175<br><span class="hljs-symbol">.text:</span>0046401B                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0046401D</span>                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span>0046401E                 <span class="hljs-keyword">retn</span>    <span class="hljs-number">8</span><br><br><span class="hljs-comment">;ææ„å‡½æ•°</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464040</span> var_C           = <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">0Ch</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464040</span> var_8           = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464040</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464040</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464041</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">esp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464043</span>                 <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0CCh</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464049</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ebx</span><br><span class="hljs-symbol">.text:</span>0046404A                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">esi</span><br><span class="hljs-symbol">.text:</span>0046404B                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">edi</span><br><span class="hljs-symbol">.text:</span>0046404C                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ecx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0046404D</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">edi</span>, [<span class="hljs-built_in">ebp</span>+var_C]<br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464050</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-number">3</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464055</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">0CCCCCCCCh</span><br><span class="hljs-symbol">.text:</span>0046405A                 <span class="hljs-keyword">rep</span> <span class="hljs-keyword">stosd</span><br><span class="hljs-symbol">.text:</span>0046405C                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ecx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0046405D</span>                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_8], <span class="hljs-built_in">ecx</span> <span class="hljs-comment">; æŠŠå¯¹è±¡åœ°å€å­˜åˆ°[ebp+var_8]</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464060</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, offset unk_54D014<br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464065</span>                 <span class="hljs-keyword">call</span>    sub_45FF30<br><span class="hljs-symbol">.text:</span>0046406A                 <span class="hljs-keyword">nop</span><br><span class="hljs-symbol">.text:</span>0046406B                 <span class="hljs-keyword">push</span>    offset aDestructing <span class="hljs-comment">; &quot;destructing......&quot;</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464070</span>                 <span class="hljs-keyword">call</span>    sub_45DB59      <span class="hljs-comment">; printf</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464075</span>                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">4</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464078</span>                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">edi</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464079</span>                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">esi</span><br><span class="hljs-symbol">.text:</span>0046407A                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ebx</span><br><span class="hljs-symbol">.text:</span>0046407B                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0CCh</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464081</span>                 <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">esp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464083</span>                 <span class="hljs-keyword">call</span>    sub_45F175<br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464088</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span>0046408A                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span>0046408B                 <span class="hljs-keyword">retn</span><br></code></pre></td></tr></table></figure>

<p>æºç </p>
<figure class="highlight c++"><table><tr><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;string.h&gt;</span></span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Student</span> &#123;<br><span class="hljs-keyword">private</span>:<br>	<span class="hljs-type">int</span> ID;<br>	<span class="hljs-type">char</span> name[<span class="hljs-number">20</span>];<br><span class="hljs-keyword">public</span>:<br>	<span class="hljs-built_in">Student</span>(<span class="hljs-type">int</span> n = <span class="hljs-number">0</span>, <span class="hljs-type">const</span> <span class="hljs-type">char</span>* na = <span class="hljs-string">&quot;NONE&quot;</span>) :<span class="hljs-built_in">ID</span>(n) &#123;<br>		<span class="hljs-built_in">memcpy</span>(name, na, <span class="hljs-built_in">sizeof</span>(na));<br>	&#125;<br>	<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">show</span><span class="hljs-params">()</span></span>;<br>	~<span class="hljs-built_in">Student</span>();<br>&#125;;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">Student::show</span><span class="hljs-params">()</span> </span>&#123;<br>	<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d %s\n&quot;</span>, ID, name);<br>&#125;<br>Student::~<span class="hljs-built_in">Student</span>() &#123;<br>	<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;destructing......&quot;</span>);<br>&#125;<br><span class="hljs-function"><span class="hljs-type">int</span>  <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>	<span class="hljs-function">Student <span class="hljs-title">stu</span><span class="hljs-params">(<span class="hljs-number">001</span>, <span class="hljs-string">&quot;xiaoming&quot;</span>)</span></span>;<br>	<span class="hljs-built_in">system</span>(<span class="hljs-string">&quot;pause&quot;</span>);<br>	<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
]]></content>
      <categories>
        <category>Reverseå­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>Reverse</tag>
      </tags>
  </entry>
  <entry>
    <title>week27-week30</title>
    <url>/2025/09/08/week27-week30/</url>
    <content><![CDATA[<p>2025å¹´9æœˆç¯‡</p>
<span id="more"></span>

<h2 id="week27-2025-9-1-2025-9-7"><a href="#week27-2025-9-1-2025-9-7" class="headerlink" title="week27 (2025.9.1-2025.9.7)"></a>week27 (2025.9.1-2025.9.7)</h2><ul>
<li>æ¥ä¸‹æ¥æ‰“ç®—æŠŠå‘¨è®°åˆ†æˆå››å‘¨ä¸€ç¯‡äº†ï¼Œæ¯å‘¨ç…§æ ·æ›´æ–°ï¼Œä½†æ˜¯å››å‘¨ä¸€ç¯‡æ–‡ç« </li>
<li>è¿™å‘¨ï¼ˆå…¶å®æ˜¯ä¸Šå‘¨ï¼Œè¿™æ®µæ˜¯è¡¥çš„ï¼‰æŠŠåšå®¢ä¸»é¢˜ç»™æ¢äº†ã€‚åŸå…ˆæƒ³ç€å…ˆé…ç½®å®Œï¼Œåˆ°æ—¶å€™ç›´æ¥æŠŠæ–‡ç« ç§»åˆ°æ–°çš„åšå®¢æ–‡ä»¶é‡Œï¼Œä½†æ˜¯è¿›åº¦å¤ªæ…¢äº†ã€‚è¿™å‘¨ç›´æ¥ç»™åŸåšå®¢æ¢çš®ğŸ˜‹è¿˜æ›´äº†ä¸€ç¯‡åšå®¢,çœŸå¥½ğŸ˜‹(è™½ç„¶è¿˜æ˜¯AIå‡ºåŠ›)</li>
<li>moe week4ä¸Šæ–°é¢˜äº†,ä½†æ˜¯week3ç”šè‡³week2è¿˜æœ‰æ²¡å†™å®Œçš„é¢˜</li>
<li>å®‰å“è¿™å—çš„ç¬”è®°è¿˜æ²¡æ›´,å¼€å­¦äº†æ‰¾æ‰¾æ—¶é—´è¡¥ä¸Š</li>
</ul>
<h2 id="week28-2025-9-8-2025-9-14"><a href="#week28-2025-9-8-2025-9-14" class="headerlink" title="week28 (2025.9.8-2025.9.14)"></a>week28 (2025.9.8-2025.9.14)</h2><ul>
<li>å¥½çš„æ‰‹å¿™è„šä¹±çš„å¼€å­¦ç¬¬ä¸€å‘¨ï¼Œç›®å‰å­¦ä¹ è®¡åˆ’æœ‰å¾…æ›´æ–°ã€‚</li>
<li>è¿™å‘¨å’ŒX2cçš„æ–°å¸ˆå‚…ä»¬ç»„é˜Ÿå‚åŠ äº†æ¹¾åŒºæ¯ï¼Œç‹¬ç«‹è§£å‡ºäº†ä¸€é“é¢˜ï¼Œè¿˜æ˜¯å¤ªèœäº†ã€‚è€ƒå¯Ÿæ–¹å‘è¿˜æŒºå…¨é¢ï¼Œpcç«¯ã€å®‰å“ç”šè‡³å¾®ä¿¡å°ç¨‹åºéƒ½æœ‰ã€‚</li>
</ul>
<h2 id="week29-2025-9-15-2025-9-21"><a href="#week29-2025-9-15-2025-9-21" class="headerlink" title="week29 (2025.9.15-2025.9.21)"></a>week29 (2025.9.15-2025.9.21)</h2><ul>
<li>è¿™å‘¨æœ‰ä¸ªé•¿åŸæ¯ï¼ˆè¿˜æœ‰ä¸ªé“äººä¸‰é¡¹é•¿åŸæ¯ï¼Œè¿™ä¿©å¥½åƒä¸æ˜¯ä¸€ä¸ªï¼‰ï¼Œåªåˆ†webã€AIå®‰å…¨ã€æ•°æ®å®‰å…¨ä¸‰ä¸ªæ–¹å‘ï¼Œæ²¡åšå‡ºæ¥ï¼Œçˆ†0äº†</li>
<li>å¼€å­¦äº†å­¦ä¹ çŠ¶æ€åˆå¼€å§‹ä¸ç¨³å®šäº†ï¼Œè€æ˜¯å·æ‡’ä¸æ‰¾æ—¶é—´å­¦ğŸ˜–è¿™å­¦æœŸå¥½å‡ é—¨æ•°å­¦ç›¸å…³è¯¾ï¼Œè¦ç‡ƒå°½äº†</li>
<li>ç»™åšå®¢æ–°å¼€äº†æ•°æ®ç»“æ„åˆ†ç±»ï¼Œèƒ½ä¸èƒ½æ›´ä¸‹å»çœ‹é€ åŒ–äº†(</li>
</ul>
<h2 id="week30-2025-9-22-2025-9-28"><a href="#week30-2025-9-22-2025-9-28" class="headerlink" title="week30 (2025.9.22-2025.9.28)"></a>week30 (2025.9.22-2025.9.28)</h2><ul>
<li>è¿™å‘¨åˆæ˜¯æ²¡æœ‰æ–°çŸ¥è¯†çš„ä¸€å‘¨</li>
<li>å‘¨å…­åˆå¹²æ‰ä¸€é“moectfçš„é¢˜ï¼Œåªå‰©æœ€åä¸€é“week2çš„upx_revengeäº†ï¼Œå®åœ¨æ²¡æ‹›äº†ğŸ˜–</li>
<li>æ„Ÿè§‰è¿˜æ˜¯æ²¡æ‰¾åˆ°å­¦ä¸šå’Œæ¯”èµ›çš„å¹³è¡¡ç‚¹ï¼Œè¿™æ ·ä¸‹å»ææ€•ä¸€å­¦æœŸå­¦çš„éƒ½æ²¡æœ‰ä¸€ä¸ªæš‘å‡å¤šğŸ˜–ä¸å¾—ä¸åæ§½ä¸ºä»€ä¹ˆä¹±ä¸ƒå…«ç³Ÿçš„è¯¾è¿™ä¹ˆå¤šå•ŠğŸ˜–</li>
</ul>
]]></content>
      <categories>
        <category>å‘¨è®°</category>
      </categories>
      <tags>
        <tag>å‘¨è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>icarusä¸»é¢˜ä¼˜åŒ–</title>
    <url>/2025/09/02/icarus%E4%B8%BB%E9%A2%98%E4%BC%98%E5%8C%96/</url>
    <content><![CDATA[<p>icarusä¸»é¢˜å¤åˆ¶åŠŸèƒ½é‡æ„ï¼ˆä»¿ç…§nextä¸»é¢˜ï¼‰ã€firebaseç»Ÿè®¡é˜…è¯»äººæ•°</p>
<span id="more"></span>

<h2 id="å¤åˆ¶åŠŸèƒ½é‡æ„"><a href="#å¤åˆ¶åŠŸèƒ½é‡æ„" class="headerlink" title="å¤åˆ¶åŠŸèƒ½é‡æ„"></a>å¤åˆ¶åŠŸèƒ½é‡æ„</h2><ul>
<li><p>icarusä¸»é¢˜è‡ªå¸¦çš„å¤åˆ¶åŠŸèƒ½æ˜¯å¸¦æ–‡å­—é€‰ä¸­çš„ï¼ˆå¦‚ä¸‹å›¾ï¼‰ï¼Œä¸ªäººæ„Ÿè§‰éº»çƒ¦äº†ç‚¹ï¼Œäºæ˜¯è€ƒè™‘å€Ÿé‰´nextçš„å¤åˆ¶é£æ ¼ï¼Œä¸€é”®å¤åˆ¶</p>
<p><img src="/../images/image-20250902231901036.png" alt="å®˜ç½‘æŒ‡å—æˆªå›¾"></p>
</li>
<li><p>å®ç°ï¼š</p>
<p>hexo-theme-icarus&#x2F;source&#x2F;js&#x2F;main.jsï¼š</p>
<figure class="highlight diff"><table><tr><td class="code"><pre><code class="hljs diff">        if (clipboard) &#123;<br><span class="hljs-deletion">-           new ClipboardJS(&#x27;.highlight .copy&#x27;, &#123;</span><br><span class="hljs-deletion">-               target: function(trigger) &#123;</span><br><span class="hljs-deletion">-                   return trigger.parentNode.nextElementSibling;</span><br><span class="hljs-deletion">-               &#125;</span><br><span class="hljs-deletion">-           &#125;).on(&#x27;success&#x27;, function(e) &#123;</span><br><span class="hljs-deletion">-               e.clearSelection();</span><br><span class="hljs-deletion">-               const tmp = e.trigger.innerHTML;</span><br><span class="hljs-deletion">-               e.trigger.innerHTML = &#x27;&lt;i class=&quot;fas fa-check&quot;&gt;&lt;/i&gt;&#x27;;</span><br><span class="hljs-deletion">-               setTimeout(function() &#123;</span><br><span class="hljs-deletion">-                   e.trigger.innerHTML = tmp;</span><br><span class="hljs-deletion">-               &#125;, 2000);</span><br><span class="hljs-deletion">-           &#125;);</span><br><span class="hljs-addition">+           $(&#x27;figure.highlight&#x27;).each(function() &#123;</span><br><span class="hljs-addition">+               const target = $(this).find(&#x27;figcaption div.level-right&#x27;)[0];</span><br><span class="hljs-addition">+               if (target) &#123;</span><br><span class="hljs-addition">+                   registerCopyButton(target, this);</span><br><span class="hljs-addition">+               &#125;</span><br><span class="hljs-addition">+           &#125;);</span><br>        &#125;<br>        <br><span class="hljs-comment">----------------------------------------------------------------------------------</span><br><br>...<br><br>    $(&#x27;.article &gt; .content &gt; table&#x27;).each(function() &#123;<br>        if ($(this).width() &gt; $(this).parent().width()) &#123;<br>            $(this).wrap(&#x27;&lt;div class=&quot;table-overflow&quot;&gt;&lt;/div&gt;&#x27;);<br>        &#125;<br>    &#125;);<br><br><span class="hljs-addition">+    // æ³¨å†Œå¤åˆ¶æŒ‰é’®åŠŸèƒ½ï¼Œä»¿ç…§Nextä¸»é¢˜å®ç°</span><br><span class="hljs-addition">+    function registerCopyButton(target, element) &#123;</span><br><span class="hljs-addition">+        // æ·»åŠ å¤åˆ¶æŒ‰é’®</span><br><span class="hljs-addition">+        target.insertAdjacentHTML(&#x27;beforeend&#x27;, &#x27;&lt;a href=&quot;javascript:;&quot; class=&quot;copy&quot; title=&quot;Copy&quot;&gt;&lt;i class=&quot;fas fa-copy&quot;&gt;&lt;/i&gt;&lt;/a&gt;&#x27;);</span><br><span class="hljs-addition">+        const button = target.querySelector(&#x27;.copy&#x27;);</span><br><span class="hljs-addition">+        </span><br><span class="hljs-addition">+        button.addEventListener(&#x27;click&#x27;, function() &#123;</span><br><span class="hljs-addition">+            const code = element.querySelector(&#x27;.code&#x27;).innerText;</span><br><span class="hljs-addition">+            </span><br><span class="hljs-addition">+            if (navigator.clipboard) &#123;</span><br><span class="hljs-addition">+                // ä½¿ç”¨ç°ä»£çš„Clipboard API</span><br><span class="hljs-addition">+                navigator.clipboard.writeText(code).then(function() &#123;</span><br><span class="hljs-addition">+                    button.querySelector(&#x27;i&#x27;).className = &#x27;fas fa-check-circle&#x27;;</span><br><span class="hljs-addition">+                &#125;, function() &#123;</span><br><span class="hljs-addition">+                    button.querySelector(&#x27;i&#x27;).className = &#x27;fas fa-times-circle&#x27;;</span><br><span class="hljs-addition">+                &#125;);</span><br><span class="hljs-addition">+            &#125; else &#123;</span><br><span class="hljs-addition">+                // å…¼å®¹æ€§å›é€€æ–¹æ¡ˆ</span><br><span class="hljs-addition">+                const ta = document.createElement(&#x27;textarea&#x27;);</span><br><span class="hljs-addition">+                ta.style.top = window.scrollY + &#x27;px&#x27;;</span><br><span class="hljs-addition">+                ta.style.position = &#x27;absolute&#x27;;</span><br><span class="hljs-addition">+                ta.style.opacity = &#x27;0&#x27;;</span><br><span class="hljs-addition">+                ta.readOnly = true;</span><br><span class="hljs-addition">+                ta.value = code;</span><br><span class="hljs-addition">+                document.body.append(ta);</span><br><span class="hljs-addition">+                ta.select();</span><br><span class="hljs-addition">+                ta.setSelectionRange(0, code.length);</span><br><span class="hljs-addition">+                ta.readOnly = false;</span><br><span class="hljs-addition">+                const result = document.execCommand(&#x27;copy&#x27;);</span><br><span class="hljs-addition">+                button.querySelector(&#x27;i&#x27;).className = result ? &#x27;fas fa-check-circle&#x27; : &#x27;fas fa-times-circle&#x27;;</span><br><span class="hljs-addition">+                ta.blur();</span><br><span class="hljs-addition">+                button.blur();</span><br><span class="hljs-addition">+                document.body.removeChild(ta);</span><br><span class="hljs-addition">+            &#125;</span><br><span class="hljs-addition">+        &#125;);</span><br><span class="hljs-addition">+        </span><br><span class="hljs-addition">+        // é¼ æ ‡ç¦»å¼€300msåæ¢å¤å¤åˆ¶å›¾æ ‡</span><br><span class="hljs-addition">+        element.addEventListener(&#x27;mouseleave&#x27;, function() &#123;</span><br><span class="hljs-addition">+            setTimeout(function() &#123;</span><br><span class="hljs-addition">+                const icon = button.querySelector(&#x27;i&#x27;);</span><br><span class="hljs-addition">+                if (icon) &#123;</span><br><span class="hljs-addition">+                    icon.className = &#x27;fas fa-copy&#x27;;</span><br><span class="hljs-addition">+                &#125;</span><br><span class="hljs-addition">+            &#125;, 300);</span><br><span class="hljs-addition">+        &#125;);</span><br><span class="hljs-addition">+    &#125;</span><br><br>    function adjustNavbar() &#123;<br>        const navbarWidth = $(&#x27;.navbar-main .navbar-start&#x27;).outerWidth() + $(&#x27;.navbar-main .navbar-end&#x27;).outerWidth();<br>        if ($(document).outerWidth() &lt; navbarWidth) &#123;<br>            $(&#x27;.navbar-main .navbar-menu&#x27;).addClass(&#x27;justify-content-start&#x27;);<br>        &#125; else &#123;<br>            $(&#x27;.navbar-main .navbar-menu&#x27;).removeClass(&#x27;justify-content-start&#x27;);<br>        &#125;<br>    &#125;<br></code></pre></td></tr></table></figure>

<p>hexo-theme-icarus&#x2F;layout&#x2F;common&#x2F;scripts.jsx</p>
<figure class="highlight diff"><table><tr><td class="code"><pre><code class="hljs diff">           return &lt;Fragment&gt;<br>            &lt;script src=&#123;cdn(&#x27;jquery&#x27;, &#x27;3.3.1&#x27;, &#x27;dist/jquery.min.js&#x27;)&#125;&gt;&lt;/script&gt;<br>            &lt;script src=&#123;cdn(&#x27;moment&#x27;, &#x27;2.22.2&#x27;, &#x27;min/moment-with-locales.min.js&#x27;)&#125;&gt;&lt;/script&gt;<br>            &lt;script dangerouslySetInnerHTML=&#123;&#123; __html: `moment.locale(&quot;$&#123;language&#125;&quot;);` &#125;&#125;&gt;&lt;/script&gt;<br>            &lt;script dangerouslySetInnerHTML=&#123;&#123; __html: embeddedConfig &#125;&#125;&gt;&lt;/script&gt;<br>            &lt;script data-pjax src=&#123;url_for(&#x27;/js/column.js&#x27;)&#125;&gt;&lt;/script&gt;<br>            &lt;Plugins site=&#123;site&#125; config=&#123;config&#125; page=&#123;page&#125; helper=&#123;helper&#125; head=&#123;false&#125; /&gt;<br><span class="hljs-deletion">-           &#123;clipboard &amp;&amp; &lt;script src=&#123;cdn(&#x27;clipboard&#x27;, &#x27;2.0.4&#x27;, &#x27;dist/clipboard.min.js&#x27;)&#125; defer&gt;&lt;/script&gt;&#125;</span><br>            &lt;script data-pjax src=&#123;url_for(&#x27;/js/main.js&#x27;)&#125; defer&gt;&lt;/script&gt;<br>        &lt;/Fragment&gt;;<br></code></pre></td></tr></table></figure></li>
</ul>
<h2 id="ä½¿ç”¨firebaseç»Ÿè®¡é˜…è¯»äººæ•°"><a href="#ä½¿ç”¨firebaseç»Ÿè®¡é˜…è¯»äººæ•°" class="headerlink" title="ä½¿ç”¨firebaseç»Ÿè®¡é˜…è¯»äººæ•°"></a>ä½¿ç”¨firebaseç»Ÿè®¡é˜…è¯»äººæ•°</h2><h3 id="configæ–‡ä»¶æ·»åŠ é…ç½®"><a href="#configæ–‡ä»¶æ·»åŠ é…ç½®" class="headerlink" title="configæ–‡ä»¶æ·»åŠ é…ç½®"></a>configæ–‡ä»¶æ·»åŠ é…ç½®</h3><p>_config.icarus.yml</p>
<figure class="highlight diff"><table><tr><td class="code"><pre><code class="hljs diff"><span class="hljs-addition">+# Firebase Firestore é˜…è¯»äººæ•°ç»Ÿè®¡</span><br><span class="hljs-addition">+services:</span><br><span class="hljs-addition">+    firebase:</span><br><span class="hljs-addition">+        enable: true</span><br><span class="hljs-addition">+        collection: articles # Firestoreæ•°æ®åº“ä¸­çš„é›†åˆåç§°</span><br><span class="hljs-addition">+        apiKey:  # ä½ çš„Firebase API Key</span><br><span class="hljs-addition">+        projectId:  # ä½ çš„Firebaseé¡¹ç›®ID</span><br></code></pre></td></tr></table></figure>

<h3 id="æ–‡ç« headå¢åŠ äººæ•°ç»Ÿè®¡"><a href="#æ–‡ç« headå¢åŠ äººæ•°ç»Ÿè®¡" class="headerlink" title="æ–‡ç« headå¢åŠ äººæ•°ç»Ÿè®¡"></a>æ–‡ç« headå¢åŠ äººæ•°ç»Ÿè®¡</h3><p>hexo-theme-icarus&#x2F;layout&#x2F;common&#x2F;articles.jsx</p>
<figure class="highlight diff"><table><tr><td class="code"><pre><code class="hljs diff">                            &#123;/* Visitor counter */&#125;                            <br>                            &#123;!index &amp;&amp; plugins &amp;&amp; plugins.busuanzi <span class="hljs-comment">=== true ? &lt;span class=&quot;level-item&quot; id=&quot;busuanzi_container_page_pv&quot; dangerouslySetInnerHTML=&#123;&#123;</span><br>                                __html: _p(&#x27;plugin.visit_count&#x27;, &#x27;&lt;span id=&quot;busuanzi_value_page_pv&quot;&gt;0&lt;/span&gt;&#x27;)<br>                            &#125;&#125;&gt;&lt;/span&gt; : null&#125;<br><span class="hljs-addition">+                           &#123;/* Firebase Visitor counter */&#125;</span><br><span class="hljs-addition">+                           &#123;config.services &amp;&amp; config.services.firebase &amp;&amp; config.services.firebase.enable ? &lt;span class=&quot;level-item&quot;&gt;</span><br><span class="hljs-addition">+                               &lt;i class=&quot;far fa-eye mr-1&quot;&gt;&lt;/i&gt;</span><br><span class="hljs-addition">+                               &lt;span class=&quot;firestore-visitors-count&quot;&gt;0&lt;/span&gt;</span><br><span class="hljs-addition">+                           &lt;/span&gt; : null&#125;</span><br></code></pre></td></tr></table></figure>

<h3 id="åŸºäºfirebaseçš„ç»Ÿè®¡åŠŸèƒ½å®ç°"><a href="#åŸºäºfirebaseçš„ç»Ÿè®¡åŠŸèƒ½å®ç°" class="headerlink" title="åŸºäºfirebaseçš„ç»Ÿè®¡åŠŸèƒ½å®ç°"></a>åŸºäºfirebaseçš„ç»Ÿè®¡åŠŸèƒ½å®ç°</h3><p>source&#x2F;js&#x2F;firebase_counter.jsï¼ˆæ–°å»ºï¼‰</p>
<figure class="highlight diff"><table><tr><td class="code"><pre><code class="hljs diff"><span class="hljs-addition">+/* global IcarusThemeSettings, firebase */</span><br><span class="hljs-addition">+</span><br><span class="hljs-addition">+// Firebase Counter - é˜…è¯»é‡ç»Ÿè®¡åŠŸèƒ½</span><br><span class="hljs-addition">+</span><br><span class="hljs-addition">+if (IcarusThemeSettings &amp;&amp; IcarusThemeSettings.services &amp;&amp; IcarusThemeSettings.services.firebase &amp;&amp; IcarusThemeSettings.services.firebase.enable) &#123;</span><br><span class="hljs-addition">+    </span><br><span class="hljs-addition">+    // åˆå§‹åŒ–Firebase</span><br><span class="hljs-addition">+    try &#123;</span><br><span class="hljs-addition">+        // ç¡®ä¿firebaseå¯¹è±¡å­˜åœ¨</span><br><span class="hljs-addition">+        if (typeof firebase === &#x27;undefined&#x27;) &#123;</span><br><span class="hljs-addition">+            console.error(&#x27;Firebase library not loaded&#x27;);</span><br><span class="hljs-addition">+            // å¦‚æœFirebaseåº“æœªåŠ è½½ï¼Œéšè—è®¡æ•°å™¨å…ƒç´ </span><br><span class="hljs-addition">+            document.querySelectorAll(&#x27;.firestore-visitors-count&#x27;).forEach(el =&gt; &#123;</span><br><span class="hljs-addition">+                el.style.display = &#x27;none&#x27;;</span><br><span class="hljs-addition">+            &#125;);</span><br><span class="hljs-addition">+        &#125; else &#123;</span><br><span class="hljs-addition">+            </span><br><span class="hljs-addition">+            firebase.initializeApp(&#123;</span><br><span class="hljs-addition">+                apiKey: IcarusThemeSettings.services.firebase.apiKey,</span><br><span class="hljs-addition">+                projectId: IcarusThemeSettings.services.firebase.projectId</span><br><span class="hljs-addition">+            &#125;);</span><br><span class="hljs-addition">+            </span><br><span class="hljs-addition">+            // å¼€å‘ç¯å¢ƒæ£€æµ‹</span><br><span class="hljs-addition">+            const isLocalhost = [&#x27;localhost&#x27;, &#x27;127.0.0.1&#x27;].includes(window.location.hostname);</span><br><span class="hljs-addition">+            const isDevelopment = isLocalhost || window.location.hostname.includes(&#x27;192.168.&#x27;);</span><br><span class="hljs-addition">+            </span><br><span class="hljs-addition">+            // ç§»é™¤æ‰€æœ‰è°ƒè¯•æ—¥å¿—è¾“å‡º</span><br><span class="hljs-addition">+            </span><br><span class="hljs-addition">+            // è·å–æ•°æ®åº“å¼•ç”¨</span><br><span class="hljs-addition">+            const db = firebase.firestore();</span><br><span class="hljs-addition">+            const articlesCollection = IcarusThemeSettings.services.firebase.collection || &#x27;articles&#x27;;</span><br><span class="hljs-addition">+            const articles = db.collection(articlesCollection);</span><br><span class="hljs-addition">+            </span><br><span class="hljs-addition">+            // è·å–é˜…è¯»æ¬¡æ•°å‡½æ•°</span><br><span class="hljs-addition">+            const getCount = (doc, increaseCount) =&gt; &#123;</span><br><span class="hljs-addition">+                // è·å–æ–‡æ¡£æ•°æ®</span><br><span class="hljs-addition">+                return doc.get().then(d =&gt; &#123;</span><br><span class="hljs-addition">+                    // åˆå§‹åŒ–è®¡æ•°</span><br><span class="hljs-addition">+                    let count = d.exists ? d.data().count : 0;</span><br><span class="hljs-addition">+                    </span><br><span class="hljs-addition">+                    // å¦‚æœéœ€è¦å¢åŠ è®¡æ•°ï¼ˆåªåœ¨æ–‡ç« é¡µé¢ä¸”æœªåœ¨åŒä¸€ä¼šè¯è®¿é—®è¿‡ï¼‰</span><br><span class="hljs-addition">+                    if (increaseCount) &#123;</span><br><span class="hljs-addition">+                        // å¢åŠ è®¡æ•°</span><br><span class="hljs-addition">+                        count++;</span><br><span class="hljs-addition">+                        return doc.set(&#123; count &#125;).then(() =&gt; &#123;</span><br><span class="hljs-addition">+                            if (isDevelopment) console.log(&#x27;è®¡æ•°å·²æ›´æ–°:&#x27;, count);</span><br><span class="hljs-addition">+                            return count;</span><br><span class="hljs-addition">+                        &#125;).catch(error =&gt; &#123;</span><br><span class="hljs-addition">+                            console.error(&#x27;Error updating count:&#x27;, error);</span><br><span class="hljs-addition">+                            return count; // è¿”å›å¢åŠ å‰çš„è®¡æ•°</span><br><span class="hljs-addition">+                        &#125;);</span><br><span class="hljs-addition">+                    &#125;</span><br><span class="hljs-addition">+                    </span><br><span class="hljs-addition">+                    return count;</span><br><span class="hljs-addition">+                &#125;).catch(error =&gt; &#123;</span><br><span class="hljs-addition">+                    console.error(&#x27;Error getting count:&#x27;, error);</span><br><span class="hljs-addition">+                    // å‡ºé”™æ—¶è¿”å›é»˜è®¤å€¼0</span><br><span class="hljs-addition">+                    return 0;</span><br><span class="hljs-addition">+                &#125;);</span><br><span class="hljs-addition">+            &#125;;</span><br><span class="hljs-addition">+</span><br><span class="hljs-addition">+            // å¤„ç†é˜…è¯»è®¡æ•°çš„å‡½æ•°</span><br><span class="hljs-addition">+            const handleViewCount = () =&gt; &#123;</span><br><span class="hljs-addition">+                // è·å–å½“å‰URLè·¯å¾„</span><br><span class="hljs-addition">+                const currentPath = window.location.pathname;</span><br><span class="hljs-addition">+                </span><br><span class="hljs-addition">+                // å¢å¼ºé¦–é¡µè¯†åˆ«ï¼šä½¿ç”¨å¤šä¸ªå¯èƒ½çš„é€‰æ‹©å™¨</span><br><span class="hljs-addition">+                const isIndexPage = document.querySelector(&#x27;.article-list&#x27;) !== null ||</span><br><span class="hljs-addition">+                                   document.querySelector(&#x27;.article-card-list&#x27;) !== null ||</span><br><span class="hljs-addition">+                                   document.querySelectorAll(&#x27;.article-card&#x27;).length &gt; 0 || // é™ä½é˜ˆå€¼ä»¥é€‚åº”é¦–é¡µ</span><br><span class="hljs-addition">+                                   (currentPath === &#x27;/&#x27; &amp;&amp; document.querySelector(&#x27;article.article&#x27;) !== null); // ç‰¹æ®Šå¤„ç†ï¼šæ ¹è·¯å¾„+article.articleå…ƒç´ </span><br><span class="hljs-addition">+                </span><br><span class="hljs-addition">+                // å¢å¼ºæ–‡ç« é¡µé¢è¯†åˆ«ï¼šä½¿ç”¨æ›´ç²¾ç¡®çš„é€‰æ‹©å™¨ç»„åˆ</span><br><span class="hljs-addition">+                // é‡è¦ï¼šé¦–é¡µä¼˜å…ˆåˆ¤æ–­ï¼Œä¸”æ–‡ç« é¡µåˆ¤æ–­è¦æ’é™¤é¦–é¡µçš„æƒ…å†µï¼Œå¹¶å¢åŠ ç‰¹å®šçš„æ–‡ç« é¡µç‰¹å¾</span><br><span class="hljs-addition">+                const isArticlePage = !isIndexPage &amp;&amp; (</span><br><span class="hljs-addition">+                    // ä¼ ç»Ÿæ–‡ç« é¡µé€‰æ‹©å™¨</span><br><span class="hljs-addition">+                    (document.querySelector(&#x27;.article-container&#x27;) !== null &amp;&amp; document.querySelector(&#x27;.article-content&#x27;) !== null) ||</span><br><span class="hljs-addition">+                    (document.querySelector(&#x27;article.post&#x27;) !== null &amp;&amp; document.querySelector(&#x27;.article-content&#x27;) !== null) ||</span><br><span class="hljs-addition">+                    document.querySelector(&#x27;[id=&quot;post-content&quot;]&#x27;) !== null ||</span><br><span class="hljs-addition">+                    // é’ˆå¯¹hexo sç¯å¢ƒçš„å¢å¼ºé€‰æ‹©å™¨ï¼Œä½†éœ€è¦ç¡®ä¿ä¸æ˜¯é¦–é¡µ</span><br><span class="hljs-addition">+                    (document.querySelector(&#x27;article.article&#x27;) !== null &amp;&amp; </span><br><span class="hljs-addition">+                     document.querySelector(&#x27;article.card-content.article&#x27;) !== null &amp;&amp;</span><br><span class="hljs-addition">+                     document.querySelectorAll(&#x27;.article-card&#x27;).length === 0 &amp;&amp;</span><br><span class="hljs-addition">+                     currentPath !== &#x27;/&#x27;)</span><br><span class="hljs-addition">+                );</span><br><span class="hljs-addition">+                                    </span><br><span class="hljs-addition">+                // é¡µé¢ç±»å‹ä¿¡æ¯ - ä»…åœ¨å¼€å‘ç¯å¢ƒæ˜¾ç¤º</span><br><span class="hljs-addition">+                if (isDevelopment) &#123;</span><br><span class="hljs-addition">+                    console.log(`[Firebase] å½“å‰é¡µé¢ç±»å‹: $&#123;isArticlePage ? &#x27;æ–‡ç« é¡µ&#x27; : isIndexPage ? &#x27;é¦–é¡µ&#x27; : &#x27;å…¶ä»–é¡µé¢&#x27;&#125;`);</span><br><span class="hljs-addition">+                &#125;</span><br><span class="hljs-addition">+</span><br><span class="hljs-addition">+                if (isArticlePage) &#123;</span><br><span class="hljs-addition">+                    // æ–‡ç« é¡µé¢å¤„ç†</span><br><span class="hljs-addition">+                    const titleElement = document.querySelector(&#x27;.title.is-3, .title.is-4-mobile&#x27;);</span><br><span class="hljs-addition">+                    const countElement = document.querySelector(&#x27;.firestore-visitors-count&#x27;);</span><br><span class="hljs-addition">+                    </span><br><span class="hljs-addition">+                    if (titleElement &amp;&amp; countElement) &#123;</span><br><span class="hljs-addition">+                        const title = titleElement.textContent.trim();</span><br><span class="hljs-addition">+                        const doc = articles.doc(title);</span><br><span class="hljs-addition">+                        </span><br><span class="hljs-addition">+                        // ç¡®å®šæ˜¯å¦å¢åŠ è®¡æ•°ï¼šä¸åœ¨æœ¬åœ°å¼€å‘ç¯å¢ƒä¸”åŒä¸€ä¼šè¯æœªè®¿é—®è¿‡</span><br><span class="hljs-addition">+                        let increaseCount = !isDevelopment;</span><br><span class="hljs-addition">+                        </span><br><span class="hljs-addition">+                        if (sessionStorage.getItem(title)) &#123;</span><br><span class="hljs-addition">+                            increaseCount = false;</span><br><span class="hljs-addition">+                        &#125; else &#123;</span><br><span class="hljs-addition">+                            // æ ‡è®°ä¸ºåœ¨å½“å‰ä¼šè¯ä¸­å·²è®¿é—®</span><br><span class="hljs-addition">+                            sessionStorage.setItem(title, true);</span><br><span class="hljs-addition">+                        &#125;</span><br><span class="hljs-addition">+                        </span><br><span class="hljs-addition">+                        getCount(doc, increaseCount).then(count =&gt; &#123;</span><br><span class="hljs-addition">+                            countElement.innerText = count;</span><br><span class="hljs-addition">+                        &#125;).catch(e =&gt; &#123;</span><br><span class="hljs-addition">+                            // ç§»é™¤é”™è¯¯æ—¥å¿—</span><br><span class="hljs-addition">+                        &#125;);</span><br><span class="hljs-addition">+                    &#125; else &#123;</span><br><span class="hljs-addition">+                        // é™é»˜å¤„ç†ï¼šæœªæ‰¾åˆ°æ–‡ç« æ ‡é¢˜æˆ–è®¡æ•°å…ƒç´ </span><br><span class="hljs-addition">+                    &#125;</span><br><span class="hljs-addition">+                &#125; else if (isIndexPage) &#123;</span><br><span class="hljs-addition">+                    // é¦–é¡µæ–‡ç« åˆ—è¡¨å¤„ç†</span><br><span class="hljs-addition">+                    // ä¿®æ”¹é€‰æ‹©å™¨ä»¥åŒ¹é…å®é™…HTMLç»“æ„</span><br><span class="hljs-addition">+                    // é¦–é¡µæ–‡ç« ç»“æ„: .card &gt; .card-content.article &gt; .title.is-3.is-size-4-mobile</span><br><span class="hljs-addition">+                    const titleElements = document.querySelectorAll(</span><br><span class="hljs-addition">+                        &#x27;.card .article .title.is-3, .card .article .title.is-4-mobile, &#x27; +</span><br><span class="hljs-addition">+                        &#x27;.card article .title.is-3, .card article .title.is-4-mobile, &#x27; +</span><br><span class="hljs-addition">+                        &#x27;.card .article p.title, .card article p.title&#x27;</span><br><span class="hljs-addition">+                    );</span><br><span class="hljs-addition">+                    const countElements = document.querySelectorAll(&#x27;.card .article .firestore-visitors-count, .card article .firestore-visitors-count&#x27;);</span><br><span class="hljs-addition">+                </span><br><span class="hljs-addition">+                // ç§»é™¤é¦–é¡µå…ƒç´ æ£€æµ‹æ—¥å¿—</span><br><span class="hljs-addition">+                </span><br><span class="hljs-addition">+                if (titleElements.length &gt; 0 &amp;&amp; countElements.length &gt; 0) &#123;</span><br><span class="hljs-addition">+                    const promises = [...titleElements].map(element =&gt; &#123;</span><br><span class="hljs-addition">+                            const title = element.textContent.trim();</span><br><span class="hljs-addition">+                            const doc = articles.doc(title);</span><br><span class="hljs-addition">+                            // é¦–é¡µåªè·å–è®¡æ•°ï¼Œä¸å¢åŠ è®¡æ•°</span><br><span class="hljs-addition">+                            return getCount(doc, false).then(count =&gt; &#123;</span><br><span class="hljs-addition">+                                return count;</span><br><span class="hljs-addition">+                            &#125;);</span><br><span class="hljs-addition">+                        &#125;);</span><br><span class="hljs-addition">+                    </span><br><span class="hljs-addition">+                    Promise.all(promises).then(counts =&gt; &#123;</span><br><span class="hljs-addition">+                            counts.forEach((val, idx) =&gt; &#123;</span><br><span class="hljs-addition">+                                if (countElements[idx]) &#123;</span><br><span class="hljs-addition">+                                    countElements[idx].innerText = val;</span><br><span class="hljs-addition">+                                &#125;</span><br><span class="hljs-addition">+                            &#125;);</span><br><span class="hljs-addition">+                        &#125;).catch(e =&gt; &#123;</span><br><span class="hljs-addition">+                            // é”™è¯¯å¤„ç†ï¼šå°è¯•æ˜¾ç¤ºä¸€äº›é»˜è®¤å€¼æˆ–æ›¿ä»£æ–‡æœ¬</span><br><span class="hljs-addition">+                            countElements.forEach(el =&gt; &#123;</span><br><span class="hljs-addition">+                                if (el.innerText === &#x27;0&#x27;) &#123;</span><br><span class="hljs-addition">+                                    el.innerText = &#x27;åŠ è½½ä¸­...&#x27;;</span><br><span class="hljs-addition">+                                &#125;</span><br><span class="hljs-addition">+                            &#125;);</span><br><span class="hljs-addition">+                        &#125;);</span><br><span class="hljs-addition">+                &#125; else &#123;</span><br><span class="hljs-addition">+                    // å°è¯•ä½¿ç”¨æ›´é€šç”¨çš„é€‰æ‹©å™¨</span><br><span class="hljs-addition">+                    const fallbackTitleElements = document.querySelectorAll(&#x27;.article-card a[href^=&quot;/&quot;]&#x27;);</span><br><span class="hljs-addition">+                    const fallbackCountElements = document.querySelectorAll(&#x27;.article-card .firestore-visitors-count&#x27;);</span><br><span class="hljs-addition">+                    </span><br><span class="hljs-addition">+                    if (fallbackTitleElements.length &gt; 0 &amp;&amp; fallbackCountElements.length &gt; 0) &#123;</span><br><span class="hljs-addition">+                        // è¿™é‡Œå¯ä»¥æ·»åŠ å¤‡é€‰é€»è¾‘</span><br><span class="hljs-addition">+                    &#125;</span><br><span class="hljs-addition">+                &#125;</span><br><span class="hljs-addition">+                &#125; else &#123;</span><br><span class="hljs-addition">+                    // é™é»˜å¤„ç†ï¼šå½“å‰é¡µé¢æ—¢ä¸æ˜¯æ–‡ç« é¡µä¹Ÿä¸æ˜¯é¦–é¡µ</span><br><span class="hljs-addition">+                &#125;</span><br><span class="hljs-addition">+            &#125;;</span><br><span class="hljs-addition">++</span><br><span class="hljs-addition">+            // ç›‘å¬ä¼ ç»Ÿé¡µé¢åŠ è½½å®Œæˆäº‹ä»¶</span><br><span class="hljs-addition">+            document.addEventListener(&#x27;DOMContentLoaded&#x27;, () =&gt; &#123;</span><br><span class="hljs-addition">+                handleViewCount();</span><br><span class="hljs-addition">+            &#125;);</span><br><span class="hljs-addition">+            </span><br><span class="hljs-addition">+            // ç›‘å¬PJAXé¡µé¢åŠ è½½å®Œæˆäº‹ä»¶ï¼ˆé€‚é…Icarusä¸»é¢˜çš„PJAXæœºåˆ¶ï¼‰</span><br><span class="hljs-addition">+            document.addEventListener(&#x27;page:loaded&#x27;, () =&gt; &#123;</span><br><span class="hljs-addition">+                handleViewCount();</span><br><span class="hljs-addition">+            &#125;);</span><br><span class="hljs-addition">+        &#125;</span><br><span class="hljs-addition">+    &#125; catch (error) &#123;</span><br><span class="hljs-addition">+        // ç§»é™¤åˆå§‹åŒ–å¤±è´¥æ—¥å¿—</span><br><span class="hljs-addition">+        // å¦‚æœåˆå§‹åŒ–å¤±è´¥ï¼Œå°è¯•éšè—è®¡æ•°å™¨å…ƒç´ ä»¥é¿å…æ˜¾ç¤ºä¸º0</span><br><span class="hljs-addition">+        document.querySelectorAll(&#x27;.firestore-visitors-count&#x27;).forEach(el =&gt; &#123;</span><br><span class="hljs-addition">+            el.style.display = &#x27;none&#x27;;</span><br><span class="hljs-addition">+        &#125;);</span><br><span class="hljs-addition">+    &#125;</span><br><span class="hljs-addition">+&#125;</span><br></code></pre></td></tr></table></figure>

<h3 id="å…¶ä»–ä¸€äº›ä¼˜åŒ–"><a href="#å…¶ä»–ä¸€äº›ä¼˜åŒ–" class="headerlink" title="å…¶ä»–ä¸€äº›ä¼˜åŒ–"></a>å…¶ä»–ä¸€äº›ä¼˜åŒ–</h3><p>hexo-theme-icarus&#x2F;layout&#x2F;common&#x2F;scripts.jsx</p>
<figure class="highlight diff"><table><tr><td class="code"><pre><code class="hljs diff">const &#123; Component, Fragment &#125; = require(&#x27;inferno&#x27;);<br>const &#123; toMomentLocale &#125; = require(&#x27;hexo/dist/plugins/helper/date&#x27;);<br>const Plugins = require(&#x27;./plugins&#x27;);<br><br>module.exports = class extends Component &#123;<br>    render() &#123;<br>        const &#123; site, config, helper, page &#125; = this.props;<br>        const &#123; url_for, cdn &#125; = helper;<br>        const &#123; article &#125; = config;<br>        const language = toMomentLocale(page.lang || page.language || config.language || &#x27;en&#x27;);<br><br>        let fold = &#x27;unfolded&#x27;;<br>        let clipboard = true;<br>        if (article &amp;&amp; article.highlight) &#123;<br>            if (typeof article.highlight.clipboard !== &#x27;undefined&#x27;) &#123;<br>                clipboard = !!article.highlight.clipboard;<br>            &#125;<br>            if (typeof article.highlight.fold <span class="hljs-comment">=== &#x27;string&#x27;) &#123;</span><br>                fold = article.highlight.fold;<br>            &#125;<br>        &#125;<br><br>        const embeddedConfig = `var IcarusThemeSettings = &#123;<br>            article: &#123;<br>                highlight: &#123;<br>                    clipboard: $&#123;clipboard&#125;,<br>                    fold: &#x27;$&#123;fold&#125;&#x27;<br>                &#125;<br><span class="hljs-addition">+           &#125;,</span><br><span class="hljs-addition">+           services: &#123;</span><br><span class="hljs-addition">+               firebase: $&#123;config.services &amp;&amp; config.services.firebase ? JSON.stringify(config.services.firebase) : &#x27;false&#x27;&#125;</span><br>            &#125;<br>        &#125;;`;<br><br>        return &lt;Fragment&gt;<br>            &lt;script src=&#123;cdn(&#x27;jquery&#x27;, &#x27;3.3.1&#x27;, &#x27;dist/jquery.min.js&#x27;)&#125;&gt;&lt;/script&gt;<br>            &lt;script src=&#123;cdn(&#x27;moment&#x27;, &#x27;2.22.2&#x27;, &#x27;min/moment-with-locales.min.js&#x27;)&#125;&gt;&lt;/script&gt;<br>            &lt;script dangerouslySetInnerHTML=&#123;&#123; __html: `moment.locale(&quot;$&#123;language&#125;&quot;);` &#125;&#125;&gt;&lt;/script&gt;<br>            &lt;script dangerouslySetInnerHTML=&#123;&#123; __html: embeddedConfig &#125;&#125;&gt;&lt;/script&gt;<br><span class="hljs-addition">+           &#123;/* Firebase Firestore */&#125;</span><br><span class="hljs-addition">+           &#123;config.services &amp;&amp; config.services.firebase &amp;&amp; config.services.firebase.enable ? (</span><br><span class="hljs-addition">+               &lt;Fragment&gt;</span><br><span class="hljs-addition">+                   &lt;script src=&quot;https://www.gstatic.com/firebasejs/9.6.11/firebase-app-compat.js&quot;&gt;&lt;/script&gt;</span><br><span class="hljs-addition">+                   &lt;script src=&quot;https://www.gstatic.com/firebasejs/9.6.11/firebase-firestore-compat.js&quot;&gt;&lt;/script&gt;</span><br><span class="hljs-addition">+               &lt;/Fragment&gt;</span><br><span class="hljs-addition">+           ) : null&#125;</span><br>            &lt;script data-pjax src=&#123;url_for(&#x27;/js/column.js&#x27;)&#125;&gt;&lt;/script&gt;<br>            &lt;Plugins site=&#123;site&#125; config=&#123;config&#125; page=&#123;page&#125; helper=&#123;helper&#125; head=&#123;false&#125; /&gt;<br>            &lt;script data-pjax src=&#123;url_for(&#x27;/js/main.js&#x27;)&#125; defer&gt;&lt;/script&gt;<br><span class="hljs-addition">+           &#123;/* Firebase counter script */&#125;</span><br><span class="hljs-addition">+           &#123;config.services &amp;&amp; config.services.firebase &amp;&amp; config.services.firebase.enable ? (</span><br><span class="hljs-addition">+               &lt;script data-pjax src=&#123;url_for(&#x27;/js/firebase_counter.js&#x27;)&#125; defer&gt;&lt;/script&gt;</span><br><span class="hljs-addition">+           ) : null&#125;</span><br>        &lt;/Fragment&gt;;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>æ‚è®°</category>
      </categories>
      <tags>
        <tag>blog</tag>
        <tag>æ‚è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>week35-week39</title>
    <url>/2025/11/03/week35-week39/</url>
    <content><![CDATA[<p>2025å¹´11æœˆç¯‡</p>
<span id="more"></span>

<h2 id="week35-2025-10-27-2025-11-2"><a href="#week35-2025-10-27-2025-11-2" class="headerlink" title="week35 (2025.10.27-2025.11.2)"></a>week35 (2025.10.27-2025.11.2)</h2><ul>
<li>0xGameçš„æœ€åä¸€å‘¨ï¼Œåœ¨AIçš„å¸®åŠ©ä¸‹ä¹Ÿæ˜¯å…¨è§£å‡ºæ¥äº†ã€‚è¿™å‘¨é¢˜ç›®æŒºå¥½ç©çš„ï¼Œæœ‰Unityé€†å‘æ”¹æ¸¸æˆæœºåˆ¶å’Œä»¿çœŸï¼ˆä¸ªäººè®¤ä¸ºï¼‰çš„é¢˜ç›®ï¼ˆå›¾åƒåŠ å¯†ç¨‹åºå’Œç½‘ç»œé€šä¿¡ç¨‹åºï¼‰ä»€ä¹ˆçš„ï¼Œå‡½æ•°é‡å†™ä¹Ÿæ˜¯å‡ºç°äº†å‡ æ¬¡ï¼Œå­¦ä¹ åˆ°äº†ğŸ˜‹</li>
<li>å‘¨äºŒæ¯”èµ›ç»“æŸåæ‘†çƒ‚äº†ï¼Œweek4WriteUpè¿˜æ²¡å†™ï¼Œ?CTFweek4ä¹Ÿæ²¡å»çœ‹ï¼Œç­‰å¤ç°å¥½äº†ã€‚GeekChallengesæ™šç‚¹å†åš</li>
<li>å‘¨æœ«é—²å¾—æ— èŠåœ¨ZLibä¸Šæ‰¾åˆ°äº†å‡ æœ¬ä¹¦ï¼Œé€†å‘å·¥ç¨‹å®æˆ˜(BruceÂ·Dang)è¿˜æœ‰ç¨‹åºå‘˜çš„è‡ªæˆ‘ä¿®å…»è¿™ä¸¤æœ¬æ„Ÿè§‰å†™å¾—æŒºå¥½çš„ï¼Œç¬¦åˆæˆ‘ç°åœ¨çš„å­¦ä¹ éœ€æ±‚ğŸ˜‹</li>
</ul>
<h2 id="week36-2025-11-3-2025-11-9"><a href="#week36-2025-11-3-2025-11-9" class="headerlink" title="week36 (2025.11.3-2025.11.9)"></a>week36 (2025.11.3-2025.11.9)</h2><ul>
<li><p>è¿™å‘¨æœ‰ç‚¹æ‘†çƒ‚äº†ğŸ™ˆğŸ™ˆğŸ™ˆæ²¡ä»€ä¹ˆå¯ä»¥å†™çš„</p>
</li>
<li><p>ç›®å‰0xGame2025week4WriteUpè¿˜æœ‰2.5é¢˜æ²¡æœ‰å†™ï¼Œäº‰å–ä¸‹å‘¨å¯ä»¥ç»“æŸè¿™ä»¶äº‹</p>
</li>
<li><p>å¯¹äº†è¿™å‘¨è¿˜å°è¯•äº†å¤ç°æ¹¾åŒºæ¯ï¼Œä½†æ˜¯å‘ç°strangappçš„è¿è¡Œç¯å¢ƒæ­ä¸èµ·æ¥ğŸ˜¡ğŸ˜¡ğŸ˜¡å‘¨æœ«ä¹Ÿæ²¡æœ‰å¤„ç†è¿™äº‹</p>
</li>
<li><p>åæ€åæ€ç…®å•µçš„ç”Ÿæ´»ï¼Œæœ‰ç‚¹å¤ªæ— èŠäº†ï¼Œä»¥è‡³äºæ€»æ˜¯åœ¨çŸ­è§†é¢‘é‡Œéº»ç—¹è‡ªå·±ã€‚æ‰€ä»¥è¿™å‘¨æœ«ç…®å•µä¸‹è¡€æœ¬ä¹°äº†å°ç”µé’¢æ¥ä¸°å¯Œä¸°å¯Œç”Ÿæ´»ï¼ˆ</p>
<p>è¿˜æœ‰å¬è¯´æœ€è¿‘PCLå’ŒHMCLå‡ºäº†è”æœºåŠŸèƒ½ï¼Œå‘¨æœ«å’Œæœ‹å‹è¯•ç€è”æœºäº†ä¸€ä¸‹ï¼Œå¤ªå¥½äº†ç…®å•µä¹Ÿæ˜¯ç»ˆäºæœ‰ä¸ªæœ‰ç‚¹å…´è¶£ç©çš„æ¸¸æˆäº†ğŸ˜‹ğŸ˜‹ğŸ˜‹</p>
</li>
<li><p>è¿™å‘¨è™½ç„¶è¯´æ²¡ä»€ä¹ˆæŠ€æœ¯ä¸Šçš„æ”¶è·ï¼Œä½†æ˜¯ç…®å•µæ„Ÿè§‰äººç”Ÿåˆä¸°å¯Œäº†ä¸€ç‚¹ğŸ±</p>
</li>
</ul>
<h2 id="week37-2025-11-10-2025-11-16"><a href="#week37-2025-11-10-2025-11-16" class="headerlink" title="week37 (2025.11.10-2025.11.16)"></a>week37 (2025.11.10-2025.11.16)</h2><ul>
<li>å¥½å§è¿™å‘¨çœ‹èµ·æ¥æ›´æ‘†ä¸€ç‚¹ï¼ŒX2cçš„å‡é˜Ÿè€ƒæ ¸å·²ç»å¼€å§‹äº†ï¼Œä½†æ˜¯ç…®å•µè¿˜æ²¡æœ‰åšå¥½å‡†å¤‡ğŸ˜¶â€ğŸŒ«ï¸ğŸ˜¶â€ğŸŒ«ï¸ğŸ˜¶â€ğŸŒ«ï¸å¯ä»¥çš„è¯ï¼Œè®¡åˆ’ä¸‹å‘¨è¡¥å……ç‚¹SMCå’Œfridahookçš„çŸ¥è¯†å†å»å‚åŠ è€ƒæ ¸ï¼ˆä¸»è¦è¿˜æ˜¯è„šæœ¬è¿™ä¸€å—ğŸ™ˆï¼‰</li>
<li>0xGame2025week4WriteUpè¿˜å‰©2é¢˜ï¼Œä¸»è¦æ˜¯é¢˜ç›®è¿˜æ˜¯æœ‰ç‚¹å¤æ‚åº¦åœ¨çš„ï¼Œè¦æè¿°å‡ºä¸€æ¡æ¯”è¾ƒæ¸…æ™°çš„æ€è·¯æœ‰ç‚¹éš¾åº¦ã€‚ä½†æ˜¯å·²ç»æŠŠå†™å®Œçš„éƒ¨åˆ†æ”¾å‡ºæ¥äº†</li>
</ul>
<h2 id="week38-2025-11-17-2025-11-23"><a href="#week38-2025-11-17-2025-11-23" class="headerlink" title="week38 (2025.11.17-2025.11.23)"></a>week38 (2025.11.17-2025.11.23)</h2><ul>
<li>OKè¿™å‘¨ä¹Ÿæ˜¯æˆåŠŸå†™å®Œäº†0xGame2025week4WriteUp(ï½ï¿£â–½ï¿£)ï½</li>
<li>è¿™å‘¨å‚åŠ äº†å‡é˜Ÿè€ƒæ ¸ï¼ŒæˆåŠŸå‡é˜Ÿäº†(ï½ï¿£â–½ï¿£)ï½</li>
<li>å”‰ï¼Œè€ƒæ ¸å…¶å®å¹¶ä¸éš¾ï¼Œä½†æ˜¯å‚åŠ è€ƒæ ¸å‰æˆ‘ä¸€ç›´åœ¨çŠ¹è±«ï¼Œæ€»æ˜¯è®¾æƒ³è‡ªå·±ç¦»é€šè¿‡è€ƒæ ¸çš„æ ‡å‡†è¿˜å·®å¤ªè¿œã€‚è¿™å‡ ä¹å°±æ˜¯æˆ‘é•¿æœŸä»¥æ¥çš„é—®é¢˜ï¼Œåœ¨æ²¡æœ‰çœŸæ­£æ¥è§¦ä¸€ä»¶äº‹ç‰©çš„æ—¶å€™æ€»çˆ±è®¾æƒ³ï¼Œæ€»æ˜¯ç¼ºä¹å†²åŠ¨çš„å‹‡æ°”ğŸ˜¶â€ğŸŒ«ï¸ç”Ÿæ´»ä¸Šä¹Ÿæ˜¯ï¼Œæ˜æ˜æ„Ÿå—åˆ°äº†å®¿èˆä¸é€‚åˆå­¦ä¹ ï¼Œä½†æ˜¯åœ¨ä¸€ç‚¹ç‚¹çš„ä¸ç†æƒ³ï¼ˆæ¯”å¦‚èµ·åºŠæ™šäº†ã€æ‰‹æœºç©è¿‡å¤´å¿˜äº†æ—¶é—´äº†ï¼‰çš„å½±å“ä¸‹è¿˜æ˜¯ä¼šæ‰“æ¶ˆå‡ºå»è‡ªä¹ çš„å¿µå¤´ğŸ˜¶â€ğŸŒ«ï¸å…«æœˆä»½çš„å…¥é˜Ÿè€ƒæ ¸å’Œè¿™å‘¨çš„å‡é˜Ÿè€ƒæ ¸éƒ½ä¸€æ ·ï¼Œå…¶å®éƒ½æ˜¯sprengå¸ˆå‚…å…ˆæ¥æ‰¾æˆ‘äº†ï¼Œä¹‹åæˆ‘æ‰å»å‚åŠ çš„è€ƒæ ¸ğŸ˜¶â€ğŸŒ«ï¸å¼€å­¦åˆ°ç°åœ¨å¿«3ä¸ªæœˆäº†ï¼ŒåŠä¸ªå­¦æœŸä¹Ÿè¿‡å»äº†ï¼Œé™¤äº†å‚åŠ äº†å‡ åœºæ¯”èµ›ç§¯æ”’äº†äº›ç»éªŒï¼ŒçœŸçš„æ˜¯æ²¡æœ‰å…¶ä»–æ”¶è·äº†ï¼ŒçœŸå°±å’Œä¹‹å‰æƒ³çš„ä¸€æ ·ç¡®å®æ²¡æœ‰æš‘å‡å­¦çš„å¤šğŸ«¥å­¦ä¸šä¸Šå…¶å®ä¹Ÿè½ä¸‹äº†å¥½å¤šï¼Œæ²¡æœ‰ä¸€é—¨è¯¾è®°äº†ç¬”è®°ï¼Œå†™ä½œä¸šå‰è¿˜å¾—å…ˆç¿»ä¹¦ï¼Œé¢˜å†™ä¸å‡ºæ¥è¿˜å¾—æœé¢˜ğŸ«¥è¿˜æœ‰ä¸€äº›å°é¡¹ç›®å°ç‚¹å­ä¹Ÿæ˜¯è¿Ÿè¿Ÿæ²¡åŠ¨æ‰‹å»å†™ğŸ«¥ä¸Šäº†å¤§å­¦è¶Šæ´»è¶Šæ··ä¹±äº†å±äºæ˜¯</li>
</ul>
<h2 id="week39-2025-11-24-2025-11-30"><a href="#week39-2025-11-24-2025-11-30" class="headerlink" title="week39 (2025.11.24-2025.11.30)"></a>week39 (2025.11.24-2025.11.30)</h2><ul>
<li>å‘¨å…­æ‰“äº†å¤å‰‘å±±ï¼Œæ‹‰äº†å¨å¤§çš„(ï¿£_ï¿£|||)ï¼Œå…¨é springå’Œecxä¸¤ä½å¸ˆå‚…å¸¦é£äº†ï¼ŒDamnï¼Œè¿˜å¾—ç»ƒå•ŠğŸ« </li>
<li>emmmï¼Œè¿™å‘¨æ²¡å­¦ä»€ä¹ˆè¯´æ˜¯ï¼_ï¼bï¼Œçº¯æ‘†äº†ï¼ŒçŠ¶æ€å¼€å§‹ä¸å¯¹åŠ²èµ·æ¥äº†</li>
<li>æœ€è¿‘ç­¹åˆ’ç€ç”¨mkdocsç»™é€†å‘ç¬”è®°æ­ä¸ªä¸“é—¨çš„é¡µé¢</li>
</ul>
]]></content>
      <categories>
        <category>å‘¨è®°</category>
      </categories>
      <tags>
        <tag>å‘¨è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>week31-week34</title>
    <url>/2025/10/05/week31-week34/</url>
    <content><![CDATA[<p>2025å¹´10æœˆç¯‡</p>
<span id="more"></span>

<h2 id="week31-2025-9-29-2025-10-5"><a href="#week31-2025-9-29-2025-10-5" class="headerlink" title="week31 (2025.9.29-2025.10.5)"></a>week31 (2025.9.29-2025.10.5)</h2><ul>
<li>è¿™å‘¨ç¢°ä¸Šå›½åº†å‡æœŸï¼Œè¶ç€å‡æœŸç‹ ç‹ ç ”ç©¶moectfçš„upx_revengeã€‚èŠ±äº†ä¸¤å¤©æ—¶é—´ç¢ç£¨å‡ºäº†.rsrcæ®µåº”è¯¥æœ‰é—®é¢˜ï¼ˆä¹‹å‰ä¸çŸ¥é“å“ªé‡Œæ‰¾çš„å·¥å…·ç»™ä¿®å¤åˆ°ç¨‹åºèƒ½è¿è¡Œä½†æ˜¯é—ªé€€äº†ï¼Œåé¢æ‹¿æ­£å¸¸åŠ å£³ç¨‹åºå¯¹æ¯”ä¸€ä¸‹ä¸åŒçš„åœ°æ–¹åœ¨.rsrcæ®µï¼‰ï¼Œç„¶åæŠŠ.rsrcæ®µçš„ResourceDirectoryTableç»™ä¿®å¤çš„å·®ä¸å¤šäº†ï¼Œå‰©ä¸€ä¸ªDataä¸€ç›´å¯¹ä¸ä¸Šã€‚æ²¡æ‹›äº†å»æ‰¾å‡ºé¢˜äººäº¤æµï¼Œç»“æœå‘ç°æ˜¯upxç‰¹å¾æ®µçš„é—®é¢˜ğŸ« ä¸€ä¸ªæœˆäº†ç»ˆäºè§£å‡ºè¿™é“é¢˜äº†ğŸ˜­å¤ªå¥½äº†ï¼Œç»ˆäºæ˜¯akè¿‡çš„äººäº†ğŸ˜­</li>
<li>0xGame2025ä¹Ÿæ˜¯å¼€æ‰“äº†ï¼Œé æ–°ç”Ÿèµ›æ”’ç»éªŒè¿™ä¸€å—(</li>
<li>æƒ³ç€æ¥ä¸‹æ¥æœé€†å‘å¼€å‘è¿™ä¸€å—å­¦å­¦ï¼Œå‘ç°è¿™ä¸€ç±»ç¬”è®°åº”è¯¥å½’ä¸ºå¼€å‘è€Œä¸æ˜¯é€†å‘ğŸ¤”æ‰€ä»¥åˆå¼€äº†ä¸€ä¸ªæ–°åˆ†ç±»ã€‚</li>
<li>å“ˆåŸºç±³çš„ï¼Œè€æ˜¯æ„Ÿè§‰è‡ªå·±æ‡‚å¾—å¤ªå°‘äº†ï¼Œä½†æ˜¯åˆä¸çŸ¥é“ä»å“ªé‡Œå¼€å§‹å­¦è¿™äº›çŸ¥è¯†ğŸ˜­</li>
</ul>
<h2 id="week32-2025-10-6-2025-10-12"><a href="#week32-2025-10-6-2025-10-12" class="headerlink" title="week32 (2025.10.6-2025.10.12)"></a>week32 (2025.10.6-2025.10.12)</h2><ul>
<li>è¿™å‘¨å¥½åƒæ²¡ä»€ä¹ˆå¯ä»¥å†™çš„ğŸ«¥ä¸€åŠæ”¾å‡ä¸€åŠä¸Šè¯¾çš„ï¼Œæœ‰ç‚¹å‰²è£‚æ„Ÿ</li>
<li>0xGameweek1å’ŒMoectfçš„WriteUPä¹Ÿæ˜¯æ”¾ä¸Šäº†ã€‚è¿™å‘¨ä¸»è¦åœ¨åš0xGameè¿˜æœ‰?CTFçš„é¢˜ï¼Œå‘¨æœ«æœ‰ä¸ªç¾ŠåŸæ¯å¯ä»¥æ‰“ï¼Œä½†æ˜¯å›½åº†ç©è¿‡å¤´äº†æ²¡æŠ¥ä¸ŠåğŸ«¥è¿˜æœ‰ä¸ªé¢†èˆªæ¯æ¥ç€ï¼Œè¿™ä¸ªæˆªæ­¢çš„æ›´æ—©ï¼Œ9.29æˆªæ­¢çš„ï¼Œæ²¡æ³¨æ„çœ‹æ—¶é—´ä¹Ÿé”™è¿‡äº†ğŸ« </li>
<li>å¥½æƒ³è«åå…¶å¦™çš„å“ˆå‡ ä¸‹æ°”ğŸ«¥</li>
</ul>
<h2 id="week33-2025-10-13-2025-10-19"><a href="#week33-2025-10-13-2025-10-19" class="headerlink" title="week33 (2025.10.13-2025.10.19)"></a>week33 (2025.10.13-2025.10.19)</h2><ul>
<li>è¿™å‘¨è¿˜æ˜¯ä¸»è¦åš0xGameå’Œ?CTFçš„é¢˜ã€‚ç›®å‰ä¸¤ä¸ªæ¯”èµ›week1week2çš„é¢˜ç›®æ˜¯éƒ½åšå‡ºæ¥äº†ï¼Œä½†æ˜¯å€Ÿç”¨äº†ä¸å±äºè‡ªå·±çš„åŠ›é‡(</li>
<li>åŠ å¯†ç®—æ³•é€†å‘å’Œè„šæœ¬è¿™å—è¿˜æ˜¯å¾—ç»ƒå•ŠğŸ« </li>
<li>å‘¨æœ«æ‰“äº†å¼ºç½‘æ¯ï¼Œæ‹¼å°½å…¨åŠ›æ— æ³•æˆ˜èƒœï¼Œåªåšå‡ºäº†ä¸€é“Reç®€å•é¢˜ï¼Œè„šæœ¬è¿˜æ˜¯AIæ¢­çš„ğŸ« </li>
</ul>
<h2 id="week34-2025-10-20-2025-10-26"><a href="#week34-2025-10-20-2025-10-26" class="headerlink" title="week34 (2025.10.20-2025.10.26)"></a>week34 (2025.10.20-2025.10.26)</h2><ul>
<li>è¿™å‘¨æ‰çŠ¶æ€äº†ã€‚0xGameweek3ä¸Šéš¾åº¦äº†ï¼Œå·®ç‚¹æ²¡åšå®Œï¼ˆCalamaity_Fortneå› ä¸ºæ•°æ®æå–é”™è¯¯æ²¡åŠæ—¶è§£å‡ºæ¥ğŸ˜­ï¼‰ï¼Œweek4æ›´æ˜¯æœ‰ç‚¹é­”é¬¼ï¼ˆé¢˜ç›®éƒ½å¥½æŠ½è±¡</li>
<li>?CTFweek3å¼€å§‹æ²¡æ‰“äº†ï¼ŒèŠ‚å¥æœ‰ç‚¹ä¹±äº†ï¼ŒWPæ²¡æœ‰åŠæ—¶å†™ç§¯äº†å¥½å¤šï¼ˆ0xGameweek3å’Œ?CTFweek1ã€2ï¼‰ï¼ŒåŠ ä¸Šèµ›é¢˜éš¾åº¦å¼€å§‹ä¸Šæ¥äº†ï¼Œæ‰€ä»¥å®åœ¨å¿™ä¸è¿‡æ¥ï¼Œæ›´åˆ«è¯´è¿˜æœ‰å­¦ä¸š</li>
<li>ğŸ˜­ğŸ˜­ğŸ« ğŸ« ğŸ«¥ğŸ«¥</li>
</ul>
]]></content>
      <categories>
        <category>å‘¨è®°</category>
      </categories>
      <tags>
        <tag>å‘¨è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>week45-week48</title>
    <url>/2026/01/11/week45-week48/</url>
    <content><![CDATA[<p>2026å¹´1æœˆç¯‡</p>
<span id="more"></span>

<h2 id="week45-2026-1-5-2025-1-11"><a href="#week45-2026-1-5-2025-1-11" class="headerlink" title="week45 (2026.1.5-2025.1.11)"></a>week45 (2026.1.5-2025.1.11)</h2><ul>
<li>æœŸæœ«å‘¨ï¼Œå¤ä¹ åˆ°è¦ä¼¼åŠ›Xï¹X</li>
</ul>
<h2 id="week46-2026-1-12-2026-1-18"><a href="#week46-2026-1-12-2026-1-18" class="headerlink" title="week46 (2026.1.12-2026.1.18)"></a>week46 (2026.1.12-2026.1.18)</h2><ul>
<li>æœŸæœ«å‘¨æ–­æ›´â€¦</li>
</ul>
<h2 id="week47-2026-1-19-2026-1-25"><a href="#week47-2026-1-19-2026-1-25" class="headerlink" title="week47 (2026.1.19-2026.1.25)"></a>week47 (2026.1.19-2026.1.25)</h2><ul>
<li>è€ƒå®Œè¯•å›å®¶åŠ›ï¼Œå·æ‡’ä¸¤å¤©:p</li>
</ul>
<h2 id="week48-2026-1-26-2026-2-1"><a href="#week48-2026-1-26-2026-2-1" class="headerlink" title="week48 (2026.1.26-2026.2.1)"></a>week48 (2026.1.26-2026.2.1)</h2><ul>
<li>å‘¨æœ«ä¸¤å¤©æ‰“é˜¿é‡ŒCTFï¼Œçˆ†é›¶äº†ğŸ˜­ğŸ˜­</li>
</ul>
]]></content>
      <categories>
        <category>å‘¨è®°</category>
      </categories>
      <tags>
        <tag>å‘¨è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>week49-week52</title>
    <url>/2026/02/08/week49-week52/</url>
    <content><![CDATA[<p>2026å¹´2æœˆç¯‡</p>
<span id="more"></span>

<h2 id="week49-2026-2-2-2026-2-8"><a href="#week49-2026-2-2-2026-2-8" class="headerlink" title="week49 (2026.2.2-2026.2.8)"></a>week49 (2026.2.2-2026.2.8)</h2><ul>
<li>è¿™å‘¨ï¼ŒæŠ˜è…¾äº†ä¸€ç‚¹çˆ¬è™«(ï½ï¿£â–½ï¿£)ï½æœ‰ç‚¹å°æ‘†(ï½ï¿£â–½ï¿£)ï½</li>
</ul>
<h2 id="week50-2026-2-9-2026-2-15"><a href="#week50-2026-2-9-2026-2-15" class="headerlink" title="week50 (2026.2.9-2026.2.15)"></a>week50 (2026.2.9-2026.2.15)</h2><ul>
<li>è¿™å‘¨ä¼˜åŒ–äº†ä¸€ä¸‹åšå®¢ï¼Œå†…åµŒäº†ä¸ªäººçŸ¥è¯†åº“è¿›å»ï¼Œæ–¹ä¾¿ç»Ÿä¸€ç®¡ç†åšå®¢å’Œç¬”è®°</li>
<li>å“å‘€ï¼ŒåŠä¸ªå¯’å‡è¿‡å»äº†è¿˜æ²¡å­¦ä»€ä¹ˆå‘¢_(:Ğ·ã€âˆ )_</li>
</ul>
]]></content>
      <categories>
        <category>å‘¨è®°</category>
      </categories>
      <tags>
        <tag>å‘¨è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>week40-week44</title>
    <url>/2025/12/07/week40-week44/</url>
    <content><![CDATA[<p>2025å¹´12æœˆç¯‡</p>
<span id="more"></span>

<h2 id="week40-2025-12-1-2025-12-7"><a href="#week40-2025-12-1-2025-12-7" class="headerlink" title="week40 (2025.12.1-2025.12.7)"></a>week40 (2025.12.1-2025.12.7)</h2><ul>
<li>è¿™å‘¨æ‘†çƒ‚åŠ›&#x2F;_ \</li>
</ul>
<h2 id="week41-2025-12-8-2025-12-14"><a href="#week41-2025-12-8-2025-12-14" class="headerlink" title="week41 (2025.12.8-2025.12.14)"></a>week41 (2025.12.8-2025.12.14)</h2><ul>
<li><p>å‘¨æœ«æ‰“äº†é¹åŸæ¯ï¼Œä¸€é“é¢˜è€—æ‰ä¸€æ•´å¤©(T_T)ã€‚åˆæ˜¯è¿‡äºä¾èµ–AIï¼Œå¯¼è‡´å¤§åŠæ—¶é—´éƒ½åœ¨ç­‰AIå’Œè°ƒæ•™AIï¼ˆä¸€é“èŠ±æŒ‡ä»¤+VMçš„é¢˜ï¼Œä¸€å¼€å§‹çœ‹å‡ºæ˜¯VMæ²¡çœ‹å‡ºèŠ±æŒ‡ä»¤åœ¨å“ªé‡Œï¼Œä¸¢ç»™AIåˆ†æï¼Œä¸€æ—©ä¸Š3hæ²¡å‡ºç»“æœï¼Œä¸­åˆè‡ªå·±ç¢ç£¨äº†ä¸‹æ±‡ç¼–ä»£ç æ‰çœ‹å‡ºèŠ±æŒ‡ä»¤çš„è§„å¾‹ã€‚å€¼å¾—é«˜å…´çš„æ˜¯ä»Šå¤©æ²¡é AIè‡ªå·±å†™äº†IDApythonè„šæœ¬å»èŠ±(ã€‚ä½†æ˜¯åé¢å†™VMè§£é‡Šå™¨åˆä¸¢ç»™AIäº†ï¼ŒAIåˆ†æä¸€ä¸‹åˆæ²¡åˆ†æå‡ºä¸€æ ¹æ¯›ï¼Œåˆæ˜¯æ¯”èµ›ç»“æŸåè‡ªå·±ç¢ç£¨å‡ºäº†ä¸‹ä¸€æ­¥ï¼ˆæ‚²ï¼‰ã€‚å¤åˆ¶åŸä»£ç æ’ä¸ªæ¡©å‡ ååˆ†é’Ÿå¯ä»¥è·‘çš„åæ±‡ç¼–éè¦è®©AIæ¥ï¼Œè¿™ä¹ˆå¤šçš„æ—¶é—´é—¹ç€ç©å‘¢å±äºæ˜¯ğŸ˜¡</p>
</li>
<li><p>å«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIğŸ˜¡</p>
<p>ä¸‹ä¸‹å‘¨CISCNä¸èƒ½ç”¨AIçœ‹ä½ æ€ä¹ˆåŠğŸ˜¡</p>
</li>
</ul>
<h2 id="week42-2025-12-15-2025-12-21"><a href="#week42-2025-12-15-2025-12-21" class="headerlink" title="week42 (2025.12.15-2025.12.21)"></a>week42 (2025.12.15-2025.12.21)</h2><ul>
<li>è€ƒè¯•å‘¨æ–­æ›´(</li>
</ul>
<h2 id="week43-2025-12-22-2025-12-28"><a href="#week43-2025-12-22-2025-12-28" class="headerlink" title="week43 (2025.12.22-2025.12.28)"></a>week43 (2025.12.22-2025.12.28)</h2><ul>
<li>è¿™å‘¨æœ«CISCNï¼Œè¿˜æ˜¯å¤ªèœäº†ã€‚å¤æ‚ç¨‹åºçš„é€†å‘èƒ½åŠ›ä¸€ç‚¹æ²¡æœ‰ã€‚ã€‚ã€‚</li>
</ul>
<h2 id="week44-2025-12-29-2026-1-4"><a href="#week44-2025-12-29-2026-1-4" class="headerlink" title="week44 (2025.12.29-2026.1.4)"></a>week44 (2025.12.29-2026.1.4)</h2><ul>
<li>å…ƒæ—¦æœŸé—´æ— èŠå¤ç°äº†CISCNçš„wasm-loginï¼Œè¿™é¢˜ä¸ä¼šå†™è„šæœ¬è´¥åŒ—äº†ğŸ˜­</li>
<li>æ­¤å¤–è¿˜æŠ˜è…¾äº†ä¸€ä¸‹WSL2ï¼Œæƒ³ä½“éªŒä½“éªŒArchç”Ÿæ€ï¼ˆå…¶å®ä¸»è¦æ˜¯æ˜¯å¹³é“ºå¼æ¡Œé¢ç®¡ç†å™¨ï¼‰ï¼Œç„¶è€ŒWSL2è²Œä¼¼ä¸æ”¯æŒç›´æ¥å›¾å½¢åŒ–æ¡Œé¢ï¼Œåé¢åˆå»æŠ˜è…¾VNCè¿æ¥WSL2ææ¡Œé¢ï¼Œæ²¡æå‡ºæ¥ã€‚è™½ç„¶ä½†æ˜¯ï¼ŒæŠ˜è…¾ä½¿æˆ‘å¿«ä¹â—‹( ï¼¾çš¿ï¼¾)ã£</li>
</ul>
]]></content>
      <categories>
        <category>å‘¨è®°</category>
      </categories>
      <tags>
        <tag>å‘¨è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>ä¸€ä¸ªå°†åšå®¢å’Œä¸ªäººçŸ¥è¯†åº“ç»“åˆçš„æ€è·¯</title>
    <url>/2026/02/13/%E4%B8%80%E4%B8%AA%E5%B0%86%E5%8D%9A%E5%AE%A2%E5%92%8C%E4%B8%AA%E4%BA%BA%E7%9F%A5%E8%AF%86%E5%BA%93%E7%BB%93%E5%90%88%E7%9A%84%E6%80%9D%E8%B7%AF/</url>
    <content><![CDATA[<p>åŸºäºhexo+icarusåšå®¢ï¼Œåˆ©ç”¨Obsidianå’Œè‡ªå†™è„šæœ¬å®ç°åšå®¢å’Œä¸ªäººçŸ¥è¯†åº“çš„ç»“åˆ</p>
<span id="more"></span>
<h2 id="çµæœºä¸€åŠ¨"><a href="#çµæœºä¸€åŠ¨" class="headerlink" title="çµæœºä¸€åŠ¨"></a>çµæœºä¸€åŠ¨</h2><p> ç¬”è€…ä¹…ä»°Obsidianå¤§åï¼Œä½†æ˜¯æ­¤å‰éƒ½æ˜¯ç”¨typoraå†™çš„åšå®¢æ–‡ç« ã€‚è¿™ä¸¤å¤©å¿ƒè¡€æ¥æ½®æƒ³è¯•è¯•Obsidianï¼ˆå¬é—»æœ‰å†…éƒ¨é“¾æ¥ä»€ä¹ˆçš„æ–°å¥‡åŠŸèƒ½ï¼‰ï¼ŒåŠ ä¸Šæƒ³æä¸ªä¸ªäººçŸ¥è¯†åº“æ”¾ä¸€äº›æ‚ä¸ƒæ‚å…«çš„ç¬”è®°ä»€ä¹ˆçš„ï¼ˆæ²¡å¿…è¦å‘å¸ƒçš„ï¼‰ï¼Œæ‰€ä»¥å¼€å§‹äº†æœ¬æ¬¡æŠ˜è…¾</p>
<h2 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h2><p>ä¸»è¦çš„é—®é¢˜å®é™…ä¸Šæ˜¯åšå®¢æ–‡ç« å’ŒçŸ¥è¯†åº“æ–‡ç« çš„ç®¡ç†ï¼Œè¿™é¦–å…ˆå°±ç‰µæ‰¯åˆ°æ–‡ç« å›¾ç‰‡é™„ä»¶çš„é—®é¢˜ï¼ˆç¬”è€…åšå®¢å›¾ç‰‡ä¸€å¹¶éƒ¨ç½²åˆ°githubäº†ï¼‰ï¼ŒçŸ¥è¯†åº“çš„å›¾ç‰‡ä¸å¥½å…¬å¼€ï¼Œæ‰€ä»¥è¦å’Œåšå®¢çš„å›¾ç‰‡åˆ†å¼€å­˜å‚¨ï¼Œå¥½åœ¨Obsidianæœ‰ä¸°å¯Œçš„æ’ä»¶ï¼Œåˆ©ç”¨æ’ä»¶â€Attachment Managementâ€œå¯ä»¥ä¸ºä¸åŒæ–‡ä»¶å¤¹è®¾ç½®ä¸åŒçš„é™„ä»¶å­˜æ”¾è·¯å¾„ï¼Œç»“åˆhexoçš„excludeé…ç½®å¯ä»¥å®ç°åšå®¢ä¸çŸ¥è¯†åº“çš„åˆ†ç¦»ï¼ˆå³çŸ¥è¯†åº“ä¸éƒ¨ç½²ä¸å…¬å¼€ï¼‰ã€‚<br>æ¥ä¸‹æ¥çš„é—®é¢˜æ˜¯çŸ¥è¯†åº“æ–‡ç« å’Œåšå®¢æ–‡ç« çš„è½¬åŒ–ï¼Œç¬”è€…å°†åšå®¢æ–‡ç« è§†ä½œçŸ¥è¯†åº“æ–‡ç« çš„ä¸€éƒ¨åˆ†ï¼Œå› æ­¤å‡†ç¡®æ¥è¯´æ˜¯çŸ¥è¯†åº“æ–‡ç« éƒ¨ç½²åˆ°åšå®¢çš„é—®é¢˜ã€‚ç›®å‰è€ƒè™‘åˆ°çš„éƒ¨ç½²ä¸­çš„é—®é¢˜æ˜¯å†…éƒ¨é“¾æ¥çš„å»é™¤å’Œå›¾ç‰‡è·¯å¾„çš„è½¬æ¢ï¼Œéœ€è¦å†™è„šæœ¬è§£å†³ã€‚</p>
<h2 id="å¼€å§‹åŠ¨æ‰‹"><a href="#å¼€å§‹åŠ¨æ‰‹" class="headerlink" title="å¼€å§‹åŠ¨æ‰‹"></a>å¼€å§‹åŠ¨æ‰‹</h2><h3 id="é™„ä»¶è®¾ç½®"><a href="#é™„ä»¶è®¾ç½®" class="headerlink" title="é™„ä»¶è®¾ç½®"></a>é™„ä»¶è®¾ç½®</h3><ol>
<li>å®‰è£…å¹¶å¯ç”¨æ’ä»¶ã€‚è¿™ä¸€æ­¥ç½‘ä¸Šæœ‰å¾ˆå¤šæ•™ç¨‹äº†ï¼Œå±äºObsidiançš„ä½¿ç”¨ï¼Œå°±ä¸åºŸè¯äº†ã€‚è´´ä¸Šä¸€ä¸ªé“¾æ¥ï¼š<a href="https://zhuanlan.zhihu.com/p/403001135">å¦‚ä½•å®‰è£…æ’ä»¶ï¼Ÿç©è½¬Obsidiançš„ä¿å§†çº§æ•™ç¨‹</a></li>
<li>å®‰è£…å¯ç”¨å®Œâ€œAttachment Managementâ€åï¼Œç‚¹å‡»Obsianå·¦ä¾§å·¥å…·æ å³ä¸‹è§’çš„è®¾ç½®å›¾æ ‡å±•å¼€è®¾ç½®ï¼Œè¿›è¡Œé™„ä»¶é»˜è®¤è·¯å¾„çš„è®¾ç½®ã€‚ç¬”è€…ç›´æ¥ç”¨Obsidianæ‰“å¼€çš„hexoä¸‹çš„sourceæ–‡ä»¶å¤¹ï¼Œæ‰€ä»¥é™„ä»¶é»˜è®¤è·¯å¾„è®¾ç½®ä¸­ï¼Œæ ¹æ–‡ä»¶å¤¹ç•™ç©ºï¼Œé™„ä»¶è·¯å¾„å¡«imagesï¼ˆå³åšå®¢å›¾ç‰‡ç›®å½•ã€‚å¡«çŸ¥è¯†åº“å›¾ç‰‡ç›®å½•ä¹Ÿè¡Œï¼Œæ­¤å¤„åªæ˜¯ä¿è¯Obsidianä¸ä¼šèƒ¡ä¹±å»ºæ–‡ä»¶å¤¹æ¥æ”¾å›¾ç‰‡è€Œå·²ï¼Œå›¾ç‰‡ç›®å½•çš„è®¾ç½®ä¸»è¦åœ¨ä¸‹ä¸€æ­¥ï¼‰<br> <img src="/../images/IMG-20260213142540152.png" alt="å±•å¼€è®¾ç½®"><br> <img src="/../images/IMG-20260213142638111.png" alt="è®¾ç½®é»˜è®¤è·¯å¾„"></li>
<li>Attachment Managementçš„ä»‹ç»ä¸­æåˆ°äº†å¯ä»¥ä¸ºæ–‡ä»¶å¤¹å•ç‹¬é‡è½½é™„ä»¶è·¯å¾„ï¼š<br> <img src="/../images/IMG-20260213143200206.png" alt="é‡è½½é™„ä»¶è·¯å¾„çš„ç‰¹æ€§"><br> æ‰€ä»¥ï¼Œç¬”è€…åœ¨sourceç›®å½•ä¸‹æ–°å»ºäº†ä¸¤ä¸ªæ–‡ä»¶å¤¹â€œmyknowledgeâ€å’Œâ€œprivate_imagesâ€ä½œä¸ºçŸ¥è¯†åº“æ–‡ä»¶å¤¹åŠå…¶é™„ä»¶æ–‡ä»¶å¤¹ã€‚é€‰ä¸­â€œmyknowledgeâ€æ–‡ä»¶å¤¹ï¼Œå³é”®å¯ä»¥çœ‹åˆ°â€œè¦†ç›–é™„ä»¶è®¾ç½®â€çš„é€‰é¡¹ï¼Œåœ¨è¿™é‡Œå¯ä»¥ä¸ºæ–‡ä»¶å¤¹å•ç‹¬è®¾ç½®é™„ä»¶è·¯å¾„<br> <img src="/../images/IMG-20260213143524173.png" alt="è¦†ç›–é™„ä»¶è®¾ç½®çš„é€‰é¡¹"><br> æ­¤å¤„çš„è®¾ç½®å’Œé»˜è®¤è·¯å¾„è®¾ç½®å¾ˆç›¸ä¼¼ï¼Œæ ¹æ–‡ä»¶å¤¹ä¹Ÿæ˜¯ç•™ç©ºï¼Œé™„ä»¶è·¯å¾„è®¾ä¸ºprivate_images<br> <img src="/../images/IMG-20260213144412039.png" alt="è¦†ç›–çŸ¥è¯†åº“é™„ä»¶è®¾ç½®"><br> ç„¶åå†å¯¹postæ–‡ä»¶å¤¹å¦‚æ³•ç‚®åˆ¶å³å¯ï¼ˆæ ¹æ–‡ä»¶å¤¹ç•™ç©ºï¼Œé™„ä»¶è·¯å¾„è®¾ä¸ºimagesï¼‰</li>
<li>è¿™æ—¶å€™è¿˜æ²¡ç»“æŸï¼Œå› ä¸ºé™¤äº†draftæ–‡ä»¶å¤¹ï¼Œhexoé»˜è®¤ä¼šæŠŠsourceä¸‹çš„æ‰€æœ‰æ–‡ä»¶éƒ½ç”Ÿæˆåˆ°publicï¼ˆå³éƒ¨ç½²çš„æ–‡ä»¶å¤¹ï¼‰ä¸­ï¼Œæ­¤æ—¶å°±éœ€è¦å€ŸåŠ©hexoçš„excludeé…ç½®æ¥æ’é™¤çŸ¥è¯†åº“æ–‡ä»¶å¤¹åŠå…¶é™„ä»¶æ–‡ä»¶å¤¹<br> <img src="/../images/IMG-20260213144609097.png" alt="excludeé…ç½®çš„å®˜æ–¹æè¿°"><br> æ‰“å¼€config.ymlï¼Œæ‰¾åˆ°å¦‚ä¸‹ä½ç½®ï¼Œå°†çŸ¥è¯†åº“æ–‡ä»¶å¤¹åŠå…¶é™„ä»¶æ–‡ä»¶å¤¹å¡«å…¥ï¼ˆæ­¤å¤„ä¿é™©èµ·è§excludeå’Œignoreå…¨å¡«äº†ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯excludeå’Œignoreçš„ç›¸å¯¹æ ¹ç›®å½•ä¸åŒï¼Œå‰è€…ä»¥sourceä¸ºæ ¹ç›®å½•ï¼Œåè€…ä»¥hexoæ ¹ç›®å½•ä¸ºæ ¹ç›®å½•ã€‚** è¡¨ç¤ºæ‰€æœ‰æ–‡ä»¶ï¼‰<br> <img src="/../images/IMG-20260213145113340.png" alt="config.ymlçš„é…ç½®"><br> åˆ°æ­¤ï¼Œåšå®¢å’ŒçŸ¥è¯†åº“çš„é™„ä»¶å­˜å‚¨è·¯å¾„å°±åˆ†å¼€äº†</li>
</ol>
<h3 id="çŸ¥è¯†åº“æ–‡ç« å‘å¸ƒåˆ°åšå®¢çš„è„šæœ¬"><a href="#çŸ¥è¯†åº“æ–‡ç« å‘å¸ƒåˆ°åšå®¢çš„è„šæœ¬" class="headerlink" title="çŸ¥è¯†åº“æ–‡ç« å‘å¸ƒåˆ°åšå®¢çš„è„šæœ¬"></a>çŸ¥è¯†åº“æ–‡ç« å‘å¸ƒåˆ°åšå®¢çš„è„šæœ¬</h3><p>hexoä¸ºç”¨æˆ·æä¾›äº†ä½¿ç”¨è‡ªå®šä¹‰è„šæœ¬æ¥ç®¡ç†åšå®¢çš„é€”å¾„ï¼š<br><img src="/../images/IMG-20260213151516207.png" alt="hexoå¯¹è„šæœ¬çš„æ”¯æŒ"><br>æ‰€ä»¥ï¼Œè‡ªå®šä¹‰è„šæœ¬åªéœ€è¦æ”¾åˆ°hexoæ ¹ç›®å½•çš„scriptsæ–‡ä»¶å¤¹é‡Œå³å¯ç”Ÿæ•ˆã€‚å½“ç„¶ï¼Œè‡ªå®šä¹‰è„šæœ¬è‚¯å®šéœ€è¦ç”¨åˆ°hexoçš„APIï¼Œæ­¤å¤„ä¸»è¦æ˜¯ä½¿ç”¨äº†hexoçš„è¿‡æ»¤å™¨ï¼Œä¸€ä¸ªhexo.extend.filter.register()å‡½æ•°å³å¯<br><img src="/../images/IMG-20260213152113967.png" alt="hexo.extend.filter.registerçš„å®˜æ–¹æè¿°"><br>è„šæœ¬æ€»ä½“æ€è·¯ï¼šè®¾ç½®ä¸€ä¸ªFrontMatterå­—æ®µpublishedï¼Œtureè¡¨ç¤ºéœ€è¦éƒ¨ç½²ï¼Œfalseè¡¨ç¤ºä¸éœ€è¦éƒ¨ç½²ï¼Œé€šè¿‡éå†myknowledgeçš„mdæ–‡ä»¶ï¼ŒæŒ¨ä¸ªæŸ¥çœ‹publishedå­—æ®µæ¥åˆ¤æ–­æ˜¯å¦è¿›è¡Œå‘å¸ƒæ“ä½œã€‚å¯¹äºæ ‡è®°ä¸ºéœ€è¦å‘å¸ƒçš„æ–‡ç« ï¼Œå…ˆå»æ‰å†…éƒ¨é“¾æ¥ï¼ŒåŒæ—¶è½¬æ¢å›¾ç‰‡è·¯å¾„ï¼Œç„¶åæ£€æŸ¥æ–‡ç« æ˜¯å¦å·²ç»å­˜åœ¨ï¼Œæ˜¯å¦éœ€è¦æ›´æ–°ã€‚</p>
<ol>
<li>å‡½æ•°ä¾èµ–ã€‚è„šæœ¬æ¶‰åŠæ–‡ä»¶æ“ä½œï¼Œè·¯å¾„æ“ä½œï¼Œè¿˜æœ‰FrontMatterè§£ææ“ä½œï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨åˆ°fs-extraã€pathã€js-yamlè¿™ä¸‰ä¸ªæ¨¡å—ã€‚åœ¨hexoæ ¹ç›®å½•ä¸‹æ‰“å¼€å‘½ä»¤è¡Œï¼Œè¿è¡Œå¦‚ä¸‹å‘½ä»¤å®‰è£…è¿™ä¸‰ä¸ªæ¨¡å—</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">npm install fs-extra path js-yaml --save<br></code></pre></td></tr></table></figure>
<ol start="2">
<li>ç¼–å†™è§£ææ–‡ç« çš„å‡½æ•°ï¼Œåˆ†ç¦»å‡ºFrontMatterå’Œæ­£æ–‡ã€‚ä½¿ç”¨å‚æ•°articleä¼ å…¥æ–‡ç« å†…å®¹ï¼Œé€šè¿‡jså­—ç¬¦ä¸²çš„æ­£åˆ™åŒ¹é…æ–¹æ³•matchæ¥è·å¾—FrontMatterçš„å†…å®¹ï¼Œç„¶ååˆ†ç¦»articleçš„FrontMatterå’Œæ­£æ–‡ï¼Œè¿”å›ä¸€ä¸ªæ‹†åˆ†å‡ºæ¥çš„å¯¹è±¡</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs JavaScript"><span class="hljs-comment">// è§£ææ–‡ç« ï¼Œåˆ†ç¦»Front Matterå’Œæ­£æ–‡ï¼Œç”¨äºè·å–publishedæ¥åˆ¤æ–­æ˜¯å¦éœ€è¦å‘å¸ƒ</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">parseArticle</span>(<span class="hljs-params">article</span>)&#123;<br>Â  Â  <span class="hljs-keyword">const</span> match = article.<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/^---\n([\s\S]*?)\n---/</span>);<br>Â  Â  <span class="hljs-keyword">if</span> (match) &#123;<br>Â  Â  Â  Â  <span class="hljs-keyword">try</span>&#123;<br>Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">const</span> frontMatter = yaml.<span class="hljs-title function_">load</span>(match[<span class="hljs-number">1</span>]);<br>Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">const</span> body = article.<span class="hljs-title function_">slice</span>(match[<span class="hljs-number">0</span>].<span class="hljs-property">length</span>).<span class="hljs-title function_">trim</span>();<br>Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">return</span> &#123;frontMatter,body&#125;<br>Â  Â  Â  Â  &#125; <span class="hljs-keyword">catch</span> (error) &#123;<br>Â  Â  Â  Â  Â  Â  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">&#x27;Front Matter parse failed&#x27;</span>)<br>Â  Â  Â  Â  &#125;<br>Â  Â  &#125;<br>Â  Â  <span class="hljs-keyword">return</span> &#123; <span class="hljs-attr">frontMatter</span>: &#123;&#125;, <span class="hljs-attr">body</span>: article &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<ol start="3">
<li>ç¼–å†™å»é™¤å†…éƒ¨é“¾æ¥å’Œä¿®æ”¹å›¾ç‰‡è·¯å¾„çš„å‡½æ•°ã€‚ä½¿ç”¨ä¸‰ä¸ªå‚æ•°contentã€filePathã€knowledgeDirï¼Œåˆ†åˆ«ä¼ å…¥æ–‡ç« å†…å®¹ã€æ–‡ç« è·¯å¾„ã€çŸ¥è¯†åº“è·¯å¾„ã€‚é¦–å…ˆé€šè¿‡æ­£åˆ™åŒ¹é…å»é™¤æ‰æ–‡ç« å†…å®¹é‡Œçš„å†…éƒ¨é“¾æ¥ï¼Œç„¶åæ ¹æ®ä¼ å…¥çš„æ–‡ä»¶è·¯å¾„å’ŒçŸ¥è¯†åº“è·¯å¾„è®¡ç®—å‡ºç›¸å¯¹è·¯å¾„ï¼Œä¿®æ”¹å›¾ç‰‡çš„è·¯å¾„ï¼ˆæ­¤å¤„åªæ˜¯å…ˆä¿®æ”¹è·¯å¾„ï¼Œåç»­ä¼šæœ‰å¤åˆ¶æ“ä½œï¼‰ï¼Œè¿”å›å¤„ç†å®Œçš„æ–‡æœ¬</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs Javascript"><span class="hljs-comment">// å»é™¤æ–‡ç« å†…éƒ¨é“¾æ¥å’Œæ”¹å˜å›¾ç‰‡è·¯å¾„</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">convertContent</span>(<span class="hljs-params">content, filePath, knowledgeDir</span>)&#123;<br>Â  Â  <span class="hljs-keyword">let</span> result = content;<br><br>Â  Â  <span class="hljs-comment">// å»é™¤å†…éƒ¨é“¾æ¥ï¼Œwikiæ ¼å¼</span><br>Â  Â  result = result.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/\[\[.*?\]\]/g</span>, <span class="hljs-string">&#x27;&#x27;</span>);<br>Â  Â  <span class="hljs-comment">// å»é™¤å†…éƒ¨é“¾æ¥ï¼Œmdè¶…é“¾æ¥æ ¼å¼</span><br>Â  Â  Â result = result.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/\[.*?\]\(.*?\.md\)/g</span>, <span class="hljs-string">&#x27;&#x27;</span>);<br>  <br>Â  Â  <span class="hljs-comment">// è®¡ç®—ç›¸å¯¹è·¯å¾„</span><br>Â  Â  <span class="hljs-keyword">const</span> relativePath = path.<span class="hljs-title function_">relative</span>(knowledgeDir, path.<span class="hljs-title function_">dirname</span>(filePath));<br>Â  Â  <span class="hljs-keyword">const</span> depth = relativePath.<span class="hljs-title function_">split</span>(path.<span class="hljs-property">sep</span>).<span class="hljs-title function_">filter</span>(<span class="hljs-title class_">Boolean</span>).<span class="hljs-property">length</span>;<br>Â  Â  <span class="hljs-keyword">const</span> upDir = depth &gt; <span class="hljs-number">0</span> ? <span class="hljs-string">&#x27;../&#x27;</span>.<span class="hljs-title function_">repeat</span>(depth) + <span class="hljs-string">&#x27;../&#x27;</span> : <span class="hljs-string">&#x27;../&#x27;</span>;<br>Â  Â  <br>Â  Â  <span class="hljs-comment">// è½¬æ¢å›¾ç‰‡è·¯å¾„ï¼š../myknowledge/images/xxx.png â†’ ../images/xxx.png</span><br>Â  Â  result = result.<span class="hljs-title function_">replace</span>(<br>Â  Â  Â  Â  <span class="hljs-keyword">new</span> <span class="hljs-title class_">RegExp</span>(<span class="hljs-string">`!\\[(.*?)\\]\\(<span class="hljs-subst">$&#123;upDir&#125;</span>private_images/(.*?)\\)`</span>, <span class="hljs-string">&#x27;g&#x27;</span>),<br>Â  Â  Â  Â  <span class="hljs-string">&#x27;![$1](../images/$2)&#x27;</span><br>Â  Â  );<br>  <br>Â  Â  <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure>
<ol start="4">
<li>ç¼–å†™æå–å›¾ç‰‡æ–‡ä»¶åçš„å‡½æ•°ã€‚ä½¿ç”¨å‚æ•°contentä¼ å…¥æ–‡ç« æ­£æ–‡å†…å®¹ï¼Œé€šè¿‡æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…å‡ºå›¾ç‰‡é“¾æ¥ï¼Œæå–å‡ºæ‰€æœ‰å›¾ç‰‡çš„åå­—ï¼Œè¿”å›å›¾ç‰‡åæ•°ç»„</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs JavaScript"><span class="hljs-comment">// æå–å›¾ç‰‡æ–‡ä»¶å</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">extractImageName</span>(<span class="hljs-params">content</span>)&#123;<br>Â  Â  <span class="hljs-keyword">const</span> matches = [];<br>Â  Â  <span class="hljs-keyword">const</span> regex = <span class="hljs-regexp">/!\[.*?\]\(\.\.\/images\/(.*?)\)/g</span>;<br>Â  Â  <span class="hljs-keyword">let</span> match;<br><br>Â  Â  <span class="hljs-keyword">while</span>((match = regex.<span class="hljs-title function_">exec</span>(content)) !== <span class="hljs-literal">null</span>)&#123;<br>Â  Â  Â  Â  matches.<span class="hljs-title function_">push</span>(match[<span class="hljs-number">1</span>]);<br>Â  Â  &#125;<br>Â  Â  <span class="hljs-keyword">return</span> [...<span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>(matches)];<span class="hljs-comment">// å»é‡</span><br>&#125;<br></code></pre></td></tr></table></figure>
<ol start="5">
<li>æ•´åˆä¸Šè¿°å‡½æ•°ï¼Œç¼–å†™å¤„ç†å•ä¸ªæ–‡ç« çš„å‡½æ•°ã€‚ä½¿ç”¨äº”ä¸ªå‚æ•°filePathã€knowledgeDirã€postDirã€knowledgeImagesDirã€blogImagesDirï¼Œä¼ å…¥æ–‡ç« è·¯å¾„ã€çŸ¥è¯†åº“è·¯å¾„ã€åšå®¢è·¯å¾„ã€çŸ¥è¯†åº“é™„ä»¶è·¯å¾„ã€åšå®¢é™„ä»¶è·¯å¾„ã€‚å…ˆç”¨fsæ¨¡å—è¯»å–æ–‡ä»¶æ‰€æœ‰å†…å®¹ï¼Œç„¶åä½¿ç”¨parseArticle()è§£æå‡ºæ–‡ç« çš„FrontMatterå’Œæ­£æ–‡ï¼Œæ£€æŸ¥publishedå­—æ®µåˆ¤æ–­æ˜¯å¦éœ€è¦è¿›è¡Œå‘å¸ƒæ“ä½œï¼Œè‹¥ä¸éœ€è¦ï¼Œè¿”å›falseï¼›è‹¥éœ€è¦å‘å¸ƒï¼Œåˆ™æ¥ç€å»é™¤å†…éƒ¨é“¾æ¥ï¼Œä¿®æ”¹å›¾ç‰‡è·¯å¾„ï¼Œé‡æ–°æ„å»ºå‡ºæ–‡æœ¬ã€‚ç„¶åç”±filePathå’ŒpostDiræ„å»ºå‡ºæ–‡ç« åœ¨postä¸‹çš„è·¯å¾„ï¼Œåˆ¤æ–­æ–‡ç« æ˜¯å¦å·²ç»å­˜åœ¨ï¼Œæ˜¯å¦éœ€è¦æ›´æ–°ã€‚è‹¥æ–‡ç« ä¸å­˜åœ¨æˆ–è€…éœ€è¦æ›´æ–°ï¼Œåˆ™æ¥ç€è¿›è¡Œå›¾ç‰‡çš„å¤åˆ¶æ“ä½œï¼šå…ˆæå–å›¾ç‰‡æ–‡ä»¶åï¼Œç„¶åå°†å›¾ç‰‡ä»private_imageså¤åˆ¶åˆ°imagesï¼ˆæ­¤å¤„è®¾ç½®äº†overwrite: tureæ¥é˜²æ­¢åŒä¸€å›¾ç‰‡ç´¯ç§¯ï¼‰ã€‚æœ€åå°±æ˜¯å†™å…¥é‡æ–°æ„å»ºçš„æ–‡æœ¬ã€‚æœ¬å‡½æ•°è¿”å›å¸ƒå°”å€¼ï¼Œè®°å½•æ–‡ç« æ˜¯å¦æ›´æ–°ï¼Œä»¥ä¾¿è®¡æ•°</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs JavaScript"><span class="hljs-comment">// å¤„ç†å•ä¸ªæ–‡ç« </span><br><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">ProcessSingleArticle</span>(<span class="hljs-params">filePath, knowledgeDir, postsDir, knowledgeImagesDir, blogImagesDir</span>)&#123;<br>Â  <span class="hljs-comment">// è¯»å–æ–‡ç« </span><br>Â  <span class="hljs-comment">//console.log(`processing $&#123;filePath&#125;`);</span><br>Â  <span class="hljs-keyword">const</span> content = <span class="hljs-keyword">await</span> fs.<span class="hljs-title function_">readFile</span>(filePath, <span class="hljs-string">&#x27;utf8&#x27;</span>);<br>Â  <span class="hljs-keyword">const</span> &#123; frontMatter, body &#125; = <span class="hljs-title function_">parseArticle</span>(content);<br>Â  <span class="hljs-comment">//console.log(&#x27;ispublished:&#x27;+frontMatter.published);</span><br>Â  <br>Â  <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦éœ€è¦å‘å¸ƒ</span><br>Â  <span class="hljs-keyword">if</span> (frontMatter.<span class="hljs-property">published</span> !== <span class="hljs-literal">true</span>) &#123;<br>Â  Â  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>Â  &#125;<br><br>Â  <span class="hljs-comment">// è½¬æ¢å†…å®¹ï¼ˆå»æ‰å†…éƒ¨é“¾æ¥ï¼Œè½¬æ¢å›¾ç‰‡è·¯å¾„ï¼‰</span><br>Â  <span class="hljs-keyword">let</span> processed = <span class="hljs-title function_">convertContent</span>(body, filePath, knowledgeDir);<br><br>Â  <span class="hljs-comment">// æ„å»ºå®Œæ•´å†…å®¹</span><br>Â  <span class="hljs-keyword">const</span> finalContent = <span class="hljs-string">`---\n<span class="hljs-subst">$&#123;yaml.dump(frontMatter)&#125;</span>---\n\n<span class="hljs-subst">$&#123;processed&#125;</span>`</span>;<br><br>Â  <span class="hljs-comment">// ç›®æ ‡æ–‡ä»¶è·¯å¾„ï¼ˆä¿ç•™åŸæ–‡ä»¶åï¼‰</span><br>Â  <span class="hljs-keyword">const</span> fileName = path.<span class="hljs-title function_">basename</span>(filePath);<br>Â  <span class="hljs-keyword">const</span> targetPath = path.<span class="hljs-title function_">join</span>(postsDir, fileName);<br><br>Â  <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦éœ€è¦æ›´æ–°ï¼ˆæ¯”è¾ƒå†…å®¹ï¼‰</span><br>Â  <span class="hljs-keyword">let</span> needsUpdate = <span class="hljs-literal">true</span>;<br>Â  <br>Â  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">await</span> fs.<span class="hljs-title function_">pathExists</span>(targetPath)) &#123;<br>Â  Â  <span class="hljs-keyword">const</span> existing = <span class="hljs-keyword">await</span> fs.<span class="hljs-title function_">readFile</span>(targetPath, <span class="hljs-string">&#x27;utf8&#x27;</span>);<br>Â  Â  <span class="hljs-keyword">if</span> (existing === finalContent) &#123;<br>Â  Â  Â  needsUpdate = <span class="hljs-literal">false</span>;<br>Â  Â  &#125;<br>Â  &#125;<br><br>Â  <span class="hljs-comment">// å¦‚æœéœ€è¦æ›´æ–°</span><br>Â  <span class="hljs-comment">//console.log(&quot;needUpdate:&quot;+needsUpdate);</span><br>Â  <span class="hljs-keyword">if</span> (needsUpdate) &#123;<br>Â  Â  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`[+] updating: <span class="hljs-subst">$&#123;fileName&#125;</span>`</span>);<br><br>Â  Â  <span class="hljs-comment">// å¤åˆ¶æ–‡ç« å¼•ç”¨çš„å›¾ç‰‡</span><br>Â  Â  <span class="hljs-keyword">const</span> usedImages = <span class="hljs-title function_">extractImageName</span>(processed);<br><br>Â  Â  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> imgName <span class="hljs-keyword">of</span> usedImages) &#123;<br>Â  Â  Â  <span class="hljs-keyword">const</span> sourceImg = path.<span class="hljs-title function_">join</span>(knowledgeImagesDir, imgName);<br>Â  Â  Â  <span class="hljs-keyword">const</span> targetImg = path.<span class="hljs-title function_">join</span>(blogImagesDir, imgName);<br>Â  Â  Â  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">await</span> fs.<span class="hljs-title function_">pathExists</span>(sourceImg)) &#123;<br>Â  Â  Â  Â  <span class="hljs-keyword">await</span> fs.<span class="hljs-title function_">copy</span>(sourceImg, targetImg, &#123; <span class="hljs-attr">overwrite</span>: <span class="hljs-literal">true</span> &#125;);<br>Â  Â  Â  Â  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`[+] copied picture: <span class="hljs-subst">$&#123;imgName&#125;</span>`</span>);<br>Â  Â  Â  &#125;<br>Â  Â  &#125;<br><br>Â  Â  <span class="hljs-comment">// å†™å…¥æ–‡ç« </span><br>Â  Â  <span class="hljs-keyword">await</span> fs.<span class="hljs-title function_">writeFile</span>(targetPath, finalContent);<br>Â  Â  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`[+] updated <span class="hljs-subst">$&#123;fileName&#125;</span> successfully`</span>);<br>Â  &#125;<br><br>Â  <span class="hljs-keyword">return</span> needsUpdate;<br>&#125;<br></code></pre></td></tr></table></figure>
<ol start="6">
<li>ç¼–å†™éå†mdæ–‡ä»¶çš„å‡½æ•°ã€‚ä½¿ç”¨å‚æ•°dirç”¨æ¥ä¼ å…¥çŸ¥è¯†åº“æ‰€åœ¨è·¯å¾„ï¼Œé€’å½’è¯»å–è·¯å¾„ä¸‹æ‰€æœ‰çš„mdæ–‡ä»¶ï¼Œå†™å…¥æ•°ç»„fileListï¼Œæœ€åè¿”å›fileList</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs JavaScript"><span class="hljs-comment">// è·å–æ‰€æœ‰mdæ–‡ä»¶</span><br><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getAllMdFiles</span>(<span class="hljs-params">dir</span>)&#123;<br>	<span class="hljs-keyword">let</span> fileList = [];<br>Â  Â  <span class="hljs-keyword">const</span> items = <span class="hljs-keyword">await</span> fs.<span class="hljs-title function_">readdir</span>(dir, &#123; <span class="hljs-attr">withFileTypes</span>: <span class="hljs-literal">true</span> &#125;);<br><br>Â  Â  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> item <span class="hljs-keyword">of</span> items) &#123;<br>Â  Â  Â  Â  <span class="hljs-keyword">const</span> fullPath = path.<span class="hljs-title function_">join</span>(dir, item.<span class="hljs-property">name</span>);<br><br>Â  Â  Â  Â  <span class="hljs-keyword">if</span> (item.<span class="hljs-title function_">isDirectory</span>() &amp;&amp; item.<span class="hljs-property">name</span> !== <span class="hljs-string">&#x27;images&#x27;</span>) &#123;<br>Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">await</span> <span class="hljs-title function_">getAllMdFiles</span>(fullPath, fileList);<br>Â  Â  Â  Â  &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (item.<span class="hljs-title function_">isFile</span>() &amp;&amp; item.<span class="hljs-property">name</span>.<span class="hljs-title function_">endsWith</span>(<span class="hljs-string">&#x27;.md&#x27;</span>)) &#123;<br>Â  Â  Â  Â  Â  Â  fileList.<span class="hljs-title function_">push</span>(fullPath);<br>Â  Â  Â  Â  &#125;<br>Â  Â  &#125;<br><br>Â  Â  <span class="hljs-keyword">return</span> fileList;<br>&#125;<br></code></pre></td></tr></table></figure>
<ol start="7">
<li>æ•´åˆä¸Šè¿°å†…å®¹ï¼Œä½¿ç”¨APIæ³¨å†Œè‡ªå®šä¹‰è¿‡æ»¤è§„åˆ™ã€‚ç¬¬ä¸€ä¸ªå‚æ•°typeè¡¨ç¤ºè¿‡æ»¤å™¨æ‰§è¡Œçš„æ—¶æœºï¼Œæ­¤å¤„ä½¿ç”¨â€œafter_initâ€ï¼Œå³åœ¨åšå®¢åˆå§‹åŒ–ä¹‹åï¼Œå¼€å§‹æ‰§è¡Œå†…éƒ¨è¿‡æ»¤å™¨ä¹‹å‰ï¼›ç¬¬äºŒä¸ªå‚æ•°ä½¿ç”¨ä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œå°†è·å–æ‰€æœ‰mdæ–‡ä»¶ä»¥åŠå¤„ç†å•ä¸ªæ–‡ç« æ•´åˆèµ·æ¥ï¼›ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯ä¼˜å…ˆçº§ï¼Œæ­¤å¤„ä¸ç”¨è®¾ç½®ï¼Œå› ä¸ºç¬¬ä¸€ä¸ªå‚æ•°å·²ç»ä¿è¯æ­¤å¤„è‡ªå†™çš„è¿‡æ»¤å™¨å¯ä»¥å…ˆäºå†…ç½®è¿‡æ»¤å™¨ç”Ÿæ•ˆäº†ï¼ˆå®é™…ä¸Šç¬”è€…æµ‹è¯•å‘ç°ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºâ€œbefore_generateâ€æ—¶ï¼Œè®¾ç½®ä¼˜å…ˆçº§ä¼¼ä¹ä¸èƒ½è®©è‡ªå†™çš„è¿‡æ»¤å™¨å…ˆäºå†…ç½®è¿‡æ»¤å™¨ç”Ÿæ•ˆï¼Œéœ€è¦ä¸¤æ¬¡hexo gæ‰èƒ½è®©çŸ¥è¯†åº“æ–‡ç« çœŸæ­£ç”Ÿæˆåˆ°publicæ–‡ä»¶å¤¹å†…ï¼Œæ‰€ä»¥åœ¨DSçš„å»ºè®®ä¸‹å°†ç¬¬ä¸€ä¸ªå‚æ•°è®¾ä¸ºâ€œafter_initâ€ï¼Œèˆå¼ƒä¼˜å…ˆçº§çš„ä½¿ç”¨ï¼‰</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs JavaScript"><span class="hljs-comment">// æ€»å‡½æ•°ï¼Œæ³¨å†Œå›è°ƒå‡½æ•°è‡ªå®ç°è¿‡æ»¤è§„åˆ™</span><br>hexo.<span class="hljs-property">extend</span>.<span class="hljs-property">filter</span>.<span class="hljs-title function_">register</span>(<span class="hljs-string">&#x27;after_init&#x27;</span>, <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>Â  Â  <span class="hljs-keyword">const</span> sourceDir = hexo.<span class="hljs-property">source_dir</span>;<br>Â  Â  <span class="hljs-keyword">const</span> knowledgeDir = path.<span class="hljs-title function_">join</span>(sourceDir, <span class="hljs-string">&#x27;myknowledge&#x27;</span>);<br>Â  Â  <span class="hljs-keyword">const</span> postsDir = path.<span class="hljs-title function_">join</span>(sourceDir, <span class="hljs-string">&#x27;_posts&#x27;</span>);<br>Â  Â  <span class="hljs-keyword">const</span> knowledgeImagesDir = path.<span class="hljs-title function_">join</span>(sourceDir, <span class="hljs-string">&#x27;private_images&#x27;</span>);<br>Â  Â  <span class="hljs-keyword">const</span> blogImagesDir = path.<span class="hljs-title function_">join</span>(sourceDir, <span class="hljs-string">&#x27;images&#x27;</span>);<br>Â  Â  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;[+] syncing articles in myknowledge...&#x27;</span>);<br><br>Â  Â  <span class="hljs-comment">// ç¡®ä¿ç›®å½•å­˜åœ¨</span><br>Â  Â  <span class="hljs-keyword">await</span> fs.<span class="hljs-title function_">ensureDir</span>(postsDir);<br>Â  Â  <span class="hljs-keyword">await</span> fs.<span class="hljs-title function_">ensureDir</span>(blogImagesDir);<br><br>Â  Â  <span class="hljs-comment">// éå†çŸ¥è¯†åº“ç›®å½•</span><br>Â  Â  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;[+] getting all mdfiles&quot;</span>);<br>Â  Â  <span class="hljs-keyword">const</span> files = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getAllMdFiles</span>(knowledgeDir);<br>Â  Â  <span class="hljs-keyword">let</span> updatedCount = <span class="hljs-number">0</span>;<br><br>Â  Â  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;[+] try to process articles&quot;</span>);<br>Â  Â  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">const</span> file <span class="hljs-keyword">of</span> files)&#123;<br>Â  Â  Â  Â  <span class="hljs-keyword">try</span>&#123;<br>Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">const</span> updated = <span class="hljs-keyword">await</span> <span class="hljs-title class_">ProcessSingleArticle</span>(<br>Â  Â  Â  Â  Â  Â  Â  Â  file,<br>Â  Â  Â  Â  Â  Â  Â  Â  knowledgeDir,<br>Â  Â  Â  Â  Â  Â  Â  Â  postsDir,<br>Â  Â  Â  Â  Â  Â  Â  Â  knowledgeImagesDir,<br>Â  Â  Â  Â  Â  Â  Â  Â  blogImagesDir<br>Â  Â  Â  Â  Â  Â  );<br><br>Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">if</span>(updated)&#123;<br>Â  Â  Â  Â  Â  Â  Â  Â  updatedCount++;<br>Â  Â  Â  Â  Â  Â  &#125;<br>Â  Â  Â  Â  &#125; <span class="hljs-keyword">catch</span>(error)&#123;<br>Â  Â  Â  Â  Â  Â  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`process failed <span class="hljs-subst">$&#123;file&#125;</span>:`</span>,error.<span class="hljs-property">message</span>);<br>Â  Â  Â  Â  &#125;<br>Â  Â  &#125;<br>Â  Â  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;[+] sync successfully&quot;</span>)<br>Â  Â  <span class="hljs-keyword">if</span>(updatedCount &gt; <span class="hljs-number">0</span>)&#123;<br>Â  Â  Â  Â  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`[+] updated <span class="hljs-subst">$&#123;updatedCount&#125;</span> articles`</span>)<br>Â  Â  &#125;<br>&#125;);<br></code></pre></td></tr></table></figure>
<p>æœ€ç»ˆè„šæœ¬ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs JavaScript"><span class="hljs-keyword">const</span> fs=<span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;fs-extra&#x27;</span>)<br><span class="hljs-keyword">const</span> path=<span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;path&#x27;</span>)<br><span class="hljs-keyword">const</span> yaml=<span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;js-yaml&#x27;</span>)<br><br><span class="hljs-comment">// è§£ææ–‡ç« ï¼Œåˆ†ç¦»Front Matterå’Œæ­£æ–‡ï¼Œç”¨äºè·å–publishedæ¥åˆ¤æ–­æ˜¯å¦éœ€è¦å‘å¸ƒ</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">parseArticle</span>(<span class="hljs-params">article</span>)&#123;<br>Â  Â  <span class="hljs-keyword">const</span> match = article.<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/^---\n([\s\S]*?)\n---/</span>);<br>Â  Â  <span class="hljs-keyword">if</span> (match) &#123;<br>Â  Â  Â  Â  <span class="hljs-keyword">try</span>&#123;<br>Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">const</span> frontMatter = yaml.<span class="hljs-title function_">load</span>(match[<span class="hljs-number">1</span>]);<br>Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">const</span> body = article.<span class="hljs-title function_">slice</span>(match[<span class="hljs-number">0</span>].<span class="hljs-property">length</span>).<span class="hljs-title function_">trim</span>();<br>Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">return</span> &#123;frontMatter,body&#125;<br>Â  Â  Â  Â  &#125; <span class="hljs-keyword">catch</span> (error) &#123;<br>Â  Â  Â  Â  Â  Â  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">&#x27;Front Matter parse failed&#x27;</span>)<br>Â  Â  Â  Â  &#125;<br>Â  Â  &#125;<br>Â  Â  <span class="hljs-keyword">return</span> &#123; <span class="hljs-attr">frontMatter</span>: &#123;&#125;, <span class="hljs-attr">body</span>: article &#125;<br>&#125;<br><br><span class="hljs-comment">// å»é™¤æ–‡ç« å†…éƒ¨é“¾æ¥å’Œæ”¹å˜å›¾ç‰‡è·¯å¾„</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">convertContent</span>(<span class="hljs-params">content, filePath, knowledgeDir</span>)&#123;<br>Â  Â  <span class="hljs-keyword">let</span> result = content;<br><br>Â  Â  <span class="hljs-comment">// å»é™¤å†…éƒ¨é“¾æ¥ï¼Œwikiæ ¼å¼</span><br>Â  Â  result = result.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/\[\[.*?\]\]/g</span>, <span class="hljs-string">&#x27;&#x27;</span>);<br>Â  Â  <span class="hljs-comment">// å»é™¤å†…éƒ¨é“¾æ¥ï¼Œmdè¶…é“¾æ¥æ ¼å¼</span><br>Â  Â  Â result = result.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/\[.*?\]\(.*?\.md\)/g</span>, <span class="hljs-string">&#x27;&#x27;</span>);<br>  <br>Â  Â  <span class="hljs-comment">// è®¡ç®—ç›¸å¯¹è·¯å¾„</span><br>Â  Â  <span class="hljs-keyword">const</span> relativePath = path.<span class="hljs-title function_">relative</span>(knowledgeDir, path.<span class="hljs-title function_">dirname</span>(filePath));<br>Â  Â  <span class="hljs-keyword">const</span> depth = relativePath.<span class="hljs-title function_">split</span>(path.<span class="hljs-property">sep</span>).<span class="hljs-title function_">filter</span>(<span class="hljs-title class_">Boolean</span>).<span class="hljs-property">length</span>;<br>Â  Â  <span class="hljs-keyword">const</span> upDir = depth &gt; <span class="hljs-number">0</span> ? <span class="hljs-string">&#x27;../&#x27;</span>.<span class="hljs-title function_">repeat</span>(depth) + <span class="hljs-string">&#x27;../&#x27;</span> : <span class="hljs-string">&#x27;../&#x27;</span>;<br>Â  Â  <br>Â  Â  <span class="hljs-comment">// è½¬æ¢å›¾ç‰‡è·¯å¾„ï¼š../myknowledge/images/xxx.png â†’ ../images/xxx.png</span><br>Â  Â  result = result.<span class="hljs-title function_">replace</span>(<br>Â  Â  Â  Â  <span class="hljs-keyword">new</span> <span class="hljs-title class_">RegExp</span>(<span class="hljs-string">`!\\[(.*?)\\]\\(<span class="hljs-subst">$&#123;upDir&#125;</span>private_images/(.*?)\\)`</span>, <span class="hljs-string">&#x27;g&#x27;</span>),<br>Â  Â  Â  Â  <span class="hljs-string">&#x27;![$1](../images/$2)&#x27;</span><br>Â  Â  );<br>  <br>Â  Â  <span class="hljs-keyword">return</span> result;<br>&#125;<br><br><span class="hljs-comment">// æå–å›¾ç‰‡æ–‡ä»¶å</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">extractImageName</span>(<span class="hljs-params">content</span>)&#123;<br>Â  Â  <span class="hljs-keyword">const</span> matches = [];<br>Â  Â  <span class="hljs-keyword">const</span> regex = <span class="hljs-regexp">/!\[.*?\]\(\.\.\/images\/(.*?)\)/g</span>;<br>Â  Â  <span class="hljs-keyword">let</span> match;<br><br>Â  Â  <span class="hljs-keyword">while</span>((match = regex.<span class="hljs-title function_">exec</span>(content)) !== <span class="hljs-literal">null</span>)&#123;<br>Â  Â  Â  Â  matches.<span class="hljs-title function_">push</span>(match[<span class="hljs-number">1</span>]);<br>Â  Â  &#125;<br>Â  Â  <span class="hljs-keyword">return</span> [...<span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>(matches)];<span class="hljs-comment">// å»é‡</span><br>&#125;<br><br><span class="hljs-comment">// å¤„ç†å•ä¸ªæ–‡ç« </span><br><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">ProcessSingleArticle</span>(<span class="hljs-params">filePath, knowledgeDir, postsDir, knowledgeImagesDir, blogImagesDir</span>)&#123;<br>Â  <span class="hljs-comment">// è¯»å–æ–‡ç« </span><br>Â  <span class="hljs-comment">//console.log(`processing $&#123;filePath&#125;`);</span><br>Â  <span class="hljs-keyword">const</span> content = <span class="hljs-keyword">await</span> fs.<span class="hljs-title function_">readFile</span>(filePath, <span class="hljs-string">&#x27;utf8&#x27;</span>);<br>Â  <span class="hljs-keyword">const</span> &#123; frontMatter, body &#125; = <span class="hljs-title function_">parseArticle</span>(content);<br>Â  <span class="hljs-comment">//console.log(&#x27;ispublished:&#x27;+frontMatter.published);</span><br>Â  <br>Â  <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦éœ€è¦å‘å¸ƒ</span><br>Â  <span class="hljs-keyword">if</span> (frontMatter.<span class="hljs-property">published</span> !== <span class="hljs-literal">true</span>) &#123;<br>Â  Â  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>Â  &#125;<br><br>Â  <span class="hljs-comment">// è½¬æ¢å†…å®¹ï¼ˆå»æ‰å†…éƒ¨é“¾æ¥ï¼Œè½¬æ¢å›¾ç‰‡è·¯å¾„ï¼‰</span><br>Â  <span class="hljs-keyword">let</span> processed = <span class="hljs-title function_">convertContent</span>(body, filePath, knowledgeDir);<br><br>Â  <span class="hljs-comment">// æ„å»ºå®Œæ•´å†…å®¹</span><br>Â  <span class="hljs-keyword">const</span> finalContent = <span class="hljs-string">`---\n<span class="hljs-subst">$&#123;yaml.dump(frontMatter)&#125;</span>---\n<span class="hljs-subst">$&#123;processed&#125;</span>`</span>;<br><br>Â  <span class="hljs-comment">// ç›®æ ‡æ–‡ä»¶è·¯å¾„ï¼ˆä¿ç•™åŸæ–‡ä»¶åï¼‰</span><br>Â  <span class="hljs-keyword">const</span> fileName = path.<span class="hljs-title function_">basename</span>(filePath);<br>Â  <span class="hljs-keyword">const</span> targetPath = path.<span class="hljs-title function_">join</span>(postsDir, fileName);<br><br>Â  <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦éœ€è¦æ›´æ–°ï¼ˆæ¯”è¾ƒå†…å®¹ï¼‰</span><br>Â  <span class="hljs-keyword">let</span> needsUpdate = <span class="hljs-literal">true</span>;<br>Â  <br>Â  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">await</span> fs.<span class="hljs-title function_">pathExists</span>(targetPath)) &#123;<br>Â  Â  <span class="hljs-keyword">const</span> existing = <span class="hljs-keyword">await</span> fs.<span class="hljs-title function_">readFile</span>(targetPath, <span class="hljs-string">&#x27;utf8&#x27;</span>);<br>Â  Â  <span class="hljs-keyword">if</span> (existing === finalContent) &#123;<br>Â  Â  Â  needsUpdate = <span class="hljs-literal">false</span>;<br>Â  Â  &#125;<br>Â  &#125;<br><br>Â  <span class="hljs-comment">// å¦‚æœéœ€è¦æ›´æ–°</span><br>Â  <span class="hljs-comment">//console.log(&quot;needUpdate:&quot;+needsUpdate);</span><br>Â  <span class="hljs-keyword">if</span> (needsUpdate) &#123;<br>Â  Â  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`[+] updating: <span class="hljs-subst">$&#123;fileName&#125;</span>`</span>);<br><br>Â  Â  <span class="hljs-comment">// å¤åˆ¶æ–‡ç« å¼•ç”¨çš„å›¾ç‰‡</span><br>Â  Â  <span class="hljs-keyword">const</span> usedImages = <span class="hljs-title function_">extractImageName</span>(processed);<br><br>Â  Â  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> imgName <span class="hljs-keyword">of</span> usedImages) &#123;<br>Â  Â  Â  <span class="hljs-keyword">const</span> sourceImg = path.<span class="hljs-title function_">join</span>(knowledgeImagesDir, imgName);<br>Â  Â  Â  <span class="hljs-keyword">const</span> targetImg = path.<span class="hljs-title function_">join</span>(blogImagesDir, imgName);<br>Â  Â  Â  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">await</span> fs.<span class="hljs-title function_">pathExists</span>(sourceImg)) &#123;<br>Â  Â  Â  Â  <span class="hljs-keyword">await</span> fs.<span class="hljs-title function_">copy</span>(sourceImg, targetImg, &#123; <span class="hljs-attr">overwrite</span>: <span class="hljs-literal">true</span> &#125;);<br>Â  Â  Â  Â  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`[+] copied picture: <span class="hljs-subst">$&#123;imgName&#125;</span>`</span>);<br>Â  Â  Â  &#125;<br>Â  Â  &#125;<br><br>Â  Â  <span class="hljs-comment">// å†™å…¥æ–‡ç« </span><br>Â  Â  <span class="hljs-keyword">await</span> fs.<span class="hljs-title function_">writeFile</span>(targetPath, finalContent);<br>Â  Â  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`[+] updated <span class="hljs-subst">$&#123;fileName&#125;</span> successfully`</span>);<br>Â  &#125;<br><br>Â  <span class="hljs-keyword">return</span> needsUpdate;<br>&#125;<br><br><span class="hljs-comment">// è·å–æ‰€æœ‰mdæ–‡ä»¶</span><br><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getAllMdFiles</span>(<span class="hljs-params">dir</span>)&#123;<br>	<span class="hljs-keyword">let</span> fileList = [];<br>Â  Â  <span class="hljs-keyword">const</span> items = <span class="hljs-keyword">await</span> fs.<span class="hljs-title function_">readdir</span>(dir, &#123; <span class="hljs-attr">withFileTypes</span>: <span class="hljs-literal">true</span> &#125;);<br><br>Â  Â  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> item <span class="hljs-keyword">of</span> items) &#123;<br>Â  Â  Â  Â  <span class="hljs-keyword">const</span> fullPath = path.<span class="hljs-title function_">join</span>(dir, item.<span class="hljs-property">name</span>);<br><br>Â  Â  Â  Â  <span class="hljs-keyword">if</span> (item.<span class="hljs-title function_">isDirectory</span>() &amp;&amp; item.<span class="hljs-property">name</span> !== <span class="hljs-string">&#x27;images&#x27;</span>) &#123;<br>Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">await</span> <span class="hljs-title function_">getAllMdFiles</span>(fullPath, fileList);<br>Â  Â  Â  Â  &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (item.<span class="hljs-title function_">isFile</span>() &amp;&amp; item.<span class="hljs-property">name</span>.<span class="hljs-title function_">endsWith</span>(<span class="hljs-string">&#x27;.md&#x27;</span>)) &#123;<br>Â  Â  Â  Â  Â  Â  fileList.<span class="hljs-title function_">push</span>(fullPath);<br>Â  Â  Â  Â  &#125;<br>Â  Â  &#125;<br><br>Â  Â  <span class="hljs-keyword">return</span> fileList;<br>&#125;<br><br><span class="hljs-comment">// æ€»å‡½æ•°ï¼Œæ³¨å†Œå›è°ƒå‡½æ•°è‡ªå®ç°è¿‡æ»¤è§„åˆ™</span><br>hexo.<span class="hljs-property">extend</span>.<span class="hljs-property">filter</span>.<span class="hljs-title function_">register</span>(<span class="hljs-string">&#x27;after_init&#x27;</span>, <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>Â  Â  <span class="hljs-keyword">const</span> sourceDir = hexo.<span class="hljs-property">source_dir</span>;<br>Â  Â  <span class="hljs-keyword">const</span> knowledgeDir = path.<span class="hljs-title function_">join</span>(sourceDir, <span class="hljs-string">&#x27;myknowledge&#x27;</span>);<br>Â  Â  <span class="hljs-keyword">const</span> postsDir = path.<span class="hljs-title function_">join</span>(sourceDir, <span class="hljs-string">&#x27;_posts&#x27;</span>);<br>Â  Â  <span class="hljs-keyword">const</span> knowledgeImagesDir = path.<span class="hljs-title function_">join</span>(sourceDir, <span class="hljs-string">&#x27;private_images&#x27;</span>);<br>Â  Â  <span class="hljs-keyword">const</span> blogImagesDir = path.<span class="hljs-title function_">join</span>(sourceDir, <span class="hljs-string">&#x27;images&#x27;</span>);<br>Â  Â  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;[+] syncing articles in myknowledge...&#x27;</span>);<br><br>Â  Â  <span class="hljs-comment">// ç¡®ä¿ç›®å½•å­˜åœ¨</span><br>Â  Â  <span class="hljs-keyword">await</span> fs.<span class="hljs-title function_">ensureDir</span>(postsDir);<br>Â  Â  <span class="hljs-keyword">await</span> fs.<span class="hljs-title function_">ensureDir</span>(blogImagesDir);<br><br>Â  Â  <span class="hljs-comment">// éå†çŸ¥è¯†åº“ç›®å½•</span><br>Â  Â  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;[+] getting all mdfiles&quot;</span>);<br>Â  Â  <span class="hljs-keyword">const</span> files = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getAllMdFiles</span>(knowledgeDir);<br>Â  Â  <span class="hljs-keyword">let</span> updatedCount = <span class="hljs-number">0</span>;<br><br>Â  Â  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;[+] try to process articles&quot;</span>);<br>Â  Â  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">const</span> file <span class="hljs-keyword">of</span> files)&#123;<br>Â  Â  Â  Â  <span class="hljs-keyword">try</span>&#123;<br>Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">const</span> updated = <span class="hljs-keyword">await</span> <span class="hljs-title class_">ProcessSingleArticle</span>(<br>Â  Â  Â  Â  Â  Â  Â  Â  file,<br>Â  Â  Â  Â  Â  Â  Â  Â  knowledgeDir,<br>Â  Â  Â  Â  Â  Â  Â  Â  postsDir,<br>Â  Â  Â  Â  Â  Â  Â  Â  knowledgeImagesDir,<br>Â  Â  Â  Â  Â  Â  Â  Â  blogImagesDir<br>Â  Â  Â  Â  Â  Â  );<br><br>Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">if</span>(updated)&#123;<br>Â  Â  Â  Â  Â  Â  Â  Â  updatedCount++;<br>Â  Â  Â  Â  Â  Â  &#125;<br>Â  Â  Â  Â  &#125; <span class="hljs-keyword">catch</span>(error)&#123;<br>Â  Â  Â  Â  Â  Â  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`process failed <span class="hljs-subst">$&#123;file&#125;</span>:`</span>,error.<span class="hljs-property">message</span>);<br>Â  Â  Â  Â  &#125;<br>Â  Â  &#125;<br>Â  Â  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;[+] sync successfully&quot;</span>)<br>Â  Â  <span class="hljs-keyword">if</span>(updatedCount &gt; <span class="hljs-number">0</span>)&#123;<br>Â  Â  Â  Â  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`[+] updated <span class="hljs-subst">$&#123;updatedCount&#125;</span> articles`</span>)<br>Â  Â  &#125;<br>&#125;);<br></code></pre></td></tr></table></figure>
<h2 id="æ•ˆæœå±•ç¤º"><a href="#æ•ˆæœå±•ç¤º" class="headerlink" title="æ•ˆæœå±•ç¤º"></a>æ•ˆæœå±•ç¤º</h2><p>ä»¥æœ¬æ–‡å’Œå¦ä¸€ç¯‡æµ‹è¯•æ–‡ç« ä¸ºä¾‹ï¼Œæœ¬æ–‡è®¾ç½®publishedä¸ºtrueï¼Œæµ‹è¯•æ–‡ç« è®¾ç½®ä¸ºfalseã€‚è¿˜æœªè¿›è¡Œgenerateä¹‹å‰ï¼Œä¸¤ç¯‡æ–‡ç« ä¸­çš„å›¾ç‰‡é“¾æ¥å¦‚ä¸‹ï¼š<br><img src="/../images/IMG-20260213220752342.png" alt="æœ¬æ–‡å›¾ç‰‡é“¾æ¥"><br><img src="/../images/IMG-20260213220847002.png" alt="æµ‹è¯•æ–‡ç« å›¾ç‰‡é“¾æ¥"><br>æœ¬æ–‡ä¸­è®¾ç½®ä¸€ä¸ªå†…éƒ¨é“¾æ¥ï¼š<br><img src="/../images/IMG-20260213220918405.png" alt="å†…éƒ¨é“¾æ¥"><br>ç„¶åæ‰§è¡Œhexo cl &amp;&amp; hexo gï¼š<br><img src="/../images/IMG-20260213221128009.png" alt="å‘½ä»¤è¡Œè¾“å‡º"><br>æŸ¥çœ‹å‘å¸ƒåˆ°postçš„æ–‡ç« ä¸­å†…éƒ¨é“¾æ¥æ˜¯å¦åˆ é™¤ï¼Œå›¾ç‰‡é“¾æ¥æ˜¯å¦ä¿®æ”¹ï¼š<br><img src="/../images/IMG-20260213221509504.png" alt="å‘å¸ƒåˆ°postçš„æ–‡ç« ä¸­çš„å†…éƒ¨é“¾æ¥"><br><img src="/../images/IMG-20260213221332152.png" alt="å‘å¸ƒåˆ°postçš„æ–‡ç« ä¸­çš„å›¾ç‰‡é“¾æ¥"><br>å¯ä»¥çœ‹åˆ°ï¼Œè„šæœ¬æˆåŠŸç”Ÿæ•ˆ</p>
]]></content>
      <categories>
        <category>æ‚è®°</category>
      </categories>
      <tags>
        <tag>æ‚è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>Moectf2025ReverseWriteUp</title>
    <url>/2025/10/12/Moectf2025ReverseWriteUp/</url>
    <content><![CDATA[<p>Moectf2025 Reverseæ–¹å‘å…¨è§£&amp;è¯¦è§£</p>
<span id="more"></span>

<h2 id="week1"><a href="#week1" class="headerlink" title="week1"></a>week1</h2><h3 id="upx"><a href="#upx" class="headerlink" title="upx"></a>upx</h3><ul>
<li><p>é™„ä»¶ç¨‹åºç”¨010editoræ‰“å¼€ï¼Œå¯ä»¥çœ‹åˆ°upxç‰ˆæœ¬ï¼Œå¯ä»¥æ‰¾å¯¹åº”ç‰ˆæœ¬upxç¨‹åºè„±å£³ï¼Œä¹Ÿå¯ä»¥æ‰‹åŠ¨è„±å£³ï¼ˆé‡‡ç”¨å†…å­˜é•œåƒæ³•ï¼‰ï¼š</p>
<p>ç”¨x64dbgæ‰“å¼€ç¨‹åºï¼Œå…ˆç§»é™¤é¢„è®¾æ–­ç‚¹</p>
<p><img src="/../images/image-20250828230432945-1760193218428-1.png" alt="ç§»é™¤é¢„è®¾æ–­ç‚¹"></p>
<p>åœ¨â€œå†…å­˜æ˜ å°„â€çª—å£ç»™ç¨‹åºçš„.rsrcæ®µä¸‹ä¸€æ¬¡æ€§å†…å­˜è®¿é—®æ–­ç‚¹ï¼ŒF9è¿è¡Œ</p>
<p><img src="/../images/image-20250828230606530-1760193218428-2.png" alt="ä¸‹ä¸€æ¬¡æ€§è¯»å–æ–­ç‚¹"></p>
<p>ç„¶ååœ¨UPX0æ®µæˆ–è€…UPX1æ®µä¸‹ä¸€æ¬¡æ€§å†…å­˜å†™å…¥æ–­ç‚¹ï¼ŒF9è¿è¡Œ</p>
<p><img src="/../images/image-20250828230727951-1760193218429-4.png" alt="ä¸‹ä¸€æ¬¡æ€§å†…å­˜å†™å…¥æ–­ç‚¹"></p>
<p>å›åˆ°â€œCPUâ€çª—å£ï¼Œå¯ä»¥çœ‹åˆ°åœ¨RIPä¸è¿œå¤„æœ‰ä¸€ä¸ªå¤§è·³ï¼ˆRIPåœ¨0x00007FF7BB887423å¤„)</p>
<p><img src="/../images/image-20250828231133499-1760193218429-8.png" alt="å¤§è·³"></p>
<p>è·Ÿè¿›å»ï¼Œè¿˜æœ‰ä¸ªè·³è½¬è¡¨ï¼Œç»§ç»­è·Ÿè¿›ï¼Œå¯ä»¥çœ‹åˆ°ç¨‹åºçš„OEPäº†</p>
<p><img src="/../images/image-20250828231234644-1760193218428-3.png" alt="OEP"></p>
<p>ç„¶ååœ¨æ­¤å¤„ä½¿ç”¨scylla dumpå‡ºç¨‹åºï¼Œå¹¶ä¸”ä¿®å¤IATï¼Œå¾—åˆ°upx_dump_SCY.exeï¼Œå¯ä»¥åˆ†æäº†</p>
</li>
<li><p>åˆ†æmainå‡½æ•°ï¼Œå‘ç°æ¯ä¸ªè¾“å…¥çš„å­—ç¬¦å¼‚æˆ–äº†0x21ï¼Œè€Œéæœ«ä½å­—ç¬¦è¿˜å¼‚æˆ–äº†åŸæ¥çš„ä¸‹ä¸€ä½ã€‚ç”±äºå¼‚æˆ–æœ‰äº¤æ¢å¾‹ï¼Œæ‰€ä»¥è§£å¯†é€»è¾‘å¯ä»¥æ˜¯ï¼šå…ˆå¯¹æ¯ä¸ªå¤„ç†å®Œçš„å­—ç¬¦å¼‚æˆ–0x21ï¼Œç„¶åå†ä»å€’æ•°ç¬¬äºŒä½å¼€å§‹å’Œä¸‹ä¸€ä½å¼‚æˆ–ï¼Œè¿™æ ·å°±æ¢å¤äº†å¤åŸå‡ºäº†flagï¼ˆä½†æ˜¯ç»™çš„å¯†æ–‡å°‘äº†æœ€åä¸€ä½ï¼Œå³å­—ç¬¦ä¸²çš„ç»“æŸç¬¦ã€‚æ ¹æ®æœ€åä¸€ä½å’Œå€’æ•°ç¬¬äºŒä½çš„å…³ç³»0x56&#x3D;125 ^ 0x21 ^ æœ«ä½ å¾—å‡ºï¼šæœ«ä½&#x3D;10ï¼Œæ‰€ä»¥æœ«ä½^0x21&#x3D;43ï¼Œå°†å¯†æ–‡è¡¥å……å®Œæ•´ï¼‰</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-comment">//mainå‡½æ•°</span><br>__int64 <span class="hljs-title function_">sub_7FF6FC2718A0</span><span class="hljs-params">()</span><br>&#123;<br>  <span class="hljs-type">char</span> *v0; <span class="hljs-comment">// rdi</span><br>  __int64 i; <span class="hljs-comment">// rcx</span><br>  FILE *Stream; <span class="hljs-comment">// rax</span><br>  _BYTE v4[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [rsp+0h] [rbp-20h] BYREF</span><br>  <span class="hljs-type">char</span> v5; <span class="hljs-comment">// [rsp+20h] [rbp+0h] BYREF</span><br>  _DWORD cipher[<span class="hljs-number">44</span>]; <span class="hljs-comment">// [rsp+30h] [rbp+10h]</span><br>  <span class="hljs-type">char</span> flag[<span class="hljs-number">132</span>]; <span class="hljs-comment">// [rsp+E0h] [rbp+C0h] BYREF</span><br>  <span class="hljs-type">int</span> length; <span class="hljs-comment">// [rsp+164h] [rbp+144h]</span><br>  _BYTE v9[<span class="hljs-number">60</span>]; <span class="hljs-comment">// [rsp+188h] [rbp+168h]</span><br>  <span class="hljs-type">int</span> j; <span class="hljs-comment">// [rsp+1C4h] [rbp+1A4h]</span><br>  <span class="hljs-type">int</span> Char; <span class="hljs-comment">// [rsp+1E4h] [rbp+1C4h]</span><br>  <span class="hljs-type">int</span> k; <span class="hljs-comment">// [rsp+204h] [rbp+1E4h]</span><br><br>  v0 = &amp;v5;<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">130LL</span>; i; --i )<br>  &#123;<br>    *(_DWORD *)v0 = <span class="hljs-number">-858993460</span>;<br>    v0 += <span class="hljs-number">4</span>;<br>  &#125;<br>  sub_7FF6FC271375((__int64)&amp;word_7FF6FC28200E);<br>  cipher[<span class="hljs-number">0</span>] = <span class="hljs-number">35</span>;<br>  cipher[<span class="hljs-number">1</span>] = <span class="hljs-number">43</span>;<br>  cipher[<span class="hljs-number">2</span>] = <span class="hljs-number">39</span>;<br>  cipher[<span class="hljs-number">3</span>] = <span class="hljs-number">54</span>;<br>  cipher[<span class="hljs-number">4</span>] = <span class="hljs-number">51</span>;<br>  cipher[<span class="hljs-number">5</span>] = <span class="hljs-number">60</span>;<br>  cipher[<span class="hljs-number">6</span>] = <span class="hljs-number">3</span>;<br>  cipher[<span class="hljs-number">7</span>] = <span class="hljs-number">72</span>;<br>  cipher[<span class="hljs-number">8</span>] = <span class="hljs-number">100</span>;<br>  cipher[<span class="hljs-number">9</span>] = <span class="hljs-number">11</span>;<br>  cipher[<span class="hljs-number">10</span>] = <span class="hljs-number">29</span>;<br>  cipher[<span class="hljs-number">11</span>] = <span class="hljs-number">118</span>;<br>  cipher[<span class="hljs-number">12</span>] = <span class="hljs-number">123</span>;<br>  cipher[<span class="hljs-number">13</span>] = <span class="hljs-number">16</span>;<br>  cipher[<span class="hljs-number">14</span>] = <span class="hljs-number">11</span>;<br>  cipher[<span class="hljs-number">15</span>] = <span class="hljs-number">58</span>;<br>  cipher[<span class="hljs-number">16</span>] = <span class="hljs-number">63</span>;<br>  cipher[<span class="hljs-number">17</span>] = <span class="hljs-number">101</span>;<br>  cipher[<span class="hljs-number">18</span>] = <span class="hljs-number">118</span>;<br>  cipher[<span class="hljs-number">19</span>] = <span class="hljs-number">41</span>;<br>  cipher[<span class="hljs-number">20</span>] = <span class="hljs-number">21</span>;<br>  cipher[<span class="hljs-number">21</span>] = <span class="hljs-number">55</span>;<br>  cipher[<span class="hljs-number">22</span>] = <span class="hljs-number">28</span>;<br>  cipher[<span class="hljs-number">23</span>] = <span class="hljs-number">10</span>;<br>  cipher[<span class="hljs-number">24</span>] = <span class="hljs-number">8</span>;<br>  cipher[<span class="hljs-number">25</span>] = <span class="hljs-number">33</span>;<br>  cipher[<span class="hljs-number">26</span>] = <span class="hljs-number">62</span>;<br>  cipher[<span class="hljs-number">27</span>] = <span class="hljs-number">60</span>;<br>  cipher[<span class="hljs-number">28</span>] = <span class="hljs-number">61</span>;<br>  cipher[<span class="hljs-number">29</span>] = <span class="hljs-number">22</span>;<br>  cipher[<span class="hljs-number">30</span>] = <span class="hljs-number">11</span>;<br>  cipher[<span class="hljs-number">31</span>] = <span class="hljs-number">36</span>;<br>  cipher[<span class="hljs-number">32</span>] = <span class="hljs-number">41</span>;<br>  cipher[<span class="hljs-number">33</span>] = <span class="hljs-number">36</span>;<br>  cipher[<span class="hljs-number">34</span>] = <span class="hljs-number">86</span>;<br>  sub_7FF6FC27119F((__int64)aPleaseInputYou);   <span class="hljs-comment">// &quot;please input your flag: &quot;</span><br>  Stream = _acrt_iob_func(<span class="hljs-number">0</span>);<br>  fgets(flag, <span class="hljs-number">100</span>, Stream);<br>  length = j_strlen(flag);<br>  <span class="hljs-keyword">for</span> ( j = <span class="hljs-number">0</span>; j &lt; length; ++j )<br>  &#123;<br>    Char = flag[j] ^ <span class="hljs-number">0x21</span>;<br>    <span class="hljs-keyword">if</span> ( j &lt; length - <span class="hljs-number">1</span> )<br>      Char ^= flag[j + <span class="hljs-number">1</span>];<br>    v9[j] = Char;<br>  &#125;<br>  <span class="hljs-keyword">for</span> ( k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">35</span>; ++k )<br>  &#123;<br>    <span class="hljs-keyword">if</span> ( (<span class="hljs-type">char</span>)v9[k] != cipher[k] )<br>    &#123;<br>      sub_7FF6FC27119F((__int64)aYouWillNeverGe);<span class="hljs-comment">// &quot;you will never get the flag!!!!\n&quot;</span><br>      <span class="hljs-keyword">break</span>;<br>    &#125;<br>  &#125;<br>  sub_7FF6FC271311(v4, qword_7FF6FC27AD00);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>è§£å¯†è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">enc=[<br>    <span class="hljs-number">0x23</span>, <span class="hljs-number">0x2b</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x3c</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x48</span>,<br>    <span class="hljs-number">0x64</span>, <span class="hljs-number">0x0b</span>, <span class="hljs-number">0x1d</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x7b</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x0b</span>, <span class="hljs-number">0x3a</span>,<br>    <span class="hljs-number">0x3f</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x1c</span>, <span class="hljs-number">0x0a</span>,<br>    <span class="hljs-number">0x08</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x3e</span>, <span class="hljs-number">0x3c</span>, <span class="hljs-number">0x3d</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x0b</span>, <span class="hljs-number">0x24</span>,<br>    <span class="hljs-number">0x29</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">43</span>			<br>]<br>xored=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc)):<br>    xored.append(enc[i]^<span class="hljs-number">0x21</span>)<br><span class="hljs-comment">#print(xored)</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(xored)-<span class="hljs-number">2</span>,-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>):<br>    xored[i]=xored[i]^xored[i+<span class="hljs-number">1</span>]<br>flag=<span class="hljs-string">&#x27;&#x27;</span>.join(<span class="hljs-built_in">chr</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xored)<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure></li>
</ul>
<h3 id="maze"><a href="#maze" class="headerlink" title="maze"></a>maze</h3><ul>
<li><p>é™„ä»¶ç¨‹åºmainå‡½æ•°é€»è¾‘å¦‚ä¸‹ï¼Œwasdè¿·å®«é¢˜ï¼Œè¿·å®«åœ¨å‡½æ•°maze_initä¸­</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> __fastcall <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **argv, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **envp)</span><br>&#123;<br>  <span class="hljs-type">unsigned</span> __int64 count; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">int</span> v4; <span class="hljs-comment">// ebx</span><br>  __int64 index; <span class="hljs-comment">// r9</span><br>  <span class="hljs-type">int</span> v6; <span class="hljs-comment">// r11d</span><br>  <span class="hljs-type">unsigned</span> __int64 y; <span class="hljs-comment">// r8</span><br>  __int64 x; <span class="hljs-comment">// r10</span><br>  <span class="hljs-type">unsigned</span> __int64 n0x37_1; <span class="hljs-comment">// rdi</span><br>  <span class="hljs-type">char</span> *Format; <span class="hljs-comment">// rcx</span><br>  _BYTE flag[<span class="hljs-number">1008</span>]; <span class="hljs-comment">// [rsp+20h] [rbp-408h]</span><br><br>  maze_init();<br>  <span class="hljs-built_in">printf</span>(asc_140004138);<br>  <span class="hljs-built_in">printf</span>(&amp;Format_);<br>  <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>  &#123;<br>LABEL_2:<br>    <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>    &#123;<br>      <span class="hljs-built_in">printf</span>(asc_140004190);<br>      <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%s&quot;</span>);<br>      count = <span class="hljs-number">-1LL</span>;<br>      <span class="hljs-keyword">do</span><br>        ++count;<br>      <span class="hljs-keyword">while</span> ( flag[count] );<br>      <span class="hljs-keyword">if</span> ( count &lt;= <span class="hljs-number">999</span> )<br>        <span class="hljs-keyword">break</span>;<br>      <span class="hljs-built_in">printf</span>(&amp;Format__0);<br>    &#125;<br>    v4 = <span class="hljs-number">1</span>;<br>    index = <span class="hljs-number">0LL</span>;<br>    v6 = <span class="hljs-number">1</span>;<br>    y = <span class="hljs-number">1LL</span>;<span class="hljs-comment">// èµ·ç‚¹y</span><br>    x = <span class="hljs-number">1LL</span>;<span class="hljs-comment">// èµ·ç‚¹x</span><br>    <span class="hljs-keyword">if</span> ( (<span class="hljs-type">int</span>)count &gt; <span class="hljs-number">0</span> )<br>      <span class="hljs-keyword">break</span>;<br>LABEL_19:<br>    Format = (<span class="hljs-type">char</span> *)&amp;byte_140004118;<br>LABEL_20:<br>    <span class="hljs-built_in">printf</span>(Format);<br>    <span class="hljs-built_in">printf</span>(&amp;Format__1);<br>  &#125;<br>  n0x37_1 = <span class="hljs-number">1LL</span>;<br>  <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>  &#123;<br>    <span class="hljs-keyword">switch</span> ( flag[index] )<br>    &#123;<br>      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;A&#x27;</span>:<br>      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;a&#x27;</span>:<br>        --v4;<br>        --x;<br>        --n0x37_1;<br>        <span class="hljs-keyword">break</span>;<br>      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;D&#x27;</span>:<br>      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;d&#x27;</span>:<br>        ++v4;<br>        ++x;<br>        ++n0x37_1;<br>        <span class="hljs-keyword">break</span>;<br>      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;S&#x27;</span>:<br>      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;s&#x27;</span>:<br>        ++v6;<br>        ++y;<br>        <span class="hljs-keyword">break</span>;<br>      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;W&#x27;</span>:<br>      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;w&#x27;</span>:<br>        --v6;<br>        --y;<br>        <span class="hljs-keyword">break</span>;<br>      <span class="hljs-keyword">default</span>:<br>        <span class="hljs-built_in">printf</span>(&amp;Format__2);<br>        <span class="hljs-built_in">printf</span>(&amp;Format__1);<br>        <span class="hljs-keyword">goto</span> LABEL_2;<br>    &#125;<br>    <span class="hljs-keyword">if</span> ( y &gt; <span class="hljs-number">0x37</span> || n0x37_1 &gt; <span class="hljs-number">0x37</span> )<br>    &#123;<br>      Format = (<span class="hljs-type">char</span> *)&amp;unk_1400040D8;<br>      <span class="hljs-keyword">goto</span> LABEL_20;<br>    &#125;<br>    <span class="hljs-keyword">if</span> ( byte_140005660[<span class="hljs-number">56</span> * y + x] == <span class="hljs-number">49</span> )<br>    &#123;<br>      Format = (<span class="hljs-type">char</span> *)&amp;unk_1400040F8;<br>      <span class="hljs-keyword">goto</span> LABEL_20;<br>    &#125;<br>    <span class="hljs-keyword">if</span> ( y == <span class="hljs-number">15</span> &amp;&amp; x == <span class="hljs-number">32</span> )<br>      <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">if</span> ( ++index &gt;= (<span class="hljs-type">int</span>)count )<br>      <span class="hljs-keyword">goto</span> LABEL_19;<br>  &#125;<br>  <span class="hljs-built_in">printf</span>(asc_1400041E0);<br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;moectf&#123;%s&#125;\n&quot;</span>);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>maze_initå‡½æ•°ï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c">__int64 <span class="hljs-title function_">maze_init</span><span class="hljs-params">()</span><br>&#123;<br>  <span class="hljs-type">const</span> <span class="hljs-type">char</span> *all_1; <span class="hljs-comment">// r9</span><br>  <span class="hljs-type">const</span> <span class="hljs-type">char</span> **v1; <span class="hljs-comment">// rbx</span><br>  <span class="hljs-type">int</span> n56_2; <span class="hljs-comment">// r11d</span><br>  __int64 v3; <span class="hljs-comment">// r10</span><br>  __int64 n56; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">int</span> v5; <span class="hljs-comment">// r8d</span><br>  __int64 i; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">char</span> v7; <span class="hljs-comment">// dl</span><br>  __int64 v8; <span class="hljs-comment">// rcx</span><br>  _QWORD v9[<span class="hljs-number">56</span>]; <span class="hljs-comment">// [rsp+20h] [rbp-E0h] BYREF</span><br><br>  v9[<span class="hljs-number">1</span>] = <span class="hljs-string">&quot;10100000000000000010000011011101011111111101011100000111&quot;</span>;<br>  all_1 = <span class="hljs-string">&quot;11111111111111111111111111111111111111111111111111111111&quot;</span>;<br>  v9[<span class="hljs-number">0</span>] = <span class="hljs-string">&quot;11111111111111111111111111111111111111111111111111111111&quot;</span>;<br>  v9[<span class="hljs-number">2</span>] = <span class="hljs-string">&quot;10111010111111111010111011000001000001000001000101110111&quot;</span>;<br>  v9[<span class="hljs-number">3</span>] = <span class="hljs-string">&quot;10000010000010000010001011011111111101110111011101110111&quot;</span>;<br>  v9[<span class="hljs-number">4</span>] = <span class="hljs-string">&quot;10111111111011101110111011010000000000010100010001110111&quot;</span>;<br>  v9[<span class="hljs-number">5</span>] = <span class="hljs-string">&quot;10100000001000101000100011010101111111011101110101110111&quot;</span>;<br>  v9[<span class="hljs-number">6</span>] = <span class="hljs-string">&quot;10101011111110111011101011010101000001000000010101110111&quot;</span>;<br>  v9[<span class="hljs-number">7</span>] = <span class="hljs-string">&quot;10101010000010100000101011110101110101111101111111110111&quot;</span>;<br>  v9[<span class="hljs-number">8</span>] = <span class="hljs-string">&quot;10111010111010101111101011100101000100000101000101110111&quot;</span>;<br>  v9[<span class="hljs-number">9</span>] = <span class="hljs-string">&quot;10000010001010001000001011001111011111010101011101110111&quot;</span>;<br>  v9[<span class="hljs-number">10</span>] = <span class="hljs-string">&quot;11111011101011111011111111101000100000101100101001110111&quot;</span>;<br>  v9[<span class="hljs-number">11</span>] = <span class="hljs-string">&quot;10001010001000100010000010001010011000100010010011000001&quot;</span>;<br>  v9[<span class="hljs-number">12</span>] = <span class="hljs-string">&quot;10111010111110101010111011011001011111010101011101011101&quot;</span>;<br>  v9[<span class="hljs-number">13</span>] = <span class="hljs-string">&quot;10001010001000001010001011000101000100000101000101011101&quot;</span>;<br>  v9[<span class="hljs-number">14</span>] = <span class="hljs-string">&quot;11101011101111111011101011110101110111111101110101011101&quot;</span>;<br>  v9[<span class="hljs-number">15</span>] = <span class="hljs-string">&quot;10001000101000001010001011000100010100000101000101011101&quot;</span>;<br>  v9[<span class="hljs-number">16</span>] = <span class="hljs-string">&quot;10111111101011101110111011011111110101110111011101011101&quot;</span>;<br>  v9[<span class="hljs-number">17</span>] = <span class="hljs-string">&quot;10001000001000100000001011000100000100010000000101011001&quot;</span>;<br>  v9[<span class="hljs-number">18</span>] = <span class="hljs-string">&quot;11101011111011111111101011110101111101111111110101011011&quot;</span>;<br>  v9[<span class="hljs-number">19</span>] = <span class="hljs-string">&quot;10101000000010001000101011010100000001000100010101011011&quot;</span>;<br>  v9[<span class="hljs-number">20</span>] = <span class="hljs-string">&quot;10101111111110101010101011010111111111010101010101011011&quot;</span>;<br>  v9[<span class="hljs-number">21</span>] = <span class="hljs-string">&quot;10100000000000100010101011010000000000010001010101011011&quot;</span>;<br>  v9[<span class="hljs-number">22</span>] = <span class="hljs-string">&quot;10111111111111111110111011011111111111111111011101011011&quot;</span>;<br>  v9[<span class="hljs-number">23</span>] = <span class="hljs-string">&quot;10000000001111000000000011110111010000111100011111011011&quot;</span>;<br>  v9[<span class="hljs-number">24</span>] = <span class="hljs-string">&quot;11101111100000011011011111111010110111011101100001011011&quot;</span>;<br>  v9[<span class="hljs-number">25</span>] = <span class="hljs-string">&quot;11101111111111111011011111111101110111101101100001011011&quot;</span>;<br>  v9[<span class="hljs-number">26</span>] = <span class="hljs-string">&quot;10001000111111000010000011111010110111011101100001011011&quot;</span>;<br>  v9[<span class="hljs-number">27</span>] = <span class="hljs-string">&quot;10111010111111111010111011110111010000111101100001010011&quot;</span>;<br>  v9[<span class="hljs-number">28</span>] = <span class="hljs-string">&quot;10000010000010000010001011111111111111111101100001010111&quot;</span>;<br>  v9[<span class="hljs-number">29</span>] = <span class="hljs-string">&quot;10111111111011101110111011110001000110001101100001010001&quot;</span>;<br>  v9[<span class="hljs-number">30</span>] = <span class="hljs-string">&quot;10100000001000101000100011110111011101111101100001011101&quot;</span>;<br>  v9[<span class="hljs-number">31</span>] = <span class="hljs-string">&quot;10101011111110111011101011110001000101111101100001011101&quot;</span>;<br>  v9[<span class="hljs-number">32</span>] = <span class="hljs-string">&quot;10101010000010100000101011111101011101111101100001011101&quot;</span>;<br>  v9[<span class="hljs-number">33</span>] = <span class="hljs-string">&quot;10111010111010101111101011110001000110001101100001011101&quot;</span>;<br>  v9[<span class="hljs-number">34</span>] = <span class="hljs-string">&quot;10000010001010101000001011111111111111111101100001011101&quot;</span>;<br>  v9[<span class="hljs-number">35</span>] = <span class="hljs-string">&quot;11111011101011111011111110000000000000001101100001011101&quot;</span>;<br>  v9[<span class="hljs-number">36</span>] = <span class="hljs-string">&quot;10001010001000100010000011111111111111111100110011011101&quot;</span>;<br>  v9[<span class="hljs-number">37</span>] = <span class="hljs-string">&quot;10111010111110101010111010010000000011111110001111011101&quot;</span>;<br>  v9[<span class="hljs-number">38</span>] = <span class="hljs-string">&quot;10001010001000001010001010110111000001111110100101011101&quot;</span>;<br>  v9[<span class="hljs-number">39</span>] = <span class="hljs-string">&quot;11101011101111111011101000110011001111111100110111011101&quot;</span>;<br>  v9[<span class="hljs-number">40</span>] = <span class="hljs-string">&quot;10001000101000001010001011111111111111111111110111010001&quot;</span>;<br>  v1 = (<span class="hljs-type">const</span> <span class="hljs-type">char</span> **)v9;<br>  v9[<span class="hljs-number">55</span>] = <span class="hljs-string">&quot;11111111111111111111111111111111111111111111111111111111&quot;</span>;<br>  v9[<span class="hljs-number">41</span>] = <span class="hljs-string">&quot;10111111101011101110111010100001001100000000000011011011&quot;</span>;<br>  n56_2 = <span class="hljs-number">0</span>;<br>  v9[<span class="hljs-number">42</span>] = <span class="hljs-string">&quot;10001000001000100000001011111111111101011101111001011011&quot;</span>;<br>  v3 = <span class="hljs-number">0LL</span>;<br>  v9[<span class="hljs-number">43</span>] = <span class="hljs-string">&quot;10101011111011111111101011000000000001000100010111011011&quot;</span>;<br>  v9[<span class="hljs-number">44</span>] = <span class="hljs-string">&quot;10101000000010001000101010010111111111111111111111011011&quot;</span>;<br>  v9[<span class="hljs-number">45</span>] = <span class="hljs-string">&quot;10101111111110101010101010110111111111111111111101011011&quot;</span>;<br>  v9[<span class="hljs-number">46</span>] = <span class="hljs-string">&quot;10100000000000100010101011100000000000000000000011011011&quot;</span>;<br>  v9[<span class="hljs-number">47</span>] = <span class="hljs-string">&quot;10111111111111111110011011111111111111111111111011011011&quot;</span>;<br>  v9[<span class="hljs-number">48</span>] = <span class="hljs-string">&quot;10000011111111111111000010000000000000000000000000011001&quot;</span>;<br>  v9[<span class="hljs-number">49</span>] = <span class="hljs-string">&quot;11111011111111111111111111111111111111111111111111111101&quot;</span>;<br>  v9[<span class="hljs-number">50</span>] = <span class="hljs-string">&quot;11111011100001100110110111000000000000000000000111111101&quot;</span>;<br>  v9[<span class="hljs-number">51</span>] = <span class="hljs-string">&quot;11111011101111011010000111011111111111111111110111111101&quot;</span>;<br>  v9[<span class="hljs-number">52</span>] = <span class="hljs-string">&quot;11111011100001000010110110000111111111111111110000000001&quot;</span>;<br>  v9[<span class="hljs-number">53</span>] = <span class="hljs-string">&quot;11111011101111011010110111101111111111111111111111111111&quot;</span>;<br>  v9[<span class="hljs-number">54</span>] = <span class="hljs-string">&quot;11110000000000011000110000000000000000000000000000000011&quot;</span>;<br>  <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>  &#123;<br>    n56 = <span class="hljs-number">-1LL</span>;<br>    <span class="hljs-keyword">do</span><br>      ++n56;<br>    <span class="hljs-keyword">while</span> ( all_1[n56] );<br>    <span class="hljs-keyword">if</span> ( n56 != <span class="hljs-number">56</span> )<br>    &#123;<br>      <span class="hljs-built_in">printf</span>((<span class="hljs-type">char</span> *)&amp;Format__3);<br>      <span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>);<br>    &#125;<br>    v5 = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0LL</span>; i &lt; <span class="hljs-number">56</span>; ++i )<br>    &#123;<br>      v7 = all_1[i];<br>      <span class="hljs-keyword">if</span> ( (<span class="hljs-type">unsigned</span> __int8)(v7 - <span class="hljs-number">48</span>) &gt; <span class="hljs-number">1u</span> )<br>      &#123;<br>        <span class="hljs-built_in">printf</span>((<span class="hljs-type">char</span> *)&amp;Format__4);<br>        <span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>);<br>      &#125;<br>      v8 = v3 + i;<br>      ++v5;<br>      byte_140005660[v8] = v7;<br>    &#125;<br>    ++n56_2;<br>    ++v1;<br>    v3 += <span class="hljs-number">56LL</span>;<br>    <span class="hljs-keyword">if</span> ( n56_2 &gt;= <span class="hljs-number">56</span> )<br>      <span class="hljs-keyword">break</span>;<br>    all_1 = *v1;<br>  &#125;<br>  <span class="hljs-keyword">if</span> ( n48 != <span class="hljs-number">48</span> )<br>  &#123;<br>    <span class="hljs-built_in">printf</span>((<span class="hljs-type">char</span> *)&amp;Format);<br>    <span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>);<br>  &#125;<br>  <span class="hljs-keyword">if</span> ( n48_0 != <span class="hljs-number">48</span> )<br>  &#123;<br>    <span class="hljs-built_in">printf</span>((<span class="hljs-type">char</span> *)&amp;Format__5);<br>    <span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>);<br>  &#125;<br>  <span class="hljs-keyword">return</span> i;<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>ä½¿ç”¨ç¥å¥‡å¦™å¦™å·¥å…·å¾—åˆ°è¿·å®«è·¯å¾„ï¼š</p>
<figure class="highlight py"><table><tr><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">from</span> mycode <span class="hljs-keyword">import</span> maze<br>Maze = [<br>    <span class="hljs-string">&quot;11111111111111111111111111111111111111111111111111111111&quot;</span>,<br>    <span class="hljs-string">&quot;10100000000000000010000011011101011111111101011100000111&quot;</span>,<br>    <span class="hljs-string">&quot;10111010111111111010111011000001000001000001000101110111&quot;</span>,<br>    <span class="hljs-string">&quot;10000010000010000010001011011111111101110111011101110111&quot;</span>,<br>    <span class="hljs-string">&quot;10111111111011101110111011010000000000010100010001110111&quot;</span>,<br>    <span class="hljs-string">&quot;10100000001000101000100011010101111111011101110101110111&quot;</span>,<br>    <span class="hljs-string">&quot;10101011111110111011101011010101000001000000010101110111&quot;</span>,<br>    <span class="hljs-string">&quot;10101010000010100000101011110101110101111101111111110111&quot;</span>,<br>    <span class="hljs-string">&quot;10111010111010101111101011100101000100000101000101110111&quot;</span>,<br>    <span class="hljs-string">&quot;10000010001010001000001011001111011111010101011101110111&quot;</span>,<br>    <span class="hljs-string">&quot;11111011101011111011111111101000100000101100101001110111&quot;</span>,<br>    <span class="hljs-string">&quot;10001010001000100010000010001010011000100010010011000001&quot;</span>,<br>    <span class="hljs-string">&quot;10111010111110101010111011011001011111010101011101011101&quot;</span>,<br>    <span class="hljs-string">&quot;10001010001000001010001011000101000100000101000101011101&quot;</span>,<br>    <span class="hljs-string">&quot;11101011101111111011101011110101110111111101110101011101&quot;</span>,<br>    <span class="hljs-string">&quot;10001000101000001010001011000100010100000101000101011101&quot;</span>,<br>    <span class="hljs-string">&quot;10111111101011101110111011011111110101110111011101011101&quot;</span>,<br>    <span class="hljs-string">&quot;10001000001000100000001011000100000100010000000101011001&quot;</span>,<br>    <span class="hljs-string">&quot;11101011111011111111101011110101111101111111110101011011&quot;</span>,<br>    <span class="hljs-string">&quot;10101000000010001000101011010100000001000100010101011011&quot;</span>,<br>    <span class="hljs-string">&quot;10101111111110101010101011010111111111010101010101011011&quot;</span>,<br>    <span class="hljs-string">&quot;10100000000000100010101011010000000000010001010101011011&quot;</span>,<br>    <span class="hljs-string">&quot;10111111111111111110111011011111111111111111011101011011&quot;</span>,<br>    <span class="hljs-string">&quot;10000000001111000000000011110111010000111100011111011011&quot;</span>,<br>    <span class="hljs-string">&quot;11101111100000011011011111111010110111011101100001011011&quot;</span>,<br>    <span class="hljs-string">&quot;11101111111111111011011111111101110111101101100001011011&quot;</span>,<br>    <span class="hljs-string">&quot;10001000111111000010000011111010110111011101100001011011&quot;</span>,<br>    <span class="hljs-string">&quot;10111010111111111010111011110111010000111101100001010011&quot;</span>,<br>    <span class="hljs-string">&quot;10000010000010000010001011111111111111111101100001010111&quot;</span>,<br>    <span class="hljs-string">&quot;10111111111011101110111011110001000110001101100001010001&quot;</span>,<br>    <span class="hljs-string">&quot;10100000001000101000100011110111011101111101100001011101&quot;</span>,<br>    <span class="hljs-string">&quot;10101011111110111011101011110001000101111101100001011101&quot;</span>,<br>    <span class="hljs-string">&quot;10101010000010100000101011111101011101111101100001011101&quot;</span>,<br>    <span class="hljs-string">&quot;10111010111010101111101011110001000110001101100001011101&quot;</span>,<br>    <span class="hljs-string">&quot;10000010001010101000001011111111111111111101100001011101&quot;</span>,<br>    <span class="hljs-string">&quot;11111011101011111011111110000000000000001101100001011101&quot;</span>,<br>    <span class="hljs-string">&quot;10001010001000100010000011111111111111111100110011011101&quot;</span>,<br>    <span class="hljs-string">&quot;10111010111110101010111010010000000011111110001111011101&quot;</span>,<br>    <span class="hljs-string">&quot;10001010001000001010001010110111000001111110100101011101&quot;</span>,<br>    <span class="hljs-string">&quot;11101011101111111011101000110011001111111100110111011101&quot;</span>,<br>    <span class="hljs-string">&quot;10001000101000001010001011111111111111111111110111010001&quot;</span>,<br>    <span class="hljs-string">&quot;10111111101011101110111010100001001100000000000011011011&quot;</span>,<br>    <span class="hljs-string">&quot;10001000001000100000001011111111111101011101111001011011&quot;</span>,<br>    <span class="hljs-string">&quot;10101011111011111111101011000000000001000100010111011011&quot;</span>,<br>    <span class="hljs-string">&quot;10101000000010001000101010010111111111111111111111011011&quot;</span>,<br>    <span class="hljs-string">&quot;10101111111110101010101010110111111111111111111101011011&quot;</span>,<br>    <span class="hljs-string">&quot;10100000000000100010101011100000000000000000000011011011&quot;</span>,<br>    <span class="hljs-string">&quot;10111111111111111110011011111111111111111111111011011011&quot;</span>,<br>    <span class="hljs-string">&quot;10000011111111111111000010000000000000000000000000011001&quot;</span>,<br>    <span class="hljs-string">&quot;11111011111111111111111111111111111111111111111111111101&quot;</span>,<br>    <span class="hljs-string">&quot;11111011100001100110110111000000000000000000000111111101&quot;</span>,<br>    <span class="hljs-string">&quot;11111011101111011010000111011111111111111111110111111101&quot;</span>,<br>    <span class="hljs-string">&quot;11111011100001000010110110000111111111111111110000000001&quot;</span>,<br>    <span class="hljs-string">&quot;11111011101111011010110111101111111111111111111111111111&quot;</span>,<br>    <span class="hljs-string">&quot;11110000000000011000110000000000000000000000000000000011&quot;</span>,<br>    <span class="hljs-string">&quot;11111111111111111111111111111111111111111111111111111111&quot;</span><br>]<br>start=(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)<br>end=(<span class="hljs-number">15</span>,<span class="hljs-number">32</span>)<br>path=maze.solve(Maze,start,end)<br><span class="hljs-built_in">print</span>(path)<br><br><br><span class="hljs-comment">#mycode.maze:</span><br><span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> deque<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">solve</span>(<span class="hljs-params">maze, start, end, directions=<span class="hljs-literal">None</span>, wall=<span class="hljs-string">&#x27;1&#x27;</span>, free=<span class="hljs-string">&#x27;0&#x27;</span></span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    å‚æ•°:</span><br><span class="hljs-string">        maze: äºŒç»´å­—ç¬¦ä¸²åˆ—è¡¨</span><br><span class="hljs-string">        start: èµ·ç‚¹åæ ‡ (row, col)</span><br><span class="hljs-string">        end: ç»ˆç‚¹åæ ‡ (row, col)</span><br><span class="hljs-string">        directions: è‡ªå®šä¹‰æ–¹å‘æŒ‡ä»¤ (é»˜è®¤WASD)</span><br><span class="hljs-string">        wall: å¢™å­—ç¬¦ (é»˜è®¤&#x27;1&#x27;)</span><br><span class="hljs-string">        free: é€šè·¯å­—ç¬¦ (é»˜è®¤&#x27;0&#x27;)</span><br><span class="hljs-string">    </span><br><span class="hljs-string">    è¿”å›:</span><br><span class="hljs-string">        ç§»åŠ¨æŒ‡ä»¤å­—ç¬¦ä¸² æˆ– None(æ— è§£)</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-keyword">if</span> directions <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>        directions = &#123;<br>            <span class="hljs-string">&#x27;W&#x27;</span>: (-<span class="hljs-number">1</span>, <span class="hljs-number">0</span>),  <span class="hljs-comment"># ä¸Š</span><br>            <span class="hljs-string">&#x27;A&#x27;</span>: (<span class="hljs-number">0</span>, -<span class="hljs-number">1</span>),   <span class="hljs-comment"># å·¦</span><br>            <span class="hljs-string">&#x27;S&#x27;</span>: (<span class="hljs-number">1</span>, <span class="hljs-number">0</span>),    <span class="hljs-comment"># ä¸‹</span><br>            <span class="hljs-string">&#x27;D&#x27;</span>: (<span class="hljs-number">0</span>, <span class="hljs-number">1</span>)     <span class="hljs-comment"># å³</span><br>        &#125;<br>    <br>    rows, cols = <span class="hljs-built_in">len</span>(maze), <span class="hljs-built_in">len</span>(maze[<span class="hljs-number">0</span>])<br>    <br>    <span class="hljs-comment"># åæ ‡éªŒè¯</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">is_valid</span>(<span class="hljs-params">pos</span>):<br>        r, c = pos<br>        <span class="hljs-keyword">return</span> (<span class="hljs-number">0</span> &lt;= r &lt; rows <span class="hljs-keyword">and</span> <span class="hljs-number">0</span> &lt;= c &lt; cols <span class="hljs-keyword">and</span> maze[r][c] == free)<br>    <br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> is_valid(start):<br>        <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">f&quot;æ— æ•ˆèµ·ç‚¹ <span class="hljs-subst">&#123;start&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> is_valid(end):<br>        <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">f&quot;æ— æ•ˆç»ˆç‚¹ <span class="hljs-subst">&#123;end&#125;</span>&quot;</span>)<br><br>    <span class="hljs-comment"># BFSæ ¸å¿ƒï¼ˆä¿®å¤äº†å˜é‡åå†²çªï¼‰</span><br>    queue = deque([(start[<span class="hljs-number">0</span>], start[<span class="hljs-number">1</span>], <span class="hljs-string">&quot;&quot;</span>)])<br>    visited = <span class="hljs-built_in">set</span>([(start[<span class="hljs-number">0</span>], start[<span class="hljs-number">1</span>])])<br>    <br>    <span class="hljs-keyword">while</span> queue:<br>        row, col, current_path = queue.popleft()  <span class="hljs-comment"># æ”¹åä¸º current_path</span><br>        <br>        <span class="hljs-keyword">if</span> (row, col) == end:<br>            <span class="hljs-keyword">return</span> current_path<br>        <br>        <span class="hljs-keyword">for</span> move, (dr, dc) <span class="hljs-keyword">in</span> directions.items():<br>            new_row, new_col = row + dr, col + dc<br>            <br>            <span class="hljs-keyword">if</span> (<span class="hljs-number">0</span> &lt;= new_row &lt; rows <span class="hljs-keyword">and</span> <span class="hljs-number">0</span> &lt;= new_col &lt; cols <span class="hljs-keyword">and</span> <br>                maze[new_row][new_col] == free <span class="hljs-keyword">and</span>  <span class="hljs-comment"># ä½¿ç”¨é€šè·¯å­—ç¬¦ free</span><br>                (new_row, new_col) <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> visited):<br>                <br>                visited.add((new_row, new_col))<br>                queue.append((new_row, new_col, current_path + move))  <span class="hljs-comment"># ä½¿ç”¨ current_path</span><br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>  <span class="hljs-comment"># æ— è§£</span><br></code></pre></td></tr></table></figure></li>
</ul>
<h3 id="flower"><a href="#flower" class="headerlink" title="flower"></a>flower</h3><ul>
<li><p>é™„ä»¶ç¨‹åºç”¨IDAæ‰“å¼€ï¼Œåœ¨æ±‡ç¼–ç•Œé¢ä¸Šä¸‹æ»‘åŠ¨å¯ä»¥æ‰¾åˆ°èŠ±æŒ‡ä»¤å¼•èµ·çš„çº¢è‰²æ ˆå¸§æŠ¥é”™ã€‚æ‰“å¼€IDAå·¥å…·æ çš„â€œOptionsâ€é€‰é¡¹çš„â€œGeneralâ€ï¼Œå‹¾é€‰â€œStackpointerâ€ï¼Œå¯ä»¥çœ‹åˆ°æ ˆå¸§ä¿¡æ¯</p>
<p><img src="/../images/image-20250829121800223-1760193218429-5.png" alt="General"></p>
<p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-08-29%20121722-1760193218429-7.png" alt="Stackpointer"></p>
<p>å¯ä»¥çœ‹åˆ°çº¢è‰²æŠ¥é”™çš„å‡½æ•°æ ˆå¸§è¶…è¿‡äº†1000ï¼Œæœ‰ç‚¹åå¸¸ï¼Œæ‰¾åˆ°æ ˆå¸§å‘ç”Ÿçªå˜çš„åœ°æ–¹ï¼Œå‘ç°ç”¨sub rsp,1000hæ”¹å˜äº†æ ˆå¸§ï¼ŒæŠŠè¿™æ¡æŒ‡ä»¤nopæ‰ã€‚æœ¬é¢˜è¿™ä¸ªç±»å‹çš„èŠ±æŒ‡ä»¤å ç»å¤§å¤šæ•°ï¼Œéœ€è¦è€å¿ƒçš„ä¸€ä¸ªä¸€ä¸ªnopæ‰ã€‚ï¼ˆè¿˜æœ‰sub rsp,400hçš„ï¼Œä¸»è¦ç•™æ„æ ˆå¸§å¤§äº100ï¼‰</p>
<p><img src="/../images/image-20250829122250848-1760193218429-6.png" alt="nopèŠ±æŒ‡ä»¤"></p>
<p>è¿˜æœ‰å¦ä¸€ç§èŠ±æŒ‡ä»¤ï¼š</p>
<p><img src="/../images/image-20250829130321938-1760193218429-9.png" alt="ç¬¬äºŒç§èŠ±æŒ‡ä»¤"></p>
<p>å›¾ä¸­Label+1æ˜¯0x004048EFï¼Œè¢«0x004048EEå¤„çš„æŒ‡ä»¤è¦†ç›–ä½äº†ï¼Œæ‰€ä»¥undefineä¸€ä¸‹ï¼ŒIDAå°±ä¼šè‡ªåŠ¨çº é”™ã€‚æŠŠæ²¡ç”¨çš„æŒ‡ä»¤nopæ‰</p>
<p><img src="/../images/image-20250829133142939-1760193218429-10.png" alt="è‡ªåŠ¨çº é”™"></p>
<p>æ¥ä¸‹æ¥è¦åšçš„ä¿®æ”¹æœ‰2ç‚¹ã€‚é¦–å…ˆå¯ä»¥çœ‹åˆ°0x004048E5å¤„æœ‰ä¸€ä¸ªæ’è·³èŠ±æŒ‡ä»¤ï¼Œè¿™ä¸ªè¦nopæ‰ã€‚</p>
<p><img src="/../images/image-20250829140959636-1760193218429-11.png" alt="nopæ‰æ’è·³"></p>
<p>ç„¶åæ˜¯call loc_4048EFï¼Œç”±äºcallæ˜¯ä¼šå ç”¨æ ˆå¸§çš„ï¼Œæ›´ä½•å†µcallä¸€ä¸ªæ ‡ç­¾æ²¡æœ‰retæ¢å¤æ ˆå¸§ï¼Œåé¢æ ˆå¸§è¿˜æ˜¯ä¼šæŠ¥é”™ï¼ˆè¿™é‡Œæœ‰ä¸€ä¸ªè¯•é”™è¿‡ç¨‹ï¼Œä¸æŠŠcallæ”¹æˆjmpçš„è¯ï¼Œå‡½æ•°undefine+code+create functionåä¾æ—§åç¼–è¯‘ä¸äº†ï¼‰ã€‚åšæ³•å°±æ˜¯å·¥å…·æ edit-&gt;patch program-&gt;change byteï¼ŒæŠŠåå…­è¿›åˆ¶ç E8æ”¹æˆE9</p>
<p><img src="/../images/image-20250829141054207-1760193218429-12.png" alt="callæ”¹jmp"></p>
<p>ç„¶åå°±æ˜¯é€‰ä¸­å‡½æ•°åundefine+code+create functionäº†ï¼Œå°±å¯ä»¥æ­£å¸¸åç¼–è¯‘äº†</p>
</li>
<li><p>mainå‡½æ•°é€»è¾‘ä¸»è¦æ˜¯æŠŠflagæå¤´å»å°¾ï¼Œä¸­é—´éƒ¨åˆ†åŠ å¯†åæ¯”å¯¹</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-type">unsigned</span> __int64 __fastcall <span class="hljs-title function_">solve</span><span class="hljs-params">(_QWORD *flag)</span><br>&#123;<br>  <span class="hljs-type">char</span> v1; <span class="hljs-comment">// bl</span><br>  <span class="hljs-type">bool</span> v2; <span class="hljs-comment">// r12</span><br>  __int64 v3; <span class="hljs-comment">// rax</span><br>  __int64 v4; <span class="hljs-comment">// rbx</span><br>  __int64 v5; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">char</span> *flag[i]; <span class="hljs-comment">// rax</span><br>  __int64 v7; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">char</span> v9; <span class="hljs-comment">// [rsp+17h] [rbp-59h] BYREF</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [rsp+18h] [rbp-58h]</span><br>  <span class="hljs-type">int</span> len; <span class="hljs-comment">// [rsp+1Ch] [rbp-54h]</span><br>  __int64 flag_start; <span class="hljs-comment">// [rsp+20h] [rbp-50h] BYREF</span><br>  __int64 flag_end; <span class="hljs-comment">// [rsp+28h] [rbp-48h] BYREF</span><br>  <span class="hljs-type">void</span> *fl4g[<span class="hljs-number">5</span>]; <span class="hljs-comment">// [rsp+30h] [rbp-40h] BYREF</span><br>  <span class="hljs-type">unsigned</span> __int64 v15; <span class="hljs-comment">// [rsp+58h] [rbp-18h]</span><br>  __int64 savedregs; <span class="hljs-comment">// [rsp+70h] [rbp+0h] BYREF</span><br><br>  v15 = __readfsqword(<span class="hljs-number">0x28u</span>);<br>  v1 = <span class="hljs-number">0</span>;<br>  v2 = <span class="hljs-number">1</span>;<br>  <span class="hljs-keyword">if</span> ( (<span class="hljs-type">unsigned</span> __int64)length((__int64)flag) &gt; <span class="hljs-number">7</span> )<br>  &#123;<br>    substr(fl4g, flag, <span class="hljs-number">0LL</span>, <span class="hljs-number">7uLL</span>);<br>    v1 = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">if</span> ( !(<span class="hljs-type">unsigned</span> __int8)cmp((__int64)fl4g, (__int64)<span class="hljs-string">&quot;moectf&#123;&quot;</span>) &amp;&amp; *(_BYTE *)get_last_str(flag) == <span class="hljs-number">125</span> )<br>      v2 = <span class="hljs-number">0</span>;<br>  &#125;<br>  <span class="hljs-keyword">if</span> ( v1 )<br>    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::~<span class="hljs-built_in">string</span>(fl4g);<br>  <span class="hljs-keyword">if</span> ( v2 )<br>  &#123;<br>    v3 = <span class="hljs-built_in">cout</span>((<span class="hljs-built_in">std</span>::ostream *)&amp;<span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span>);<br>    out(v3, (__int64 (*)(<span class="hljs-type">void</span>))<span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>&lt;<span class="hljs-type">char</span>,<span class="hljs-built_in">std</span>::char_traits&lt;<span class="hljs-type">char</span>&gt;&gt;);<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    <span class="hljs-built_in">std</span>::allocator&lt;<span class="hljs-type">char</span>&gt;::allocator((<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)&amp;savedregs - <span class="hljs-number">89</span>);<br>    flag_end = getEnd(flag);<br>    v4 = cutTail(&amp;flag_end, <span class="hljs-number">1LL</span>);<br>    flag_start = getStart((__int64)flag);<br>    v5 = cutHead(&amp;flag_start, <span class="hljs-number">7LL</span>);<br>    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::basic_string&lt;__gnu_cxx::__normal_iterator&lt;<span class="hljs-type">char</span> *,<span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>&gt;,<span class="hljs-type">void</span>&gt;(fl4g, v5, v4, (__int64)&amp;v9);<span class="hljs-comment">// æå¤´å»å°¾</span><br>    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::operator=(flag, fl4g);<br>    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::~<span class="hljs-built_in">string</span>(fl4g);<br>    <span class="hljs-built_in">std</span>::allocator&lt;<span class="hljs-type">char</span>&gt;::~allocator();<br>    len = length((__int64)flag);<br>    <span class="hljs-keyword">if</span> ( len == <span class="hljs-number">32</span> )<br>    &#123;<br>      <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; len; ++i )<br>      &#123;<br>        flag[i] = (<span class="hljs-type">char</span> *)toList(flag, i);      <span class="hljs-comment">// flag[i]</span><br>        <span class="hljs-keyword">if</span> ( (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)encode(*flag[i]) != enc[i] )<br>          <span class="hljs-keyword">break</span>;<br>      &#125;<br>    &#125;<br>    v7 = <span class="hljs-built_in">cout</span>((<span class="hljs-built_in">std</span>::ostream *)&amp;<span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span>);<br>    out(v7, (__int64 (*)(<span class="hljs-type">void</span>))<span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>&lt;<span class="hljs-type">char</span>,<span class="hljs-built_in">std</span>::char_traits&lt;<span class="hljs-type">char</span>&gt;&gt;);<br>  &#125;<br>  <span class="hljs-keyword">return</span> v15 - __readfsqword(<span class="hljs-number">0x28u</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>åŠ å¯†å‡½æ•°encodeå¦‚ä¸‹ï¼Œå°±æ˜¯æŠŠflag[i]å’Œkeyå¼‚æˆ–ï¼Œkeyä¼šé€’å¢ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œé™æ€åˆ†æä¸‹å¾—åˆ°çš„keyæ˜¯ä¸æ­£ç¡®çš„ï¼ˆé™æ€åˆ†æå¾—åˆ°çš„keyæ˜¯0x23ï¼Œä½†æ˜¯åŠ¨æ€è°ƒè¯•ä¼šå‘ç°ç¨‹åºè¿è¡Œåˆ°æ­¤å¤„keyå˜æˆ0x29ï¼‰ï¼ŒåŠ¨è°ƒå¾—åˆ°çš„keyæ‰èƒ½è§£å¯†å‡ºflag</p>
<p><img src="/../images/image-20250829141947673-1760193218429-13.png" alt="encodeå‡½æ•°"></p>
</li>
<li><p>è§£å¯†è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">data = [<br>    <span class="hljs-number">0x4F</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x7E</span>,<br>    <span class="hljs-number">0x44</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x52</span>,<br>    <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x2B</span><br>]<br>key=<span class="hljs-number">0x29</span><br>result=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(data)):<br>    plaintext=(data[i]^key)&amp;<span class="hljs-number">0xff</span><br>    key+=<span class="hljs-number">1</span><br>    result.append(plaintext)<br>flag=<span class="hljs-string">&#x27;&#x27;</span>.join(<span class="hljs-built_in">chr</span>(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> result)<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure></li>
</ul>
<h3 id="tea"><a href="#tea" class="headerlink" title="tea"></a>tea</h3><ul>
<li><p>IDAæ‰“å¼€é™„ä»¶ç¨‹åºï¼Œmainå‡½æ•°é€»è¾‘æ˜¯å°†è¾“å…¥çš„flagåˆ†æˆ10ä»½ï¼Œæ¯æ¬¡å–ä¸¤ä»½è¿›è¡ŒåŠ å¯†ï¼ŒåŠ å¯†å‡ºæ¥çš„æ•°æ®å’Œencæ¯”è¾ƒã€‚keyå’Œencå·²ç»ç»™å®š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-comment">//mainå‡½æ•°</span><br><span class="hljs-type">int</span> __fastcall <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **argv, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **envp)</span><br>&#123;<br>  <span class="hljs-type">char</span> *v3; <span class="hljs-comment">// rdi</span><br>  __int64 i; <span class="hljs-comment">// rcx</span><br>  _BYTE v6[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [rsp+0h] [rbp-20h] BYREF</span><br>  <span class="hljs-type">char</span> v7; <span class="hljs-comment">// [rsp+20h] [rbp+0h] BYREF</span><br>  _DWORD key[<span class="hljs-number">12</span>]; <span class="hljs-comment">// [rsp+28h] [rbp+8h] BYREF</span><br>  _DWORD enc[<span class="hljs-number">20</span>]; <span class="hljs-comment">// [rsp+58h] [rbp+38h]</span><br>  _DWORD fl4g[<span class="hljs-number">20</span>]; <span class="hljs-comment">// [rsp+A8h] [rbp+88h] BYREF</span><br>  _DWORD Flag[<span class="hljs-number">20</span>]; <span class="hljs-comment">// [rsp+F8h] [rbp+D8h] BYREF</span><br>  <span class="hljs-type">char</span> flag[<span class="hljs-number">64</span>]; <span class="hljs-comment">// [rsp+148h] [rbp+128h] BYREF</span><br>  <span class="hljs-type">size_t</span> length; <span class="hljs-comment">// [rsp+188h] [rbp+168h]</span><br>  <span class="hljs-type">int</span> j; <span class="hljs-comment">// [rsp+1A4h] [rbp+184h]</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> part1; <span class="hljs-comment">// [rsp+1C8h] [rbp+1A8h] BYREF</span><br>  <span class="hljs-type">int</span> part2; <span class="hljs-comment">// [rsp+1CCh] [rbp+1ACh]</span><br>  <span class="hljs-type">int</span> v17; <span class="hljs-comment">// [rsp+1E4h] [rbp+1C4h]</span><br>  <span class="hljs-type">int</span> k; <span class="hljs-comment">// [rsp+204h] [rbp+1E4h]</span><br><br>  v3 = &amp;v7;<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">130LL</span>; i; --i )<br>  &#123;<br>    *(_DWORD *)v3 = <span class="hljs-number">-858993460</span>;<br>    v3 += <span class="hljs-number">4</span>;<br>  &#125;<br>  sub_7FF6DAA21384(byte_7FF6DAA33015);<br>  key[<span class="hljs-number">0</span>] = <span class="hljs-number">289739801</span>;<br>  key[<span class="hljs-number">1</span>] = <span class="hljs-number">427884820</span>;<br>  key[<span class="hljs-number">2</span>] = <span class="hljs-number">1363251608</span>;<br>  key[<span class="hljs-number">3</span>] = <span class="hljs-number">269567252</span>;<br>  enc[<span class="hljs-number">0</span>] = <span class="hljs-number">2026214571</span>;<br>  enc[<span class="hljs-number">1</span>] = <span class="hljs-number">578894681</span>;<br>  enc[<span class="hljs-number">2</span>] = <span class="hljs-number">1193947460</span>;<br>  enc[<span class="hljs-number">3</span>] = <span class="hljs-number">-229306230</span>;<br>  enc[<span class="hljs-number">4</span>] = <span class="hljs-number">73202484</span>;<br>  enc[<span class="hljs-number">5</span>] = <span class="hljs-number">961145356</span>;<br>  enc[<span class="hljs-number">6</span>] = <span class="hljs-number">-881456792</span>;<br>  enc[<span class="hljs-number">7</span>] = <span class="hljs-number">358205817</span>;<br>  enc[<span class="hljs-number">8</span>] = <span class="hljs-number">-554069347</span>;<br>  enc[<span class="hljs-number">9</span>] = <span class="hljs-number">119347883</span>;<br>  enc[<span class="hljs-number">10</span>] = <span class="hljs-number">0</span>;<br>  <span class="hljs-built_in">memset</span>(fl4g, <span class="hljs-number">0</span>, <span class="hljs-number">44uLL</span>);<br>  <span class="hljs-built_in">memset</span>(Flag, <span class="hljs-number">0</span>, <span class="hljs-number">44uLL</span>);<br>  <span class="hljs-built_in">printf</span>(&amp;You_are_wrong___);<br>  <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%s&quot;</span>, flag);<br>  length = j_strlen(flag);<br>  j_memcpy(fl4g, flag, length);<br>  <span class="hljs-keyword">for</span> ( j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">5</span>; ++j )<br>  &#123;<br>    part1 = fl4g[<span class="hljs-number">2</span> * j];<br>    part2 = fl4g[<span class="hljs-number">2</span> * j + <span class="hljs-number">1</span>];<br>    tea(&amp;part1, key);<span class="hljs-comment">// è¿™é‡Œä¼ çš„æ˜¯åœ°å€ï¼Œteaå†…å¯ä»¥é€šè¿‡part1çš„åœ°å€å¾—åˆ°part2</span><br>    Flag[<span class="hljs-number">2</span> * j] = part1;<br>    Flag[<span class="hljs-number">2</span> * j + <span class="hljs-number">1</span>] = part2;<br>  &#125;<br>  v17 = <span class="hljs-number">1</span>;<br>  <span class="hljs-keyword">for</span> ( k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">11</span>; ++k )<br>  &#123;<br>    <span class="hljs-keyword">if</span> ( Flag[k] != enc[k] )<br>    &#123;<br>      v17 = <span class="hljs-number">0</span>;<br>      <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;You are wrong!!&quot;</span>);<br>      <span class="hljs-keyword">break</span>;<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">if</span> ( v17 == <span class="hljs-number">1</span> )<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Congratulations!!!!&quot;</span>);<br>  sub_7FF6DAA21320(v6, &amp;unk_7FF6DAA2AE60);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>åŠ å¯†å‡½æ•°æ˜¯æ”¹åŠ¨çš„teaåŠ å¯†</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c">__int64 __fastcall <span class="hljs-title function_">Tea</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> *part1, _DWORD *key)</span><br>&#123;<br>  __int64 n4; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">int</span> delta; <span class="hljs-comment">// [rsp+24h] [rbp+4h]</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> p1; <span class="hljs-comment">// [rsp+44h] [rbp+24h]</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> p2; <span class="hljs-comment">// [rsp+64h] [rbp+44h]</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [rsp+A4h] [rbp+84h]</span><br><br>  sub_7FF6DAA21384((__int64)&amp;byte_7FF6DAA33015);<br>  delta = <span class="hljs-number">0</span>;<br>  p1 = *part1;<br>  p2 = part1[<span class="hljs-number">1</span>];<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; ++i )<br>  &#123;<br>    delta += <span class="hljs-number">1131796</span>;<br>    p1 += (key[<span class="hljs-number">1</span>] + (p2 &gt;&gt; <span class="hljs-number">5</span>)) ^ (delta + p2) ^ (*key + <span class="hljs-number">16</span> * p2);<br>    p2 += (key[<span class="hljs-number">3</span>] + (p1 &gt;&gt; <span class="hljs-number">5</span>)) ^ (delta + p1) ^ (key[<span class="hljs-number">2</span>] + <span class="hljs-number">16</span> * p1);<br>  &#125;<br>  *part1 = p1;<br>  n4 = <span class="hljs-number">4LL</span>;<br>  part1[<span class="hljs-number">1</span>] = p2;<br>  <span class="hljs-keyword">return</span> n4;<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>è§£å¯†é€»è¾‘ï¼šå°†teaå†…çš„p1 p2ä½ç½®å¯¹è°ƒï¼Œâ€+â€æ”¹æˆâ€-â€œï¼Œç„¶ådeltaä»æœ€åä¸€è½®çš„å€¼å¾€å›é€’å‡å°±å¯ä»¥äº†ã€‚è§£å¯†è„šæœ¬ï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdint.h&gt;</span></span><br><span class="hljs-type">void</span> <span class="hljs-title function_">tea_decrypt</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> *a,<span class="hljs-type">uint32_t</span> *k)</span> &#123;<br>	<span class="hljs-type">uint32_t</span> delta = <span class="hljs-number">1131796</span> * <span class="hljs-number">32</span>;<br>	<span class="hljs-type">uint32_t</span> p1 = *a;<br>	<span class="hljs-type">uint32_t</span> p2 = *(a + <span class="hljs-number">1</span>);<br>	<span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; i++) &#123;<br>		p2 -= ((k[<span class="hljs-number">3</span>] + (p1 &gt;&gt; <span class="hljs-number">5</span>)) ^ (delta + p1) ^ (k[<span class="hljs-number">2</span>] + <span class="hljs-number">16</span> * p1));<br>		p1 -= ((k[<span class="hljs-number">1</span>] + (p2 &gt;&gt; <span class="hljs-number">5</span>)) ^ (delta + p2) ^ (*k + <span class="hljs-number">16</span> * p2));<br>		delta -= <span class="hljs-number">1131796</span>;<br>	&#125;<br>	*a = p1;<br>	*(a+<span class="hljs-number">1</span>)= p2;<br>&#125;<br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>	<span class="hljs-type">uint32_t</span> key[<span class="hljs-number">4</span>];<br>	<span class="hljs-type">uint32_t</span> enc[<span class="hljs-number">11</span>];<br>	key[<span class="hljs-number">0</span>] = <span class="hljs-number">289739801</span>;<br>	key[<span class="hljs-number">1</span>] = <span class="hljs-number">427884820</span>;<br>	key[<span class="hljs-number">2</span>] = <span class="hljs-number">1363251608</span>;<br>	key[<span class="hljs-number">3</span>] = <span class="hljs-number">269567252</span>;<br>	enc[<span class="hljs-number">0</span>] = <span class="hljs-number">2026214571</span>;<br>	enc[<span class="hljs-number">1</span>] = <span class="hljs-number">578894681</span>;<br>	enc[<span class="hljs-number">2</span>] = <span class="hljs-number">1193947460</span>;<br>	enc[<span class="hljs-number">3</span>] = <span class="hljs-number">-229306230</span>;<br>	enc[<span class="hljs-number">4</span>] = <span class="hljs-number">73202484</span>;<br>	enc[<span class="hljs-number">5</span>] = <span class="hljs-number">961145356</span>;<br>	enc[<span class="hljs-number">6</span>] = <span class="hljs-number">-881456792</span>;<br>	enc[<span class="hljs-number">7</span>] = <span class="hljs-number">358205817</span>;<br>	enc[<span class="hljs-number">8</span>] = <span class="hljs-number">-554069347</span>;<br>	enc[<span class="hljs-number">9</span>] = <span class="hljs-number">119347883</span>;<br>	enc[<span class="hljs-number">10</span>] = <span class="hljs-number">0</span>;<br>	<span class="hljs-type">char</span> flag[<span class="hljs-number">45</span>] = &#123; <span class="hljs-number">0</span> &#125;;<br>	<span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++) &#123;<br>		<span class="hljs-type">uint32_t</span> block[<span class="hljs-number">2</span>] = &#123;enc[<span class="hljs-number">2</span>*i],enc[<span class="hljs-number">2</span>*i+<span class="hljs-number">1</span>]&#125;;<br>		tea_decrypt(block, key);<br>		<span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">4</span>; j++) &#123;<br>			flag[<span class="hljs-number">8</span> * i + j] = (block[<span class="hljs-number">0</span>] &gt;&gt; (j * <span class="hljs-number">8</span>)) &amp; <span class="hljs-number">0xff</span>;<span class="hljs-comment">//å³ç§»jä¸ªå­—ç¬¦ï¼Œç„¶åå–æœ€åä¸€ä¸ª</span><br>			flag[<span class="hljs-number">8</span> * i + j + <span class="hljs-number">4</span>] = (block[<span class="hljs-number">1</span>] &gt;&gt; (j * <span class="hljs-number">8</span>)) &amp; <span class="hljs-number">0xff</span>;<br>		&#125;<br>	&#125;<br>	<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s&quot;</span>, flag);<br>	<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h3 id="ez3"><a href="#ez3" class="headerlink" title="ez3"></a>ez3</h3><ul>
<li><p>é™„ä»¶ç¨‹åºmainå‡½æ•°é€»è¾‘ä¸»è¦æ˜¯è·å–flagï¼Œç„¶åæå¤´å»å°¾ï¼Œå¯¹ä¸­é—´éƒ¨åˆ†è¿›è¡Œcheckã€‚mainå‡½æ•°ï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> __fastcall <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **argv, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **envp)</span><br>&#123;<br>  <span class="hljs-type">char</span> v3; <span class="hljs-comment">// bl</span><br>  <span class="hljs-type">bool</span> v4; <span class="hljs-comment">// r12</span><br>  __int64 v5; <span class="hljs-comment">// rbx</span><br>  __int64 v6; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">char</span> v8; <span class="hljs-comment">// [rsp+Fh] [rbp-71h] BYREF</span><br>  __int64 Start; <span class="hljs-comment">// [rsp+10h] [rbp-70h] BYREF</span><br>  __int64 end; <span class="hljs-comment">// [rsp+18h] [rbp-68h] BYREF</span><br>  _BYTE flag[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [rsp+20h] [rbp-60h] BYREF</span><br>  _QWORD fl4g[<span class="hljs-number">8</span>]; <span class="hljs-comment">// [rsp+40h] [rbp-40h] BYREF</span><br><br>  fl4g[<span class="hljs-number">5</span>] = __readfsqword(<span class="hljs-number">0x28u</span>);<br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Input your flag:\n&gt; &quot;</span>, argv, envp);<br>  fflush(<span class="hljs-built_in">stdout</span>);<br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::basic_string(flag);<br>  <span class="hljs-built_in">cin</span>(&amp;<span class="hljs-built_in">std</span>::<span class="hljs-built_in">cin</span>);<br>  <span class="hljs-keyword">if</span> ( length(flag) == <span class="hljs-number">42</span> )<br>  &#123;<br>    v3 = <span class="hljs-number">0</span>;<br>    v4 = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">if</span> ( length(flag) &gt; <span class="hljs-number">7</span> )<br>    &#123;<br>      substr(fl4g, flag, <span class="hljs-number">0LL</span>, <span class="hljs-number">7LL</span>);<br>      v3 = <span class="hljs-number">1</span>;<br>      <span class="hljs-keyword">if</span> ( !cmp(fl4g, <span class="hljs-string">&quot;moectf&#123;&quot;</span>) &amp;&amp; *get_last_str(flag) == <span class="hljs-number">125</span> )<br>        v4 = <span class="hljs-number">0</span>;<br>    &#125;<br>    <span class="hljs-keyword">if</span> ( v3 )<br>      <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::~<span class="hljs-built_in">string</span>(fl4g);<br>    <span class="hljs-keyword">if</span> ( v4 )<br>    &#123;<br>      <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;FORMAT ERROR!&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>      <span class="hljs-built_in">std</span>::allocator&lt;<span class="hljs-type">char</span>&gt;::allocator(&amp;v8);<br>      end = getEnd(flag);<br>      v5 = cutTail(&amp;end, <span class="hljs-number">1LL</span>);<br>      Start = getStart(flag);<br>      v6 = cutHead(&amp;Start, <span class="hljs-number">7LL</span>);<br>      <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::basic_string&lt;__gnu_cxx::__normal_iterator&lt;<span class="hljs-type">char</span> *,<span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>&gt;,<span class="hljs-type">void</span>&gt;(fl4g, v6, v5, &amp;v8);<br>      strcopy(flag, fl4g);<br>      <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::~<span class="hljs-built_in">string</span>(fl4g);<br>      <span class="hljs-built_in">std</span>::allocator&lt;<span class="hljs-type">char</span>&gt;::~allocator(&amp;v8);<br>      <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::basic_string(fl4g, flag);<br>      LOBYTE(v5) = check(fl4g);<br>      <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::~<span class="hljs-built_in">string</span>(fl4g);<br>      <span class="hljs-keyword">if</span> ( v5 )<br>      &#123;<br>        <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;OK&quot;</span>);<br>        <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;But I don&#x27;t know what the true flag is&quot;</span>);<br>      &#125;<br>      <span class="hljs-keyword">else</span><br>      &#123;<br>        <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;try again~&quot;</span>);<br>      &#125;<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Length error!&quot;</span>);<br>  &#125;<br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::~<span class="hljs-built_in">string</span>(flag);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>checkå‡½æ•°ï¼š</p>
<p><img src="/../images/image-20250829115915331-1760193218429-15.png" alt="checkå‡½æ•°"></p>
<p>é¢˜ç›®æç¤ºäº†z3ï¼Œæ‰€ä»¥ä½¿ç”¨z3çº¦æŸæ±‚è§£ã€‚æ€è·¯å°±æ˜¯å¤ç°checkå‡½æ•°é€»è¾‘ï¼Œçˆ†ç ´å‡ºflag</p>
</li>
<li><p>è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> z3 <span class="hljs-keyword">import</span> *<br><br>enc = [<br>    <span class="hljs-number">0x0B1B0</span>, <span class="hljs-number">0x5678</span>, <span class="hljs-number">0x7FF2</span>, <span class="hljs-number">0xA332</span>, <span class="hljs-number">0xA0E8</span>, <span class="hljs-number">0x364C</span>, <span class="hljs-number">0x2BD4</span>,<br>    <span class="hljs-number">0xC8FE</span>, <span class="hljs-number">0x4A7C</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x2BE4</span>, <span class="hljs-number">0x4144</span>, <span class="hljs-number">0x3BA6</span>, <span class="hljs-number">0xBE8C</span>, <span class="hljs-number">0x8F7E</span>,<br>    <span class="hljs-number">0x35F8</span>, <span class="hljs-number">0x61AA</span>, <span class="hljs-number">0x2B4A</span>, <span class="hljs-number">0x6828</span>, <span class="hljs-number">0xB39E</span>, <span class="hljs-number">0xB542</span>, <span class="hljs-number">0x33EC</span>, <span class="hljs-number">0xC7D8</span>,<br>    <span class="hljs-number">0x448C</span>, <span class="hljs-number">0x9310</span>, <span class="hljs-number">0x8808</span>, <span class="hljs-number">0xADD4</span>, <span class="hljs-number">0x3CC2</span>, <span class="hljs-number">0x796</span>, <span class="hljs-number">0xC940</span>, <span class="hljs-number">0x4E32</span>,<br>    <span class="hljs-number">0x4E2E</span>, <span class="hljs-number">0x924A</span>, <span class="hljs-number">0x5B5C</span><br>]<br><br>s=Solver()<br>flag=[BitVec(<span class="hljs-string">f&#x27;flag_<span class="hljs-subst">&#123;i&#125;</span>&#x27;</span>,<span class="hljs-number">32</span>)<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">34</span>)]<br>b=[BitVec(<span class="hljs-string">f&#x27;b_<span class="hljs-subst">&#123;i&#125;</span>&#x27;</span>,<span class="hljs-number">32</span>)<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">34</span>)]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">34</span>):<br>    s.add(flag[i]&gt;=<span class="hljs-number">32</span>,flag[i]&lt;=<span class="hljs-number">126</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">34</span>):<br>    <span class="hljs-keyword">if</span> i==<span class="hljs-number">0</span>:<br>        s.add(b[<span class="hljs-number">0</span>]==(<span class="hljs-number">47806</span>*flag[<span class="hljs-number">0</span>])%<span class="hljs-number">51966</span>)<br>    <span class="hljs-keyword">else</span>:<br>        b_value=<span class="hljs-number">47806</span>*(flag[i]+i)<br>        b_xored=b_value^(b[i-<span class="hljs-number">1</span>]^<span class="hljs-number">0x114514</span>)<br>        s.add(b[i]==b_xored%<span class="hljs-number">51966</span>)<br>    s.add(b[i]==enc[i])<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;solutions found:&quot;</span>)<br><span class="hljs-keyword">while</span> s.check()==sat:<br>    model=s.model()<br>    solution=<span class="hljs-string">&#x27;&#x27;</span>.join([<span class="hljs-built_in">chr</span>(model[flag[i]].as_long())<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">34</span>)])<br>    <span class="hljs-built_in">print</span>(solution)<br>    exception=Or([flag[i]!=model[flag[i]]<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">34</span>)])<span class="hljs-comment">#é¿å…é‡å¤æƒ…å†µ</span><br>    s.add(exception)<br></code></pre></td></tr></table></figure></li>
</ul>
<h3 id="é€†å‘å·¥ç¨‹å…¥é—¨æŒ‡åŒ—"><a href="#é€†å‘å·¥ç¨‹å…¥é—¨æŒ‡åŒ—" class="headerlink" title="é€†å‘å·¥ç¨‹å…¥é—¨æŒ‡åŒ—"></a>é€†å‘å·¥ç¨‹å…¥é—¨æŒ‡åŒ—</h3><ul>
<li><p>IDAæ‰“å¼€é™„ä»¶ç¨‹åºï¼Œåœ¨å­—ç¬¦ä¸²çª—å£å¯ä»¥ç›´æ¥çœ‹åˆ°flag</p>
<p><img src="/../images/image-20250829104220942-1760193218429-14.png" alt="å­—ç¬¦ä¸²çª—å£"></p>
</li>
</ul>
<h2 id="week2"><a href="#week2" class="headerlink" title="week2"></a>week2</h2><h3 id="base"><a href="#base" class="headerlink" title="base"></a>base</h3><ul>
<li><p>è¿è¡Œé™„ä»¶ç¨‹åºï¼Œç›´æ¥è®©è¾“å…¥flagã€‚IDAæ‰“å¼€åˆ†æmainå‡½æ•°ï¼Œå‘ç°ä½¿ç”¨äº†æ ‡å‡†base64åŠ å¯†ï¼Œå¹¶ä¸”å¯†æ–‡ç›´æ¥ç»™äº†ã€‚cyberchefä¸€æŠŠæ¢­</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-comment">//mainå‡½æ•°</span><br><span class="hljs-type">int</span> __fastcall <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **argv, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **envp)</span><br>&#123;<br>  FILE *Stream; <span class="hljs-comment">// rax</span><br>  __int64 v4; <span class="hljs-comment">// rdx</span><br>  __int64 length; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">unsigned</span> __int64 n; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">char</span> *Str1; <span class="hljs-comment">// rbx</span><br>  <span class="hljs-type">int</span> v8; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *Format; <span class="hljs-comment">// rcx</span><br>  <span class="hljs-type">char</span> v11[<span class="hljs-number">16</span>]; <span class="hljs-comment">// [rsp+20h] [rbp-98h] BYREF</span><br>  <span class="hljs-type">char</span> flag[<span class="hljs-number">112</span>]; <span class="hljs-comment">// [rsp+30h] [rbp-88h] BYREF</span><br><br>  <span class="hljs-built_in">printf</span>(::Format);<br>  <span class="hljs-built_in">printf</span>((<span class="hljs-type">char</span> *)&amp;Format_);<br>  Stream = _acrt_iob_func(<span class="hljs-number">0</span>);<br>  fgets(flag, <span class="hljs-number">100</span>, Stream);<br>  v4 = <span class="hljs-number">-1LL</span>;<br>  length = <span class="hljs-number">-1LL</span>;<br>  <span class="hljs-keyword">do</span><br>    ++length;<br>  <span class="hljs-keyword">while</span> ( flag[length] );<br>  <span class="hljs-keyword">if</span> ( length &amp;&amp; v11[length + <span class="hljs-number">15</span>] == <span class="hljs-number">10</span> )<br>  &#123;<br>    n = length - <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">if</span> ( n &gt;= <span class="hljs-number">0x64</span> )<br>      _report_securityfailure_(flag);<br>    flag[n] = <span class="hljs-number">0</span>;<br>  &#125;<br>  <span class="hljs-keyword">do</span><br>    ++v4;<br>  <span class="hljs-keyword">while</span> ( flag[v4] );<br>  Str1 = (<span class="hljs-type">char</span> *)baseEncode(flag, v4, v11);<span class="hljs-comment">// æ ‡å‡†base64åŠ å¯†</span><br>  v8 = <span class="hljs-built_in">strcmp</span>(Str1, <span class="hljs-string">&quot;bW9lY3Rme1kwdV9DNG5fRzAwZF9BdF9CNDVlNjQhIX0=&quot;</span>);<br>  Format = (<span class="hljs-type">char</span> *)&amp;unk_140003300;<br>  <span class="hljs-keyword">if</span> ( v8 )<br>    Format = (<span class="hljs-type">char</span> *)&amp;byte_140003318;<br>  <span class="hljs-built_in">printf</span>(Format);<br>  <span class="hljs-built_in">free</span>(Str1);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><img src="/../images/image-20250821000019398-1760193218429-16.png" alt="cyberchefä¸€æŠŠæ¢­"></p>
</li>
</ul>
<h3 id="speed"><a href="#speed" class="headerlink" title="speed"></a>speed</h3><ul>
<li><p>é™„ä»¶ç¨‹åºè¿è¡Œå‡ºç°ä¸€é“é»‘å½±ï¼Œçœ‹ä¸æ¸…ã€‚IDAåˆ†æmainå‡½æ•°ï¼Œå‘ç°ä½¿ç”¨äº†WNDCLASSAç»“æ„ä½“ï¼ˆè¯¦ç»†ä¿¡æ¯è§ï¼š<a href="https://learn.microsoft.com/zh-cn/windows/win32/api/winuser/ns-winuser-wndclassa">WNDCLASSA ï¼ˆwinuser.hï¼‰ - Win32 apps | Microsoft Learn</a>ï¼‰ï¼Œä¸»è¦é€»è¾‘æ˜¯åˆ›å»ºçª—å£ï¼Œå…³é”®éƒ¨åˆ†æ˜¯çª—å£ç»“æ„ä½“å˜é‡lpfnWndProcï¼Œå®ƒæŒ‡å‘äº†çª—å£çš„é€»è¾‘ï¼ˆå³ä»£ç ä¸­çš„WndProcå‡½æ•°ï¼‰</p>
<p><img src="/../images/image-20250828214030322-1760193218429-17.png" alt="mainå‡½æ•°"></p>
</li>
<li><p>åˆ†æWndProcå‡½æ•°å‘ç°ï¼Œçª—å£ä¼¼ä¹ç›´æ¥è¾“å‡ºflagã€‚äºæ˜¯ä¸‹æ–­ç‚¹ï¼ŒåŠ¨æ€è°ƒè¯•</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-comment">//WndProcå‡½æ•°</span><br>LRESULT __fastcall <span class="hljs-title function_">WndProc</span><span class="hljs-params">(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam)</span><br>&#123;<br>  tagPAINTSTRUCT Paint; <span class="hljs-comment">// [rsp+30h] [rbp-50h] BYREF</span><br>  <span class="hljs-type">char</span> Destination[<span class="hljs-number">14</span>]; <span class="hljs-comment">// [rsp+80h] [rbp+0h] BYREF</span><br>  __int16 v7; <span class="hljs-comment">// [rsp+8Eh] [rbp+Eh]</span><br>  __int64 v8; <span class="hljs-comment">// [rsp+90h] [rbp+10h]</span><br>  __int64 v9; <span class="hljs-comment">// [rsp+98h] [rbp+18h]</span><br>  __int64 v10; <span class="hljs-comment">// [rsp+A0h] [rbp+20h]</span><br>  __int64 v11; <span class="hljs-comment">// [rsp+A8h] [rbp+28h]</span><br>  __int64 v12; <span class="hljs-comment">// [rsp+B0h] [rbp+30h]</span><br>  __int64 v13; <span class="hljs-comment">// [rsp+B8h] [rbp+38h]</span><br>  __int64 v14; <span class="hljs-comment">// [rsp+C0h] [rbp+40h]</span><br>  __int64 v15; <span class="hljs-comment">// [rsp+C8h] [rbp+48h]</span><br>  __int64 v16; <span class="hljs-comment">// [rsp+D0h] [rbp+50h]</span><br>  __int64 v17; <span class="hljs-comment">// [rsp+D8h] [rbp+58h]</span><br>  __int64 v18; <span class="hljs-comment">// [rsp+E0h] [rbp+60h]</span><br>  __int64 v19; <span class="hljs-comment">// [rsp+E8h] [rbp+68h]</span><br>  __int64 v20; <span class="hljs-comment">// [rsp+F0h] [rbp+70h]</span><br>  __int64 v21; <span class="hljs-comment">// [rsp+F8h] [rbp+78h]</span><br>  <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">tagRECT</span> <span class="hljs-title">Rect</span>;</span> <span class="hljs-comment">// [rsp+100h] [rbp+80h] BYREF</span><br>  <span class="hljs-type">char</span> mylittlepony[<span class="hljs-number">13</span>]; <span class="hljs-comment">// [rsp+113h] [rbp+93h] BYREF</span><br>  <span class="hljs-type">char</span> Source[<span class="hljs-number">8</span>]; <span class="hljs-comment">// [rsp+120h] [rbp+A0h] BYREF</span><br>  __int64 v25; <span class="hljs-comment">// [rsp+128h] [rbp+A8h]</span><br>  _QWORD v26[<span class="hljs-number">2</span>]; <span class="hljs-comment">// [rsp+130h] [rbp+B0h]</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [rsp+140h] [rbp+C0h]</span><br>  <span class="hljs-type">int</span> n12; <span class="hljs-comment">// [rsp+144h] [rbp+C4h]</span><br>  HDC hdc; <span class="hljs-comment">// [rsp+148h] [rbp+C8h]</span><br><br>  <span class="hljs-keyword">if</span> ( Msg == <span class="hljs-number">2</span> )<br>  &#123;<br>    PostQuitMessage(<span class="hljs-number">0</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>  &#125;<br>  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( Msg == <span class="hljs-number">15</span> )<br>  &#123;<br>    hdc = BeginPaint(hWnd, &amp;Paint);<br>    <span class="hljs-built_in">strcpy</span>(Destination, <span class="hljs-string">&quot;Your flag is &quot;</span>);<br>    v7 = <span class="hljs-number">0</span>;<br>    v8 = <span class="hljs-number">0LL</span>;<br>    v9 = <span class="hljs-number">0LL</span>;<br>    v10 = <span class="hljs-number">0LL</span>;<br>    v11 = <span class="hljs-number">0LL</span>;<br>    v12 = <span class="hljs-number">0LL</span>;<br>    v13 = <span class="hljs-number">0LL</span>;<br>    v14 = <span class="hljs-number">0LL</span>;<br>    v15 = <span class="hljs-number">0LL</span>;<br>    v16 = <span class="hljs-number">0LL</span>;<br>    v17 = <span class="hljs-number">0LL</span>;<br>    v18 = <span class="hljs-number">0LL</span>;<br>    v19 = <span class="hljs-number">0LL</span>;<br>    v20 = <span class="hljs-number">0LL</span>;<br>    v21 = <span class="hljs-number">0LL</span>;<br>    *(_QWORD *)Source = <span class="hljs-number">0x7F1B3E885EF9160L</span>L;<br>    v25 = <span class="hljs-number">0x2CD336BCB0464A89L</span>L;<br>    v26[<span class="hljs-number">0</span>] = <span class="hljs-number">0xEF5FC91642917EE1u</span>LL;<br>    *(_QWORD *)((<span class="hljs-type">char</span> *)v26 + <span class="hljs-number">6</span>) = <span class="hljs-number">0x739D40A4E356EF5FL</span>L;<br>    <span class="hljs-built_in">strcpy</span>(mylittlepony, <span class="hljs-string">&quot;mylittlepony&quot;</span>);<br>    n12 = <span class="hljs-number">12</span>;<br>    i = <span class="hljs-built_in">strlen</span>(Source);<br>    RC4Crypt((<span class="hljs-type">unsigned</span> __int8 *)Source, i, (<span class="hljs-type">const</span> <span class="hljs-type">unsigned</span> __int8 *)mylittlepony, <span class="hljs-number">12</span>);<br>    <span class="hljs-built_in">strcat</span>(Destination, Source);<br>    GetClientRect(hWnd, &amp;Rect);<br>    DrawTextA(hdc, Destination, <span class="hljs-number">-1</span>, &amp;Rect, <span class="hljs-number">0x40005u</span>);<br>    EndPaint(hWnd, &amp;Paint);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    <span class="hljs-keyword">return</span> DefWindowProcA(hWnd, Msg, wParam, lParam);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>åŠ¨æ€è°ƒè¯•ç»“æœå¦‚å›¾ï¼š</p>
<p><img src="/../images/image-20250828214156948-1760193218429-19.png" alt="åŠ¨æ€è°ƒè¯•"></p>
</li>
</ul>
<h3 id="ezpy"><a href="#ezpy" class="headerlink" title="ezpy"></a>ezpy</h3><ul>
<li><p>ä½¿ç”¨decompyle3åç¼–è¯‘å¾—åˆ°ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">caesar_cipher_encrypt</span>(<span class="hljs-params">text, shift</span>):<br>    result = []<br>    <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> text:<br>        <span class="hljs-keyword">if</span> char.isalpha():<br>            <span class="hljs-keyword">if</span> char.islower():<br>                new_char = <span class="hljs-built_in">chr</span>((<span class="hljs-built_in">ord</span>(char) - <span class="hljs-built_in">ord</span>(<span class="hljs-string">&quot;a&quot;</span>) + shift) % <span class="hljs-number">26</span> + <span class="hljs-built_in">ord</span>(<span class="hljs-string">&quot;a&quot;</span>))<br>            <span class="hljs-keyword">elif</span> char.isupper():<br>                new_char = <span class="hljs-built_in">chr</span>((<span class="hljs-built_in">ord</span>(char) - <span class="hljs-built_in">ord</span>(<span class="hljs-string">&quot;A&quot;</span>) + shift) % <span class="hljs-number">26</span> + <span class="hljs-built_in">ord</span>(<span class="hljs-string">&quot;A&quot;</span>))<br>            result.append(new_char)<br>        <span class="hljs-keyword">else</span>:<br>            result.append(char)<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>.join(result)<br><br><br>user_input = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;please input your flagï¼š&quot;</span>)<br>a = <span class="hljs-number">1</span><br><span class="hljs-keyword">if</span> a != <span class="hljs-number">1</span>:<br>    plaintext = user_input<br>    shift = <span class="hljs-number">114514</span><br>    encrypted_text = caesar_cipher_encrypt(plaintext, shift)<br>    <span class="hljs-keyword">if</span> encrypted_text == <span class="hljs-string">&quot;wyomdp&#123;I0e_Ux0G_zim&#125;&quot;</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Correct!!!!&quot;</span>)<br></code></pre></td></tr></table></figure>
</li>
<li><p>å¯ä»¥çœ‹å‡ºå®ç°äº†ä¸€ä¸ªå‡¯æ’’åŠ å¯†ï¼Œåˆ†æé€»è¾‘å¯ä»¥çœ‹å‡ºå®é™…ä¸Šæ˜¯ç»™æ¯ä¸ªå­—æ¯ç§»ä½äº†10ï¼ˆasciiç +10ï¼‰ï¼Œæ‰€ä»¥ç»™å­—æ¯å‡10å°±okäº†ï¼Œå¯ä»¥åŸºäºæºç è¿›è¡Œå¾®å°æ”¹åŠ¨å¾—åˆ°è§£å¯†è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">caesar_cipher_decrypt</span>(<span class="hljs-params">text, shift</span>):<br>    result = []<br>    <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> text:<br>        <span class="hljs-keyword">if</span> char.isalpha():<br>            <span class="hljs-keyword">if</span> char.islower():<br>                new_char = <span class="hljs-built_in">chr</span>((<span class="hljs-built_in">ord</span>(char) - <span class="hljs-built_in">ord</span>(<span class="hljs-string">&quot;a&quot;</span>) - shift) % <span class="hljs-number">26</span> + <span class="hljs-built_in">ord</span>(<span class="hljs-string">&quot;a&quot;</span>))<span class="hljs-comment">#&#x27;+&#x27;æ”¹ä¸º-&quot;</span><br>            <span class="hljs-keyword">elif</span> char.isupper():<br>                new_char = <span class="hljs-built_in">chr</span>((<span class="hljs-built_in">ord</span>(char) - <span class="hljs-built_in">ord</span>(<span class="hljs-string">&quot;A&quot;</span>) - shift) % <span class="hljs-number">26</span> + <span class="hljs-built_in">ord</span>(<span class="hljs-string">&quot;A&quot;</span>))<br>            result.append(new_char)<br>        <span class="hljs-keyword">else</span>:<br>            result.append(char)<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>.join(result)<br>enc=<span class="hljs-string">&quot;wyomdp&#123;I0e_Ux0G_zim&#125;&quot;</span><br>flag=caesar_cipher_decrypt(enc,<span class="hljs-number">114514</span>)<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure></li>
</ul>
<h3 id="catch"><a href="#catch" class="headerlink" title="catch"></a>catch</h3><ul>
<li><p>å…ˆçœ‹mainå‡½æ•°åç¼–è¯‘ç»“æœï¼Œå‘ç°åªæœ‰ç®€å•çš„ä¸¤ä¸ªå‡½æ•°ï¼Œå…¶ä¸­solveå‡½æ•°æœ‰æ›´å¤æ‚çš„é€»è¾‘ï¼š</p>
<p><img src="/../images/image-20250828215740728-1760193218429-18.png" alt="mainå‡½æ•°"></p>
</li>
<li><p>ç„¶è€Œsolveå‡½æ•°å¹¶ä¸èƒ½çœ‹å‡ºä»€ä¹ˆæœ‰ç”¨çš„é€»è¾‘å‡ºæ¥ï¼Œsub_114514å‡ºç°äº†flagå­—æ ·ï¼Œä½†æ˜¯åŠ¨è°ƒå‘ç°æ²¡æœ‰ç”¨å¤„</p>
<p><img src="/../images/image-20250828215832225-1760193218429-20.png" alt="solveå‡½æ•°"></p>
</li>
<li><p>ç»“åˆé¢˜ç›®æç¤ºtry catchä¸èƒ½è¢«æ­£ç¡®åç¼–è¯‘ï¼Œäºæ˜¯ç›´æ¥æŸ¥çœ‹æ±‡ç¼–ä»£ç ã€‚åœ¨æ±‡ç¼–ä»£ç é‡Œçœ‹åˆ°ä¸€ä¸ªç±»ä¼¼flagæ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œåˆ†æåç»­é€»è¾‘å‘ç°å¯¹è¿™ä¸ªå­—ç¬¦ä¸²è¿›è¡Œäº†å¤„ç†ï¼Œåˆ†æå‘ç°å¤„ç†ç»“æœå°±æ˜¯flag</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm"><span class="hljs-symbol">.text:</span>00000001400014D6 <span class="hljs-comment">; =============== S U B R O U T I N E =======================================</span><br><span class="hljs-symbol">.text:</span>00000001400014D6<br><span class="hljs-symbol">.text:</span>00000001400014D6 <span class="hljs-comment">; Attributes: bp-based frame fpd=10h</span><br><span class="hljs-symbol">.text:</span>00000001400014D6<br><span class="hljs-symbol">.text:</span>00000001400014D6 <span class="hljs-comment">; void __noreturn solve(void)</span><br><span class="hljs-symbol">.text:</span>00000001400014D6                 <span class="hljs-meta">public</span> _Z5solvev<br><span class="hljs-symbol">.text:</span>00000001400014D6 _Z5solvev       proc <span class="hljs-built_in">near</span>               <span class="hljs-comment">; CODE XREF: main+Dâ†“p</span><br><span class="hljs-symbol">.text:</span>00000001400014D6                                         <span class="hljs-comment">; DATA XREF: .pdata:000000014002D078â†“o ...</span><br><span class="hljs-symbol">.text:</span>00000001400014D6<br><span class="hljs-symbol">.text:</span>00000001400014D6 length          = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">1Ch</span><br><span class="hljs-symbol">.text:</span>00000001400014D6 C               = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">18h</span><br><span class="hljs-symbol">.text:</span>00000001400014D6 count           = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">14h</span><br><span class="hljs-symbol">.text:</span>00000001400014D6<br><span class="hljs-symbol">.text:</span>00000001400014D6 <span class="hljs-comment">; __unwind &#123; // __gxx_personality_seh0</span><br><span class="hljs-symbol">.text:</span>00000001400014D6                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">rbp</span><br><span class="hljs-symbol">.text:</span>00000001400014D7                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">rsi</span><br><span class="hljs-symbol">.text:</span>00000001400014D8                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">rbx</span><br><span class="hljs-symbol">.text:</span>00000001400014D9                 <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">rsp</span>, <span class="hljs-number">30h</span><br><span class="hljs-symbol">.text:</span>00000001400014<span class="hljs-built_in">DD</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rbp</span>, [<span class="hljs-built_in">rsp</span>+<span class="hljs-number">30h</span>]<br><span class="hljs-symbol">.text:</span>00000001400014E2                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rax</span>, aMyFlagIsHidden <span class="hljs-comment">; &quot;my flag is hidden in this program. Can &quot;...</span><br><span class="hljs-symbol">.text:</span>00000001400014E9                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rcx</span>, <span class="hljs-built_in">rax</span>        <span class="hljs-comment">; char *</span><br><span class="hljs-symbol">.text:</span>00000001400014EC                 <span class="hljs-keyword">call</span>    print<br><span class="hljs-symbol">.text:</span>00000001400014F1 <span class="hljs-comment">;   try &#123;</span><br><span class="hljs-symbol">.text:</span>00000001400014F1                 <span class="hljs-keyword">call</span>    _Z10sub_114514v <span class="hljs-comment">; sub_114514(void)</span><br><span class="hljs-symbol">.text:</span>00000001400014F1 <span class="hljs-comment">;   &#125; // starts at 1400014F1</span><br><span class="hljs-symbol">.text:</span>00000001400014F6                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-number">10h</span>        <span class="hljs-comment">; thrown_size</span><br><span class="hljs-symbol">.text:</span>00000001400014FB                 <span class="hljs-keyword">call</span>    __cxa_allocate_exception<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000140001500</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rbx</span>, <span class="hljs-built_in">rax</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000140001503</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rax</span>, aNothingButErro <span class="hljs-comment">; &quot;nothing but error&quot;</span><br><span class="hljs-symbol">.text:</span>000000014000150A                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rdx</span>, <span class="hljs-built_in">rax</span>        <span class="hljs-comment">; char *</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">000000014000150D</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rcx</span>, <span class="hljs-built_in">rbx</span>        <span class="hljs-comment">; this</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000140001510</span> <span class="hljs-comment">;   try &#123;</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000140001510</span>                 <span class="hljs-keyword">call</span>    _ZNSt11logic_errorC1EPKc <span class="hljs-comment">; std::logic_error::logic_error(char const*)</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000140001510</span> <span class="hljs-comment">;   &#125; // starts at 140001510</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000140001515</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">r8</span>, <span class="hljs-built_in">cs</span>:_refptr__ZNSt11logic_errorD1Ev <span class="hljs-comment">; void (*)(void *)</span><br><span class="hljs-symbol">.text:</span>000000014000151C                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rax</span>, _ZTISt11logic_error <span class="hljs-comment">; `typeinfo for&#x27;std::logic_error</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000140001523</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rdx</span>, <span class="hljs-built_in">rax</span>        <span class="hljs-comment">; lptinfo</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000140001526</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rcx</span>, <span class="hljs-built_in">rbx</span>        <span class="hljs-comment">; void *</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000140001529</span> <span class="hljs-comment">;   try &#123;</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000140001529</span>                 <span class="hljs-keyword">call</span>    __cxa_throw<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000140001529</span> <span class="hljs-comment">;   &#125; // starts at 140001529</span><br><span class="hljs-symbol">.text:</span>000000014000152E <span class="hljs-comment">; ---------------------------------------------------------------------------</span><br><span class="hljs-symbol">.text:</span>000000014000152E <span class="hljs-comment">;   cleanup() // owned by 140001510</span><br><span class="hljs-symbol">.text:</span>000000014000152E                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rsi</span>, <span class="hljs-built_in">rax</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000140001531</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rcx</span>, <span class="hljs-built_in">rbx</span>        <span class="hljs-comment">; void *</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000140001534</span>                 <span class="hljs-keyword">call</span>    __cxa_free_exception<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000140001539</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">rsi</span><br><span class="hljs-symbol">.text:</span>000000014000153C                 <span class="hljs-keyword">jmp</span>     short $+<span class="hljs-number">2</span><br><span class="hljs-symbol">.text:</span>000000014000153E <span class="hljs-comment">; ---------------------------------------------------------------------------</span><br><span class="hljs-symbol">.text:</span>000000014000153E<br><span class="hljs-symbol">.text:</span>000000014000153E loc_14000153E:                          <span class="hljs-comment">; CODE XREF: solve(void)+66â†‘j</span><br><span class="hljs-symbol">.text:</span>000000014000153E <span class="hljs-comment">;   catch(...) // owned by 1400014F1    ; void *</span><br><span class="hljs-symbol">.text:</span>000000014000153E <span class="hljs-comment">;   catch(...) // owned by 140001529</span><br><span class="hljs-symbol">.text:</span>000000014000153E                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rcx</span>, <span class="hljs-built_in">rax</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000140001541</span>                 <span class="hljs-keyword">call</span>    __cxa_begin_catch<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000140001546</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rax</span>, enc        <span class="hljs-comment">; &quot;zbrpgs&#123;F4z3_Ge1px_jvgu_@sybjre_qrfhjn&#125;&quot;</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">000000014000154D</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rcx</span>, <span class="hljs-built_in">rax</span>        <span class="hljs-comment">; Str</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000140001550</span>                 <span class="hljs-keyword">call</span>    strlen<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000140001555</span>                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">rbp</span>+<span class="hljs-number">10h</span>+length], <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000140001558</span>                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">rbp</span>+<span class="hljs-number">10h</span>+count], <span class="hljs-number">0</span><br><span class="hljs-symbol">.text:</span>000000014000155F                 <span class="hljs-keyword">jmp</span>     loc_14000160E<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000140001564</span> <span class="hljs-comment">; ---------------------------------------------------------------------------</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000140001564</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000140001564</span> loc_140001564:                          <span class="hljs-comment">; CODE XREF: solve(void)+13Eâ†“j</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000140001564</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">rbp</span>+<span class="hljs-number">10h</span>+count]<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000140001567</span>                 <span class="hljs-keyword">cdqe</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000140001569</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rdx</span>, enc        <span class="hljs-comment">; &quot;zbrpgs&#123;F4z3_Ge1px_jvgu_@sybjre_qrfhjn&#125;&quot;</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000140001570</span>                 <span class="hljs-keyword">movzx</span>   <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rax</span>+<span class="hljs-built_in">rdx</span>]<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000140001574</span>                 <span class="hljs-keyword">movzx</span>   <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">al</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000140001577</span>                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">rbp</span>+<span class="hljs-number">10h</span>+C], <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>000000014000157A                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">rbp</span>+<span class="hljs-number">10h</span>+C]<br><span class="hljs-symbol">.text:</span><span class="hljs-number">000000014000157D</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-built_in">eax</span>        <span class="hljs-comment">; C</span><br><span class="hljs-symbol">.text:</span>000000014000157F                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">cs</span>:__imp_islower<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000140001586</span>                 <span class="hljs-keyword">call</span>    <span class="hljs-built_in">rax</span> <span class="hljs-comment">; __imp_islower ; åˆ¤æ–­å­—æ¯å¤§å°å†™</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000140001588</span>                 <span class="hljs-keyword">test</span>    <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>000000014000158A                 <span class="hljs-keyword">jz</span>      short loc_1400015B9 <span class="hljs-comment">; å¤§å†™å­—æ¯è·³è½¬</span><br><span class="hljs-symbol">.text:</span>000000014000158C                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">rbp</span>+<span class="hljs-number">10h</span>+C] <span class="hljs-comment">; enc[count]</span><br><span class="hljs-symbol">.text:</span>000000014000158F                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">edx</span>, [<span class="hljs-built_in">rax</span>-<span class="hljs-number">54h</span>]  <span class="hljs-comment">; enc[count]-0x54</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000140001592</span>                 <span class="hljs-keyword">movsxd</span>  <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">edx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000140001595</span>                 <span class="hljs-keyword">imul</span>    <span class="hljs-built_in">rax</span>, <span class="hljs-number">4EC4EC4Fh</span>  <span class="hljs-comment">; ä»è¿™é‡Œå¼€å§‹</span><br><span class="hljs-symbol">.text:</span>000000014000159C                 <span class="hljs-keyword">shr</span>     <span class="hljs-built_in">rax</span>, <span class="hljs-number">20h</span><br><span class="hljs-symbol">.text:</span>00000001400015A0                 <span class="hljs-keyword">sar</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">3</span><br><span class="hljs-symbol">.text:</span>00000001400015A3                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-built_in">edx</span><br><span class="hljs-symbol">.text:</span>00000001400015A5                 <span class="hljs-keyword">sar</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-number">1Fh</span><br><span class="hljs-symbol">.text:</span>00000001400015A8                 <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">ecx</span><br><span class="hljs-symbol">.text:</span>00000001400015AA                 <span class="hljs-keyword">imul</span>    <span class="hljs-built_in">ecx</span>, <span class="hljs-built_in">eax</span>, <span class="hljs-number">1Ah</span><br><span class="hljs-symbol">.text:</span>00000001400015AD                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">edx</span><br><span class="hljs-symbol">.text:</span>00000001400015AF                 <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">ecx</span>        <span class="hljs-comment">; åˆ°è¿™é‡Œç»“æŸï¼Œå®ç°çš„æ˜¯é™¤ä»¥26</span><br><span class="hljs-symbol">.text:</span>00000001400015B1                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">61h</span> <span class="hljs-comment">; &#x27;a&#x27;  ; åŠ ä¸Š0x61</span><br><span class="hljs-symbol">.text:</span>00000001400015B4                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">rbp</span>+<span class="hljs-number">10h</span>+C], <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>00000001400015B7                 <span class="hljs-keyword">jmp</span>     short loc_1400015F6<br><span class="hljs-symbol">.text:</span>00000001400015B9 <span class="hljs-comment">; ---------------------------------------------------------------------------</span><br><span class="hljs-symbol">.text:</span>00000001400015B9<br><span class="hljs-symbol">.text:</span>00000001400015B9 loc_1400015B9:                          <span class="hljs-comment">; CODE XREF: solve(void)+B4â†‘j</span><br><span class="hljs-symbol">.text:</span>00000001400015B9                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">rbp</span>+<span class="hljs-number">10h</span>+C]<br><span class="hljs-symbol">.text:</span>00000001400015BC                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-built_in">eax</span>        <span class="hljs-comment">; C</span><br><span class="hljs-symbol">.text:</span>00000001400015BE                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">cs</span>:__imp_isupper<br><span class="hljs-symbol">.text:</span>00000001400015C5                 <span class="hljs-keyword">call</span>    <span class="hljs-built_in">rax</span> <span class="hljs-comment">; __imp_isupper ; åˆ¤æ–­å­—æ¯å¤§å°å†™</span><br><span class="hljs-symbol">.text:</span>00000001400015C7                 <span class="hljs-keyword">test</span>    <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>00000001400015C9                 <span class="hljs-keyword">jz</span>      short loc_1400015F6 <span class="hljs-comment">; éå­—æ¯è·³è½¬</span><br><span class="hljs-symbol">.text:</span>00000001400015CB                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">rbp</span>+<span class="hljs-number">10h</span>+C] <span class="hljs-comment">; enc[count]</span><br><span class="hljs-symbol">.text:</span>00000001400015CE                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">edx</span>, [<span class="hljs-built_in">rax</span>-<span class="hljs-number">34h</span>]  <span class="hljs-comment">; enc[count]-0x34</span><br><span class="hljs-symbol">.text:</span>00000001400015D1                 <span class="hljs-keyword">movsxd</span>  <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">edx</span><br><span class="hljs-symbol">.text:</span>00000001400015D4                 <span class="hljs-keyword">imul</span>    <span class="hljs-built_in">rax</span>, <span class="hljs-number">4EC4EC4Fh</span>  <span class="hljs-comment">; ä»è¿™é‡Œå¼€å§‹</span><br><span class="hljs-symbol">.text:</span>00000001400015<span class="hljs-built_in">DB</span>                 <span class="hljs-keyword">shr</span>     <span class="hljs-built_in">rax</span>, <span class="hljs-number">20h</span><br><span class="hljs-symbol">.text:</span>00000001400015DF                 <span class="hljs-keyword">sar</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">3</span><br><span class="hljs-symbol">.text:</span>00000001400015E2                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-built_in">edx</span><br><span class="hljs-symbol">.text:</span>00000001400015E4                 <span class="hljs-keyword">sar</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-number">1Fh</span><br><span class="hljs-symbol">.text:</span>00000001400015E7                 <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">ecx</span><br><span class="hljs-symbol">.text:</span>00000001400015E9                 <span class="hljs-keyword">imul</span>    <span class="hljs-built_in">ecx</span>, <span class="hljs-built_in">eax</span>, <span class="hljs-number">1Ah</span><br><span class="hljs-symbol">.text:</span>00000001400015EC                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">edx</span><br><span class="hljs-symbol">.text:</span>00000001400015EE                 <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">ecx</span>        <span class="hljs-comment">; åˆ°è¿™é‡Œç»“æŸï¼Œå®ç°çš„æ˜¯é™¤ä»¥26</span><br><span class="hljs-symbol">.text:</span>00000001400015F0                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">41h</span> <span class="hljs-comment">; &#x27;A&#x27;  ; åŠ ä¸Š0x41</span><br><span class="hljs-symbol">.text:</span>00000001400015F3                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">rbp</span>+<span class="hljs-number">10h</span>+C], <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>00000001400015F6<br><span class="hljs-symbol">.text:</span>00000001400015F6 loc_1400015F6:                          <span class="hljs-comment">; CODE XREF: solve(void)+E1â†‘j</span><br><span class="hljs-symbol">.text:</span>00000001400015F6                                         <span class="hljs-comment">; solve(void)+F3â†‘j</span><br><span class="hljs-symbol">.text:</span>00000001400015F6                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">rbp</span>+<span class="hljs-number">10h</span>+C]<br><span class="hljs-symbol">.text:</span>00000001400015F9                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>00000001400015FB                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">rbp</span>+<span class="hljs-number">10h</span>+count]<br><span class="hljs-symbol">.text:</span>00000001400015FE                 <span class="hljs-keyword">cdqe</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000140001600</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rdx</span>, enc        <span class="hljs-comment">; &quot;zbrpgs&#123;F4z3_Ge1px_jvgu_@sybjre_qrfhjn&#125;&quot;</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000140001607</span>                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">rax</span>+<span class="hljs-built_in">rdx</span>], <span class="hljs-built_in">cl</span><br><span class="hljs-symbol">.text:</span>000000014000160A                 <span class="hljs-keyword">add</span>     [<span class="hljs-built_in">rbp</span>+<span class="hljs-number">10h</span>+count], <span class="hljs-number">1</span><br><span class="hljs-symbol">.text:</span>000000014000160E<br><span class="hljs-symbol">.text:</span>000000014000160E loc_14000160E:                          <span class="hljs-comment">; CODE XREF: solve(void)+89â†‘j</span><br><span class="hljs-symbol">.text:</span>000000014000160E                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">rbp</span>+<span class="hljs-number">10h</span>+count]<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000140001611</span>                 <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">rbp</span>+<span class="hljs-number">10h</span>+length]<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000140001614</span>                 <span class="hljs-keyword">jl</span>      loc_140001564<br><span class="hljs-symbol">.text:</span>000000014000161A                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rax</span>, aSoYouDidnTCatc <span class="hljs-comment">; &quot;so you didn&#x27;t catch me?\n&quot;</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000140001621</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rcx</span>, <span class="hljs-built_in">rax</span>        <span class="hljs-comment">; char *</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000140001624</span> <span class="hljs-comment">;   try &#123;</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000140001624</span>                 <span class="hljs-keyword">call</span>    print<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000140001624</span> <span class="hljs-comment">;   &#125; // starts at 140001624</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000140001629</span>                 <span class="hljs-keyword">call</span>    __cxa_end_catch<br><span class="hljs-symbol">.text:</span>000000014000162E                 <span class="hljs-keyword">jmp</span>     short loc_140001644<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000140001630</span> <span class="hljs-comment">; ---------------------------------------------------------------------------</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000140001630</span> <span class="hljs-comment">;   cleanup() // owned by 140001624</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000140001630</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rbx</span>, <span class="hljs-built_in">rax</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000140001633</span>                 <span class="hljs-keyword">call</span>    __cxa_end_catch<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000140001638</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">rbx</span><br><span class="hljs-symbol">.text:</span>000000014000163B                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rcx</span>, <span class="hljs-built_in">rax</span>        <span class="hljs-comment">; gcc_exc</span><br><span class="hljs-symbol">.text:</span>000000014000163E                 <span class="hljs-keyword">call</span>    _Unwind_Resume<br><span class="hljs-symbol">.text:</span>000000014000163E <span class="hljs-comment">; ---------------------------------------------------------------------------</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000140001643</span>                 <span class="hljs-meta">align</span> <span class="hljs-number">4</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000140001644</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000140001644</span> loc_140001644:                          <span class="hljs-comment">; CODE XREF: solve(void)+158â†‘j</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000140001644</span>                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">rsp</span>, <span class="hljs-number">30h</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000140001648</span>                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">rbx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000140001649</span>                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">rsi</span><br><span class="hljs-symbol">.text:</span>000000014000164A                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">rbp</span><br><span class="hljs-symbol">.text:</span>000000014000164B                 <span class="hljs-keyword">retn</span><br><span class="hljs-symbol">.text:</span>000000014000164B <span class="hljs-comment">; &#125; // starts at 1400014D6</span><br><span class="hljs-symbol">.text:</span>000000014000164B _Z5solvev       endp<br></code></pre></td></tr></table></figure>
</li>
<li><p>è§£å¯†è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">decode</span>(<span class="hljs-params">s</span>):<br>    result = []<br>    <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> s:<br>        <span class="hljs-comment">#å°å†™å­—æ¯</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;a&#x27;</span> &lt;= char &lt;= <span class="hljs-string">&#x27;z&#x27;</span>:<br>            new_char = <span class="hljs-built_in">chr</span>((<span class="hljs-built_in">ord</span>(char) - <span class="hljs-number">0x54</span>) % <span class="hljs-number">26</span> + <span class="hljs-number">0x61</span>)<br>            result.append(new_char)<br>        <span class="hljs-comment">#å¤§å†™å­—æ¯</span><br>        <span class="hljs-keyword">elif</span> <span class="hljs-string">&#x27;A&#x27;</span> &lt;= char &lt;= <span class="hljs-string">&#x27;Z&#x27;</span>:<br>            new_char = <span class="hljs-built_in">chr</span>((<span class="hljs-built_in">ord</span>(char) - <span class="hljs-number">0x34</span>) % <span class="hljs-number">26</span> + <span class="hljs-number">0x41</span>)<br>            result.append(new_char)<br>        <span class="hljs-comment">#éå­—æ¯</span><br>        <span class="hljs-keyword">else</span>:<br>            result.append(char)<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;</span>.join(result)<br><br>enc = <span class="hljs-string">&quot;zbrpgs&#123;F4z3_Ge1px_jvgu_@sybjre_qrfhjn&#125;&quot;</span><br>flag = decode(enc)<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure></li>
</ul>
<h3 id="upx-revenge"><a href="#upx-revenge" class="headerlink" title="upx_revenge"></a>upx_revenge</h3><ul>
<li><p>é™„ä»¶ç¨‹åºè¿è¡Œä¸äº†ï¼Œå¦‚å›¾ï¼š</p>
<p><img src="/../images/image-20251003124237857-1760193218429-23.png" alt="è¿è¡ŒæŠ¥é”™"></p>
<p>é¢˜ç›®æç¤ºupxç‰¹å¾æ®µé­”æ”¹ï¼Œä½†æ˜¯è‡ªå·±å°è¯•åå‘ç°é­”æ”¹ç‰¹å¾æ®µä¸ä¼šå¯¼è‡´ç¨‹åºè¿è¡Œä¸äº†</p>
<p>åæ¥ç¢ç£¨äº†åŠå¤©ï¼Œæ‹·æ‰“<del>(bushi</del>äº†ä¸€ä¸‹å‡ºé¢˜äººï¼Œæ‰å‘ç°è¿™ä¸ªç¨‹åºç¼ºäº†bytesï¼ˆçœ‹äº†å®˜æ–¹WriteUpï¼Œå‘ç°è¿™ç¡®å®æ˜¯ä¸€ä¸ªè€ƒç‚¹ğŸ˜­ï¼Œæˆ‘çœŸå‚»ï¼ŒçœŸçš„ï¼Œæˆ‘å•çŸ¥é“upxé­”æ”¹ä¼šæ”¹ç‰¹å¾æ®µæ•°æ®ï¼Œæˆ‘ä¸çŸ¥é“è¿˜å¯ä»¥åˆ æ•°æ®ğŸ˜­ï¼‰</p>
<p><img src="/../images/image-20251003124409938-1760193218429-22.png" alt="è¿™æ˜¯week1_upxçš„ç»“å°¾"></p>
<p><img src="/../images/image-20251003124456921-1760193218429-21.png" alt="è¿™æ˜¯æœ¬é¢˜ç¨‹åºçš„ç»“å°¾"></p>
<p>ç¼ºå°‘çš„åœ°æ–¹åœ¨upxç‰¹å¾æ®µï¼Œå¯ä»¥å‘ç°upx1æ®µå¼€å¤´çš„å››ä¸ªå­—èŠ‚é”™ä½äº†ï¼Œé”™ä½åˆ°upxç‰¹å¾æ®µä¸Šäº†ï¼Œæ‰€ä»¥è¦ç»™ç‰¹å¾æ®µæ’å…¥å››ä¸ªå­—èŠ‚</p>
<p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-10-03%20124610-1760193218429-24.png" alt="è¿™æ˜¯week1_upxçš„ç‰¹å¾æ®µ"></p>
<p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-10-03%20124713-1760193218429-26.png" alt="è¿™æ˜¯æœ¬é¢˜ç¨‹åºçš„ç‰¹å¾æ®µ"></p>
<p>ç”¨010editoråœ¨49 01 00 C3åé¢æŒ‰Ctrl+shift+Iæ’å…¥4bytesï¼ˆé»˜è®¤å¡«å……ä¸º0ï¼‰ï¼Œä¼šå‘ç°ç¨‹åºå¯ä»¥è¿è¡Œäº†</p>
<p><img src="/../images/image-20251003125528890-1760193218429-25.png" alt="æ’å…¥4å­—èŠ‚"></p>
<p><img src="/../images/image-20251003125621022-1760193218429-29.png" alt="ç¨‹åºå¯ä»¥è¿è¡Œäº†"></p>
</li>
<li><p>é‡‡ç”¨æ‰‹åŠ¨è„±å£³çš„åŠæ³•ã€‚å…·ä½“æ“ä½œå¯ä»¥å‚è€ƒweek1_upxçš„è§£æ³•æˆ–è€…çœ‹çœ‹<a href="http://sydzi.github.io/2025/07/29/Day9-%E5%A3%B3/">Day9:å£³ä¸è„±å£³ï¼ˆä¸€ï¼‰</a>å’Œ<a href="http://sydzi.github.io/2025/07/30/Day10-%E5%A3%B3%E4%B8%8E%E8%84%B1%E5%A3%B3%EF%BC%88%E4%BA%8C%EF%BC%89/">Day10:å£³ä¸è„±å£³ï¼ˆäºŒï¼‰</a><del>ï¼ˆç‹å©†å–ç“œè¿™ä¸€å—</del>ï¼Œè¿™é‡Œä»æ‰¾åˆ°OEPå¼€å§‹ï¼š</p>
<p><img src="/../images/image-20251003131740100-1760193218429-28.png" alt="OEP"></p>
<p>ä¸‹æ–­ç‚¹F9è¿è¡Œåˆ°ä¸Šå›¾è¿™ä¸ªå¤§è·³ï¼Œç„¶åF7æ­¥å…¥</p>
<p><img src="/../images/image-20251003131847409-1760193218429-31.png" alt="OEPä½ç½®"></p>
<p>RIPæŒ‡å‘æ­¤å¤„æ—¶ï¼Œæ‰“å¼€scyllaè¿›è¡Œè½¬å‚¨å’ŒIATé‡å»ºä¿®å¤è½¬å‚¨ã€‚è¿™é‡Œéœ€è¦æ³¨æ„ï¼ŒIATæœç´¢å‡ºæ¥çš„ç»“æœé‡Œæœ‰ä¸€ä¸ªæŸåçš„å¯¼å…¥ï¼Œéœ€è¦æŠŠå®ƒåˆ æ‰</p>
<p><img src="/../images/image-20251003132216493-1760193218429-27.png" alt="åˆ é™¤æ— æ•ˆå¯¼å…¥ç»“ç‚¹"></p>
<p>è„±å£³åçš„_dump_SCY.exeæ–‡ä»¶å°±å¯ä»¥ç”¨IDAæ‰“å¼€æ­£å¸¸åˆ†æäº†</p>
</li>
<li><p>é¦–å…ˆæŸ¥çœ‹å­—ç¬¦ä¸²è¡¨ï¼Œå¯ä»¥å‘ç°å¯ç–‘çš„çš„æç¤ºâ€correctâ€</p>
<p><img src="/../images/image-20251003132623642-1760193218429-30.png" alt="å¯ç–‘çš„æç¤º"></p>
</li>
<li><p>è·Ÿè¸ªcorrectå¯ä»¥æ‰¾åˆ°mainå‡½æ•°ã€‚ä¸‹é¢æ˜¯ä¼˜åŒ–åçš„mainå‡½æ•°å’Œç›¸å…³çš„å‡½æ•°</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><code class="hljs c++"><span class="hljs-comment">// Hidden C++ exception states: #wind=5</span><br><span class="hljs-function"><span class="hljs-type">int</span> __fastcall <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **argv, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **envp)</span></span><br><span class="hljs-function"></span>&#123;<br>  __int64 v3; <span class="hljs-comment">// rax</span><br>  __int64 v4; <span class="hljs-comment">// rdx</span><br>  <span class="hljs-type">unsigned</span> __int8 v5; <span class="hljs-comment">// al</span><br>  __int64 v6; <span class="hljs-comment">// r8</span><br>  <span class="hljs-type">void</span> **v7; <span class="hljs-comment">// rdx</span><br>  <span class="hljs-type">void</span> **v8; <span class="hljs-comment">// rsi</span><br>  <span class="hljs-type">size_t</span> length; <span class="hljs-comment">// rdi</span><br>  <span class="hljs-type">void</span> *v10; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">void</span> *v11; <span class="hljs-comment">// rcx</span><br>  _QWORD *newBuffer; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">char</span> *v13; <span class="hljs-comment">// rbx</span><br>  <span class="hljs-type">char</span> *enc; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">char</span> *v15; <span class="hljs-comment">// rbx</span><br>  <span class="hljs-type">void</span> **encryptedFlag; <span class="hljs-comment">// rcx</span><br>  <span class="hljs-type">int</span> v17; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *outString; <span class="hljs-comment">// rdx</span><br>  __int64 v19; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">void</span> *v20; <span class="hljs-comment">// rcx</span><br>  <span class="hljs-type">void</span> *v21; <span class="hljs-comment">// rcx</span><br>  <span class="hljs-type">void</span> *v22; <span class="hljs-comment">// rcx</span><br>  <span class="hljs-type">void</span> *v23; <span class="hljs-comment">// rcx</span><br>  <span class="hljs-type">void</span> *CopiedFlag[<span class="hljs-number">2</span>]; <span class="hljs-comment">// [rsp+28h] [rbp-51h] BYREF</span><br>  <span class="hljs-type">char</span> *bufferEnd; <span class="hljs-comment">// [rsp+38h] [rbp-41h]</span><br>  <span class="hljs-type">void</span> *flag[<span class="hljs-number">2</span>]; <span class="hljs-comment">// [rsp+40h] [rbp-39h] BYREF</span><br>  __m128i si128; <span class="hljs-comment">// [rsp+50h] [rbp-29h]</span><br>  <span class="hljs-type">void</span> *encodeResult[<span class="hljs-number">2</span>]; <span class="hljs-comment">// [rsp+60h] [rbp-19h] BYREF</span><br>  <span class="hljs-type">size_t</span> Size; <span class="hljs-comment">// [rsp+70h] [rbp-9h]</span><br>  <span class="hljs-type">unsigned</span> __int64 v31; <span class="hljs-comment">// [rsp+78h] [rbp-1h]</span><br>  <span class="hljs-type">void</span> *modifiedBaseTable[<span class="hljs-number">2</span>]; <span class="hljs-comment">// [rsp+80h] [rbp+7h] BYREF</span><br>  __m128i v33; <span class="hljs-comment">// [rsp+90h] [rbp+17h]</span><br>  __int128 v34; <span class="hljs-comment">// [rsp+A0h] [rbp+27h]</span><br>  __int64 v35; <span class="hljs-comment">// [rsp+B0h] [rbp+37h]</span><br>  __int64 v36; <span class="hljs-comment">// [rsp+B8h] [rbp+3Fh]</span><br><br>  v3 = <span class="hljs-built_in">output</span>(std::cout, pleaseEnterYourFlag);<br>  std::istream::<span class="hljs-keyword">operator</span>&gt;&gt;(v3, out_flush);<br>  *flag = <span class="hljs-number">0LL</span>;<br>  si128 = _mm_load_si128(&amp;xmmword_7FF7420B44B0);<br>  <span class="hljs-built_in">LOBYTE</span>(flag[<span class="hljs-number">0</span>]) = <span class="hljs-number">0</span>;<br>  <span class="hljs-built_in">LOBYTE</span>(v4) = <span class="hljs-number">10</span>;<br>  v5 = std::ios::<span class="hljs-built_in">widen</span>(&amp;std::cin + *(std::cin + <span class="hljs-number">4LL</span>), v4);<br>  <span class="hljs-built_in">input</span>(std::cin, flag, v5);<br>  v7 = flag;<br>  <span class="hljs-keyword">if</span> ( si<span class="hljs-number">128.</span>m128i_i64[<span class="hljs-number">1</span>] &gt; <span class="hljs-number">0xFuLL</span> )            <span class="hljs-comment">// si128.m128i_i64[1]æ˜¯è¾“å…¥çš„flagçš„é•¿åº¦</span><br>    v7 = flag[<span class="hljs-number">0</span>];<br>  v8 = flag;<br>  <span class="hljs-keyword">if</span> ( si<span class="hljs-number">128.</span>m128i_i64[<span class="hljs-number">1</span>] &gt; <span class="hljs-number">0xFuLL</span> )<br>    v8 = flag[<span class="hljs-number">0</span>];<br>  *CopiedFlag = <span class="hljs-number">0LL</span>;<br>  bufferEnd = <span class="hljs-number">0LL</span>;<br>  length = v7 + si<span class="hljs-number">128.</span>m128i_i64[<span class="hljs-number">0</span>] - v8;<br>  <span class="hljs-keyword">if</span> ( length )<br>  &#123;<br>    <span class="hljs-keyword">if</span> ( length &gt; <span class="hljs-number">0x7FFFFFFFFFFFFFFFLL</span> )<br>      <span class="hljs-built_in">lengthError</span>();<br>    <span class="hljs-keyword">if</span> ( length &lt; <span class="hljs-number">0x1000</span> )<br>    &#123;<br>      newBuffer = <span class="hljs-keyword">operator</span> <span class="hljs-built_in">new</span>(length);<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>      <span class="hljs-keyword">if</span> ( length + <span class="hljs-number">39</span> &lt; length )<br>        <span class="hljs-built_in">sub_7FF7420B1170</span>();<br>      v10 = <span class="hljs-keyword">operator</span> <span class="hljs-built_in">new</span>(length + <span class="hljs-number">39</span>);<br>      v11 = v10;<br>      <span class="hljs-keyword">if</span> ( !v10 )<br>LABEL_31:<br>        <span class="hljs-built_in">invalid_parameter_noinfo_noreturn</span>();<br>      newBuffer = ((v10 + <span class="hljs-number">39</span>) &amp; <span class="hljs-number">0xFFFFFFFFFFFFFFE0uLL</span>);<br>      *(newBuffer - <span class="hljs-number">1</span>) = v11;<br>    &#125;<br>    CopiedFlag[<span class="hljs-number">0</span>] = newBuffer;<br>    v13 = newBuffer + length;<br>    bufferEnd = newBuffer + length;<br>    <span class="hljs-built_in">memmove</span>(newBuffer, v8, length);<br>    CopiedFlag[<span class="hljs-number">1</span>] = v13;<br>  &#125;<br>  <span class="hljs-built_in">XORencrypt</span>(modifiedBaseTable, v7, v6);        <span class="hljs-comment">// é­”æ”¹base64çš„ç¼–ç è¡¨</span><br>  <span class="hljs-built_in">baseEncode</span>(encodeResult, CopiedFlag, modifiedBaseTable);<span class="hljs-comment">// base64ç¼–ç </span><br>  v34 = <span class="hljs-number">0LL</span>;<br>  enc = <span class="hljs-keyword">operator</span> <span class="hljs-built_in">new</span>(<span class="hljs-number">0x30uLL</span>);<br>  v15 = enc;<br>  *&amp;v34 = enc;<br>  v35 = <span class="hljs-number">44LL</span>;<br>  v36 = <span class="hljs-number">47LL</span>;<br>  <span class="hljs-built_in">strcpy</span>(enc, <span class="hljs-string">&quot;lY7bW=\\ck?eyjX7]TZ\\&#125;CVbh\\tOyTH6&gt;jH7XmFifG]H7&quot;</span>);<br>  encryptedFlag = encodeResult;<br>  <span class="hljs-keyword">if</span> ( v31 &gt; <span class="hljs-number">0xF</span> )<br>    encryptedFlag = encodeResult[<span class="hljs-number">0</span>];<br>  <span class="hljs-keyword">if</span> ( Size != <span class="hljs-number">44</span> || (v17 = <span class="hljs-built_in">memcmp</span>(encryptedFlag, enc, <span class="hljs-number">0x2CuLL</span>), outString = aCorrect, v17) )<br>    outString = aWrong;<br>  v19 = <span class="hljs-built_in">output</span>(std::cout, outString);<br>  std::istream::<span class="hljs-keyword">operator</span>&gt;&gt;(v19, out_flush);<br>  <span class="hljs-built_in">j_j_free</span>(v15);<br>  <span class="hljs-keyword">if</span> ( v31 &gt; <span class="hljs-number">0xF</span> )<br>  &#123;<br>    v20 = encodeResult[<span class="hljs-number">0</span>];<br>    <span class="hljs-keyword">if</span> ( v31 + <span class="hljs-number">1</span> &gt;= <span class="hljs-number">0x1000</span> )<br>    &#123;<br>      v20 = *(encodeResult[<span class="hljs-number">0</span>] - <span class="hljs-number">1</span>);<br>      <span class="hljs-keyword">if</span> ( (encodeResult[<span class="hljs-number">0</span>] - v20 - <span class="hljs-number">8</span>) &gt; <span class="hljs-number">0x1F</span> )<br>        <span class="hljs-built_in">invalid_parameter_noinfo_noreturn</span>();<br>    &#125;<br>    <span class="hljs-built_in">j_j_free</span>(v20);<br>  &#125;<br>  Size = <span class="hljs-number">0LL</span>;<br>  v31 = <span class="hljs-number">15LL</span>;<br>  <span class="hljs-built_in">LOBYTE</span>(encodeResult[<span class="hljs-number">0</span>]) = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">if</span> ( v<span class="hljs-number">33.</span>m128i_i64[<span class="hljs-number">1</span>] &gt; <span class="hljs-number">0xFuLL</span> )<br>  &#123;<br>    v21 = modifiedBaseTable[<span class="hljs-number">0</span>];<br>    <span class="hljs-keyword">if</span> ( (v<span class="hljs-number">33.</span>m128i_i64[<span class="hljs-number">1</span>] + <span class="hljs-number">1</span>) &gt;= <span class="hljs-number">0x1000</span> )<br>    &#123;<br>      v21 = *(modifiedBaseTable[<span class="hljs-number">0</span>] - <span class="hljs-number">1</span>);<br>      <span class="hljs-keyword">if</span> ( (modifiedBaseTable[<span class="hljs-number">0</span>] - v21 - <span class="hljs-number">8</span>) &gt; <span class="hljs-number">0x1F</span> )<br>        <span class="hljs-built_in">invalid_parameter_noinfo_noreturn</span>();<br>    &#125;<br>    <span class="hljs-built_in">j_j_free</span>(v21);<br>  &#125;<br>  v33 = _mm_load_si128(&amp;xmmword_7FF7420B44B0);<br>  <span class="hljs-built_in">LOBYTE</span>(modifiedBaseTable[<span class="hljs-number">0</span>]) = <span class="hljs-number">0</span>;<br>  v22 = CopiedFlag[<span class="hljs-number">0</span>];<br>  <span class="hljs-keyword">if</span> ( CopiedFlag[<span class="hljs-number">0</span>] )<br>  &#123;<br>    <span class="hljs-keyword">if</span> ( (bufferEnd - CopiedFlag[<span class="hljs-number">0</span>]) &gt;= <span class="hljs-number">0x1000</span> )<br>    &#123;<br>      v22 = *(CopiedFlag[<span class="hljs-number">0</span>] - <span class="hljs-number">1</span>);<br>      <span class="hljs-keyword">if</span> ( (CopiedFlag[<span class="hljs-number">0</span>] - v22 - <span class="hljs-number">8</span>) &gt; <span class="hljs-number">0x1F</span> )<br>        <span class="hljs-keyword">goto</span> LABEL_31;<br>    &#125;<br>    <span class="hljs-built_in">j_j_free</span>(v22);<br>  &#125;<br>  <span class="hljs-keyword">if</span> ( si<span class="hljs-number">128.</span>m128i_i64[<span class="hljs-number">1</span>] &gt; <span class="hljs-number">0xFuLL</span> )<br>  &#123;<br>    v23 = flag[<span class="hljs-number">0</span>];<br>    <span class="hljs-keyword">if</span> ( (si<span class="hljs-number">128.</span>m128i_i64[<span class="hljs-number">1</span>] + <span class="hljs-number">1</span>) &gt;= <span class="hljs-number">0x1000</span> )<br>    &#123;<br>      v23 = *(flag[<span class="hljs-number">0</span>] - <span class="hljs-number">1</span>);<br>      <span class="hljs-keyword">if</span> ( (flag[<span class="hljs-number">0</span>] - v23 - <span class="hljs-number">8</span>) &gt; <span class="hljs-number">0x1F</span> )<br>        <span class="hljs-built_in">invalid_parameter_noinfo_noreturn</span>();<br>    &#125;<br>    <span class="hljs-built_in">j_j_free</span>(v23);<br>  &#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-comment">// Hidden C++ exception states: #wind=5</span><br><span class="hljs-function">_QWORD *__fastcall <span class="hljs-title">XORencrypt</span><span class="hljs-params">(_QWORD *modifiedTable, __int64 a2, __int64 a3)</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-type">void</span> **pTableStart; <span class="hljs-comment">// rdx</span><br>  <span class="hljs-type">void</span> **pCurrentPos; <span class="hljs-comment">// rdi</span><br>  <span class="hljs-type">void</span> **i; <span class="hljs-comment">// rsi</span><br>  <span class="hljs-type">char</span> xored; <span class="hljs-comment">// r9</span><br>  <span class="hljs-type">unsigned</span> __int64 cucrrentSize; <span class="hljs-comment">// rcx</span><br>  <span class="hljs-type">unsigned</span> __int64 capacity; <span class="hljs-comment">// rdx</span><br>  _QWORD *Table; <span class="hljs-comment">// rax</span><br><br>  *modifiedTable = <span class="hljs-number">0LL</span>;<br>  modifiedTable[<span class="hljs-number">2</span>] = <span class="hljs-number">0LL</span>;<br>  modifiedTable[<span class="hljs-number">3</span>] = <span class="hljs-number">15LL</span>;<br>  *modifiedTable = <span class="hljs-number">0</span>;<br>  pTableStart = &amp;oriTable;<br>  pCurrentPos = &amp;oriTable;<br>  <span class="hljs-keyword">if</span> ( *(&amp;xmmword_7FF7420B6760 + <span class="hljs-number">1</span>) &gt; <span class="hljs-number">0xFuLL</span> )<br>  &#123;<br>    pCurrentPos = oriTable;                     <span class="hljs-comment">// oriTableæ˜¯åŸå§‹çš„base64ç¼–ç è¡¨</span><br>    pTableStart = oriTable;<br>  &#125;<br>  <span class="hljs-keyword">for</span> ( i = (pTableStart + xmmword_7FF7420B6760); pCurrentPos != i; pCurrentPos = (pCurrentPos + <span class="hljs-number">1</span>) )<br>  &#123;<br>    xored = *pCurrentPos ^ <span class="hljs-number">0xE</span>;                 <span class="hljs-comment">// éå†Tableå¹¶å¼‚æˆ–0xEï¼Œåˆ›å»ºä¸€ä¸ªé­”æ”¹çš„ç¼–ç è¡¨</span><br>    cucrrentSize = modifiedTable[<span class="hljs-number">2</span>];<br>    capacity = modifiedTable[<span class="hljs-number">3</span>];<br>    <span class="hljs-keyword">if</span> ( cucrrentSize &gt;= capacity )<br>    &#123;<br>      <span class="hljs-built_in">needExpand</span>(modifiedTable, capacity, a3, xored);<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>      modifiedTable[<span class="hljs-number">2</span>] = cucrrentSize + <span class="hljs-number">1</span>;      <span class="hljs-comment">// æ­¤å¤„å¼€å§‹å†™å…¥xorå¤„ç†åçš„tableå­—ç¬¦</span><br>      Table = modifiedTable;<br>      <span class="hljs-keyword">if</span> ( capacity &gt; <span class="hljs-number">0xF</span> )<br>        Table = *modifiedTable;<br>      *(Table + cucrrentSize) = xored;<br>      *(Table + cucrrentSize + <span class="hljs-number">1</span>) = <span class="hljs-number">0</span>;<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">return</span> modifiedTable;<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>å¯ä»¥çœ‹å‡ºé€»è¾‘å°±æ˜¯å…ˆé­”æ”¹base64çš„ç¼–ç è¡¨ï¼Œç„¶åå†ç”¨é­”æ”¹çš„ç¼–ç è¡¨å¯¹flagè¿›è¡Œbase64ç¼–ç ï¼Œæœ€åå’Œç»™å®šçš„å¯†æ–‡æ¯”è¾ƒã€‚å¯ä»¥å…ˆå¯¹encè¿›è¡Œå¼‚æˆ–ï¼Œç„¶åå†base64è§£ç </p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">enc = <span class="hljs-string">&quot;lY7bW=\\ck?eyjX7]TZ\\&#125;CVbh\\tOyTH6&gt;jH7XmFifG]H7&quot;</span><br>data = <span class="hljs-string">&quot;&quot;</span><br><br><span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> enc:<br>    data += <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(char) ^ <span class="hljs-number">0xE</span>)<br><span class="hljs-built_in">print</span>(data)<br><span class="hljs-comment">#bW9lY3Rme1kwdV9SZTRsMXlfRzAwZF80dF9VcHghISF9</span><br></code></pre></td></tr></table></figure>

<p><img src="/../images/image-20251003134212864-1760193218429-34.png" alt="base64è§£ç "></p>
</li>
</ul>
<h3 id="Two-cups-of-tea"><a href="#Two-cups-of-tea" class="headerlink" title="Two cups of tea"></a>Two cups of tea</h3><ul>
<li><p>åç¼–è¯‘çš„ä»£ç åˆ†æä¼˜åŒ–åå¤§æ¦‚æ˜¯è¿™æ ·ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><code class="hljs c++"><span class="hljs-comment">//mainå‡½æ•°éƒ¨åˆ†</span><br><span class="hljs-function"><span class="hljs-type">int</span> __fastcall <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **argv, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **envp)</span></span><br><span class="hljs-function"></span>&#123;<br>  __int64 n; <span class="hljs-comment">// rbx</span><br>  FILE *Stream; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">size_t</span> length; <span class="hljs-comment">// rax</span><br>  __int64 v6; <span class="hljs-comment">// rdx</span><br>  __int64 count; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">unsigned</span> __int64 tmp4key; <span class="hljs-comment">// [rsp+20h] [rbp-E0h] BYREF</span><br>  <span class="hljs-type">char</span> key_2; <span class="hljs-comment">// [rsp+28h] [rbp-D8h]</span><br>  __int64 key_1; <span class="hljs-comment">// [rsp+30h] [rbp-D0h] BYREF</span><br>  <span class="hljs-type">int</span> key_3; <span class="hljs-comment">// [rsp+38h] [rbp-C8h]</span><br>  <span class="hljs-type">int</span> key_4; <span class="hljs-comment">// [rsp+3Ch] [rbp-C4h]</span><br>  _DWORD enc[<span class="hljs-number">10</span>]; <span class="hljs-comment">// [rsp+40h] [rbp-C0h]</span><br>  _OWORD flag[<span class="hljs-number">2</span>]; <span class="hljs-comment">// [rsp+68h] [rbp-98h] BYREF</span><br>  __int64 v16; <span class="hljs-comment">// [rsp+88h] [rbp-78h]</span><br>  <span class="hljs-type">char</span> Buffer[<span class="hljs-number">16</span>]; <span class="hljs-comment">// [rsp+90h] [rbp-70h] BYREF</span><br>  __int128 v18; <span class="hljs-comment">// [rsp+A0h] [rbp-60h]</span><br>  __int64 v19; <span class="hljs-comment">// [rsp+B0h] [rbp-50h]</span><br><br>  n = <span class="hljs-number">0LL</span>;<br>  key_1 = <span class="hljs-number">2LL</span>;<br>  key_2 = <span class="hljs-number">0</span>;<br>  key_3 = <span class="hljs-number">2</span>;<br>  key_4 = <span class="hljs-number">5</span>;<br>  enc[<span class="hljs-number">0</span>] = <span class="hljs-number">0x5D624C34</span>;<br>  enc[<span class="hljs-number">1</span>] = <span class="hljs-number">0x8629FEAD</span>;<br>  enc[<span class="hljs-number">2</span>] = <span class="hljs-number">0x9D11379B</span>;<br>  enc[<span class="hljs-number">3</span>] = <span class="hljs-number">0xFCD53211</span>;<br>  enc[<span class="hljs-number">4</span>] = <span class="hljs-number">0x460F63CE</span>;<br>  enc[<span class="hljs-number">5</span>] = <span class="hljs-number">0xC5816E68</span>;<br>  enc[<span class="hljs-number">6</span>] = <span class="hljs-number">0xFE5300AD</span>;<br>  enc[<span class="hljs-number">7</span>] = <span class="hljs-number">0xA0015EE</span>;<br>  enc[<span class="hljs-number">8</span>] = <span class="hljs-number">0x9806DBBB</span>;<br>  enc[<span class="hljs-number">9</span>] = <span class="hljs-number">0xEF4A2648</span>;<br>  tmp4key = <span class="hljs-number">0xD0FCC6A7B8941CAFuLL</span>;<br>  <span class="hljs-built_in">key_init</span>(*&amp;argc, &amp;tmp4key, &amp;key_1);<span class="hljs-comment">// è¿™é‡Œåˆå§‹åŒ–äº†key,ä¸å¿…ç†ä¼šå…·ä½“å®ç°ï¼Œå¯ä»¥åŠ¨è°ƒå¾—åˆ°ç»“æœ</span><br>  <span class="hljs-built_in">printf</span>(&amp;pleaseEnterYourFlag);<br>  Stream = _acrt_iob_func(<span class="hljs-number">0</span>);<br>  <span class="hljs-built_in">fgets</span>(Buffer, <span class="hljs-number">100</span>, Stream);<br>  length = <span class="hljs-built_in">strcspn</span>(Buffer, <span class="hljs-string">&quot;\n&quot;</span>);<span class="hljs-comment">// è·å–flagçš„é•¿åº¦</span><br>  <span class="hljs-keyword">if</span> ( length &gt;= <span class="hljs-number">0x64</span> )<br>    _report_securityfailure_();<br>  Buffer[length] = <span class="hljs-number">0</span>;<br>  flag[<span class="hljs-number">0</span>] = *Buffer;<br>  key_1 = tmp4key;<br>  v16 = v19;<br>  flag[<span class="hljs-number">1</span>] = v18;<br>  key_3 = <span class="hljs-number">0x12345678</span>;<br>  key_4 = <span class="hljs-number">0x9ABCDEF0</span>;<br>  <span class="hljs-built_in">modefiedTea</span>(flag, v6, &amp;key_1);<span class="hljs-comment">// é­”æ”¹çš„teaï¼ŒåŠ å¯†flagä»¥ä¾¿æ¯”å¯¹éªŒè¯</span><br>  count = <span class="hljs-number">-1LL</span>;<br>  <span class="hljs-keyword">do</span><br>    ++count;<br>  <span class="hljs-keyword">while</span> ( Buffer[count] );<span class="hljs-comment">// ç¡®è®¤flagé•¿åº¦</span><br>  <span class="hljs-keyword">if</span> ( count == <span class="hljs-number">40</span> )<br>  &#123;<br>    <span class="hljs-keyword">while</span> ( *(flag + n * <span class="hljs-number">4</span>) == enc[n] )<span class="hljs-comment">// æ¯”å¯¹éªŒè¯</span><br>    &#123;<br>      <span class="hljs-keyword">if</span> ( ++n &gt;= <span class="hljs-number">10</span> )<br>      &#123;<br>        <span class="hljs-built_in">printf</span>(right);<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>      &#125;<br>    &#125;<br>    <span class="hljs-built_in">printf</span>(wrong);<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    <span class="hljs-built_in">printf</span>(Format_0);<br>  &#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br><br><span class="hljs-comment">//é­”æ”¹teaéƒ¨åˆ†</span><br><span class="hljs-function">__int64 __fastcall <span class="hljs-title">modefiedTea</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> *flag, __int64 a2, __int64 key)</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> flag_9; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> delta; <span class="hljs-comment">// r11d</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> flag_eight; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> flag_1; <span class="hljs-comment">// esi</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> flag_2; <span class="hljs-comment">// ebp</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> flag_3; <span class="hljs-comment">// r14d</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> flag_4; <span class="hljs-comment">// r15d</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> flag_5; <span class="hljs-comment">// r12d</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> flag_6; <span class="hljs-comment">// r13d</span><br>  <span class="hljs-type">int</span> flag_o; <span class="hljs-comment">// ebx</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> flag_7; <span class="hljs-comment">// ecx</span><br>  <span class="hljs-type">int</span> key_0; <span class="hljs-comment">// edi</span><br>  <span class="hljs-type">int</span> key_1; <span class="hljs-comment">// ebx</span><br>  __int64 key_3; <span class="hljs-comment">// r10</span><br>  <span class="hljs-type">int</span> key_2; <span class="hljs-comment">// r11d</span><br>  <span class="hljs-type">int</span> v18; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">bool</span> Count; <span class="hljs-comment">// zf</span><br>  __int64 flag_seven; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> flag_0; <span class="hljs-comment">// [rsp+0h] [rbp-58h]</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> flag_nine; <span class="hljs-comment">// [rsp+4h] [rbp-54h]</span><br>  <span class="hljs-type">int</span> count; <span class="hljs-comment">// [rsp+8h] [rbp-50h]</span><br>  <span class="hljs-type">int</span> delta_1; <span class="hljs-comment">// [rsp+68h] [rbp+10h]</span><br>  __int64 Key; <span class="hljs-comment">// [rsp+70h] [rbp+18h]</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> flag_8; <span class="hljs-comment">// [rsp+78h] [rbp+20h]</span><br><br>  Key = key;<br>  flag_9 = flag[<span class="hljs-number">9</span>];<br>  delta = <span class="hljs-number">0</span>;<br>  flag_eight = flag[<span class="hljs-number">8</span>];<br>  flag_1 = flag[<span class="hljs-number">1</span>];<br>  flag_2 = flag[<span class="hljs-number">2</span>];<br>  flag_3 = flag[<span class="hljs-number">3</span>];<br>  flag_4 = flag[<span class="hljs-number">4</span>];<br>  flag_5 = flag[<span class="hljs-number">5</span>];<br>  flag_6 = flag[<span class="hljs-number">6</span>];<br>  flag_o = *flag;<br>  flag_7 = flag[<span class="hljs-number">7</span>];<br>  flag_8 = flag_eight;<br>  flag_nine = flag_9;<br>  count = <span class="hljs-number">11</span>;<br>  <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>  &#123;<br>    delta_1 = delta - <span class="hljs-number">1640531527</span>;<br>    key_0 = *(key + <span class="hljs-number">4LL</span> * (((delta - <span class="hljs-number">1640531527</span>) &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">3</span>));<br>    flag_0 = flag_o<br>           + ((((<span class="hljs-number">16</span> * flag_9) ^ (flag_1 &gt;&gt; <span class="hljs-number">3</span>)) + ((flag_9 &gt;&gt; <span class="hljs-number">5</span>) ^ (<span class="hljs-number">4</span> * flag_1))) ^ (((delta - <span class="hljs-number">1640531527</span>) ^ flag_1)<br>                                                                                  + (key_0 ^ flag_9)));<br>    key_1 = *(Key + <span class="hljs-number">4</span> * (((delta - <span class="hljs-number">1640531527</span>) &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">3</span> ^ <span class="hljs-number">1LL</span>));<br>    flag_1 += ((flag_0 ^ key_1) + ((delta - <span class="hljs-number">1640531527</span>) ^ flag_2)) ^ (((<span class="hljs-number">16</span> * flag_0) ^ (flag_2 &gt;&gt; <span class="hljs-number">3</span>))<br>                                                                    + ((flag_0 &gt;&gt; <span class="hljs-number">5</span>) ^ (<span class="hljs-number">4</span> * flag_2)));<br>    key_3 = ((delta - <span class="hljs-number">1640531527</span>) &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">3</span> ^ <span class="hljs-number">3LL</span>;<br>    key_2 = *(Key + <span class="hljs-number">4</span> * (((delta - <span class="hljs-number">1640531527</span>) &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">3</span> ^ <span class="hljs-number">2LL</span>));<br>    flag_2 += ((flag_1 ^ key_2) + (delta_1 ^ flag_3)) ^ (((<span class="hljs-number">16</span> * flag_1) ^ (flag_3 &gt;&gt; <span class="hljs-number">3</span>)) + ((flag_1 &gt;&gt; <span class="hljs-number">5</span>) ^ (<span class="hljs-number">4</span> * flag_3)));<br>    flag_3 += ((delta_1 ^ flag_4) + (flag_2 ^ *(Key + <span class="hljs-number">4</span> * key_3))) ^ (((<span class="hljs-number">16</span> * flag_2) ^ (flag_4 &gt;&gt; <span class="hljs-number">3</span>))<br>                                                                    + ((flag_2 &gt;&gt; <span class="hljs-number">5</span>) ^ (<span class="hljs-number">4</span> * flag_4)));<br>    flag_4 += ((flag_3 ^ key_0) + (delta_1 ^ flag_5)) ^ (((<span class="hljs-number">16</span> * flag_3) ^ (flag_5 &gt;&gt; <span class="hljs-number">3</span>)) + ((flag_3 &gt;&gt; <span class="hljs-number">5</span>) ^ (<span class="hljs-number">4</span> * flag_5)));<br>    flag_5 += ((flag_4 ^ key_1) + (delta_1 ^ flag_6)) ^ (((<span class="hljs-number">16</span> * flag_4) ^ (flag_6 &gt;&gt; <span class="hljs-number">3</span>)) + ((flag_4 &gt;&gt; <span class="hljs-number">5</span>) ^ (<span class="hljs-number">4</span> * flag_6)));<br>    v18 = (flag_5 ^ key_2) + (delta_1 ^ flag_7);<br>    delta = delta_1;<br>    flag_6 += v18 ^ (((<span class="hljs-number">16</span> * flag_5) ^ (flag_7 &gt;&gt; <span class="hljs-number">3</span>)) + ((flag_5 &gt;&gt; <span class="hljs-number">5</span>) ^ (<span class="hljs-number">4</span> * flag_7)));<br>    flag_7 += ((flag_6 ^ *(Key + <span class="hljs-number">4</span> * key_3)) + (delta_1 ^ flag_8)) ^ (((<span class="hljs-number">16</span> * flag_6) ^ (flag_8 &gt;&gt; <span class="hljs-number">3</span>))<br>                                                                    + ((flag_6 &gt;&gt; <span class="hljs-number">5</span>) ^ (<span class="hljs-number">4</span> * flag_8)));<br>    flag_8 += ((flag_7 ^ key_0) + (delta_1 ^ flag_nine)) ^ (((<span class="hljs-number">16</span> * flag_7) ^ (flag_nine &gt;&gt; <span class="hljs-number">3</span>))<br>                                                          + ((flag_7 &gt;&gt; <span class="hljs-number">5</span>) ^ (<span class="hljs-number">4</span> * flag_nine)));<br>    flag_9 = (((flag_8 ^ key_1) + (delta_1 ^ flag_0)) ^ (((<span class="hljs-number">16</span> * flag_8) ^ (flag_0 &gt;&gt; <span class="hljs-number">3</span>)) + ((flag_8 &gt;&gt; <span class="hljs-number">5</span>) ^ (<span class="hljs-number">4</span> * flag_0))))<br>           + flag_nine;<br>    key = Key;<br>    Count = count-- == <span class="hljs-number">1</span>;<br>    flag_nine = flag_9;<br>    <span class="hljs-keyword">if</span> ( Count )<br>      <span class="hljs-keyword">break</span>;<br>    flag_o = flag_0;<br>  &#125;<br>  flag_seven = flag_7;<br>  flag[<span class="hljs-number">1</span>] = flag_1;<br>  flag[<span class="hljs-number">2</span>] = flag_2;<br>  flag[<span class="hljs-number">3</span>] = flag_3;<br>  flag[<span class="hljs-number">4</span>] = flag_4;<br>  flag[<span class="hljs-number">5</span>] = flag_5;<br>  flag[<span class="hljs-number">6</span>] = flag_6;<br>  flag[<span class="hljs-number">7</span>] = flag_7;<br>  flag[<span class="hljs-number">8</span>] = flag_8;<br>  flag[<span class="hljs-number">9</span>] = flag_9;<br>  *flag = flag_0;<br>  <span class="hljs-keyword">return</span> flag_seven;<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>ç”±äºåŠ å¯†ä¸»è¦ä¾èµ–çš„æ˜¯å¼‚æˆ–ï¼Œåªè¦å¤åŸå‡ºåŠ å¯†æ—¶çš„ç¯å¢ƒï¼ˆç›¸å…³å˜é‡ï¼‰ï¼Œå°±å¯ä»¥å†æ¬¡åŠ å¯†å®ç°å¤åŸã€‚ä¸‹å›¾æ˜¯AIç»™çš„åŠ å¯†é€»è¾‘åˆ†æã€‚é¦–å…ˆæ¯è½®åŠ å¯†çš„å¯†é’¥ä¸åŒï¼Œå…¶æ¬¡æ¯ä¸ªå­—ç¬¦å—çš„åŠ å¯†éƒ½ä¾èµ–å‰ä¸€å—å’Œåä¸€å—ã€‚çªç ´å£ï¼šå¯¹äºflag9è€Œè¨€ï¼Œå®ƒçš„å‰ä¸€å—å’Œåä¸€å—éƒ½æ˜¯ç»è¿‡æœ¬è½®åŠ å¯†çš„ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨æœ€åä¸€è½®ï¼Œflag9ä¾èµ–çš„æ˜¯æœ€ç»ˆå¯†æ–‡çš„flag0å’Œflag8ï¼Œå¯ä»¥åˆ©ç”¨æœ€ç»ˆå¯†æ–‡ç›´æ¥è§£å¯†ã€‚è§£å¯†å‡ºæœ€åä¸€è½®çš„æœªåŠ å¯†flag9åï¼Œå°±å¯ä»¥å¾€å›è§£å¯†flag8-flag0ï¼Œå°±è¿™æ ·11è½®è§£å¯†å›å»ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><code class="hljs plaintext">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<br>â”‚               ä¿®æ”¹ç‰ˆTEAåŠ å¯†ï¼ˆ10å—Feistelç»“æ„ï¼Œ11è½®ï¼‰                        â”‚<br>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<br><br>è¾“å…¥: flag[0]...flag[9] (10ä¸ª32ä½å­—), key[0]...key[3] (128ä½å¯†é’¥)<br><br>åˆå§‹åŒ–:<br>   delta = 0<br>   count = 11<br><br>å¼€å§‹å¾ªç¯ï¼ˆ11è½®ï¼‰:<br>   delta_1 = delta - 0x61C88647  (æ— ç¬¦å·å‡æ³•ï¼Œ1640531527çš„åå…­è¿›åˆ¶)<br><br>   å¯†é’¥è°ƒåº¦:<br>        k0 = key[(delta_1&gt;&gt;2) &amp; 3]<br>        k1 = key[((delta_1&gt;&gt;2) &amp; 3) ^ 1]<br>        k2 = key[((delta_1&gt;&gt;2) &amp; 3) ^ 2]<br>        k3 = key[((delta_1&gt;&gt;2) &amp; 3) ^ 3]<br><br>   åŠ å¯†é“¾ï¼ˆæ¯è½®æ›´æ–°æ‰€æœ‰10ä¸ªå­—ï¼Œé¡ºåºä¾èµ–ï¼‰:<br>        flag0 += F(flag9, flag1, delta_1, k0)<br>        flag1 += F(flag0, flag2, delta_1, k1)<br>        flag2 += F(flag1, flag3, delta_1, k2)<br>        flag3 += F(flag2, flag4, delta_1, k3)<br>        flag4 += F(flag3, flag5, delta_1, k0)<br>        flag5 += F(flag4, flag6, delta_1, k1)<br>        flag6 += F(flag5, flag7, delta_1, k2)<br>        flag7 += F(flag6, flag8, delta_1, k3)<br>        flag8 += F(flag7, flag9, delta_1, k0)<br>        flag9 += F(flag8, flag0, delta_1, k1)<br><br>   å…¶ä¸­ F(a, b, delta, k) = <br>        ((16*a) ^ (b&gt;&gt;3)) + ((a&gt;&gt;5) ^ (4*b))) ^ ( (delta ^ b) + (k ^ a) )<br><br>   æ›´æ–°delta = delta_1<br><br>å¾ªç¯ç»“æŸï¼ˆcountå‡è‡³1ï¼‰<br><br>è¾“å‡º: åŠ å¯†åçš„flag[0]...flag[9]<br></code></pre></td></tr></table></figure>
</li>
<li><p>è§£å¯†è„šæœ¬ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">modefiedTea_decrypt</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span>* flag, <span class="hljs-type">uint32_t</span>* key)</span> </span>&#123;<br>    <span class="hljs-type">int32_t</span> deltas[<span class="hljs-number">11</span>];<br>    <span class="hljs-type">int32_t</span> delta = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">11</span>; i++) &#123;<br>        delta -= <span class="hljs-number">1640531527</span>; <br>        deltas[i] = delta;<br>    &#125;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> round = <span class="hljs-number">10</span>; round &gt;= <span class="hljs-number">0</span>; round--) &#123;<br>        <span class="hljs-type">uint32_t</span> delta_1 = deltas[round];<br><br>        <span class="hljs-type">uint32_t</span> k0 = key[((delta_1 &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">3</span>)];<br>        <span class="hljs-type">uint32_t</span> k1 = key[((delta_1 &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">3</span>) ^ <span class="hljs-number">1</span>];<br>        <span class="hljs-type">uint32_t</span> k2 = key[((delta_1 &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">3</span>) ^ <span class="hljs-number">2</span>];<br>        <span class="hljs-type">uint32_t</span> k3 = key[((delta_1 &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">3</span>) ^ <span class="hljs-number">3</span>];<br><br>        flag[<span class="hljs-number">9</span>] -= ((flag[<span class="hljs-number">8</span>] ^ k1) + (delta_1 ^ flag[<span class="hljs-number">0</span>])) ^ (((<span class="hljs-number">16</span> * flag[<span class="hljs-number">8</span>]) ^ (flag[<span class="hljs-number">0</span>] &gt;&gt; <span class="hljs-number">3</span>)) + ((flag[<span class="hljs-number">8</span>] &gt;&gt; <span class="hljs-number">5</span>) ^ (<span class="hljs-number">4</span> * flag[<span class="hljs-number">0</span>])));<br>        flag[<span class="hljs-number">8</span>] -= ((flag[<span class="hljs-number">7</span>] ^ k0) + (delta_1 ^ flag[<span class="hljs-number">9</span>])) ^ (((<span class="hljs-number">16</span> * flag[<span class="hljs-number">7</span>]) ^ (flag[<span class="hljs-number">9</span>] &gt;&gt; <span class="hljs-number">3</span>)) + ((flag[<span class="hljs-number">7</span>] &gt;&gt; <span class="hljs-number">5</span>) ^ (<span class="hljs-number">4</span> * flag[<span class="hljs-number">9</span>])));<br>        flag[<span class="hljs-number">7</span>] -= ((flag[<span class="hljs-number">6</span>] ^ k3) + (delta_1 ^ flag[<span class="hljs-number">8</span>])) ^ (((<span class="hljs-number">16</span> * flag[<span class="hljs-number">6</span>]) ^ (flag[<span class="hljs-number">8</span>] &gt;&gt; <span class="hljs-number">3</span>)) + ((flag[<span class="hljs-number">6</span>] &gt;&gt; <span class="hljs-number">5</span>) ^ (<span class="hljs-number">4</span> * flag[<span class="hljs-number">8</span>])));<br>        flag[<span class="hljs-number">6</span>] -= ((flag[<span class="hljs-number">5</span>] ^ k2) + (delta_1 ^ flag[<span class="hljs-number">7</span>])) ^ (((<span class="hljs-number">16</span> * flag[<span class="hljs-number">5</span>]) ^ (flag[<span class="hljs-number">7</span>] &gt;&gt; <span class="hljs-number">3</span>)) + ((flag[<span class="hljs-number">5</span>] &gt;&gt; <span class="hljs-number">5</span>) ^ (<span class="hljs-number">4</span> * flag[<span class="hljs-number">7</span>])));<br>        flag[<span class="hljs-number">5</span>] -= ((flag[<span class="hljs-number">4</span>] ^ k1) + (delta_1 ^ flag[<span class="hljs-number">6</span>])) ^ (((<span class="hljs-number">16</span> * flag[<span class="hljs-number">4</span>]) ^ (flag[<span class="hljs-number">6</span>] &gt;&gt; <span class="hljs-number">3</span>)) + ((flag[<span class="hljs-number">4</span>] &gt;&gt; <span class="hljs-number">5</span>) ^ (<span class="hljs-number">4</span> * flag[<span class="hljs-number">6</span>])));<br>        flag[<span class="hljs-number">4</span>] -= ((flag[<span class="hljs-number">3</span>] ^ k0) + (delta_1 ^ flag[<span class="hljs-number">5</span>])) ^ (((<span class="hljs-number">16</span> * flag[<span class="hljs-number">3</span>]) ^ (flag[<span class="hljs-number">5</span>] &gt;&gt; <span class="hljs-number">3</span>)) + ((flag[<span class="hljs-number">3</span>] &gt;&gt; <span class="hljs-number">5</span>) ^ (<span class="hljs-number">4</span> * flag[<span class="hljs-number">5</span>])));<br>        flag[<span class="hljs-number">3</span>] -= ((flag[<span class="hljs-number">2</span>] ^ k3) + (delta_1 ^ flag[<span class="hljs-number">4</span>])) ^ (((<span class="hljs-number">16</span> * flag[<span class="hljs-number">2</span>]) ^ (flag[<span class="hljs-number">4</span>] &gt;&gt; <span class="hljs-number">3</span>)) + ((flag[<span class="hljs-number">2</span>] &gt;&gt; <span class="hljs-number">5</span>) ^ (<span class="hljs-number">4</span> * flag[<span class="hljs-number">4</span>])));<br>        flag[<span class="hljs-number">2</span>] -= ((flag[<span class="hljs-number">1</span>] ^ k2) + (delta_1 ^ flag[<span class="hljs-number">3</span>])) ^ (((<span class="hljs-number">16</span> * flag[<span class="hljs-number">1</span>]) ^ (flag[<span class="hljs-number">3</span>] &gt;&gt; <span class="hljs-number">3</span>)) + ((flag[<span class="hljs-number">1</span>] &gt;&gt; <span class="hljs-number">5</span>) ^ (<span class="hljs-number">4</span> * flag[<span class="hljs-number">3</span>])));<br>        flag[<span class="hljs-number">1</span>] -= ((flag[<span class="hljs-number">0</span>] ^ k1) + (delta_1 ^ flag[<span class="hljs-number">2</span>])) ^ (((<span class="hljs-number">16</span> * flag[<span class="hljs-number">0</span>]) ^ (flag[<span class="hljs-number">2</span>] &gt;&gt; <span class="hljs-number">3</span>)) + ((flag[<span class="hljs-number">0</span>] &gt;&gt; <span class="hljs-number">5</span>) ^ (<span class="hljs-number">4</span> * flag[<span class="hljs-number">2</span>])));<br>        flag[<span class="hljs-number">0</span>] -= ((flag[<span class="hljs-number">9</span>] ^ k0) + (delta_1 ^ flag[<span class="hljs-number">1</span>])) ^ (((<span class="hljs-number">16</span> * flag[<span class="hljs-number">9</span>]) ^ (flag[<span class="hljs-number">1</span>] &gt;&gt; <span class="hljs-number">3</span>)) + ((flag[<span class="hljs-number">9</span>] &gt;&gt; <span class="hljs-number">5</span>) ^ (<span class="hljs-number">4</span> * flag[<span class="hljs-number">1</span>])));<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-type">uint32_t</span> enc[<span class="hljs-number">10</span>] = &#123;<br>        <span class="hljs-number">0x5D624C34</span>, <span class="hljs-number">0x8629FEAD</span>, <span class="hljs-number">0x9D11379B</span>, <span class="hljs-number">0xFCD53211</span>,<br>        <span class="hljs-number">0x460F63CE</span>, <span class="hljs-number">0xC5816E68</span>, <span class="hljs-number">0xFE5300AD</span>, <span class="hljs-number">0x0A0015EE</span>,<br>        <span class="hljs-number">0x9806DBBB</span>, <span class="hljs-number">0xEF4A2648</span><br>    &#125;;<br>    <span class="hljs-type">uint32_t</span> key[<span class="hljs-number">4</span>] = &#123;<br>        <span class="hljs-number">0x63656F6D</span>, <span class="hljs-number">0x21216674</span>, <span class="hljs-number">0x12345678</span>, <span class="hljs-number">0x9ABCDEF0</span><br>    &#125;;<br><br>    <span class="hljs-built_in">modefiedTea_decrypt</span>(enc, key);<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>* flag_str = (<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>*)enc;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">40</span>; i++) &#123;<br>        <span class="hljs-keyword">if</span> (flag_str[i] &gt;= <span class="hljs-number">32</span> &amp;&amp; flag_str[i] &lt;= <span class="hljs-number">126</span>) &#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, flag_str[i]);<br>        &#125;<br>        <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\\x%02X&quot;</span>, flag_str[i]);<br>        &#125;<br>    &#125;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n&quot;</span>);<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h2 id="week3"><a href="#week3" class="headerlink" title="week3"></a>week3</h2><h3 id="have-fun"><a href="#have-fun" class="headerlink" title="have_fun"></a>have_fun</h3><ul>
<li><p>é™„ä»¶æ˜¯ä¸€ä¸ªWindows GUIç¨‹åºï¼Œç•Œé¢å¦‚å›¾ã€‚å·¥å…·æ çš„â€œäº¤äº’â€å®ç°flagçš„éªŒè¯ã€‚</p>
<p><img src="/../images/image-20250828184625164-1760193218429-35.png" alt="ç•Œé¢"></p>
</li>
<li><p>mainå‡½æ•°ä¸»è¦å®ç°çš„æ˜¯åˆ›å»ºçª—å£ï¼Œæ¶‰åŠåˆ°WNDCLASSEXWç»“æ„ä½“ï¼ˆè¯¦ç»†ä¿¡æ¯è§ï¼š<a href="https://learn.microsoft.com/zh-cn/windows/win32/api/winuser/ns-winuser-wndclassexw">WNDCLASSEXW ï¼ˆwinuser.hï¼‰ - Win32 apps | Microsoft Learn</a>ï¼‰ã€‚å…¶ä¸­ï¼Œç»“æ„ä½“å˜é‡lpfnWndProcæ¶‰åŠçª—å£è¿‡ç¨‹çš„å®ç°ï¼Œæ‰€ä»¥flagéªŒè¯çš„ç›¸å…³é€»è¾‘åœ¨lpfnWndProcæŒ‡å‘çš„å‡½æ•°ä¸­æŸ¥çœ‹ï¼ˆå›¾ä¸­é‡å‘½åä¸ºToolBarï¼‰</p>
<p><img src="/../images/image-20250828184701147-1760193218429-32.png" alt="mainå‡½æ•°"></p>
</li>
<li><p>ToolBarä¸­ï¼Œå®ç°äº†å·¥å…·æ ä¸‰ä¸ªé€‰é¡¹çš„äº¤äº’é€»è¾‘ï¼Œå…¶ä¸­ï¼ŒDialogBoxParamWå®ç°çš„æ˜¯â€äº¤äº’â€œé€‰é¡¹ï¼ˆå› ä¸ºå‚æ•°DialogFuncçœ‹ç€æœ€å¤æ‚ï¼Œæœ€åƒflagéªŒè¯é€»è¾‘ï¼‰</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-comment">//ToolBarå‡½æ•°</span><br>LRESULT __fastcall <span class="hljs-title function_">ToolBar</span><span class="hljs-params">(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam)</span><br>&#123;<br>  HDC hdc; <span class="hljs-comment">// rsi</span><br>  HFONT FontW; <span class="hljs-comment">// rdi</span><br>  HGDIOBJ h; <span class="hljs-comment">// rbx</span><br>  tagPAINTSTRUCT Paint; <span class="hljs-comment">// [rsp+70h] [rbp-88h] BYREF</span><br><br>  <span class="hljs-keyword">switch</span> ( Msg )<br>  &#123;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">2u</span>:<br>      PostQuitMessage(<span class="hljs-number">0</span>);<br>      <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">0xFu</span>:<br>      hdc = BeginPaint(hWnd, &amp;Paint);<br>      SetTextColor(hdc, <span class="hljs-number">0xFFu</span>);<br>      SetBkMode(hdc, <span class="hljs-number">1</span>);<br>      FontW = CreateFontW(<span class="hljs-number">36</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">700</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1u</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0x20u</span>, &amp;pszFaceName);<br>      h = SelectObject(hdc, FontW);<br>      TextOutW(hdc, <span class="hljs-number">500</span>, <span class="hljs-number">160</span>, &amp;String, <span class="hljs-number">15</span>);<br>      TextOutW(hdc, <span class="hljs-number">500</span>, <span class="hljs-number">200</span>, &amp;word_7FF6D7EA3350, <span class="hljs-number">10</span>);<br>      SelectObject(hdc, h);<br>      DeleteObject(FontW);<br>      EndPaint(hWnd, &amp;Paint);<br>      <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">0x111u</span>:<br>      <span class="hljs-keyword">switch</span> ( wParam )<br>      &#123;<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">0x68u</span>:<br>          DialogBoxParamW(hInstance, <span class="hljs-number">0x67</span>, hWnd, sub_7FF6D7EA1420, <span class="hljs-number">0LL</span>);<br>          <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">0x69u</span>:<br>          DestroyWindow(hWnd);<br>          <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">0x9C42u</span>:<br>          DialogBoxParamW(hInstance, <span class="hljs-number">0x66</span>, hWnd, DialogFunc, <span class="hljs-number">0LL</span>);<span class="hljs-comment">//â€œäº¤äº’â€é€‰é¡¹</span><br>          <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">default</span>:<br>          <span class="hljs-keyword">return</span> DefWindowProcW(hWnd, Msg, wParam, lParam);<br>      &#125;<br>      <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">default</span>:<br>      <span class="hljs-keyword">return</span> DefWindowProcW(hWnd, Msg, wParam, lParam);<br>  &#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>DialogFuncå‡½æ•°ï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c">INT_PTR __fastcall <span class="hljs-title function_">DialogFunc</span><span class="hljs-params">(HWND hDlg, <span class="hljs-type">int</span> a2, <span class="hljs-type">unsigned</span> __int16 n1003)</span><br>&#123;<br>  HWND hDlg_1; <span class="hljs-comment">// rbx</span><br>  <span class="hljs-type">int</span> v4; <span class="hljs-comment">// edx</span><br>  __int64 length; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">int</span> n32_2; <span class="hljs-comment">// r8d</span><br>  __m128 si128; <span class="hljs-comment">// xmm2</span><br>  __int64 v8; <span class="hljs-comment">// rdx</span><br>  <span class="hljs-type">unsigned</span> __int64 v9; <span class="hljs-comment">// rcx</span><br>  __m128 v10; <span class="hljs-comment">// xmm0</span><br>  __m128 v11; <span class="hljs-comment">// xmm1</span><br>  __m128 v12; <span class="hljs-comment">// xmm0</span><br>  __m128 v13; <span class="hljs-comment">// xmm1</span><br>  __int64 count; <span class="hljs-comment">// rdx</span><br>  <span class="hljs-type">unsigned</span> __int16 *currentChar; <span class="hljs-comment">// rdx</span><br>  <span class="hljs-type">int</span> currentEnc; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> judgeNumber; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">const</span> WCHAR *PrintText; <span class="hljs-comment">// r8</span><br>  _OWORD v20[<span class="hljs-number">2</span>]; <span class="hljs-comment">// [rsp+0h] [rbp-1D8h] BYREF</span><br>  WCHAR flag[<span class="hljs-number">8</span>]; <span class="hljs-comment">// [rsp+20h] [rbp-1B8h] BYREF</span><br>  _OWORD v22[<span class="hljs-number">12</span>]; <span class="hljs-comment">// [rsp+30h] [rbp-1A8h] BYREF</span><br>  _WORD flag_xored[<span class="hljs-number">104</span>]; <span class="hljs-comment">// [rsp+F0h] [rbp-E8h] BYREF</span><br><br>  hDlg_1 = hDlg;<br>  v4 = a2 - <span class="hljs-number">272</span>;<br>  <span class="hljs-keyword">if</span> ( !v4 )<br>  &#123;<br>    PrintText = &amp;word_7FF6D7EA3368;<br>LABEL_22:<br>    SetDlgItemTextW(hDlg, <span class="hljs-number">1002</span>, PrintText);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">1LL</span>;<br>  &#125;<br>  <span class="hljs-keyword">if</span> ( v4 != <span class="hljs-number">1</span> )<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>  <span class="hljs-keyword">if</span> ( (n1003 - <span class="hljs-number">1</span>) &gt; <span class="hljs-number">1u</span> )<br>  &#123;<br>    <span class="hljs-keyword">if</span> ( n1003 == <span class="hljs-number">1003</span> )<br>    &#123;<br>      GetDlgItemTextW(hDlg, <span class="hljs-number">1001</span>, flag, <span class="hljs-number">100</span>);<br>      length = <span class="hljs-number">-1LL</span>;<br>      <span class="hljs-keyword">do</span><br>        ++length;<br>      <span class="hljs-keyword">while</span> ( flag[length] );<br>      n32_2 = <span class="hljs-number">0</span>;<br>      <span class="hljs-keyword">if</span> ( length &gt;= <span class="hljs-number">32</span> )<span class="hljs-comment">// flagé•¿åº¦å¤§äº32çš„æƒ…å†µï¼ˆå®é™…ä¸Šä¸èƒ½æ˜¯è¿™ç§æƒ…å†µï¼‰</span><br>      &#123;<br>        si128 = _mm_load_si128(&amp;xmmword_7FF6D7EA33F0);<br>        v8 = <span class="hljs-number">0LL</span>;<br>        v9 = <span class="hljs-number">0LL</span>;<br>        <span class="hljs-keyword">do</span><br>        &#123;<br>          v10 = _mm_loadu_si128(&amp;flag[v9 / <span class="hljs-number">2</span>]);<br>          n32_2 += <span class="hljs-number">32</span>;<br>          v8 += <span class="hljs-number">32LL</span>;<br>          v11 = _mm_loadu_si128(&amp;v22[v9 / <span class="hljs-number">0x10</span>]);<br>          v9 += <span class="hljs-number">64LL</span>;<br>          v22[v9 / <span class="hljs-number">0x10</span> + <span class="hljs-number">8</span>] = _mm_xor_ps(v10, si128);<br>          v12 = _mm_loadu_si128(&amp;v20[v9 / <span class="hljs-number">0x10</span>]);<br>          v22[v9 / <span class="hljs-number">0x10</span> + <span class="hljs-number">9</span>] = _mm_xor_ps(v11, si128);<br>          v13 = _mm_loadu_si128(&amp;v20[v9 / <span class="hljs-number">0x10</span> + <span class="hljs-number">1</span>]);<br>          v22[v9 / <span class="hljs-number">0x10</span> + <span class="hljs-number">10</span>] = _mm_xor_ps(v12, si128);<br>          v22[v9 / <span class="hljs-number">0x10</span> + <span class="hljs-number">11</span>] = _mm_xor_ps(v13, si128);<br>        &#125;<br>        <span class="hljs-keyword">while</span> ( v8 &lt; (length - (length &amp; <span class="hljs-number">31</span>)) );<br>      &#125;<br>      count = n32_2;<span class="hljs-comment">// ä¸Šè¿°æƒ…å†µåº”ä¸æˆç«‹ï¼Œå› æ­¤n32_2ä¸º0</span><br>      <span class="hljs-keyword">if</span> ( n32_2 &lt; length )<br>      &#123;<br>        <span class="hljs-keyword">do</span><br>        &#123;<br>          flag_xored[count] = flag[count] ^ <span class="hljs-number">0x2A</span>;<br>          ++count;<br>        &#125;<br>        <span class="hljs-keyword">while</span> ( count &lt; length );<br>      &#125;<br>      flag_xored[length] = <span class="hljs-number">0</span>;<br>      currentChar = flag_xored;<br>      <span class="hljs-keyword">do</span><br>      &#123;<br>        currentEnc = *(currentChar + &amp;enc - flag_xored);<span class="hljs-comment">// enc[currentChar-flag_xored]</span><br>        judgeNumber = *currentChar - currentEnc;<br>        <span class="hljs-keyword">if</span> ( judgeNumber )<br>          <span class="hljs-keyword">break</span>;<br>        ++currentChar;<br>      &#125;<br>      <span class="hljs-keyword">while</span> ( currentEnc );<br>      <span class="hljs-keyword">if</span> ( judgeNumber || (PrintText = &amp;right, length != <span class="hljs-number">16</span>) )<span class="hljs-comment">// flagé•¿åº¦ç”±æ­¤å¤„å¾—å‡º</span><br>        PrintText = &amp;wrong;<br>      hDlg = hDlg_1;<br>      <span class="hljs-keyword">goto</span> LABEL_22;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>  &#125;<br>  EndDialog(hDlg, n1003);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">1LL</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>é€»è¾‘å¾ˆæ˜æ˜¾ï¼Œéå†flagï¼Œæ¯ä¸ªå­—ç¬¦å¼‚æˆ–0x2Aï¼Œç„¶åå’Œencæ¯”è¾ƒã€‚è§£å¯†è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">enc = [<br>    <span class="hljs-number">0x0047</span>, <span class="hljs-number">0x0045</span>, <span class="hljs-number">0x004F</span>, <span class="hljs-number">0x0049</span>, <span class="hljs-number">0x005E</span>, <span class="hljs-number">0x004C</span>, <span class="hljs-number">0x0051</span>, <span class="hljs-number">0x0062</span>, <span class="hljs-number">0x006A</span>, <span class="hljs-number">0x005C</span>, <span class="hljs-number">0x001E</span>, <span class="hljs-number">0x0075</span>, <span class="hljs-number">0x004C</span>, <span class="hljs-number">0x007F</span>, <span class="hljs-number">0x0044</span>, <span class="hljs-number">0x0057</span><br>]<br>flag = <span class="hljs-string">&#x27;&#x27;</span>.join(<span class="hljs-built_in">chr</span>(b ^ <span class="hljs-number">0x2A</span>) <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> enc)<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure></li>
</ul>
<h3 id="guess"><a href="#guess" class="headerlink" title="guess"></a>guess</h3><ul>
<li><p>é™„ä»¶ç¨‹åºæ˜¯ä¸€ä¸ªçŒœæ•°å­—æ¸¸æˆï¼Œç”¨IDAæ‰“å¼€ï¼Œé€šè¿‡å­—ç¬¦ä¸²è¡¨çš„å…³é”®æ•°æ®â€You are right!\nâ€å¯ä»¥å¿«é€Ÿå®šä½åˆ°mainå‡½æ•°çš„ä½ç½®</p>
<p><img src="/../images/image-20250907190954175-1760193218429-33.png" alt="å…³é”®æ•°æ®"></p>
</li>
<li><p>mainå‡½æ•°F5åç¼–è¯‘ä¸äº†ï¼Œsp valueæŠ¥é”™ï¼Œè¯´æ˜æœ‰èŠ±æŒ‡ä»¤ã€‚æŠŠæ ˆæŒ‡é’ˆå‹¾é€‰ä¸Šï¼Œä¼šå‘ç°æ ˆå¸§çªå˜çš„ä½ç½®ï¼š</p>
<p><img src="/../images/image-20250907191116300-1760193218429-36.png" alt="æ ˆå¸§çªå˜"></p>
<p>æ ˆå¸§æ”¹å˜å¤ªå¤šï¼Œæ˜æ˜¾ä¸å¯¹ï¼ŒæŠŠsub rsp, raxç»™nopæ‰ã€‚ç„¶åå¯ä»¥å‘ç°å‡½æ•°æœ«å°¾æ ˆå¸§ä¼šæœ‰ç‚¹é—®é¢˜ï¼š</p>
<p><img src="/../images/image-20250907191353142-1760193218429-37.png" alt="å‡½æ•°æœ«å°¾æ ˆå¸§"></p>
<p>æŠŠadd rsp, 1428hä¹Ÿç»™nopæ‰ï¼Œè¿™æ ·mainå‡½æ•°åŸºæœ¬ä¸Šå¯ä»¥åç¼–è¯‘äº†</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><code class="hljs c++"><span class="hljs-comment">//ä¼˜åŒ–åçš„mainå‡½æ•°</span><br><span class="hljs-comment">// bad sp value at call has been detected, the output may be wrong!</span><br><span class="hljs-function"><span class="hljs-type">int</span> __fastcall <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **argv, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **envp)</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-type">bool</span> v3; <span class="hljs-comment">// dl</span><br>  std::ostream *v4; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v5; <span class="hljs-comment">// eax</span><br>  _QWORD *v6; <span class="hljs-comment">// rax</span><br>  std::ostream *v8; <span class="hljs-comment">// rax</span><br>  __int64 v9; <span class="hljs-comment">// rax</span><br>  __int64 v10; <span class="hljs-comment">// rbx</span><br>  std::ostream *v11; <span class="hljs-comment">// rax</span><br>  std::ostream *v12; <span class="hljs-comment">// rax</span><br>  std::ostream *v13; <span class="hljs-comment">// rax</span><br>  std::ostream *v14; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> n0x64; <span class="hljs-comment">// [rsp+2Ch] [rbp-54h]</span><br>  _BYTE v17[<span class="hljs-number">2512</span>]; <span class="hljs-comment">// [rsp+30h] [rbp-50h] BYREF</span><br>  _BYTE v18[<span class="hljs-number">2512</span>]; <span class="hljs-comment">// [rsp+A00h] [rbp+980h] BYREF</span><br>  _BYTE v19[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [rsp+13D0h] [rbp+1350h] BYREF</span><br>  _BYTE v20[<span class="hljs-number">40</span>]; <span class="hljs-comment">// [rsp+13F0h] [rbp+1370h] BYREF</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> n0x64_1; <span class="hljs-comment">// [rsp+1418h] [rbp+1398h]</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [rsp+141Ch] [rbp+139Ch]</span><br><br>  _main(argc, argv, envp);<br>  std::ios_base::<span class="hljs-built_in">sync_with_stdio</span>(<span class="hljs-number">0LL</span>, v3);<br>  std::ios::<span class="hljs-built_in">tie</span>((<span class="hljs-type">char</span> *)in + <span class="hljs-number">16</span>, <span class="hljs-number">0LL</span>);<br>  <span class="hljs-built_in">cout</span>(out, <span class="hljs-string">&quot;Welcome to MoeCTF 2025!\n&quot;</span>);<br>  <span class="hljs-built_in">cout</span>(out, <span class="hljs-string">&quot;Let&#x27;s play a game!\n&quot;</span>);<br>  <span class="hljs-built_in">cout</span>(out, <span class="hljs-string">&quot;I have a secret number between 0 and 99, and you can guess it 10 times.\n&quot;</span>);<br>  v4 = (std::ostream *)<span class="hljs-built_in">cout</span>(out, <span class="hljs-string">&quot;If you successly guessed it, I will give you the flag!&quot;</span>);<br>  <span class="hljs-built_in">endl</span>(v4);<br>  <span class="hljs-built_in">random_device</span>((std::random_device *)v18);<br>  v5 = <span class="hljs-built_in">random_operator</span>(v18);<br>  <span class="hljs-built_in">mersenne_twister_engine</span>(v17, v5);<br>  std::random_device::~<span class="hljs-built_in">random_device</span>((std::random_device *)v18);<br>  n0x64_1 = (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)<span class="hljs-built_in">mersenne_twister_engine_operator</span>(v17) % <span class="hljs-number">0x64</span>;<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">9</span>; ++i )<br>  &#123;<br>    <span class="hljs-built_in">cout</span>(out, <span class="hljs-string">&quot;Please input your number: &quot;</span>);<br>    std::ostream::<span class="hljs-built_in">flush</span>(out);<br>    v6 = (_QWORD *)<span class="hljs-built_in">cin</span>(in);<br>    <span class="hljs-keyword">if</span> ( (<span class="hljs-type">unsigned</span> __int8)std::ios::<span class="hljs-keyword">operator</span>!((<span class="hljs-type">char</span> *)v6 + *(_QWORD *)(*v6 - <span class="hljs-number">24LL</span>)) || n0x64 &gt;= <span class="hljs-number">0x64</span> )<br>    &#123;<br>      v8 = (std::ostream *)<span class="hljs-built_in">cout</span>(out, <span class="hljs-string">&quot;Invalid input&quot;</span>);<br>      <span class="hljs-built_in">endl</span>(v8);<br>      std::ios::<span class="hljs-built_in">clear</span>((<span class="hljs-type">char</span> *)in + <span class="hljs-number">16</span>, <span class="hljs-number">0LL</span>);<br>      v9 = std::numeric_limits&lt;<span class="hljs-type">long</span> <span class="hljs-type">long</span>&gt;::<span class="hljs-built_in">max</span>();<br>      std::istream::<span class="hljs-built_in">ignore</span>(in, v9, <span class="hljs-number">10</span>);<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>      <span class="hljs-keyword">if</span> ( n0x64_1 == n0x64 )<br>      &#123;<br>        <span class="hljs-built_in">cout</span>(out, <span class="hljs-string">&quot;You are right!\n&quot;</span>);<br>        v10 = <span class="hljs-built_in">cout</span>(out, <span class="hljs-string">&quot;The flag is moectf&#123;&quot;</span>);<br>        <span class="hljs-built_in">hex_to_binary</span>(v20, &amp;enc[abi:cxx11]);<br>        <span class="hljs-built_in">rc4_decrypt</span>(v19, v20, &amp;key[abi:cxx11]);<br>        v11 = (std::ostream *)std::<span class="hljs-keyword">operator</span>&lt;&lt;&lt;<span class="hljs-type">char</span>&gt;(v10, v19);<br>        v12 = (std::ostream *)<span class="hljs-built_in">cout</span>(v11, <span class="hljs-string">&quot;&#125;.&quot;</span>);<br>        <span class="hljs-built_in">endl</span>(v12);<br>        std::string::~<span class="hljs-built_in">string</span>(v19);<br>        std::string::~<span class="hljs-built_in">string</span>(v20);<br>        <span class="hljs-keyword">break</span>;<br>      &#125;<br>      v13 = (std::ostream *)<span class="hljs-built_in">cout</span>(out, <span class="hljs-string">&quot;That&#x27;s not right...&quot;</span>);<br>      <span class="hljs-built_in">endl</span>(v13);<br>    &#125;<br>  &#125;<br>  v14 = (std::ostream *)<span class="hljs-built_in">cout</span>(out, <span class="hljs-string">&quot;Thanks for your playing!&quot;</span>);<br>  <span class="hljs-built_in">endl</span>(v14);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>å¯ä»¥çœ‹å‡ºï¼Œmainå‡½æ•°çš„é€»è¾‘æ˜¯å…ˆè·å–ä¸€ä¸ªæ•°å­—è¾“å…¥ï¼Œç„¶åç»è¿‡å’Œéšæœºæ•°æœ‰å…³çš„å„ç§æ“ä½œæ¥åˆ¤æ–­æ˜¯å¦ç¬¦åˆæ¡ä»¶ï¼Œç¬¦åˆæ¡ä»¶å°±è¾“å‡ºflagã€‚æ—¢ç„¶å¯ä»¥ç›´æ¥è¾“å‡ºflagï¼Œä¸å¦¨å°±åŠ¨è°ƒæ”¹å˜åˆ¤æ–­ç»“æœç›´æ¥å¾—åˆ°flagã€‚æ‰¾åˆ°å’Œè¾“å‡ºæœ‰å…³çš„åˆ¤æ–­é€»è¾‘çš„ä½ç½®ï¼š</p>
<p><img src="/../images/image-20250907193423247-1760193218429-39.png" alt="è·³è½¬çš„å…³é”®é€»è¾‘"></p>
<p>åŠ¨è°ƒç¨‹åºæ­¥è¿‡æ­¤å¤„åï¼Œæ”¹ä¸€ä¸‹ZFå³å¯è®©ç¨‹åºè·³åˆ°â€You are right!\nâ€å¤„è·å¾—flagè¾“å‡ºã€‚å¥½åœ¨æœ¬é¢˜æ²¡æœ‰ç»™åŠ¨è°ƒæŒ–å‘ï¼Œå¯ä»¥ç›´æ¥å¾—åˆ°flagï¼š</p>
<p><img src="/../images/image-20250907193656681-1760193218429-40.png" alt="å¾—åˆ°flag"></p>
</li>
</ul>
<h3 id="rusty-sudoku"><a href="#rusty-sudoku" class="headerlink" title="rusty_sudoku"></a>rusty_sudoku</h3><ul>
<li><p>rustè¯­è¨€çš„æ•°ç‹¬æ¸¸æˆã€‚è¿è¡Œé™„ä»¶ç¨‹åºï¼Œæç¤ºé€†å‘åˆ†æç¨‹åºæ‰¾åˆ°æ•°ç‹¬å¹¶æ±‚è§£ã€‚ç”¨IDAæ‰“å¼€ï¼Œç»“åˆAIè¾…åŠ©ä¼˜åŒ–åmainå‡½æ•°é•¿è¿™æ ·ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><code class="hljs c++"><span class="hljs-function">__int64 __fastcall <span class="hljs-title">rusty_sudoku::main</span><span class="hljs-params">(__int64 a1, __int64 a2, __int64 a3)</span></span><br><span class="hljs-function"></span>&#123;<br>  __int128 *md5_ctx_prt; <span class="hljs-comment">// rdi</span><br>  __int64 temp; <span class="hljs-comment">// rdx</span><br>  <span class="hljs-type">size_t</span> cupy_size; <span class="hljs-comment">// rdx</span><br>  <span class="hljs-type">unsigned</span> __int8 *input_end; <span class="hljs-comment">// rcx</span><br>  <span class="hljs-type">unsigned</span> __int8 *trimmed_length; <span class="hljs-comment">// rsi</span><br>  <span class="hljs-type">unsigned</span> __int8 *trimmed_start; <span class="hljs-comment">// r9</span><br>  <span class="hljs-type">unsigned</span> __int8 *input_ptr; <span class="hljs-comment">// r8</span><br>  <span class="hljs-type">char</span> is_whitespace; <span class="hljs-comment">// r11</span><br>  <span class="hljs-type">unsigned</span> __int8 *current_ptr; <span class="hljs-comment">// rbx</span><br>  <span class="hljs-type">unsigned</span> __int8 *trimmed_count; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> codepoint; <span class="hljs-comment">// r11d</span><br>  <span class="hljs-type">int</span> v14; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> temp_val1; <span class="hljs-comment">// r14d</span><br>  <span class="hljs-type">int</span> temp_val2; <span class="hljs-comment">// ebp</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> high_byte; <span class="hljs-comment">// ebx</span><br>  __int64 alloc_result; <span class="hljs-comment">// rbx</span><br>  <span class="hljs-type">char</span> is_whitespace2; <span class="hljs-comment">// bl</span><br>  <span class="hljs-type">unsigned</span> __int8 *end_ptr; <span class="hljs-comment">// r11</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> codepoint2; <span class="hljs-comment">// esi</span><br>  <span class="hljs-type">char</span> byte1; <span class="hljs-comment">// bl</span><br>  <span class="hljs-type">char</span> byte2; <span class="hljs-comment">// bp</span><br>  <span class="hljs-type">int</span> temp_val3; <span class="hljs-comment">// ebp</span><br>  <span class="hljs-type">int</span> temp_val4; <span class="hljs-comment">// ebx</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> high_byte2; <span class="hljs-comment">// ebx</span><br>  <span class="hljs-type">size_t</span> actual_size; <span class="hljs-comment">// r15</span><br>  __int64 alloc_size; <span class="hljs-comment">// r14</span><br>  __int64 allocated_mem; <span class="hljs-comment">// rax</span><br>  __int64 expected_char; <span class="hljs-comment">// r9</span><br>  __int64 input_data; <span class="hljs-comment">// rdx</span><br>  __int64 index; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">int</span> user_char; <span class="hljs-comment">// ecx</span><br>  <span class="hljs-type">int</span> v34; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> temp_val5; <span class="hljs-comment">// r8d</span><br>  __int64 result; <span class="hljs-comment">// rax</span><br>  __int64 user_index; <span class="hljs-comment">// rax</span><br>  __int64 sudoku_index; <span class="hljs-comment">// rdx</span><br>  <span class="hljs-type">int</span> user_codepointer; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v40; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> temp_val6; <span class="hljs-comment">// r11d</span><br>  <span class="hljs-type">int</span> temp_val7; <span class="hljs-comment">// r10d</span><br>  <span class="hljs-type">int</span> v43; <span class="hljs-comment">// r10d</span><br>  <span class="hljs-type">int</span> temp_val8; <span class="hljs-comment">// ebp</span><br>  <span class="hljs-type">int</span> temp_val9; <span class="hljs-comment">// r11d</span><br>  __int64 temp_arg1; <span class="hljs-comment">// rdx</span><br>  __int64 temp_arg2; <span class="hljs-comment">// rdx</span><br>  __int64 temp_arg3; <span class="hljs-comment">// rdx</span><br>  _BYTE buf[<span class="hljs-number">88</span>]; <span class="hljs-comment">// [rsp+30h] [rbp-178h] BYREF</span><br>  __int128 fmt_arg1; <span class="hljs-comment">// [rsp+90h] [rbp-118h] BYREF</span><br>  __int128 fmt_arg2; <span class="hljs-comment">// [rsp+A0h] [rbp-108h]</span><br>  __int128 fmt_arg3; <span class="hljs-comment">// [rsp+B0h] [rbp-F8h]</span><br>  __int128 fmt_arg4; <span class="hljs-comment">// [rsp+C0h] [rbp-E8h]</span><br>  __int128 fmt_arg5; <span class="hljs-comment">// [rsp+D0h] [rbp-D8h]</span><br>  __int64 fmt_arg6; <span class="hljs-comment">// [rsp+E0h] [rbp-C8h]</span><br>  _OWORD stdin_handle[<span class="hljs-number">5</span>]; <span class="hljs-comment">// [rsp+F0h] [rbp-B8h] BYREF</span><br>  <span class="hljs-type">char</span> board_data; <span class="hljs-comment">// [rsp+140h] [rbp-68h]</span><br>  _BYTE md5_hash[<span class="hljs-number">16</span>]; <span class="hljs-comment">// [rsp+150h] [rbp-58h] BYREF</span><br><br>  *buf = &amp;welcome;                              <span class="hljs-comment">// &quot;Welcome to MoeCTF 2025!\nPlease **find** my sudoku and fill it correctly.\nAnd then I will give you the flag.\nInput your answer in one line (without spaces).\nfor example, 854219763397865421261473985785126394649538172132947856926384517513792648478651239 represents:\n854|219|763\n397|865|421\n261|473|985\n-----------\n785|126|394\n649|538|172\n132|947|856\n-----------\n926|384|517\n513|792|648\n478|651|239\n\nYour answer:\n&quot;</span><br>  *&amp;buf[<span class="hljs-number">8</span>] = <span class="hljs-number">1LL</span>;<br>  *&amp;buf[<span class="hljs-number">16</span>] = <span class="hljs-number">8LL</span>;<br>  *&amp;buf[<span class="hljs-number">24</span>] = <span class="hljs-number">0LL</span>;<br>  std::io::stdio::_print(a1, a2, a3, buf);<br>  *buf = <span class="hljs-number">0LL</span>;<br>  *&amp;buf[<span class="hljs-number">8</span>] = <span class="hljs-number">1LL</span>;<br>  *&amp;buf[<span class="hljs-number">16</span>] = <span class="hljs-number">0LL</span>;<br>  *&amp;stdin_handle[<span class="hljs-number">0</span>] = std::io::stdio::<span class="hljs-built_in">stdin</span>();<br>  md5_ctx_prt = stdin_handle;<br>  <span class="hljs-keyword">if</span> ( (std::io::stdio::Stdin::<span class="hljs-built_in">read_line</span>(stdin_handle, a2, buf, stdin_handle) &amp; <span class="hljs-number">1</span>) != <span class="hljs-number">0</span> )<br>  &#123;<br>    *&amp;fmt_arg1 = temp;<br>    core::result::<span class="hljs-built_in">unwrap_failed</span>(stdin_handle, a2, <span class="hljs-number">14</span>, <span class="hljs-string">&quot;Invalid input.src\\main.rs&quot;</span>, &amp;fmt_arg1, &amp;off_7FF6BF752050);<br>  &#125;<br>  cupy_size = *&amp;buf[<span class="hljs-number">8</span>];<br>  input_end = (*&amp;buf[<span class="hljs-number">8</span>] + *&amp;buf[<span class="hljs-number">16</span>]);<br>  <span class="hljs-keyword">if</span> ( *&amp;buf[<span class="hljs-number">16</span>] )<br>  &#123;<br>    trimmed_length = <span class="hljs-number">0LL</span>;<br>    trimmed_start = <span class="hljs-number">0LL</span>;<br>    input_ptr = *&amp;buf[<span class="hljs-number">8</span>];<br>    <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>    &#123;<br>      current_ptr = input_ptr;<br>      trimmed_count = trimmed_start;<br>      codepoint = *input_ptr;<br>      <span class="hljs-keyword">if</span> ( (codepoint &amp; <span class="hljs-number">0x80u</span>) != <span class="hljs-number">0</span> )<br>      &#123;<br>        v14 = codepoint &amp; <span class="hljs-number">0x1F</span>;<br>        temp_val1 = input_ptr[<span class="hljs-number">1</span>] &amp; <span class="hljs-number">0x3F</span>;<br>        <span class="hljs-keyword">if</span> ( codepoint &lt;= <span class="hljs-number">0xDFu</span> )<br>        &#123;<br>          input_ptr += <span class="hljs-number">2</span>;<br>          codepoint = temp_val1 | (v14 &lt;&lt; <span class="hljs-number">6</span>);<br>        &#125;<br>        <span class="hljs-keyword">else</span><br>        &#123;<br>          temp_val2 = (temp_val1 &lt;&lt; <span class="hljs-number">6</span>) | input_ptr[<span class="hljs-number">2</span>] &amp; <span class="hljs-number">0x3F</span>;<br>          <span class="hljs-keyword">if</span> ( codepoint &lt; <span class="hljs-number">0xF0u</span> )<br>          &#123;<br>            input_ptr += <span class="hljs-number">3</span>;<br>            codepoint = (v14 &lt;&lt; <span class="hljs-number">12</span>) | temp_val2;<br>          &#125;<br>          <span class="hljs-keyword">else</span><br>          &#123;<br>            input_ptr += <span class="hljs-number">4</span>;<br>            codepoint = ((codepoint &amp; <span class="hljs-number">7</span>) &lt;&lt; <span class="hljs-number">18</span>) | (temp_val2 &lt;&lt; <span class="hljs-number">6</span>) | current_ptr[<span class="hljs-number">3</span>] &amp; <span class="hljs-number">0x3F</span>;<br>          &#125;<br>        &#125;<br>      &#125;<br>      <span class="hljs-keyword">else</span><br>      &#123;<br>        ++input_ptr;<br>      &#125;<br>      trimmed_start = &amp;trimmed_count[input_ptr - current_ptr];<br>      <span class="hljs-keyword">if</span> ( codepoint - <span class="hljs-number">9</span> &gt;= <span class="hljs-number">5</span> &amp;&amp; codepoint != <span class="hljs-number">32</span> )<br>      &#123;<br>        <span class="hljs-keyword">if</span> ( codepoint &lt; <span class="hljs-number">0x80</span> )<br>          <span class="hljs-keyword">goto</span> LABEL_27;<br>        high_byte = codepoint &gt;&gt; <span class="hljs-number">8</span>;<br>        <span class="hljs-keyword">if</span> ( codepoint &gt;&gt; <span class="hljs-number">8</span> &gt; <span class="hljs-number">0x1F</span> )<br>        &#123;<br>          <span class="hljs-keyword">if</span> ( high_byte == <span class="hljs-number">32</span> )<br>          &#123;<br>            is_whitespace = *(core::unicode::unicode_data::white_space::WHITESPACE_MAP + codepoint) &gt;&gt; <span class="hljs-number">1</span>;<br>          &#125;<br>          <span class="hljs-keyword">else</span><br>          &#123;<br>            <span class="hljs-keyword">if</span> ( high_byte != <span class="hljs-number">48</span> )<br>              <span class="hljs-keyword">goto</span> LABEL_27;<br>            is_whitespace = codepoint == <span class="hljs-number">12288</span>;<br>          &#125;<br>        &#125;<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( high_byte )<br>        &#123;<br>          <span class="hljs-keyword">if</span> ( high_byte != <span class="hljs-number">22</span> )<br>            <span class="hljs-keyword">goto</span> LABEL_27;<br>          is_whitespace = codepoint == <span class="hljs-number">5760</span>;<br>        &#125;<br>        <span class="hljs-keyword">else</span><br>        &#123;<br>          is_whitespace = *(core::unicode::unicode_data::white_space::WHITESPACE_MAP + codepoint);<br>        &#125;<br>        <span class="hljs-keyword">if</span> ( (is_whitespace &amp; <span class="hljs-number">1</span>) == <span class="hljs-number">0</span> )<br>          <span class="hljs-keyword">goto</span> LABEL_27;<br>      &#125;<br>      <span class="hljs-keyword">if</span> ( input_ptr == input_end )<br>      &#123;<br>        alloc_result = <span class="hljs-number">1LL</span>;<br>        <span class="hljs-keyword">goto</span> LABEL_58;<br>      &#125;<br>    &#125;<br>  &#125;<br>  trimmed_start = <span class="hljs-number">0LL</span>;<br>  input_ptr = *&amp;buf[<span class="hljs-number">8</span>];<br>  trimmed_count = <span class="hljs-number">0LL</span>;<br>LABEL_27:<br>  <span class="hljs-keyword">if</span> ( input_ptr == input_end )<br>    <span class="hljs-keyword">goto</span> LABEL_53;<br>  <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>  &#123;<br>    end_ptr = input_end;<br>    codepoint2 = *(input_end - <span class="hljs-number">1</span>);<br>    <span class="hljs-keyword">if</span> ( (codepoint2 &amp; <span class="hljs-number">0x80000000</span>) != <span class="hljs-number">0</span> )<br>    &#123;<br>      byte1 = *(input_end - <span class="hljs-number">2</span>);<br>      <span class="hljs-keyword">if</span> ( byte1 &gt;= <span class="hljs-number">-64</span> )<br>      &#123;<br>        input_end -= <span class="hljs-number">2</span>;<br>        temp_val4 = byte1 &amp; <span class="hljs-number">0x1F</span>;<br>      &#125;<br>      <span class="hljs-keyword">else</span><br>      &#123;<br>        byte2 = *(input_end - <span class="hljs-number">3</span>);<br>        <span class="hljs-keyword">if</span> ( byte2 &gt;= <span class="hljs-number">-64</span> )<br>        &#123;<br>          input_end -= <span class="hljs-number">3</span>;<br>          temp_val3 = byte2 &amp; <span class="hljs-number">0xF</span>;<br>        &#125;<br>        <span class="hljs-keyword">else</span><br>        &#123;<br>          input_end -= <span class="hljs-number">4</span>;<br>          temp_val3 = ((*(end_ptr - <span class="hljs-number">4</span>) &amp; <span class="hljs-number">7</span>) &lt;&lt; <span class="hljs-number">6</span>) | byte2 &amp; <span class="hljs-number">0x3F</span>;<br>        &#125;<br>        temp_val4 = (temp_val3 &lt;&lt; <span class="hljs-number">6</span>) | byte1 &amp; <span class="hljs-number">0x3F</span>;<br>      &#125;<br>      codepoint2 = (temp_val4 &lt;&lt; <span class="hljs-number">6</span>) | codepoint2 &amp; <span class="hljs-number">0x3F</span>;<br>      <span class="hljs-keyword">if</span> ( codepoint2 - <span class="hljs-number">9</span> &lt; <span class="hljs-number">5</span> )<br>        <span class="hljs-keyword">goto</span> LABEL_31;<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>      --input_end;<br>      <span class="hljs-keyword">if</span> ( codepoint2 - <span class="hljs-number">9</span> &lt; <span class="hljs-number">5</span> )<br>        <span class="hljs-keyword">goto</span> LABEL_31;<br>    &#125;<br>    <span class="hljs-keyword">if</span> ( codepoint2 == <span class="hljs-number">32</span> )<br>      <span class="hljs-keyword">goto</span> LABEL_31;<br>    <span class="hljs-keyword">if</span> ( codepoint2 &lt; <span class="hljs-number">0x80</span> )<br>      <span class="hljs-keyword">break</span>;<br>    high_byte2 = codepoint2 &gt;&gt; <span class="hljs-number">8</span>;<br>    <span class="hljs-keyword">if</span> ( codepoint2 &gt;&gt; <span class="hljs-number">8</span> &lt;= <span class="hljs-number">0x1F</span> )<br>    &#123;<br>      <span class="hljs-keyword">if</span> ( high_byte2 )<br>      &#123;<br>        <span class="hljs-keyword">if</span> ( high_byte2 != <span class="hljs-number">22</span> )<br>          <span class="hljs-keyword">break</span>;<br>        is_whitespace2 = codepoint2 == <span class="hljs-number">5760</span>;<br>      &#125;<br>      <span class="hljs-keyword">else</span><br>      &#123;<br>        is_whitespace2 = *(core::unicode::unicode_data::white_space::WHITESPACE_MAP + codepoint2);<br>      &#125;<br>      <span class="hljs-keyword">goto</span> LABEL_30;<br>    &#125;<br>    <span class="hljs-keyword">if</span> ( high_byte2 == <span class="hljs-number">32</span> )<br>    &#123;<br>      is_whitespace2 = *(core::unicode::unicode_data::white_space::WHITESPACE_MAP + codepoint2) &gt;&gt; <span class="hljs-number">1</span>;<br>      <span class="hljs-keyword">goto</span> LABEL_30;<br>    &#125;<br>    <span class="hljs-keyword">if</span> ( high_byte2 != <span class="hljs-number">48</span> )<br>      <span class="hljs-keyword">break</span>;<br>    is_whitespace2 = codepoint2 == <span class="hljs-number">12288</span>;<br>LABEL_30:<br>    <span class="hljs-keyword">if</span> ( (is_whitespace2 &amp; <span class="hljs-number">1</span>) == <span class="hljs-number">0</span> )<br>      <span class="hljs-keyword">break</span>;<br>LABEL_31:<br>    <span class="hljs-keyword">if</span> ( input_ptr == input_end )<br>      <span class="hljs-keyword">goto</span> LABEL_53;<br>  &#125;<br>  trimmed_start = &amp;end_ptr[trimmed_start - input_ptr];<br>LABEL_53:<br>  trimmed_length = (trimmed_start - trimmed_count);<br>  <span class="hljs-keyword">if</span> ( trimmed_start - trimmed_count &lt; <span class="hljs-number">0</span> )<br>  &#123;<br>    alloc_size = <span class="hljs-number">0LL</span>;<br>    <span class="hljs-keyword">goto</span> LABEL_110;<br>  &#125;<br>  cupy_size = &amp;trimmed_count[*&amp;buf[<span class="hljs-number">8</span>]];<br>  <span class="hljs-keyword">if</span> ( trimmed_start == trimmed_count )<br>  &#123;<br>    alloc_result = <span class="hljs-number">1LL</span>;<br>    trimmed_length = <span class="hljs-number">0LL</span>;<br>    <span class="hljs-keyword">goto</span> LABEL_58;<br>  &#125;<br>  actual_size = &amp;trimmed_count[*&amp;buf[<span class="hljs-number">8</span>]];<br>  <span class="hljs-built_in">RNvCs73fAdSrgOJL_7___rustc35___rust_no_alloc_shim_is_unstable_v2</span>(stdin_handle, trimmed_length);<br>  alloc_size = <span class="hljs-number">1LL</span>;<br>  allocated_mem = __rustc::__rust_alloc(stdin_handle, trimmed_length, <span class="hljs-number">1LL</span>, trimmed_length);<br>  <span class="hljs-keyword">if</span> ( !allocated_mem )<br>LABEL_110:<br>    alloc::raw_vec::<span class="hljs-built_in">handle_error</span>(stdin_handle, trimmed_length, trimmed_length, alloc_size, &amp;off_7FF6BF7521D8);<span class="hljs-comment">// &quot;/rustc/29483883eed69d5fb4db01964cdf2af4d86e9cb2\\library\\alloc\\src\\slice.rs&quot;</span><br>  alloc_result = allocated_mem;<br>  cupy_size = actual_size;<br>LABEL_58:<br>  <span class="hljs-built_in">memcpy</span>(stdin_handle, trimmed_length, cupy_size);<br>  input_data = *buf;<br>  <span class="hljs-keyword">if</span> ( *buf )<br>    __rustc::__rust_dealloc(stdin_handle, trimmed_length, *buf, *&amp;buf[<span class="hljs-number">8</span>], <span class="hljs-number">1LL</span>);<br>  <span class="hljs-keyword">if</span> ( trimmed_length == <span class="hljs-number">81</span> )<br>  &#123;<br>    index = <span class="hljs-number">0LL</span>;<br>    <span class="hljs-keyword">while</span> ( index != <span class="hljs-number">81</span> )<br>    &#123;<br>      user_char = *(alloc_result + index);<br>      <span class="hljs-keyword">if</span> ( (user_char &amp; <span class="hljs-number">0x80u</span>) == <span class="hljs-number">0</span> )<br>      &#123;<br>        ++index;<br>      &#125;<br>      <span class="hljs-keyword">else</span><br>      &#123;<br>        v34 = user_char &amp; <span class="hljs-number">0x1F</span>;<br>        expected_char = *(alloc_result + index + <span class="hljs-number">1</span>) &amp; <span class="hljs-number">0x3F</span>;<br>        <span class="hljs-keyword">if</span> ( user_char &lt;= <span class="hljs-number">0xDFu</span> )<br>        &#123;<br>          index += <span class="hljs-number">2LL</span>;<br>          input_data = expected_char | (v34 &lt;&lt; <span class="hljs-number">6</span>);<br>          user_char = input_data;<br>        &#125;<br>        <span class="hljs-keyword">else</span><br>        &#123;<br>          expected_char = (expected_char &lt;&lt; <span class="hljs-number">6</span>);<br>          temp_val5 = expected_char | *(alloc_result + index + <span class="hljs-number">2</span>) &amp; <span class="hljs-number">0x3F</span>;<br>          <span class="hljs-keyword">if</span> ( user_char &lt; <span class="hljs-number">0xF0u</span> )<br>          &#123;<br>            index += <span class="hljs-number">3LL</span>;<br>            input_data = (v34 &lt;&lt; <span class="hljs-number">12</span>);<br>            user_char = input_data | temp_val5;<br>          &#125;<br>          <span class="hljs-keyword">else</span><br>          &#123;<br>            input_data = (user_char &amp; <span class="hljs-number">7</span>) &lt;&lt; <span class="hljs-number">18</span>;<br>            user_char = input_data | (temp_val5 &lt;&lt; <span class="hljs-number">6</span>) | *(alloc_result + index + <span class="hljs-number">3</span>) &amp; <span class="hljs-number">0x3F</span>;<br>            <span class="hljs-keyword">if</span> ( user_char == <span class="hljs-number">1114112</span> )<br>              <span class="hljs-keyword">break</span>;<br>            index += <span class="hljs-number">4LL</span>;<br>          &#125;<br>        &#125;<br>      &#125;<br>      <span class="hljs-keyword">if</span> ( (user_char - <span class="hljs-number">58</span>) &lt; <span class="hljs-number">0xFFFFFFF6</span> )<br>        <span class="hljs-keyword">goto</span> LABEL_72;<br>    &#125;<br>    user_index = <span class="hljs-number">0LL</span>;<br>    sudoku_index = <span class="hljs-number">0LL</span>;<br>    <span class="hljs-keyword">while</span> ( user_index != <span class="hljs-number">81</span> )<br>    &#123;<br>      user_codepointer = *(alloc_result + user_index);<br>      <span class="hljs-keyword">if</span> ( (user_codepointer &amp; <span class="hljs-number">0x80u</span>) != <span class="hljs-number">0</span> )<br>      &#123;<br>        v40 = user_codepointer &amp; <span class="hljs-number">0x1F</span>;<br>        temp_val6 = *(alloc_result + user_index + <span class="hljs-number">1</span>) &amp; <span class="hljs-number">0x3F</span>;<br>        <span class="hljs-keyword">if</span> ( user_codepointer &lt;= <span class="hljs-number">0xDFu</span> )<br>        &#123;<br>          user_index += <span class="hljs-number">2LL</span>;<br>          expected_char = temp_val6 | (v40 &lt;&lt; <span class="hljs-number">6</span>);<br>          user_codepointer = expected_char;<br>          <span class="hljs-keyword">if</span> ( sudoku_index == <span class="hljs-number">81</span> )<br>            <span class="hljs-keyword">break</span>;<br>        &#125;<br>        <span class="hljs-keyword">else</span><br>        &#123;<br>          temp_val7 = (temp_val6 &lt;&lt; <span class="hljs-number">6</span>) | *(alloc_result + user_index + <span class="hljs-number">2</span>) &amp; <span class="hljs-number">0x3F</span>;<br>          <span class="hljs-keyword">if</span> ( user_codepointer &lt; <span class="hljs-number">0xF0u</span> )<br>          &#123;<br>            user_index += <span class="hljs-number">3LL</span>;<br>            expected_char = (v40 &lt;&lt; <span class="hljs-number">12</span>);<br>            user_codepointer = expected_char | temp_val7;<br>            <span class="hljs-keyword">if</span> ( sudoku_index == <span class="hljs-number">81</span> )<br>              <span class="hljs-keyword">break</span>;<br>          &#125;<br>          <span class="hljs-keyword">else</span><br>          &#123;<br>            expected_char = (user_codepointer &amp; <span class="hljs-number">7</span>) &lt;&lt; <span class="hljs-number">18</span>;<br>            user_codepointer = expected_char | (temp_val7 &lt;&lt; <span class="hljs-number">6</span>) | *(alloc_result + user_index + <span class="hljs-number">3</span>) &amp; <span class="hljs-number">0x3F</span>;<br>            <span class="hljs-keyword">if</span> ( user_codepointer == <span class="hljs-number">1114112</span> )<br>              <span class="hljs-keyword">break</span>;<br>            user_index += <span class="hljs-number">4LL</span>;<br>            <span class="hljs-keyword">if</span> ( sudoku_index == <span class="hljs-number">81</span> )<br>              <span class="hljs-keyword">break</span>;<br>          &#125;<br>        &#125;<br>      &#125;<br>      <span class="hljs-keyword">else</span><br>      &#123;<br>        ++user_index;<br>        <span class="hljs-keyword">if</span> ( sudoku_index == <span class="hljs-number">81</span> )<br>          <span class="hljs-keyword">break</span>;<br>      &#125;<br>      expected_char = sudoku[sudoku_index];<br>      <span class="hljs-keyword">if</span> ( (expected_char &amp; <span class="hljs-number">0x80u</span>) != <span class="hljs-number">0LL</span> )<br>      &#123;<br>        v43 = expected_char &amp; <span class="hljs-number">0x1F</span>;<br>        temp_val8 = sudoku[sudoku_index + <span class="hljs-number">1</span>] &amp; <span class="hljs-number">0x3F</span>;<br>        <span class="hljs-keyword">if</span> ( expected_char &lt;= <span class="hljs-number">0xDFu</span> )<br>        &#123;<br>          sudoku_index += <span class="hljs-number">2LL</span>;<br>          expected_char = temp_val8 | (v43 &lt;&lt; <span class="hljs-number">6</span>);<br>          <span class="hljs-keyword">if</span> ( user_codepointer == <span class="hljs-number">1114112</span> )<br>            <span class="hljs-keyword">break</span>;<br>        &#125;<br>        <span class="hljs-keyword">else</span><br>        &#123;<br>          temp_val9 = (temp_val8 &lt;&lt; <span class="hljs-number">6</span>) | sudoku[sudoku_index + <span class="hljs-number">2</span>] &amp; <span class="hljs-number">0x3F</span>;<br>          <span class="hljs-keyword">if</span> ( expected_char &lt; <span class="hljs-number">0xF0u</span> )<br>          &#123;<br>            sudoku_index += <span class="hljs-number">3LL</span>;<br>            expected_char = (v43 &lt;&lt; <span class="hljs-number">12</span>) | temp_val9;<br>            <span class="hljs-keyword">if</span> ( user_codepointer == <span class="hljs-number">1114112</span> )<br>              <span class="hljs-keyword">break</span>;<br>          &#125;<br>          <span class="hljs-keyword">else</span><br>          &#123;<br>            expected_char = ((expected_char &amp; <span class="hljs-number">7</span>) &lt;&lt; <span class="hljs-number">18</span>) | (temp_val9 &lt;&lt; <span class="hljs-number">6</span>) | sudoku[sudoku_index + <span class="hljs-number">3</span>] &amp; <span class="hljs-number">0x3Fu</span>;<br>            <span class="hljs-keyword">if</span> ( expected_char == <span class="hljs-number">1114112</span> )<br>              <span class="hljs-keyword">break</span>;<br>            sudoku_index += <span class="hljs-number">4LL</span>;<br>            <span class="hljs-keyword">if</span> ( user_codepointer == <span class="hljs-number">1114112</span> )<br>              <span class="hljs-keyword">break</span>;<br>          &#125;<br>        &#125;<br>      &#125;<br>      <span class="hljs-keyword">else</span><br>      &#123;<br>        ++sudoku_index;<br>        <span class="hljs-keyword">if</span> ( user_codepointer == <span class="hljs-number">1114112</span> )<br>          <span class="hljs-keyword">break</span>;<br>      &#125;<br>      <span class="hljs-keyword">if</span> ( expected_char != <span class="hljs-number">46</span> &amp;&amp; user_codepointer != expected_char )<br>      &#123;<br>        *&amp;stdin_handle[<span class="hljs-number">0</span>] = aYouShouldNotCh;<br>        *(&amp;stdin_handle[<span class="hljs-number">0</span>] + <span class="hljs-number">1</span>) = <span class="hljs-number">32LL</span>;<br>        *&amp;fmt_arg1 = stdin_handle;<br>        *(&amp;fmt_arg1 + <span class="hljs-number">1</span>) = &lt;&amp;T_as_core::fmt::Display&gt;::fmt;<br>        *buf = &amp;unk_7FF6BF<span class="hljs-number">7524E0</span>;<br>        *&amp;buf[<span class="hljs-number">8</span>] = <span class="hljs-number">2LL</span>;<br>        *&amp;buf[<span class="hljs-number">32</span>] = <span class="hljs-number">0LL</span>;<br>        *&amp;buf[<span class="hljs-number">16</span>] = &amp;fmt_arg1;<br>        *&amp;buf[<span class="hljs-number">24</span>] = <span class="hljs-number">1LL</span>;<br>        result = std::io::stdio::_print(stdin_handle, <span class="hljs-number">81LL</span>, sudoku_index, buf);<br>        <span class="hljs-keyword">goto</span> LABEL_73;<br>      &#125;<br>    &#125;<br>    sudoku::board::sudoku::Sudoku::<span class="hljs-built_in">from_str_line</span>(stdin_handle, <span class="hljs-number">81LL</span>, alloc_result, buf, <span class="hljs-number">81LL</span>, expected_char);<br>    <span class="hljs-keyword">if</span> ( buf[<span class="hljs-number">0</span>] == <span class="hljs-number">1</span> )<br>    &#123;<br>      *&amp;fmt_arg1 = *&amp;buf[<span class="hljs-number">4</span>];<br>      core::result::<span class="hljs-built_in">unwrap_failed</span>(<br>        stdin_handle,<br>        <span class="hljs-number">81</span>,<br>        <span class="hljs-number">43</span>,<br>        <span class="hljs-string">&quot;called `Result::unwrap()` on an `Err` value&quot;</span>,<br>        &amp;fmt_arg1,<br>        &amp;unk_7FF6BF752070);<br>    &#125;<br>    board_data = buf[<span class="hljs-number">81</span>];<br>    stdin_handle[<span class="hljs-number">4</span>] = *&amp;buf[<span class="hljs-number">65</span>];<br>    stdin_handle[<span class="hljs-number">3</span>] = *&amp;buf[<span class="hljs-number">49</span>];<br>    stdin_handle[<span class="hljs-number">2</span>] = *&amp;buf[<span class="hljs-number">33</span>];<br>    stdin_handle[<span class="hljs-number">1</span>] = *&amp;buf[<span class="hljs-number">17</span>];<br>    stdin_handle[<span class="hljs-number">0</span>] = *&amp;buf[<span class="hljs-number">1</span>];<br>    <span class="hljs-keyword">if</span> ( sudoku::board::sudoku::Sudoku::<span class="hljs-built_in">is_solved</span>(stdin_handle, <span class="hljs-number">81LL</span>, temp_arg1, stdin_handle) )<br>    &#123;<br>      *buf = &amp;off_7FF6BF752490;                 <span class="hljs-comment">// &quot;Congratulation!\n&quot;</span><br>      *&amp;buf[<span class="hljs-number">8</span>] = <span class="hljs-number">1LL</span>;<br>      *&amp;buf[<span class="hljs-number">16</span>] = <span class="hljs-number">8LL</span>;<br>      *&amp;buf[<span class="hljs-number">24</span>] = <span class="hljs-number">0LL</span>;<br>      std::io::stdio::_print(stdin_handle, <span class="hljs-number">81LL</span>, temp_arg2, buf);<br>      fmt_arg4 = <span class="hljs-number">0LL</span>;<br>      fmt_arg3 = <span class="hljs-number">0LL</span>;<br>      fmt_arg2 = <span class="hljs-number">0LL</span>;<br>      fmt_arg1 = <span class="hljs-number">0LL</span>;<br>      fmt_arg6 = <span class="hljs-number">0LL</span>;<br>      fmt_arg5 = ::fmt_arg5;<br>      md5_ctx_prt = &amp;fmt_arg1;<br>      md5::<span class="hljs-built_in">consume</span>(&amp;fmt_arg1, <span class="hljs-number">81LL</span>, alloc_result, &amp;fmt_arg1, <span class="hljs-number">81LL</span>);<br>      *&amp;buf[<span class="hljs-number">80</span>] = fmt_arg6;<br>      *&amp;buf[<span class="hljs-number">64</span>] = fmt_arg5;<br>      *&amp;buf[<span class="hljs-number">48</span>] = fmt_arg4;<br>      *&amp;buf[<span class="hljs-number">32</span>] = fmt_arg3;<br>      *&amp;buf[<span class="hljs-number">16</span>] = fmt_arg2;<br>      *buf = fmt_arg1;<br>      md5::Context::<span class="hljs-built_in">finalize</span>(&amp;fmt_arg1, <span class="hljs-number">81LL</span>, buf, md5_hash);<br>      *&amp;fmt_arg1 = md5_hash;<br>      *(&amp;fmt_arg1 + <span class="hljs-number">1</span>) = &lt;md5::Digest_as_core::fmt::LowerHex&gt;::fmt;<br>      *buf = &amp;YourFlagIs;                       <span class="hljs-comment">// &quot;Your flag is moectf&#123;&quot;</span><br>      *&amp;buf[<span class="hljs-number">8</span>] = <span class="hljs-number">2LL</span>;<br>      *&amp;buf[<span class="hljs-number">32</span>] = <span class="hljs-number">0LL</span>;<br>      *&amp;buf[<span class="hljs-number">16</span>] = &amp;fmt_arg1;<br>      *&amp;buf[<span class="hljs-number">24</span>] = <span class="hljs-number">1LL</span>;<br>      result = std::io::stdio::_print(&amp;fmt_arg1, <span class="hljs-number">81LL</span>, temp_arg3, buf);<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>      *buf = &amp;TryAgain;                         <span class="hljs-comment">// &quot;try again~\n&quot;</span><br>      *&amp;buf[<span class="hljs-number">8</span>] = <span class="hljs-number">1LL</span>;<br>      *&amp;buf[<span class="hljs-number">16</span>] = <span class="hljs-number">8LL</span>;<br>      *&amp;buf[<span class="hljs-number">24</span>] = <span class="hljs-number">0LL</span>;<br>      result = std::io::stdio::_print(stdin_handle, <span class="hljs-number">81LL</span>, temp_arg2, buf);<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>LABEL_72:<br>    *buf = &amp;Invalid;                            <span class="hljs-comment">// &quot;Invalid Solution.\n&quot;</span><br>    *&amp;buf[<span class="hljs-number">8</span>] = <span class="hljs-number">1LL</span>;<br>    *&amp;buf[<span class="hljs-number">16</span>] = <span class="hljs-number">8LL</span>;<br>    *&amp;buf[<span class="hljs-number">24</span>] = <span class="hljs-number">0LL</span>;<br>    result = std::io::stdio::_print(stdin_handle, trimmed_length, input_data, buf);<br>  &#125;<br>LABEL_73:<br>  <span class="hljs-keyword">if</span> ( trimmed_length )<br>    <span class="hljs-keyword">return</span> __rustc::__rust_dealloc(md5_ctx_prt, trimmed_length, trimmed_length, alloc_result, <span class="hljs-number">1LL</span>);<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>rusté€†å‘çš„ä¼ªä»£ç ä¸å¥½åˆ†æï¼Œä½†æ˜¯ä½œä¸ºæ•°ç‹¬æ¸¸æˆï¼Œåªéœ€è¦æ‰¾åˆ°æ•°ç‹¬å°±å¯ä»¥äº†ï¼Œå¯ä»¥shift+F12åœ¨å­—ç¬¦ä¸²è¡¨çª—å£æ‰¾åˆ°å¯ç–‘çš„æ•°æ®ï¼š</p>
<p><img src="/../images/image-20250910112618179-1760193218429-38.png" alt="å¯ç–‘çš„æ•°æ®"></p>
</li>
<li><p>ç»“åˆä¼ªä»£ç ï¼Œå¯ä»¥åˆ†æå‡ºç¨‹åºæ¥å—ç”¨æˆ·è¾“å…¥çš„å·²æ±‚è§£çš„æ•°ç‹¬åä¼šè¿›è¡Œæ£€éªŒï¼Œè‹¥æ•°ç‹¬æ­£ç¡®ä¸”æ±‚è§£æˆåŠŸï¼Œä¼šè¾“å‡ºflagï¼Œflagæ˜¯md5åŠ å¯†åçš„æ•°ç‹¬ã€‚æ‰€ä»¥ç›´æ¥åˆ©ç”¨ç¨‹åºå¾—åˆ°flagå³å¯ã€‚ç½‘ä¸Šæ‰¾ä¸€ä¸ªæ•°ç‹¬æ±‚è§£å·¥å…·æ±‚è§£ï¼š<a href="https://sudoku.vc/zh-CN/sudoku-solver">æ•°ç‹¬æ±‚è§£å™¨ - å…è´¹åœ¨çº¿æ•°ç‹¬æ–¹æ¡ˆè§£é¢˜å·¥å…·</a>ï¼ˆå»ºè®®ä¸è¦ç›´æ¥æŠŠæ•°ç‹¬å¤åˆ¶ç»™AIæ±‚è§£ï¼Œå› ä¸ºAIä¼šä¹±æ”¹æ•°æ®ï¼Œç¬”è€…å¡åœ¨æ±‚è§£è¿™ä¸€æ­¥å¥½ä¹…ğŸ˜…ï¼‰</p>
<p><img src="/../images/image-20250910112549164-1760193218429-42.png" alt="æ±‚è§£æ•°ç‹¬"></p>
</li>
<li><p>IDAåŠ¨æ€è°ƒè¯•ï¼ˆç›´æ¥è¿è¡Œç¨‹åºè¾“å…¥æ­£ç¡®æ•°ç‹¬è²Œä¼¼ä¼šé—ªé€€ï¼‰ï¼ŒæŠŠè§£å‡ºæ¥çš„æ•°ç‹¬æŒ‰æç¤ºçš„é¡ºåºè¾“å…¥ï¼Œå°±å¯ä»¥å¾—åˆ°flagï¼š</p>
<p><img src="/../images/image-20250910112516212-1760193218429-41.png" alt="å¾—åˆ°flag"></p>
</li>
</ul>
<h2 id="week4"><a href="#week4" class="headerlink" title="week4"></a>week4</h2><h3 id="ezandroid"><a href="#ezandroid" class="headerlink" title="ezandroid"></a>ezandroid</h3><ul>
<li><p>é™„ä»¶apkç”¨JEBæ‰“å¼€ï¼Œå‘ç°é€»è¾‘ä¸»è¦æ˜¯å°†è¾“å…¥çš„æ–‡æœ¬base64åŠ å¯†åè¿›è¡Œæ¯”è¾ƒ</p>
<p><img src="/../images/image-20250907203522833-1760193218429-43.png" alt="å‡½æ•°é€»è¾‘"></p>
</li>
<li><p>cyberchefä¸€æŠŠæ¢­</p>
<p><img src="/../images/image-20250907203551932-1760193218429-44.png" alt="cyberchefä¸€æŠŠæ¢­"></p>
</li>
</ul>
<h3 id="ezandroid-pro"><a href="#ezandroid-pro" class="headerlink" title="ezandroid.pro"></a>ezandroid.pro</h3><ul>
<li><p>é™„ä»¶apkç”¨JEBæ‰“å¼€ï¼Œå¯ä»¥å‘ç°ä½¿ç”¨äº†ä¸€ä¸ªä»nativeå±‚ezandroidproåº“è½½å…¥çš„å‡½æ•°checkï¼Œç”±checkåˆ¤æ–­è¾“å…¥æ˜¯å¦æ­£ç¡®</p>
<p><img src="/../images/image-20250907212718438-1760193218429-45.png" alt="JEBåç¼–è¯‘ç»“æœ"></p>
</li>
<li><p>æŠŠapkè§£å‹ï¼Œåœ¨IDAä¸­æ‰“å¼€lib&#x2F;armeabi-v7a&#x2F;libezandroidpro.soï¼Œåœ¨Exportsç•Œé¢æ‰¾åˆ°Java_com_example_ezandroidpro_MainActivity_checkå‡½æ•°ï¼Œå³apkè½½å…¥çš„checkå‡½æ•°</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-type">bool</span> __fastcall <span class="hljs-title">Java_com_example_ezandroidpro_MainActivity_check</span><span class="hljs-params">(<span class="hljs-type">int</span> JENV, <span class="hljs-type">int</span> a2, <span class="hljs-type">int</span> a3)</span></span><br><span class="hljs-function"></span>&#123;<br>  _BOOL4 ret; <span class="hljs-comment">// r5</span><br>  <span class="hljs-type">const</span> <span class="hljs-type">char</span> *flag; <span class="hljs-comment">// r0</span><br>  <span class="hljs-type">const</span> <span class="hljs-type">char</span> *src; <span class="hljs-comment">// r4</span><br>  <span class="hljs-type">size_t</span> length; <span class="hljs-comment">// r0</span><br>  <span class="hljs-type">size_t</span> n; <span class="hljs-comment">// r5</span><br>  <span class="hljs-type">char</span> *dest; <span class="hljs-comment">// r9</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v11; <span class="hljs-comment">// r10</span><br>  <span class="hljs-type">char</span> *str; <span class="hljs-comment">// r4</span><br>  <span class="hljs-type">int</span> n96; <span class="hljs-comment">// r2</span><br>  <span class="hljs-type">int</span> v14; <span class="hljs-comment">// r0</span><br>  <span class="hljs-type">unsigned</span> __int8 *v15; <span class="hljs-comment">// r2</span><br>  <span class="hljs-type">int</span> v16; <span class="hljs-comment">// r1</span><br>  <span class="hljs-type">char</span> *_str; <span class="hljs-comment">// r3</span><br>  <span class="hljs-type">void</span> *s1_1; <span class="hljs-comment">// r6</span><br>  <span class="hljs-type">unsigned</span> __int8 v20; <span class="hljs-comment">// [sp+4h] [bp-44h] BYREF</span><br>  _BYTE v21[<span class="hljs-number">7</span>]; <span class="hljs-comment">// [sp+5h] [bp-43h] BYREF</span><br>  <span class="hljs-type">void</span> *s1; <span class="hljs-comment">// [sp+Ch] [bp-3Ch]</span><br>  _DWORD v23[<span class="hljs-number">2</span>]; <span class="hljs-comment">// [sp+10h] [bp-38h] BYREF</span><br>  <span class="hljs-type">void</span> *key; <span class="hljs-comment">// [sp+18h] [bp-30h]</span><br>  _DWORD v25[<span class="hljs-number">2</span>]; <span class="hljs-comment">// [sp+1Ch] [bp-2Ch] BYREF</span><br>  <span class="hljs-type">void</span> *dest_1; <span class="hljs-comment">// [sp+24h] [bp-24h]</span><br><br>  ret = <span class="hljs-number">0</span>;<br>  flag = (<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)(*(<span class="hljs-built_in">int</span> (__fastcall **)(<span class="hljs-type">int</span>, <span class="hljs-type">int</span>, _DWORD))(*(_DWORD *)JENV + <span class="hljs-number">676</span>))(JENV, a3, <span class="hljs-number">0</span>);<br>  <span class="hljs-keyword">if</span> ( !flag )<br>    <span class="hljs-keyword">return</span> ret;<br>  src = flag;<br>  length = <span class="hljs-built_in">strlen</span>(flag);<br>  <span class="hljs-keyword">if</span> ( length &gt;= <span class="hljs-number">0xFFFFFFF0</span> )<br>    std::__basic_string_common&lt;<span class="hljs-literal">true</span>&gt;::__throw_length_error(v25);<br>  n = length;<br>  <span class="hljs-keyword">if</span> ( length &gt;= <span class="hljs-number">0xB</span> )<br>  &#123;<br>    v11 = (length + <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xFFFFFFF0</span>;<br>    dest = (<span class="hljs-type">char</span> *)<span class="hljs-keyword">operator</span> <span class="hljs-built_in">new</span>(v11);<br>    v25[<span class="hljs-number">1</span>] = n;<br>    dest_1 = dest;<br>    v25[<span class="hljs-number">0</span>] = v11 + <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">goto</span> LABEL_7;<br>  &#125;<br>  <span class="hljs-built_in">LOBYTE</span>(v25[<span class="hljs-number">0</span>]) = <span class="hljs-number">2</span> * length;<br>  dest = (<span class="hljs-type">char</span> *)v25 + <span class="hljs-number">1</span>;<br>  <span class="hljs-keyword">if</span> ( length )<br>LABEL_7:<br>    <span class="hljs-built_in">j_memcpy</span>(dest, src, n);<br>  dest[n] = <span class="hljs-number">0</span>;<br>  (*(<span class="hljs-built_in">void</span> (__fastcall **)(<span class="hljs-type">int</span>, <span class="hljs-type">int</span>, <span class="hljs-type">const</span> <span class="hljs-type">char</span> *))(*(_DWORD *)JENV + <span class="hljs-number">680</span>))(JENV, a3, src);<br>  key = (<span class="hljs-type">void</span> *)<span class="hljs-keyword">operator</span> <span class="hljs-built_in">new</span>(<span class="hljs-number">0x20u</span>);<br>  <span class="hljs-built_in">strcpy</span>((<span class="hljs-type">char</span> *)key, <span class="hljs-string">&quot;moectf2025!!!!!!&quot;</span>);<br>  v23[<span class="hljs-number">1</span>] = <span class="hljs-number">16</span>;<br>  v23[<span class="hljs-number">0</span>] = <span class="hljs-number">33</span>;<br>  str = (<span class="hljs-type">char</span> *)<span class="hljs-keyword">operator</span> <span class="hljs-built_in">new</span>(<span class="hljs-number">0x70u</span>);<br>  <span class="hljs-built_in">strcpy</span>(str, <span class="hljs-string">&quot;4EEB1EEF2914D79BFA8C5006332097ED2EF06C4A59CAE31C827A08D45CC649C0B971BF2EFBCB160E531A646DF7A6AC0B&quot;</span>);<br>  <span class="hljs-built_in">sm4Encrypt</span>((<span class="hljs-type">int</span>)&amp;v20, (<span class="hljs-type">int</span>)v25, (<span class="hljs-type">int</span>)v23);<br>  n96 = *(_DWORD *)&amp;v21[<span class="hljs-number">3</span>];<br>  v14 = v20 &amp; <span class="hljs-number">1</span>;<br>  <span class="hljs-keyword">if</span> ( !v14 )<br>    n96 = v20 &gt;&gt; <span class="hljs-number">1</span>;<br>  <span class="hljs-keyword">if</span> ( n96 == <span class="hljs-number">96</span> )<br>  &#123;<br>    <span class="hljs-keyword">if</span> ( v14 )<br>    &#123;<br>      s1_1 = s1;<br>      ret = <span class="hljs-built_in">memcmp</span>(s1, str, <span class="hljs-number">0x60u</span>) == <span class="hljs-number">0</span>;<br>      <span class="hljs-keyword">goto</span> LABEL_20;<br>    &#125;<br>    v15 = v21;<br>    v16 = v20 &gt;&gt; <span class="hljs-number">1</span>;<br>    _str = str;<br>    <span class="hljs-keyword">do</span><br>    &#123;<br>      ret = *v15 == (<span class="hljs-type">unsigned</span> __int8)*_str;<br>      <span class="hljs-keyword">if</span> ( *v15 != (<span class="hljs-type">unsigned</span> __int8)*_str )<br>        <span class="hljs-keyword">break</span>;<br>      ++_str;<br>      ++v15;<br>      --v16;<br>    &#125;<br>    <span class="hljs-keyword">while</span> ( v16 );<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    ret = <span class="hljs-number">0</span>;<br>  &#125;<br>  <span class="hljs-keyword">if</span> ( v14 )<br>  &#123;<br>    s1_1 = s1;<br>LABEL_20:<br>    <span class="hljs-function"><span class="hljs-keyword">operator</span> <span class="hljs-title">delete</span><span class="hljs-params">(s1_1)</span></span>;<br>  &#125;<br>  <span class="hljs-function"><span class="hljs-keyword">operator</span> <span class="hljs-title">delete</span><span class="hljs-params">(str)</span></span>;<br>  <span class="hljs-keyword">if</span> ( <span class="hljs-built_in">LOBYTE</span>(v23[<span class="hljs-number">0</span>]) &lt;&lt; <span class="hljs-number">31</span> )<br>    <span class="hljs-function"><span class="hljs-keyword">operator</span> <span class="hljs-title">delete</span><span class="hljs-params">(key)</span></span>;<br>  <span class="hljs-keyword">if</span> ( <span class="hljs-built_in">LOBYTE</span>(v25[<span class="hljs-number">0</span>]) &lt;&lt; <span class="hljs-number">31</span> )<br>    <span class="hljs-function"><span class="hljs-keyword">operator</span> <span class="hljs-title">delete</span><span class="hljs-params">(dest_1)</span></span>;<br>  <span class="hljs-keyword">return</span> ret;<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>å¯ä»¥çœ‹åˆ°ï¼Œcheckå‡½æ•°ä½¿ç”¨äº†sm4åŠ å¯†ï¼Œå¯†é’¥å¯èƒ½æ˜¯â€œmoectf2025!!!!!!â€ï¼Œè¿˜éœ€è¦çŸ¥é“åŠ å¯†æ¨¡å¼ã€‚å€ŸåŠ©AIåˆ†æå…·ä½“åŠ å¯†å‡½æ•°çŸ¥é“é‡‡ç”¨ECBåŠ å¯†æ¨¡å¼ï¼Œcyberchefä¸€æŠŠæ¢­ï¼š</p>
<p><img src="/../images/image-20250907220527950-1760193218429-47.png" alt="cyberchefä¸€æŠŠæ¢­"></p>
</li>
</ul>
<h3 id="A-simple-program"><a href="#A-simple-program" class="headerlink" title="A simple program"></a>A simple program</h3><ul>
<li><p>é™„ä»¶ç¨‹åºmainå‡½æ•°åç¼–è¯‘å‡ºæ¥å¤§æ¦‚æ˜¯è¿™æ ·ï¼š</p>
<p><img src="/../images/image-20250909145857318-1760193218429-48.png" alt="mainå‡½æ•°"></p>
<p>ä½†æ˜¯Str2è¿™ä¸ªåƒæ¨¡åƒæ ·çš„flagæ˜¯å‡çš„ï¼Œæäº¤ä¼šæ˜¾ç¤ºé”™è¯¯ã€‚ç»“åˆé¢˜ç›®æç¤ºï¼Œflagåº”è¯¥è—åœ¨å…¶ä»–åœ°æ–¹ã€‚</p>
</li>
<li><p>IDAçœ‹ä¸å‡ºæœ‰ä»€ä¹ˆå¥—è·¯åœ¨é‡Œé¢ï¼Œä½†æ˜¯åœ¨X32Dbgï¼Œstrncmpæ˜¯å¯ä»¥ç‚¹è¿›å»çš„ï¼ˆåœ¨IDAä¸­ï¼Œstrncmpæ˜¯ç²‰è‰²çš„å¯¼å…¥å‡½æ•°ï¼Œç‚¹å‡»å‡½æ•°æ²¡æœ‰è¯¦ç»†å†…å®¹ï¼‰ï¼Œç‚¹è¿›å»ä¼šå‘ç°ï¼Œé‡Œé¢è¿˜æœ‰ä¸€ä¸ªstrncmp</p>
<p><img src="/../images/image-20250909150500077-1760193218429-49.png" alt="strncmp:åˆ«æœ‰æ´å¤©"></p>
<p>åŠ ä¸Šæ³¨é‡Šï¼š</p>
<p><img src="/../images/image-20250909195444724-1760193218429-46.png" alt="åŠ ä¸Šæ³¨é‡Š"></p>
</li>
<li><p>æ‰€ä»¥çœŸæ­£çš„æ£€éªŒé€»è¾‘åœ¨strncmpé‡Œï¼Œç¨‹åºä»chall.4D31A4å–å‡ºçœŸæ­£çš„å¯†æ–‡ï¼Œç„¶åæŠŠè¾“å…¥çš„flagè¿›è¡Œå¼‚æˆ–å¤„ç†å†æ¯”è¾ƒã€‚åœ¨è½¬å‚¨ä¸­è·Ÿéš4D31A4å¯ä»¥è·å¾—å¯†æ–‡ï¼š</p>
<p><img src="/../images/image-20250909195828121-1760193218429-50.png" alt="è½¬å‚¨ä¸­çš„å¯†æ–‡"></p>
</li>
<li><p>è§£å¯†è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">enc=[<span class="hljs-number">0x4E</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x5E</span>]<br>flag=<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> enc:<br>    flag+=<span class="hljs-built_in">chr</span>(i^<span class="hljs-number">0x23</span>)<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure></li>
</ul>
<h2 id="week5"><a href="#week5" class="headerlink" title="week5"></a>week5</h2><h3 id="2048-master-re"><a href="#2048-master-re" class="headerlink" title="2048_master_re"></a>2048_master_re</h3><ul>
<li><p>é™„ä»¶ç¨‹åºæ˜¯ä¸€ä¸ª2048å°æ¸¸æˆï¼Œé€šè¿‡æ–¹å‘é”®æ¥æ“ä½œæ•°å­—æ•´ä½“ç§»åŠ¨ã€‚æ ¹æ®æ¸¸æˆçª—å£å¯ä»¥æ¨æµ‹è¿™ä¹Ÿæ˜¯ä¸€ä¸ªGUIç¨‹åºã€‚</p>
<p><img src="/../images/image-20250927191149395-1760193218429-51.png" alt="æ¸¸æˆçª—å£"></p>
</li>
<li><p>ç”¨IDAæ‰“å¼€é™„ä»¶ç¨‹åºï¼Œshift+F12å¯ä»¥åœ¨å­—ç¬¦ä¸²çª—å£çœ‹è§ä¸€äº›è››ä¸é©¬è¿¹ï¼ˆå› ä¸ºæ˜¯MFC GUIç¨‹åºï¼Œä¹Ÿå¯ä»¥ç›´æ¥æ‰¾WinMainå‡½æ•°ï¼Œç„¶åå†ä»ä¸­æ‰¾å‡ºå’Œflagæ£€éªŒæœ‰å…³çš„é€»è¾‘ï¼‰ï¼š</p>
<p><img src="/../images/image-20250927191413499-1760193218429-52.png" alt="å­—ç¬¦ä¸²çª—å£"></p>
</li>
<li><p>è·Ÿè¸ªflag.txtå¯ä»¥å‘ç°ä¸€ä¸ªç–‘ä¼¼çš„å…³é”®å‡½æ•°ï¼š</p>
<p><img src="/../images/image-20250927191650957-1760193218429-54.png" alt="ç–‘ä¼¼å…³é”®é€»è¾‘çš„å‡½æ•°"></p>
<p>é€šè¿‡ç²—ç•¥åˆ†æå¯ä»¥æ¨æµ‹ç¨‹åºä»flag.txté‡Œè¯»å–æ•°æ®ï¼Œç„¶åè¿›è¡Œæ£€éªŒã€‚ä½†æ˜¯æ­¤å¤„æ²¡æœ‰ç›´æ¥çš„å’Œflagç›¸å…³çš„æç¤ºï¼Œè·Ÿè¸ªåˆ°ä¸Šçº§å‡½æ•°çœ‹çœ‹ã€‚é€‰ä¸­å‡½æ•°åæŒ‰XæŸ¥æ‰¾äº¤å‰å¼•ç”¨ï¼Œè·³è½¬åˆ°ä¸Šä¸€çº§å‡½æ•°ï¼š</p>
<p><img src="/../images/image-20250927192543291-1760193218429-53.png" alt="å‡ºé¢˜äººçš„æç¤º"></p>
<p>å‡ºé¢˜äººæ ¹æ®å¯ç–‘å‡½æ•°çš„è¿”å›å€¼è®¾ç½®äº†æç¤ºï¼Œçœ‹æ¥flagæ£€éªŒé€»è¾‘åœ¨æ­¤æ²¡é”™äº†ã€‚å›åˆ°å¯ç–‘å‡½æ•°ï¼Œå¯ä»¥çœ‹åˆ°å‡½æ•°ååŠéƒ¨åˆ†æ˜¯å¯¹Blockçš„æ£€éªŒï¼Œæ‰€ä»¥æ¨æµ‹sub_401A81æ˜¯ä¸€ä¸ªåŠ å¯†å‡½æ•°ã€‚è·Ÿè¸ªè¿›å»å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªé­”æ”¹xxteaå‡½æ•°å’Œä¸€ä¸ªç–‘ä¼¼æ•°æ®æ ¼å¼è½¬æ¢çš„å‡½æ•°ã€‚è¿™æ˜¯ä¼˜åŒ–åçš„æ ·å­ï¼š</p>
<p><img src="/../images/image-20250927194329834-1760193218429-55.png" alt="sub_401A81"></p>
<p>åˆ°è¿™é‡Œå¤§æ¦‚æŒæ¡äº†ä¸€äº›ä¿¡æ¯äº†ã€‚ä½†è¿˜æ˜¯è¦å®Œæ•´åˆ†æä¸€ä¸‹ç¨‹åºçš„æ•´ä½“é€»è¾‘ï¼Œç»§ç»­æ‰¾ä¸Šçº§å‡½æ•°ï¼Œå›æº¯åˆ°WinMainå‡½æ•°ã€‚ä¸‹é¢æ˜¯æ²¿ç€æ­£å‘è°ƒç”¨é€»è¾‘çš„åˆ†æï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-type">int</span> __stdcall <span class="hljs-title">WinMain</span><span class="hljs-params">(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, <span class="hljs-type">int</span> nShowCmd)</span></span><br><span class="hljs-function"></span>&#123;<br>  MSG Msg; <span class="hljs-comment">// [rsp+60h] [rbp-90h] BYREF</span><br>  WNDCLASSEXA v6; <span class="hljs-comment">// [rsp+90h] [rbp-60h] BYREF</span><br><br>  <span class="hljs-built_in">memset</span>(&amp;v6, <span class="hljs-number">0</span>, <span class="hljs-built_in">sizeof</span>(v6));<br>  v<span class="hljs-number">6.</span>cbSize = <span class="hljs-number">80</span>;<br>  v<span class="hljs-number">6.l</span>pfnWndProc = check_2048;                  <span class="hljs-comment">// æ¸¸æˆçš„æ£€éªŒé€»è¾‘</span><br>  v<span class="hljs-number">6.</span>hInstance = hInstance;<br>  v<span class="hljs-number">6.</span>hCursor = <span class="hljs-built_in">LoadCursorA</span>(<span class="hljs-number">0LL</span>, <span class="hljs-number">0x7F00</span>);<br>  v<span class="hljs-number">6.</span>hbrBackground = <span class="hljs-number">5</span>;<br>  v<span class="hljs-number">6.l</span>pszClassName = <span class="hljs-string">&quot;WindowClass&quot;</span>;<br>  v<span class="hljs-number">6.</span>hIcon = <span class="hljs-built_in">LoadIconA</span>(<span class="hljs-number">0LL</span>, <span class="hljs-number">0x7F00</span>);<br>  v<span class="hljs-number">6.</span>hIconSm = <span class="hljs-built_in">LoadIconA</span>(<span class="hljs-number">0LL</span>, <span class="hljs-number">0x7F00</span>);<br>  <span class="hljs-keyword">if</span> ( <span class="hljs-built_in">RegisterClassExA</span>(&amp;v6) )<br>  &#123;<br>    <span class="hljs-keyword">if</span> ( <span class="hljs-built_in">CreateWindowExA</span>(<br>           <span class="hljs-number">0x200u</span>,<br>           <span class="hljs-string">&quot;WindowClass&quot;</span>,<br>           <span class="hljs-string">&quot;2048&quot;</span>,<br>           <span class="hljs-number">0x10CF0000u</span>,<br>           <span class="hljs-number">0x80000000</span>,<br>           <span class="hljs-number">0x80000000</span>,<br>           <span class="hljs-number">640</span>,<br>           <span class="hljs-number">480</span>,<br>           <span class="hljs-number">0LL</span>,<br>           <span class="hljs-number">0LL</span>,<br>           hInstance,<br>           <span class="hljs-number">0LL</span>) )<br>    &#123;<br>      <span class="hljs-keyword">while</span> ( <span class="hljs-built_in">GetMessageA</span>(&amp;Msg, <span class="hljs-number">0LL</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>) &gt; <span class="hljs-number">0</span> )<br>      &#123;<br>        <span class="hljs-built_in">TranslateMessage</span>(&amp;Msg);<br>        <span class="hljs-built_in">DispatchMessageA</span>(&amp;Msg);<br>      &#125;<br>      <span class="hljs-keyword">return</span> Msg.wParam;<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>      <span class="hljs-built_in">MessageBoxA</span>(<span class="hljs-number">0LL</span>, <span class="hljs-string">&quot;Window Creation Failed!&quot;</span>, <span class="hljs-string">&quot;Error!&quot;</span>, <span class="hljs-number">0x30u</span>);<br>      <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    <span class="hljs-built_in">MessageBoxA</span>(<span class="hljs-number">0LL</span>, <span class="hljs-string">&quot;Window Registration Failed!&quot;</span>, <span class="hljs-string">&quot;Error!&quot;</span>, <span class="hljs-number">0x30u</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>  &#125;<br>&#125;<br><br><span class="hljs-comment">//æ¸¸æˆæ£€éªŒå‡½æ•°</span><br><span class="hljs-function">LRESULT __fastcall <span class="hljs-title">check_2048</span><span class="hljs-params">(HWND hWnd, UINT n20, WPARAM wParam, LPARAM lParam)</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v4; <span class="hljs-comment">// eax</span><br>  tagPAINTSTRUCT Paint; <span class="hljs-comment">// [rsp+50h] [rbp-30h] BYREF</span><br>  <span class="hljs-keyword">struct</span> <span class="hljs-title class_">tagRECT</span> Rect; <span class="hljs-comment">// [rsp+230h] [rbp+1B0h] BYREF</span><br>  HGDIOBJ h; <span class="hljs-comment">// [rsp+248h] [rbp+1C8h]</span><br>  HDC hdcSrc; <span class="hljs-comment">// [rsp+250h] [rbp+1D0h]</span><br>  HDC hdc; <span class="hljs-comment">// [rsp+258h] [rbp+1D8h]</span><br>  LONG dwNewLong; <span class="hljs-comment">// [rsp+264h] [rbp+1E4h]</span><br>  HMENU SystemMenu; <span class="hljs-comment">// [rsp+268h] [rbp+1E8h]</span><br>  <span class="hljs-type">int</span> i2; <span class="hljs-comment">// [rsp+274h] [rbp+1F4h]</span><br>  <span class="hljs-type">int</span> i1; <span class="hljs-comment">// [rsp+278h] [rbp+1F8h]</span><br>  <span class="hljs-type">int</span> nn; <span class="hljs-comment">// [rsp+27Ch] [rbp+1FCh]</span><br>  <span class="hljs-type">int</span> mm; <span class="hljs-comment">// [rsp+280h] [rbp+200h]</span><br>  <span class="hljs-type">int</span> kk; <span class="hljs-comment">// [rsp+284h] [rbp+204h]</span><br>  <span class="hljs-type">int</span> v18; <span class="hljs-comment">// [rsp+288h] [rbp+208h]</span><br>  <span class="hljs-type">int</span> jj; <span class="hljs-comment">// [rsp+28Ch] [rbp+20Ch]</span><br>  <span class="hljs-type">int</span> i14; <span class="hljs-comment">// [rsp+290h] [rbp+210h]</span><br>  <span class="hljs-type">int</span> i13; <span class="hljs-comment">// [rsp+294h] [rbp+214h]</span><br>  <span class="hljs-type">int</span> i12; <span class="hljs-comment">// [rsp+298h] [rbp+218h]</span><br>  <span class="hljs-type">int</span> i11; <span class="hljs-comment">// [rsp+29Ch] [rbp+21Ch]</span><br>  <span class="hljs-type">int</span> i10; <span class="hljs-comment">// [rsp+2A0h] [rbp+220h]</span><br>  <span class="hljs-type">int</span> v25; <span class="hljs-comment">// [rsp+2A4h] [rbp+224h]</span><br>  <span class="hljs-type">int</span> i9; <span class="hljs-comment">// [rsp+2A8h] [rbp+228h]</span><br>  <span class="hljs-type">int</span> i8; <span class="hljs-comment">// [rsp+2ACh] [rbp+22Ch]</span><br>  <span class="hljs-type">int</span> i7; <span class="hljs-comment">// [rsp+2B0h] [rbp+230h]</span><br>  <span class="hljs-type">int</span> i6; <span class="hljs-comment">// [rsp+2B4h] [rbp+234h]</span><br>  <span class="hljs-type">int</span> i5; <span class="hljs-comment">// [rsp+2B8h] [rbp+238h]</span><br>  <span class="hljs-type">int</span> i4; <span class="hljs-comment">// [rsp+2BCh] [rbp+23Ch]</span><br>  <span class="hljs-type">int</span> v32; <span class="hljs-comment">// [rsp+2C0h] [rbp+240h]</span><br>  <span class="hljs-type">int</span> i3; <span class="hljs-comment">// [rsp+2C4h] [rbp+244h]</span><br>  <span class="hljs-type">int</span> ii; <span class="hljs-comment">// [rsp+2C8h] [rbp+248h]</span><br>  <span class="hljs-type">int</span> n; <span class="hljs-comment">// [rsp+2CCh] [rbp+24Ch]</span><br>  <span class="hljs-type">int</span> m; <span class="hljs-comment">// [rsp+2D0h] [rbp+250h]</span><br>  <span class="hljs-type">int</span> k; <span class="hljs-comment">// [rsp+2D4h] [rbp+254h]</span><br>  <span class="hljs-type">int</span> j; <span class="hljs-comment">// [rsp+2D8h] [rbp+258h]</span><br>  <span class="hljs-type">int</span> v39; <span class="hljs-comment">// [rsp+2DCh] [rbp+25Ch]</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [rsp+2E0h] [rbp+260h]</span><br>  <span class="hljs-type">char</span> v41; <span class="hljs-comment">// [rsp+2E7h] [rbp+267h]</span><br>  <span class="hljs-type">int</span> i16; <span class="hljs-comment">// [rsp+2E8h] [rbp+268h]</span><br>  <span class="hljs-type">int</span> i15; <span class="hljs-comment">// [rsp+2ECh] [rbp+26Ch]</span><br><br>  <span class="hljs-keyword">if</span> ( n20 == <span class="hljs-number">15</span> )                              <span class="hljs-comment">// ä¸‹é¢å¼€å§‹æ˜¯ä¸€å¤§ä¸²çš„æ£€éªŒæ“ä½œ</span><br>  &#123;<br>    hdc = <span class="hljs-built_in">BeginPaint</span>(hWnd, &amp;Paint);<br>    hdcSrc = <span class="hljs-built_in">CreateCompatibleDC</span>(hdc);<br>    <span class="hljs-built_in">GetClientRect</span>(hWnd, &amp;Rect);<br>    h = <span class="hljs-built_in">CreateCompatibleBitmap</span>(hdc, Rect.right, Rect.bottom);<br>    <span class="hljs-built_in">SelectObject</span>(hdcSrc, h);<br>    <span class="hljs-built_in">sub_4022AF</span>(hdcSrc);<br>    <span class="hljs-built_in">BitBlt</span>(hdc, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, Rect.right, Rect.bottom, hdcSrc, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0xCC0020u</span>);<br>    <span class="hljs-built_in">DeleteObject</span>(h);<br>    <span class="hljs-built_in">DeleteDC</span>(hdcSrc);<br>    <span class="hljs-built_in">EndPaint</span>(hWnd, &amp;Paint);<br>  &#125;<br>  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( n20 &gt; <span class="hljs-number">0xF</span> )<br>  &#123;<br>	<span class="hljs-comment">//...æ­¤å¤„çœç•¥</span><br>  &#125;<br>  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( n20 == <span class="hljs-number">1</span> )<br>  &#123;<br>    SystemMenu = <span class="hljs-built_in">GetSystemMenu</span>(hWnd, <span class="hljs-number">0</span>);<br>    dwNewLong = <span class="hljs-built_in">GetWindowLongA</span>(hWnd, <span class="hljs-number">-16</span>) &amp; <span class="hljs-number">0xFFF8FFFF</span>;<br>    <span class="hljs-built_in">SetWindowLongA</span>(hWnd, <span class="hljs-number">-16</span>, dwNewLong);<br>    <span class="hljs-built_in">SetWindowPos</span>(hWnd, <span class="hljs-number">0LL</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">3u</span>);<br>    <span class="hljs-built_in">ShowWindow</span>(hWnd, <span class="hljs-number">1</span>);<br>    v4 = <span class="hljs-built_in">time64</span>(<span class="hljs-number">0LL</span>);<br>    <span class="hljs-built_in">srand</span>(v4);<br>    hThread = <span class="hljs-built_in">CreateThread</span>(<span class="hljs-number">0LL</span>, <span class="hljs-number">0LL</span>, StartAddress, <span class="hljs-number">0LL</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0LL</span>);<br>    <span class="hljs-built_in">CreateThread</span>(<span class="hljs-number">0LL</span>, <span class="hljs-number">0LL</span>, check_flag, <span class="hljs-number">0LL</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0LL</span>);<span class="hljs-comment">// è¿™é‡Œåˆ›å»ºäº†çº¿ç¨‹ï¼Œè€Œflagçš„æ£€éªŒå‡½æ•°å°±åœ¨è¿™ä¸ªçº¿ç¨‹é‡Œ</span><br>    <span class="hljs-keyword">if</span> ( <span class="hljs-built_in">sub_401DBF</span>(<span class="hljs-string">&quot;layout.dat&quot;</span>) )<br>    &#123;<br>      <span class="hljs-built_in">sub_4645D0</span>(&amp;Paint, <span class="hljs-string">&quot;layout.dat&quot;</span>, <span class="hljs-number">8</span>);<br>      <span class="hljs-keyword">for</span> ( i15 = <span class="hljs-number">1</span>; i15 &lt;= <span class="hljs-number">4</span>; ++i15 )<br>      &#123;<br>        <span class="hljs-keyword">for</span> ( i16 = <span class="hljs-number">1</span>; i16 &lt;= <span class="hljs-number">4</span>; ++i16 )<br>          <span class="hljs-built_in">sub_453880</span>(&amp;Paint, &amp;dword_4B6040[<span class="hljs-number">5</span> * i15 + i16]);<br>      &#125;<br>      <span class="hljs-built_in">sub_453880</span>(&amp;Paint, &amp;dword_4B60A4);<br>      <span class="hljs-built_in">sub_464580</span>(&amp;Paint);<br>      <span class="hljs-keyword">if</span> ( <span class="hljs-built_in">MessageBoxA</span>(<span class="hljs-number">0LL</span>, <span class="hljs-string">&quot;Continue?&quot;</span>, <span class="hljs-string">&quot;E=hv&quot;</span>, <span class="hljs-number">4u</span>) == <span class="hljs-number">7</span> )<br>      &#123;<br>        <span class="hljs-built_in">memset</span>(dword_4B6040, <span class="hljs-number">0</span>, <span class="hljs-built_in">sizeof</span>(dword_4B6040));<br>        <span class="hljs-built_in">check</span>();<br>        <span class="hljs-built_in">check</span>();<br>        <span class="hljs-built_in">InvalidateRect</span>(hWnd, <span class="hljs-number">0LL</span>, <span class="hljs-number">1</span>);<br>        dword_4B60A4 = <span class="hljs-number">0</span>;<br>      &#125;<br>      <span class="hljs-built_in">sub_464C70</span>(&amp;Paint);<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>      <span class="hljs-built_in">check</span>();<br>      <span class="hljs-built_in">check</span>();<br>      dword_4B60A4 = <span class="hljs-number">0</span>;<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    <span class="hljs-keyword">if</span> ( n20 != <span class="hljs-number">2</span> )<br>      <span class="hljs-keyword">return</span> <span class="hljs-built_in">DefWindowProcA</span>(hWnd, n20, wParam, lParam);<br>    <span class="hljs-built_in">TerminateThread</span>(hThread, <span class="hljs-number">0</span>);<br>    <span class="hljs-built_in">PostQuitMessage</span>(<span class="hljs-number">0</span>);<br>  &#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>&#125;<br><br><span class="hljs-comment">//flagçš„æ£€éªŒå‡½æ•°</span><br><span class="hljs-function">__int64 __fastcall <span class="hljs-title">check_flag</span><span class="hljs-params">(LPVOID lpThreadParameter)</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-keyword">if</span> ( !<span class="hljs-built_in">sub_401DBF</span>(<span class="hljs-string">&quot;flag.txt&quot;</span>) )<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>  <span class="hljs-keyword">if</span> ( <span class="hljs-built_in">get_check_flag</span>() )                       <span class="hljs-comment">// è·å–å¹¶æ£€éªŒflag</span><br>  &#123;<br>    <span class="hljs-built_in">MessageBoxA</span>(<br>      hWnd,<br>      <span class="hljs-string">&quot;It seems you&#x27;ve uncovered some clues, but they&#x27;re not enough to unlock the deepest secrets.&quot;</span>,<br>      <span class="hljs-string">&quot;sandtea&quot;</span>,<br>      <span class="hljs-number">0x30u</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">1LL</span>;<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    <span class="hljs-built_in">MessageBoxA</span>(hWnd, <span class="hljs-string">&quot;You have found the final secret of 2048! - sandtea&quot;</span>, <span class="hljs-string">&quot;Congratulations&quot;</span>, <span class="hljs-number">0x40u</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>  &#125;<br>&#125;<br><br><span class="hljs-comment">//è·å–å¹¶æ£€éªŒflagçš„å‡½æ•°</span><br><span class="hljs-function">__int64 <span class="hljs-title">get_check_flag</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-type">size_t</span> length; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">char</span> flag[<span class="hljs-number">136</span>]; <span class="hljs-comment">// [rsp+20h] [rbp-D0h] BYREF</span><br>  <span class="hljs-type">unsigned</span> __int64 block_num; <span class="hljs-comment">// [rsp+A8h] [rbp-48h] BYREF</span><br>  <span class="hljs-type">char</span> key[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [rsp+B0h] [rbp-40h] BYREF</span><br>  <span class="hljs-type">void</span> *Block; <span class="hljs-comment">// [rsp+D0h] [rbp-20h]</span><br>  FILE *FILE; <span class="hljs-comment">// [rsp+D8h] [rbp-18h]</span><br>  <span class="hljs-type">unsigned</span> __int64 i; <span class="hljs-comment">// [rsp+E0h] [rbp-10h]</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v8; <span class="hljs-comment">// [rsp+ECh] [rbp-4h]</span><br><br>  FILE = <span class="hljs-built_in">fopen</span>(<span class="hljs-string">&quot;flag.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>);<br>  <span class="hljs-built_in">file_read</span>(FILE, <span class="hljs-string">&quot;%100s&quot;</span>, flag);<br>  <span class="hljs-built_in">fclose</span>(FILE);<br>  <span class="hljs-keyword">if</span> ( <span class="hljs-built_in">strlen</span>(flag) != <span class="hljs-number">37</span> )<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">1LL</span>;<br>  <span class="hljs-built_in">strcpy</span>(key, <span class="hljs-string">&quot;2048master2048ma&quot;</span>);<br>  length = <span class="hljs-built_in">strlen</span>(flag);<br>  Block = <span class="hljs-built_in">encrypt</span>(flag, length, key, &amp;block_num);<br>  <span class="hljs-keyword">if</span> ( Block )<br>  &#123;<br>    v8 = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0LL</span>; i &lt; block_num; ++i )<br>    &#123;<br>      <span class="hljs-keyword">if</span> ( *(Block + i) != byte_495280[i] )<br>        v8 = <span class="hljs-number">1</span>;<br>    &#125;<br>    <span class="hljs-built_in">free</span>(Block);<br>    <span class="hljs-keyword">return</span> v8;<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    <span class="hljs-built_in">sub_428D00</span>(<span class="hljs-string">&quot;Encryption failed\n&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">1LL</span>;<br>  &#125;<br>&#125;<br><br><span class="hljs-comment">//åŠ å¯†å‡½æ•°</span><br><span class="hljs-function">__int64 __fastcall <span class="hljs-title">encrypt</span><span class="hljs-params">(__int64 flag, <span class="hljs-type">unsigned</span> __int64 length, _QWORD *key, __int64 block_num)</span></span><br><span class="hljs-function"></span>&#123;<br>  __int64 v5; <span class="hljs-comment">// rdx</span><br>  _QWORD Key[<span class="hljs-number">3</span>]; <span class="hljs-comment">// [rsp+20h] [rbp-30h] BYREF</span><br>  <span class="hljs-type">unsigned</span> __int64 word_num; <span class="hljs-comment">// [rsp+38h] [rbp-18h] BYREF</span><br>  _WORD *block; <span class="hljs-comment">// [rsp+40h] [rbp-10h]</span><br>  <span class="hljs-type">void</span> *mem; <span class="hljs-comment">// [rsp+48h] [rbp-8h]</span><br><br>  mem = <span class="hljs-built_in">new_mem</span>(flag, length, &amp;word_num);       <span class="hljs-comment">// æ ¹æ®ä¼ å…¥çš„flagç”³è¯·äº†ä¸€å—å†…å­˜ï¼Œword_numæ˜¯ç”³è¯·çš„wordä¸ªæ•°</span><br>  <span class="hljs-keyword">if</span> ( !mem )<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>  v5 = key[<span class="hljs-number">1</span>];                                  <span class="hljs-comment">// è¿™æ˜¯ä¼ å…¥çš„å¯†é’¥</span><br>  Key[<span class="hljs-number">0</span>] = *key;<br>  Key[<span class="hljs-number">1</span>] = v5;<br>  <span class="hljs-built_in">modifiedXXTea</span>(mem, word_num, Key);            <span class="hljs-comment">// xxteaåŠ å¯†</span><br>  block = <span class="hljs-built_in">make_blocks</span>(mem, word_num, block_num);<span class="hljs-comment">// å¯¹åŠ å¯†åçš„æ•°æ®è¿›è¡Œä¸€äº›è½¬æ¢ï¼Œä»¥ä¾¿åç»­å’Œç»™å®šçš„æ•°æ®è¿›è¡Œæ ¡éªŒ</span><br>  <span class="hljs-built_in">free</span>(mem);<br>  <span class="hljs-keyword">return</span> block;<br>&#125;<br><br><span class="hljs-comment">//ç”³è¯·å†…å­˜çš„å‡½æ•°</span><br><span class="hljs-function">_DWORD *__fastcall <span class="hljs-title">new_mem</span><span class="hljs-params">(__int64 flag, <span class="hljs-type">unsigned</span> __int64 length, <span class="hljs-type">unsigned</span> __int64 *word_num)</span></span><br><span class="hljs-function"></span>&#123;<br>  _DWORD *mem; <span class="hljs-comment">// [rsp+28h] [rbp-18h]</span><br>  <span class="hljs-type">unsigned</span> __int64 Word_num; <span class="hljs-comment">// [rsp+30h] [rbp-10h]</span><br>  <span class="hljs-type">unsigned</span> __int64 i; <span class="hljs-comment">// [rsp+38h] [rbp-8h]</span><br><br>  Word_num = (length + <span class="hljs-number">3</span>) &gt;&gt; <span class="hljs-number">2</span>;                 <span class="hljs-comment">// 10</span><br>  mem = <span class="hljs-built_in">calloc</span>(Word_num, <span class="hljs-number">4uLL</span>);                 <span class="hljs-comment">// 10*4å­—èŠ‚çš„å†…å­˜ç©ºé—´</span><br>  <span class="hljs-keyword">if</span> ( !mem )<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0LL</span>; i &lt; length; ++i )<br>    mem[i &gt;&gt; <span class="hljs-number">2</span>] |= *(flag + i) &lt;&lt; (<span class="hljs-number">8</span> * (i &amp; <span class="hljs-number">3</span>));<br><br>  *word_num = Word_num;<br>  <span class="hljs-keyword">return</span> mem;<br>&#125;<br><br><span class="hljs-comment">//é­”æ”¹xxteaå‡½æ•°</span><br><span class="hljs-function"><span class="hljs-type">bool</span> __fastcall <span class="hljs-title">modifiedXXTea</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> *block, <span class="hljs-type">int</span> word_num, __int64 key)</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> *p1; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> *last_one1; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">bool</span> result; <span class="hljs-comment">// al</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> *v6; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">int</span> v7; <span class="hljs-comment">// [rsp+8h] [rbp-18h]</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v8; <span class="hljs-comment">// [rsp+8h] [rbp-18h]</span><br>  <span class="hljs-type">int</span> round; <span class="hljs-comment">// [rsp+Ch] [rbp-14h]</span><br>  <span class="hljs-type">int</span> v10; <span class="hljs-comment">// [rsp+Ch] [rbp-14h]</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> j; <span class="hljs-comment">// [rsp+10h] [rbp-10h]</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [rsp+10h] [rbp-10h]</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> delta; <span class="hljs-comment">// [rsp+14h] [rbp-Ch]</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> delta1; <span class="hljs-comment">// [rsp+14h] [rbp-Ch]</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> last_one; <span class="hljs-comment">// [rsp+18h] [rbp-8h]</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v16; <span class="hljs-comment">// [rsp+18h] [rbp-8h]</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v17; <span class="hljs-comment">// [rsp+18h] [rbp-8h]</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> p2; <span class="hljs-comment">// [rsp+1Ch] [rbp-4h]</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v19; <span class="hljs-comment">// [rsp+1Ch] [rbp-4h]</span><br>  <span class="hljs-type">int</span> v20; <span class="hljs-comment">// [rsp+38h] [rbp+18h]</span><br><br>  <span class="hljs-keyword">if</span> ( word_num &lt;= <span class="hljs-number">1</span> )<br>  &#123;<br>    <span class="hljs-keyword">if</span> ( word_num &lt; <span class="hljs-number">-1</span> )<br>    &#123;<br>      v20 = -word_num;<br>      v10 = <span class="hljs-number">52</span> / -word_num + <span class="hljs-number">6</span>;<br>      delta1 = <span class="hljs-number">0x3E9779B9</span> * v10;<br>      v19 = *block;<br>      <span class="hljs-keyword">do</span><br>      &#123;<br>        v8 = (delta1 &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">3</span>;<br>        <span class="hljs-keyword">for</span> ( i = v20 - <span class="hljs-number">1</span>; i; --i )<br>        &#123;<br>          v16 = block[i - <span class="hljs-number">1</span>];<br>          v6 = &amp;block[i];<br>          *v6 -= (((<span class="hljs-number">4</span> * v19) ^ (v16 &gt;&gt; <span class="hljs-number">5</span>)) + ((v19 &gt;&gt; <span class="hljs-number">3</span>) ^ (<span class="hljs-number">16</span> * v16))) ^ ((v19 ^ delta1)<br>                                                                         + (v16 ^ *(<span class="hljs-number">4LL</span> * (v8 ^ i &amp; <span class="hljs-number">3</span>) + key)));<br>          v19 = *v6;<br>        &#125;<br>        v17 = block[v20 - <span class="hljs-number">1</span>];<br>        *block -= (((<span class="hljs-number">4</span> * v19) ^ (v17 &gt;&gt; <span class="hljs-number">5</span>)) + ((v19 &gt;&gt; <span class="hljs-number">3</span>) ^ (<span class="hljs-number">16</span> * v17))) ^ ((v19 ^ delta1) + (v17 ^ *(<span class="hljs-number">4LL</span> * v8 + key)));<br>        v19 = *block;<br>        delta1 -= <span class="hljs-number">0x3E9779B9</span>;<br>        result = --v10 != <span class="hljs-number">0</span>;<br>      &#125;<br>      <span class="hljs-keyword">while</span> ( v10 );<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    round = <span class="hljs-number">52</span> / word_num + <span class="hljs-number">6</span>;<br>    delta = <span class="hljs-number">0</span>;<br>    last_one = block[word_num - <span class="hljs-number">1</span>];<br>    <span class="hljs-keyword">do</span><br>    &#123;<br>      delta += <span class="hljs-number">0x3E9779B9</span>;<br>      v7 = (delta &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">3</span>;<br>      <span class="hljs-keyword">for</span> ( j = <span class="hljs-number">0</span>; word_num - <span class="hljs-number">1</span> &gt; j; ++j )<br>      &#123;<br>        p2 = block[j + <span class="hljs-number">1</span>];<br>        p1 = &amp;block[j];<br>        *p1 += (((<span class="hljs-number">4</span> * p2) ^ (last_one &gt;&gt; <span class="hljs-number">5</span>)) + ((p2 &gt;&gt; <span class="hljs-number">3</span>) ^ (<span class="hljs-number">16</span> * last_one))) ^ ((p2 ^ delta)<br>                                                                               + (last_one ^ *(<span class="hljs-number">4LL</span> * (v7 ^ j &amp; <span class="hljs-number">3</span>) + key)));<br>        last_one = *p1;<br>      &#125;<br>      last_one1 = &amp;block[word_num - <span class="hljs-number">1</span>];<br>      *last_one1 += (((<span class="hljs-number">4</span> * *block) ^ (last_one &gt;&gt; <span class="hljs-number">5</span>)) + ((*block &gt;&gt; <span class="hljs-number">3</span>) ^ (<span class="hljs-number">16</span> * last_one))) ^ ((*block ^ delta)<br>                                                                                            + (last_one ^ *(<span class="hljs-number">4LL</span> * (v7 ^ j &amp; <span class="hljs-number">3</span>) + key)));<br>      last_one = *last_one1;<br>      result = --round != <span class="hljs-number">0</span>;<br>    &#125;<br>    <span class="hljs-keyword">while</span> ( round );<br>  &#125;<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br><br><span class="hljs-comment">//æ•°æ®æ ¼å¼è½¬æ¢å‡½æ•°</span><br><span class="hljs-function">_WORD *__fastcall <span class="hljs-title">make_blocks</span><span class="hljs-params">(__int64 mem, <span class="hljs-type">unsigned</span> __int64 num_word, <span class="hljs-type">size_t</span> *block_num)</span></span><br><span class="hljs-function"></span>&#123;<br>  _WORD *block; <span class="hljs-comment">// [rsp+20h] [rbp-10h]</span><br>  <span class="hljs-type">unsigned</span> __int64 i; <span class="hljs-comment">// [rsp+28h] [rbp-8h]</span><br><br>  *block_num = <span class="hljs-number">4</span> * num_word; <br>  block = <span class="hljs-built_in">malloc</span>(*block_num);<br>  <span class="hljs-keyword">if</span> ( !block )<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0LL</span>; i &lt; num_word; ++i )<br>  &#123;<br>    block[<span class="hljs-number">2</span> * i] = *(<span class="hljs-number">4</span> * i + mem);<br>    <span class="hljs-built_in">LOBYTE</span>(block[<span class="hljs-number">2</span> * i + <span class="hljs-number">1</span>]) = <span class="hljs-built_in">BYTE2</span>(*(<span class="hljs-number">4</span> * i + mem));<br>    <span class="hljs-built_in">HIBYTE</span>(block[<span class="hljs-number">2</span> * i + <span class="hljs-number">1</span>]) = <span class="hljs-built_in">HIBYTE</span>(*(<span class="hljs-number">4</span> * i + mem));<br>  &#125;<br>  <span class="hljs-keyword">return</span> block;<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>æ‰€ä»¥è¦è§£å‡ºflagï¼Œå°±éœ€è¦é€†å‘è¿™ä¸ªxxteaåŠ å¯†ã€‚æŠŠè¿™ä¸ªä»»åŠ¡äº¤ç»™AIï¼Œå¯ä»¥å¾—åˆ°è§£å¯†è„šæœ¬ï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs C"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><br><span class="hljs-comment">// åŠ å¯†æ•°æ®ï¼ˆmake_blocksçš„è¾“å‡ºï¼‰</span><br><span class="hljs-type">uint8_t</span> encrypted_data[<span class="hljs-number">40</span>] = &#123;<br>    <span class="hljs-number">0x35</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0xCC</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0xF9</span>, <span class="hljs-number">0xFF</span>,<br>    <span class="hljs-number">0x9F</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0xAE</span>,<br>    <span class="hljs-number">0xD7</span>, <span class="hljs-number">0x9E</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0xC4</span>, <span class="hljs-number">0xA5</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0xD9</span>,<br>    <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x8A</span>, <span class="hljs-number">0xC9</span>, <span class="hljs-number">0x63</span><br>&#125;;<br><br><span class="hljs-comment">// å¯†é’¥</span><br><span class="hljs-type">char</span> key[<span class="hljs-number">17</span>] = <span class="hljs-string">&quot;2048master2048ma&quot;</span>;<br><br><span class="hljs-comment">// é€†make_blocksï¼šå°†_WORDæ•°ç»„è½¬æ¢å›DWORDæ•°ç»„</span><br><span class="hljs-type">uint32_t</span>* <span class="hljs-title function_">unmake_blocks</span><span class="hljs-params">(<span class="hljs-type">uint8_t</span>* blocks, <span class="hljs-type">size_t</span> block_bytes, <span class="hljs-type">size_t</span>* num_dwords)</span> &#123;<br>    *num_dwords = block_bytes / <span class="hljs-number">4</span>;<br>    <span class="hljs-type">uint32_t</span>* dwords = (<span class="hljs-type">uint32_t</span>*)<span class="hljs-built_in">malloc</span>(*num_dwords * <span class="hljs-number">4</span>);<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; *num_dwords; i++) &#123;<br>        <span class="hljs-comment">// å°†ä¸¤ä¸ªWORDåˆå¹¶ä¸ºä¸€ä¸ªDWORD</span><br>        <span class="hljs-type">uint16_t</span> low_word = *(<span class="hljs-type">uint16_t</span>*)&amp;blocks[<span class="hljs-number">4</span> * i];<br>        <span class="hljs-type">uint16_t</span> high_word = *(<span class="hljs-type">uint16_t</span>*)&amp;blocks[<span class="hljs-number">4</span> * i + <span class="hljs-number">2</span>];<br>        dwords[i] = (high_word &lt;&lt; <span class="hljs-number">16</span>) | low_word;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> dwords;<br>&#125;<br><br><span class="hljs-comment">// é€†modifiedXXTeaè§£å¯†</span><br><span class="hljs-type">void</span> <span class="hljs-title function_">decrypt_tea</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span>* data, <span class="hljs-type">int</span> num_dwords, <span class="hljs-type">uint32_t</span>* tea_key)</span> &#123;<br>    <span class="hljs-keyword">if</span> (num_dwords &lt;= <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span>;<br><br>    <span class="hljs-type">int</span> rounds = <span class="hljs-number">52</span> / num_dwords + <span class="hljs-number">6</span>;<br>    <span class="hljs-type">uint32_t</span> delta = <span class="hljs-number">0x3E9779B9</span> * rounds; <span class="hljs-comment">// 1050114489</span><br><br>    <span class="hljs-type">uint32_t</span> sum = delta;<br>    <span class="hljs-type">uint32_t</span> y = data[<span class="hljs-number">0</span>];<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; rounds; i++) &#123;<br>        <span class="hljs-type">uint32_t</span> e = (sum &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">3</span>;<br><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = num_dwords - <span class="hljs-number">1</span>; j &gt; <span class="hljs-number">0</span>; j--) &#123;<br>            <span class="hljs-type">uint32_t</span> z = data[j - <span class="hljs-number">1</span>];<br>            data[j] -= (((z &gt;&gt; <span class="hljs-number">5</span>) ^ (y &lt;&lt; <span class="hljs-number">2</span>)) + ((y &gt;&gt; <span class="hljs-number">3</span>) ^ (z &lt;&lt; <span class="hljs-number">4</span>))) ^ ((sum ^ y) + (tea_key[(j ^ e) &amp; <span class="hljs-number">3</span>] ^ z));<br>            y = data[j];<br>        &#125;<br><br>        <span class="hljs-type">uint32_t</span> z = data[num_dwords - <span class="hljs-number">1</span>];<br>        data[<span class="hljs-number">0</span>] -= (((z &gt;&gt; <span class="hljs-number">5</span>) ^ (y &lt;&lt; <span class="hljs-number">2</span>)) + ((y &gt;&gt; <span class="hljs-number">3</span>) ^ (z &lt;&lt; <span class="hljs-number">4</span>))) ^ ((sum ^ y) + (tea_key[e] ^ z));<br>        y = data[<span class="hljs-number">0</span>];<br><br>        sum -= <span class="hljs-number">0x3E9779B9</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// ä»DWORDæ•°ç»„æå–å­—ç¬¦ä¸²</span><br><span class="hljs-type">char</span>* <span class="hljs-title function_">extract_string</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span>* dwords, <span class="hljs-type">size_t</span> num_dwords, <span class="hljs-type">size_t</span> original_len)</span> &#123;<br>    <span class="hljs-type">char</span>* str =(<span class="hljs-type">char</span>*) <span class="hljs-built_in">malloc</span>(original_len + <span class="hljs-number">1</span>);<br>    <span class="hljs-built_in">memset</span>(str, <span class="hljs-number">0</span>, original_len + <span class="hljs-number">1</span>);<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; original_len; i++) &#123;<br>        <span class="hljs-type">uint32_t</span> dword = dwords[i &gt;&gt; <span class="hljs-number">2</span>];<br>        str[i] = (dword &gt;&gt; (<span class="hljs-number">8</span> * (i &amp; <span class="hljs-number">3</span>))) &amp; <span class="hljs-number">0xFF</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> str;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-comment">// æ­¥éª¤1: é€†make_blocks</span><br>    <span class="hljs-type">size_t</span> num_dwords;<br>    <span class="hljs-type">uint32_t</span>* tea_encrypted = unmake_blocks(encrypted_data, <span class="hljs-number">40</span>, &amp;num_dwords);<br><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;After unmake_blocks (%zu DWORDs):\n&quot;</span>, num_dwords);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; num_dwords; i++) &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;0x%08X &quot;</span>, tea_encrypted[i]);<br>    &#125;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n\n&quot;</span>);<br><br>    <span class="hljs-comment">// æ­¥éª¤2: å‡†å¤‡TEAå¯†é’¥ï¼ˆå°†å­—ç¬¦ä¸²è½¬æ¢ä¸º4ä¸ª32ä½æ•´æ•°ï¼‰</span><br>    <span class="hljs-type">uint32_t</span> tea_key[<span class="hljs-number">4</span>];<br>    <span class="hljs-built_in">memcpy</span>(tea_key, key, <span class="hljs-number">16</span>);<br><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;TEA Key:\n&quot;</span>);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i++) &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;0x%08X &quot;</span>, tea_key[i]);<br>    &#125;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n\n&quot;</span>);<br><br>    <span class="hljs-comment">// æ­¥éª¤3: é€†modifiedXXTeaè§£å¯†</span><br>    decrypt_tea(tea_encrypted, num_dwords, tea_key);<br><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;After TEA decryption:\n&quot;</span>);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; num_dwords; i++) &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;0x%08X &quot;</span>, tea_encrypted[i]);<br>    &#125;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n\n&quot;</span>);<br><br>    <span class="hljs-comment">// æ­¥éª¤4: æå–flagå­—ç¬¦ä¸²ï¼ˆåŸå§‹é•¿åº¦37å­—èŠ‚ï¼‰</span><br>    <span class="hljs-type">char</span>* flag = extract_string(tea_encrypted, num_dwords, <span class="hljs-number">37</span>);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Decrypted flag: %s\n&quot;</span>, flag);<br><br>    <span class="hljs-comment">// æ¸…ç†</span><br>    <span class="hljs-built_in">free</span>(tea_encrypted);<br>    <span class="hljs-built_in">free</span>(flag);<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
]]></content>
      <categories>
        <category>WriteUp&amp;å¤ç°</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>WriteUp</tag>
        <tag>Reverse</tag>
      </tags>
  </entry>
  <entry>
    <title>å‘¨è®°</title>
    <url>/2025/06/02/%E5%91%A8%E8%AE%B0/</url>
    <content><![CDATA[<p>ç®€å•è®°å½•æ¯å‘¨æ”¶è·</p>
<span id="more"></span>

<h2 id="week1-2025-3-4-2025-3-9"><a href="#week1-2025-3-4-2025-3-9" class="headerlink" title="week1 (2025.3.4-2025.3.9)"></a>week1 (2025.3.4-2025.3.9)</h2><ul>
<li>çœ‹åˆ°ç¾¤å‹è®²åˆ°å‘¨æŠ¥ï¼Œçµå…‰ä¸€é—ªè§‰å¾—å¯ä»¥å†™å†™å‘¨è®°æ¥è®°å½•è‡ªå·±çš„å­¦ä¹ ï¼Œä¹Ÿå½“ä½œä¸€ç§ç£ä¿ƒ</li>
<li>è¿™å‘¨ä¸»è¦å­¦ä¹ ææ‰¿è¿œè€å¸ˆçš„ã€Šé€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç†ã€‹ï¼ˆå»å¹´12æœˆå›¾ä¹¦é¦†å€Ÿçš„ï¼Œè¿™å‘¨æ‰æ­£å¼å¼€å§‹çœ‹ğŸ˜“ï¼‰</li>
<li>ä¸»è¦å­¦ä¹ äº†åŠ¨æ€è°ƒè¯•çš„åŸºç¡€æŠ€èƒ½ã€‚æœ‰ï¼š<ol>
<li>è°ƒè¯•å™¨çš„åŸºç¡€æ“ä½œï¼ŒæŸ¥æ‰¾ç›®æ ‡ä»£ç çš„æ–¹æ³•ï¼ˆå¹²æ‰¾ï¼Œå­—ç¬¦ä¸²æ£€ç´¢ï¼Œä¸‹æ–­ç‚¹ï¼ŒAPIæ£€ç´¢åŠä¸‹æ–­ç‚¹ï¼‰</li>
<li>æ‰“è¡¥ä¸patchä¿®æ”¹è¾“å‡ºçš„å­—ç¬¦ä¸²ï¼ˆç›´æ¥ä¿®æ”¹æˆ–è€…å¯¼å‘ä¿®æ”¹çš„NULLå¡«å……åŒºåŸŸï¼‰å¹¶å¯¼å‡ºæ–°çš„å¯æ‰§è¡Œæ–‡ä»¶</li>
<li>å­—èŠ‚åºã€å¯„å­˜å™¨åŸºç¡€</li>
<li>æ ˆã€æ ˆå¸§</li>
<li>å‡½æ•°è°ƒç”¨çº¦å®šï¼ˆcdeclï¼ˆè°ƒç”¨è€…å¤„ç†æ ˆï¼‰ã€stdcallï¼ˆè¢«è°ƒç”¨è€…å¤„ç†æ ˆï¼‰ã€fastcallï¼ˆåŒstdcallï¼Œä½†æ˜¯ç»“åˆäº†æ ˆå’Œå¯„å­˜å™¨ï¼‰ï¼‰</li>
</ol>
</li>
</ul>
<h2 id="week2-2025-3-10-2025-3-16"><a href="#week2-2025-3-10-2025-3-16" class="headerlink" title="week2 (2025.3.10-2025.3.16)"></a>week2 (2025.3.10-2025.3.16)</h2><ul>
<li>è¿™å‘¨ä¸»è¦å­¦ä¹ äº†PEæ–‡ä»¶ç»“æ„çš„å†…å®¹ï¼ŒåŒæ­¥æ›´æ–°äº†å­¦ä¹ ç¬”è®° ï¼Œä¸»è¦æ˜¯PEæ–‡ä»¶çš„åŸºæœ¬ç»„æˆä»‹ç»ï¼Œç†è®ºçŸ¥è¯†</li>
<li>å‘¨æœ«æœ¬æƒ³æ¥ç€ä¸‹ä¸€ç« çš„å­¦ä¹ ï¼Œä½†æ˜¯æ‘†å¤§çƒ‚äº†ï¼Œç”šè‡³PEç¬”è®°è¿˜æ²¡å†™å®Œ</li>
<li>ä¸‹å‘¨æœ«å°±æ˜¯NCTFäº†ï¼Œä¸€ç‚¹å‡†å¤‡æ²¡æœ‰ï¼Œè¦ç‚¸æ‰äº†</li>
</ul>
<h2 id="week3-2025-3-17-2025-3-23"><a href="#week3-2025-3-17-2025-3-23" class="headerlink" title="week3 (2025.3.17-2025.3.23)"></a>week3 (2025.3.17-2025.3.23)</h2><ul>
<li>è¿™å‘¨è¿‡å¾—åˆå¿™åˆä¸çŸ¥é“åœ¨å¿™ä»€ä¹ˆï¼ŒPEæ–‡ä»¶ç»“æ„æœ€åçš„EATéƒ¨åˆ†æ²¡çœ‹æ‡‚ï¼Œ(T_T)ï¼Œç¬”è®°è¿˜æ²¡è¡¥å®Œ</li>
<li>NCTFçˆ†é›¶äº†ï¼Œç¼–ç èƒ½åŠ›æ˜¯ç¡¬ä¼¤ï¼ŒçŸ¥è¯†æ›´æ˜¯ä¼¤ä¸ŠåŠ ä¼¤ (T_T)</li>
<li>å¥½äº†ï¼ŒçœŸæ˜¯ç³Ÿç³•çš„ä¸€å‘¨</li>
</ul>
<h2 id="week4-2025-3-24-2025-3-30"><a href="#week4-2025-3-24-2025-3-30" class="headerlink" title="week4 (2025.3.24-2025.3.30)"></a>week4 (2025.3.24-2025.3.30)</h2><ul>
<li>offlineä¸€å‘¨</li>
</ul>
<h2 id="week5-2025-3-31-2025-4-6"><a href="#week5-2025-3-31-2025-4-6" class="headerlink" title="week5 (2025.3.31-2025.4.6)"></a>week5 (2025.3.31-2025.4.6)</h2><ul>
<li>æƒ³äº†æƒ³ï¼Œå‘ç°è‡ªå·±ä¸€ç›´å­˜åœ¨ä¸€ä¸ªé”™è¯¯ï¼Œå°±æ˜¯ä¸ºäº†ç¬”è®°è€Œåšç¬”è®°ï¼Œçº¯ç²¹çš„æ˜¯è®°å½•ï¼›ä½†æ˜¯å¥½åƒä»¥æ€»ç»“æˆ–è€…è¯´å¤è¿°çš„æ–¹å¼æ¥åšç¬”è®°æ‰æ¯”è¾ƒæœ‰ç”¨</li>
<li>è¿™å‘¨ç¢°ä¸Šæ¸…æ˜äº†ï¼Œæœ‰ä¸ªä¸‰å¤©å‡ã€‚è™½ç„¶ä½†æ˜¯ï¼Œä¾æ—§æ˜¯æ²¡æ€ä¹ˆå­¦æ–°ä¸œè¥¿</li>
<li>ä½†æ˜¯è‡³å°‘æ˜¯åšäº†ç‚¹ä»€ä¹ˆã€‚å‘¨æ—¥æŠŠPEæ–‡ä»¶æ ¼å¼æ”¶å°¾äº†ï¼ˆè¿˜æ˜¯æœ‰ç‚¹éš¾åº¦çš„ï¼Œå› ä¸ºå›å¤´çœ‹äº†å‰é¢åšçš„ç¬”è®°ï¼Œå‘ç°å¯¹IATå’ŒEATçš„è®¤è¯†æœ‰ç‚¹ä¸å¯¹åŠ²ï¼Œé‡æ–°æ¢³ç†äº†ä¸€éï¼Œåˆ åˆ æ”¹æ”¹ï¼‰ã€‚å­¦èªæ˜äº†ï¼Œè¿™æ¬¡æ˜¯çœ‹å®Œä¹¦å®Œæ•´åœ°æŠŠä¾‹å­å…ˆèµ°äº†ä¸€éå†åšçš„ç¬”è®°</li>
<li>è¿™å‘¨åœ¨å’¸é±¼2å…ƒæ·˜åˆ°äº†ä¸€åŒ…è¯¾ï¼Œåé¢å‘ç°é‡Œé¢æœ‰ä¸€å¥—è¯¾ä½“ç³»æŒºå®Œæ•´çš„ï¼Œä¹Ÿæ˜¯æœ‰è¯¾è·Ÿäº†</li>
<li>è¿˜æœ‰å°±æ˜¯å°è¯•äº†è‡ªå·±å†™pythonè§£å¯†è„šæœ¬ï¼Œå‘ç°æ²¡ä½“ç³»å­¦è¿‡ä¸€éçœŸä¸èƒ½ç¡¬ä¸Š</li>
</ul>
<h2 id="week6-2025-4-7-2025-4-13"><a href="#week6-2025-4-7-2025-4-13" class="headerlink" title="week6 (2025.4.7-2025.4.13)"></a>week6 (2025.4.7-2025.4.13)</h2><ul>
<li>è¿™å‘¨æ‰¾äº†ä¸ªçŸ­ä¸€äº›çš„pythonè§†é¢‘ï¼Œè·Ÿç€è¿‡äº†ä¸€éï¼Œç„¶åè¯•ç€åšé¢˜å†™è„šæœ¬ï¼Œæ‚¨çŒœæ€ä¹ˆç€ï¼Œè¿˜æ˜¯ä¸å¤ªä¼šğŸ¤¡</li>
<li>è§£å¯†å®åœ¨æ˜¯å¤ªåƒæ“ä½œäº†ï¼Œç»†ç»†ä¸€æƒ³ï¼Œå¥½åƒè§£å¯†è¿™ç©æ„æ›´åƒæ•°å­¦ï¼Œä¸€ä¸ªå–æ¨¡é€†å‘DSç›´æ¥ä¸Šå…¬å¼ï¼Œæˆ‘è¿˜åœ¨å¾ªç¯çˆ†ç ´è¢«é™¤æ•°ğŸ¤¡</li>
<li>ä¸å¾—ä¸æ‹¿å‡ºå››å­—çœŸè¨€ï¼šèœå°±å¤šç»ƒã€‚æ‰€ä»¥ï¼Œè¿™å‘¨å°±è¯•ç€åˆ·é¢˜æ¥äº†</li>
<li>èŠ‚å¥è¿˜æ˜¯æ…¢äº†ç‚¹ï¼Œå”‰</li>
</ul>
<h2 id="week7-2025-4-14-2025-4-20"><a href="#week7-2025-4-14-2025-4-20" class="headerlink" title="week7 (2025.4.14-2025.4.20)"></a>week7 (2025.4.14-2025.4.20)</h2><ul>
<li>emmmæ€ä¹ˆè¯´ï¼Œè¿™å‘¨å‰é¢å‡ å¤©å€’æ˜¯æŠ½æ—¶é—´åˆ·é¢˜äº†ï¼Œä½†æ˜¯ä¸€åˆ°å‘¨æœ«ï¼Œæ˜æ˜¾æ„Ÿåˆ°æ‡’äº†</li>
<li>å‘¨ä¸‰èŠ±äº†ä¸€ä¸ªä¸‹åˆææ˜ç™½é‡å®šä½è¡¨ï¼Œç¬”è®°å†™äº†ï¼Œä½†æ˜¯åˆ‡å…¥ç‚¹å¥½åƒä¸æ˜¯å¾ˆå¯¹ã€‚è¿™æ¬¡çš„ç¬”è®°ï¼Œå› ä¸ºå‚è€ƒäº†DSç»™çš„è¾…åŠ©è®²è§£ï¼Œæ‰€ä»¥è·Ÿå‰é¢çš„æœ‰ç‚¹ä¸ä¸€æ ·ã€‚æ„Ÿè§‰ç”¨å½¢è±¡çš„ä¾‹å­æ¥ç±»æ¯”ä»¥åŠä»è®¾è®¡è€…è§’åº¦æè¿°ç»†èŠ‚ï¼Œæ›´æœ‰åˆ©äºåæœŸå¤ä¹ å†ç†è§£</li>
<li>è¿˜æ˜¯æ„Ÿè§‰æ•ˆç‡ä¸Šä¸æ¥ğŸ¤”ï¼Œæˆ‘åœ¨æƒ³è¦ä¸ç„¶å…ˆè·Ÿè¯¾èµ°ï¼Œä¸æ‡‚çš„åœ°æ–¹å†çœ‹ä¹¦ï¼Œä¼šä¸ä¼šå­¦çš„æ¸…æ¥šä¸€ç‚¹ï¼Œçœçš„è€å•ƒä¸€å¤„</li>
<li>æœ¬æ¥æ‰“ç®—å‘¨æœ«æ¥ä¸ªè„±å£³ç»ƒä¹ çš„ï¼Œé¸½äº†ï¼ˆï¼›Â´Ğ´ï½€ï¼‰ã‚</li>
</ul>
<h2 id="week8-2025-4-21-2025-4-27"><a href="#week8-2025-4-21-2025-4-27" class="headerlink" title="week8 (2025.4.21-2025.4.27)"></a>week8 (2025.4.21-2025.4.27)</h2><ul>
<li>è¿™å‡ å¤©å›¾åºŠå´©äº†ï¼Œå›¾ç‰‡ä¸Šä¼ ä¸äº†ï¼Œä¹‹å‰çš„å›¾åœ¨åšå®¢é‡Œä¹Ÿæœ‰ç‚¹æ˜¾ç¤ºä¸å‡ºæ¥ï¼Œæ‰¾äº†å¥½ä¹…æ²¡æ‰¾åˆ°é—®é¢˜åœ¨å“ªé‡Œï¼Œåªèƒ½ä¼ åˆ°æœ¬åœ°å’Œå…¶ä»–æ–‡ä»¶ä¸€èµ·æ‰“åŒ…ä¼ githubäº†</li>
<li>äº”ä¸€è°ƒä¼‘ä½¿æˆ‘æœ¬å°±çŸ­æš‚çš„å‘¨æœ«æ›´åŠ çŸ­æš‚ï¼ˆè™½ç„¶ç›®å‰ä¸ºæ­¢å‘¨æœ«è¿˜æ²¡æœ‰è¢«æˆ‘çœŸæ­£åˆ©ç”¨è¿‡ï¼‰ï¼Œè¿™å‘¨æ‹¿å¾—å‡ºæ‰‹çš„å°±åªæ˜¯ä¸€é“é¢˜ç›®</li>
<li>emâ€¦å®é™…ä¸Šè¿™å‘¨èŠ±äº†ä¸å°‘æ—¶é—´æè„±å£³ç»ƒä¹ çš„ç¯å¢ƒã€‚ä¹°çš„è¯¾é‡Œå¤´è€å¸ˆè¯´ç”¨vs2008ç»ƒä¹ ï¼Œä½†æ˜¯è¯¥æ­»çš„è™šæ‹Ÿæœºæ²¡è”ç½‘å¾—è‡ªå·±å®‰è£…netframeworkï¼Œè¿™å°±èŠ±äº†ä¸å°‘æ—¶é—´ï¼Œä»¥åŠçµæœºä¸€åŠ¨æŠŠç¯å¢ƒæ­åœ¨win11ä¸Šäº†ï¼Œè¿™åˆèŠ±äº†ä¸€ç‚¹æ—¶é—´ã€‚è¿˜æœ‰ä¸€ç‚¹æ—¶é—´å°è¯•ç”¨è‡ªå·±å†™çš„ç¨‹åºåŠ å£³è„±å£³ï¼Œä½†æ˜¯æ²¡æŠ˜è…¾æˆåŠŸã€‚</li>
<li>è¿˜æœ‰ï¼Œæˆ‘æœ‰ç‚¹æ€€ç–‘è¿™ä¸ªè€å¸ˆçš„æˆåˆ†äº†ï¼Œä¸€å£ä¸€ä¸ªæŠ›ç –å¼•ç‰ï¼Œä¸€å£ä¸€ä¸ªè‡ªå·±çœ‹ï¼ˆæˆ‘è¦æ˜¯è‡ªå·±ä¼šå­¦è¿˜çœ‹è¯¾å¹²ä»€ä¹ˆï¼‰ğŸ« ã€‚ä½†æ˜¯æ‰¾ä¸åˆ°æ¯”ä»–çš„è¯¾æ›´å®Œæ•´çš„winé€†å‘èµ„æºäº†ğŸ˜”</li>
</ul>
<h2 id="week9-2025-4-28-2025-5-4"><a href="#week9-2025-4-28-2025-5-4" class="headerlink" title="week9 (2025.4.28-2025.5.4)"></a>week9 (2025.4.28-2025.5.4)</h2><ul>
<li>è¿™å‘¨ç¢°ä¸Šäº†å®éªŒå‘¨å’Œäº”ä¸€å‡æœŸï¼Œçœ‹ä¼¼ç©ºé—²æ—¶é—´å¾ˆå¤šï¼Œä½†å®é™…ä¸Šå¹¶éå¦‚æ­¤<del>ï¼ˆå€Ÿå£</del></li>
<li>CSå•Šï¼Œä¸‰å¤©é€Ÿé€šæ•°å­¦å®éªŒï¼Œè¿˜è¦å†™è€åšä¸€æœ¬çš„å®éªŒæŠ¥å‘Šï¼Œç”šè‡³æŠ¥å‘Šè¿˜åŒ…æ‹¬ä¸¤ç¯‡è®ºæ–‡ï¼Œç¦»è°±äº†ğŸ« </li>
<li>å¥½çš„ï¼Œçœ‹æ¥è¿™å‘¨ä¾æ—§æ˜¯æ²¡ä»€ä¹ˆå­¦ä¹ æ”¶è·çš„ä¸€å‘¨ã€‚<del>é™¤äº†å•å¼€äº†ä¸€ä¸ªIDAproçš„å­¦ä¹ ç¬”è®°ï¼ˆå››å¤„ç¢°å£åªèƒ½å­¦å­¦å·¥å…·çš„ä½¿ç”¨äº†ï¼‰</del></li>
</ul>
<h2 id="week10-2025-5-5-2025-5-11"><a href="#week10-2025-5-5-2025-5-11" class="headerlink" title="week10 (2025.5.5-2025.5.11)"></a>week10 (2025.5.5-2025.5.11)</h2><ul>
<li>è¿™å‘¨æŠ˜è…¾ç”µè£…å®ä¹ å’Œæ•°å­¦å®éªŒï¼Œè¿˜è¦å¤ä¹ å¤§ç‰©å’Œé«˜æ•°ï¼Œå¿™æ­»äº†ï¼Œå”‰</li>
</ul>
<h2 id="week11-2025-5-12-2025-5-18"><a href="#week11-2025-5-12-2025-5-18" class="headerlink" title="week11 (2025.5.12-2025.5.18)"></a>week11 (2025.5.12-2025.5.18)</h2><ul>
<li>è¯¶ï¼Œæµ…æ‘†ä¸€å‘¨</li>
</ul>
<h2 id="week12-2025-5-19-2025-5-25"><a href="#week12-2025-5-19-2025-5-25" class="headerlink" title="week12 (2025.5.19-2025.5.25)"></a>week12 (2025.5.19-2025.5.25)</h2><ul>
<li>å¿«æœŸæœ«æœˆäº†å•Šï¼Œå“å‘€ï¼Œä¸€å­¦æœŸåˆè¦è¿‡å»äº†</li>
<li>å¼€å§‹æœ‰ç‚¹è€ƒè¯•å‰çš„ç´§å¼ æ„Ÿäº†ï¼Œè¿™å‘¨ä¸»è¦æ‹¿æ¥æå­¦ä¸šäº†ï¼Œå¤§ç‰©ã€é«˜æ•°ã€ç”µå·¥æ¨¡ç”µè¿˜æœ‰å…­çº§å¤šæ‰‹æŠ“ğŸ™ƒ</li>
<li>è¯¶ï¼Œä½†æ˜¯ä¼˜åŒ–äº†ä¸€ä¸‹åšå®¢çš„ç•Œé¢ï¼ŒæŠ˜è…¾äº†å¿«æœ‰ä¸‰å¤©æ—¶é—´ã€‚ä¸»è¦å°±æ˜¯ç»™ä¸»é¡µæ”¹æˆäº†åˆ†ç±»å¡ç‰‡ï¼Œä¸‹ä¸€çº§æ‰æ˜¯æ–‡ç« ï¼Œè¿™æ ·å­ç»“æ„æ›´æ¸…æ™°ä¸€ç‚¹ã€‚è¿˜æœ‰ä¸€äº›å°åœ°æ–¹çš„ç¾åŒ–ï¼Œä»¥åŠé˜…è¯»æ¬¡æ•°ç»Ÿè®¡çš„é—®é¢˜ï¼ˆä»leancloudå›½å†…ç‰ˆåˆ°ä¸è’œå­åˆ°leancloudå›½é™…ç‰ˆåˆå›åˆ°leancloudå›½å†…ç‰ˆâ€¦å“‡ï¼Œçœ‹æ¥æˆ‘å’ŒDSè€å¸ˆçš„åè°ƒèƒ½åŠ›è¿˜ä¸æ˜¯å¾ˆå¥½ï¼Œæ¯•ç«Ÿå…‰è¿™ä¸€é¡¹å°±è¦äº†å·®ä¸å¤š1å¤©æ—¶é—´ğŸ™ƒå¤´éƒ½å¤§äº†ï¼‰</li>
<li>æœ¬æ¥æ‰“ç®—å‘¨æœ«æŠŠæ²¡è·Ÿä¸Šçš„è¯¾ä¸šè¡¥ä¸Šï¼Œä½†æ˜¯ä¼˜åŒ–åšå®¢å°±å äº†å‘¨å…­ä¸€ä¸ªä¸Šåˆï¼Œå‘¨å…­ä¸€ä¸ªä¸‹åˆæé‚£ä¸ªC++æ…•è¯¾ï¼ˆä¸å½“äººå•Šï¼Œé¢˜ç›®è®©ç›´æ¥å¤åˆ¶çš„è¾“å‡ºå®ç°ä»£ç å’Œè¾“å‡ºè¦æ±‚ä¸€æ¨¡ä¸¤æ ·ï¼‰ï¼Œä½†æ˜¯æˆ‘è¿˜æœ‰é«˜æ•°å¤§ç‰©ç‰¹åˆ«æ˜¯æ¨¡ç”µå’Œå…­çº§ä»¥åŠè¿˜æœ‰ä¸ªç”µè£…å®ä¹ æŠ¥å‘Šå’Œç‰©ç†å®éªŒæŠ¥å‘Šï¼Œå‹åŠ›éƒ½ç»™åˆ°å‘¨æ—¥ï¼Œå¯æƒ³è€ŒçŸ¥</li>
<li>è¿˜æœ‰ä¸€ä»¶äº‹ï¼Œè¿™å‘¨é€®ç©ºçœ‹äº†çœ‹helloç®—æ³•ï¼ˆå°±æ˜¯è¿™ä¸ªï¼š<a href="https://www.hello-algo.com/chapter_hello_algo/">https://www.hello-algo.com/chapter_hello_algo/</a> ï¼Œä¸Šå­¦æœŸå›¤ä¸‹æ¥çš„èµ„æºï¼‰æœ€è¿‘åˆšå¥½ä¹°çš„è¯¾é‡Œå¤´è®²Cå’ŒC++çš„æ—¶å€™æåˆ°äº†æ•°æ®ç»“æ„ï¼Œä½†æ˜¯å®åœ¨æ‰¾ä¸åˆ°æ—¶é—´çœ‹è§†é¢‘ï¼Œå°±åªèƒ½çœ‹çœ‹ä¹¦äº†ã€‚å“‡ï¼ŒU1S1æ˜¯çœŸä¼˜è´¨èµ„æ–™å•Šã€‚å›å¤´çœ‹çœ‹å†åŠ ä¸€ä¸ªæ•°æ®ç»“æ„ä¸ç®—æ³•çš„åˆ†ç±»ï¼Œåæ­£ä¸‹å­¦æœŸå¥½åƒä¹Ÿè¦å­¦äº†</li>
<li>å…¶å®è¿˜æœ‰ç‚¹äº‹æƒ…ï¼Œå†™è¿™ä¸ªåšå®¢çš„åˆå¿ƒå…¶å®ä¸æ˜¯ä»€ä¹ˆè®°å½•æ”¶è·ï¼Œè€Œæ˜¯å› ä¸ºæˆ‘æ²¡æœ‰æ‰¾åˆ°å¯ä»¥å­¦ä¹ æ•ˆä»¿çš„å¯¹è±¡ï¼Œçœ‹å¤§ä½¬çš„åšå®¢éƒ½æ˜¯æ›´æ–°çŸ¥è¯†ï¼Œå¾ˆå°‘æœ‰äººæåˆ°ä¸ºä»€ä¹ˆä¼šæƒ³åˆ°å»å­¦è¿™äº›çŸ¥è¯†ï¼Œå°±æ˜¯ï¼Œæ²¡äººä¼šå‘Šè¯‰ä½ ä¸‹ä¸€æ­¥è¯¥å¹²ä»€ä¹ˆï¼ŒçŸ¥è¯†é‚£ä¹ˆå¤šå´åˆæ‰¾ä¸åˆ°å­¦ä¹ çš„æ–¹å‘ï¼Œå°±æ˜¯è¿™ç§æ„Ÿè§‰ã€‚æ‰€ä»¥æƒ³è®°å½•è®°å½•è‡ªå·±çš„å­¦ä¹ ç»å†ï¼Œæ–¹ä¾¿æ¢³ç†å­¦ä¹ è·¯çº¿ï¼Œä¹Ÿå¸Œæœ›å¤šå°‘å¯ä»¥ç»™å°†æ¥åƒæˆ‘ä¸€æ ·è¿·èŒ«çš„äººä¸€äº›æŒ‡å¼•ã€‚</li>
<li>å…¶å®å¼€å§‹å­¦ä¹ çš„æ—¶å€™ï¼Œæˆ‘ä¼šæ—¶ä¸æ—¶å»çœ‹çœ‹åŒçº§çš„å¤§ä½¬çš„åšå®¢ï¼Œçœ‹åˆ°ä»–ä»¬æ›´æ–°çš„éƒ½æ˜¯æˆ‘æ²¡æœ‰å¬è¯´è¿‡çš„çŸ¥è¯†ï¼Œçœ‹ç€ä»–ä»¬å˜å¾—è¶Šæ¥è¶Šä¸“ä¸šè¶Šæ¥è¶Šå‰å®³ï¼Œé•¿ä¹…ä¸‹æ¥å¿ƒé‡Œå¾ˆä¸æ˜¯æ»‹å‘³ã€‚é«˜ä¸­æ—¶å€™é‚£ç§æ— åŠ›æ„Ÿå°±åˆå‡ºç°äº†ã€‚åæ¥æˆ‘å°±éšçº¦è§‰å¾—ä¸å¯¹åŠ²ï¼Œè¿™ä¸å°±æŠŠå¤§å­¦åˆè¿‡æˆé«˜ä¸­äº†å—ï¼Ÿâ€œæ¯”è¾ƒçš„ç»ˆç‚¹æ˜¯è‡ªå‘ï¼Œä¸“æ³¨çš„ç»ˆç‚¹æ˜¯è‡ªç”±â€ï¼Œæƒ³æƒ³å½“åˆæƒ³å­¦ä¿¡å®‰ä¸å°±æ˜¯å› ä¸ºå–œæ¬¢å—ï¼ˆè™½ç„¶é‚£æ—¶å€™ç¡®å®ä¸çŸ¥é“å…·ä½“å¾—å­¦ä»€ä¹ˆï¼‰ï¼Œä¸ºä»€ä¹ˆè¦å’Œåˆ«äººæ¯”å‘¢ï¼Ÿé«˜ä¸­çš„æ—¶å€™æˆ‘æ€»æ˜¯åˆ»æ„ä¸èå…¥æ¯”è¾ƒçš„æ°›å›´ï¼Œè€Œç°åœ¨æ²¡æœ‰äº†é‚£æ ·åšé‡çš„å­¦ä¹ ç¯å¢ƒï¼Œæˆ‘å´ä¸è‡ªè§‰å¼€å§‹æ¯”è¾ƒèµ·æ¥äº†ï¼Œå”‰ğŸ˜”æ‰€ä»¥è¿™äº›å¤©å…¶å®ä¸€ç›´åœ¨è°ƒæ•´è‡ªå·±çš„å¿ƒæ€ï¼Œå¥½åœ¨ç°åœ¨æˆ‘æ„Ÿè§‰æ…¢æ…¢åœ°ä¸å†é¢‘ç¹ç«™åœ¨å¤–ç•Œå»å®¡è§†è‡ªå·±äº†ï¼Œå¼€å§‹è§‰å¾—æ¯å¤©èƒ½çœ‹è§é˜³å…‰ã€èƒ½å¤Ÿåœ¨æ™šè‡ªä¹ ä¸Šä¸‹è¯¾çš„è·¯ä¸Šè¾¹å¬æ­Œè¾¹èµ°è·¯ã€<del>èƒ½å¤Ÿå®ç°å¼•ä½“å‘ä¸Šæ‹‰0ä¸ªåˆ°æ‹‰6ä¸ªï¼ˆå°½ç®¡æ˜¯åœ¨æœ‰å¼¹åŠ›å¸¦è¾…åŠ©çš„æƒ…å†µä¸‹ã€</del>èƒ½å¤Ÿåœ¨ç¤¾å›¢çš„å®£è®²æ´»åŠ¨ä¸Šæ‰¿æ‹…ä¸€éƒ¨åˆ†å‘è¨€çš„è´£ä»»â€¦â€¦è¿™äº›éƒ½è®©æˆ‘çš„ç”Ÿæ´»å˜å¾—è¶Šæ¥è¶Šç¾å¥½ã€‚è¿™å¯èƒ½å°±æ˜¯çŸ¥è¶³å¸¸ä¹çš„æ„Ÿè§‰å§ï¼Œåæ­£æ´»å¾—æ›´å¼€å¿ƒäº†ï¼Œä¹Ÿæ›´æœ‰è¡ŒåŠ¨çš„èƒ½é‡äº†ï¼Œä¹ŸæŒºå¥½</li>
<li>ä»Šå¤©çš„å­—æ•°æœ‰ç‚¹è¶…æ ‡äº†å“ˆå“ˆğŸ˜„ä½†æ˜¯ä¸ç®¡äº†</li>
<li>æ¥ä¸‹æ¥ä¸€ä¸ªæœˆå¤šä¸çŸ¥é“ä¼šä¸ä¼šè¿˜æœ‰æœºä¼šæ›´æ–°ç‚¹çŸ¥è¯†ç¬”è®°ï¼Œä½†æ˜¯å¸Œæœ›æš‘å‡å¯ä»¥å¥½å¥½å­¦å­¦å§<del>ï¼ˆæ±‚æ±‚æˆ‘è‡ªå·±äº†</del></li>
<li>æ—¢ç„¶æåˆ°äº†å­¦ä¹ è·¯çº¿ï¼Œè¦ä¸ç„¶è¿™é‡Œæ¢³ç†ä¸€æ®µå§ï¼Œå…¶å®æœ‰äº›ä¸œè¥¿æ²¡è®°ä¸Šæ¥ã€‚åˆšå¼€å§‹æ˜¯ä»ã€Šé€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç†ã€‹å¼€å§‹å­¦çš„ï¼Œä½†æ˜¯å­¦äº†å¿«ä¸€ä¸ªæœˆæ„Ÿè§‰æ•ˆç‡ä¹Ÿä¸è¡Œå•Šï¼Œåé¢å¼€å§‹æ‰¾è¯¾ï¼Œæ‰¾åˆ°äº†ä¸€ä¸ªå…¨è·¯çº¿çš„è¯¾ï¼ˆç›®å½•é‡Œæ˜¯åŒ…å«äº†æ¸—é€æµ‹è¯•å’Œé€†å‘å…æ€çš„ï¼‰ä½†æ˜¯æ„Ÿè§‰é€†å‘é‚£éƒ¨åˆ†è€å¸ˆæœ‰ç‚¹æ··å•Šï¼Œä¸Šè¯¾å°±å±•ç¤ºç¬”è®° ï¼Œè¯´è¯ä¹Ÿå«å«ç³Šç³Šçš„ï¼Œè¿˜æ—¶ä¸æ—¶æ¥å¥ä¸»è¦æ˜¯æŠ›ç –å¼•ç‰ï¼Œå°±æ„Ÿè§‰è¿™æ ·ä¸‹æ¥ä¹Ÿå­¦å¾—è¿·è¿·ç³Šç³Šçš„ï¼Œæ‰€ä»¥åˆå»æ‰¾æ–°çš„è¯¾ã€‚ç°åœ¨æ˜¯æ‰¾åˆ°äº†å¦å¤–ä¸¤å¥—ï¼Œä¸€å¥—æ˜¯windowså†…æ ¸å®‰å…¨ï¼Œä¸€å¥—æ˜¯çº¢é˜Ÿå…æ€ï¼ˆä¸¤å¥—è¯¾åŒä¸€å®¶æœºæ„çš„ï¼Œ<del>jayx</del>ï¼‰ï¼Œè¿™ä¸ªä½“ç³»æ„Ÿè§‰ä¹Ÿå¾ˆæ¸…æ™°ï¼Œè€å¸ˆè®²è¯¾ï¼ˆè‡³å°‘çœ‹äº†å‡ èŠ‚è¯¾ä¸‹æ¥ï¼‰å€’ä¹Ÿæ¸…æ¥šï¼Œå®è·µä¸ºä¸»ã€‚æ‰€ä»¥ç°åœ¨ç¡®å®šä¸‹æ¥æ˜¯è·Ÿç€æœ€æ–°çš„ä¸¤å¥—å­¦ã€‚åé¢å¯èƒ½ä¼šè€ƒè™‘æ”¹æ”¹ä¹‹å‰è®°çš„ç¬”è®°ã€‚</li>
<li>å•Šå¯¹äº†ï¼Œè¿˜å¾—ç‹¡è¾©ä¸€ä¸‹ã€‚æˆ‘å‘ç°week2å¼€å§‹å°±ä¸æ˜¯è®°å½•æ”¶è·äº†ï¼Œåƒæ˜¯æŠ¥å¤‡å¹²äº†ä»€ä¹ˆğŸ˜„å…¶å®ä¹Ÿæ²¡ä»€ä¹ˆå†™çš„ï¼Œå› ä¸ºè¿˜åœ¨æ‘¸ç´¢ã€‚</li>
</ul>
<h2 id="week13-2025-5-26-2025-6-1"><a href="#week13-2025-5-26-2025-6-1" class="headerlink" title="week13 (2025.5.26-2025.6.1)"></a>week13 (2025.5.26-2025.6.1)</h2><ul>
<li>è¿™å‘¨æœ¬æ¥æ˜¯è¯•ç€æŠŠåšå®¢éƒ¨ç½²åˆ°vercelä¸Šæ–¹ä¾¿å›½å†…è®¿é—®çš„ï¼ˆDeepSeekè¯´å¯ä»¥çš„ï¼‰ï¼Œä½†æ˜¯æ²¡æŠ˜è…¾æ˜ç™½ï¼Œæ‰€ä»¥æœ¬æ¥æ²¡æ‰“ç®—å†™ä»€ä¹ˆçš„ã€‚ç»“æœï¼Œå‘¨æ—¥æ™šä¸Š11ç‚¹å¤šæ‰“å¼€åšå®¢æ–‡ä»¶å¤¹ï¼Œå‘ç°æœ‰ç‚¹ä¸å¯¹åŠ²ï¼Œä¸€è®¿é—®ï¼Œåšå®¢å´©äº†ğŸ˜…</li>
<li>åƒé”™ä¸‡é”™å°±ä¸è¯¥é”™åœ¨ä»€ä¹ˆéƒ½ä¸æ‡‚è¿˜è·Ÿç€DeepSeekèµ°ï¼Œå“‡ï¼ŒçœŸçš„ï¼Œéš¾ä»¥æè¿°è¿™ç§æ„Ÿè§‰ï¼Œå…‰è¿™ç¯‡å‘¨è®°å°±æœ‰77å¤©äº†å•Šï¼ŒğŸ˜…</li>
<li>è¿™æ®µè¯å…¶å®æ˜¯6.2å†™çš„ï¼Œå‘¨æ—¥æ™šä¸Šä¿®åšå®¢ä¿®åˆ°1ç‚¹ï¼Œå°è¯•ä¿®å¤ä½†æ˜¯è¡Œä¸é€šğŸ˜…</li>
<li>å“‡ï¼Œè¿™ä¸ªäººå·¥æ™ºèƒ½ï¼Œå®ƒæ•™æˆ‘ç”¨rm rfï¼Œè™½ç„¶ä¸æ˜¯windowsçš„æŒ‡ä»¤ï¼Œä½†æ˜¯å®ƒèƒ½åœ¨æ•™ç¨‹é‡Œç”¨ä¸Šè¿™æ ·çš„æŒ‡ä»¤ï¼Œå“‡ï¼ŒçœŸçš„ï¼ŒçœŸæ˜¯è¿™ä¸ªğŸ‘ã€‚æˆ‘çœŸçš„ï¼Œå“‡ï¼Œè¦æ— è¯­æ­»äº†</li>
<li>6.2å°±æŠ˜è…¾ä¸€å¤©çš„åšå®¢ï¼ŒæŠŠåŸæ¥çš„åšå®¢åºŸæ‰äº†ï¼Œé‡æ„äº†ä¸€ä¸ªã€‚å“‡ï¼Œä¸€æœæ•™ç¨‹ï¼Œå’Œå½“åˆåˆšå¼€å§‹æåšå®¢æ—¶çœ‹åˆ°çš„å®Œå…¨ä¸ä¸€æ ·äº†ï¼Œä¸‹ä¸‹æ¥çš„NexTè¿˜æ˜¯æ–°ç‰ˆçš„ï¼Œé…ç½®å˜äº†ä¸æ˜¯ä¸€ç‚¹ï¼Œå“‡ğŸ˜…</li>
<li>åƒä¸€å ‘é•¿ä¸€æ™ºäº†ï¼Œä»¥åæ‰¾æ•™ç¨‹ä¸å…ˆæœåˆ«äººå†™çš„ç›´æ¥é—®AIæˆ‘å°±æ˜¯è¿™ä¸ªğŸ‘</li>
</ul>
<h2 id="week14-2025-6-2-2025-6-8"><a href="#week14-2025-6-2-2025-6-8" class="headerlink" title="week14 (2025.6.2-2025.6.8)"></a>week14 (2025.6.2-2025.6.8)</h2><ul>
<li>OKï¼Œè¿™å‘¨ä¸»è¦ä»»åŠ¡å°±æ˜¯é‡æ–°æ­äº†ä¸€ä¸ªåšå®¢ã€‚åšå®¢å»ºäº†åŠå¹´äº†ï¼Œéƒ½å¿˜äº†æ€ä¹ˆå»ºèµ·æ¥çš„äº†ï¼Œé‡æ­å»æ‰¾æ•™ç¨‹ï¼Œæœå‡ºæ¥çš„ç»“æœå’Œå°è±¡é‡ŒåŠå¹´å‰çš„è¿˜ä¸ä¸€æ ·ï¼Œè¿­ä»£é€Ÿç‡çœŸå¿«å•Š</li>
<li>å¥½åœ¨æ—§çš„åšå®¢æ²¡æœ‰å…¨æ¯ï¼Œåœ¨æ®‹å­˜çš„nextæ–‡ä»¶é‡Œæ‰¾åˆ°äº†ä¸€äº›è¿˜èƒ½æŠ„çš„é…ç½®</li>
<li>æ‰åŠå¹´NexTéƒ½æ›´æ–°åˆ°8.23äº†ï¼Œè¯„è®ºç³»ç»Ÿå’Œè®¿å®¢ç³»ç»Ÿå˜äº†ä¸å°‘ï¼Œè€é…ç½®ç”¨ä¸ä¸Šåªèƒ½æ¢æ–°çš„é…ç½®äº†</li>
<li>å®Œäº†éƒ½æ²¡ä»€ä¹ˆå¯ä»¥å†™çš„äº†</li>
<li>é¢„è®¡æ¥ä¸‹æ¥å‡ å‘¨å°±ä¸ä¼šæœ‰ä»€ä¹ˆå†…å®¹äº†ï¼Œé©¬ä¸Šå°±æ˜¯æœŸæœ«å‘¨äº†ã€‚å”‰ï¼Œå¤§å¤§å°å°çš„ä½œä¸šæŠ¥å‘Šè€ƒè¯•åˆæ¥äº†ğŸ« </li>
</ul>
<h2 id="week15-16-17-2025-6-9-2025-6-29"><a href="#week15-16-17-2025-6-9-2025-6-29" class="headerlink" title="week15,16,17 (2025.6.9-2025.6.29)"></a>week15,16,17 (2025.6.9-2025.6.29)</h2><ul>
<li>æœŸæœ«æœˆæ–­æ›´</li>
</ul>
<h2 id="week18-2025-6-30-2025-7-6"><a href="#week18-2025-6-30-2025-7-6" class="headerlink" title="week18 (2025.6.30-2025.7.6)"></a>week18 (2025.6.30-2025.7.6)</h2><ul>
<li>OKï¼Œä¹Ÿæ˜¯è€ƒå®Œè¯•äº†ã€‚å›å®¶ä¸¤å¤©ä¹Ÿæ˜¯é—²é‡Œå·å¿™åœ°çœ‹äº†ä¸€ç‚¹è¯¾</li>
<li>æ¥ä¸‹æ¥çœ‹çœ‹èƒ½ä¸èƒ½æŒç»­æ›´ä¸ªå‡ åå¤©ï¼Œæˆ‘å·²ç»â€œè®¡åˆ’â€å¥½äº†ä¸€äº›è¦æ›´çš„å†…å®¹äº†ï¼Œèƒ½ä¸èƒ½æ›´æˆå°±çœ‹æˆ‘è‡ªå·±äº†ï¼ˆ</li>
</ul>
<h2 id="week19-2025-7-7-2025-7-13"><a href="#week19-2025-7-7-2025-7-13" class="headerlink" title="week19 (2025.7.7-2025.7.13)"></a>week19 (2025.7.7-2025.7.13)</h2><ul>
<li>è¿™å‘¨å¼€å§‹å­¦ä¹ åŸºç¡€ä¸€ç‚¹çš„çŸ¥è¯†ï¼Œä¸»è¦æ˜¯æ±‡ç¼–ã€‚ä¸‹å‘¨åº”è¯¥æ˜¯ç¨‹åºé€†å‘åŸºç¡€çš„ä¸œè¥¿äº†ã€‚</li>
<li>ç¬”è®°æœ‰ç‚¹ä¹±ã€‚è¿™å‘¨ä¸»è¦å›´ç»•æ±‡ç¼–ï¼Œå­¦ä¹ äº†ä¸åŒæ¶æ„ä¸åŒæ¨¡å¼ä¸‹çš„æ±‡ç¼–çš„åŸºç¡€çŸ¥è¯†ï¼ŒåŒ…æ‹¬æœ€åŸºæœ¬çš„å¯„å­˜å™¨ã€æ±‡ç¼–æŒ‡ä»¤ã€å‡½æ•°çš„æ±‡ç¼–å½¢å¼ã€æ ˆå¸§ã€ä¸åŒæ¶æ„æ¨¡å¼çš„æ±‡ç¼–å·®å¼‚ç­‰ã€‚æ•´ä½“è€Œè¨€å…¶å®ä¸æ˜¯å¾ˆç¹æ‚çš„ä¸œè¥¿ï¼Œå†…å®¹ä¹Ÿä¸å¤šï¼Œæ‰€ä»¥è¯´å…¶å®è¿™å‘¨è¿˜æ˜¯å¤„äºæƒ³èµ·æ¥è¯¥å­¦äº†çš„æ—¶å€™æ‰å­¦çš„çŠ¶æ€ã€‚çœ‹äº†çœ‹å…¶ä»–çš„å›¤èµ·æ¥çš„èµ„æ–™ï¼Œæœ‰ä¸€è¯´ä¸€ï¼Œå¼€å­¦åè¿˜çœŸä¸ä¸€å®šå¯ä»¥æœ‰è¿ç»­çš„æ—¶é—´å­¦ï¼Œè¿™æ ·å­æ²¡æœ‰å…ˆèµ·ä¸ªä½“ç³»æ„Ÿè§‰è¿˜æ˜¯å¾ˆéš¾çœŸæ­£å­¦æ‡‚ã€‚</li>
</ul>
<h2 id="week20-2025-7-14-2025-7-20"><a href="#week20-2025-7-14-2025-7-20" class="headerlink" title="week20 (2025.7.14-2025.7.20)"></a>week20 (2025.7.14-2025.7.20)</h2><ul>
<li>ä¸€è¨€éš¾å°½å±äºæ˜¯ï¼Œæ€»è€Œè¨€ä¹‹è¿™å‘¨æ²¡æ€ä¹ˆé›†ä¸­ç²¾åŠ›å»ç»™ç¬¬ä¸€éƒ¨åˆ†çš„æ±‡ç¼–å­¦ä¹ æ”¶å°¾</li>
<li>è¿˜æœ‰ç»“æ„ä½“ã€ç±»ä»€ä¹ˆçš„è¿˜æ²¡æœ‰å°è¯•ï¼Œä¸ºäº†é™ä½éš¾åº¦æ²¡æœ‰å¼•å…¥C++å¤æ‚çš„è¯­æ³•ï¼Œä½†æ˜¯æ€»æ„Ÿè§‰å“ªé‡Œæœ‰ç‚¹ä¸å¯¹åŠ²</li>
<li>è¿™æ ·ä¸‹å»ä¸æ˜¯å¾ˆokå•Š(Ë‰â–½Ë‰ï¼›)â€¦</li>
</ul>
<h2 id="week21-2025-7-21-2025-7-27"><a href="#week21-2025-7-21-2025-7-27" class="headerlink" title="week21 (2025.7.21-2025.7.27)"></a>week21 (2025.7.21-2025.7.27)</h2><ul>
<li>æ‘†çƒ‚ä¸€å‘¨ğŸ¤ªğŸ¤ª</li>
<li>å…¶å®è¿™ä¸€å‘¨æˆ‘æ²¡å†™å‘¨è®°ï¼Œç”šè‡³æŠŠå®ƒéšè—äº†ã€‚week22å­¦äº†å‡ å¤©è‰¯å¿ƒè¿‡ä¸å»åˆæ¢å¤æ–‡ç« äº†(ï½ï¿£â–½ï¿£)ï½</li>
</ul>
<h2 id="week22-2025-7-28-2025-8-3"><a href="#week22-2025-7-28-2025-8-3" class="headerlink" title="week22 (2025.7.28-2025.8.3)"></a>week22 (2025.7.28-2025.8.3)</h2><ul>
<li>è¿™å‘¨æ”¶è·é¢‡ä¸°å•Šï¼Œè„±å£³è¿™ä¸€å—å¡äº†åŠå¹´å¤šäº†åº”è¯¥æœ‰ï¼Œä¹Ÿæ˜¯ç»ˆäºèµ°åˆ°é€†å‘çœŸæ­£æœ‰é­…åŠ›çš„åœ°æ–¹äº†ï¼Œè„±å£³ã€èŠ±æŒ‡ä»¤ã€åè°ƒè¯•éƒ½å­¦ä¸Šäº†ï¼Œè™½ç„¶åç†è®ºï¼Œä½†æ˜¯è‡³å°‘æœ‰ç‚¹è§è¯†äº†</li>
<li>ç¾ä¸­ä¸è¶³çš„æ˜¯ï¼Œä»£ç ç¼–è¯‘ç€ç¼–è¯‘ç€çªç„¶å†’å‡ºäº†ä¸€ä¸ªè°ƒç”¨çº¦å®šå†²çªï¼ˆx86ç¯å¢ƒï¼‰ğŸ« èŠ±æŒ‡ä»¤ä¹‹å‰éƒ½æ²¡å‘ç°è¿™ä¸ªé—®é¢˜ï¼ŒçœŸæ˜¯å¥‡äº†æ€ªäº†ğŸ« é‡è£…ä¸€éVSç”šè‡³è¿˜æ˜¯æœ‰è¿™ä¸ªé—®é¢˜</li>
<li>è¿™å‘¨æ‰¾æ ¡é˜Ÿå¸ˆå‚…æ²Ÿé€šäº†ä¸€ä¸‹ï¼Œå¥½åƒå‚åŠ è€ƒæ ¸å¾—è·Ÿç€æ–°ä¸€è½®æ‹›æ–°æ—¶é—´çº¿æ¥ï¼Œä¸ç„¶è¦æœ‰æ‹¿å¾—å‡ºæ‰‹çš„å®åŠ›æ‰å¯ä»¥æ‰“ç ´äººå®¶çš„æ‹›æ–°è®¡åˆ’ğŸ« ğŸ« </li>
</ul>
<h2 id="week23-2025-8-4-2025-8-10"><a href="#week23-2025-8-4-2025-8-10" class="headerlink" title="week23 (2025.8.4-2025.8.10)"></a>week23 (2025.8.4-2025.8.10)</h2><ul>
<li>ä¸Šå‘¨æœ«å¼€å§‹æƒ³ç€ç»™åšå®¢æ¢ä¸ªä¸»é¢˜ï¼ˆè¿™ä¸ªä¸»é¢˜æ„Ÿè§‰è¢«æˆ‘æå¾—æœ‰ç‚¹è€äº†ï¼‰ï¼Œä¸€å¦‚æ—¢å¾€çš„é­ç½ªå•ŠğŸ« è¿™å‘¨æœ¬æ¥æƒ³æ‰¾æœºä¼šæŠŠè¦æ¢çš„ä¸»é¢˜å‡†å¤‡å¥½ï¼Œä½†æ˜¯ï¼Œä¸€æŠ˜è…¾å°±æ˜¯åŠå¤©ğŸ« </li>
<li>x2cå¼€å§‹æ‹›æ–°äº†ï¼Œå”‰ï¼Œè¿˜æ²¡å‡†å¤‡å¥½ğŸ« </li>
<li>æœ¬æ¥è¿™å‘¨åˆ°OLLVMäº†ï¼Œä½†æ˜¯å°è¯•åå‘ç°è‡ªå·±å†™çš„ç¨‹åºOLLVMæ²¡æœ‰æ•ˆæœï¼Œä¸çŸ¥é“æ˜¯é€»è¾‘å¤ªç®€å•è¿˜æ˜¯IDAå¤ªå¼ºå¤§äº†è¿˜æ˜¯ä»€ä¹ˆï¼Œå¦å¤–è§£æ³•è¿˜æœ‰ç‰µæ‰¯åˆ°angrçš„ï¼Œç´¢æ€§æ·±çš„å°±å¾€åå»¶å»¶äº†ï¼Œå…ˆæŠŠçŸ¥è¯†é¢æ‹“å¼€ï¼Œå®‰å“è¿˜æ²¡çœ‹å‘¢ï¼Œpyè¿˜æœ‰å…¶å®ƒè¯­è¨€çš„é€†å‘ä¹Ÿæ²¡æ€ä¹ˆæ¥è§¦è¿‡å‘¢ğŸ« </li>
<li>æ€ä¹ˆæ„Ÿè§‰çŠ¶æ€èµ·èµ·è½è½çš„ğŸ˜…</li>
</ul>
<h2 id="week24-2025-8-11-2025-8-17"><a href="#week24-2025-8-11-2025-8-17" class="headerlink" title="week24 (2025.8.11-2025.8.17)"></a>week24 (2025.8.11-2025.8.17)</h2><ul>
<li>è¿™å‘¨å¼€å§‹èµ¶è¿›åº¦ï¼Œå­¦äº†ç‚¹å®‰å“é€†å‘åŸºç¡€ï¼Œç„¶åæŠ•äº†ç®€å†ã€‚ä¹Ÿç®—æ˜¯è§è¯†åˆ°äº†æ‹›æ–°è€ƒæ ¸äº†ã€‚æ„Ÿè°¢å¸ˆå‚…æ‰‹ä¸‹ç•™æƒ…ï¼Œä¹Ÿæ˜¯ç»ˆäºè¢«æ”¶ç•™äº†ğŸ«¡ã€‚</li>
<li>ç„¶åå°±æ˜¯æ‰“moeï¼Œæ„Ÿè§‰æ¯”0xGameè¿˜ä¸Šäº†ç‚¹éš¾åº¦ï¼Œç¬¬ä¸€å‘¨å°±æœ‰upxçš„é¢˜äº†ï¼Œè¿˜æœ‰C++çš„ã€‚é¡ºé“æ‰“äº†LILCTFï¼Œåšå‡ºäº†ä¸€é¢˜ğŸ˜‹ä½†æ˜¯å…¶ä»–é¢˜æ²¡æ€è·¯äº†ï¼ˆåŠ ä¸Šå‡†å¤‡ç§‘ç›®ä¸€ğŸ« ï¼Œå°±æ²¡å¾€ä¸‹åšï¼Œåé¢å†å­¦å­¦å†å¤ç°ğŸ˜‹</li>
<li>è€ƒè™‘åˆ°Winé€†å‘è¿˜æ²¡æ›´å®Œï¼Œæ‰€ä»¥å®‰å“è¿™éƒ¨åˆ†å°±æ²¡æœ‰å†™ç¬”è®°äº†ï¼Œå›å¤´å†ç†Ÿæ‚‰ç†Ÿæ‚‰å†è¡¥</li>
</ul>
<h2 id="week25-2025-8-18-2025-8-24"><a href="#week25-2025-8-18-2025-8-24" class="headerlink" title="week25 (2025.8.18-2025.8.24)"></a>week25 (2025.8.18-2025.8.24)</h2><ul>
<li>moeä¸Šå¼ºåº¦äº†ï¼Œä½†æ˜¯ç¬¬äºŒå‘¨çš„é¢˜è¿˜æ²¡å†™å®Œ</li>
<li>è¿™å‘¨æ‘†çƒ‚äº†</li>
</ul>
<h3 id="week26-2025-8-25-2025-8-31"><a href="#week26-2025-8-25-2025-8-31" class="headerlink" title="week26 (2025.8.25-2025.8.31)"></a>week26 (2025.8.25-2025.8.31)</h3><ul>
<li>è¿™å‘¨ä¸»è¦è¿˜æ˜¯ç ”ç©¶moeçš„é¢˜ï¼Œæ²¡æœ‰å­¦ä»€ä¹ˆæ–°çŸ¥è¯†ã€‚</li>
</ul>
]]></content>
      <categories>
        <category>å‘¨è®°</category>
      </categories>
      <tags>
        <tag>å‘¨è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>æ¹¾åŒºæ¯åˆèµ›WriteUp&amp;å¤ç°</title>
    <url>/2025/10/03/%E6%B9%BE%E5%8C%BA%E6%9D%AF%E5%88%9D%E8%B5%9BWriteUp&amp;%E5%A4%8D%E7%8E%B0/</url>
    <content><![CDATA[<p>å’ŒX2cçš„nixwareã€Ky4niT3å¸ˆå‚…å‚åŠ äº†çº¿ä¸Šåˆèµ›ï¼Œä½†æ˜¯å¯„äº†ã€‚ç¬¬ä¸€æ¬¡ç»„é˜Ÿå‚èµ›ï¼Œè¿˜æ˜¯å¤ªèœäº†ã€‚Reæ–¹å‘è§£äº†ä¸€é“ï¼Œç„¶åå’Œå¸ˆå‚…ä»¬æ‹¼å‡‘å‡ºäº†ä¸€é“ã€‚åŸºæœ¬å°±æ˜¯ç­¾åˆ°é¢˜é AIï¼Œéš¾é¢˜æ²¡æ€è·¯ï¼Œè§è¯†è¿˜æ˜¯å¤ªå°‘äº†</p>
<span id="more"></span>

<h2 id="WriteUp"><a href="#WriteUp" class="headerlink" title="WriteUp"></a>WriteUp</h2><h3 id="hardtest"><a href="#hardtest" class="headerlink" title="hardtest"></a>hardtest</h3><ul>
<li><p>é™„ä»¶ç¨‹åºç”¨IDAæ‰“å¼€ï¼Œshift+F12åœ¨å­—ç¬¦ä¸²è¡¨é€šè¿‡å…³é”®å­—â€œflag:â€å¯ä»¥æ‰¾åˆ°mainå‡½æ•°ä½ç½®</p>
<p><img src="/../images/image-20251003142543591.png" alt="å­—ç¬¦ä¸²è¡¨"></p>
</li>
<li><p>ä»¥ä¸‹æ˜¯ä¼˜åŒ–åçš„mainå‡½æ•°ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><code class="hljs cpp"><span class="hljs-function">__int64 __fastcall <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-type">int</span> a1, <span class="hljs-type">char</span> **a2, <span class="hljs-type">char</span> **a3)</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> seed; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">unsigned</span> __int64 scale1; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">void</span> *temp1; <span class="hljs-comment">// rsp</span><br>  <span class="hljs-type">unsigned</span> __int64 scale2; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">void</span> *temp2; <span class="hljs-comment">// rsp</span><br>  <span class="hljs-type">char</span> temp; <span class="hljs-comment">// al</span><br>  _QWORD buf[<span class="hljs-number">2</span>]; <span class="hljs-comment">// [rsp+8h] [rbp-F0h] BYREF</span><br>  __int64 i_2; <span class="hljs-comment">// [rsp+18h] [rbp-E0h]</span><br>  __int64 v12; <span class="hljs-comment">// [rsp+20h] [rbp-D8h]</span><br>  <span class="hljs-type">char</span> input; <span class="hljs-comment">// [rsp+29h] [rbp-CFh] BYREF</span><br>  <span class="hljs-type">char</span> judge; <span class="hljs-comment">// [rsp+2Ah] [rbp-CEh]</span><br>  <span class="hljs-type">char</span> randNum; <span class="hljs-comment">// [rsp+2Bh] [rbp-CDh]</span><br>  <span class="hljs-type">int</span> j; <span class="hljs-comment">// [rsp+2Ch] [rbp-CCh]</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [rsp+30h] [rbp-C8h]</span><br>  <span class="hljs-type">int</span> length; <span class="hljs-comment">// [rsp+34h] [rbp-C4h]</span><br>  __int64 v19; <span class="hljs-comment">// [rsp+38h] [rbp-C0h]</span><br>  __int64 Buf; <span class="hljs-comment">// [rsp+40h] [rbp-B8h]</span><br>  __int64 v21; <span class="hljs-comment">// [rsp+48h] [rbp-B0h]</span><br>  _QWORD *Enc; <span class="hljs-comment">// [rsp+50h] [rbp-A8h]</span><br>  <span class="hljs-type">char</span> flag[<span class="hljs-number">104</span>]; <span class="hljs-comment">// [rsp+58h] [rbp-A0h] BYREF</span><br>  <span class="hljs-type">unsigned</span> __int64 v24; <span class="hljs-comment">// [rsp+C0h] [rbp-38h]</span><br><br>  v24 = __readfsqword(<span class="hljs-number">0x28u</span>);<br>  <span class="hljs-built_in">setbuf</span>(stdin, <span class="hljs-number">0LL</span>);<br>  <span class="hljs-built_in">setbuf</span>(stdout, <span class="hljs-number">0LL</span>);<br>  <span class="hljs-built_in">setbuf</span>(stderr, <span class="hljs-number">0LL</span>);<br>  seed = <span class="hljs-built_in">time</span>(<span class="hljs-number">0LL</span>);<br>  <span class="hljs-built_in">srand</span>(seed);<br>  randNum = <span class="hljs-built_in">rand</span>() % <span class="hljs-number">255</span> + <span class="hljs-number">1</span>;<br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;input your number(1-255): &quot;</span>);<br>  <span class="hljs-keyword">if</span> ( __isoc99_scanf(<span class="hljs-string">&quot;%d&quot;</span>, &amp;input) == <span class="hljs-number">1</span> &amp;&amp; randNum == input )<br>  &#123;<br>    <span class="hljs-keyword">while</span> ( <span class="hljs-built_in">getchar</span>() != <span class="hljs-number">10</span> )<br>      ;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;flag: &quot;</span>);<br>    <span class="hljs-built_in">fgets</span>(flag, <span class="hljs-number">100</span>, stdin);                    <span class="hljs-comment">// è·å–flagè¾“å…¥</span><br>    flag[<span class="hljs-built_in">strcspn</span>(flag, <span class="hljs-string">&quot;\n&quot;</span>)] = <span class="hljs-number">0</span>;<br>    length = <span class="hljs-built_in">strlen</span>(flag);<br>    v19 = length - <span class="hljs-number">1LL</span>;<br>    i_2 = length;<br>    v12 = <span class="hljs-number">0LL</span>;<br>    buf[<span class="hljs-number">0</span>] = length;<br>    buf[<span class="hljs-number">1</span>] = <span class="hljs-number">0LL</span>;<br>    scale1 = <span class="hljs-number">16</span> * ((length + <span class="hljs-number">15LL</span>) / <span class="hljs-number">0x10uLL</span>);  <span class="hljs-comment">// åœ¨åŠ¨æ€åˆ†é…æ ˆä¸Šçš„å†…å­˜</span><br>    <span class="hljs-keyword">while</span> ( buf != (buf - (scale1 &amp; <span class="hljs-number">0xFFFFFFFFFFFFF000LL</span>)) )<br>      ;<br>    temp1 = <span class="hljs-built_in">alloca</span>(scale1 &amp; <span class="hljs-number">0xFFF</span>);<br>    <span class="hljs-keyword">if</span> ( (scale1 &amp; <span class="hljs-number">0xFFF</span>) != <span class="hljs-number">0</span> )<br>      *(&amp;buf[<span class="hljs-number">-1</span>] + (scale1 &amp; <span class="hljs-number">0xFFF</span>)) = *(&amp;buf[<span class="hljs-number">-1</span>] + (scale1 &amp; <span class="hljs-number">0xFFF</span>));<br>    Buf = buf;                                  <span class="hljs-comment">// BufæŒ‡å‘åˆ†é…çš„å†…å­˜</span><br>    <span class="hljs-built_in">encrypt1</span>(flag, buf);                        <span class="hljs-comment">// å¯¹flagè¿›è¡ŒåŠ å¯†ï¼ŒåŠ å¯†ç»“æœå®é™…ä¸Šç”±Bufè®°å½•ï¼Œbufæ˜¯ä¸€ä¸ªé€šç”¨çš„ç¼“å­˜ç©ºé—´</span><br>    v21 = length - <span class="hljs-number">1LL</span>;<br>    scale2 = <span class="hljs-number">16</span> * ((length + <span class="hljs-number">15LL</span>) / <span class="hljs-number">0x10uLL</span>);  <span class="hljs-comment">// å†æ¬¡åŠ¨æ€åˆ†é…æ ˆä¸Šçš„å†…å­˜</span><br>    <span class="hljs-keyword">while</span> ( buf != (buf - (scale2 &amp; <span class="hljs-number">0xFFFFFFFFFFFFF000LL</span>)) )<br>      ;<br>    temp2 = <span class="hljs-built_in">alloca</span>(scale2 &amp; <span class="hljs-number">0xFFF</span>);<br>    <span class="hljs-keyword">if</span> ( (scale2 &amp; <span class="hljs-number">0xFFF</span>) != <span class="hljs-number">0</span> )<br>      *(&amp;buf[<span class="hljs-number">-1</span>] + (scale2 &amp; <span class="hljs-number">0xFFF</span>)) = *(&amp;buf[<span class="hljs-number">-1</span>] + (scale2 &amp; <span class="hljs-number">0xFFF</span>));<br>    Enc = buf;                                  <span class="hljs-comment">// EncæŒ‡å‘åˆ†é…çš„å†…å­˜</span><br>    <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; length; ++i )<br>    &#123;<br>      temp = <span class="hljs-built_in">encrypt2</span>(*(Buf + i));              <span class="hljs-comment">// å¯¹ä¸Šä¸€è½®åŠ å¯†çš„ç»“æœå†è¿›è¡Œä¸€æ¬¡åŠ å¯†ï¼ŒåŠ å¯†ç»“æœç”±Encè®°å½•</span><br>      *(Enc + i) = temp;<br>    &#125;<br>    judge = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">for</span> ( j = <span class="hljs-number">0</span>; j &lt; length; ++j )<br>    &#123;<br>      <span class="hljs-keyword">if</span> ( *(Enc + j) != byte_2120[j] )         <span class="hljs-comment">// åˆ¤æ–­åŠ å¯†ç»“æœæ˜¯å¦æ­£ç¡®</span><br>      &#123;<br>        judge = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">break</span>;<br>      &#125;<br>    &#125;<br>    <span class="hljs-keyword">if</span> ( judge )<br>      <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;right&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;error&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">1LL</span>;<br>  &#125;<br>&#125;<br><br><span class="hljs-function">__int64 __fastcall <span class="hljs-title">encrypt1</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> *flag, __int64 buf)</span></span><br><span class="hljs-function"></span>&#123;<br>  __int64 count; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">signed</span> <span class="hljs-type">int</span> i; <span class="hljs-comment">// [rsp+14h] [rbp-1Ch]</span><br>  <span class="hljs-type">signed</span> <span class="hljs-type">int</span> length; <span class="hljs-comment">// [rsp+18h] [rbp-18h]</span><br><br>  length = <span class="hljs-built_in">strlen</span>(flag);<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; ; ++i )<br>  &#123;<br>    count = i;<br>    <span class="hljs-keyword">if</span> ( i &gt;= length )<br>      <span class="hljs-keyword">break</span>;<br>    *(i + buf) = <span class="hljs-built_in">rol</span>(flag[i], (i % <span class="hljs-number">7</span>) + <span class="hljs-number">1</span>);     <span class="hljs-comment">// return (flag[i] &lt;&lt; ((i%7)+1)) | (flag[i] &gt;&gt; (8 - ((i%7)+1)))</span><br>  &#125;<br>  <span class="hljs-keyword">return</span> count;<br>&#125;<br><br><span class="hljs-function">__int64 __fastcall <span class="hljs-title">encrypt2</span><span class="hljs-params">(<span class="hljs-type">char</span> Buf_i)</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-type">unsigned</span> __int8 v1; <span class="hljs-comment">// al</span><br>  <span class="hljs-type">unsigned</span> __int8 v3; <span class="hljs-comment">// [rsp+15h] [rbp-3h]</span><br><br>  v1 = <span class="hljs-built_in">rol</span>(Buf_i ^ <span class="hljs-number">0x5Au</span>, <span class="hljs-number">3</span>);                   <span class="hljs-comment">// return (a1^0x5Au &lt;&lt; 3) | (a1^0x5Au &gt;&gt; (8 - 3));</span><br>  v3 = <span class="hljs-built_in">sub_1313</span>((<span class="hljs-number">16</span> * ((<span class="hljs-number">3</span> * (v1 &gt;&gt; <span class="hljs-number">4</span>)) &amp; <span class="hljs-number">0xF</span>)) | (<span class="hljs-number">5</span> * (v1 &amp; <span class="hljs-number">0xF</span>)) &amp; <span class="hljs-number">0xFu</span>);<span class="hljs-comment">// AIè¯´æ˜¯æ¨¡å¹‚è¿ç®—å‡½æ•°ï¼Œè®¡ç®—a1^(255) mod 257</span><br>  <span class="hljs-keyword">return</span> byte_2020[<span class="hljs-built_in">ror</span>(v3, <span class="hljs-number">2</span>)];                 <span class="hljs-comment">// return (v3 &gt;&gt; 2) | (v3 &lt;&lt; (8 - 2));æ­¤å¤„å»ºç«‹äº†æ˜ å°„å…³ç³»</span><br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>ç¬”è€…åŠ è§£å¯†è¿™ä¸€å—å¤ªèœäº†ï¼Œæ²¡æœ‰æ•°å­¦å¤´è„‘ï¼Œåªèƒ½ä¾é AIè§£å¯†äº†ï¼ˆå› ä¸ºæ¶‰åŠæ•°è®ºï¼Œç¬”è€…è¿˜æ²¡å­¦è¿‡ï¼‰</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">rol</span>(<span class="hljs-params">b, n</span>):<br>    n %= <span class="hljs-number">8</span><br>    <span class="hljs-keyword">return</span> ((b &lt;&lt; n) | (b &gt;&gt; (<span class="hljs-number">8</span> - n))) &amp; <span class="hljs-number">0xFF</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ror</span>(<span class="hljs-params">b, n</span>):<br>    n %= <span class="hljs-number">8</span><br>    <span class="hljs-keyword">return</span> ((b &gt;&gt; n) | (b &lt;&lt; (<span class="hljs-number">8</span> - n))) &amp; <span class="hljs-number">0xFF</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">mod_inv</span>(<span class="hljs-params">a, mod=<span class="hljs-number">257</span></span>):<br>    <span class="hljs-comment"># è®¡ç®—aåœ¨æ¨¡257ä¸‹çš„é€†å…ƒï¼Œä½¿ç”¨è´¹é©¬å°å®šç†</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">pow</span>(a, <span class="hljs-number">255</span>, mod)<br><br>byte_2020 = [<br>    <span class="hljs-number">0x63</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0xC5</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0x76</span>,<br>    <span class="hljs-number">0xCA</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0xC9</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0xFA</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0xF0</span>, <span class="hljs-number">0xAD</span>, <span class="hljs-number">0xD4</span>, <span class="hljs-number">0xA2</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0xA4</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0xC0</span>,<br>    <span class="hljs-number">0xB7</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xCC</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0xA5</span>, <span class="hljs-number">0xE5</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x15</span>,<br>    <span class="hljs-number">0x04</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0xEB</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0xB2</span>, <span class="hljs-number">0x75</span>,<br>    <span class="hljs-number">0x09</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0xA0</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0xB3</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0xE3</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0x84</span>,<br>    <span class="hljs-number">0x53</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xED</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0xFC</span>, <span class="hljs-number">0xB1</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0xCF</span>,<br>    <span class="hljs-number">0xD0</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0xAA</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0xF9</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x9F</span>, <span class="hljs-number">0xA8</span>,<br>    <span class="hljs-number">0x51</span>, <span class="hljs-number">0xA3</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x8F</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0x9D</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0xF5</span>, <span class="hljs-number">0xBC</span>, <span class="hljs-number">0xB6</span>, <span class="hljs-number">0xDA</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xF3</span>, <span class="hljs-number">0xD2</span>,<br>    <span class="hljs-number">0xCD</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0xEC</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0xC4</span>, <span class="hljs-number">0xA7</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x73</span>,<br>    <span class="hljs-number">0x60</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0xB8</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0xDB</span>,<br>    <span class="hljs-number">0xE0</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0xD3</span>, <span class="hljs-number">0xAC</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x79</span>,<br>    <span class="hljs-number">0xE7</span>, <span class="hljs-number">0xC8</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0xD5</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0xA9</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0xF4</span>, <span class="hljs-number">0xEA</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0xAE</span>, <span class="hljs-number">0x08</span>,<br>    <span class="hljs-number">0xBA</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0xA6</span>, <span class="hljs-number">0xB4</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0xDD</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0xBD</span>, <span class="hljs-number">0x8B</span>, <span class="hljs-number">0x8A</span>,<br>    <span class="hljs-number">0x70</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0xB5</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0xF6</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0xB9</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x9E</span>,<br>    <span class="hljs-number">0xE1</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0x8E</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x9B</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0xE9</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0xDF</span>,<br>    <span class="hljs-number">0x8C</span>, <span class="hljs-number">0xA1</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0xB0</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0xBB</span>, <span class="hljs-number">0x16</span><br>]<br><br><span class="hljs-comment"># æ„å»ºåå‘æ˜ å°„</span><br>rev_2020 = &#123;&#125;<br><span class="hljs-keyword">for</span> idx, val <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(byte_2020):<br>    rev_2020[val] = idx<br><br>enc_data = [<br>    <span class="hljs-number">0x97</span>, <span class="hljs-number">0xD5</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0xB4</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0xDA</span>,<br>    <span class="hljs-number">0x43</span>, <span class="hljs-number">0xCD</span>, <span class="hljs-number">0xD3</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0xCD</span>, <span class="hljs-number">0x71</span>,<br>    <span class="hljs-number">0xBD</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0x1A</span><br>]<br><br><span class="hljs-comment"># é€†å‘encrypt2</span><br>enc1_out = []<br><span class="hljs-keyword">for</span> i, c <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(enc_data):<br>    idx = rev_2020[c]  <span class="hljs-comment"># å¾—åˆ°ç´¢å¼•ï¼ˆå³v3å¾ªç¯å³ç§»2ä½åçš„å€¼ï¼‰</span><br>    v3 = rol(idx, <span class="hljs-number">2</span>)   <span class="hljs-comment"># å¾ªç¯å·¦ç§»2ä½å¾—åˆ°v3ï¼ˆåŸå¾ªç¯å³ç§»2ä½çš„é€†ï¼‰</span><br>    <span class="hljs-comment"># å¦‚æœv3ä¸º0ï¼Ÿä½†åŸä»£ç ä¸­a1ä¸ä¸º0æ‰è®¡ç®—ï¼Œè¿™é‡Œå‡è®¾v3ä¸ä¸º0</span><br>    <span class="hljs-keyword">if</span> v3 == <span class="hljs-number">0</span>:<br>        x = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">else</span>:<br>        x = mod_inv(v3, <span class="hljs-number">257</span>)<br>    A = (x &gt;&gt; <span class="hljs-number">4</span>) &amp; <span class="hljs-number">0xF</span><br>    B = x &amp; <span class="hljs-number">0xF</span><br>    high = (<span class="hljs-number">11</span> * A) &amp; <span class="hljs-number">0xF</span><br>    low = (<span class="hljs-number">13</span> * B) &amp; <span class="hljs-number">0xF</span><br>    v1 = (high &lt;&lt; <span class="hljs-number">4</span>) | low<br>    tmp = ror(v1, <span class="hljs-number">3</span>)  <span class="hljs-comment"># å¾ªç¯å³ç§»3ä½ï¼ˆåŸå¾ªç¯å·¦ç§»3ä½çš„é€†ï¼‰</span><br>    enc1_out.append(tmp ^ <span class="hljs-number">0x5A</span>)<br><br><span class="hljs-comment"># é€†å‘encrypt1</span><br>flag = []<br><span class="hljs-keyword">for</span> i, c <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(enc1_out):<br>    n = (i % <span class="hljs-number">7</span>) + <span class="hljs-number">1</span><br>    flag_char = ror(c, n)  <span class="hljs-comment"># å¾ªç¯å³ç§»nä½ï¼ˆåŸå¾ªç¯å·¦ç§»nä½çš„é€†ï¼‰</span><br>    flag.append(flag_char)<br><br><span class="hljs-comment"># è½¬æ¢ä¸ºå­—ç¬¦ä¸²</span><br>flag_str = <span class="hljs-string">&#x27;&#x27;</span>.join(<span class="hljs-built_in">chr</span>(b) <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> flag)<br><span class="hljs-built_in">print</span>(flag_str)<br></code></pre></td></tr></table></figure></li>
</ul>
<h3 id="minigame"><a href="#minigame" class="headerlink" title="minigame"></a>minigame</h3><ul>
<li><p>å¾®ä¿¡å°ç¨‹åºé€†å‘ï¼Œç¬¬ä¸€æ¬¡é‡åˆ°è¿™ä¸ªç±»å‹çš„é¢˜</p>
</li>
<li><p>ç”¨<a href="https://github.com/biggerstar/wedecode">wedecode</a>è§£åŒ…é™„ä»¶ï¼Œè¾“å‡ºç»“æœåœ¨wedecode-main&#x2F;OUTPUT&#x2F;defaulté‡Œ</p>
<p><img src="/../images/image-20251003175458209.png" alt="è§£åŒ…ç»“æœ"></p>
<p>æ²¡æœ‰è¿™æ–¹é¢çš„ç»éªŒï¼Œè®©AIåˆ†æé¡¹ç›®ï¼Œå‘ç°utils&#x2F;validator.wasmé‡Œæœ‰æ£€éªŒé€»è¾‘ã€‚wasmæ˜¯ä¸€ç§äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¯ä»¥è½¬æˆwaté˜…è¯»ï¼ˆç±»ä¼¼æ±‡ç¼–ï¼‰ã€‚ä½¿ç”¨åœ¨çº¿å·¥å…·<a href="https://webassembly.github.io/wabt/demo/wasm2wat/">wasm2wat demo</a>æŠŠwasmè½¬æˆwat:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><code class="hljs wat">(module<br>  (type $t0 (func (param i32) (result i32)))<br>  (type $t1 (func))<br>  (func $c (export &quot;c&quot;) (type $t0) (param $p0 i32) (result i32)<br>    (local $l1 i32) (local $l2 i32) (local $l3 i32) (local $l4 i32)<br>    (if $I6<br>      (i32.ne<br>        (block $B0 (result i32)<br>          (block $B1<br>            (block $B2<br>              (br_if $B2<br>                (i32.eqz<br>                  (i32.and<br>                    (local.tee $l3<br>                      (local.get $p0))<br>                    (i32.const 3))))<br>              (drop<br>                (br_if $B0<br>                  (i32.const 0)<br>                  (i32.eqz<br>                    (i32.load8_u<br>                      (local.get $p0)))))<br>              (loop $L3<br>                (br_if $B2<br>                  (i32.eqz<br>                    (i32.and<br>                      (local.tee $p0<br>                        (i32.add<br>                          (local.get $p0)<br>                          (i32.const 1)))<br>                      (i32.const 3))))<br>                (br_if $L3<br>                  (i32.load8_u<br>                    (local.get $p0))))<br>              (br $B1))<br>            (loop $L4<br>              (local.set $p0<br>                (i32.add<br>                  (local.tee $l1<br>                    (local.get $p0))<br>                  (i32.const 4)))<br>              (br_if $L4<br>                (i32.eq<br>                  (i32.and<br>                    (i32.or<br>                      (i32.sub<br>                        (i32.const 16843008)<br>                        (local.tee $l4<br>                          (i32.load<br>                            (local.get $l1))))<br>                      (local.get $l4))<br>                    (i32.const -2139062144))<br>                  (i32.const -2139062144))))<br>            (loop $L5<br>              (local.set $l1<br>                (i32.add<br>                  (local.tee $p0<br>                    (local.get $l1))<br>                  (i32.const 1)))<br>              (br_if $L5<br>                (i32.load8_u<br>                  (local.get $p0)))))<br>          (i32.sub<br>            (local.get $p0)<br>            (local.get $l3)))<br>        (i32.const 38))<br>      (then<br>        (return<br>          (i32.const 0))))<br>    (loop $L7<br>      (block $B8<br>        (local.set $l1<br>          (i32.eq<br>            (local.tee $p0<br>              (i32.xor<br>                (i32.load8_u offset=1024<br>                  (local.get $l2))<br>                (i32.load8_s<br>                  (i32.add<br>                    (local.get $l2)<br>                    (local.get $l3)))))<br>            (i32.const 153)))<br>        (br_if $B8<br>          (i32.ne<br>            (local.get $p0)<br>            (i32.const 153)))<br>        (br_if $L7<br>          (i32.ne<br>            (local.tee $l2<br>              (i32.add<br>                (local.get $l2)<br>                (i32.const 1)))<br>            (i32.const 38)))))<br>    (local.get $l1))<br>  (func $b (export &quot;b&quot;) (type $t1))<br>  (memory $a (export &quot;a&quot;) 258 258)<br>  (data $d0 (i32.const 1024) &quot;\ff\f5\f8\fe\e2\ff\f8\fc\a9\fb\ab\ae\fa\ad\ac\a8\fa\ae\ab\a1\a1\af\ae\f8\ac\af\ae\fc\a1\fa\a8\fb\fb\ad\fc\ac\aa\e4&quot;))<br><br></code></pre></td></tr></table></figure>
</li>
<li><p>ç”±AIåˆ†æçŸ¥ï¼Œæ­¤å¤„ä¸»è¦æ˜¯æŠŠè¾“å…¥çš„å†…å®¹ä¸å¯†æ–‡å¼‚æˆ–ï¼Œå¼‚æˆ–çš„ç»“æœè¦ç­‰äº153ã€‚ç­‰ä»·äºå°†è¾“å…¥çš„å†…å®¹å’Œ153å¼‚æˆ–è¦ç­‰äºå¯†æ–‡ã€‚è§£å¯†å°±æ˜¯æ‹¿153å¼‚æˆ–å¯†æ–‡ã€‚exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">enc = [<br>    <span class="hljs-number">0xff</span>, <span class="hljs-number">0xf5</span>, <span class="hljs-number">0xf8</span>, <span class="hljs-number">0xfe</span>, <span class="hljs-number">0xe2</span>, <span class="hljs-number">0xff</span>, <span class="hljs-number">0xf8</span>, <span class="hljs-number">0xfc</span>, <span class="hljs-number">0xa9</span>, <span class="hljs-number">0xfb</span>,<br>    <span class="hljs-number">0xab</span>, <span class="hljs-number">0xae</span>, <span class="hljs-number">0xfa</span>, <span class="hljs-number">0xad</span>, <span class="hljs-number">0xac</span>, <span class="hljs-number">0xa8</span>, <span class="hljs-number">0xfa</span>, <span class="hljs-number">0xae</span>, <span class="hljs-number">0xab</span>, <span class="hljs-number">0xa1</span>,<br>    <span class="hljs-number">0xa1</span>, <span class="hljs-number">0xaf</span>, <span class="hljs-number">0xae</span>, <span class="hljs-number">0xf8</span>, <span class="hljs-number">0xac</span>, <span class="hljs-number">0xaf</span>, <span class="hljs-number">0xae</span>, <span class="hljs-number">0xfc</span>, <span class="hljs-number">0xa1</span>, <span class="hljs-number">0xfa</span>,<br>    <span class="hljs-number">0xa8</span>, <span class="hljs-number">0xfb</span>, <span class="hljs-number">0xfb</span>, <span class="hljs-number">0xad</span>, <span class="hljs-number">0xfc</span>, <span class="hljs-number">0xac</span>, <span class="hljs-number">0xaa</span>, <span class="hljs-number">0xe4</span><br>]<br><br>flag = <span class="hljs-string">&#x27;&#x27;</span>.join([<span class="hljs-built_in">chr</span>(data ^ <span class="hljs-number">153</span>) <span class="hljs-keyword">for</span> data <span class="hljs-keyword">in</span> enc])<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure></li>
</ul>
<h2 id="å¤ç°"><a href="#å¤ç°" class="headerlink" title="å¤ç°"></a>å¤ç°</h2><h3 id="strangapp"><a href="#strangapp" class="headerlink" title="strangapp"></a>strangapp</h3><ul>
<li><p>apkç”¨JEBæ‰“å¼€ä¼šå‘ç°MainActivityå…¨æ˜¯nop:</p>
<p><img src="/../images/image-20251105151416089.png" alt="MainActivity"></p>
</li>
<li><p>æ‹–è¿›GDAé‡Œçœ‹ä¸€ä¸‹ï¼Œä¼šå‘ç°apkåŠ äº†å£³</p>
<p><img src="/../images/image-20251105150944165.png" alt="GDAåˆ†æ"></p>
<p>æ‰€ä»¥ç¬¬ä¸€æ­¥å…ˆè„±å£³</p>
</li>
<li><p>æ²¡è¾™äº†ï¼Œé¢˜ç›®ç¯å¢ƒå¡çš„å¥½æ­»ï¼Œé…äº†ä¸€ä¸‹åˆç¯å¢ƒæ²¡é…å‡ºèƒ½è¿è¡Œapkçš„ï¼Œæ”¹å¤©å†è¯•ğŸ˜¡</p>
</li>
</ul>
]]></content>
      <categories>
        <category>WriteUp&amp;å¤ç°</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>WriteUp</tag>
        <tag>Reverse</tag>
        <tag>å¤ç°</tag>
      </tags>
  </entry>
  <entry>
    <title>è®°ä¸€æ¬¡blogé‡å»º</title>
    <url>/2025/06/05/%E8%AE%B0%E4%B8%80%E6%AC%A1blog%E9%87%8D%E5%BB%BA/</url>
    <content><![CDATA[<p>éƒ¨ç½²Vercelå¤±è¯¯åçš„blogé‡å»ºï¼ˆåŸºäºhexo+NexT8.23.0ï¼Œé‡‡ç”¨utterancesè¯„è®ºç³»ç»Ÿå’Œfirestoreæ•°æ®è®°å½•ï¼‰</p>
<span id="more"></span>

<ul>
<li>OKï¼Œè¿™æ˜¯ç¬”è€…åœ¨ä¾èµ–AIç›²ç›®æŠŠåšå®¢éƒ¨ç½²åˆ°Vercelä¸Šå¯¼è‡´åšå®¢å´©æºƒåçš„åšå®¢é‡å»ºè®°å½•</li>
<li>è®°å½•çš„åŸå› é¦–å…ˆæ˜¯æ›´æ–°â€œè®°ä¸€æ¬¡blogä¼˜åŒ–â€çš„å†…å®¹ï¼Œè¿˜æœ‰æ–°ç‰ˆæœ¬NexTçš„ä¸€äº›ä¸ªäººé…ç½®ï¼ˆæ–°ç‰ˆæœ¬NexTçš„æ•™ç¨‹å¥½åƒä¸å¤šï¼Œè¯„è®ºç³»ç»Ÿå’Œè®¿å®¢è®¡æ•°ç³»ç»Ÿè¦è‡ªå·±ç¢ç£¨å¥½ä¸€ä¼šå„¿ï¼‰</li>
</ul>
<h2 id="é¦–é¡µåˆ†ç±»å¡ç‰‡å®ç°"><a href="#é¦–é¡µåˆ†ç±»å¡ç‰‡å®ç°" class="headerlink" title="é¦–é¡µåˆ†ç±»å¡ç‰‡å®ç°"></a>é¦–é¡µåˆ†ç±»å¡ç‰‡å®ç°</h2><ul>
<li><p>å› ä¸ºæ˜¯å¯¹â€œè®°ä¸€æ¬¡blogä¼˜åŒ–â€çš„æ›´æ–°ï¼Œæ‰€ä»¥è¿™éƒ¨åˆ†ç›´æ¥è´´ä»£ç äº†ï¼ˆæ³¨ï¼šåŒºåˆ«æ›´å¤šæ˜¯åœ¨æ–‡ä»¶åä»swigå˜æˆäº†njkï¼‰</p>
<p>themes&#x2F;next&#x2F;layout&#x2F;index.njkï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><code class="hljs html">&#123;% extends &#x27;_layout.njk&#x27; %&#125;<br>&#123;% import &#x27;_macro/sidebar.njk&#x27; as sidebar_template with context %&#125;<br><br>&#123;% block title %&#125;&#123;&#123; title &#125;&#125;&#123;%- if theme.index_with_subtitle and subtitle %&#125; - &#123;&#123; subtitle &#125;&#125;&#123;%- endif %&#125;&#123;% endblock %&#125;<br><br>&#123;% block class %&#125;index categories-page&#123;% endblock %&#125;<br><br>&#123;% block content %&#125;<br><br>&#123;# è¿™éƒ¨åˆ†æ˜¯å®ç°categoryå¡ç‰‡ï¼Œæœ€åé¢è¿˜æœ‰æ²¡categoryçš„æ–‡ç« çš„å¤„ç†ï¼Œå› ä¸ºæˆ‘ä¸¥æ ¼äº†æ¯ç¯‡æ–‡ç« æœ‰categoryï¼Œå°±æ²¡ç®¡ç”»é¢å¦‚ä½•äº† #&#125;<br>&#123;% if site.categories.length &gt; 0 %&#125;<br><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;category-cards-container&quot;</span>&gt;</span><br>    &#123;% for cat in site.categories.toArray() %&#125;<br>      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;category-card&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;category-header&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">h2</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;category-name&quot;</span>&gt;</span>&#123;&#123; cat.name &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;post-count&quot;</span>&gt;</span>&#123;&#123; cat.posts.length &#125;&#125;ç¯‡æ–‡ç« <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>          <span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>&#123;# è¿™ä¸€éƒ¨åˆ†å®ç°å¡ç‰‡æ˜¾ç¤ºåŒ…å«çš„æ–‡ç« çš„æ ‡é¢˜ï¼Œæ•°é‡å¯ä»¥æ”¹ä¸‹é¢çš„limit()çš„æ•°å­— #&#125;<br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;recent-posts-list&quot;</span>&gt;</span><br>      &#123;% for post in cat.posts.sort(&#x27;date&#x27;, -1).limit(3).toArray() %&#125;<br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;recent-post-item&quot;</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;&#123;&#123; url_for(post.path) &#125;&#125;&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;post-title&quot;</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&quot;&#123;&#123; post.title &#125;&#125;&quot;</span>&gt;</span><br>            &#123;&#123; post.title | truncate(18) &#125;&#125;<br>          <span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;post-date&quot;</span>&gt;</span><br>			&#123;% if post.updated %&#125; <br>				&#123;&#123; post.updated.format(&#x27;MM/DD&#x27;) &#125;&#125;<br>			&#123;% else %&#125;<br>				&#123;&#123; post.date.format(&#x27;MM/DD&#x27;) &#125;&#125;<br>			&#123;% endif %&#125;<br>		<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>      &#123;% endfor %&#125;<br><br><br> <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;more-posts-wrapper&quot;</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;&#123;&#123; url_for(&#x27;/categories/&#x27; + cat.name + &#x27;/&#x27;) &#125;&#125;&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;more-posts-button&quot;</span>&gt;</span><br>		æ›´å¤šæ–‡ç«  â†’<br>	<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>&#123;% endfor %&#125;<br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>&#123;% else %&#125;<br><br> <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;no-categories-notice&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>æš‚æ— åˆ†ç±»æ•°æ®ï¼Œè¯·ä¸ºæ–‡ç« æ·»åŠ åˆ†ç±»<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br><br>  &#123;% endif %&#125;<br><br>&#123;% endblock %&#125;<br><br>&#123;% block sidebar %&#125;<br>  &#123;&#123; sidebar_template.render(false) &#125;&#125;<br>&#123;% endblock %&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>source&#x2F;_data&#x2F;styles.stylï¼š</p>
<p>å¾—å…ˆåœ¨next&#x2F;config.ymlé‡Œæ‰“å¼€è¿™ä¸ªæ–‡ä»¶çš„æ”¯æŒï¼ˆå¯èƒ½æ˜¯æ–°ç‰¹æ€§å§ï¼Œç¬”è€…è®°å¾—ä¹‹å‰æ²¡æ”¹è¿‡configè®¾ç½®å°±æœ‰è¿™ä¸ªæ–‡ä»¶äº†ï¼Œä½†æ˜¯ç°åœ¨å¾—æ‰“å¼€æ”¯æŒå¹¶æ‰‹åŠ¨åˆ›å»º_dataæ–‡ä»¶å¤¹å’Œstyles.stylç­‰æ–‡ä»¶ï¼‰ï¼Œåœ¨custom_file_pathé‡Œåˆ é™¤styleçš„æ³¨é‡Š</p>
<p><img src="/../images/image-20250605144828365.png" alt="æ‰“å¼€æ–‡ä»¶æ”¯æŒ"></p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><code class="hljs stylus"><span class="hljs-comment">/* åˆ†ç±»å¡ç‰‡æ ·å¼ - å®‰å…¨è¿½åŠ  */</span><br><span class="hljs-selector-class">.category-cards-container</span> &#123;<br>  <span class="hljs-attribute">margin</span>: <span class="hljs-number">40px</span> auto;<br>  <span class="hljs-attribute">max-width</span>: <span class="hljs-number">1200px</span>;<br>  <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span> <span class="hljs-number">20px</span>;<br><br>  <span class="hljs-selector-class">.category-card</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>,<span class="hljs-number">255</span>,<span class="hljs-number">255</span>,<span class="hljs-number">0.85</span>); <span class="hljs-comment">/* åŠé€æ˜ç™½è‰²ï¼Œä¸ä½ çš„opacity 0.85åè°ƒ */</span><br>    <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">8px</span>;<br>    <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">2px</span> <span class="hljs-number">15px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0.1</span>);<br>    <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">25px</span>;<br>    <span class="hljs-attribute">padding</span>: <span class="hljs-number">25px</span>;<br>    <span class="hljs-attribute">transition</span>: all <span class="hljs-number">0.3s</span> ease;<br>    <span class="hljs-attribute">backdrop-filter</span>: <span class="hljs-built_in">blur</span>(<span class="hljs-number">2px</span>); <span class="hljs-comment">/* æ¯›ç»ç’ƒæ•ˆæœå¢å¼ºèƒŒæ™¯èåˆ */</span><br>    <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>,<span class="hljs-number">255</span>,<span class="hljs-number">255</span>,<span class="hljs-number">0.3</span>); <span class="hljs-comment">/* æŸ”å’Œè¾¹æ¡† */</span><br>    <br>    <span class="hljs-selector-pseudo">&amp;:hover</span> &#123;<br>      <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(-<span class="hljs-number">5px</span>);<br>      <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">5px</span> <span class="hljs-number">25px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0.15</span>);<br>    &#125;<br><br>    <span class="hljs-selector-class">.category-name</span> &#123;<br>      <span class="hljs-attribute">color</span>: <span class="hljs-number">#2c3e50</span>;<br>      <span class="hljs-attribute">font-size</span>: <span class="hljs-number">1.4em</span>;<br>      <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">8px</span> <span class="hljs-number">0</span>;<br>      <span class="hljs-attribute">font-weight</span>: <span class="hljs-number">600</span>;<br>    &#125;<br><br>    <span class="hljs-selector-class">.post-count</span> &#123;<br>      <span class="hljs-attribute">color</span>: <span class="hljs-number">#7f8c8d</span>;<br>      <span class="hljs-attribute">font-size</span>: <span class="hljs-number">0.9em</span>;<br>      <span class="hljs-attribute">display</span>: block;<br>    &#125;<br>  &#125;<br>&#125;<br><br><br><span class="hljs-comment">/* è¿™éƒ¨åˆ†æ˜¯æˆ‘è‡ªå·±ç”¨çš„èƒŒæ™¯å›¾çš„è®¾ç½® */</span><br><span class="hljs-selector-tag">body</span> &#123;<br>  <span class="hljs-attribute">background-image</span>: <span class="hljs-built_in">url</span>(/images/background.jpg);<br>  <span class="hljs-attribute">background-repeat</span>: no-repeat;<br>  <span class="hljs-attribute">background-attachment</span>: fixed;<br>  <span class="hljs-attribute">background-size</span>: <span class="hljs-number">100%</span> <span class="hljs-number">100%</span>;<br>  <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0.85</span>;<br>&#125;<br><span class="hljs-comment">/* ======================== */</span><br><span class="hljs-comment">/* åˆ†ç±»å¡ç‰‡å†…çš„æ–‡ç« åˆ—è¡¨æ ·å¼ */</span><br><span class="hljs-comment">/* ======================== */</span><br><br><span class="hljs-selector-class">.category-card</span> &#123;<br>  <span class="hljs-attribute">position</span>: relative; <span class="hljs-comment">/* ä¸ºæ¯›ç»ç’ƒæ•ˆæœæä¾›å®šä½ä¸Šä¸‹æ–‡ */</span><br>  <br>  <span class="hljs-selector-class">.category-header</span> &#123;<br>    <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">15px</span>;<br>    <span class="hljs-attribute">padding-bottom</span>: <span class="hljs-number">12px</span>;<br>    <span class="hljs-attribute">border-bottom</span>: <span class="hljs-number">1px</span> solid <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0.08</span>);<br>  &#125;<br><br>  <span class="hljs-selector-class">.recent-posts-list</span> &#123;<br>    <span class="hljs-attribute">margin-top</span>: <span class="hljs-number">10px</span>;<br>    <br>    <span class="hljs-selector-class">.recent-post-item</span> &#123;<br>      <span class="hljs-attribute">display</span>: flex;<br>      <span class="hljs-attribute">justify-content</span>: space-between;<br>      <span class="hljs-attribute">align-items</span>: center;<br>      <span class="hljs-attribute">padding</span>: <span class="hljs-number">8px</span> <span class="hljs-number">0</span>;<br>      <span class="hljs-attribute">transition</span>: all <span class="hljs-number">0.2s</span> ease;<br><br>      <br>      <span class="hljs-selector-pseudo">&amp;:hover</span> &#123;<br>        <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(<span class="hljs-number">3px</span>);<br>      &#125;<br><br>      <span class="hljs-selector-class">.post-title</span> &#123;<br>        <span class="hljs-attribute">color</span>: <span class="hljs-number">#34495e</span>;<br>        <span class="hljs-attribute">font-size</span>: <span class="hljs-number">0.95em</span>;<br>        <span class="hljs-attribute">flex-grow</span>: <span class="hljs-number">1</span>;<br>        <span class="hljs-attribute">white-space</span>: nowrap;<br>        <span class="hljs-attribute">overflow</span>: hidden;<br>        <span class="hljs-attribute">text-overflow</span>: ellipsis;<br>        <span class="hljs-attribute">padding-right</span>: <span class="hljs-number">10px</span>;<br>        <br>        <span class="hljs-selector-pseudo">&amp;:hover</span> &#123;<br>          <span class="hljs-attribute">color</span>: <span class="hljs-number">#3498db</span>;<br>          <span class="hljs-attribute">text-decoration</span>: underline;<br>        &#125;<br>      &#125;<br><br>      <span class="hljs-selector-class">.post-date</span> &#123;<br>        <span class="hljs-attribute">color</span>: <span class="hljs-number">#95a5a6</span>;<br>        <span class="hljs-attribute">font-size</span>: <span class="hljs-number">0.8em</span>;<br>        <span class="hljs-attribute">font-family</span>: <span class="hljs-string">&#x27;Arial&#x27;</span>, sans-serif;<br>        <span class="hljs-attribute">flex-shrink</span>: <span class="hljs-number">0</span>;<br>      &#125;<br>    &#125;<br>  &#125;<br>  * &#123;<br>    <span class="hljs-attribute">border-bottom</span>: none <span class="hljs-meta">!important</span>;<br>    <span class="hljs-attribute">box-shadow</span>: none <span class="hljs-meta">!important</span>;<br>  &#125;<br>  <br>  <span class="hljs-selector-class">.category-header</span>, <br>  <span class="hljs-selector-class">.recent-post-item</span>, <br>  <span class="hljs-selector-class">.recent-posts-list</span> &#123;<br>    <span class="hljs-attribute">border</span>: none <span class="hljs-meta">!important</span>;<br>    <span class="hljs-attribute">border-bottom</span>: none <span class="hljs-meta">!important</span>;<br>  &#125;<br>&#125;<br><br><span class="hljs-comment">/* æ›´å¤šæ–‡ç« æŒ‰é’®æ ·å¼ */</span><br><span class="hljs-selector-class">.more-posts-wrapper</span> &#123;<br>  <span class="hljs-attribute">text-align</span>: left;<br>  <span class="hljs-attribute">margin-top</span>: <span class="hljs-number">12px</span>;<br>  <span class="hljs-attribute">padding-top</span>: <span class="hljs-number">10px</span>;<br>  <br>  <span class="hljs-selector-class">.more-posts-button</span> &#123;<br>    <span class="hljs-attribute">display</span>: inline-block;<br>    <span class="hljs-attribute">color</span>:<span class="hljs-built_in">rgb</span>(<span class="hljs-number">72</span>, <span class="hljs-number">168</span>, <span class="hljs-number">241</span>);<br>    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">0.9em</span>;<br>    <span class="hljs-attribute">padding</span>: <span class="hljs-number">6px</span> <span class="hljs-number">12px</span>;<br>    <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">4px</span>;<br>    <span class="hljs-attribute">transition</span>: all <span class="hljs-number">0.3s</span> ease;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">52</span>, <span class="hljs-number">152</span>, <span class="hljs-number">219</span>, <span class="hljs-number">0.1</span>);<br>    <br>    <span class="hljs-selector-pseudo">&amp;:hover</span> &#123;<br>      <span class="hljs-attribute">background</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">52</span>, <span class="hljs-number">152</span>, <span class="hljs-number">219</span>, <span class="hljs-number">0.2</span>);<br>      <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(<span class="hljs-number">3px</span>);<br>    &#125;<br>    <br>    <br>    <br>    <span class="hljs-selector-pseudo">&amp;:hover</span><span class="hljs-selector-pseudo">::after</span> &#123;<br>      <span class="hljs-attribute">margin-left</span>: <span class="hljs-number">8px</span>;<br>    &#125;<br>  &#125;<br>&#125;<br><span class="hljs-comment">/* å“åº”å¼è°ƒæ•´ */</span><br><span class="hljs-keyword">@media</span> (<span class="hljs-attribute">max-width</span>: <span class="hljs-number">767px</span>) &#123;<br>  <span class="hljs-selector-class">.category-card</span> &#123;<br>    <span class="hljs-attribute">padding</span>: <span class="hljs-number">18px</span>;<br>    <br>    <span class="hljs-selector-class">.recent-post-item</span> &#123;<br>      <span class="hljs-attribute">flex-direction</span>: column;<br>      <span class="hljs-attribute">align-items</span>: flex-start;<br>      <br>      <span class="hljs-selector-class">.post-date</span> &#123;<br>        <span class="hljs-attribute">margin-top</span>: <span class="hljs-number">3px</span>;<br>        <span class="hljs-attribute">align-self</span>: flex-end;<br>      &#125;<br>    &#125;<br>  &#125;<br>&#125;<br>.posts-<span class="hljs-attribute">container</span>&#123;<br>    <span class="hljs-attribute">margin</span>: <span class="hljs-number">40px</span> auto;<br>    <span class="hljs-attribute">max-width</span>: <span class="hljs-number">1200px</span>;<br>    <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span> <span class="hljs-number">20px</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>æ•ˆæœè¯·è§â€œè®°ä¸€æ¬¡blogä¼˜åŒ–â€</p>
</li>
</ul>
<h2 id="ç‚¹å‡»æ›´å¤šæ–‡ç« åçš„æ–‡ç« åˆ—è¡¨å®ç°"><a href="#ç‚¹å‡»æ›´å¤šæ–‡ç« åçš„æ–‡ç« åˆ—è¡¨å®ç°" class="headerlink" title="ç‚¹å‡»æ›´å¤šæ–‡ç« åçš„æ–‡ç« åˆ—è¡¨å®ç°"></a>ç‚¹å‡»æ›´å¤šæ–‡ç« åçš„æ–‡ç« åˆ—è¡¨å®ç°</h2><ul>
<li><p>ä»ç„¶æ˜¯åŸºäºåŸæ¥çš„Index.njk</p>
</li>
<li><p>themes&#x2F;next&#x2F;layout&#x2F;category.njkï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><code class="hljs html">&#123;% extends &#x27;_layout.njk&#x27; %&#125;<br>&#123;% import &#x27;_macro/sidebar.njk&#x27; as sidebar_template with context %&#125;<br><br>&#123;% block title %&#125; <br>&#123;&#123; page.category &#125;&#125; | &#123;&#123; __(&#x27;title.category&#x27;) &#125;&#125; | &#123;&#123; config.title &#125;&#125;<br>&#123;% if theme.index_with_subtitle and subtitle %&#125; - &#123;&#123; subtitle &#125;&#125;&#123;% endif %&#125;<br>&#123;% endblock %&#125;<br><br>&#123;% block class %&#125;index posts-expand&#123;% endblock %&#125;<br><br>&#123;% block content %&#125;<br><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;category-title&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;text-align: center; margin: 30px 0;&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>&#123;&#123; page.category &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br>&#123;# æ–°å¢åŒ…è£¹å®¹å™¨å¹¶æ·»åŠ é—´è· class PS:è¿™ä¸€éƒ¨åˆ†æ˜¯ä¸ªäººæ„Ÿè§‰åˆ—è¡¨å¤ªè´´è¿‘ä¾§è¾¹æ äº†ï¼Œæ‰€ä»¥å’Œé¦–é¡µåˆ†ç±»å¡ç‰‡çš„ä½ç½®è®¾ç½®ä¿æŒä¸€è‡´äº†#&#125;<br>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;posts-container&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;margin-right: 30px ;&quot;</span>&gt;</span><br><br>  &#123;%- for post in page.posts.toArray() %&#125;<br>    &#123;&#123; partial(&#x27;_macro/post.njk&#x27;, &#123;post: post, is_index: true&#125;) &#125;&#125;<br>  &#123;%- endfor %&#125;<br><br>  &#123;%- include &#x27;_partials/pagination.njk&#x27; -%&#125;<br>  <br>&#123;% endblock %&#125;<br><br>&#123;% block sidebar %&#125;<br>  &#123;&#123; sidebar_template.render(false) &#125;&#125;<br>&#123;% endblock %&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>æ•ˆæœä»è§ä¸Šä¸€ç¯‡åšå®¢</p>
</li>
</ul>
<h2 id="åˆ é™¤ä¾§è¾¹æ ç›®å½•ä¸‹åˆ’çº¿ä¸æ–‡æœ«æ ‡ç­¾çš„â€œ-â€"><a href="#åˆ é™¤ä¾§è¾¹æ ç›®å½•ä¸‹åˆ’çº¿ä¸æ–‡æœ«æ ‡ç­¾çš„â€œ-â€" class="headerlink" title="åˆ é™¤ä¾§è¾¹æ ç›®å½•ä¸‹åˆ’çº¿ä¸æ–‡æœ«æ ‡ç­¾çš„â€œ#â€"></a>åˆ é™¤ä¾§è¾¹æ ç›®å½•ä¸‹åˆ’çº¿ä¸æ–‡æœ«æ ‡ç­¾çš„â€œ#â€</h2><ul>
<li>è¿™ä¸¤ä¸ªéƒ¨åˆ†æ²¡æœ‰å˜åŠ¨ï¼Œé™¤äº†æ–‡ä»¶åçš„åç¼€æ”¹å˜äº†ï¼Œå…¶ä½™éƒ½ä¸€æ ·ã€‚è¯¦è§ä¸Šä¸€ç¯‡åšå®¢ã€‚</li>
</ul>
<h2 id="utterancesè¯„è®ºç³»ç»Ÿ"><a href="#utterancesè¯„è®ºç³»ç»Ÿ" class="headerlink" title="utterancesè¯„è®ºç³»ç»Ÿ"></a>utterancesè¯„è®ºç³»ç»Ÿ</h2><ul>
<li><p>æ–°ç‰ˆæœ¬NexTå·²ç»ä¸æ”¯æŒvalineäº†ï¼Œç»™çš„é€‰é¡¹åªæœ‰ï¼š</p>
<p><img src="/../images/image-20250605150357372.png" alt="è¯„è®ºç³»ç»Ÿé€‰é¡¹"></p>
</li>
<li><p>æ‰€ä»¥ç¬”è€…é€‰äº†utterancesã€‚è¿™ä¸ªç³»ç»Ÿå¥½åƒå’Œgithubæœ‰ç‚¹å…³ç³»</p>
</li>
<li><p>åœ¨next&#x2F;config.ymlçš„commentsé‡ŒæŠŠactiveæ”¹æˆutterances</p>
<p><img src="/../images/image-20250605150655597.png" alt="é€‰æ‹©utterances"></p>
</li>
<li><p>ç„¶åéœ€è¦ç»™githubä»“åº“å®‰è£…utterancesï¼Œè®¿é—®<a href="https://github.com/apps/utterances">https://github.com/apps/utterances</a> ï¼Œç„¶åç‚¹å‡»Install</p>
<p><img src="/../images/image-20250605185949763.png" alt="install utterances"></p>
</li>
<li><p>åœ¨è·³è½¬çš„é¡µé¢å‹¾é€‰only select repositoriesï¼Œç„¶åé€‰æ‹©åšå®¢ä»“åº“</p>
<p><img src="/../images/image-20250605190153428.png" alt="select repositories"></p>
</li>
<li><p>ç‚¹å‡»installå°±å¯ä»¥äº†</p>
</li>
<li><p>è¦æ³¨æ„çš„æ˜¯ï¼Œhexo sä¸‹æ˜¯è°ƒè¯•ä¸äº†è¿™ä¸ªåŠŸèƒ½çš„ï¼ˆè™½ç„¶ä¸çŸ¥é“æˆ‘ä¸ºä»€ä¹ˆè¦åœ¨hexo sä¸‹è°ƒè¯•è¿™ä¸ªåŠŸèƒ½ï¼‰ï¼Œä¼šæŠ¥é”™ï¼Œä½†æ˜¯éƒ¨ç½²åæ˜¯å¯ä»¥æ­£å¸¸å·¥ä½œçš„</p>
</li>
</ul>
<h2 id="firestoreç»Ÿè®¡è®¿é—®äººæ•°"><a href="#firestoreç»Ÿè®¡è®¿é—®äººæ•°" class="headerlink" title="firestoreç»Ÿè®¡è®¿é—®äººæ•°"></a>firestoreç»Ÿè®¡è®¿é—®äººæ•°</h2><ul>
<li><p>NexT8.23.0ä¸æ”¯æŒValineäº†ï¼Œå¾—é‡æ–°é€‰æ‹©æ•°æ®ç»Ÿè®¡ç³»ç»Ÿã€‚firestoreæ˜¯googleçš„äº§å“ï¼Œå› æ­¤éœ€è¦ç§‘å­¦ä¸Šç½‘ã€‚</p>
</li>
<li><p>å‚è€ƒå¤§ä½¬åšå®¢ï¼š<a href="https://weirenxue.github.io/2021/06/11/hexo_next_firestore_visitors/">https://weirenxue.github.io/2021/06/11/hexo_next_firestore_visitors/</a>  æ­¥éª¤å¾ˆç®€æ´å®Œæ•´äº†ï¼Œä½†æ˜¯ä¸ªäººå®ç°çš„æ—¶å€™ä¼šæœ‰ä¸€äº›é—®é¢˜ï¼Œæ¥ä¸‹æ¥è¯¦ç»†ä»‹ç»ç›¸å…³æ­¥éª¤</p>
</li>
<li><p>é¦–å…ˆï¼Œåœ¨next&#x2F;config.ymlé‡Œå¯ç”¨firestoreï¼š</p>
<p><img src="/../images/image-20250605192012733.png" alt="å¯ç”¨firestore"></p>
</li>
<li><p>æœ‰ä¸¤ä¸ªç©ºéœ€è¦å¡«å†™ï¼Œapikeyå’ŒprojectIdã€‚ä¸æ€¥ï¼Œéœ€è¦å…ˆæœ‰firestoreçš„é¡¹ç›®ã€‚æ¥ä¸‹æ¥è®¿é—®firebaseï¼š<a href="https://console.firebase.google.com/">https://console.firebase.google.com/</a>  ï¼ˆç§‘å­¦ä¸Šç½‘ï¼‰</p>
</li>
<li><p>ç™»å½•åç‚¹å‡»â€œåˆ›å»ºé¡¹ç›®â€</p>
<p><img src="/../images/image-20250605192451907.png" alt="åˆ›å»ºé¡¹ç›®"></p>
</li>
<li><p>æ¥ä¸‹æ¥æŒ‰ç…§å¼•å¯¼èµ°ä¸‹å»ï¼Œå¼€å‘è€…è®¡åˆ’ã€AIè¾…åŠ©ã€google analyticsæ ¹æ®ä¸ªäººéœ€æ±‚é€‰æ‹©ï¼Œç‚¹å‡»ç»§ç»­å¹¶ç¨ç­‰ç‰‡åˆ»å°±åˆ›å»ºæˆåŠŸäº†ã€‚</p>
<p><img src="/../images/image-20250605192821032.png" alt="åˆ›å»ºæˆåŠŸ"></p>
</li>
<li><p>ç‚¹å‡»æ–°é¡¹ç›®ï¼Œåœ¨å·¦ä¸Šè§’â€œé¡¹ç›®æ¦‚è¿°â€é‡Œç‚¹â€œé¡¹ç›®è®¾ç½®â€</p>
<p><img src="/../images/image-20250605193218565.png" alt="é¡¹ç›®è®¾ç½®"></p>
<p>è¿™æ—¶å€™å¯ä»¥çœ‹è§é¡¹ç›®IDç­‰ä¿¡æ¯äº†ï¼Œä½†æ˜¯apiè¿˜æ²¡æœ‰æ˜¾ç¤º</p>
<p><img src="/../images/image-20250605193311734.png" alt="é¡¹ç›®è®¾ç½®ä¿¡æ¯"></p>
</li>
<li><p>æ¥ä¸‹æ¥åœ¨å·¦ä¾§è¾¹æ â€œæ„å»ºâ€é‡Œæ‰¾åˆ°â€œAuthenticationâ€ï¼Œç‚¹å‡»â€œå¼€å§‹â€ï¼ˆå“‡ï¼Œè¿™ä¸ªç•Œé¢è®¾ç½®æˆ‘è¿˜ä»¥ä¸ºgoogleä¸è®©æ‰‹åŠ¨è®¾ç½®åªèƒ½ç”¨AIäº†ï¼ŒçæŒ‰äº†åŠå¤©æ‰çŸ¥é“ç‚¹â€å¼€å§‹â€ï¼‰</p>
<p><img src="/../images/image-20250605193844508.png" alt="Authentication"></p>
</li>
<li><p>æ¥ä¸‹æ¥é€‰æ‹©ç™»é™†æ–¹å¼ç™»å½•å³å¯ã€‚æˆ‘é€‰æ‹©è°·æ­Œï¼Œç‚¹å‡»å³ä¸Šè§’å¯ç”¨ï¼Œé¡¹ç›®å…¬å¼€åç§°é»˜è®¤å³å¯ï¼Œé¡¹ç›®æ”¯æŒé‚®ç®±é€‰æ‹©ä¸ªäººè°·æ­Œé‚®ç®±</p>
<p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-06-05%20194506.png" alt="ç™»å½•"></p>
</li>
<li><p>å›åˆ°é¡¹ç›®è®¾ç½®é¡µé¢ï¼Œå¯ä»¥çœ‹åˆ°apiå·²ç»å‡ºç°äº†</p>
<p><img src="/../images/image-20250605210227422.png" alt="apiå‡ºç°"></p>
</li>
<li><p>æ¥ä¸‹æ¥å°±å¯ä»¥æŠŠnext&#x2F;config.ymlé‡Œçš„projectIdå’ŒapiKeyå¡«ä¸Šäº†</p>
</li>
<li><p>ç„¶åæ‰“å¼€å·¦ä¾§è¾¹æ â€œæ„å»ºâ€é‡Œçš„â€œFirestore Databaseâ€ï¼Œç‚¹å‡»â€œåˆ›å»ºæ•°æ®åº“â€</p>
<p><img src="/../images/image-20250605210959567.png" alt="åˆ›å»ºæ•°æ®åº“"></p>
</li>
<li><p>æ¥ä¸‹æ¥çš„é¡µé¢ï¼Œè®¾ç½®ä½ç½®ï¼ˆæ•°æ®åº“IDä¼¼ä¹ä¸èƒ½æ”¹åŠ¨ï¼‰ï¼Œç„¶åä¸‹ä¸€æ­¥</p>
<p><img src="/../images/image-20250605211218445.png" alt="è®¾ç½®ä½ç½®"></p>
</li>
<li><p>æ¥ä¸‹æ¥é€‰æ‹©æµ‹è¯•æ¨¡å¼ï¼Œç­‰å¾…é¢„é…Cloud Firestore</p>
<p><img src="/../images/image-20250605211444337.png" alt="é€‰æ‹©æµ‹è¯•æ¨¡å¼"></p>
</li>
<li><p>åŠ è½½æˆåŠŸåé•¿è¿™æ ·</p>
<p><img src="/../images/image-20250605211643158.png" alt="databaseåˆ›å»ºæˆåŠŸå"></p>
</li>
<li><p>æ¥ä¸‹æ¥é‡æ–°éƒ¨ç½²åšå®¢åå°±å¯ä»¥æµ‹è¯•è®¡æ•°æœºåˆ¶æ˜¯å¦æ­£å¸¸äº†ã€‚ä½†æ˜¯ç¬”è€…åœ¨è¿™ä¸€æ­¥æŠ˜è…¾äº†å¾ˆä¹…ï¼Œå› ä¸ºè°ƒè¯•çš„æ—¶å€™å‘ç°ï¼š</p>
<p>1.æ•°æ®åº“çš„ä¿¡æ¯åœ¨ç¬¬ä¸€æ¬¡å¯ç”¨è®¡æ•°æœºåˆ¶åä¼šè‡ªåŠ¨ç”Ÿæˆï¼Œä½†æ˜¯å¯¹è¿™äº›ä¿¡æ¯è¿›è¡Œæ”¹åŠ¨åè®¡æ•°æœºåˆ¶å°±å¤±æ•ˆäº†  </p>
<p>2.å³ä½¿åœ¨è«åå…¶å¦™çš„æƒ…å†µä¸‹ï¼ˆå¯èƒ½æ˜¯å…³é—­firestoreé…ç½®åå†æ¬¡å¼€å¯çš„æƒ…å†µï¼‰é‡æ–°åˆå§‹åŒ–äº†æ•°æ®åº“ï¼Œè®¡æ•°1æ¬¡ä¹‹åå†æ€ä¹ˆè®¿é—®ï¼ˆå¦‚åˆ·æ–°ã€å…³é—­é¡µé¢é‡æ–°æ‰“å¼€ï¼‰ä¹Ÿä¸ä¼šè®°å½•ç¬¬2æ¬¡  </p>
</li>
<li><p>è¿˜æœ‰ä¸€äº›è°ƒè¯•è¿‡ç¨‹å‘ç°çš„é—®é¢˜ï¼Œä½†æ˜¯è°ƒè¯•è¿‡ç¨‹å¤ªä¹±äº†ä¸å¥½æè¿°ï¼Œæ‰€ä»¥ä¸‹é¢ç›´æ¥æŒ‡å‡ºé—®é¢˜å¹¶ç»™å‡ºè§£å†³æ–¹æ¡ˆ</p>
</li>
<li><p>é¦–å…ˆï¼Œfirestoreçš„è®¡æ•°æœºåˆ¶æœ‰ç‚¹ç‰¹åˆ«ï¼Œå®ƒä½¿ç”¨äº†localStorageæ¥åˆ¤æ–­æ˜¯å¦è®¿é—®è¿‡æ–‡ç« ï¼Œå¦‚æœè®¿é—®è¿‡æ–‡ç« ï¼Œå°†ä¸ä¼šå‡ºç°ç¬¬äºŒæ¬¡è®¡æ•°çš„æƒ…å†µï¼ˆæ°¸è¿œä¸ä¼šï¼Œé™¤éé‡ç½®localStorageï¼‰ã€‚è¿™ä¹Ÿè§£é‡Šäº†ä¸ºä»€ä¹ˆæ”¹åŠ¨æ•°æ®ä¿¡æ¯åè®¡æ•°æœºåˆ¶ä¼šå¤±æ•ˆï¼šå› ä¸ºæ²¡æœ‰ç¬¬äºŒæ¬¡è®¡æ•°ï¼Œæ‰€ä»¥æ•°æ®åº“ä¿¡æ¯ä¸ä¼šå†æ›´æ–°ã€‚å› æ­¤éœ€è¦å¯¹è®¡æ•°æœºåˆ¶è¿›è¡Œä¸€äº›ä¼˜åŒ–ï¼Œä¼˜åŒ–æ–¹æ¡ˆæ¥è‡ªDeepSeekï¼Œéœ€è¦æ”¹åŠ¨çš„é…ç½®ä¸ºnext&#x2F;source&#x2F;js&#x2F;third-party&#x2F;statistics&#x2F;firestore.js</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">/* global CONFIG, firebase */</span><br><br>firebase.<span class="hljs-title function_">initializeApp</span>(&#123;<br>  apiKey   : <span class="hljs-variable constant_">CONFIG</span>.<span class="hljs-property">firestore</span>.<span class="hljs-property">apiKey</span>,<br>  <span class="hljs-attr">projectId</span>: <span class="hljs-variable constant_">CONFIG</span>.<span class="hljs-property">firestore</span>.<span class="hljs-property">projectId</span><br>&#125;);<br><br>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">const</span> <span class="hljs-title function_">getCount</span> = (<span class="hljs-params">doc, increaseCount</span>) =&gt; &#123;<br>    <span class="hljs-comment">// IncreaseCount will be false when not in article page</span><br>    <span class="hljs-keyword">return</span> doc.<span class="hljs-title function_">get</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">d</span> =&gt;</span> &#123;<br>      <span class="hljs-comment">// Has no data, initialize count</span><br>      <span class="hljs-keyword">let</span> count = d.<span class="hljs-property">exists</span> ? d.<span class="hljs-title function_">data</span>().<span class="hljs-property">count</span> : <span class="hljs-number">0</span>;<br>      <span class="hljs-comment">// If first view this article</span><br>      <span class="hljs-keyword">if</span> (increaseCount) &#123;<br>        <span class="hljs-comment">// Increase count</span><br>        count++;<br>        doc.<span class="hljs-title function_">set</span>(&#123;<br>          count<br>        &#125;);<br>      &#125;<br>      <span class="hljs-keyword">return</span> count;<br>    &#125;);<br>  &#125;;<br><br>  <span class="hljs-keyword">const</span> db = firebase.<span class="hljs-title function_">firestore</span>();<br>  <span class="hljs-keyword">const</span> articles = db.<span class="hljs-title function_">collection</span>(<span class="hljs-variable constant_">CONFIG</span>.<span class="hljs-property">firestore</span>.<span class="hljs-property">collection</span>);<br><br>  <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;page:loaded&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable constant_">CONFIG</span>.<span class="hljs-property">page</span>.<span class="hljs-property">isPost</span>) &#123;<br>      <span class="hljs-comment">// Fix issue #118</span><br>      <span class="hljs-comment">// https://developer.mozilla.org/en-US/docs/Web/API/Node/textContent</span><br>      <span class="hljs-keyword">const</span> title = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.post-title&#x27;</span>).<span class="hljs-property">textContent</span>.<span class="hljs-title function_">trim</span>();<br>      <span class="hljs-keyword">const</span> doc = articles.<span class="hljs-title function_">doc</span>(title);<br>      <span class="hljs-keyword">let</span> increaseCount = <span class="hljs-variable constant_">CONFIG</span>.<span class="hljs-property">hostname</span> === location.<span class="hljs-property">hostname</span>;<br>      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">sessionStorage</span>.<span class="hljs-title function_">getItem</span>(title)) &#123;<br>        increaseCount = <span class="hljs-literal">false</span>;<br>      &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-comment">// Mark as visited in current session</span><br>        <span class="hljs-variable language_">sessionStorage</span>.<span class="hljs-title function_">setItem</span>(title, <span class="hljs-literal">true</span>);<br>      &#125;<br>      <span class="hljs-title function_">getCount</span>(doc, increaseCount).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">count</span> =&gt;</span> &#123;<br>        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.firestore-visitors-count&#x27;</span>).<span class="hljs-property">innerText</span> = count;<br>      &#125;).<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&#x27;Error updating count:&#x27;</span>, e));<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable constant_">CONFIG</span>.<span class="hljs-property">page</span>.<span class="hljs-property">isHome</span>) &#123;<br>      <span class="hljs-keyword">const</span> promises = [...<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">&#x27;.post-title&#x27;</span>)].<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">element</span> =&gt;</span> &#123;<br>        <span class="hljs-keyword">const</span> title = element.<span class="hljs-property">textContent</span>.<span class="hljs-title function_">trim</span>();<br>        <span class="hljs-keyword">const</span> doc = articles.<span class="hljs-title function_">doc</span>(title);<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_">getCount</span>(doc);<br>      &#125;);<br>      <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>(promises).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">counts</span> =&gt;</span> &#123;<br>        <span class="hljs-keyword">const</span> metas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">&#x27;.firestore-visitors-count&#x27;</span>);<br>        counts.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">val, idx</span>) =&gt;</span> &#123;<br>          metas[idx].<span class="hljs-property">innerText</span> = val;<br>        &#125;);<br>      &#125;).<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&#x27;Error fetching counts:&#x27;</span>, e));<br>    &#125;<br>  &#125;);<br>&#125;)();<br></code></pre></td></tr></table></figure>

<p>ç®€å•è§£é‡Šä¸€ä¸‹ä¼˜åŒ–çš„ä¸»è¦æ€è·¯ï¼šä½¿ç”¨sessionStorageæ›¿æ¢localStorageï¼Œè®¡æ•°æœºåˆ¶å˜ä¸ºä¼šè¯çº§ï¼Œå³æ¯æ¬¡æ‰“å¼€æ–‡ç« éƒ½ä¼šè®¡æ•°ï¼Œè€Œåˆ·æ–°ä¸ä¼šè®¡æ•°</p>
</li>
<li><p>é‚£ä¹ˆæ¥ä¸‹æ¥å°±è¦è®¾ç½®ä¸€ä¸‹æ•°æ®åº“çš„è§„åˆ™äº†ã€‚å¤§ä½¬çš„å®‰å…¨è§„åˆ™å¥½åƒæœ‰ä¸€äº›æ¼æ´ï¼Œä¸‹é¢æ˜¯DeepSeekç”Ÿæˆçš„å®‰å…¨è§„åˆ™ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript">rules_version = <span class="hljs-string">&#x27;2&#x27;</span>;<br>service cloud.<span class="hljs-property">firestore</span> &#123;<br>  match /databases/&#123;database&#125;/documents &#123;<br>    <span class="hljs-comment">// é’ˆå¯¹æ–‡ç« é›†åˆçš„è§„åˆ™</span><br>    match /articles/&#123;articleId&#125; &#123;<br>      <span class="hljs-comment">// å…è®¸æ‰€æœ‰äººè¯»å–</span><br>      allow <span class="hljs-attr">read</span>: <span class="hljs-keyword">if</span> <span class="hljs-literal">true</span>;<br>      <br>      <span class="hljs-comment">// åˆ›å»ºæ–°æ–‡æ¡£æ—¶çš„è§„åˆ™</span><br>      allow <span class="hljs-attr">create</span>: <span class="hljs-keyword">if</span> request.<span class="hljs-property">resource</span>.<span class="hljs-property">data</span>.<span class="hljs-title function_">keys</span>().<span class="hljs-title function_">hasOnly</span>([<span class="hljs-string">&quot;count&quot;</span>]) <br>                   &amp;&amp; request.<span class="hljs-property">resource</span>.<span class="hljs-property">data</span>.<span class="hljs-property">count</span> == <span class="hljs-number">1</span>;<br>      <br>      <span class="hljs-comment">// æ›´æ–°æ–‡æ¡£æ—¶çš„è§„åˆ™ï¼ˆç¡®ä¿countåªèƒ½+1ï¼‰</span><br>      allow <span class="hljs-attr">update</span>: <span class="hljs-keyword">if</span> request.<span class="hljs-property">resource</span>.<span class="hljs-property">data</span>.<span class="hljs-title function_">keys</span>().<span class="hljs-title function_">hasOnly</span>([<span class="hljs-string">&quot;count&quot;</span>])<br>                   &amp;&amp; request.<span class="hljs-property">resource</span>.<span class="hljs-property">data</span>.<span class="hljs-property">count</span> == resource.<span class="hljs-property">data</span>.<span class="hljs-property">count</span> + <span class="hljs-number">1</span>;<br>    &#125;<br><br>    <span class="hljs-comment">// ç¦æ­¢å…¶ä»–æ‰€æœ‰æ“ä½œ</span><br>    match /&#123;<span class="hljs-variable language_">document</span>=**&#125; &#123;<br>      allow read, <span class="hljs-attr">write</span>: <span class="hljs-keyword">if</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>æ‰“å¼€â€œFirestore Databaseâ€çš„â€œè§„åˆ™â€ï¼ŒæŠŠè§„åˆ™ç²˜è´´è¿›å»ï¼Œç‚¹å‡»å‘å¸ƒå³å¯</p>
<p><img src="/../images/image-20250605214840666.png" alt="è®¾ç½®è§„åˆ™"></p>
</li>
</ul>
]]></content>
      <categories>
        <category>æ‚è®°</category>
      </categories>
      <tags>
        <tag>blog</tag>
        <tag>æ‚è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>è®°ä¸€æ¬¡blogä¼˜åŒ–</title>
    <url>/2025/06/02/%E8%AE%B0%E4%B8%80%E6%AC%A1blog%E4%BC%98%E5%8C%96/</url>
    <content><![CDATA[<p>Hexo+NexTåšå®¢çš„å°ä¼˜åŒ– (æ³¨ï¼šæ­¤ç¯‡è®°å½•çš„æ˜¯ç¬”è€…åŸæ¥å´©æºƒçš„åšå®¢çš„ä¼˜åŒ–ï¼Œæ˜¯æ—§ç‰ˆNexTä¼˜åŒ–)</p>
<span id="more"></span>

<ul>
<li>è¿™å‡ å¤©çªç„¶äº§ç”Ÿä¸€ä¸ªæƒ³æ³•ï¼šåšå®¢ä¸»é¡µæ”¹æˆåˆ†ç±»çš„æ ·å¼ä¼šä¸ä¼šæ›´å¥½çœ‹ä¸€ç‚¹ï¼Œä¸»é¡µæ˜¯ä¸»é¢˜é›†åˆï¼Œæ¯ä¸ªä¸»é¢˜é‡Œé¢æ‰æ˜¯ç›¸å…³çš„æ–‡ç« </li>
<li>å¿ƒåŠ¨ä¸å¦‚è¡ŒåŠ¨ï¼Œç›´æ¥å¼€å¹²ï¼</li>
</ul>
<h2 id="é¦–é¡µåˆ†ç±»å¡ç‰‡å®ç°"><a href="#é¦–é¡µåˆ†ç±»å¡ç‰‡å®ç°" class="headerlink" title="é¦–é¡µåˆ†ç±»å¡ç‰‡å®ç°"></a>é¦–é¡µåˆ†ç±»å¡ç‰‡å®ç°</h2><ul>
<li><p>è¿™éƒ¨åˆ†å…¶å®èŠ±äº†ä¸å°‘æ—¶é—´ï¼Œå› ä¸ºæ²¡æœ‰å…·ä½“å­¦è¿‡Hexo+NexTçš„ç»“æ„ï¼Œå¥½åœ¨æœ‰Deepseekè€å¸ˆçš„å¸®åŠ©</p>
</li>
<li><p>ä¿®æ”¹çš„éƒ¨åˆ†ä¸»è¦åœ¨themes&#x2F;next&#x2F;layout&#x2F;index.swigï¼Œä¸‹é¢ç›´æ¥è´´ä»£ç ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><code class="hljs html">&#123;% extends &#x27;_layout.swig&#x27; %&#125;<br>&#123;% import &#x27;_macro/sidebar.swig&#x27; as sidebar_template with context %&#125;<br><br>&#123;% block title %&#125;&#123;&#123; title &#125;&#125;&#123;%- if theme.index_with_subtitle and subtitle %&#125; - &#123;&#123; subtitle &#125;&#125;&#123;%- endif %&#125;&#123;% endblock %&#125;<br><br>&#123;% block class %&#125;index categories-page&#123;% endblock %&#125;<br><br>&#123;% block content %&#125;<br><br>&#123;# è¿™éƒ¨åˆ†æ˜¯å®ç°categoryå¡ç‰‡ï¼Œæœ€åé¢è¿˜æœ‰æ²¡categoryçš„æ–‡ç« çš„å¤„ç†ï¼Œå› ä¸ºæˆ‘ä¸¥æ ¼äº†æ¯ç¯‡æ–‡ç« æœ‰categoryï¼Œå°±æ²¡ç®¡ç”»é¢å¦‚ä½•äº† #&#125;<br>&#123;% if site.categories.length &gt; 0 %&#125;<br><br>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;category-cards-container&quot;</span>&gt;</span><br>    &#123;% for cat in site.categories.toArray() %&#125;<br>      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;category-card&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;category-header&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">h2</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;category-name&quot;</span>&gt;</span>&#123;&#123; cat.name &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;post-count&quot;</span>&gt;</span>&#123;&#123; cat.posts.length &#125;&#125;ç¯‡æ–‡ç« <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>          <span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br><br>        &#123;# è¿™ä¸€éƒ¨åˆ†å®ç°å¡ç‰‡æ˜¾ç¤ºåŒ…å«çš„æ–‡ç« çš„æ ‡é¢˜ï¼Œæ•°é‡å¯ä»¥æ”¹ä¸‹é¢çš„limit()çš„æ•°å­— #&#125;<br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;recent-posts-list&quot;</span>&gt;</span><br>          &#123;% for post in cat.posts.sort(&#x27;date&#x27;, -1).limit(3).toArray() %&#125;<br>            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;recent-post-item&quot;</span>&gt;</span><br>              <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;&#123;&#123; url_for(post.path) &#125;&#125;&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;post-title&quot;</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&quot;&#123;&#123; post.title &#125;&#125;&quot;</span>&gt;</span><br>                &#123;&#123; post.title | truncate(18) &#125;&#125;<br>              <span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>              <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;post-date&quot;</span>&gt;</span><br>    			&#123;% if post.updated %&#125; <br>    				&#123;&#123; post.updated.format(&#x27;MM/DD&#x27;) &#125;&#125;<br>    			&#123;% else %&#125;<br>    				&#123;&#123; post.date.format(&#x27;MM/DD&#x27;) &#125;&#125;<br>    			&#123;% endif %&#125;<br>    		<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>          &#123;% endfor %&#125;<br>            <br>         <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;more-posts-wrapper&quot;</span>&gt;</span><br>    		<span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;&#123;&#123; url_for(&#x27;/categories/&#x27; + cat.name + &#x27;/&#x27;) &#125;&#125;&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;more-posts-button&quot;</span>&gt;</span><br>      			æ›´å¤šæ–‡ç«  â†’<br>    		<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>    	<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>            <br>        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    &#123;% endfor %&#125;<br>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>&#123;% else %&#125;<br><br>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;no-categories-notice&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>æš‚æ— åˆ†ç±»æ•°æ®ï¼Œè¯·ä¸ºæ–‡ç« æ·»åŠ åˆ†ç±»<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br>&#123;% endif %&#125;<br><br>&#123;% endblock %&#125;<br><br>&#123;% block sidebar %&#125;<br>  &#123;&#123; sidebar_template.render(false) &#125;&#125;<br>&#123;% endblock %&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>è¿˜æœ‰source&#x2F;_data&#x2F;styles.styl</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><code class="hljs stylus"><span class="hljs-comment">/* åˆ†ç±»å¡ç‰‡æ ·å¼ - å®‰å…¨è¿½åŠ  */</span><br><span class="hljs-selector-class">.category-cards-container</span> &#123;<br>  <span class="hljs-attribute">margin</span>: <span class="hljs-number">40px</span> auto;<br>  <span class="hljs-attribute">max-width</span>: <span class="hljs-number">1200px</span>;<br>  <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span> <span class="hljs-number">20px</span>;<br><br>  <span class="hljs-selector-class">.category-card</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>,<span class="hljs-number">255</span>,<span class="hljs-number">255</span>,<span class="hljs-number">0.85</span>); <span class="hljs-comment">/* åŠé€æ˜ç™½è‰²ï¼Œä¸ä½ çš„opacity 0.85åè°ƒ */</span><br>    <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">8px</span>;<br>    <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">2px</span> <span class="hljs-number">15px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0.1</span>);<br>    <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">25px</span>;<br>    <span class="hljs-attribute">padding</span>: <span class="hljs-number">25px</span>;<br>    <span class="hljs-attribute">transition</span>: all <span class="hljs-number">0.3s</span> ease;<br>    <span class="hljs-attribute">backdrop-filter</span>: <span class="hljs-built_in">blur</span>(<span class="hljs-number">2px</span>); <span class="hljs-comment">/* æ¯›ç»ç’ƒæ•ˆæœå¢å¼ºèƒŒæ™¯èåˆ */</span><br>    <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>,<span class="hljs-number">255</span>,<span class="hljs-number">255</span>,<span class="hljs-number">0.3</span>); <span class="hljs-comment">/* æŸ”å’Œè¾¹æ¡† */</span><br>    <br>    <span class="hljs-selector-pseudo">&amp;:hover</span> &#123;<br>      <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(-<span class="hljs-number">5px</span>);<br>      <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">5px</span> <span class="hljs-number">25px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0.15</span>);<br>    &#125;<br><br>    <span class="hljs-selector-class">.category-name</span> &#123;<br>      <span class="hljs-attribute">color</span>: <span class="hljs-number">#2c3e50</span>;<br>      <span class="hljs-attribute">font-size</span>: <span class="hljs-number">1.4em</span>;<br>      <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">8px</span> <span class="hljs-number">0</span>;<br>      <span class="hljs-attribute">font-weight</span>: <span class="hljs-number">600</span>;<br>    &#125;<br><br>    <span class="hljs-selector-class">.post-count</span> &#123;<br>      <span class="hljs-attribute">color</span>: <span class="hljs-number">#7f8c8d</span>;<br>      <span class="hljs-attribute">font-size</span>: <span class="hljs-number">0.9em</span>;<br>      <span class="hljs-attribute">display</span>: block;<br>    &#125;<br>  &#125;<br>&#125;<br><br><br><span class="hljs-comment">/* è¿™éƒ¨åˆ†æ˜¯æˆ‘è‡ªå·±ç”¨çš„èƒŒæ™¯å›¾çš„è®¾ç½® */</span><br><span class="hljs-selector-tag">body</span> &#123;<br>  <span class="hljs-attribute">background-image</span>: <span class="hljs-built_in">url</span>(/images/background.jpg);<br>  <span class="hljs-attribute">background-repeat</span>: no-repeat;<br>  <span class="hljs-attribute">background-attachment</span>: fixed;<br>  <span class="hljs-attribute">background-size</span>: <span class="hljs-number">100%</span> <span class="hljs-number">100%</span>;<br>  <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0.85</span>;<br>&#125;<br><span class="hljs-comment">/* ======================== */</span><br><span class="hljs-comment">/* åˆ†ç±»å¡ç‰‡å†…çš„æ–‡ç« åˆ—è¡¨æ ·å¼ */</span><br><span class="hljs-comment">/* ======================== */</span><br><br><span class="hljs-selector-class">.category-card</span> &#123;<br>  <span class="hljs-attribute">position</span>: relative; <span class="hljs-comment">/* ä¸ºæ¯›ç»ç’ƒæ•ˆæœæä¾›å®šä½ä¸Šä¸‹æ–‡ */</span><br>  <br>  <span class="hljs-selector-class">.category-header</span> &#123;<br>    <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">15px</span>;<br>    <span class="hljs-attribute">padding-bottom</span>: <span class="hljs-number">12px</span>;<br>    <span class="hljs-attribute">border-bottom</span>: <span class="hljs-number">1px</span> solid <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0.08</span>);<br>  &#125;<br><br>  <span class="hljs-selector-class">.recent-posts-list</span> &#123;<br>    <span class="hljs-attribute">margin-top</span>: <span class="hljs-number">10px</span>;<br>    <br>    <span class="hljs-selector-class">.recent-post-item</span> &#123;<br>      <span class="hljs-attribute">display</span>: flex;<br>      <span class="hljs-attribute">justify-content</span>: space-between;<br>      <span class="hljs-attribute">align-items</span>: center;<br>      <span class="hljs-attribute">padding</span>: <span class="hljs-number">8px</span> <span class="hljs-number">0</span>;<br>      <span class="hljs-attribute">transition</span>: all <span class="hljs-number">0.2s</span> ease;<br><br>      <br>      <span class="hljs-selector-pseudo">&amp;:hover</span> &#123;<br>        <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(<span class="hljs-number">3px</span>);<br>      &#125;<br><br>      <span class="hljs-selector-class">.post-title</span> &#123;<br>        <span class="hljs-attribute">color</span>: <span class="hljs-number">#34495e</span>;<br>        <span class="hljs-attribute">font-size</span>: <span class="hljs-number">0.95em</span>;<br>        <span class="hljs-attribute">flex-grow</span>: <span class="hljs-number">1</span>;<br>        <span class="hljs-attribute">white-space</span>: nowrap;<br>        <span class="hljs-attribute">overflow</span>: hidden;<br>        <span class="hljs-attribute">text-overflow</span>: ellipsis;<br>        <span class="hljs-attribute">padding-right</span>: <span class="hljs-number">10px</span>;<br>        <br>        <span class="hljs-selector-pseudo">&amp;:hover</span> &#123;<br>          <span class="hljs-attribute">color</span>: <span class="hljs-number">#3498db</span>;<br>          <span class="hljs-attribute">text-decoration</span>: underline;<br>        &#125;<br>      &#125;<br><br>      <span class="hljs-selector-class">.post-date</span> &#123;<br>        <span class="hljs-attribute">color</span>: <span class="hljs-number">#95a5a6</span>;<br>        <span class="hljs-attribute">font-size</span>: <span class="hljs-number">0.8em</span>;<br>        <span class="hljs-attribute">font-family</span>: <span class="hljs-string">&#x27;Arial&#x27;</span>, sans-serif;<br>        <span class="hljs-attribute">flex-shrink</span>: <span class="hljs-number">0</span>;<br>      &#125;<br>    &#125;<br>  &#125;<br>  * &#123;<br>    <span class="hljs-attribute">border-bottom</span>: none <span class="hljs-meta">!important</span>;<br>    <span class="hljs-attribute">box-shadow</span>: none <span class="hljs-meta">!important</span>;<br>  &#125;<br>  <br>  <span class="hljs-selector-class">.category-header</span>, <br>  <span class="hljs-selector-class">.recent-post-item</span>, <br>  <span class="hljs-selector-class">.recent-posts-list</span> &#123;<br>    <span class="hljs-attribute">border</span>: none <span class="hljs-meta">!important</span>;<br>    <span class="hljs-attribute">border-bottom</span>: none <span class="hljs-meta">!important</span>;<br>  &#125;<br>&#125;<br><br><span class="hljs-comment">/* æ›´å¤šæ–‡ç« æŒ‰é’®æ ·å¼ */</span><br><span class="hljs-selector-class">.more-posts-wrapper</span> &#123;<br>  <span class="hljs-attribute">text-align</span>: left;<br>  <span class="hljs-attribute">margin-top</span>: <span class="hljs-number">12px</span>;<br>  <span class="hljs-attribute">padding-top</span>: <span class="hljs-number">10px</span>;<br>  <br>  <span class="hljs-selector-class">.more-posts-button</span> &#123;<br>    <span class="hljs-attribute">display</span>: inline-block;<br>    <span class="hljs-attribute">color</span>:<span class="hljs-built_in">rgb</span>(<span class="hljs-number">72</span>, <span class="hljs-number">168</span>, <span class="hljs-number">241</span>);<br>    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">0.9em</span>;<br>    <span class="hljs-attribute">padding</span>: <span class="hljs-number">6px</span> <span class="hljs-number">12px</span>;<br>    <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">4px</span>;<br>    <span class="hljs-attribute">transition</span>: all <span class="hljs-number">0.3s</span> ease;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">52</span>, <span class="hljs-number">152</span>, <span class="hljs-number">219</span>, <span class="hljs-number">0.1</span>);<br>    <br>    <span class="hljs-selector-pseudo">&amp;:hover</span> &#123;<br>      <span class="hljs-attribute">background</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">52</span>, <span class="hljs-number">152</span>, <span class="hljs-number">219</span>, <span class="hljs-number">0.2</span>);<br>      <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(<span class="hljs-number">3px</span>);<br>    &#125;<br>    <br>    <br>    <br>    <span class="hljs-selector-pseudo">&amp;:hover</span><span class="hljs-selector-pseudo">::after</span> &#123;<br>      <span class="hljs-attribute">margin-left</span>: <span class="hljs-number">8px</span>;<br>    &#125;<br>  &#125;<br>&#125;<br><span class="hljs-comment">/* å“åº”å¼è°ƒæ•´ */</span><br><span class="hljs-keyword">@media</span> (<span class="hljs-attribute">max-width</span>: <span class="hljs-number">767px</span>) &#123;<br>  <span class="hljs-selector-class">.category-card</span> &#123;<br>    <span class="hljs-attribute">padding</span>: <span class="hljs-number">18px</span>;<br>    <br>    <span class="hljs-selector-class">.recent-post-item</span> &#123;<br>      <span class="hljs-attribute">flex-direction</span>: column;<br>      <span class="hljs-attribute">align-items</span>: flex-start;<br>      <br>      <span class="hljs-selector-class">.post-date</span> &#123;<br>        <span class="hljs-attribute">margin-top</span>: <span class="hljs-number">3px</span>;<br>        <span class="hljs-attribute">align-self</span>: flex-end;<br>      &#125;<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>æ•ˆæœï¼š</p>
<p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-05-24%20223804.png" alt="åˆ†ç±»å¡ç‰‡æ•ˆæœ"></p>
</li>
</ul>
<h2 id="ç‚¹å‡»æ›´å¤šæ–‡ç« åçš„æ–‡ç« åˆ—è¡¨å®ç°"><a href="#ç‚¹å‡»æ›´å¤šæ–‡ç« åçš„æ–‡ç« åˆ—è¡¨å®ç°" class="headerlink" title="ç‚¹å‡»æ›´å¤šæ–‡ç« åçš„æ–‡ç« åˆ—è¡¨å®ç°"></a>ç‚¹å‡»æ›´å¤šæ–‡ç« åçš„æ–‡ç« åˆ—è¡¨å®ç°</h2><ul>
<li><p>è¿™éƒ¨åˆ†ä¸»è¦åŸºäºåŸæ¥çš„Index.swigï¼Œå› ä¸ºæˆ‘è§‰å¾—åŸæ¥çš„é£æ ¼å°±æŒºç®€æ´å¥½çœ‹çš„</p>
</li>
<li><p>æ‰¾åˆ°themes&#x2F;next&#x2F;layout&#x2F;category.swigï¼Œæ”¹æˆï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><code class="hljs html">&#123;% extends &#x27;_layout.swig&#x27; %&#125;<br>&#123;% import &#x27;_macro/sidebar.swig&#x27; as sidebar_template with context %&#125;<br><br>&#123;% block title %&#125;<br>  &#123;&#123; page.category &#125;&#125; | &#123;&#123; __(&#x27;title.category&#x27;) &#125;&#125; | &#123;&#123; config.title &#125;&#125;<br>  &#123;%- if theme.index_with_subtitle and config.subtitle %&#125; - &#123;&#123; config.subtitle &#125;&#125;&#123;%- endif %&#125;<br>&#123;% endblock %&#125;<br><br>&#123;% block class %&#125;category posts-expand&#123;% endblock %&#125;<br><br>&#123;% block content %&#125;<br><br>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;category-title&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;text-align: center; margin: 30px 0;&quot;</span>&gt;</span>//è¿™é‡ŒæŠŠåˆ†ç±»åç§°ç½®ä¸­äº†<br>    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>&#123;&#123; page.category &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br>  &#123;%- for post in page.posts.toArray() %&#125;<br>    &#123;&#123; partial(&#x27;_macro/post.swig&#x27;, &#123;post: post, is_index: true&#125;) &#125;&#125;<br>  &#123;%- endfor %&#125;<br><br>  &#123;% include &#x27;_partials/pagination.swig&#x27; %&#125;<br>&#123;% endblock %&#125;<br><br>&#123;% block sidebar %&#125;<br>  &#123;&#123; sidebar_template.render(false) &#125;&#125;<br>&#123;% endblock %&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>æ•ˆæœï¼š</p>
<p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-05-25%20000412-1749026329569-14.png" alt="æ–‡ç« åˆ—è¡¨æ•ˆæœ"></p>
</li>
</ul>
<h2 id="åˆ é™¤æ–‡ç« ä¾§è¾¹æ ç›®å½•éš¾çœ‹çš„ä¸‹åˆ’çº¿"><a href="#åˆ é™¤æ–‡ç« ä¾§è¾¹æ ç›®å½•éš¾çœ‹çš„ä¸‹åˆ’çº¿" class="headerlink" title="åˆ é™¤æ–‡ç« ä¾§è¾¹æ ç›®å½•éš¾çœ‹çš„ä¸‹åˆ’çº¿"></a>åˆ é™¤æ–‡ç« ä¾§è¾¹æ ç›®å½•éš¾çœ‹çš„ä¸‹åˆ’çº¿</h2><ul>
<li><p>åœ¨themes&#x2F;next&#x2F;layout&#x2F;_partials&#x2F;head.swig<strong>æœ€ååŠ ä¸Š</strong>ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><code class="hljs html"><span class="hljs-comment">&lt;!-- å¼ºåˆ¶ç§»é™¤ç›®å½•ä¸‹åˆ’çº¿ --&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="language-css"></span><br><span class="language-css">  <span class="hljs-comment">/* è¦†ç›–æ‰€æœ‰å¯èƒ½çš„ç›®å½•å®¹å™¨ */</span></span><br><span class="language-css">  <span class="hljs-selector-attr">[class*=<span class="hljs-string">&quot;toc&quot;</span>]</span> <span class="hljs-selector-class">.nav-item</span> <span class="hljs-selector-tag">a</span>,</span><br><span class="language-css">  <span class="hljs-selector-attr">[class*=<span class="hljs-string">&quot;TOC&quot;</span>]</span> <span class="hljs-selector-class">.nav-item</span> <span class="hljs-selector-tag">a</span>,</span><br><span class="language-css">  <span class="hljs-selector-class">.active</span> &gt; <span class="hljs-selector-tag">a</span>,</span><br><span class="language-css">  <span class="hljs-selector-class">.active-current</span> &gt; <span class="hljs-selector-tag">a</span> &#123;</span><br><span class="language-css">    <span class="hljs-attribute">border-bottom</span>: none <span class="hljs-meta">!important</span>;</span><br><span class="language-css">    <span class="hljs-attribute">text-decoration</span>: none <span class="hljs-meta">!important</span>;</span><br><span class="language-css">    <span class="hljs-attribute">box-shadow</span>: none <span class="hljs-meta">!important</span>;</span><br><span class="language-css">  &#125;</span><br><span class="language-css"></span><br><span class="language-css"></span><br><span class="language-css">  <span class="hljs-comment">/* è¦†ç›–ä¼ªå…ƒç´ ä¸‹åˆ’çº¿ */</span></span><br><span class="language-css">  <span class="hljs-selector-attr">[class*=<span class="hljs-string">&quot;toc&quot;</span>]</span> <span class="hljs-selector-tag">a</span><span class="hljs-selector-pseudo">::after</span>,</span><br><span class="language-css">  <span class="hljs-selector-attr">[class*=<span class="hljs-string">&quot;TOC&quot;</span>]</span> <span class="hljs-selector-tag">a</span><span class="hljs-selector-pseudo">::after</span> &#123;</span><br><span class="language-css">    <span class="hljs-attribute">display</span>: none <span class="hljs-meta">!important</span>;</span><br><span class="language-css">  &#125;</span><br><span class="language-css"></span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>æ•ˆæœï¼š</p>
<p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-05-24%20225421.png" alt="æ¶ˆé™¤ä¸‹åˆ’çº¿"></p>
</li>
</ul>
<h2 id="åˆ é™¤æ–‡æœ«æ ‡ç­¾æ–‡å­—å‰çš„â€œ-â€"><a href="#åˆ é™¤æ–‡æœ«æ ‡ç­¾æ–‡å­—å‰çš„â€œ-â€" class="headerlink" title="åˆ é™¤æ–‡æœ«æ ‡ç­¾æ–‡å­—å‰çš„â€œ#â€"></a>åˆ é™¤æ–‡æœ«æ ‡ç­¾æ–‡å­—å‰çš„â€œ#â€</h2><ul>
<li><p>å…ˆè¯´æ–‡ä»¶ï¼šthemes&#x2F;next&#x2F;layout&#x2F;_macro&#x2F;post.swig</p>
</li>
<li><p>è¿™ä¸ªé—®é¢˜ï¼Œç½‘ä¸Šæ‰¾åˆ°çš„è§£å†³æ–¹æ³•éƒ½æ˜¯åˆ æ‰11è¡Œçš„â€œ#â€</p>
<figure class="highlight html"><table><tr><td class="code"><pre><code class="hljs html">//è¿™æ˜¯åŸæ¥çš„ä»£ç ï¼Œå¯ä»¥ctrl+Fæœpost-footer<br><span class="hljs-tag">&lt;<span class="hljs-name">footer</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;post-footer&quot;</span>&gt;</span><br>    &#123;%- if post.tags and post.tags.length %&#125;<br>      &#123;%- if theme.tag_icon %&#125;<br>        &#123;%- set tag_indicate = &#x27;<span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;fa fa-tag&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span>&#x27; %&#125;<br>      &#123;% else %&#125;<br>        &#123;%- set tag_indicate = &#x27;#&#x27; %&#125;<br>      &#123;%- endif %&#125;<br>      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;post-tags&quot;</span>&gt;</span><br>        &#123;%- for tag in post.tags.toArray() %&#125;<br>          <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;&#123;&#123; url_for(tag.path) &#125;&#125;&quot;</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;tag&quot;</span>&gt;</span>#<span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;fa fa-tag&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span>&#123;&#123; tag_indicate &#125;&#125; &#123;&#123; tag.name &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>        &#123;%- endfor %&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>ä½†æ˜¯åˆ é™¤åå‘ç°â€œ#â€è¿˜åœ¨ã€‚æŠŠä»£ç ç»™DSçœ‹äº†ä¸‹ï¼Œå‘ç°ç¬¬7è¡ŒæŠŠtag_indicateè®¾æˆäº†â€œ#â€ï¼Œåˆ æ‰è¿™ä¸ªå°±å¯ä»¥äº†</p>
</li>
<li><p>æ•ˆæœï¼š</p>
<p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-05-24%20235657-1749026142443-7.png" alt="åˆ é™¤â€œ#â€"></p>
</li>
</ul>
<h2 id="æµ‹è¯•æ—¶é˜…è¯»æ–‡ç« ä¸è®¡æ•°"><a href="#æµ‹è¯•æ—¶é˜…è¯»æ–‡ç« ä¸è®¡æ•°" class="headerlink" title="æµ‹è¯•æ—¶é˜…è¯»æ–‡ç« ä¸è®¡æ•°"></a>æµ‹è¯•æ—¶é˜…è¯»æ–‡ç« ä¸è®¡æ•°</h2><ul>
<li><p>2025.6.2 æ³¨ï¼šåœ¨NexT8åçš„ç‰ˆæœ¬ï¼Œvalineä¸è¢«æ”¯æŒäº†</p>
</li>
<li><p>åšå®¢æ­èµ·æ¥åä¸€ç›´æœ‰ä¸ªé—®é¢˜ï¼Œå°±æ˜¯è‡ªå·±çœ‹è‡ªå·±çš„åšå®¢æ–‡ç« ä¼šè¢«è®¡æ•°ï¼Œæœ€å¼€å§‹æ˜¯ç”¨ublockå±è”½ç»Ÿè®¡ç½‘ç«™æ¥å®ç°ï¼Œä½†æ˜¯è¿™ä¸¤å¤©æµ‹è¯•äº†ä¸€ä¸‹å‘ç°è¿™ä¸ªæ–¹æ³•ç”¨æ‰‹æœºè®¿é—®ä¹Ÿä¸ä¼šè®¡æ•°ï¼Œè¿™ä¸å°±æ„å‘³ç€ç»Ÿè®¡åŠŸèƒ½ç˜«ç—ªäº†å—ğŸ˜®</p>
</li>
<li><p>æ‰€ä»¥å¼€å§‹å’ŒDSè€å¸ˆæ¢è®¨æ–°æ–¹æ³•ã€‚DSè€å¸ˆè¿™äººä¸å’‹è¡Œï¼Œå¥½æ–¹æ¡ˆè—ç€æ–ç€ï¼Œæ‹·é—®äº†åŠå¤©æ‰æœ‰äº†ä¸‹é¢çš„ç®€æ´çš„æ–¹æ³•ï¼š</p>
<ul>
<li><p>themes&#x2F;next&#x2F;layout&#x2F;_third-party&#x2F;comments&#x2F;valine.swigä¸­ï¼Œåœ¨new Valine({ })çš„æ‹¬å·é‡Œï¼ŒæŠŠvisitorè®¾ç½®æˆ</p>
<figure class="highlight html"><table><tr><td class="code"><pre><code class="hljs html">visitor    : (window.location.hostname === &#x27;localhost&#x27; || window.location.hostname === &#x27;127.0.0.1&#x27;) ? false : &#123;&#123; theme.valine.visitor &#125;&#125;,<br></code></pre></td></tr></table></figure>
</li>
<li><p>è¿™æ ·å­ï¼Œåœ¨hexo sä¸‹è®¿é—®localhostæŸ¥çœ‹æ–‡ç« ä¸ä¼šè¢«è®¡æ•°ã€‚DSè¯´è¿™æ˜¯æŠŠhexo så’Œhexo dä¸¤ä¸ªç¯å¢ƒéš”ç¦»äº†ï¼Œæ‰€ä»¥è¯´å¦‚æœhexo sä¸‹å‡ºç°æ–‡ç« é˜…è¯»æ•°ä¸ºé›¶çš„æƒ…å†µç®—æ­£å¸¸ï¼ˆæˆ‘å°±æ˜¯è¿™æ ·ï¼‰</p>
</li>
<li><p>å½“ç„¶äº†ï¼Œå¦‚æœè¦çœ‹é˜…è¯»æ•°ï¼Œå°±è¦è®¿é—®hexo déƒ¨ç½²åçš„ç½‘ç«™äº†ï¼Œè®°å¾—ä¸è¦ç‚¹è¿›æ–‡ç« å»çœ‹ï¼Œä¸ç„¶è¿˜æ˜¯ä¼šè¢«è®¡æ•°</p>
</li>
<li><p>éº»çƒ¦æ˜¯éº»çƒ¦äº†ç‚¹ï¼Œä½†åŠŸèƒ½è‡³å°‘æ˜¯å®ç°äº†</p>
</li>
</ul>
</li>
</ul>
]]></content>
      <categories>
        <category>æ‚è®°</category>
      </categories>
      <tags>
        <tag>blog</tag>
        <tag>æ‚è®°</tag>
      </tags>
  </entry>
</search>
