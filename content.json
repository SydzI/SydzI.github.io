{"posts":[{"title":"0xGame2025Week1WriteUp","text":"0xGame2025 Week1 Reverseæ–¹å‘å…¨è§£&amp;è¯¦è§£ EasyXor é™„ä»¶ç¨‹åºç”¨IDAæ‰“å¼€å°±æ˜¯mainå‡½æ•°çš„ä½ç½®äº†ï¼ŒæŒ‰F5åç¼–è¯‘å¾—åˆ°å¦‚ä¸‹ï¼š è¿›è¡Œä¸€äº›å°å°çš„å˜é‡åä¼˜åŒ–å¯ä»¥å¾—åˆ°ï¼š å¯ä»¥çœ‹å‡ºï¼Œå‡½æ•°è·å–flagè¾“å…¥ï¼Œç„¶åå¯¹flagæ¯ä¸€ä½è¿›è¡Œå¼‚æˆ–ï¼Œå¼‚æˆ–çš„å€¼æ¥è‡ªä¸€ä¸ªç»™å®šçš„å­—ç¬¦ä¸²ï¼Œè¦æ±‚å¼‚æˆ–åçš„å€¼è¦ç­‰äºstr[i]-iã€‚æ‰€ä»¥è§£å¯†æ€è·¯æ˜¯ï¼ŒæŠŠå¼‚æˆ–å…³ç³»ä¸­çš„Charå’Œstr[i]-iè¿›è¡Œå¯¹è°ƒï¼Œå³ç”±Char^key[index%length]==str[i]-iå¾—åˆ°( str[i]-i )^key[index%length]==Charã€‚è§£å¯†è„šæœ¬ï¼š 1234567891011121314151617#include&lt;stdio.h&gt;#include&lt;string.h&gt;int main() { char str[] = { 0x42, 0x1A, 0x39, 0x17, 0x1D, 0x09, 0x51, 0x55, 0x2C, 0x5F, 0x63, 0x0C, 0x0D, 0x16, 0x62, 0x27, 0x55, 0x64, 0x55, 0x26, 0x6D, 0x6A, 0x18, 0x34, 0x88, 0x65, 0x6E, 0x1C, 0x21, 0x6E, 0x3D, 0x23, 0x6A, 0x25, 0x6B, 0x63, 0x68, 0x7E, 0x77, 0x75, 0x9A, 0x7D, 0x39, 0x43, 0x00, 0x00, 0x00, 0x00 }; char key[] = &quot;raputa0xGame2025&quot;; char flag[45]; for (int i = 0; i &lt;= 43; i++) { flag[i] = (str[i] - i) ^ key[i % strlen(key)]; } flag[44] = '\\0'; printf(&quot;%s&quot;, flag); return 0;} BaseUpx é¢˜ç›®æç¤ºæœ‰Upxå£³ï¼Œç”¨DIEæ‰“å¼€é™„ä»¶ç¨‹åºå¯ä»¥çœ‹å‡ºè¿™æ˜¯æ ‡å‡†upx4.24 åœ¨Githubä¸Šä¸‹è½½Release UPX 4.2.4 Â· upx/upxï¼Œä½¿ç”¨æŒ‡ä»¤upx -dè„±å£³ ç„¶åå°±å¯ä»¥æŠŠè„±å£³åçš„ç¨‹åºæ‹¿åˆ°IDAé‡Œåˆ†æï¼Œæ‰“å¼€å°±æ˜¯mainå‡½æ•°äº†ï¼ŒæŒ‰F5åç¼–è¯‘ï¼š å¯ä»¥çœ‹åˆ°å‡½æ•°å¯¹è¾“å…¥çš„encï¼ˆå®é™…ä¸Šæ˜¯flagï¼‰è¿›è¡Œäº†base64encodeï¼Œç„¶åå’Œstrè¿›è¡Œæ¯”è¾ƒã€‚å› æ­¤æ€è·¯æ˜¯æ‹¿åˆ°strï¼Œç›´æ¥ç”¨CyberChefæ¥è¿›è¡Œbase64è§£ç ï¼š SignIn é™„ä»¶ç¨‹åºç”¨IDAæ‰“å¼€ï¼Œç›´æ¥å°±æ˜¯mainå‡½æ•°äº†ï¼ŒæŒ‰F5åç¼–è¯‘ï¼Œæç¤ºflagåœ¨ç¨‹åºé‡Œ shift+F12æŸ¥çœ‹å­—ç¬¦ä¸²è¡¨ï¼Œå°±å¯ä»¥æ‰¾åˆ°flagäº† SignIn2 è¿è¡Œé™„ä»¶ç¨‹åºå¯ä»¥çœ‹åˆ°ä¸€äº›æç¤ºï¼š æç¤ºROT47ï¼Œåº”è¯¥æ˜¯æŸç§åŠ å¯† é™„ä»¶ç¨‹åºç”¨IDAæ‰“å¼€ï¼ŒæŒ‰F5åç¼–è¯‘mainå‡½æ•°ï¼š å¯ä»¥çœ‹åˆ°ç¨‹åºé‡Œæœ¬æ¥å°±æœ‰ä¸€ä¸ªflagï¼Œç¨‹åºæ‹¿åˆ°æˆ‘ä»¬è¾“å…¥çš„æ•°å­—åå¯¹flagè¿›è¡Œäº†åŠ å¯†ï¼Œç„¶åæ£€æŸ¥åŠ å¯†åçš„flagå¼€å¤´å‡ ä¸ªå­—æ¯æ˜¯ä¸æ˜¯â€0xGameâ€ã€‚æ—¢ç„¶æåˆ°äº†ROT47ï¼Œå°±æŠŠflagçš„æ•°æ®æ‹¿åˆ°CyberChefé‡Œçœ‹çœ‹èƒ½ä¸èƒ½è§£å¯†ï¼Œåˆšå¥½å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªROT 47 Brust Forceï¼ˆflagå°±ç›´æ¥å¤åˆ¶ç¨‹åºé‡Œçš„å°±å¥½äº†ï¼‰ï¼š å½“æ—¶è§£å®Œæ²¡ç»†çœ‹flagå†…å®¹ï¼Œå¤ç°è¿™é¢˜æ¥å†™åšå®¢çš„æ—¶å€™çœ‹åˆ°è¿™ä¸ªflagè¿˜æœ‰ç‚¹æ€€ç–‘å¯¹ä¸å¯¹ğŸ˜‚ ZZZ é™„ä»¶ç¨‹åºç”¨IDAæ‰“å¼€ï¼Œç›´æ¥å°±æ˜¯mainå‡½æ•°äº†ï¼ŒæŒ‰F5åç¼–è¯‘ä¸€ä¸‹ï¼š å¯ä»¥çœ‹å‡ºç¨‹åºæ‹¿åˆ°è¾“å…¥çš„flagåå…ˆæ£€æŸ¥äº†ä¸€ä¸‹æ ¼å¼ï¼Œç„¶åæˆªå–é™¤äº†4ä¸ªéƒ¨åˆ†ï¼Œæ‹¿è¿™4ä¸ªéƒ¨åˆ†å»ºç«‹äº†ç­‰å¼ã€‚ç»“åˆé¢˜ç›®ZZZå¯ä»¥æ¨æµ‹è¿™æ˜¯åœ¨è€ƒz3æ±‚è§£ã€‚é¢˜ç›®ä¸ºäº†ä¿è¯å”¯ä¸€è§£è¿˜ç»™äº†flagçš„sha256æ¥éªŒè¯ ç”¨z3å¤ç°ä¸€ä¸‹ç­‰å¼ï¼Œå†åŠ ä¸Šsha256éªŒè¯ï¼š 123456789101112131415161718192021222324from z3 import *import hashlibsha256='4aba519d4666f5421488afaaf89efdcbe48e7a53f814ce5c1d82b46b55032651's=Solver()x1=BitVec('x1',32)x2=BitVec('x2',32)x3=BitVec('x3',32)x4=BitVec('x4',32)s.add(3 * x2 + 5 * x1 + 7 * x4 + 2 * x3 == -1445932505)s.add(2 * (2 * (2 * x2 + x3) + x1) + x4 == -672666814)s.add(7 * x2 + 3 * x1 + 5 * x4 + 4 * x3 == 958464147)s.add(((x1 ^ x2) &lt;&lt; 6) + ((x3 &gt;&gt; 6) ^ 0x4514) == 123074281)while s.check() == sat: model=s.model() x1_val=model[x1].as_long() x2_val=model[x2].as_long() x3_val=model[x3].as_long() x4_val=model[x4].as_long() flag=f&quot;0xGame{{{x1_val:08x}{x2_val:08x}{x3_val:08x}{x4_val:08x}}}&quot; if hashlib.sha256(flag.encode()).hexdigest()==sha256:#éªŒè¯æ˜¯å¦ä¸ºæ­£ç¡®flag print(flag) exception=Or(x1!=x1_val,x2!=x2_val,x3!=x3_val,x4!=x4_val)#æ’é™¤åŒä¸€è§£ s.add(exception) DyDebug é™„ä»¶ç¨‹åºç”¨IDAæ‰“å¼€ï¼Œç›´æ¥å°±æ˜¯mainå‡½æ•°äº†ï¼ŒæŒ‰F5çœ‹çœ‹åç¼–è¯‘ï¼š å¦‚æ³¨é‡Šå†™çš„ï¼Œç¨‹åºå¯¹æˆ‘ä»¬çš„è¾“å…¥æ²¡æœ‰ä»»ä½•æ“ä½œï¼Œè€Œæ˜¯æ‹¿äº†flagæ˜æ–‡æ¥æ¯”è¾ƒï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥åŠ¨æ€è°ƒè¯•æ‹¿åˆ°flagæ˜æ–‡ã€‚è¿™é‡Œéœ€è¦çŸ¥é“ä¸€äº›æ±‡ç¼–å°çŸ¥è¯†ï¼šå‡½æ•°çš„è¿”å›å€¼å­˜æ”¾åœ¨å¯„å­˜å™¨raxé‡Œã€‚ç„¶åå¼€å§‹æˆ‘ä»¬çš„æ“ä½œï¼š åœ¨mainå‡½æ•°åç¼–è¯‘ç•Œé¢é€‰ä¸­è§£å¯†å‡½æ•°decrypt_string()æ‰€åœ¨è¡Œï¼Œå³é”®é€‰æ‹©jump to disasmè·³åˆ°æ±‡ç¼–ç•Œé¢ï¼š å…‰æ ‡åœåœ¨çš„åœ°æ–¹é™„è¿‘å°±æœ‰ä¸€ä¸ªcall _Z14decrypt_stringPKcyæŒ‡ä»¤ï¼Œåé¢æœ‰æ³¨é‡Šæ˜¯è§£å¯†å‡½æ•°decrypt_string() å…¶å®å…‰æ ‡åœåœ¨çš„ä½ç½®çš„æŒ‡ä»¤å°±æ˜¯å–å‡½æ•°è¿”å›å€¼çš„æ“ä½œäº†ã€‚å‡½æ•°çš„è¿”å›å€¼æ”¾åœ¨raxé‡Œï¼Œè€Œè¿™æ¡æŒ‡ä»¤æŠŠrax movï¼ˆç§»åŠ¨ï¼‰åˆ°äº†[rbp-10h+decrypted_str]ï¼Œçœ‹ä¸æ‡‚æ²¡å…³ç³»ï¼Œåªéœ€è¦çŸ¥é“å‡½æ•°è¿”å›å€¼å¯ä»¥é€šè¿‡è¿™é‡Œçš„raxçœ‹åˆ°å°±è¡Œäº†ã€‚è¿™ä¸ªè¿”å›å€¼å°±æ˜¯è§£å¯†åå¾—åˆ°çš„flagæ˜æ–‡ã€‚åœ¨å…‰æ ‡åœåœ¨çš„ä½ç½®æŒ‰F2ä¸‹æ–­ç‚¹ æŠŠç•Œé¢æ­£ä¸Šæ–¹çš„â€no debuggerâ€æ”¹é€‰æˆâ€local windows debuggerâ€ï¼ŒæŒ‰æ—è¾¹ç»¿è‰²çš„ä¸‰è§’å½¢å¼€å§‹è°ƒè¯• è¿™æ—¶å€™ä¼šå¼¹å‡ºå‘½ä»¤è¡Œçª—å£ï¼Œéšä¾¿è¾“å…¥ä¸€ç‚¹ä¸œè¥¿ï¼ŒæŒ‰å›è½¦ å¯ä»¥çœ‹åˆ°IDAé‡Œç¨‹åºåœåœ¨äº†æˆ‘ä»¬åˆšåˆšä¸‹æ–­ç‚¹çš„åœ°æ–¹ æŠŠé¼ æ ‡ç§»åˆ°raxä¸Šå°±å¯ä»¥çœ‹åˆ°flagäº†ï¼ŒåŒå‡»raxåˆ°flagçš„ä½ç½®ï¼Œå¯ä»¥æŠŠè¿™ä¸€ä¸²æ•°æ®å¤åˆ¶ç»™AIæå–","link":"/2025/10/10/0xGame2025Week1ReverseWriteUp/"},{"title":"0xGame2025Week2WriteUp","text":"0xGame2025 Week2 Reverseæ–¹å‘å…¨è§£&amp;è¯¦è§£ shuffle é™„ä»¶ç”¨IDAæ‰“å¼€ï¼Œmainå‡½æ•°åç¼–è¯‘åå¤§æ¦‚é•¿è¿™æ ·ï¼š è¿™æ˜¯shuffleå‡½æ•°ï¼š å¯ä»¥çœ‹å‡ºè¿™æ˜¯åœ¨è€ƒéšæœºæ•°ï¼Œæœ‰äº†ç§å­å°±å¯ä»¥å¾—åˆ°ä¸€æ¨¡ä¸€æ ·çš„éšæœºæ•°åºåˆ—ã€‚å›åˆ°mainå‡½æ•°ï¼ŒåŒå‡»seedå¯ä»¥å¾—åˆ°ä¸€ä¸ªå€¼ï¼š ä½†æ˜¯ç»è¿‡æµ‹è¯•è¿™ä¸ªseedè§£ä¸å‡ºflagï¼Œå›å¤´çœ‹å¯ä»¥å‘ç°ä¸Šå›¾ä¸­seedè¿˜æœ‰å¦ä¸€ä¸ªå¼•ç”¨ï¼šruntime_envï¼Œå¾ˆå¯ç–‘äº†ã€‚åŒå‡»è·³è½¬ï¼š å‡ºç°äº†å¯¹seedçš„èµ‹å€¼ï¼Œç»“åˆåå­—çš„â€runtimeâ€å¯ä»¥æ¨æµ‹è¿™ä¸ªæ‰æ˜¯çœŸæ­£çš„seed è§£å¯†è„šæœ¬ï¼š 123456789101112131415161718192021222324252627282930313233343536#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;string.h&gt;void unshuffle_simple(unsigned char *str, int length) { int *rand_vals = (int*)malloc(length * sizeof(int)); unsigned char temp; int i, j; // å…ˆè·å–æ‰€æœ‰éšæœºå€¼ for (i = length - 1; i &gt; 0; --i) { rand_vals[i] = rand(); } // é€†å‘æ´—ç‰Œï¼šä»å‰å¾€å for (i = 1; i &lt; length; i++) { j = rand_vals[i] % (i + 1); // æ‰§è¡Œç›¸åŒçš„äº¤æ¢ temp = str[i]; str[i] = str[j]; str[j] = temp; } free(rand_vals);}int main() { unsigned int seed = 0x666; char flag[] = &quot;23-64bed6}-xm5300-{faGa34-0e04c2e7c2a78f39a4&quot;; int length = strlen(flag); srand(seed); unshuffle_simple((unsigned char*)flag, length); printf(&quot;flag: %s\\n&quot;, flag); return 0;} ç®—æ•°é«˜æ‰‹ é™„ä»¶ç¨‹åºæ˜¯ä¸ªpythonexeï¼Œç›¸å…³çŸ¥è¯†å¯ä»¥å‚è€ƒDay17:pythoné€†å‘ï¼ˆç‹å©†å–ç“œingã€‚ä½¿ç”¨pyinstxtractorè§£åŒ…åå¯ä»¥å¾—åˆ°ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼š æ ¹æ®pyinstxtractorçš„æç¤ºå¯ä»¥æ‰¾åˆ°ç–‘ä¼¼å…¥å£æ–‡ä»¶ï¼ŒåŒåçš„æ–‡ä»¶å¯èƒ½æ€§å¤§ç‚¹ã€‚ç„¶åç”¨uncompyle6æŠŠpycè½¬æˆpyæ ¼å¼ï¼š ç›´æ¥å¾—åˆ°flag BabyJar é™„ä»¶ç¨‹åºæ˜¯ä¸ªjaræ–‡ä»¶ï¼Œç”¨jd-guiæ‰“å¼€ï¼š å¯ä»¥çœ‹åˆ°è¿™æ˜¯ä¸€ä¸ªjavaçš„flagæ£€éªŒç¨‹åºï¼ŒåŠ å¯†é€»è¾‘åœ¨encryptæ–¹æ³•é‡Œã€‚ä¸Šå›¾é€‰ä¸­çš„é‚£è¡ŒæŠŠå­—èŠ‚çš„é«˜ä½ç§»åˆ°ä½ä½ï¼Œä½ä½ç§»åˆ°é«˜ä½ï¼Œæ‰€ä»¥å†æ“ä½œä¸€æ¬¡å°±å¯ä»¥è¿˜åŸã€‚è¿˜è¦æ³¨æ„encryptçš„è¿”å›å€¼è¿›è¡Œäº†base64ç¼–ç ã€‚ è§£å¯†è„šæœ¬ï¼š 123456789101112131415import base64def decrypt(enc,key): enc=base64.b64decode(enc) flag=&quot;&quot; for i in enc: temp=((i&amp;240)&gt;&gt;4|(i&amp;15)&lt;&lt;4) flag+=chr(temp^key) return flagenc=&quot;QsY1V5cX9jJyF2JSAgdikwfCEneTAgICUpNnd1Iyk8IXUkJ3QhcyZ8J3YpY=&quot;key=20flag=&quot;&quot;flag=decrypt(enc,key)print(flag) 16bit æ ¹æ®é¢˜ç›®åç§°å’Œæç¤ºå¯ä»¥æ¨æµ‹è€ƒå¯Ÿ16ä½ç¯å¢ƒé€†å‘ã€‚é™„ä»¶ç¨‹åºä¸èƒ½è¿è¡Œï¼ŒIDAä¹Ÿåç¼–è¯‘ä¸äº†ï¼Œåªèƒ½è¯»æ±‡ç¼–ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158seg000:0000 ; =============== S U B R O U T I N E =======================================seg000:0000seg000:0000 ; Attributes: noreturnseg000:0000seg000:0000 public startseg000:0000 start proc nearseg000:0000 mov ax, seg dsegseg000:0003 mov ds, ax ; dsegæ˜¯æ•°æ®æ®µï¼Œæœ‰flagåŠ å¯†åçš„æ•°æ®seg000:0005 assume ds:dsegseg000:0005 mov cx, 17h ; countå¯„å­˜å™¨ï¼Œä¸€èˆ¬å­˜æ”¾å¾ªç¯æ¬¡æ•°seg000:0008 mov si, 0seg000:000B mov di, 0seg000:000Eseg000:000E loc_1000E: ; CODE XREF: start+1Câ†“jseg000:000E mov al, [si+0Ah] ; si=0æ—¶[0Ah]å³dsegï¼š000Aï¼Œæ˜¯flagå¯†æ–‡çš„ä½ç½®ï¼Œæ­¤å¤„æ˜¯åœ¨å–å‡ºå¯†æ–‡seg000:0012 sub al, 9 ; å‡9seg000:0014 xor al, 0Eh ; å¼‚æˆ–seg000:0016 mov [di+38h], al ; è§£å¯†åçš„æ•°æ®å­˜æ”¾åˆ°ä»¥[38h]å³dseg:0038hä¸ºèµ·å§‹çš„åŒºåŸŸseg000:001A inc si ; å¾€ä¸‹å–seg000:001B inc di ; å¾€ä¸‹å­˜seg000:001C loop loc_1000E ; si=0æ—¶[0Ah]å³dsegï¼š000Aï¼Œæ˜¯flagå¯†æ–‡çš„ä½ç½®ï¼Œæ­¤å¤„æ˜¯åœ¨å–å‡ºå¯†æ–‡seg000:001E mov cx, 17h ; æ›´æ–°å¾ªç¯æ¬¡æ•°seg000:0021seg000:0021 loc_10021: ; CODE XREF: start+2Fâ†“jseg000:0021 mov al, [si+0Ah] ; æ­¤å¤„si=17h,æ‰€ä»¥å–çš„æ˜¯ä»¥dseg:0021hä¸ºèµ·å§‹çš„æ•°æ®seg000:0025 xor al, 0Eh ; å¼‚æˆ–seg000:0027 sub al, 9 ; å‡9seg000:0029 mov [di+38h], al ; è§£å¯†åçš„æ•°æ®å­˜æ”¾åˆ°seg:004fä¸ºèµ·å§‹çš„åŒºåŸŸseg000:002D inc si ; å¾€ä¸‹å–seg000:002E inc di ; å¾€ä¸‹å­˜seg000:002F loop loc_10021 ; æ­¤å¤„si=17h,æ‰€ä»¥å–çš„æ˜¯ä»¥dseg:0021hä¸ºèµ·å§‹çš„æ•°æ®seg000:0031 mov byte_100A6, 24h ; '$' ; byte_100A6æ˜¯&quot;flag=&quot;ï¼Œæ­¤å¤„æ˜¯åœ¨æ‰“å°flagseg000:0036 mov dx, 67h ; 'g'seg000:0039 mov ah, 9seg000:003B int 21h ; DOS - PRINT STRINGseg000:003B ; DS:DX -&gt; string terminated by &quot;$&quot;seg000:003D mov dx, 38h ; '8'seg000:0040 mov ah, 9seg000:0042 int 21h ; DOS - PRINT STRINGseg000:0042 ; DS:DX -&gt; string terminated by &quot;$&quot;seg000:0044 mov ax, 4C00hseg000:0047 int 21h ; DOS - 2+ - QUIT WITH EXIT CODE (EXIT)seg000:0047 start endp ; AL = exit codeseg000:0047seg000:0047 seg000 endsseg000:0047dseg:0009 ; ===========================================================================dseg:0009dseg:0009 ; Segment type: Pure datadseg:0009 dseg segment para public 'DATA' use16dseg:0009 assume cs:dsegdseg:0009 ;org 9dseg:0009 align 2dseg:000A db 47h ; Gdseg:000B db 7Fh ; dseg:000C db 52h ; Rdseg:000D db 78h ; xdseg:000E db 6Ch ; ldseg:000F db 74h ; tdseg:0010 db 7Eh ; ~dseg:0011 db 72h ; rdseg:0012 db 47h ; Gdseg:0013 db 47h ; Gdseg:0014 db 73h ; sdseg:0015 db 5Ah ; Zdseg:0016 db 84hdseg:0017 db 5Ah ; Zdseg:0018 db 43h ; Cdseg:0019 db 85hdseg:001A db 46h ; Fdseg:001B db 5Ah ; Zdseg:001C db 83hdseg:001D db 6Fh ; odseg:001E db 46h ; Fdseg:001F db 5Ah ; Zdseg:0020 db 6Ch ; ldseg:0021 db 33h ; 3dseg:0022 db 30h ; 0dseg:0023 db 73h ; sdseg:0024 db 32h ; 2dseg:0025 db 75h ; udseg:0026 db 66h ; fdseg:0027 db 37h ; 7dseg:0028 db 61h ; adseg:0029 db 66h ; fdseg:002A db 33h ; 3dseg:002B db 30h ; 0dseg:002C db 78h ; xdseg:002D db 66h ; fdseg:002E db 40h ; @dseg:002F db 35h ; 5dseg:0030 db 61h ; adseg:0031 db 4Eh ; Ndseg:0032 db 64h ; ddseg:0033 db 34h ; 4dseg:0034 db 65h ; edseg:0035 db 32h ; 2dseg:0036 db 33h ; 3dseg:0037 db 88hdseg:0038 db 0dseg:0039 db 0dseg:003A db 0dseg:003B db 0dseg:003C db 0dseg:003D db 0dseg:003E db 0dseg:003F db 0dseg:0040 db 0dseg:0041 db 0dseg:0042 db 0dseg:0043 db 0dseg:0044 db 0dseg:0045 db 0dseg:0046 db 0dseg:0047 db 0dseg:0048 db 0dseg:0049 db 0dseg:004A db 0dseg:004B db 0dseg:004C db 0dseg:004D db 0dseg:004E db 0dseg:004F db 0dseg:0050 db 0dseg:0051 db 0dseg:0052 db 0dseg:0053 db 0dseg:0054 db 0dseg:0055 db 0dseg:0056 db 0dseg:0057 db 0dseg:0058 db 0dseg:0059 db 0dseg:005A db 0dseg:005B db 0dseg:005C db 0dseg:005D db 0dseg:005E db 0dseg:005F db 0dseg:0060 db 0dseg:0061 db 0dseg:0062 db 0dseg:0063 db 0dseg:0064 db 0dseg:0065 db 0dseg:0066 byte_100A6 db 0 ; DATA XREF: start+31â†‘wdseg:0067 db 66h ; fdseg:0068 db 6Ch ; ldseg:0069 db 61h ; adseg:006A db 67h ; gdseg:006B db 20hdseg:006C db 3Dh ; =dseg:006D db 24h ; $dseg:006E db ? ;dseg:006F db ? ;dseg:006F dseg endsdseg:006Fseg002:0000 ; =========================================================================== å¯ä»¥çœ‹å‡ºç¨‹åºåˆ†ä¸¤éƒ¨åˆ†å¯¹flagçš„å¯†æ–‡è¿›è¡Œäº†è§£å¯†ï¼Œæ¨¡æ‹Ÿè¿™æ®µä»£ç å°±å¯ä»¥å¾—åˆ°flagã€‚è§£å¯†è„šæœ¬ï¼š 123456789101112131415161718192021222324252627data = [ 0x47, 0x7F, 0x52, 0x78, 0x6C, 0x74, 0x7E, 0x72, 0x47, 0x47, 0x73, 0x5A, 0x84, 0x5A, 0x43, 0x85, 0x46, 0x5A, 0x83, 0x6F, 0x46, 0x5A, 0x6C, 0x33, 0x30, 0x73, 0x32, 0x75, 0x66, 0x37, 0x61, 0x66, 0x33, 0x30, 0x78, 0x66, 0x40, 0x35, 0x61, 0x4E, 0x64, 0x34, 0x65, 0x32, 0x33, 0x88]output = []# ç¬¬ä¸€æ®µè§£å¯†ï¼ˆå‰ 0x17 å­—èŠ‚ï¼‰for i in range(0x17): al = data[i] al = (al - 9) &amp; 0xFF al = al ^ 0x0E output.append(al)# ç¬¬äºŒæ®µè§£å¯†ï¼ˆå 0x17 å­—èŠ‚ï¼‰for i in range(0x17,0x2E): al = data[i] al = al ^ 0x0E al = (al - 9) &amp; 0xFF output.append(al)# è¾“å‡ºä¸ºå­—ç¬¦ä¸²flag = ''.join(chr(i) for i in output)print(flag) TELF é¢˜ç›®æç¤ºåŠ å£³ï¼ŒDIEæ£€æŸ¥å‘ç°é™„ä»¶ç¨‹åºåŠ äº†upxå£³ï¼š è¿™æ˜¯ä¸ªelfæ–‡ä»¶ï¼Œè€ƒå¯Ÿelfæ‰‹åŠ¨è„±å£³çš„è¯éš¾åº¦ä¸å°ã€‚ä½¿ç”¨upxå·¥å…·ä¼šå‘ç°è„±ä¸äº†å£³ï¼Œæ¨æµ‹æœ‰upxç‰¹å¾é­”æ”¹ã€‚ç”¨010editoræ‰“å¼€é™„ä»¶ç¨‹åºï¼Œæ³¨æ„åˆ°å‡ºç°äº†å¯ç–‘å­—æ ·â€X1câ€ï¼š ä¿®æ”¹â€X1câ€ä¸ºâ€UPXâ€åç¨‹åºå¯æ­£å¸¸å·¥å…·è„±å£³ï¼š è„±å£³åçš„ç¨‹åºç”¨IDAæ‰“å¼€ï¼Œmainå‡½æ•°å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960int __fastcall main(int argc, const char **argv, const char **envp){ __int64 block; // [rsp+8h] [rbp-A8h] BYREF _QWORD fl4g[8]; // [rsp+10h] [rbp-A0h] BYREF char flag[8]; // [rsp+50h] [rbp-60h] BYREF __int64 v7; // [rsp+58h] [rbp-58h] __int64 v8; // [rsp+60h] [rbp-50h] __int64 v9; // [rsp+68h] [rbp-48h] __int64 v10; // [rsp+70h] [rbp-40h] __int64 v11; // [rsp+78h] [rbp-38h] __int64 v12; // [rsp+80h] [rbp-30h] _DWORD key[5]; // [rsp+90h] [rbp-20h] BYREF int k; // [rsp+A4h] [rbp-Ch] int j; // [rsp+A8h] [rbp-8h] int i; // [rsp+ACh] [rbp-4h] srand(0xF6950u); for ( i = 0; i &lt;= 3; ++i ) key[i] = rand(); printf(&quot;Please input your flag: &quot;); if ( __isoc99_scanf(&quot;%56s&quot;, flag) == 1 ) { if ( strlen(flag) == 56 ) { fl4g[0] = *flag; fl4g[1] = v7; fl4g[2] = v8; fl4g[3] = v9; fl4g[4] = v10; fl4g[5] = v11; fl4g[6] = v12; for ( j = 0; j &lt;= 55; j += 8 ) { block = fl4g[j / 8u]; encrypt(&amp;block, key); fl4g[j / 8u] = block; } for ( k = 0; k &lt;= 55; ++k ) { if ( enc[k] != *(fl4g + k) ) { printf(&quot;Try Again!&quot;); return 1; } } puts(&quot;Congratulation!&quot;); return 0; } else { puts(&quot;Length Error!&quot;); return 1; } } else { fwrite(&quot;Input error or EOF\\n&quot;, 1uLL, 0x13uLL, _bss_start); return 1; }} å¯ä»¥çœ‹å‡ºç¨‹åºç”¨å…ˆéšæœºæ•°ç”Ÿæˆäº†keyï¼Œç„¶åå¯¹è¾“å…¥çš„flagè¿›è¡Œäº†åŠ å¯†ï¼Œæœ€åæ˜¯æ ¡éªŒã€‚åŠ å¯†å‡½æ•°å¦‚ä¸‹ï¼Œæ˜¯teaåŠ å¯†ï¼š ä½†æ˜¯ç”¨ç›¸åŒç§å­ç”Ÿæˆçš„éšæœºæ•°ç»„æˆçš„keyä¼šè§£å¯†å¤±è´¥ï¼ŒåŠ¨è°ƒä¼šå‘ç°keyå’Œè‡ªå·±ä½¿ç”¨åŒä¸€ç§å­ç”Ÿæˆçš„keyä¸åŒï¼ˆIDAelfåŠ¨è°ƒæ•™ç¨‹è§idaåŠ¨æ€è°ƒè¯•elf(æ— å‘è¯¦ç»†)ï¼‰ï¼š è¿™æ ·å°±èƒ½è§£å¯†äº†ã€‚teaåŠ å¯†çš„ä¸»è¦é€»è¾‘æ˜¯å¼‚æˆ–ï¼Œæ‰€ä»¥åªéœ€è¦è¿˜åŸå‡ºåŠ å¯†æ—¶çš„ç›¸å…³å˜é‡å°±å¯ä»¥äº† è§£å¯†è„šæœ¬ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940#include &lt;stdio.h&gt;#include &lt;stdint.h&gt;void decrypt(uint32_t* block, uint32_t* key) { uint32_t p1 = block[0]; uint32_t p2 = block[1]; int sum = 0; for (int i = 0; i &lt; 32; i++) { sum -= 0x61C88647; } for (int i = 0; i &lt; 32; i++) { p2 -= (p1 + sum) ^ (16 * p1 + key[2]) ^ ((p1 &gt;&gt; 5) + key[3]); p1 -= (p2 + sum) ^ (16 * p2 + key[0]) ^ ((p2 &gt;&gt; 5) + key[1]); sum += 0x61C88647; } block[0] = p1; block[1] = p2;}int main() { uint32_t key[4] = { 0x7e4d087b, 0x7a4db733, 0x70fe9df0, 0x595607f7 }; uint32_t enc[14] = { 0xDC01DAAD, 0x088A5BAE, 0x8F4FF54E, 0x9E9D5F6E, 0x08A94E0A, 0xC245AB25, 0x438FC94B, 0x28D6513D, 0xF4CD72F6, 0x3B4AB42B, 0xEF6636FB, 0xB28C8AD6, 0x1B9C1AEB, 0x531F9C0A }; for (int i = 0; i &lt; 14; i += 2) { decrypt(&amp;enc[i], key); } char* flagChar = (char*)enc; for (int i = 0; i &lt; 56; i++) { printf(&quot;%c&quot;, flagChar[i]); } return 0;}","link":"/2025/10/19/0xGame2025Week2ReverseWriteUp/"},{"title":"0xGame2025Week3WriteUp","text":"0xGame2025 Week3 Reverseæ–¹å‘å…¨è§£&amp;è¯¦è§£ easyApp è€ƒç‚¹ï¼šapké€†å‘ã€å·¥å…·åº”ç”¨ã€base64ç¼–ç è§£ç ã€z3æ±‚è§£ é™„ä»¶ç¨‹åºæ˜¯ä¸ªapkï¼Œåœ¨æ¨¡æ‹Ÿå™¨ä¸­è¿è¡Œå¦‚å›¾ï¼Œæ¨æµ‹æŒ‰é’®ä¼šè§¦å‘flagæ£€éªŒé€»è¾‘ï¼š ç”¨JEBæ‰“å¼€apkï¼Œæ‰¾åˆ°MainActivityå¹¶å³é”®è§£æåï¼Œå¾—åˆ°JAVAä»£ç ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485package com.example.easyapp;import android.content.Context;import android.os.Bundle;import android.util.Base64;import android.view.View;import android.widget.Button;import android.widget.EditText;import android.widget.Toast;import androidx.activity.ComponentActivity;import dalvik.system.DexClassLoader;import java.io.File;import java.io.FileOutputStream;import java.io.InputStream;import java.io.OutputStream;import java.lang.reflect.Method;import kotlin.Metadata;import kotlin.collections.ArraysKt;import kotlin.io.ByteStreamsKt;import kotlin.jvm.functions.Function1;import kotlin.jvm.internal.Intrinsics;import kotlin.text.Charsets;import kotlin.text.StringsKt;@Metadata(d1 = {&quot;\\u0000\\&quot;\\n\\u0002\\u0018\\u0002\\n\\u0002\\u0018\\u0002\\n\\u0002\\b\\u0002\\n\\u0002\\u0010\\u0002\\n\\u0000\\n\\u0002\\u0018\\u0002\\n\\u0000\\n\\u0002\\u0010\\u000E\\n\\u0002\\u0010\\u0012\\n\\u0000\\b\\u0007\\u0018\\u00002\\u00020\\u0001B\\u0005Â¢\\u0006\\u0002\\u0010\\u0002J\\u0012\\u0010\\u0003\\u001A\\u00020\\u00042\\b\\u0010\\u0005\\u001A\\u0004\\u0018\\u00010\\u0006H\\u0014J\\f\\u0010\\u0007\\u001A\\u00020\\b*\\u00020\\tH\\u0002Â¨\\u0006\\n&quot;}, d2 = {&quot;Lcom/example/easyapp/MainActivity;&quot;, &quot;Landroidx/activity/ComponentActivity;&quot;, &quot;()V&quot;, &quot;onCreate&quot;, &quot;&quot;, &quot;savedInstanceState&quot;, &quot;Landroid/os/Bundle;&quot;, &quot;toHexString&quot;, &quot;&quot;, &quot;&quot;, &quot;app_release&quot;}, k = 1, mv = {1, 9, 0}, xi = 0x30)public final class MainActivity extends ComponentActivity { public static final int $stable; static { } @Override // androidx.activity.ComponentActivity protected void onCreate(Bundle arg3) { super.onCreate(arg3); this.setContentView(layout.activity_main); EditText v3 = (EditText)this.findViewById(id.flagInput); ((Button)this.findViewById(id.button)).setOnClickListener((View arg2) -&gt; MainActivity.onCreate$lambda$0(v3, this, arg2)); // è¿™é‡Œå°†Clickå’ŒonCreate$lambda$0ç»‘å®šèµ·æ¥äº† } private static final void onCreate$lambda$0(EditText arg6, MainActivity arg7, View arg8) { boolean v6_4; // v8_1çš„è¿”å›å€¼æµå‘v6_4 Intrinsics.checkNotNullParameter(arg7, &quot;this$0&quot;); String v6 = arg6.getText().toString(); // v6å­˜æ”¾äº†è¾“å…¥çš„flag File v8 = new File(arg7.getCacheDir(), &quot;dex.zip&quot;); InputStream v0 = arg7.getAssets().open(&quot;dex.zip&quot;); // æ‰“å¼€äº†asset/dex.zip Intrinsics.checkNotNullExpressionValue(v0, &quot;open(...)&quot;); ByteStreamsKt.copyTo$default(v0, ((OutputStream)new FileOutputStream(v8)), 0, 2, null); if(v6.length() == 42) { Method v8_1 = new DexClassLoader(v8.getAbsolutePath(), arg7.getCacheDir().getAbsolutePath(), null, arg7.getClassLoader()).loadClass(&quot;com.example.easyapp.Secret&quot;).getDeclaredMethod(&quot;check&quot;, String.class); // v8æŒ‡å‘äº†dexä¸­çš„com.example.easyapp.Secretçš„checkæ–¹æ³• String v1 = v6.substring(0, 26); // flagè¢«æˆªæ–­ï¼Œæˆªæ–­çš„éƒ¨åˆ†æµå‘v1 Intrinsics.checkNotNullExpressionValue(v1, &quot;this as java.lang.Stringâ€¦ing(startIndex, endIndex)&quot;); byte[] v1_1 = v1.getBytes(Charsets.UTF_8); // flagæˆªæ–­éƒ¨åˆ†æµå‘v1_1 Intrinsics.checkNotNullExpressionValue(((Object)v1_1), &quot;this as java.lang.String).getBytes(charset)&quot;); String v1_2 = Base64.encodeToString(v1_1, 0); // flagæˆªæ–­éƒ¨åˆ†è¢«è¿›è¡Œäº†baseç¼–ç ï¼Œæµå‘v1_2 Intrinsics.checkNotNullExpressionValue(v1_2, &quot;encodeToString(...)&quot;); String v1_3 = StringsKt.trim(((CharSequence)v1_2)).toString(); // ç¼–ç åçš„flagæˆªæ–­éƒ¨åˆ†æµå‘v1_3 String v6_1 = v6.substring(26); // flagçš„å‰©ä½™éƒ¨åˆ†æµå‘äº†v6_1 Intrinsics.checkNotNullExpressionValue(v6_1, &quot;this as java.lang.String).substring(startIndex)&quot;); byte[] v6_2 = v6_1.getBytes(Charsets.UTF_8); // flagçš„å‰©ä½™éƒ¨åˆ†ä»v6_1æµå‘äº†v6_2 Intrinsics.checkNotNullExpressionValue(((Object)v6_2), &quot;this as java.lang.String).getBytes(charset)&quot;); if(v1_3.equals(&quot;MHhHYW1le0RvX3kwdV9sMHYzX2FuZHIwMWQ=&quot;)) { // æ­¤å¤„ä¸ºv1_3çš„æ£€éªŒé€»è¾‘ Object v6_3 = v8_1.invoke(null, arg7.toHexString(v6_2)); // v6_2ç»è¿‡toHexStringå¤„ç†åä½œä¸ºv8_1ï¼Œå³dex:com.example.easyapp.Secret.checkçš„å‚æ•° Intrinsics.checkNotNull(v6_3, &quot;null cannot be cast to non-null type kotlin.Boolean&quot;); v6_4 = ((Boolean)v6_3).booleanValue(); // v8_1çš„è¿”å›å€¼æµå‘v6_4 } else { v6_4 = false; } if(v6_4) { // v6_4å†³å®šäº†æœ€åçš„è¾“å‡ºï¼šRight/Oh no no Toast.makeText(((Context)arg7), &quot;Right!&quot;, 0).show(); return; } Toast.makeText(((Context)arg7), &quot;Oh no no&quot;, 0).show(); return; } Toast.makeText(((Context)arg7), &quot;Length wrong!&quot;, 0).show(); } private final String toHexString(byte[] arg11) { return ArraysKt.joinToString$default(arg11, &quot;&quot;, null, null, 0, null, ((Function1)MainActivity.toHexString.1.INSTANCE), 30, null); }} å¯ä»¥çœ‹åˆ°ï¼Œflagè¢«æ‹†åˆ†æˆä¸¤éƒ¨åˆ†è¿›è¡Œæ£€éªŒï¼Œå‰26ä¸ªå­—ç¬¦ç»è¿‡base64ç¼–ç åä¸â€MHhHYW1le0RvX3kwdV9sMHYzX2FuZHIwMWQ=â€æ¯”å¯¹ï¼Œå‰©ä¸‹éƒ¨åˆ†ç”±dexä¸­çš„com.example.easyapp.Secret.checkæ–¹æ³•æ£€éªŒã€‚ç¬¬ä¸€éƒ¨åˆ†å¯ä»¥å€ŸåŠ©CyberChefè§£å¯†ï¼š ç°åœ¨æ¥åˆ†æflagç¬¬äºŒéƒ¨åˆ†çš„æ£€éªŒã€‚åœ¨JEBå·¦ä¸Šè§’å·¥ç¨‹æµè§ˆå™¨ä¸­æ‰¾åˆ°asset/dex.zip/dex.bin Secretç±»è§£æåå¾—åˆ°ï¼š å…¶ä¸­checkçš„é€»è¾‘ç­‰ä»·ä¸ºä¸€ä¸ªä¸‰å…ƒä¸€æ¬¡å¤§æ•°æ–¹ç¨‹ç»„ï¼Œä¸‰ä¸ªå…ƒä»flagçš„ç¬¬äºŒéƒ¨åˆ†æˆªå–ï¼š v0 = substring(flagPart2[0:16])v3 = substring(flagPart2[8:24])v4 = substring(flagPart2:[16:32]) v3 + 3 * v0 - 27454419028250566601 = 02 * v4 - 5 * v3 + 20616666104378640363 = 0v0 + 4 * v4 - 0x1dce62be9f0fa2f6c = 0 å¯ä»¥ä½¿ç”¨z3æ±‚è§£ã€‚è§£å¯†è„šæœ¬ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162from z3 import *&quot;&quot;&quot;v0 v3 v4åˆ†åˆ«å­˜æ”¾[0:16],[8:24],[16:32]ä¸‹æ ‡çš„å­—ç¬¦ï¼ŒBigIntegerå°†è¿™äº›å­—ç¬¦è½¬æˆåå…­è¿›åˆ¶æ•°ï¼Œæ¯ä¸ªåå…­è¿›åˆ¶æ•°4ä½ï¼Œæ‰€ä»¥æ¯ä¸ªå˜é‡æ˜¯64ä½éœ€è¦å…³æ³¨ä¸¤ä¸¤å˜é‡ä¹‹é—´æœ‰32ä½çš„é‡å æ‰€ä»¥å¯ä»¥å°†ä¸‰ä¸ª64ä½å˜é‡åˆ†æˆ4ä¸ª32ä½å˜é‡æ¥å¤„ç†&quot;&quot;&quot;# å®šä¹‰4ä¸ª32ä½å˜é‡u=BitVec('u',32) # v0çš„é«˜32ä½v=BitVec('v',32) # v0çš„ä½32ä½ï¼Œä¹Ÿæ˜¯v3çš„é«˜32ä½w=BitVec('w',32) # v3çš„ä½32ä½ï¼Œä¹Ÿæ˜¯v4çš„é«˜32ä½t=BitVec('t',32) # v4çš„ä½32ä½# é€šè¿‡æ‹¼æ¥32ä½å˜é‡æ„é€ 64ä½å˜é‡v0=Concat(u,v) #v0=u&lt;&lt;32|vv3=Concat(v,w) #v3=v&lt;&lt;32|wv4=Concat(w,t) #v4=w&lt;&lt;32|t#å®šä¹‰å¸¸é‡A=BitVecVal(27454419028250566601,64)B=BitVecVal(-20616666104378640363,64)C=BitVecVal(0x1dce62be9f0fa2f6c,64)#å»ºç«‹çº¦æŸs=Solver()s.add(v3+3*v0==A)s.add(2*v4-5*v3==B)s.add(v0+4*v4==C)if s.check()==unsat: print(&quot;æ— è§£&quot;)while s.check()==sat: model=s.model() u_val=model[u].as_long() v_val=model[v].as_long() w_val=model[w].as_long() t_val=model[t].as_long() print(f&quot;found solution:&quot;) print(f&quot;u: {u_val:08x}&quot;) print(f&quot;v: {v_val:08x}&quot;) print(f&quot;w: {w_val:08x}&quot;) print(f&quot;t: {t_val:08x}&quot;) # å°†32ä½å˜é‡è¿˜åŸæˆå­—ç¬¦ result=(u_val&lt;&lt;96)|(v_val&lt;&lt;64)|(w_val&lt;&lt;32)|t_val hex_str=f&quot;{result:032x}&quot; flag_bytes=bytes.fromhex(hex_str) flag=flag_bytes.decode('utf-8') print(f&quot;flag: {flag}&quot;) #æ’é™¤å·²æœ‰çš„è§£ s.add(Or(u!=u_val,v!=v_val,w!=w_val,t!=t_val)) &quot;&quot;&quot;found solution:u: 5f346e64v: 5f646578w: 5f6c6f61t: 6465727dflag: _4nd_dex_loader}&quot;&quot;&quot; flagï¼š0xGame{Do_y0u_l0v3_andr01d_4nd_dex_loader} Minesweepr è€ƒç‚¹ï¼šwebé€†å‘ã€jsé€†å‘ é™„ä»¶æ˜¯htmlæ–‡ä»¶å’Œjsæ–‡ä»¶ï¼Œæ¨æµ‹æ˜¯ä¸€ä¸ªwebé€†å‘é¢˜ã€‚htmlæ‰“å¼€æ˜¯ä¸€ä¸ªæ‰«é›·æ¸¸æˆç½‘é¡µã€‚å› ä¸ºjsä¸»è¦ç”¨æ¥å¤„ç†ç½‘é¡µäº¤äº’ï¼Œæ‰€ä»¥é‡ç‚¹å…³æ³¨jsæ–‡ä»¶çš„å†…å®¹ ç½‘é¡µæŒ‰F12æ‰“å¼€å¼€å‘äººå‘˜å·¥å…·ï¼Œå¯ä»¥åœ¨å·¥å…·æ æºä»£ç æ¨¡å—çœ‹jsè„šæœ¬ã€‚æœç´¢â€flagâ€å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªå¯ç–‘çš„å‡½æ•°ï¼š è¿™é‡Œå‡½æ•°åå’Œå˜é‡åéƒ½ä¸æ˜¯æœ‰æ„ä¹‰çš„ï¼Œä¸å¥½é˜…è¯»ï¼Œå¯ä»¥åŒå‡»é«˜äº®æ¥è¿½è¸ªæ•°æ®æµã€‚ åˆ†æå¯ä»¥å‘ç°ï¼Œ0x55ea57è¢«è°ƒç”¨äº†å¾ˆå¤šæ¬¡ï¼Œè¿½è¸ªè¿™ä¸ªå€¼å¯ä»¥åˆ°è¾¾0x183cï¼Œè¿™ä¸ªå‡½æ•°è´Ÿè´£ä»0xca50ä¸­åŠ è½½å€¼è¿”å›ï¼Œè¿™ç®—æ˜¯ä¸€ä¸ªå…¨å±€çš„æ··æ·†æ‰‹æ®µäº† æ ¹æ®0x183cçš„ä»£ç å¯ä»¥æ‰¾åˆ°0xca50çš„å­—ç¬¦ä¸²è¡¨0x1193d5ï¼Œè¡¨ä¸­å°±å¯ä»¥ç´¢å¼•å‡ºå¯†é’¥winModal:message2ï¼šâ€WebIsInterestingâ€äº†ï¼Œä»¥åŠå¯†æ–‡â€g\\x1d%(\\x1e,\\x15@SA\\x5cFD\\x0fWJn]P}^}\\x0c\\x12\\x07_]AGYC^o\\x04\\x00yA-ZGT\\x16U\\x0eâ€ï¼ˆ0x183cçš„ç´¢å¼•ç®—æ³•æœ‰ç‚¹å¥‡æ€ªï¼Œå¥½åƒç´¢å¼•ä¸åˆ°æ­£ç¡®çš„ä½ç½®ä¸Šï¼Œæ²¡ææ‡‚ï¼‰ è€Œ0x172ca4çš„è§£å¯†é€»è¾‘å¯ä»¥ç­‰ä»·å¦‚ä¸‹ï¼š 12for i in range(len(enc)): flag+=enc[i]^key[i%len(key)] å› æ­¤å¯ä»¥å¾—åˆ°è§£å¯†è„šæœ¬ï¼š 123456enc=&quot;g\\x1d%(\\x1e,\\x15@SA\\x5cFD\\x0fWJn]P}^}\\x0c\\x12\\x07_]AGYC^o\\x04\\x00yA-ZGT\\x16U\\x0e&quot;key=&quot;WebIsInteresting&quot;flag=&quot;&quot;for i in range(len(enc)): flag+=chr(ord(enc[i])^ord(key[i%len(key)]))print(flag) flagï¼š0xGame{463950f9-9824-4bfb-8230-98ab02d431d0} ezVBS è€ƒç‚¹ï¼šVBSé€†å‘ã€VBSå»æ··æ·† é™„ä»¶ç¨‹åºæ˜¯ä¸ªVBSæ–‡ä»¶ï¼Œè¿è¡Œæ˜¾ç¤ºï¼š ç”¨è®°äº‹æœ¬æ‰“å¼€VBSä¼šå‘ç°æ˜¯ä¸€å †å¥‡æ€ªçš„å­—ç¬¦ï¼ŒæŸ¥äº†ä¸€ä¸‹è¯´æ˜¯åŠ äº†æ··æ·† å‚è€ƒVBSä»£ç æ··æ·†ï¼Œå¯ä»¥ä½¿ç”¨å»æ··æ·†è„šæœ¬è¿›è¡Œå»æ··æ·†ï¼Œä½¿ç”¨æ–¹æ³•è§é“¾æ¥ï¼š 12345678910111213141516171819202122232425Option Explicit Function Defuscator(vbs) Dim t t = InStr(1, vbs, &quot;Execute&quot;, 1) t = Mid(vbs, t + Len(&quot;Execute&quot;)) t = Eval(t) Defuscator = tEnd Function Dim fso, iConst ForReading = 1Set fso = CreateObject(&quot;Scripting.FileSystemObject&quot;)For i = 0 To WScript.Arguments.Count - 1 Dim FileName FileName = WScript.Arguments(i) Dim MyFile Set MyFile = fso.OpenTextFile(FileName, ForReading) Dim vbs vbs = MyFile.ReadAll WScript.Echo Defuscator(vbs) MyFile.CloseNext Set fso = Nothing ç„¶åå¯ä»¥å¾—åˆ°å¦‚ä¸‹çš„ä»£ç ï¼š 12345678910Microsoft (R) Windows Script Host Version 5.812ç‰ˆæƒæ‰€æœ‰(C) Microsoft Corporationã€‚ä¿ç•™æ‰€æœ‰æƒåˆ©ã€‚code = &quot;Function l(str):Dim i,j,k,r:j=Len(str):r=&quot;&quot;&quot;&quot;:For i=1 to j:k=Asc(Mid(str,i,1)):If k&gt;=33 And k&lt;=126 Then:r=r&amp;Chr(33+((k+14)Mod 94)):Else:r=r&amp;Chr(k):End If:Next:l=r:End Function:Execute l(&quot;&quot;DEC l x?AFEq@IWQt?E6C J@FC &gt;6DD286i QX i q2D6ec%23=6 l Q7Ie{&amp;*d2Eh=?H&gt;5b%3BKF#JZp:A(w!s@)+z|uvr'ax^&quot;&quot;&quot;&quot;;$C6tD9`g}y&lt;8_Gfc~4qQ i 7=28 l QH2+2pJ}vsyhrH{7}5K*r?J&amp;DpyE$&gt;{&amp;_HB}z&gt;{*u?J%g:J#|:d&amp;tp|w_52glQ i 6?4 l QQ i u@C : l ` %@ {6?WDECX $E6A b i :7 : Z a kl {6?WDECX %96? i 3:Eq=@4&lt; l pD4W|:5WDEC[ :[ `XX Y ade Y ade Z pD4W|:5WDEC[ : Z `[ `XX Y ade Z pD4W|:5WDEC[ : Z a[ `XX i 4` l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ec Y ecXX |@5 ec Z `[ `X i 4a l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ecXX |@5 ec Z `[ `X i 4b l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - ecX |@5 ec Z `[ `X i 4c l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt;X |@5 ec Z `[ `X i 6?4 l 6?4 U 4` U 4a U 4b U 4c i t=D6 i x7 : Z ` kl {6?WDECX %96? i 3:Eq=@4&lt; l pD4W|:5WDEC[ :[ `XX Y ade Y ade Z pD4W|:5WDEC[ : Z `[ `XX Y ade i 4` l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ec Y ecXX |@5 ec Z `[ `X i 4a l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ecXX |@5 ec Z `[ `X i 4b l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - ecX |@5 ec Z `[ `X i 6?4 l 6?4 U 4` U 4a U 4b U QlQ i t=D6 i 3:Eq=@4&lt; l pD4W|:5WDEC[ :[ `XX Y ade Y ade i 4` l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ec Y ecXX |@5 ec Z `[ `X i 4a l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ecXX |@5 ec Z `[ `X i 6?4 l 6?4 U 4` U 4a U QlQ U QlQ i t?5 x7 i t?5 x7 i }6IE i xu 6?4 l 7=28 %96? i |D8q@I Q*@FC 7=28 :D 4@CC64EPQ i t=D6 i |D8q@I Q*@FC 7=28 :D :?4@CC64EPQ i t?5 x7&quot;&quot;)&quot;Execute codecode = &quot;Function l(str):Dim i,j,k,r:j=Len(str):r=&quot;&quot;&quot;&quot;:For i=1 to j:k=Asc(Mid(str,i,1)):If k&gt;=33 And k&lt;=126 Then:r=r&amp;Chr(33+((k+14)Mod 94)):Else:r=r&amp;Chr(k):End If:Next:l=r:End Function:Execute l(&quot;&quot;DEC l x?AFEq@IWQt?E6C J@FC 7=28i QX i q2D6ec%23=6 l QeHB)IvGyC%c~&quot;&quot;&quot;&quot;&gt;}twp^h@fg'qZ`=+#s4EdAFa2(_5Du{Jr$86;z79&amp;:x|*!&lt;Kb?3Q i 7=28 l Q^^H5q'Z2CGvJ+(fdZyaE#:vz=(faCy28#^H$=xwE#GKE+_f$CvZB@zHa`'%2qxpJs^6Esgb&amp;+AHF=:&amp;6#'p2+AHD+zHJ`gr2=yaE#GKEq(@Eq'p9qg&gt;{ZgwEq(fFq'f7Z^H8ZAH9`G27~BHu#'&gt;9CGv7Cy28#'CEZ(;dZzH5q'&quot;&quot;&quot;&quot;Eq(f2=AH8#(fz#x%D#yp2=EllQ i 6?4 l QQ i u@C : l ` %@ {6?WDECX $E6A b i :7 : Z a kl {6?WDECX %96? i 3:Eq=@4&lt; l pD4W|:5WDEC[ :[ `XX Y ade Y ade Z pD4W|:5WDEC[ : Z `[ `XX Y ade Z pD4W|:5WDEC[ : Z a[ `XX i 4` l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ec Y ecXX |@5 ec Z `[ `X i 4a l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ecXX |@5 ec Z `[ `X i 4b l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - ecX |@5 ec Z `[ `X i 4c l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt;X |@5 ec Z `[ `X i 6?4 l 6?4 U 4` U 4a U 4b U 4c i t=D6 i x7 : Z ` kl {6?WDECX %96? i 3:Eq=@4&lt; l pD4W|:5WDEC[ :[ `XX Y ade Y ade Z pD4W|:5WDEC[ : Z `[ `XX Y ade i 4` l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ec Y ecXX |@5 ec Z `[ `X i 4a l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ecXX |@5 ec Z `[ `X i 4b l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - ecX |@5 ec Z `[ `X i 6?4 l 6?4 U 4` U 4a U 4b U QlQ i t=D6 i 3:Eq=@4&lt; l pD4W|:5WDEC[ :[ `XX Y ade Y ade i 4` l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ec Y ecXX |@5 ec Z `[ `X i 4a l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ecXX |@5 ec Z `[ `X i 6?4 l 6?4 U 4` U 4a U QlQ U QlQ i t?5 x7 i t?5 x7 i }6IE i xu 6?4 l 7=28 %96? i |D8q@I DEC i t=D6 i |D8q@I Q*@FC 7=28 :D :?4@CC64EPQ i |D8q@I 6?4 i t?5 x7&quot;&quot;)&quot;Set objFSO = CreateObject(&quot;Scripting.FileSystemObject&quot;)strScriptPath = WScript.ScriptFullNamestrTextToWrite = codeobjFSO.OpenTextFile(strScriptPath, 2, True).WriteLine(strTextToWrite) å¯ä»¥çœ‹åˆ°codeä¸­æœ‰ä¸€äº›å¯è¯»æ˜æ–‡ï¼Œåé¢åˆæ˜¯ä¸€å¤§ä¸²å¥‡æ€ªçš„å­—ç¬¦ã€‚æ¨æµ‹è¿˜æœ‰ä¸€å±‚æ··æ·†ï¼Œå¯è¯»æ˜æ–‡å³ä¸ºè§£å¯†å‡½æ•°ã€‚è®©AIç»™å‡ºè§£å¯†è„šæœ¬ï¼š 1234567891011121314151617181920212223242526def l(encrypted_str): &quot;&quot;&quot;VBScript l å‡½æ•°çš„ Python å®ç°&quot;&quot;&quot; result = &quot;&quot; for i in range(len(encrypted_str)): k = ord(encrypted_str[i]) if 33 &lt;= k &lt;= 126: # ä¸ VBScript ç›¸åŒçš„ç®—æ³• result += chr(33 + ((k + 14) % 94)) else: result += chr(k) return result# ä½ çš„åŠ å¯†å­—ç¬¦ä¸²encrypted_strings = [ &quot;DEC l x?AFEq@IWQt?E6C J@FC &gt;6DD286i QX i q2D6ec%23=6 l Q7Ie{&amp;*d2Eh=?H&gt;5b%3BKF#JZp:A(w!s@)+z|uvr'ax^\\&quot;\\&quot;\\&quot;\\&quot;;$C6tD9`g}y&lt;8_Gfc~4qQ i 7=28 l QH2+2pJ}vsyhrH{7}5K*r?J&amp;DpyE$&gt;{&amp;_HB}z&gt;{*u?J%g:J#|:d&amp;tp|w_52glQ i 6?4 l QQ i u@C : l ` %@ {6?WDECX $E6A b i :7 : Z a kl {6?WDECX %96? i 3:Eq=@4&lt; l pD4W|:5WDEC[ :[ `XX Y ade Y ade Z pD4W|:5WDEC[ : Z `[ `XX Y ade Z pD4W|:5WDEC[ : Z a[ `XX i 4` l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ec Y ecXX |@5 ec Z `[ `X i 4a l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ecXX |@5 ec Z `[ `X i 4b l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - ecX |@5 ec Z `[ `X i 4c l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt;X |@5 ec Z `[ `X i 6?4 l 6?4 U 4` U 4a U 4b U 4c i t=D6 i x7 : Z ` kl {6?WDECX %96? i 3:Eq=@4&lt; l pD4W|:5WDEC[ :[ `XX Y ade Y ade Z pD4W|:5WDEC[ : Z `[ `XX Y ade i 4` l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ec Y ecXX |@5 ec Z `[ `X i 4a l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ecXX |@5 ec Z `[ `X i 4b l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - ecX |@5 ec Z `[ `X i 6?4 l 6?4 U 4` U 4a U 4b U QlQ i t=D6 i 3:Eq=@4&lt; l pD4W|:5WDEC[ :[ `XX Y ade Y ade i 4` l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ec Y ecXX |@5 ec Z `[ `X i 4a l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ecXX |@5 ec Z `[ `X i 6?4 l 6?4 U 4` U 4a U QlQ U QlQ i t?5 x7 i t?5 x7 i }6IE i xu 6?4 l 7=28 %96? i |D8q@I Q*@FC 7=28 :D 4@CC64EPQ i t=D6 i |D8q@I Q*@FC 7=28 :D :?4@CC64EPQ i t?5 x7&quot;, &quot;DEC l x?AFEq@IWQt?E6C J@FC 7=28i QX i q2D6ec%23=6 l QeHB)IvGyC%c~\\&quot;\\&quot;\\&quot;\\&quot;&gt;}twp^h@fg'qZ`=+#s4EdAFa2(_5Du{Jr$86;z79&amp;:x|*!&lt;Kb?3Q i 7=28 l Q^^H5q'Z2CGvJ+(fdZyaE#:vz=(faCy28#^H$=xwE#GKE+_f$CvZB@zHa`'%2qxpJs^6Esgb&amp;+AHF=:&amp;6#'p2+AHD+zHJ`gr2=yaE#GKEq(@Eq'p9qg&gt;{ZgwEq(fFq'f7Z^H8ZAH9`G27~BHu#'&gt;9CGv7Cy28#'CEZ(;dZzH5q'\\&quot;\\&quot;\\&quot;\\&quot;Eq(f2=AH8#(fz#x%D#yp2=EllQ i 6?4 l QQ i u@C : l ` %@ {6?WDECX $E6A b i :7 : Z a kl {6?WDECX %96? i 3:Eq=@4&lt; l pD4W|:5WDEC[ :[ `XX Y ade Y ade Z pD4W|:5WDEC[ : Z `[ `XX Y ade Z pD4W|:5WDEC[ : Z a[ `XX i 4` l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ec Y ecXX |@5 ec Z `[ `X i 4a l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ecXX |@5 ec Z `[ `X i 4b l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - ecX |@5 ec Z `[ `X i 4c l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt;X |@5 ec Z `[ `X i 6?4 l 6?4 U 4` U 4a U 4b U 4c i t=D6 i x7 : Z ` kl {6?WDECX %96? i 3:Eq=@4&lt; l pD4W|:5WDEC[ :[ `XX Y ade Y ade Z pD4W|:5WDEC[ : Z `[ `XX Y ade i 4` l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ec Y ecXX |@5 ec Z `[ `X i 4a l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ecXX |@5 ec Z `[ `X i 4b l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - ecX |@5 ec Z `[ `X i 6?4 l 6?4 U 4` U 4a U 4b U QlQ i t=D6 i 3:Eq=@4&lt; l pD4W|:5WDEC[ :[ `XX Y ade Y ade i 4` l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ec Y ecXX |@5 ec Z `[ `X i 4a l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ecXX |@5 ec Z `[ `X i 6?4 l 6?4 U 4` U 4a U QlQ U QlQ i t?5 x7 i t?5 x7 i }6IE i xu 6?4 l 7=28 %96? i |D8q@I DEC i t=D6 i |D8q@I Q*@FC 7=28 :D :?4@CC64EPQ i |D8q@I 6?4 i t?5 x7&quot;]# è§£å¯†å¹¶æ˜¾ç¤ºç»“æœfor i, encrypted in enumerate(encrypted_strings, 1): print(f&quot;è§£å¯†ç¬¬ {i} ä¸ªå­—ç¬¦ä¸²:&quot;) decrypted = l(encrypted) print(decrypted) print(&quot;\\n&quot; + &quot;=&quot; * 80 + &quot;\\n&quot;) è¾“å‡ºï¼š 123456789è§£å¯†ç¬¬ 1 ä¸ªå­—ç¬¦ä¸²:str = InputBox(&quot;Enter your message: &quot;) : Base64Table = &quot;fx6LUY5at9lnwmd3TbqzuRy+AipWHPDoXZKMFGCV2I/QQQQjSreEsh18NJkg0v74OcB&quot; : flag = &quot;waZaAyNGDJ9CwLfNdzYCnyUsAJtSmLU0wqNKmLYFnyT8iyRMi5UEAMH0da8=&quot; : enc = &quot;&quot; : For i = 1 To Len(str) Step 3 : if i + 2 &lt;= Len(str) Then : bitBlock = Asc(Mid(str, i, 1)) * 256 * 256 + Asc(Mid(str, i + 1, 1)) * 256 + Asc(Mid(str, i + 2, 1)) : c1 = Mid(Base64Table, Int(bitBlock \\ (64 * 64 * 64)) Mod 64 + 1, 1) : c2 = Mid(Base64Table, Int(bitBlock \\ (64 * 64)) Mod 64 + 1, 1) : c3 = Mid(Base64Table, Int(bitBlock \\ 64) Mod 64 + 1, 1) : c4 = Mid(Base64Table, Int(bitBlock) Mod 64 + 1, 1) : enc = enc &amp; c1 &amp; c2 &amp; c3 &amp; c4 : Else : If i + 1 &lt;= Len(str) Then : bitBlock = Asc(Mid(str, i, 1)) * 256 * 256 + Asc(Mid(str, i + 1, 1)) * 256 : c1 = Mid(Base64Table, Int(bitBlock \\ (64 * 64 * 64)) Mod 64 + 1, 1) : c2 = Mid(Base64Table, Int(bitBlock \\ (64 * 64)) Mod 64 + 1, 1) : c3 = Mid(Base64Table, Int(bitBlock \\ 64) Mod 64 + 1, 1) : enc = enc &amp; c1 &amp; c2 &amp; c3 &amp; &quot;=&quot; : Else : bitBlock = Asc(Mid(str, i, 1)) * 256 * 256 : c1 = Mid(Base64Table, Int(bitBlock \\ (64 * 64 * 64)) Mod 64 + 1, 1) : c2 = Mid(Base64Table, Int(bitBlock \\ (64 * 64)) Mod 64 + 1, 1) : enc = enc &amp; c1 &amp; c2 &amp; &quot;=&quot; &amp; &quot;=&quot; : End If : End If : Next : IF enc = flag Then : MsgBox &quot;Your flag is correct!&quot; : Else : MsgBox &quot;Your flag is incorrect!&quot; : End If================================================================================è§£å¯†ç¬¬ 2 ä¸ªå­—ç¬¦ä¸²:str = InputBox(&quot;Enter your flag: &quot;) : Base64Table = &quot;6wqXxGvJrT4OQQQQmNEHA/9o78VB+1lZRDct5pu2aW0dsFLyCSgejKfhUiIMYPkz3nb&quot; : flag = &quot;//wdBV+arvGyZW75+J2tRiGKlW72rJagR/wSlIHtRvztZ07SrG+qoKw21VTaBIAyD/etD83UZpwuliUeRVAaZpwsZKwy18CalJ2tRvztBWotBVAhB8mL+8HtBW7uBV7f+/wg+pwh1vafOqwFRVmhrvGfrJagRVrt+Wj5+KwdBVQQQQtBW7alpwgRW7KRITsRJAalt==&quot; : enc = &quot;&quot; : For i = 1 To Len(str) Step 3 : if i + 2 &lt;= Len(str) Then : bitBlock = Asc(Mid(str, i, 1)) * 256 * 256 + Asc(Mid(str, i + 1, 1)) * 256 + Asc(Mid(str, i + 2, 1)) : c1 = Mid(Base64Table, Int(bitBlock \\ (64 * 64 * 64)) Mod 64 + 1, 1) : c2 = Mid(Base64Table, Int(bitBlock \\ (64 * 64)) Mod 64 + 1, 1) : c3 = Mid(Base64Table, Int(bitBlock \\ 64) Mod 64 + 1, 1) : c4 = Mid(Base64Table, Int(bitBlock) Mod 64 + 1, 1) : enc = enc &amp; c1 &amp; c2 &amp; c3 &amp; c4 : Else : If i + 1 &lt;= Len(str) Then : bitBlock = Asc(Mid(str, i, 1)) * 256 * 256 + Asc(Mid(str, i + 1, 1)) * 256 : c1 = Mid(Base64Table, Int(bitBlock \\ (64 * 64 * 64)) Mod 64 + 1, 1) : c2 = Mid(Base64Table, Int(bitBlock \\ (64 * 64)) Mod 64 + 1, 1) : c3 = Mid(Base64Table, Int(bitBlock \\ 64) Mod 64 + 1, 1) : enc = enc &amp; c1 &amp; c2 &amp; c3 &amp; &quot;=&quot; : Else : bitBlock = Asc(Mid(str, i, 1)) * 256 * 256 : c1 = Mid(Base64Table, Int(bitBlock \\ (64 * 64 * 64)) Mod 64 + 1, 1) : c2 = Mid(Base64Table, Int(bitBlock \\ (64 * 64)) Mod 64 + 1, 1) : enc = enc &amp; c1 &amp; c2 &amp; &quot;=&quot; &amp; &quot;=&quot; : End If : End If : Next : IF enc = flag Then : MsgBox str : Else : MsgBox &quot;Your flag is incorrect!&quot; : MsgBox enc : End If================================================================================ è§£å¯†å‡ºæ¥æ˜¯ä¸¤æ®µä»£ç ã€‚ä½†æ˜¯ä»£ç ç»™çš„baseè¡¨ä¸æ˜¯å¾ˆå¯¹ï¼Œç¬¬2æ®µä»£ç ä¸­åˆ é™¤baseè¡¨ä¸­é—´è¿ç»­QQQQçš„å‡ ä¸ªå¯ä»¥è§£å¯†å‡ºä¸€äº›ç±»ä¼¼æç¤ºçš„ä¸œè¥¿ ç¬¬1æ®µä»£ç çš„ç¼–ç è¡¨è¿›è¡ŒåŒæ ·çš„ä¿®æ”¹å°±å¾—åˆ°äº†flagï¼š flagï¼š0xGame{bf00591f-a1cb-4191-b41d-d4eecda0b798} Worldâ€™s_end_BlackBox è€ƒç‚¹ï¼šåŠ¨æ€è°ƒè¯•ã€é­”æ”¹RC4ç®—æ³• é™„ä»¶ç¨‹åºè¿è¡Œå¦‚å›¾ï¼š ç”¨IDAæ‰“å¼€ï¼Œmainå‡½æ•°ç”±äºç±»çš„å½±å“ä¸å¥½åˆ†æï¼Œå…ˆè¿›è¡Œç®€å•çš„å˜é‡åä¼˜åŒ–ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194int __fastcall main(int argc, const char **argv, const char **envp){ __int64 v3; // rax __int64 v4; // rax __int64 v5; // rax __int64 v6; // rax __int64 v7; // rax __int64 v8; // rax __int64 v9; // rax __int64 v10; // rax __int64 v11; // rax std::string::iterator __for_end; // [rsp+20h] [rbp-60h] BYREF std::string::iterator __for_begin; // [rsp+28h] [rbp-58h] BYREF std::vector&lt;int&gt; EndFlag; // [rsp+30h] [rbp-50h] BYREF std::string encrypted_message; // [rsp+50h] [rbp-30h] BYREF std::string key; // [rsp+70h] [rbp-10h] BYREF std::string flag; // [rsp+90h] [rbp+10h] BYREF std::string v19; // [rsp+B0h] [rbp+30h] BYREF std::vector&lt;int&gt;::value_type __x; // [rsp+D0h] [rbp+50h] BYREF char c; // [rsp+D7h] [rbp+57h] std::string *__for_range; // [rsp+D8h] [rbp+58h] _main(argc, argv, envp); SetConsoleOutputCP(0xFDE9u); basicString((__int64)&amp;flag); basicString((__int64)&amp;key); v3 = operateOut(pOut, &amp;unk_408078); stdOut(v3, out); v4 = operateOut(pOut, &amp;unk_408160); stdOut(v4, out); getLine(pIn, &amp;key); // è·å–å¯†ç  if ( getLength(&amp;key) != 12 ) // é•¿åº¦åˆ¤æ–­ { v5 = operateOut(pOut, &quot;Length Error!&quot;); stdOut(v5, out); system(&quot;pause&quot;); exit(0); } KeyGenerate(&amp;v19, &amp;KeyEnc[abi:cxx11], &amp;DeKey[abi:cxx11]);// keyçš„ç”Ÿæˆç®—æ³• std::string::operator=(&amp;TrueKey[abi:cxx11], &amp;v19); std::string::~string(&amp;v19); if ( std::operator!=&lt;char&gt;(&amp;key, &amp;TrueKey[abi:cxx11]) )// å‡ºç°äº†æ£€éªŒé€»è¾‘ï¼Œå¯ä»¥ä»è¿™é‡Œç›´æ¥è·å–åˆ°çœŸæ­£çš„key { v6 = operateOut(pOut, &amp;unk_4081A2); // keyé”™è¯¯æ—¶çš„è¾“å‡º stdOut(v6, out); system(&quot;pause&quot;); exit(0); } v7 = operateOut(pOut, &amp;Congratulation); // keyæ­£ç¡®æ—¶çš„è¾“å‡º stdOut(v7, out); v8 = operateOut(pOut, &amp;unk_408212); stdOut(v8, out); getLine(pIn, &amp;flag); // è·å–flagçš„è¾“å…¥ if ( getLength(&amp;flag) != 51 ) { v9 = operateOut(pOut, &quot;Length Error!&quot;); stdOut(v9, out); system(&quot;pause&quot;); exit(0); } encrypt(&amp;encrypted_message, &amp;flag, &amp;key); // åŠ å¯†ç®—æ³•ï¼Œå¯†é’¥å³ä¸ºå‰æ–‡çš„key std::vector&lt;int&gt;::vector(&amp;EndFlag); __for_range = &amp;encrypted_message; __for_begin._M_current = (char *)std::string::begin(&amp;encrypted_message); __for_end._M_current = (char *)std::string::end(__for_range); while ( __gnu_cxx::operator!=&lt;char *,std::string&gt;(&amp;__for_begin, &amp;__for_end) ) { c = *__gnu_cxx::__normal_iterator&lt;char *,std::string&gt;::operator*(&amp;__for_begin); __x = (unsigned __int8)c; std::vector&lt;int&gt;::push_back(&amp;EndFlag, &amp;__x); __gnu_cxx::__normal_iterator&lt;char *,std::string&gt;::operator++(&amp;__for_begin); } if ( std::operator==&lt;int,std::allocator&lt;int&gt;&gt;(&amp;KALEIDXSCOPE, &amp;EndFlag) )// æ£€éªŒåŠ å¯†ç»“æœ { v10 = operateOut(pOut, &quot;All Perfect!&quot;); stdOut(v10, out); system(&quot;pause&quot;); exit(0); } v11 = operateOut(pOut, &quot;Try again!&quot;); stdOut(v11, out); std::vector&lt;int&gt;::~vector(&amp;EndFlag); std::string::~string(&amp;encrypted_message); std::string::~string(&amp;key); std::string::~string(&amp;flag); return 0;}//åŠ å¯†å‡½æ•°std::string *__cdecl modifiedRC4(std::string *__return_ptr retstr, const std::string *plaintext, const std::string *key){ size_t v3; // rax size_t length; // rax char v5; // bl std::vector&lt;int&gt;::reference List; // rax __int64 v8; // [rsp+0h] [rbp-80h] BYREF std::vector&lt;int&gt; k; // [rsp+20h] [rbp-60h] BYREF std::vector&lt;int&gt; s; // [rsp+40h] [rbp-40h] BYREF std::allocator&lt;int&gt; __a; // [rsp+66h] [rbp-1Ah] BYREF char v12; // [rsp+67h] [rbp-19h] BYREF size_t i; // [rsp+68h] [rbp-18h] std::allocator&lt;int&gt;::allocator((std::allocator&lt;int&gt; *const)&amp;v8 + 102); std::vector&lt;int&gt;::vector(&amp;s, 0x100uLL, &amp;__a); std::allocator&lt;int&gt;::~allocator(&amp;__a); rc4_ksa(&amp;s, key); // RC4å¯†é’¥è°ƒåº¦ç®—æ³• v3 = std::string::size(plaintext); rc4_prga(&amp;k, &amp;s, v3); // RC4ä¼ªéšæœºæ•°ç”Ÿæˆç®—æ³• std::allocator&lt;char&gt;::allocator(&amp;v12); std::string::basic_string(retstr, &amp;unk_408037, &amp;v12); std::allocator&lt;char&gt;::~allocator(&amp;v12); for ( i = 0LL; ; ++i ) { length = std::string::size(plaintext); if ( i &gt;= length ) break; v5 = *(_BYTE *)StrMakeList(plaintext, i); List = IntMakeList(&amp;k, i); std::string::operator+=(retstr, (unsigned int)(char)(v5 ^ *(_BYTE *)List ^ 7));// é­”æ”¹çš„åœ°æ–¹åœ¨è¿™ } std::vector&lt;int&gt;::~vector(&amp;k); std::vector&lt;int&gt;::~vector(&amp;s); return retstr;}//å¯†é’¥è°ƒåº¦ç®—æ³•void __cdecl rc4_ksa(std::vector&lt;int&gt; *s, const std::string *key){ int *M_current; // rbx std::vector&lt;int&gt;::iterator v3; // rax int v4; // ebx unsigned __int64 v5; // rdx _BYTE *List; // rax char v7; // dl int *s_j; // rbx int *s_i; // rax size_t i; // [rsp+20h] [rbp-60h] int j; // [rsp+2Ch] [rbp-54h] M_current = std::vector&lt;int&gt;::end(s)._M_current; v3._M_current = std::vector&lt;int&gt;::begin(s)._M_current; std::iota&lt;__gnu_cxx::__normal_iterator&lt;int *,std::vector&lt;int&gt;&gt;,int&gt;( v3, (__gnu_cxx::__normal_iterator&lt;int*,std::vector&lt;int&gt; &gt;)M_current, 0); j = 0; for ( i = 0LL; i &lt;= 255; ++i ) { v4 = *IntMakeList(s, i) + j; v5 = i % getLength(key); List = (_BYTE *)StrMakeList(key, v5); v7 = v4 + *List; LODWORD(List) = (unsigned int)((v4 + (char)*List) &gt;&gt; 31) &gt;&gt; 24; j = (unsigned __int8)((_BYTE)List + v7) - (_DWORD)List; s_j = IntMakeList(s, j); s_i = IntMakeList(s, i); std::swap&lt;int&gt;(s_i, s_j); }}//ä¼ªéšæœºæ•°ç”Ÿæˆç®—æ³•std::vector&lt;int&gt; *__cdecl rc4_prga(std::vector&lt;int&gt; *__return_ptr retstr, std::vector&lt;int&gt; *s, size_t length){ std::vector&lt;int&gt;::reference v3; // rax int *v4; // rbx int *v5; // rax std::vector&lt;int&gt;::reference v6; // rax const std::vector&lt;int&gt;::value_type *v7; // rax size_t r; // [rsp+30h] [rbp-50h] int j; // [rsp+38h] [rbp-48h] int i; // [rsp+3Ch] [rbp-44h] std::vector&lt;int&gt;::vector(retstr); i = 0; j = 0; for ( r = 0LL; r &lt; length; ++r ) { i = (i + 1) % 256; v3 = IntMakeList(s, i); j = (unsigned __int8)(((unsigned int)((j + *v3) &gt;&gt; 31) &gt;&gt; 24) + j + *(_BYTE *)v3) - ((unsigned int)((j + *v3) &gt;&gt; 31) &gt;&gt; 24); v4 = IntMakeList(s, j); v5 = IntMakeList(s, i); std::swap&lt;int&gt;(v5, v4); LODWORD(v4) = *IntMakeList(s, i); v6 = IntMakeList(s, j); v7 = IntMakeList( s, (int)((unsigned __int8)(((unsigned int)(((int)v4 + *v6) &gt;&gt; 31) &gt;&gt; 24) + (_BYTE)v4 + *(_BYTE *)v6) - ((unsigned int)(((int)v4 + *v6) &gt;&gt; 31) &gt;&gt; 24))); std::vector&lt;int&gt;::push_back(retstr, v7); } return retstr;} å¯ä»¥çœ‹åˆ°å‡½æ•°å¯¹è¾“å…¥çš„æ•°æ®è¿›è¡Œäº†é­”æ”¹çš„RC4åŠ å¯†ï¼Œä½†å®é™…ä¸Šæ²¡æœ‰æ”¹å˜RC4åŠ è§£å¯†åŒä¸€ä¸ªå‡½æ•°çš„æ€§è´¨ï¼Œæ‰€ä»¥è§£å¯†åªéœ€è¦å¤ç°è¿™ä¸ªä»£ç å³å¯ ä¸‹é¢å…ˆè·å–å¯†é’¥å’ŒåŠ å¯†åçš„flagæ•°æ®ã€‚åœ¨mainå‡½æ•°ç¬¬ä¸€ä¸ªgetlineå¤„ä¸‹æ–­ç‚¹ï¼Œå¼€å§‹åŠ¨æ€è°ƒè¯• éšä¾¿è¾“å…¥ä¸€ä¸ªå­—ç¬¦åä¼šåˆ°é•¿åº¦æ£€æµ‹ï¼Œè¦æ±‚è¾“å…¥çš„å¯†ç é•¿åº¦è¦ç­‰äº12ï¼Œå¯ä»¥è¾“å…¥12ä¸ªå­—ç¬¦ä¹Ÿå¯ä»¥åç»­åˆ°è¿™ä¸ªcmpçš„æ—¶å€™æ”¹jzç»•è¿‡ è¿‡äº†é•¿åº¦æ£€æµ‹åå°±å¯ä»¥ä¸€ç›´è¿è¡Œåˆ°keyæ£€éªŒå¤„ï¼ŒåŒå‡»ç”Ÿæˆçš„å¯†é’¥çš„å˜é‡å(TrueKey)å°±å¯ä»¥å¾—åˆ°çœŸæ­£çš„keyäº†ï¼ˆä» hexçª—å£å¯ä»¥çœ‹åˆ°keyå³ä¸ºâ€XaleidscopiXâ€ï¼‰ ç„¶åè¿˜éœ€è¦è·å¾—çœŸæ­£flagçš„åŠ å¯†æ•°æ®ã€‚å¾€ä¸‹ç»•è¿‡keyæ£€éªŒï¼Œè¿è¡Œåˆ°jzçš„æ—¶å€™å†æ”¹ä¸€ä¸‹ZFæ ‡å¿—ä½ï¼ˆæ­¤å¤„åº”å½“è·³è½¬ï¼‰ ç»•è¿‡åç»ˆç«¯è¿˜æœ‰æç¤º æ¥ä¸‹æ¥è¿è¡Œåˆ°ç¬¬äºŒä¸ªgetlineï¼Œéšä¾¿è¾“å‡ ä¸ªæ•°æ®ï¼ˆæœ‰é•¿åº¦æ£€éªŒï¼Œæœ€å¥½æ˜¯è¾“å…¥51ä¸ªå­—ç¬¦ï¼Œçœçš„ç»•è¿‡é•¿åº¦æ£€éªŒï¼‰ã€‚ç„¶åç»§ç»­è¿è¡Œåˆ°åŠ å¯†ç»“æœçš„æ£€éªŒå¤„ å…¶ä¸­KALEIDXSCOPEçš„ç¬¬ä¸€ä¸ªoffsetå°±æ˜¯æ­£ç¡®çš„flagåŠ å¯†åçš„æ•°æ® è§£å¯†è„šæœ¬ï¼š 12345678910111213141516171819202122232425262728293031323334def rc4_decrypt(data, key): S = list(range(256)) j = 0 out = [] # Key-scheduling algorithm (KSA) for i in range(256): j = (j + S[i] + key[i % len(key)]) % 256 S[i], S[j] = S[j], S[i] # Pseudo-random generation algorithm (PRGA) i = 0 j = 0 for char in data: i = (i + 1) % 256 j = (j + S[i]) % 256 S[i], S[j] = S[j], S[i] K = S[(S[i] + S[j]) % 256] out.append(K) return outenc=[0x000000FC, 0x000000EA, 0x00000015, 0x0000002C, 0x00000086, 0x00000038, 0x0000003F, 0x000000F3, 0x00000092, 0x000000CE, 0x000000DA, 0x0000008E, 0x00000048, 0x000000D3, 0x00000007, 0x0000009F, 0x000000D9, 0x00000057, 0x000000B1, 0x000000EE, 0x00000041, 0x0000009A, 0x0000004D, 0x000000C5, 0x00000065, 0x0000006A, 0x000000FF, 0x000000C9, 0x0000005D, 0x00000034, 0x000000AD, 0x000000EA, 0x000000B1, 0x00000020, 0x0000004B, 0x000000DC, 0x000000BD, 0x000000D2, 0x00000035, 0x00000002, 0x00000084, 0x00000035, 0x00000071, 0x000000EC, 0x000000E0, 0x00000048, 0x0000008E, 0x000000EA, 0x0000007B, 0x000000AA, 0x000000CF]_key=&quot;XaleidscopiX&quot;key=[]flag=[]for i in _key: key.append(ord(i))#print(key)keystream=rc4_decrypt(enc, key)for i in range(len(enc)): flag.append(enc[i]^keystream[i]^7)print(''.join([chr(i) for i in flag])) flagï¼š0xGame{RC4_15_4_b4s1c&amp;fl3x1bl3_3ncrYp710n4lg0r17hm} Q(â‰§â–½â‰¦)T è€ƒç‚¹ï¼šQTç¨‹åºé€†å‘ã€crackmeã€åŠ¨æ€è°ƒè¯•ã€RC4ã€å“ˆå¸Œæ ¡éªŒ é™„ä»¶ç¨‹åºè¿è¡Œå¦‚å›¾ï¼Œæ˜¯ä¸ªåºåˆ—å·ç”Ÿæˆå™¨ï¼š ç”¨IDAæ‰“å¼€ï¼Œå‡ºç°çš„æ˜¯startå‡½æ•°ï¼Œ çœ‹ä¸å‡ºä»€ä¹ˆä¸œè¥¿æ¥ shift+F12çœ‹çœ‹å­—ç¬¦ä¸²è¡¨ï¼Œå¯ä»¥å‘ç°ä¸¤ä¸²å¯ç–‘çš„å­—ç¬¦ä¸² è·Ÿè¸ªè¿‡å»å¯ä»¥æ‰¾åˆ°è¿™æ ·ä¸€ä¸ªå‡½æ•° 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150void __fastcall sub_140001890(__int64 a1, __int64 a2, __int64 a3, __int64 a4){ volatile signed __int32 *v5; // rax volatile signed __int32 *v6; // [rsp+80h] [rbp-1F8h] BYREF volatile signed __int32 *v7; // [rsp+88h] [rbp-1F0h] volatile signed __int32 *v8; // [rsp+90h] [rbp-1E8h] BYREF volatile signed __int32 *v9; // [rsp+98h] [rbp-1E0h] __int64 Block; // [rsp+A0h] [rbp-1D8h] BYREF const char *v11; // [rsp+A8h] [rbp-1D0h] volatile signed __int32 *v12[4]; // [rsp+B0h] [rbp-1C8h] BYREF volatile signed __int32 *v13[4]; // [rsp+D0h] [rbp-1A8h] BYREF volatile signed __int32 *v14[4]; // [rsp+F0h] [rbp-188h] BYREF volatile signed __int32 *v15; // [rsp+110h] [rbp-168h] BYREF volatile signed __int32 *v16[4]; // [rsp+130h] [rbp-148h] BYREF volatile signed __int32 *v17[2]; // [rsp+150h] [rbp-128h] BYREF volatile signed __int32 *v18; // [rsp+160h] [rbp-118h] __m128i v19[2]; // [rsp+170h] [rbp-108h] BYREF __m128i v20; // [rsp+190h] [rbp-E8h] BYREF volatile signed __int32 *v21[4]; // [rsp+1B0h] [rbp-C8h] BYREF volatile signed __int32 *v22[2]; // [rsp+1D0h] [rbp-A8h] BYREF volatile signed __int32 *v23; // [rsp+1E0h] [rbp-98h] volatile signed __int32 *v24[4]; // [rsp+1F0h] [rbp-88h] BYREF volatile signed __int32 *v25[13]; // [rsp+210h] [rbp-68h] BYREF ((void (__fastcall *)(void *, volatile signed __int32 **, _QWORD, volatile signed __int32 **))QLineEdit::text)( QLineEdit::text, v25, *(_QWORD *)(*(_QWORD *)(a4 + 40) + 16LL), v25); QString::trimmed_helper(QLineEdit::text, v25, v25, v12); if ( v25[0] &amp;&amp; !_InterlockedSub(v25[0], 1u) ) free(QLineEdit::text); ((void (__fastcall *)(void *, volatile signed __int32 **, _QWORD, volatile signed __int32 **))QLineEdit::text)( QLineEdit::text, v25, *(_QWORD *)(*(_QWORD *)(a4 + 40) + 24LL), v13); if ( v12[2] == (volatile signed __int32 *)4 ) { QString::toUtf8_helper(QLineEdit::text, v25, v12, v14); Block = (__int64)v14[2]; v11 = (const char *)v14[1]; QCryptographicHash::hash(&amp;Block, v25, &amp;Block, &amp;v15, 4LL); sub_140001620((__int64)&amp;Block, (__int64)v25, a4, (__int64)v16); Block = 64LL; v11 = &quot;c94201919ec7463313c747d0a27fabcabf1400fa1e9a64d36a6b1a7e7b12ae68&quot;; QString::fromUtf8(&amp;Block, v25, &amp;Block, v17); if ( v18 == v16[2] &amp;&amp; (v8 = v18, v6 = v18, v9 = v16[1], v7 = v17[1], (unsigned __int8)QtPrivate::equalStrings(&amp;Block, v25, &amp;v6, &amp;v8)) ) { QString::toUtf8_helper(&amp;Block, v25, v13, v19); sub_1400016F0((__int64)&amp;Block, (__int64)v25, a4, &amp;v20, v19, (__int64)v14); sub_140001620((__int64)&amp;Block, (__int64)v25, a4, (__int64)v21); Block = 72LL; v11 = &quot;af33da5e152c15863b3a03c87601899a37d51b8b8168f65aca65352d3669e91959300ccb&quot;; QString::fromUtf8(&amp;Block, v25, &amp;Block, v22); if ( v23 == v21[2] &amp;&amp; (v8 = v23, v9 = v21[1], v6 = v23, v7 = v22[1], (unsigned __int8)QtPrivate::equalStrings(&amp;Block, v25, &amp;v6, &amp;v8)) ) { Block = 21LL; v11 = (const char *)&amp;unk_1400061D8; QString::fromUtf8(&amp;Block, v25, &amp;Block, v25); Block = 12LL; v11 = (const char *)&amp;unk_1400061EE; QString::fromUtf8(&amp;Block, v25, &amp;Block, v24); QMessageBox::information(&amp;Block, v25, v24, a4, v25, 1024LL); } else { Block = 22LL; v11 = (const char *)&amp;unk_1400061C1; QString::fromUtf8(&amp;Block, v25, &amp;Block, v25); Block = 12LL; v11 = (const char *)&amp;unk_140006104; QString::fromUtf8(&amp;Block, v25, &amp;Block, v24); QMessageBox::warning(&amp;Block, v25, v24, a4, v25, 1024LL); } if ( v24[0] &amp;&amp; !_InterlockedSub(v24[0], 1u) ) free(&amp;Block); if ( v25[0] &amp;&amp; !_InterlockedSub(v25[0], 1u) ) free(&amp;Block); if ( v22[0] &amp;&amp; !_InterlockedSub(v22[0], 1u) ) free(&amp;Block); if ( v21[0] &amp;&amp; !_InterlockedSub(v21[0], 1u) ) free(&amp;Block); if ( v20.m128i_i64[0] &amp;&amp; !_InterlockedSub((volatile signed __int32 *)v20.m128i_i64[0], 1u) ) free(&amp;Block); if ( !v19[0].m128i_i64[0] || _InterlockedSub((volatile signed __int32 *)v19[0].m128i_i64[0], 1u) ) goto LABEL_45; } else { Block = 25LL; v11 = (const char *)&amp;unk_140006159; QString::fromUtf8(&amp;Block, v25, &amp;Block, v25); Block = 12LL; v11 = (const char *)&amp;unk_140006104; QString::fromUtf8(&amp;Block, v25, &amp;Block, v24); QMessageBox::warning(&amp;Block, v25, v24, a4, v25, 1024LL); if ( v24[0] &amp;&amp; !_InterlockedSub(v24[0], 1u) ) free(&amp;Block); if ( !v25[0] || _InterlockedSub(v25[0], 1u) ) goto LABEL_45; } free(&amp;Block);LABEL_45: if ( v17[0] &amp;&amp; !_InterlockedSub(v17[0], 1u) ) free(&amp;Block); if ( v16[0] &amp;&amp; !_InterlockedSub(v16[0], 1u) ) free(&amp;Block); if ( v15 &amp;&amp; !_InterlockedSub(v15, 1u) ) free(&amp;Block); if ( v14[0] &amp;&amp; !_InterlockedSub(v14[0], 1u) ) free(&amp;Block); goto LABEL_10; } Block = 35LL; v11 = (const char *)&amp;unk_1400060E0; QString::fromUtf8(&amp;Block, v25, &amp;Block, v25); Block = 12LL; v11 = (const char *)&amp;unk_140006104; QString::fromUtf8(&amp;Block, v25, &amp;Block, v24); QMessageBox::warning(&amp;Block, v25, v24, a4, v25, 1024LL); if ( v24[0] &amp;&amp; !_InterlockedSub(v24[0], 1u) ) { free(&amp;Block); v5 = v25[0]; if ( !v25[0] ) goto LABEL_10; } else { v5 = v25[0]; if ( !v25[0] ) goto LABEL_10; } if ( !_InterlockedSub(v5, 1u) ) free(&amp;Block);LABEL_10: if ( v13[0] &amp;&amp; !_InterlockedSub(v13[0], 1u) ) free(&amp;Block); if ( v12[0] ) { if ( !_InterlockedSub(v12[0], 1u) ) free(&amp;Block); }} ç¨‹åºçš„å›¾å½¢åŒ–ç•Œé¢æ˜¯QTå®ç°çš„ï¼Œå¼•å…¥äº†QTçš„å¾ˆå¤šç±»ï¼Œæ‰€ä»¥é˜…è¯»éš¾åº¦è¿˜æ˜¯æœ‰ç‚¹å¤§çš„ã€‚å€ŸåŠ©AIä¼˜åŒ–ä¸€ä¸‹ä»¥åŠä¸€ç‚¹ç‚¹åŠ¨æ€è°ƒè¯•è¾…åŠ©åˆ†æå¯ä»¥å¾—åˆ°ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143void __fastcall check(__int64 a1, __int64 a2, __int64 a3, __int64 mainWindows){ volatile signed __int32 *v5; // rax volatile signed __int32 *v6; // [rsp+80h] [rbp-1F8h] BYREF volatile signed __int32 *v7; // [rsp+88h] [rbp-1F0h] volatile signed __int32 *v8; // [rsp+90h] [rbp-1E8h] BYREF volatile signed __int32 *v9; // [rsp+98h] [rbp-1E0h] __int64 Block; // [rsp+A0h] [rbp-1D8h] BYREF const char *stringData; // [rsp+A8h] [rbp-1D0h] volatile signed __int32 *usernameUtf8[4]; // [rsp+B0h] [rbp-1C8h] BYREF volatile signed __int32 *passwordUtf8[4]; // [rsp+D0h] [rbp-1A8h] BYREF volatile signed __int32 *usernameBytes[4]; // [rsp+F0h] [rbp-188h] BYREF volatile signed __int32 *usernameHash; // [rsp+110h] [rbp-168h] BYREF volatile signed __int32 *usernameHashHex[4]; // [rsp+130h] [rbp-148h] BYREF volatile signed __int32 *v17[2]; // [rsp+150h] [rbp-128h] BYREF volatile signed __int32 *expectedUserHashSize; // [rsp+160h] [rbp-118h] __m128i passwordBytes[2]; // [rsp+170h] [rbp-108h] BYREF __m128i v20; // [rsp+190h] [rbp-E8h] BYREF volatile signed __int32 *v21[4]; // [rsp+1B0h] [rbp-C8h] BYREF volatile signed __int32 *v22[2]; // [rsp+1D0h] [rbp-A8h] BYREF volatile signed __int32 *v23; // [rsp+1E0h] [rbp-98h] volatile signed __int32 *v24[4]; // [rsp+1F0h] [rbp-88h] BYREF volatile signed __int32 *tempBuffer[13]; // [rsp+210h] [rbp-68h] BYREF (QLineEdit::text)(QLineEdit::text, tempBuffer, *(*(mainWindows + 40) + 16LL), tempBuffer); QString::trimmed_helper(QLineEdit::text, tempBuffer, tempBuffer, usernameUtf8); if ( tempBuffer[0] &amp;&amp; !_InterlockedSub(tempBuffer[0], 1u) ) free(QLineEdit::text); (QLineEdit::text)(QLineEdit::text, tempBuffer, *(*(mainWindows + 40) + 24LL), passwordUtf8); if ( usernameUtf8[2] == 4 ) // é•¿åº¦æ£€éªŒ { QString::toUtf8_helper(QLineEdit::text, tempBuffer, usernameUtf8, usernameBytes); Block = usernameBytes[2]; stringData = usernameBytes[1]; QCryptographicHash::hash(&amp;Block, tempBuffer, &amp;Block, &amp;usernameHash, 4LL);// æ±‚è¾“å…¥çš„ç”¨æˆ·åhash toHex(&amp;Block, tempBuffer, mainWindows, usernameHashHex); Block = 64LL; stringData = &quot;c94201919ec7463313c747d0a27fabcabf1400fa1e9a64d36a6b1a7e7b12ae68&quot;;// é¢„è®¾å“ˆå¸Œå€¼ QString::fromUtf8(&amp;Block, tempBuffer, &amp;Block, v17); if ( expectedUserHashSize == usernameHashHex[2] &amp;&amp; (v8 = expectedUserHashSize, v6 = expectedUserHashSize, v9 = usernameHashHex[1], v7 = v17[1], QtPrivate::equalStrings(&amp;Block, tempBuffer, &amp;v6, &amp;v8)) )// ç”¨æˆ·åæ£€éªŒ { QString::toUtf8_helper(&amp;Block, tempBuffer, passwordUtf8, passwordBytes); RC4(&amp;Block, tempBuffer, mainWindows, &amp;v20, passwordBytes, usernameBytes); toHex(&amp;Block, tempBuffer, mainWindows, v21); Block = 72LL; stringData = &quot;af33da5e152c15863b3a03c87601899a37d51b8b8168f65aca65352d3669e91959300ccb&quot;; QString::fromUtf8(&amp;Block, tempBuffer, &amp;Block, v22); if ( v23 == v21[2] &amp;&amp; (v8 = v23, v9 = v21[1], v6 = v23, v7 = v22[1], QtPrivate::equalStrings(&amp;Block, tempBuffer, &amp;v6, &amp;v8)) )// éªŒè¯é€šè¿‡ { Block = 21LL; stringData = &amp;unk_7FF7F2EB61D8; QString::fromUtf8(&amp;Block, tempBuffer, &amp;Block, tempBuffer); Block = 12LL; stringData = &amp;unk_7FF7F2EB61EE; QString::fromUtf8(&amp;Block, tempBuffer, &amp;Block, v24); QMessageBox::information(&amp;Block, tempBuffer, v24, mainWindows, tempBuffer, 1024LL); } else // å¯†ç éªŒè¯ä¸é€šè¿‡ { Block = 22LL; stringData = &amp;unk_7FF7F2EB61C1; QString::fromUtf8(&amp;Block, tempBuffer, &amp;Block, tempBuffer); Block = 12LL; stringData = &amp;unk_7FF7F2EB6104; QString::fromUtf8(&amp;Block, tempBuffer, &amp;Block, v24); QMessageBox::warning(&amp;Block, tempBuffer, v24, mainWindows, tempBuffer, 1024LL); } if ( v24[0] &amp;&amp; !_InterlockedSub(v24[0], 1u) ) free(&amp;Block); if ( tempBuffer[0] &amp;&amp; !_InterlockedSub(tempBuffer[0], 1u) ) free(&amp;Block); if ( v22[0] &amp;&amp; !_InterlockedSub(v22[0], 1u) ) free(&amp;Block); if ( v21[0] &amp;&amp; !_InterlockedSub(v21[0], 1u) ) free(&amp;Block); if ( v20.m128i_i64[0] &amp;&amp; !_InterlockedSub(v20.m128i_i64[0], 1u) ) free(&amp;Block); if ( !passwordBytes[0].m128i_i64[0] || _InterlockedSub(passwordBytes[0].m128i_i64[0], 1u) ) goto LABEL_45; } else // ç”¨æˆ·åéªŒè¯ä¸é€šè¿‡ { Block = 25LL; stringData = &amp;unk_7FF7F2EB6159; QString::fromUtf8(&amp;Block, tempBuffer, &amp;Block, tempBuffer); Block = 12LL; stringData = &amp;unk_7FF7F2EB6104; QString::fromUtf8(&amp;Block, tempBuffer, &amp;Block, v24); QMessageBox::warning(&amp;Block, tempBuffer, v24, mainWindows, tempBuffer, 1024LL); if ( v24[0] &amp;&amp; !_InterlockedSub(v24[0], 1u) ) free(&amp;Block); if ( !tempBuffer[0] || _InterlockedSub(tempBuffer[0], 1u) ) goto LABEL_45; } free(&amp;Block);LABEL_45: if ( v17[0] &amp;&amp; !_InterlockedSub(v17[0], 1u) ) free(&amp;Block); if ( usernameHashHex[0] &amp;&amp; !_InterlockedSub(usernameHashHex[0], 1u) ) free(&amp;Block); if ( usernameHash &amp;&amp; !_InterlockedSub(usernameHash, 1u) ) free(&amp;Block); if ( usernameBytes[0] &amp;&amp; !_InterlockedSub(usernameBytes[0], 1u) ) free(&amp;Block); goto LABEL_10; } Block = 35LL; stringData = &amp;unk_7FF7F2EB60E0; QString::fromUtf8(&amp;Block, tempBuffer, &amp;Block, tempBuffer); Block = 12LL; stringData = &amp;unk_7FF7F2EB6104; QString::fromUtf8(&amp;Block, tempBuffer, &amp;Block, v24); QMessageBox::warning(&amp;Block, tempBuffer, v24, mainWindows, tempBuffer, 1024LL); if ( v24[0] &amp;&amp; !_InterlockedSub(v24[0], 1u) ) { free(&amp;Block); v5 = tempBuffer[0]; if ( !tempBuffer[0] ) goto LABEL_10; } else { v5 = tempBuffer[0]; if ( !tempBuffer[0] ) goto LABEL_10; } if ( !_InterlockedSub(v5, 1u) ) free(&amp;Block);LABEL_10: if ( passwordUtf8[0] &amp;&amp; !_InterlockedSub(passwordUtf8[0], 1u) ) free(&amp;Block); if ( usernameUtf8[0] ) { if ( !_InterlockedSub(usernameUtf8[0], 1u) ) free(&amp;Block); }} å¯ä»¥çœ‹åˆ°ç”¨æˆ·åé‡‡ç”¨çš„æ˜¯å“ˆå¸Œæ£€éªŒï¼Œå¯†ç é‡‡ç”¨çš„æ˜¯RC4æ£€éªŒï¼Œå¯†é’¥ä¸ºç”¨æˆ·åã€‚ å¯†ç æ£€éªŒå¥—åœ¨ç”¨æˆ·åæ£€éªŒé‡Œï¼Œæ‰€ä»¥ç¬¬ä¸€æ­¥å…ˆè§£å‡ºç”¨æˆ·åã€‚å€ŸåŠ©åœ¨çº¿è§£å¯†ç½‘ç«™MD5 åœ¨ç·šå…è²»è§£å¯†å¯ä»¥å¾—åˆ°ç”¨æˆ·åâ€Kathâ€ï¼š æ¥ä¸‹æ¥æ±‚è§£å¯†ç ã€‚RC4å‡½æ•°å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889__m128i *__fastcall RC4( __int64 a1, __int64 a2, __int64 a3, __m128i *a4, const __m128i *passwordBytes, __int64 usernameBytes){ volatile signed __int32 *v6; // rax __int64 v7; // rdx bool v8; // zf int keyLength; // r11d int *sBoxPtr; // r8 __m128i initVal; // xmm0 __m128i *sBoxInitPtr; // rax __m128i v15; // xmm2 __m128i currentVal; // xmm1 __int64 keyBytes; // rdi int i_ksa; // ecx int j_ksa; // r9d int v20; // eax int sBoxVal; // r10d __int64 sum; // kr00_8 __int64 passwordIndex; // r12 int j; // ebp __int64 i; // rdi int temp; // eax __int64 v27; // kr08_8 char v28; // r14 _DWORD S[256]; // [rsp+20h] [rbp-438h] BYREF char v31; // [rsp+420h] [rbp-38h] BYREF v6 = passwordBytes-&gt;m128i_i64[0]; v7 = passwordBytes[1].m128i_i64[0]; v8 = passwordBytes-&gt;m128i_i64[0] == 0; *a4 = _mm_loadu_si128(passwordBytes); a4[1].m128i_i64[0] = v7; if ( !v8 ) _InterlockedAdd(v6, 1u); keyLength = *(usernameBytes + 16); sBoxPtr = S; initVal = _mm_load_si128(&amp;xmmword_7FF7F2EB6200); sBoxInitPtr = S; v15 = _mm_load_si128(&amp;xmmword_7FF7F2EB6210); do { currentVal = initVal; ++sBoxInitPtr; initVal = _mm_add_epi32(initVal, v15); sBoxInitPtr[-1] = currentVal; } while ( sBoxInitPtr != &amp;v31 ); keyBytes = *(usernameBytes + 8); i_ksa = 0; j_ksa = 0; do // RC4_KSA { v20 = i_ksa; sBoxVal = *sBoxPtr; ++i_ksa; ++sBoxPtr; sum = sBoxVal + j_ksa + *(keyBytes + v20 % keyLength); j_ksa = (HIBYTE(sum) + sum) - HIBYTE(HIDWORD(sum));// j = j % 256 *(sBoxPtr - 1) = S[j_ksa]; S[j_ksa] = sBoxVal; } while ( i_ksa != 256 ); if ( passwordBytes[1].m128i_i64[0] &gt; 0 ) // RC4_PRGAå’ŒRC4decrypt { passwordIndex = 0LL; j = 0; LODWORD(i) = 0; do { i = ((i + 1) % 256); temp = S[i]; j = (temp + j) % 256; S[i] = S[j]; S[j] = temp; v27 = S[i] + temp; v28 = *(passwordBytes-&gt;m128i_i64[1] + passwordIndex) ^ S[(HIBYTE(v27) + v27) - HIBYTE(HIDWORD(v27))];// v28 = passwordBytes[passwordIndex] ^ S[(S[i]+S[j])%256] if ( !a4-&gt;m128i_i64[0] || *a4-&gt;m128i_i64[0] &gt; 1 ) QByteArray::reallocData(i, passwordBytes, a4[1].m128i_i64[0], a4, 1LL, *initVal.m128i_i64); *(a4-&gt;m128i_i64[1] + passwordIndex++) = v28; } while ( passwordBytes[1].m128i_i64[0] &gt; passwordIndex ); } return a4;} å¯ä»¥çœ‹å‡ºæ˜¯æ ‡å‡†çš„RC4ï¼Œç›´æ¥å¤ç°åŠ å¯†å‡½æ•°å³å¯ã€‚è§£å¯†è„šæœ¬ï¼š 12345678910111213141516171819202122232425262728293031323334353637def rc4_ksa(key): S = list(range(256)) j = 0 for i in range(256): j = (j + S[i] + key[i % len(key)]) % 256 S[i], S[j] = S[j], S[i] return Sdef rc4_prga(S, n): i = j = 0 keystream = [] S = S[:] # copy for _ in range(n): i = (i + 1) % 256 j = (j + S[i]) % 256 S[i], S[j] = S[j], S[i] k = S[(S[i] + S[j]) % 256] keystream.append(k) return bytes(keystream)def rc4_decrypt(key, ciphertext): S = rc4_ksa(key) ks = rc4_prga(S, len(ciphertext)) return bytes(c ^ k for c, k in zip(ciphertext, ks))key = b&quot;Kath&quot;cipher = &quot;af33da5e152c15863b3a03c87601899a37d51b8b8168f65aca65352d3669e91959300ccb&quot;# è½¬æˆbytesciphertext = bytes.fromhex(cipher)# è§£å¯†plaintext = rc4_decrypt(key, ciphertext)# è¾“å‡ºprint(&quot;Plaintext:&quot;, plaintext) flagï¼š0xGame{ce5e5621-3d6b-4429-b72a-957abf353390} Calamity_Fortune è¿™é¢˜ï¼Œå“ˆå“ˆï¼Œæ•°æ®æå–é”™äº†é¢˜ç›®æˆªæ­¢æäº¤48åˆ†é’Ÿåæˆ‘æ‰å‘ç°è¿™ä¸ªé—®é¢˜è§£å‡ºflagğŸ˜„ğŸ« æˆ‘æ°¸è¿œéƒ½ä¸ä¼šåŸè°…æˆ‘è‡ªå·±äº†ğŸ˜„å“ˆå“ˆå“ˆå“ˆ è€ƒç‚¹ï¼šå‡½æ•°é‡å†™ã€å¤æ‚åŠ å¯†ç®—æ³•é€†å‘ã€åŠ¨æ€è°ƒè¯•ç»•è¿‡ç¨‹åºæœºåˆ¶ é™„ä»¶ç¨‹åºåŒå‡»è¿è¡Œä¼šæç¤ºå¦‚å›¾ ç„¶è€Œï¼Œéšä¾¿è¾“ä¸€ä¸ªæ•°å­—çš„è¯ä¼šé—ªé€€ ç¨‹åºç”¨IDAæ‰“å¼€ï¼Œmainå‡½æ•°åç¼–è¯‘å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556int __fastcall main(int argc, const char **argv, const char **envp){ unsigned int v3; // eax int v4; // ebx int v5; // eax int v6; // ecx __int64 v7; // rbx char v8; // cl int v10; // [rsp+20h] [rbp-58h] BYREF char v11[9]; // [rsp+27h] [rbp-51h] BYREF _QWORD v12[5]; // [rsp+30h] [rbp-48h] int v13; // [rsp+58h] [rbp-20h] __int16 v14; // [rsp+5Ch] [rbp-1Ch] sub_401600(argc, argv, envp); SetConsoleOutputCP(0xFDE9u); SetConsoleCP(0xFDE9u); v3 = time64(0LL); srand(v3); v10 = 0; v4 = rand(); puts(&amp;Buffer); v5 = scanf(&quot;%d&quot;, &amp;v10); v6 = 1; if ( v5 == 1 ) { if ( v10 == v4 % 100 + 1 ) { MessageBoxA(0LL, &quot;You guessed right! Is it really right?&quot;, &quot;Result&quot;, 0); return 0; } else { v7 = 0LL; puts(&quot;You guessed it wrong!&quot;); puts(&amp;byte_405098); v12[0] = 0xD0F0C00002B1973LL; v12[1] = 0x182B1A043E1F082BLL; v12[2] = 0x151236080A0D071CLL; v12[3] = 0xA150C0111330622LL; v12[4] = 0xD2B190804073E26LL; v13 = 251992113; v14 = 5130; strcpy(v11, &quot;Calamity&quot;); do { v8 = *((_BYTE *)v12 + v7) ^ v11[v7 &amp; 7]; ++v7; putchar(v8); } while ( v7 != 46 ); return 0; } } return v6;} v12çœ‹ç€åƒå¯†æ–‡ï¼Œçš„ç¡®æ˜¯å¯†æ–‡ï¼Œä½†ä¸æ˜¯flagçš„å¯†æ–‡ï¼Œå› ä¸ºå®ƒåœ¨è¾“å…¥é”™è¯¯çš„æç¤ºé‡Œã€‚æš‚æ—¶æ²¡æœ‰å‘ç°flagæ£€éªŒå‡½æ•°ï¼Œå°è¯•å…ˆç»•è¿‡æ•°å­—æ£€éªŒ åœ¨æ±‡ç¼–çª—å£æ‰¾åˆ°æ•°å­—åˆ¤æ–­è¯­å¥ï¼ˆå¯ä»¥åœ¨åç¼–è¯‘ç•Œé¢é€‰ä¸­åˆ¤æ–­è¯­å¥æ‰€åœ¨è¡Œï¼Œå³é”®Jump to Disasmåˆ°è¾¾ï¼‰ å¯ä»¥çœ‹åˆ°è¿™æ˜¯ä¸€ä¸ªjzï¼Œåªéœ€è¦åœ¨æ‰§è¡Œåˆ°è¿™å¥ä½†æ˜¯è¿˜æ²¡æ­¥è¿‡æ—¶ï¼Œä¿®æ”¹ZFæ ‡å¿—ä½å³å¯ç»•è¿‡ã€‚åœ¨æ­¤å¤„F2ä¸‹æ–­ç‚¹ï¼Œå¼€å§‹åŠ¨è°ƒç¨‹åºã€‚éšä¾¿è¾“ä¸ªæ•°å­—ï¼ŒæŒ‰å›è½¦ æ­¤æ—¶ç¨‹åºåœåœ¨jzå¤„ï¼Œå³æˆ‘ä»¬ä¸‹æ–­ç‚¹çš„åœ°æ–¹ åœ¨å³ä¸Šä¾§å¯„å­˜å™¨çª—å£æ‰¾åˆ°ZF åŒå‡»ZFæŠŠå®ƒçš„å€¼æ”¹æˆ0x1 å¯ä»¥çœ‹åˆ°jzè¯­å¥å¤„æœ‰ä¸€æ¡ç®­å¤´å‡ºæ¥äº† F8æ‰§è¡Œjzè·³è½¬ï¼Œè·Ÿè¸ªç¨‹åºæ‰§è¡Œæµã€‚å¯ä»¥çœ‹åˆ°ç¨‹åºè¿è¡Œåˆ°ä¸€ä¸ªç±»ä¼¼è¾“å‡ºå‡½æ•°çš„åœ°æ–¹ è¿™æ—¶å€™ï¼Œåœ¨è¿™é‡Œå¤šè¯•å‡ æ¬¡ä¼šå‘ç°MessageBoxAå¯ä»¥æ­¥å…¥ã€‚å½“ç„¶è¦æ˜¯æ­¥è¿‡è¿™ä¸ªcall MessageBoxAä¼šå‘ç°ç¨‹åºæ²¡æœ‰å¼¹å‡ºçª—å£ï¼Œå€’æ˜¯ç»ˆç«¯è¾“å‡ºäº†æ–°çš„å¥å­ï¼Œååˆ†å¯ç–‘ æ‰€ä»¥åœ¨ç¨‹åºæ‰§è¡Œåˆ°call cs:MessageBoxAè¿™å¥çš„æ—¶å€™æŒ‰F7æ­¥å…¥ï¼Œå°±ä¼šå‘ç°è¿™ä¸ªMessageBoxAåˆ«æœ‰æ´å¤© è¿™æ˜¾ç„¶ä¸åƒæ˜¯MessageBoxAåº”è¯¥æœ‰çš„æ“ä½œã€‚å¯ä»¥çœ‹åˆ°ä¸€ä¸ªå¯ç–‘çš„åœ°å€è¢«æ”¾åˆ°äº†raxé‡Œï¼Œè·Ÿè¸ªè¿™ä¸ªjmpçœ‹çœ‹ï¼ˆjmp raxå¤„F7æ­¥å…¥ï¼‰ å¯ä»¥çœ‹åˆ°ç¨‹åºè¿è¡Œåˆ°äº†ä¸€ä¸ªæ–°å‡½æ•°ï¼ŒF5åç¼–è¯‘ï¼Œåç¼–è¯‘ä»£ç å¦‚ä¸‹ï¼ˆå‡½æ•°æœ‰å¤šä¸ªæ¨¡å—çš„åŠ å¯†å¤„ç†ï¼Œè¿˜æ˜¯å¾ˆå¤æ‚çš„ï¼Œä»¥ä¸‹æ˜¯ç»è¿‡å˜é‡åä¼˜åŒ–çš„ä»£ç ï¼‰ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261__int64 realMain(){ char v0; // dl char *v1; // rax char v2; // dl char *i; // rax int v4; // eax unsigned __int8 *pFlag1; // r9 _BYTE *pFlag; // rdx unsigned int v7; // esi char v8; // dl char *j; // rax unsigned int *p_block0; // r10 unsigned __int8 *current_1; // rdx int shift; // ecx unsigned int temp_2; // r8d int temp_1; // eax unsigned int cureent_block; // eax unsigned int delta; // r11d int key_value; // ebp unsigned int prev_block; // r9d unsigned int *block; // r8 int rounds; // ecx unsigned int next; // edx unsigned int oriDelta; // ecx unsigned __int8 *encrypted_bytes_1; // r10 unsigned int *v24; // rdi _DWORD *v25; // r8 _DWORD *v26; // rax int shift_1; // ecx unsigned int v28; // edx _BYTE *v29; // r9 unsigned int v30; // r8d unsigned __int64 k; // rax char v32; // dl _BYTE *current1; // rbx int randNum; // eax char tmp; // r8 _BYTE *target; // rdx unsigned __int8 *v37; // rdx unsigned __int8 *end; // rbx unsigned __int8 *current; // rax char *v40; // rcx int m; // eax char *v42; // rax char n; // dl char v44; // dl char *ii; // rax _QWORD key[2]; // [rsp+20h] [rbp-218h] BYREF char notice2[22]; // [rsp+30h] [rbp-208h] BYREF __int16 v49; // [rsp+46h] [rbp-1F2h] BYREF unsigned int block0; // [rsp+50h] [rbp-1E8h] BYREF int v51; // [rsp+54h] [rbp-1E4h] BYREF unsigned int block10; // [rsp+78h] [rbp-1C0h] _BYTE encrypted_bytes[44]; // [rsp+80h] [rbp-1B8h] BYREF int v54; // [rsp+ACh] [rbp-18Ch] BYREF _BYTE flag[44]; // [rsp+B0h] [rbp-188h] BYREF char v56; // [rsp+DCh] [rbp-15Ch] BYREF _QWORD enc[7]; // [rsp+E0h] [rbp-158h] BYREF int v58; // [rsp+118h] [rbp-120h] _BYTE base64_output[59]; // [rsp+120h] [rbp-118h] BYREF _BYTE end_1[5]; // [rsp+15Bh] [rbp-DDh] BYREF char temp[64]; // [rsp+160h] [rbp-D8h] BYREF char notice1[85]; // [rsp+1A0h] [rbp-98h] BYREF _BYTE v63[3]; // [rsp+1F5h] [rbp-43h] BYREF v0 = 79; enc[0] = 0x280D30732B077874LL; enc[1] = 0x242D00103573060BLL; enc[2] = 0x141C3406727D2F73LL; enc[3] = 0xA71137676362833LL; enc[4] = 0xE232B242F04742ALL; enc[5] = 0x2F373F03033D7310LL; enc[6] = 0x77067C3612772D7DLL; qmemcpy(key, &quot;Calamity_Fortune&quot;, sizeof(key)); qmemcpy( notice1, &quot;Ofqni`'jfcb'ns'sont'afu+'sob'tretbvrbis'bidu~wsnhi'tohrkc'eb'f'wnbdb'ha'dflb'ahu'~hry&quot;, sizeof(notice1)); v1 = notice1; v58 = 0x37233104; while ( 1 ) { *v1++ = v0 ^ 7; if ( v63 == v1 ) break; v0 = *v1; } puts(notice1); // Having made it this far,...... v2 = 87; qmemcpy(notice2, &quot;Wkbftb'Niwrs'~hru'akf`&quot;, sizeof(notice2)); for ( i = notice2; ; v2 = *i ) { *i++ = v2 ^ 7; if ( i == &amp;v49 ) break; } puts(notice2); // Please input your flag scanf(&quot;%44s&quot;, flag); v4 = flag[0]; v56 = 0; if ( !flag[0] ) goto LABEL_11; pFlag1 = flag; pFlag = flag; do v7 = 1 - flag + pFlag++; while ( *pFlag ); if ( v7 != 44 ) {LABEL_11: // é”™è¯¯æ—¶çš„è¾“å‡º v8 = 75; qmemcpy(temp, &quot;Kbi`so'Buuhu&amp;&quot;, 13); for ( j = temp; ; v8 = *j ) { *j++ = v8 ^ 7; if ( &amp;temp[13] == j ) break; } puts(temp); // é”™è¯¯æ—¶çš„è¾“å‡º exit(0); } p_block0 = &amp;block0; while ( 1 ) // bytesToBlockï¼Œè½¬æˆuint32_t { current_1 = pFlag1; shift = 0; temp_2 = 0; while ( 1 ) { temp_1 = v4 &lt;&lt; shift; shift += 8; ++current_1; temp_2 |= temp_1; if ( shift == 32 ) break; v4 = *current_1; } pFlag1 += 4; *p_block0++ = temp_2; if ( &amp;v56 == pFlag1 ) break; v4 = *pFlag1; } cureent_block = block10; delta = 0x9E3779B9; key_value = 0x616C6143; prev_block = block0; while ( 1 ) // xxtea { block = &amp;block0; for ( rounds = 0; ; ++rounds ) { next = block[1]; ++block; cureent_block = prev_block + (((cureent_block ^ *(key + (((delta &gt;&gt; 2) ^ rounds) &amp; 3))) + (next ^ delta)) ^ (((4 * next) ^ (cureent_block &gt;&gt; 5)) + ((16 * cureent_block) ^ (next &gt;&gt; 3)))); *(block - 1) = cureent_block; if ( rounds == 9 ) break; prev_block = *block; } prev_block = block0; oriDelta = delta; delta -= 0x61C88647; cureent_block = block10 + ((((cureent_block &gt;&gt; 5) ^ (4 * block0)) + ((16 * cureent_block) ^ (block0 &gt;&gt; 3))) ^ ((block0 ^ oriDelta) + (key_value ^ cureent_block))); block10 = cureent_block; if ( delta == 0xCC623AF3 ) break; key_value = *(key + (((delta &gt;&gt; 2) ^ 0xA) &amp; 3)); } encrypted_bytes_1 = encrypted_bytes; v24 = &amp;v51; // blockToBytesï¼Œuint32_tè½¬æˆbytes v25 = encrypted_bytes; while ( 1 ) { v26 = v25; for ( shift_1 = 0; shift_1 != 32; shift_1 += 8 ) { v26 = (v26 + 1); v28 = prev_block &gt;&gt; shift_1; *(v26 - 1) = v28; } if ( &amp;v54 == ++v25 ) break; prev_block = *v24++; } qmemcpy(temp, &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;, sizeof(temp)); v29 = base64_output; do // base64encode { v30 = *encrypted_bytes_1 &lt;&lt; 16; if ( v7 != 1 ) { v30 |= encrypted_bytes_1[1] &lt;&lt; 8; if ( v7 &gt; 2 ) v30 |= encrypted_bytes_1[2]; } for ( k = 0LL; k != 4; ++k ) { v32 = 61; if ( k &lt;= v7 ) v32 = temp[(v30 &gt;&gt; (-6 * k + 18)) &amp; 0x3F]; v29[k] = v32; } encrypted_bytes_1 += 3; v29 += 4; v7 -= 3; } while ( (&amp;v54 + 1) != encrypted_bytes_1 ); current1 = end_1; end_1[1] = 0; srand(0x65u); // shuffle while ( 1 ) { randNum = rand(); tmp = *current1; target = &amp;base64_output[randNum % (60 - end_1 + current1)]; *current1 = *target; *target = tmp; v37 = current1 - 1; if ( base64_output == current1 - 1 ) break; --current1; } end = current1 + 59; current = v37; do // xor *current++ ^= 0x45u; while ( end != current ); v40 = enc + 1; for ( m = 116; ; m = *v40++ ) { if ( *v37 != m ) // é”™è¯¯å¤„ç†çš„è¾“å‡º { qmemcpy(temp, &quot;Dfkfjns~&amp;'wkbftb'su~'f`fni&quot;, 26); v42 = temp; for ( n = 68; ; n = *v42 ) { *v42++ = n ^ 7; if ( &amp;temp[26] == v42 ) break; } puts(temp); exit(0); } // é”™è¯¯å¤„ç†çš„è¾“å‡º if ( end == ++v37 ) break; } v44 = 65; qmemcpy(temp, &quot;Ahusrib&amp;@hhc'Krdl&amp;&quot;, 18); for ( ii = temp; ; v44 = *ii ) { *ii++ = v44 ^ 7; if ( &amp;temp[18] == ii ) break; } puts(temp); return 1LL;} å‡½æ•°å‡ºç°åœ¨ç¨‹åºè¾“å…¥flagçš„æç¤ºä¹‹åï¼Œåº”è¯¥å°±æ˜¯flagæ£€éªŒå‡½æ•°äº†ã€‚å‡½æ•°ä½¿ç”¨äº†å¾ˆå¤šåŠ å¯†æ‰‹æ®µï¼Œç”šè‡³è¿æç¤ºè¯éƒ½æ˜¯å®æ—¶è§£å¯†çš„ã€‚å¯ä»¥çœ‹åˆ°å¯¹è¾“å…¥çš„flagä¾æ¬¡è¿›è¡Œäº†æ ¼å¼è½¬æ¢ã€é­”æ”¹XXTEAåŠ å¯†ã€æ ¼å¼è½¬æ¢ã€base64ç¼–ç ã€shuffleæ´—ç‰Œç®—æ³•æ‰“ä¹±ã€å¼‚æˆ–å¤„ç†ï¼Œæœ€åæ‰å’Œé¢„è®¾çš„å¯†æ–‡è¿›è¡Œæ¯”è¾ƒæ£€éªŒã€‚ è¿™é‡Œç»™å‡ºä¸€ä¸ªAIå¤ç°çš„ã€ç»è¿‡æµ‹è¯•ç­‰ä»·çš„è„šæœ¬ï¼Œæ–¹ä¾¿ç†è§£è¿™ä¸ªå¤æ‚çš„ç®—æ³•ï¼ˆè¢«å‡½æ•°æ”¹å†™æ•´æ€•äº†ï¼Œæ‰€ä»¥éšæœºæ•°ç”Ÿæˆç®—æ³•ä¹Ÿå¤ç°äº†ï¼‰ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127#include &lt;stdio.h&gt;#include &lt;stdint.h&gt;#include &lt;string.h&gt;// MSVC-compatible randstatic uint32_t rand_seed;void custom_srand(uint32_t seed) { rand_seed = seed; }uint32_t custom_rand() { rand_seed = rand_seed * 214013 + 2531011; return (rand_seed &gt;&gt; 16) &amp; 0x7FFF;}// XXTEA encryption (as in realMain)void encrypt_xxtea_variant(uint32_t block[11], const uint32_t key[4]) { uint32_t cureent_block = block[10]; uint32_t delta = 0x9E3779B9U; uint32_t key_value = 0x616C6143U; // åˆå§‹å€¼ï¼Œä½†ç¬¬ä¸€è½®å†…å¾ªç¯ä¸ç”¨å®ƒ uint32_t prev_block = block[0]; while (1) { uint32_t* bptr = &amp;block[0]; for (int rounds = 0; ; ++rounds) { uint32_t next = bptr[1]; ++bptr; uint32_t k = key[((delta &gt;&gt; 2) ^ rounds) &amp; 3]; uint32_t term1 = (cureent_block ^ k) + (next ^ delta); uint32_t term2 = (4 * next ^ (cureent_block &gt;&gt; 5)) + (16 * cureent_block ^ (next &gt;&gt; 3)); cureent_block = prev_block + (term1 ^ term2); *(bptr - 1) = cureent_block; if (rounds == 9) break; prev_block = *bptr; // æ­¤æ—¶ *bptr å°šæœªè¢«ä¿®æ”¹ï¼ˆæ˜¯åŸå§‹å€¼ï¼‰ } prev_block = block[0]; uint32_t oriDelta = delta; delta -= 0x61C88647U; key_value = key[((oriDelta &gt;&gt; 2) ^ 0xA) &amp; 3]; uint32_t term1 = ((cureent_block &gt;&gt; 5) ^ (4 * block[0])) + ((16 * cureent_block) ^ (block[0] &gt;&gt; 3)); uint32_t term2 = (block[0] ^ oriDelta) + (key_value ^ cureent_block); cureent_block = block[10] + (term1 ^ term2); block[10] = cureent_block; if (delta == 0xCC623AF3U) break; }}// Base64 encode 44 bytes -&gt; 60 charsvoid base64_encode(const uint8_t* input, char* output) { const char* table = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;; for (int i = 0; i &lt; 44; i += 3) { uint32_t val = (input[i] &lt;&lt; 16) | ((i + 1 &lt; 44 ? input[i + 1] : 0) &lt;&lt; 8) | ((i + 2 &lt; 44 ? input[i + 2] : 0)); output[0] = table[(val &gt;&gt; 18) &amp; 0x3F]; output[1] = table[(val &gt;&gt; 12) &amp; 0x3F]; output[2] = (i + 1 &lt; 44) ? table[(val &gt;&gt; 6) &amp; 0x3F] : '='; output[3] = (i + 2 &lt; 44) ? table[val &amp; 0x3F] : '='; output += 4; }}int main() { // Step 1: Input flag char flag[45] = &quot;0xGame{aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa}&quot;;//æµ‹è¯•æ ·ä¾‹ printf(&quot;Input flag: %s\\n&quot;, flag); // Step 2: Convert to 11 uint32_t (little-endian) uint32_t blocks[11]; for (int i = 0; i &lt; 11; i++) { blocks[i] = (uint8_t)flag[i * 4] | ((uint8_t)flag[i * 4 + 1] &lt;&lt; 8) | ((uint8_t)flag[i * 4 + 2] &lt;&lt; 16) | ((uint8_t)flag[i * 4 + 3] &lt;&lt; 24); } // Step 3: XXTEA encrypt uint32_t key[4] = { 0x616C6143, // 'C','a','l','a' 0x7974696D, // 'm','i','t','y' 0x726F465F, // '_','F','o','r' 0x656E7574 // 't','u','n','e' }; encrypt_xxtea_variant(blocks, key); printf(&quot;TEA encrypted blocks (hex, little-endian order):\\n&quot;); for (int i = 0; i &lt; 11; i++) { printf(&quot;%08x\\n&quot;, blocks[i]); } printf(&quot;\\n&quot;); // Step 4: Convert back to bytes (little-endian) uint8_t encrypted_bytes[44]; for (int i = 0; i &lt; 11; i++) { encrypted_bytes[i * 4] = blocks[i] &amp; 0xFF; encrypted_bytes[i * 4 + 1] = (blocks[i] &gt;&gt; 8) &amp; 0xFF; encrypted_bytes[i * 4 + 2] = (blocks[i] &gt;&gt; 16) &amp; 0xFF; encrypted_bytes[i * 4 + 3] = (blocks[i] &gt;&gt; 24) &amp; 0xFF; } // Step 5: Base64 encode char base64_str[61] = { 0 }; base64_encode(encrypted_bytes, base64_str); printf(&quot;Base64: %s\\n&quot;, base64_str); // Step 6: Shuffle (Fisher-Yates, i=59 downto 1) custom_srand(0x65); for (int i = 59; i &gt;= 1; i--) { int j = custom_rand() % (i + 1); // Swap base64_str[i] and base64_str[j] char tmp = base64_str[i]; base64_str[i] = base64_str[j]; base64_str[j] = tmp; } // Output shuffled result (before XOR) printf(&quot;After shuffle (before XOR): %s\\n&quot;, base64_str); printf(&quot;Hex dump:\\n&quot;); for (int i = 0; i &lt; 60; i++) { printf(&quot;%02x &quot;, (uint8_t)base64_str[i]); if ((i + 1) % 16 == 0) printf(&quot;\\n&quot;); } if (60 % 16 != 0) printf(&quot;\\n&quot;); printf(&quot;\\n&quot;); for (int i = 0; i &lt; 60; i++) { printf(&quot;%02x &quot;, (uint8_t)base64_str[i] ^ 0x45); } printf(&quot;\\n&quot;); return 0;} è§£å¯†æ€è·¯ï¼šå¼‚æˆ–æ¨¡å—ç›´æ¥ä¸€æ¨¡ä¸€æ ·åœ°é‡å¤ä¸€éå³å¯ï¼›shuffleæ¨¡å—å¯ä»¥å…ˆä»åŠ å¯†ç®—æ³•è·å¾—éšæœºæ•°åºåˆ—ï¼Œè¿™æ ·æ–¹ä¾¿ä»åå¾€å‰ç´¢å¼•è¿˜åŸï¼›å‰©ä¸‹çš„çœ‹è„šæœ¬å§ğŸ« ï¼ˆå¯¹äº†ï¼Œè¦æ³¨æ„encæ•°æ®è¦ä»æ ˆä¸Šæå–ï¼Œç¬”è€…è®©AIä»åç¼–è¯‘çš„ä»£ç é‡Œæå–ï¼Œè‚‰çœ¼æ£€éªŒæ²¡å‘ç°bytesæˆªå–é”™äº†ï¼Œæµªè´¹äº†å¥½å¤šæ—¶é—´ï¼‰ è§£å¯†è„šæœ¬ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148#include &lt;stdio.h&gt;#include &lt;stdint.h&gt;#include &lt;string.h&gt;// ========== ä½ æä¾›çš„è§£å¯†å‡½æ•° ==========void decrypt_xxtea_variant(uint32_t block[11], const uint32_t key[4]) { const int TOTAL_ROUNDS = 10; uint32_t delta = 0xCC623AF3U; for (int round = 0; round &lt; TOTAL_ROUNDS; round++) { uint32_t oriDelta = delta + 0x61C88647U; uint32_t key_value = key[((oriDelta &gt;&gt; 2) ^ 0xA) &amp; 3]; uint32_t C9 = block[9]; uint32_t C0 = block[0]; uint32_t term1 = ((C9 &gt;&gt; 5) ^ (4 * C0)) + ((16 * C9) ^ (C0 &gt;&gt; 3)); uint32_t term2 = (C0 ^ oriDelta) + (key_value ^ C9); uint32_t G = term1 ^ term2; uint32_t original_block10 = block[10] - G; uint32_t saved_block10 = original_block10; for (int i = 9; i &gt;= 0; i--) { uint32_t next = (i == 9) ? saved_block10 : block[i + 1]; uint32_t prev_C = (i == 0) ? saved_block10 : block[i - 1]; uint32_t k = key[((oriDelta &gt;&gt; 2) ^ i) &amp; 3]; uint32_t part1 = (prev_C ^ k) + (next ^ oriDelta); uint32_t part2 = (4 * next ^ (prev_C &gt;&gt; 5)) + (16 * prev_C ^ (next &gt;&gt; 3)); uint32_t H = part1 ^ part2; block[i] = block[i] - H; } block[10] = original_block10; delta += 0x61C88647U; }}const char* table = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;;int base64_decode(const char* input, uint8_t* output) { int out_len = 0; for (int i = 0; i &lt; 60; i += 4) { uint32_t val = 0; for (int j = 0; j &lt; 4; j++) { const char* p = strchr(table, input[i + j]); if (p) val = (val &lt;&lt; 6) | (p - table); else val &lt;&lt;= 6; } output[out_len++] = (val &gt;&gt; 16) &amp; 0xFF; if (input[i + 2] != '=') output[out_len++] = (val &gt;&gt; 8) &amp; 0xFF; if (input[i + 3] != '=') output[out_len++] = val &amp; 0xFF; } return out_len;}void deshuffle(char* cipher, uint32_t* rand_seq) { // é€†åºéå†ï¼št ä» 58 åˆ° 0 for (int t = 58; t &gt;= 0; t--) { int i = 59 - t; // åŠ å¯†æ—¶çš„ i int j = rand_seq[t]; // åŠ å¯†æ—¶çš„ j // å†æ¬¡äº¤æ¢ cipher[i] å’Œ cipher[j] char temp = cipher[i]; cipher[i] = cipher[j]; cipher[j] = temp; }}// ========== ä¸»ç¨‹åº ==========int main() { // Step 1: ä½¿ç”¨ä½ æä¾›çš„ 60 å­—èŠ‚ç›®æ ‡å¯†æ–‡ uint8_t encrypted_target_bytes[60] = { 0x74, 0x78, 0x07, 0x2B, 0x73, 0x30, 0x0D, 0x28, 0x0B, 0x06, 0x73, 0x35, 0x10, 0x00, 0x2D, 0x24, 0x73, 0x2F, 0x7D, 0x72, 0x06, 0x34, 0x1C, 0x14, 0x33, 0x28, 0x36, 0x76, 0x76, 0x13, 0x71, 0x0A, 0x2A, 0x74, 0x4, 0x2f, 0x24, 0x2b, 0x23, 0xe, 0x10, 0x73, 0x3D, 0x03, 0x03, 0x3F, 0x37, 0x2F, 0x7D, 0x2D, 0x77, 0x12, 0x36, 0x7C, 0x06, 0x77, 0x04, 0x31, 0x23, 0x37 }; // Step 2: XOR 0x45 å¾—åˆ° shuffled base64 å­—ç¬¦ä¸² char shuffled_b64[60] = { 0 }; //printf(&quot;step1: xor\\n&quot;); for (int i = 0; i &lt; 60; i++) { shuffled_b64[i] = encrypted_target_bytes[i] ^ 0x45; //printf(&quot;%c&quot;, shuffled_b64[i]); } //printf(&quot;\\nstep2: deshuffle\\n&quot;); // Step 3: ä½¿ç”¨ä½ æä¾›çš„ rand() åºåˆ—ï¼ˆåŸå§‹å€¼ï¼Œæœªå–æ¨¡ï¼‰ uint32_t rand_seq[59] = { 8, 46, 21, 19, 35, 1, 1, 7, 37, 17, 33, 13, 17, 10, 34, 34, 6, 20, 35, 10, 22, 21, 7, 16, 6, 18, 30, 32, 6, 2, 9, 0, 7, 4, 23, 18, 18, 16, 15, 15, 6, 15, 16, 3, 13, 13, 9, 2, 11, 10, 3, 2, 0, 1, 3, 0, 3, 0, 0 }; deshuffle(shuffled_b64, rand_seq); //for (int i = 0; i &lt; 60; i++) { //printf(&quot;%c&quot;, shuffled_b64[i]); //} char original_b64[61] = { 0 }; for (int i = 0; i &lt; 60; i++) { original_b64[i] = shuffled_b64[i]; } original_b64[60] = '\\0'; //printf(&quot;\\n&quot;); // Step 4: Base64 è§£ç  uint8_t encrypted_bytes[44]; int decoded_len = base64_decode(original_b64, encrypted_bytes); if (decoded_len != 44) { return 1; } // Step 5: é‡ç»„ä¸º 11 ä¸ª uint32_tï¼ˆå°ç«¯åºï¼‰ uint32_t block[11]; for (int i = 0; i &lt; 11; i++) { block[i] = ((uint32_t)encrypted_bytes[i * 4 + 0] &lt;&lt; 0) | ((uint32_t)encrypted_bytes[i * 4 + 1] &lt;&lt; 8) | ((uint32_t)encrypted_bytes[i * 4 + 2] &lt;&lt; 16) | ((uint32_t)encrypted_bytes[i * 4 + 3] &lt;&lt; 24); } // Step 6: è®¾ç½®å¯†é’¥ &quot;Calamity_Fortune&quot;ï¼ˆ16 å­—èŠ‚ï¼‰ uint32_t key[4] = { 0x616C6143U, 0x7974696DU, 0x726F465FU, 0x656E7574U }; // Step 7: è°ƒç”¨ä½ æä¾›çš„è§£å¯†å‡½æ•° decrypt_xxtea_variant(block, key); // Step 8: è½¬å› flag å­—ç¬¦ä¸²ï¼ˆå°ç«¯ï¼‰ char flag[45] = { 0 }; for (int i = 0; i &lt; 11; i++) { flag[i * 4 + 0] = (block[i] &gt;&gt; 0) &amp; 0xFF; flag[i * 4 + 1] = (block[i] &gt;&gt; 8) &amp; 0xFF; flag[i * 4 + 2] = (block[i] &gt;&gt; 16) &amp; 0xFF; flag[i * 4 + 3] = (block[i] &gt;&gt; 24) &amp; 0xFF; } printf(&quot;Flag: %s\\n&quot;, flag); return 0;} flagï¼š0xGame{f279c1e7-8b0d-4a3b-9c6f-5e4d2a1b0c89}","link":"/2025/10/28/0xGame2025Week3ReverseWriteUp/"},{"title":"19thCISCNåˆèµ›WriteUp","text":"ç¬¬ä¸€æ¬¡å‚åŠ å›½èµ›ï¼Œéš¾å“­äº†ğŸ˜­ğŸ˜­ WriteUpbabygame godoté€†å‘,AESç®—æ³• é™„ä»¶ç¨‹åºæ˜¯ä¸ªå°æ¸¸æˆã€‚æ‹–å…¥x64dbgåˆ†æï¼Œä¸€è·¯F9ï¼Œåœ¨å…¥å£ç‚¹é™„è¿‘å¯ä»¥çœ‹åˆ°Godot Engineå­—æ · ä¸Šç½‘æŸ¥æ‰¾ä¸€ä¸‹å¯ä»¥çŸ¥é“godotæ˜¯ä¸€ç§æ¸¸æˆå¼•æ“ï¼Œç±»ä¼¼unityï¼Œå¯ä»¥è§£åŒ… ä½¿ç”¨GDRETools/gdsdecompè§£æexeå¯ä»¥å¾—åˆ°ä¸€ä¸ªbabygameæ–‡ä»¶å¤¹ï¼Œæ–‡ä»¶å¤¹ä¸‹çš„scriptsç›®å½•æ‰“å¼€å¦‚ä¸‹ 010editorå¯ä»¥æ‰“å¼€gdæ–‡ä»¶ç›´æ¥æŸ¥çœ‹ï¼Œå¦‚ä¸‹æ˜¯flag.gdï¼Œå‡ºç°äº†ä¸»è¦çš„æ£€éªŒé€»è¾‘ï¼ŒåŠ å¯†ä½¿ç”¨äº†AES_ECB 12345678910111213141516171819202122232425262728293031extends CenterContainer@onready var flagTextEdit: Node = $PanelContainer / VBoxContainer / FlagTextEdit@onready var label2: Node = $PanelContainer / VBoxContainer / Label2static var key = &quot;FanAglFanAglOoO!&quot;var data = &quot;&quot;func _on_ready() -&gt; void : Flag.hide()func get_key() -&gt; String: return keyfunc submit() -&gt; void : data = flagTextEdit.text var aes = AESContext.new() aes.start(AESContext.MODE_ECB_ENCRYPT, key.to_utf8_buffer()) var encrypted = aes.update(data.to_utf8_buffer()) aes.finish() if encrypted.hex_encode() == &quot;d458af702a680ae4d089ce32fc39945d&quot;: label2.show() else: label2.hide()func back() -&gt; void : get_tree().change_scene_to_file(&quot;res://scenes/menu.tscn&quot;)extends Node é¢˜ç›®æç¤ºéœ€è¦æ”¶é›†é‡‘å¸ï¼ˆå¾—åˆ†ï¼‰ï¼Œåœ¨game_manager.gdé‡Œå¯ä»¥å‘ç°å¾—åˆ†ä¼šä¿®æ”¹keyï¼ŒAä¼šè¢«æ›¿æ¢æˆB 123456789@onready var fan = $&quot;../Fan&quot;var score = 0func add_point(): score += 1 if score == 1: Flag.key = Flag.key.replace(&quot;A&quot;, &quot;B&quot;) fan.visible = true æ‰€ä»¥æŠŠkeyæ”¹ä¸€ä¸‹ï¼Œç„¶åä½¿ç”¨Cryptoåº“è§£å¯†å³å¯ Exp: 123456789from Crypto.Cipher import AESimport binasciienc=&quot;d458af702a680ae4d089ce32fc39945d&quot;enc_bytes=binascii.unhexlify(enc)key=b&quot;FanBglFanBglOoO!&quot;cipher = AES.new(key, AES.MODE_ECB)decrypted = cipher.decrypt(enc_bytes)print(decrypted) #flag{wOW~youAregrEaT!} å¤ç°wasm-login js+wasmé€†å‘(æ²¡å­¦è¿‡jswebé€†å‘â•¥ï¹â•¥â€¦ é™„ä»¶æ˜¯ä¸ªç½‘é¡µç™»å½•æ ¡éªŒé¡¹ç›® é¢˜ç›®æè¿°ï¼š åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ‰§è¡Œpython -m http.server 4000å¯ä»¥æŠŠé¡¹ç›®è·‘èµ·æ¥ï¼ˆå½“ç„¶ç›´æ¥çœ‹ä»£ç ä¹Ÿè¡Œï¼Œä½†æ˜¯å½“æ—¶æ²¡æ€è·¯ï¼Œäºæ˜¯å°±æ‰¾äº†ä¸ªåŠæ³•æŠŠé¡¹ç›®è·‘èµ·æ¥çœ‹çœ‹ï¼‰ index.htmlçš„scriptéƒ¨åˆ†å¦‚ä¸‹ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140 &lt;script src=&quot;crypto-js.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;build/release.js&quot;&gt;&lt;/script&gt; &lt;script type=&quot;module&quot;&gt; import { authenticate } from &quot;./build/release.js&quot;; // åˆå§‹åŒ– WASM æ¨¡å— async function initWasm() { const wasmStatus = document.getElementById('wasm-status'); const loginForm = document.getElementById('login-form'); const loginBtn = document.getElementById('login-btn'); const loginSpinner = document.getElementById('login-spinner'); const statusMessage = document.getElementById('status-message'); const errorMessage = document.getElementById('error-message'); const passwordInput = document.getElementById('password'); const togglePasswordBtn = document.getElementById('toggle-password'); try { // åˆå§‹åŒ–å®Œæˆ wasmStatus.textContent = 'WASM å·²åŠ è½½'; wasmStatus.classList.add('text-success'); // åˆ‡æ¢å¯†ç å¯è§æ€§ togglePasswordBtn.addEventListener('click', function() { const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password'; passwordInput.setAttribute('type', type); const icon = this.querySelector('i'); const text = this.querySelector('span'); if (type === 'text') { icon.classList.remove('fa-eye-slash'); icon.classList.add('fa-eye'); text.textContent = 'éšè—'; } else { icon.classList.remove('fa-eye'); icon.classList.add('fa-eye-slash'); text.textContent = 'æ˜¾ç¤º'; } }); // ç™»å½•è¡¨å•æäº¤å¤„ç† loginForm.addEventListener('submit', async function(e) { e.preventDefault(); // æ˜¾ç¤ºåŠ è½½çŠ¶æ€ loginBtn.disabled = true; loginSpinner.classList.remove('hidden'); statusMessage.classList.add('hidden'); try { const username = document.getElementById('username').value; const password = document.getElementById('password').value; // è°ƒç”¨ WASM ä¸­çš„ authenticate å‡½æ•° const authResult = authenticate(username, password); const authData = JSON.parse(authResult); // æ¨¡æ‹Ÿå‘é€åˆ°æœåŠ¡å™¨ console.log('å‘é€åˆ°æœåŠ¡å™¨çš„æ•°æ®:', authData); // æ¨¡æ‹ŸæœåŠ¡å™¨å“åº” simulateServerRequest(authData) .then(response =&gt; { if (response.success) { // ç™»å½•æˆåŠŸ alert('ç™»å½•æˆåŠŸï¼'); } else { // ç™»å½•å¤±è´¥ showError(response.message || 'ç™»å½•å¤±è´¥ï¼Œè¯·é‡è¯•'); } }) .catch(error =&gt; { console.error('ç™»å½•é”™è¯¯:', error); showError('ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åé‡è¯•'); }) .finally(() =&gt; { // æ¢å¤æŒ‰é’®çŠ¶æ€ loginBtn.disabled = false; loginSpinner.classList.add('hidden'); }); } catch (error) { console.error('WASM å¤„ç†é”™è¯¯:', error); showError('å†…éƒ¨é”™è¯¯ï¼Œè¯·è”ç³»ç®¡ç†å‘˜'); // æ¢å¤æŒ‰é’®çŠ¶æ€ loginBtn.disabled = false; loginSpinner.classList.remove('hidden'); } }); // æ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯ function showError(message) { errorMessage.textContent = message; statusMessage.classList.remove('hidden'); // æ·»åŠ åŠ¨ç”»æ•ˆæœ const errorBox = statusMessage.querySelector('div'); errorBox.classList.add('animate-shake'); setTimeout(() =&gt; { errorBox.classList.remove('animate-shake'); }, 500); } // æ¨¡æ‹ŸæœåŠ¡å™¨è¯·æ±‚ function simulateServerRequest(data) { return new Promise(resolve =&gt; { // æ¨¡æ‹Ÿç½‘ç»œå»¶è¿Ÿ setTimeout(() =&gt; { // å®é™…åº”ç”¨ä¸­è¿™é‡Œåº”è¯¥æ˜¯çœŸå®çš„ API è¯·æ±‚ // è¿™é‡Œä»…ä½œæ¼”ç¤ºï¼Œä½¿ç”¨æœ¬åœ°åˆ¤æ–­ const check = CryptoJS.MD5(JSON.stringify(data)).toString(CryptoJS.enc.Hex); if (check.startsWith(&quot;ccaf33e3512e31f3&quot;)){ resolve({ success: true }); }else{ resolve({ success: false }); } }, 1000); }); } } catch (error) { console.error('WASM åŠ è½½å¤±è´¥:', error); wasmStatus.textContent = 'WASM åŠ è½½å¤±è´¥'; wasmStatus.classList.add('text-danger'); // ç¦ç”¨ç™»å½•æŒ‰é’® loginBtn.disabled = true; loginBtn.classList.add('bg-neutral-400'); loginBtn.classList.remove('bg-primary', 'hover:bg-primary/90'); } } // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ– WASM window.addEventListener('load', initWasm); &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; &lt;!-- æµ‹è¯•è´¦å· admin æµ‹è¯•å¯†ç  admin--&gt; å®¡é˜…ä»£ç å¯çŸ¥ï¼Œæ ¡éªŒé€»è¾‘åœ¨simulateServerRequest()é‡Œï¼Œä¸»è¦æ˜¯å¦‚ä¸‹å‡ è¡Œ 123456const check = CryptoJS.MD5(JSON.stringify(data)).toString(CryptoJS.enc.Hex);if (check.startsWith(&quot;ccaf33e3512e31f3&quot;)){ resolve({ success: true });}else{ resolve({ success: false });} dataæ˜¯ä¼ å…¥çš„å‚æ•°ï¼Œå®é™…å‚æ•°åº”è¯¥æ˜¯authDataï¼š 1234567891011121314// è°ƒç”¨ WASM ä¸­çš„ authenticate å‡½æ•°const authResult = authenticate(username, password);const authData = JSON.parse(authResult);// æ¨¡æ‹ŸæœåŠ¡å™¨å“åº”simulateServerRequest(authData).then(response =&gt; { if (response.success) { // ç™»å½•æˆåŠŸ alert('ç™»å½•æˆåŠŸï¼'); } else { // ç™»å½•å¤±è´¥ showError(response.message || 'ç™»å½•å¤±è´¥ï¼Œè¯·é‡è¯•'); }}) æ‰€ä»¥æ ¡éªŒé€»è¾‘ä¸ºï¼šè°ƒç”¨wasmçš„authenticateå‡½æ•°ï¼Œè¿”å›å€¼æ±‚md5åä¸ç»™å®šçš„å“ˆå¸Œå€¼å¤´â€ccaf33e3512e31f3â€è¿›è¡Œæ¯”è¾ƒã€‚ç»“åˆé¢˜ç›®æè¿°ï¼Œauthenticateå‡½æ•°é™¤äº†ç”¨åˆ°index.htmlæœ«å°¾çš„æµ‹è¯•è´¦å¯†ï¼Œè¿˜å¯èƒ½ç”¨åˆ°äº†æ—¶é—´æˆ³ï¼Œæ„å‘³ç€éœ€è¦æ±‚å‡ºè¿™ä¸ªæ—¶é—´æˆ³è¿›è€Œæ±‚å‡ºå®Œæ•´å“ˆå¸Œå€¼ã€‚å¯ä»¥é€‰æ‹©çˆ†ç ´æ—¶é—´æˆ³ï¼Œä½†æ˜¯åœ¨æ­¤ä¹‹å‰è¿˜å¾—äº†è§£ä¸€ä¸‹æ—¶é—´æˆ³æ€ä¹ˆæ¥çš„ release.jsç”¨æ¥è¿æ¥wasmå’Œjsï¼Œåœ¨release.jsé‡Œå¯ä»¥çœ‹åˆ°ä¸€äº›wasmçš„ç¯å¢ƒé…ç½®ï¼š 123456789101112131415161718192021222324const adaptedImports = { env: Object.setPrototypeOf({ abort(message, fileName, lineNumber, columnNumber) { // ~lib/builtins/abort(~lib/string/String | null?, ~lib/string/String | null?, u32?, u32?) =&gt; void message = __liftString(message &gt;&gt;&gt; 0); fileName = __liftString(fileName &gt;&gt;&gt; 0); lineNumber = lineNumber &gt;&gt;&gt; 0; columnNumber = columnNumber &gt;&gt;&gt; 0; (() =&gt; { // @external.js throw Error(`${message} in ${fileName}:${lineNumber}:${columnNumber}`); })(); }, &quot;console.log&quot;(text) { // ~lib/bindings/dom/console.log(~lib/string/String) =&gt; void text = __liftString(text &gt;&gt;&gt; 0); console.log(text); }, &quot;Date.now&quot;() { // ~lib/bindings/dom/Date.now() =&gt; f64 return Date.now(); }, }, Object.assign(Object.create(globalThis), imports.env || {})), }; æ­¤å¤„è®¾ç½®äº†ç¯å¢ƒé‡(ç¯å¢ƒå‡½æ•°ï¼Ÿ)Date.now()ï¼Œé€šè¿‡å·¥å…·wabtä¸‹çš„wasm2cè½¬åŒ–å‡ºwasmçš„cä»£ç ï¼Œä¹Ÿå¯ä»¥å‘ç°ç›¸å…³å†…å®¹ æ¥ä¸‹æ¥ï¼Œè¦æƒ³çˆ†ç ´æ—¶é—´æˆ³ï¼Œéœ€è¦èƒ½å¤Ÿè®¾ç½®authenticateå‡½æ•°ä½¿ç”¨çš„æ—¶é—´æˆ³ã€‚åœ¨wasmé‡Œéš¾ä»¥ä¿®æ”¹ç›¸å…³é€»è¾‘ï¼Œåªå¥½åœ¨release.jsä¸­ä¿®æ”¹Date.now()çš„å®šä¹‰ï¼Œä½¿å…¶åœ¨è¢«authenticateå‡½æ•°è°ƒç”¨çš„æ—¶å€™è¿”å›æˆ‘ä»¬æƒ³è¦çš„æ•°ã€‚è¿™é‡Œå¯ä»¥è®¾ç½®ä¸€ä¸ªå…¨å±€å˜é‡globalThis.mytimeï¼Œç„¶åä¿®æ”¹Date.now()çš„è¿”å›å€¼ä¸ºè¿™ä¸ªå…¨å±€å˜é‡ï¼Œè¿™æ ·å°±å¯ä»¥è®¾ç½®ä¸åŒçš„æ—¶é—´æˆ³æ¥è®©authenticateå‡½æ•°ä½¿ç”¨äº†ã€‚ æœ€åæŠ„ä¸€ä¸‹index.htmlé‡Œæ£€éªŒé€»è¾‘çš„jsä»£ç å°±å¯ä»¥å†™å‡ºhookè„šæœ¬ï¼š 1234567891011121314151617181920212223242526272829import { authenticate } from &quot;./build/release.js&quot;;// æ¨¡ä»¿index.htmlå¯¼å…¥authenticateå‡½æ•°ï¼Œåç»­ç›´æ¥è°ƒç”¨import CryptoJS from &quot;crypto-js&quot;;// index.htmlçš„æ£€éªŒé€»è¾‘ç”¨åˆ°äº†è¿™ä¸ªæ–‡ä»¶ï¼Œéœ€è¦å¯¼å…¥ï¼Œå¦åˆ™ç…§æŠ„ä¼šæŠ¥é”™function hook(){ var startTime=new Date(&quot;2025-12-21T22:40:00+08:00&quot;).getTime(); var endTime=new Date(&quot;2025-12-22T01:10:00+08:00&quot;).getTime(); // è¿™é‡Œçš„æ—¶é—´èŒƒå›´æ˜¯é€šè¿‡æ–‡ä»¶ä¿®æ”¹æ—¶é—´æ¨æµ‹å‡ºæ¥çš„ï¼ˆçœ‹å…¶ä»–å¸ˆå‚…çš„wpæ‰getåˆ°è¿™ç‚¹ï¼Œå¤ªç»†äº†ï¼‰ const username = &quot;admin&quot;; const password = &quot;admin&quot;; console.log(&quot;Start brute forcing...&quot;); for(let i=startTime;i&lt;=endTime;i+=1){ globalThis.mytime = i; // ä¸‹é¢å‡ è¡Œç›´æ¥æŠ„åŸä»£ç å³å¯ // è°ƒç”¨ WASM ä¸­çš„ authenticate å‡½æ•° const authResult = authenticate(username, password); const authData = JSON.parse(authResult); var check = CryptoJS.MD5(JSON.stringify(authData)).toString(CryptoJS.enc.Hex); if(check.startsWith(&quot;ccaf33e3512e31f3&quot;)){ console.log(&quot;found hash:&quot;,check);// è¿”å›æ“ä½œæ”¹æˆè¾“å‡ºhash } } console.log(&quot;Brute forcing completed.&quot;);}hook();// Start brute forcing...// found hash: ccaf33e3512e31f36228f0b97ccbc8f1// Brute forcing completed. eternum goé€†å‘ï¼Œå¾…æ›´æ–°â€¦ vvvmmm vmé€†å‘ï¼Œå¾…æ›´æ–°â€¦","link":"/2025/12/28/19thCISCN%E5%88%9D%E8%B5%9BWriteUp&%E5%A4%8D%E7%8E%B0/"},{"title":"Day1:x86æ±‡ç¼–æ¡†æ¶ã€æ•°æ®ç±»å‹ã€åŸºæœ¬è¿ç®—ã€ä½è¿ç®—","text":"vs2022æ±‡ç¼–ç¯å¢ƒã€x86æ±‡ç¼–æ¡†æ¶ã€æ•°æ®ç±»å‹ã€åŸºæœ¬è¿ç®—ã€ä½è¿ç®— åœ¨vs2022ä¸­ç¼–å†™æ±‡ç¼–ä»£ç  æ–°å»ºä¸€ä¸ªç©ºé¡¹ç›® åœ¨å·¥å…·æ çš„â€œå·¥å…·â€é€‰é¡¹ä¸­é€‰æ‹©â€œè·å–å·¥å…·å’ŒåŠŸèƒ½â€ï¼Œåœ¨â€œä½¿ç”¨C++çš„æ¡Œé¢å¼€å‘â€ä¸­å‹¾é€‰â€œWindows 10 SDKâ€ä»¥åŠâ€œMSVC v142 -VS 2015 C++ç”Ÿæˆå·¥å…·â€ï¼Œç„¶åå®‰è£…è¿™äº›æ–°å‹¾é€‰çš„é€‰é¡¹ï¼Œæ›´æ–°VS2022 å³é”®æ–°å»ºçš„ç©ºé¡¹ç›®ï¼Œé€‰æ‹©æœ€ä¸‹æ–¹çš„â€œå±æ€§â€ï¼Œåœ¨å¼¹å‡ºæ¥çš„é¡µé¢ä¸­é€‰æ‹©â€œå¸¸è§„â€ï¼Œç„¶åå°†å¹³å°ç‰ˆæœ¬æ”¹æˆwindows10ï¼Œå¯èƒ½éœ€è¦æ”¹ä¹Ÿå¯èƒ½ä¸éœ€è¦ å³é”®æ–°å»ºçš„ç©ºé¡¹ç›®ï¼Œé€‰æ‹©â€œç”Ÿæˆä¾èµ–æ€§â€ï¼Œç„¶åæ˜¯â€œç”Ÿæˆè‡ªå®šä¹‰â€ï¼Œåœ¨ç•Œé¢ä¸­é€‰æ‹©masm ç„¶åå°±å¯ä»¥æ–°å»ºä¸€ä¸ª.asmæºæ–‡ä»¶äº†ã€‚æ–°å»ºå®Œæˆåï¼Œå³é”®æºæ–‡ä»¶é€‰æ‹©â€œå±æ€§â€ï¼Œç„¶ååœ¨â€œå¸¸è§„â€é‡Œæ£€æŸ¥é¡¹ç±»å‹æ˜¯å¦ä¸ºâ€œMicrosoft Macro Assemblerâ€ ä»¥ä¸Šæ˜¯é’ˆå¯¹æŠ¥é”™è¿›è¡Œçš„å°è¯•ä¿®æ­£æ€»ç»“ï¼Œå¯èƒ½æœ‰å¤šä½™æˆ–è€…ä¸è¶³ä¹‹å¤„ x86æ±‡ç¼–æ¡†æ¶(MASM) xxxxxxxxxx2 1int num[2][2] = { {1,2},{3,4} };2printf(â€œ%d,%d,%d,%dâ€, num[0][0], num[0][1], num[1][0], num[1][1]);c 123456789101112131415161718192021222324252627;é¢„å¤„ç†.586.model flat,stdcall;åŒ…å«çš„é“¾æ¥åº“includelib ucrt.libincludelib legacy_stdio_definitions.libincludelib kernel32.libincludelib user32.lib;å¤–éƒ¨å‡½æ•°å£°æ˜extern printf:proc;æ•°æ®æ®µ.dataszHello db 'HelloWorld!',0;ä»£ç æ®µ.code;å‡½æ•°å£°æ˜main proc lea eax,szHello push eax call printf add esp,4main endpend é‡ç‚¹å¦‚ä¸‹ï¼š é“¾æ¥åº“å£°æ˜ 1includelib NameOfLib.lib ä¸åŒçš„æ®µ 12.NameOfSection;æ®µæ‰€åŒ…å«çš„æ•°æ® å‡½æ•°æ ¼å¼ 123functionName proc å‚æ•°å1:å‚æ•°ç±»å‹ï¼Œå‚æ•°å2:å‚æ•°ç±»å‹... ;æ±‡ç¼–ä»£ç functionName endp åœ¨ä¸€ä¸ªasmæ–‡ä»¶æœ«å°¾ï¼Œéœ€è¦ 12end ;ç”¨äºæ— å…¥å£ç‚¹ï¼Œå³éå¯æ‰§è¡Œæ–‡ä»¶ï¼Œä¸éœ€è¦ä¸»å‡½æ•°æ—¶end main ;ç”¨äºå¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¿…é¡»æŒ‡å®šå…¥å£ç‚¹(å¦‚mainå‡½æ•°)æ—¶ æ•°æ®ç±»å‹ ç±»å‹åç§° ç®€å†™ å¯¹åº”ç±»å‹ å ç”¨å­—èŠ‚æ•° BYTE db char 1 WORD dw short 2 DWORD dd int 4 QWORD dq long long 8 åŸºæœ¬è¿ç®— æ•°æ®ä¼ é€æŒ‡ä»¤ 1234mov dest,src ;dest=src;eax=1ç¤ºä¾‹mov eax,1 åœ°å€ä¼ é€æŒ‡ä»¤ 1234lea dest,[addr] ;dest=addr;eax=77E75F38ç¤ºä¾‹lea eax,77E75F38 åŠ æ³• 12345add dest,src ;dest=dest+src;1+1=2ç¤ºä¾‹ï¼Œæœ€åeaxé‡Œä¸º2mov eax,1add eax,1 è‡ªå¢ 1234inc dest ;dest=dest+1;eax++ç¤ºä¾‹inc eax å‡æ³• 12345sub dest,src ;dest=dest-src;6-2=4ç¤ºä¾‹ï¼Œæœ€åeaxé‡Œä¸º4mov eax,6sub eax,2 è‡ªå‡ 1234dec dest ;dest=dest-1;eax--ç¤ºä¾‹dec eax ä¹˜æ³• 1234567891011;åˆ†ä¸ºmul(æ— ç¬¦å·)å’Œimul(æœ‰ç¬¦å·);ä¹˜æ³•ç»“æœå­˜æ”¾åœ¨edxå’Œeaxä¸­(edx:eax)ï¼Œä½ä½eaxï¼Œé«˜ä½edxã€‚æœªæŒ‡å®šæ—¶ï¼Œeaxé»˜è®¤ä½œä¸ºä¸€ä¸ªå› æ•°mul src ;edx:eax=eax*srcimul src ;edx:eax=eax*srcimul dest,src ;dest=dest*srcimul dest,src,imm ;dest=src*imm;4*2=8ç¤ºä¾‹ï¼Œeax*ebxmov eax,4mov ebx,2mul ebx é™¤æ³• 12345678910;åˆ†ä¸ºdiv(æ— ç¬¦å·)å’Œidiv(æœ‰ç¬¦å·);è¢«é™¤æ•°æ”¾åœ¨edx:eaxä¸­ï¼Œé™¤æ•°ä»»æ„ï¼Œå•†å­˜æ”¾åœ¨eaxä¸­ï¼Œä½™æ•°å­˜æ”¾åœ¨edxä¸­div src ;edx:eax%src=eax...edxidiv src ;edx:eax%src=eax...edx;101%2...1ç¤ºä¾‹mov eax,101mov edx,0mov ebx,2div ebx ä½è¿ç®— ä¸ 123456and dest,src ;dest=dest &amp; src;1&amp;2=0ç¤ºä¾‹mov eax,1mov ebx,2and eax,ebx æˆ– 123456or dest,src ;dest=dest | src;1|2=3ç¤ºä¾‹mov eax,1mov ebx,2or eax,ebx å–å 12345not dest ;dest=~dest;not 00000001=11111110ç¤ºä¾‹mov eax,1not eax å¼‚æˆ– 123456xor dest,src ;dest=dest^src;1^2=3ç¤ºä¾‹mov eax,1mov ebx,2xor eax,ebx å·¦ç§»ï¼Œå³ç§» 123456789101112131415;å·¦ç§»shl dest,count ;dest=dest&lt;&lt;count;1&lt;&lt;3=8ç¤ºä¾‹mov eax,1mov cl,3shl eax,cl;å³ç§»shr dest,count ;dest=dest&gt;&gt;count;8&gt;&gt;3=1ç¤ºä¾‹mov eax,8mov cl,3shr eax,cl","link":"/2025/07/05/Day1-x86%E6%B1%87%E7%BC%96%E6%A1%86%E6%9E%B6/"},{"title":"Day11:èŠ±æŒ‡ä»¤","text":"èŠ±æŒ‡ä»¤ èŠ±æŒ‡ä»¤ åˆå«åƒåœ¾æŒ‡ä»¤ï¼Œä¸å½±å“ç¨‹åºåŸå§‹é€»è¾‘ï¼Œä½†ä¼šå¹²æ‰°IDAåç¼–è¯‘æˆ–è€…åæ±‡ç¼–ã€‚ åŸç†ï¼š å› ä¸ºåç¼–è¯‘å™¨å¤šæ˜¯é™æ€åˆ†æçš„ï¼Œä¸ä¼šé€šè¿‡æ‰§è¡Œæ¥åˆ†æé€»è¾‘ï¼Œåªä¼šæ ¹æ®åæ±‡ç¼–å‡ºæ¥çš„æŒ‡ä»¤åˆ†æï¼Œå› æ­¤æœ‰ç©ºå¯ä¹˜ï¼šä¾‹å¦‚å¯ä»¥é€šè¿‡å†…è”æ±‡ç¼–ä¸å®Œæ•´æŒ‡ä»¤ä½†æ˜¯è·³è¿‡ä¸å®Œæ•´æŒ‡ä»¤æ¥æ¨¡ç³ŠæŒ‡ä»¤è¾¹ç•Œã€å†…è”æ±‡ç¼–æ°¸è·³æ°¸ä¸è·³åˆ†æ”¯æ¥è¯¯å¯¼è¿è¡Œé€»è¾‘åˆ†æã€å†…è”æ±‡ç¼–æ— æ„ä¹‰æŒ‡ä»¤è¯¯å¯¼ä¸»è¦é€»è¾‘ æ˜¾è‘—ç‰¹å¾æ˜¯å‡ºç°çº¢è‰²è¡Œï¼Œè€Œåº”å¯¹æ–¹æ³•æ˜¯é€‰ä¸­èŠ±æŒ‡ä»¤æ‰€åœ¨çš„åŒºåŸŸæ”¹ä¸ºâ€œnopâ€ï¼ˆç©ºæŒ‡ä»¤ï¼‰ æ’è·³å‹ å³é€šè¿‡é¢„è®¾ZFä½ä¸º1ï¼Œä½¿jzæ’æ‰§è¡Œã€‚å®æµ‹IDA9.0.241217ä¸ä¼šæŠ¥çº¢ï¼Œä¹Ÿå°±æ˜¯æ··æ·†å¤±æ•ˆï¼Œæ‰€ä»¥å°±çœ‹çœ‹æºç å§ 12345678910111213#include&lt;stdio.h&gt;#include&lt;windows.h&gt;int main() { _asm{ xor eax, eax; jz s; add esp, 0x11; s: }; printf(&quot;hello\\n&quot;); system(&quot;pause&quot;); return 0;} call-retç›¸æ¶ˆå‹ æ¥çœ‹æ•ˆæœ å¯ä»¥çœ‹åˆ°ï¼Œåœ¨å‡½æ•°ä¸­é—´å‡ºç°äº†sp-analysis failedï¼Œè€Œä¸Šé¢ä¸€æ¡å°±æ˜¯retnï¼Œæ˜æ˜¾ä¸å¯¹ã€‚ å¾€å‰çœ‹ï¼Œrep stosdåˆå§‹åŒ–åï¼Œcalläº†$+5ï¼Œå³å½“å‰ä½ç½®+5=0046308Cï¼Œä¹Ÿå°±æ˜¯ä¸‹ä¸€æ¡çš„add ç„¶åç»™espçš„å€¼+7ï¼ˆcallçš„æ—¶å€™push eipå³push 0046308cäº†ï¼‰ æ­¤æ—¶espå­˜æ”¾å€¼ä¸º0046308c+7=00463093ï¼Œæ‰€ä»¥retnæ—¶ä¼špop 00463093ï¼Œç¨‹åºè·³åˆ°00463093 å¾€ä¸‹çœ‹ï¼Œ00463093æ­£æ˜¯æ²¡è¯†åˆ«å‡ºæ¥çš„ä¸‰ä¸ªæ•°çš„æœ€åä¸€ä¸ªï¼Œä¸‹é¢è¿˜æœ‰ä¸€ä¸ªoffsetæ²¡æœ‰æŒ‡ä»¤ã€‚ ç¬¬ä¸‰ä¸ªæ•°68hå’Œoffsetç»“åˆåˆšå¥½æ˜¯push offsetï¼Œå¯¹åº”ä¸Šäº†ä¸‹é¢çš„callï¼ˆå‡½æ•°ä¼ å‚ï¼‰ é€‰ä¸­æ²¡è¯†åˆ«çš„ä¸‰ä¸ªæ•°ï¼ŒæŒ‰â€œUâ€ï¼ˆundefine)ï¼Œå¯ä»¥çœ‹åˆ°ä¸‰ä¸ªæ•°åˆ†å¼€äº† é€‰ä¸­db 68hå’Œdd offset aHelloï¼ŒæŒ‰Cè½¬åŒ–ä¸ºæ±‡ç¼–æŒ‡ä»¤ï¼Œå¯ä»¥çœ‹åˆ°push offsetæ¢å¤äº† é€‰ä¸­call $+5åˆ°db 34hï¼Œå³é”®é€‰æ‹©â€Fill with NOPsâ€œï¼ˆå®æµ‹db 34hä¼šnopä¸å¹²å‡€ï¼Œè¦é€‰ä¸­åˆ°db 34hä¸‹ä¸€è¡Œï¼‰ å¯ä»¥çœ‹åˆ°å‡½æ•°å˜æˆè¿™æ ·ï¼Œè¿™æ˜¯å› ä¸ºæ’å…¥äº†retnå¯¼è‡´å‡½æ•°èŒƒå›´åˆ†æé”™è¯¯ï¼Œéœ€è¦çº æ­£ ç‚¹å‡»å‡½æ•°åï¼Œç„¶åå³é”®edit fuctionï¼ŒæŠŠend addressæ”¹æˆæœ«å°¾é‚£ä¸ªçœŸæ­£çš„retnçš„åœ°å€å°±OKäº† jz-æ“ä½œæ•°ä¸å…¨å‹ è¿™ç§æƒ…å†µä¸‹ä¼šå‡ºç°å’Œä¸Šä¸€ç§ä¸€æ ·çš„æŒ‡ä»¤è¯†åˆ«é”™è¯¯çš„é—®é¢˜ï¼Œä¸”çœ‹å›¾ï¼š è¿™æ˜¯æŒ‰ç…§MSVS C++åˆå§‹åŒ–è§„åˆ™è·³è½¬åï¼Œåœ¨æœ¬æ¥mainå‡½æ•°çš„åœ°æ–¹çš„æˆªå›¾ã€‚ä½†æ˜¯è·³è½¬è¿‡ç¨‹ä¸­ä¼šå‘ç°ï¼Œè·³è½¬åˆ°mainå‡½æ•°çš„ä»£ç æ˜¯jmp loc_xxxxxxè€Œä¸æ˜¯jmp sub_xxxxxxã€‚ä½†æ˜¯ç›®å‰è¿˜ä¸å½±å“ï¼Œå…ˆåˆ†ææŠ¥é”™çš„åœ°æ–¹ã€‚ å¯ä»¥çœ‹åˆ° xor ebp,[eax+50h] å¤„æŠ¥çº¢äº†ï¼Œå¹¶ä¸”ä¸‹é¢æ˜¯ä¸€æ®µæ²¡åˆ†æå‡ºæ¥çš„æ•°å’Œå­—ç¬¦ä¸²â€pauseâ€ï¼Œä¸‹é¢è¿›è¡Œåˆ†æ é¦–å…ˆï¼Œrep stosdåˆå§‹åŒ–åï¼Œè¿›è¡Œäº†ä¸€ä¸ªæ’è·³ï¼Œè·³è½¬çš„åœ°æ–¹æ˜¯0046308Eï¼Œåœ¨ xor ebp,[eax+50h] è¿™æ¡æŒ‡ä»¤é‡Œï¼Œæ‰€ä»¥è¿™é‡Œçº¢äº† æŠŠ xor ebp,[eax+50h] è¿™æ¡æŒ‡ä»¤undefineä¸€ä¸‹ æ ¹æ®é€»è¾‘ï¼Œç¨‹åºæ˜¯è‚¯å®šä¼šè·³åˆ°0046308Eçš„ï¼Œæ‰€ä»¥å‰é¢çš„ä»£ç å†—ä½™ï¼Œç›´æ¥nopæ‰ã€‚é€‰ä¸­ xor eax,eax åˆ°0046308Eï¼ˆæ ¹æ®ä¸Šä¸€ç§ç±»å‹çš„ç»éªŒï¼Œè¦å¤šè¦†ç›–ä¸€ä½æ‰èƒ½åˆšå¥½nopæ‰ç›®æ ‡ä»£ç ï¼‰ nopå®Œæˆåï¼ˆå¦‚æœæœ‰db 90hå°±æŒ‰â€Câ€œè½¬æˆcodeï¼‰å°±ä¼šå‘ç°ä¸‹é¢æ²¡åˆ†æçš„æ•°ç«‹åˆ»åˆ†æå‡ºæŒ‡ä»¤äº† ä½†æ˜¯è¿˜æ²¡å®Œï¼Œæ­¤æ—¶æŒ‰F5æ˜¯æ— æ³•åç¼–è¯‘çš„ï¼Œå› ä¸ºæŠ¥é”™çš„åœ°æ–¹æ˜¯loc_xxxxxxèŒƒå›´é‡Œçš„ï¼Œä¸æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯å‰é¢è¯´çš„jmp loc_xxxxxxè€Œä¸æ˜¯jmp sub_xxxxxxçš„é—®é¢˜äº†ã€‚è¿™é‡Œå¯ä»¥çœ‹å‡ºï¼ŒIDAè¿™ç±»æ··æ·†ä¼šå¯¼è‡´IDAæŠŠå‡½æ•°è¯†åˆ«æˆä¸€ä¸ªå¼•ç”¨è€Œä¸æ˜¯å‡½æ•°ã€‚ åˆ°æœ€å¼€å§‹push ebpå¼€è¾Ÿæ ˆå¸§çš„å¼•ç”¨loc_463070å¤„ï¼ŒæŠŠå®ƒundefineä¸€ä¸‹ï¼Œå†æŒ‰â€œPâ€é‡æ–°åˆ†æä¸€ä¸‹ï¼Œå°±å¯ä»¥å¾—åˆ°mainå‡½æ•°äº† è¿™ç±»æœ‰ä¸€ä¸ªç‰¹å¾å°±æ˜¯jz loc_xxxxxx+1ï¼Œæ®æ­¤å¯ä»¥å¿«é€Ÿæ‰¾åˆ°åŠ äº†æ··æ·†çš„åœ°æ–¹ æ€»ç»“ ä¸Šè¿°ä¸‰ç§ï¼ˆå®é™…ä¸Šæœ‰æ··æ·†æ•ˆæœçš„åªæœ‰ä¸¤ç§ï¼‰æ˜¯æ¯”è¾ƒåŸºç¡€çš„èŠ±æŒ‡ä»¤ã€‚è¯†åˆ«èŠ±æŒ‡ä»¤çš„è¦ç‚¹ä¸»è¦æ˜¯çœ‹çº¢è‰²é”™è¯¯ï¼Œä¹Ÿå¯ä»¥ç»“åˆä¸€äº›ç‰¹å¾æ¥è¯†åˆ«ã€‚è§£å†³æ–¹æ³•å°±æ˜¯nopæ‰æ··æ·†ä»£ç ã€‚ åœ¨å®é™…è®¾è®¡é¢˜ç›®æ—¶ï¼Œç¬”è€…æ„å¤–å‘ç°äº†ä¸€äº›æ›´å¼ºåŠ›çš„æ··æ·†ï¼Œå•å•æ˜¯åœ¨ä¸Šè¿°ä¸‰ç§ç±»å‹çš„åŸºç¡€ä¸ŠåŠ ä¸€ç‚¹å…¶ä»–æŒ‡ä»¤ï¼Œå°±ä¼šå¯¼è‡´ä¸€ä¸ªå‡½æ•°å®Œå…¨æ— æ³•è¢«è¯†åˆ«ï¼ˆè¢«æ”¾åœ¨rdataæ®µè€Œä¸æ˜¯textæ®µçš„é‚£ç§ï¼‰ï¼Œä½†æ˜¯ç¨‹åºè¿˜èƒ½æ­£å¸¸æ‰§è¡Œï¼Œè€ŒæŠ¥é”™çš„åœ°æ–¹åœ¨æ— æ³•è¯†åˆ«çš„å‡½æ•°çš„ä¸Šçº§å‡½æ•°é‡Œï¼ˆè·³è½¬åˆ°è¿™ä¸ªå‡½æ•°çš„é‚£ä¸ªå‡½æ•°ï¼‰ï¼Œå¯èƒ½è¦ç»“åˆAIæ‰èƒ½å®ç°å¿«æ·çš„åˆ†æã€‚å› æ­¤ï¼ŒèŠ±æŒ‡ä»¤è¿˜æ˜¯ä¸€ä¸ªå…·æœ‰æŒ‘æˆ˜æ€§çš„æ··æ·†æ–¹å¼ï¼ˆå½“ç„¶ä¹Ÿå¯èƒ½æ˜¯ç¬”è€…å¤ªèœäº†æ²¡çŸ³ç²’ï¼‰","link":"/2025/07/31/Day11-%E8%8A%B1%E6%8C%87%E4%BB%A4/"},{"title":"Day10:å£³ä¸è„±å£³ï¼ˆäºŒï¼‰","text":"äºŒæ¬¡æ–­ç‚¹æ³•ã€ä¸€æ¬¡æ–­ç‚¹æ³•ã€ç‰¹å¾æŸ¥æ‰¾æ³•ï¼ˆå‡åŸºäºXdbgï¼‰ã€Dllæ‰‹åŠ¨è„±å£³ å¯»æ‰¾OEPçš„æ–¹æ³•ï¼ˆäºŒï¼‰äºŒæ¬¡æ–­ç‚¹æ³• åˆå«å†…å­˜é•œåƒæ³•ï¼ŒåŸç†æ˜¯å£³ç¨‹åºè§£ææ—¶ä¼šä».rsrcæ®µè·å–èµ„æºï¼Œè§£æåå›åˆ°ä»£ç æ®µï¼Œå› æ­¤å¯ä»¥é€šè¿‡ç°åœ¨.rsrcæ®µè®¾ç½®å†…å­˜è¯»å–æ–­ç‚¹ï¼Œç„¶ååœ¨ä»£ç æ®µ(.text/.code)è®¾ç½®å†…å­˜å†™å…¥æ–­ç‚¹æ¥ç›‘æ§å£³ç¨‹åºæ‰§è¡Œã€‚ é€šå¸¸è¿™ä¸ªæ–¹æ³•æ˜¯åŸºäºOllyDbgçš„ï¼Œä½†æ˜¯ä»åŸç†å‡ºå‘Xdbgä¹Ÿä¸æ˜¯ä¸èƒ½ç”¨ã€‚é™¤äº†æœ‰ä¸€æ­¥æ˜¯åœ¨OllyDbgä¸­è®¾ç½®å¿½ç•¥æ‰€æœ‰å¼‚å¸¸ï¼ŒXdbgå¥½åƒæ²¡æœ‰è¿™ä¸ªè®¾ç½®é€‰é¡¹ï¼Œä½†æ˜¯ç»è¿‡å®æµ‹æ˜¯å¯ä»¥ç”¨è¿™ä¸ªæ–¹æ³•åœ¨Xdbgè„±upxå£³çš„ã€‚ Upxè„±å£³ç¤ºä¾‹ï¼š Xdbgè½½å…¥ç¨‹åºï¼Œå…ˆåœ¨â€œæ–­ç‚¹â€æ¨¡å—æŠŠé¢„è®¾çš„æ–­ç‚¹åˆ é™¤ï¼Œé¿å…ç¨‹åºåœ¨éå…³æ³¨çš„å¼‚å¸¸å¤„ï¼ˆæ–­ç‚¹å¤„ï¼‰åœä¸‹ ç„¶ååˆ°â€œå†…å­˜æ˜ å°„â€æ¨¡å—æ‰¾åˆ°ç¨‹åºçš„.rsrcï¼ˆæ³¨æ„æ‰€å±æ–¹ä¸ºç”¨æˆ·ï¼‰ï¼Œä¸‹ä¸€æ¬¡æ€§å†…å­˜è¯»å–æ–­ç‚¹ shift+F9è¿è¡Œï¼Œç„¶ååœ¨ä¸Šæ–¹çš„upx0å¤„ä¸‹ä¸€æ¬¡æ€§å†…å­˜å†™å…¥æ–­ç‚¹ shift+F9è¿è¡Œï¼Œå›åˆ°â€œCPUâ€æ¨¡å—ï¼Œä¼šå‘ç°ä¸‹æ–¹ä¸è¿œå¤„å°±æœ‰ä¸€ä¸ªå¤§è·³ï¼ˆéš”å¾—æœ‰ç‚¹è¿œæˆªä¸åˆ°eipå’Œå¤§è·³çš„åŒæ¡†å›¾ï¼‰ï¼Œåœ¨å¤§è·³å‰ä¸‹æ–­ç‚¹ï¼ŒF9è¿è¡Œåˆ°æ–­ç‚¹å¤„ï¼Œç„¶åæ­¥è¿›å°±å¯ä»¥åˆ°è¾¾OEPäº† ä½†æ˜¯æœ‰ä¸€ç‚¹å¥‡æ€ªçš„åœ°æ–¹ï¼šç»“åˆupxçš„è§£æåŸç†ï¼Œupxå¥½åƒæ˜¯ä»upx1æ®µåŠ è½½æ•°æ®è§£æåˆ°upx0æ®µçš„ï¼ˆAIè¯´çš„ï¼Œä¸ç¡®å®šå¯¹ä¸å¯¹ï¼‰ï¼Œæ‰€ä»¥æŒ‰é“ç†ï¼Œåœ¨upx1å¤„ä¸‹å†…å­˜è¯»å–æ–­ç‚¹ä¸æ˜¯ä¹Ÿæœ‰ç±»ä¼¼çš„ç›‘æ§æ•ˆæœå—ï¼Ÿä½†æ˜¯å®æµ‹è¿™æ ·å­ä¼šè·‘é£ğŸ¤”æœ‰è¿‡ä¸€ä¸ªæƒ³æ³•å°±æ˜¯ï¼Œå› ä¸ºåœ¨upx1æ®µä¸‹äº†è¯»å–æ–­ç‚¹ï¼Œå£³ç¨‹åºè§£æå‰ä¸­æ–­äº†ï¼Œç„¶ååˆåœ¨upx0æ®µä¸‹å†™å…¥æ–­ç‚¹ï¼Œç„¶åæŒ‰é“ç†åº”è¯¥åœåœ¨è§£æç„¶åå†™å…¥è¿™ä¸€æ­¥ï¼Œå°±æ˜¯è§£æäº†è¿˜æ²¡å†™å…¥ï¼Œæˆ–è€…è¯´åˆšåˆšå†™å…¥ä¸€æ¬¡ï¼Œé‚£è¿™æ ·ä¹Ÿä¸è‡³äºç›´æ¥è°ƒè¯•ç»ˆæ­¢å§ğŸ¤” ä¸€æ¬¡æ–­ç‚¹æ³•ï¼ˆäºŒæ¬¡æ–­ç‚¹æ³•plus) è¿™ä¸ªæ–¹æ³•æ˜¯åŸºäºäºŒæ¬¡æ–­ç‚¹æ³•å’Œupxå®æµ‹å‡ºæ¥çš„ï¼Œå› ä¸ºæ ¹æ®å£³ç¨‹åºè§£æçš„åŸç†ï¼Œæœ€ç»ˆéƒ½ä¼šå‘ç”Ÿå‘å†…å­˜å†™å…¥è§£æå®Œçš„æ•°æ®çš„æ“ä½œï¼Œæ‰€ä»¥ç›´æ¥åœ¨å†™å…¥çš„åœ°æ–¹ä¸‹å†…å­˜å†™å…¥æ–­ç‚¹ï¼Œè¿™æ ·è°ƒè¯•å™¨ä¸­æ–­çš„åœ°æ–¹å°±ç¦»OEPä¸è¿œäº†ï¼ˆæ¥è¿‘å£³ç¨‹åºè§£æçš„å°¾å£°ï¼Œä½†è¿˜æ˜¯è¿œåˆ°æˆªä¸åˆ°eipå’Œå¤§è·³çš„åŒæ¡†å›¾ï¼‰ ç¤ºä¾‹ é¦–å…ˆï¼ŒåŒæ ·è¦å…ˆå»æ‰é¢„è®¾æ–­ç‚¹ ç„¶ååœ¨â€œå†…å­˜æ˜ å°„â€æ¨¡å—ç»™upx0ä¸‹ä¸€æ¬¡æ€§å†…å­˜å†™å…¥æ–­ç‚¹/ç»™upx1ä¸‹ä¸€æ¬¡æ€§å†…å­˜è¯»å–æ–­ç‚¹ shift+F9è¿è¡Œï¼Œä¸­æ–­çš„åœ°æ–¹å°±å·®ä¸å¤šæ˜¯å£³ç¨‹åºè§£æå†™å…¥/å¼€å§‹è§£æçš„åœ°æ–¹äº†ï¼Œåœ¨ä¸‹æ–¹å¤§è·³å‰F2æ–­ç‚¹+F9è¿è¡Œä¸€æ­¥åˆ°ä½ï¼Œç„¶åå°±å¯ä»¥è·³è½¬åˆ°OEPäº† ç‰¹å¾æŸ¥æ‰¾æ³• å€ŸåŠ©ç‰¹å¾æŒ‡ä»¤popadï¼Œåœ¨ç¨‹åºåŒºåŸŸæœç´¢æŒ‡ä»¤ï¼Œç„¶åä¸‹æ–­ç‚¹è¿è¡Œè‡³æ­¤ï¼Œå†æ¥ç€è¿è¡Œåˆ°OEPå¤„ ç¤ºä¾‹ï¼š F9è¿è¡Œåˆ°ç¨‹åºåŒºåŸŸï¼Œæ­¤æ—¶æ–­åœ¨pushad å³é”®åœ¨å½“å‰åŒºåŸŸæœç´¢å‘½ä»¤popad åŒå‡»æœç´¢ç»“æœè·³è½¬ï¼Œä¸‹æ–¹ä¸è¿œå¤„å°±æ˜¯åˆ°OEPçš„å¤§è·³äº†ã€‚ç›´æ¥åœ¨jmpå‰ä¸€æ¡æŒ‡ä»¤ä¸‹æ–­ç‚¹ï¼ŒF9åˆ°æ­¤ï¼Œç„¶åæ­¥è¿› Dllæ‰‹åŠ¨è„±å£³ è‹¥å‡ºç°Dllç¨‹åºåŠ å£³çš„æƒ…å†µï¼Œå¯ä»¥å…ˆæŠŠDllç¨‹åºè½¬åŒ–æˆexeç¨‹åºï¼Œç„¶åä½¿ç”¨å’Œexeæ‰‹åŠ¨è„±å£³ä¸€æ ·çš„æ­¥éª¤å³å¯ ç¤ºä¾‹ï¼š ç”¨DIEæ‰“å¼€Dllç¨‹åºï¼Œå¯ä»¥çœ‹åˆ°æ˜¾ç¤ºåŠ äº†upxå£³ ç‚¹å‡»â€œåŒºå—â€ä¸‹æ–¹çš„â€œ&gt;â€ï¼Œæ‰“å¼€æ–‡ä»¶ç»“æ„ç•Œé¢ å–æ¶ˆå‹¾é€‰å³ä¸Šè§’â€åªè¯»â€œï¼Œç„¶åç‚¹å‡»IMAGE_FILE_HEADERï¼Œå–æ¶ˆå‹¾é€‰â€æ ‡å¿—â€œä¸­çš„â€Dllâ€œï¼ˆå›¾ä¸­æœªå–æ¶ˆï¼‰ æ­¤æ—¶å¯ä»¥å‘ç°ï¼ŒCharacteristicsçš„å€¼å˜äº† ç„¶åæŠŠdllåç¼€æ”¹æˆexeå°±å¯ä»¥æŒ‰ç…§exeæ‰‹åŠ¨è„±å£³çš„æ­¥éª¤è¿›è¡Œè„±å£³äº†","link":"/2025/07/30/Day10-%E5%A3%B3%E4%B8%8E%E8%84%B1%E5%A3%B3%EF%BC%88%E4%BA%8C%EF%BC%89/"},{"title":"Day12:åè°ƒè¯•ï¼ˆä¸€ï¼‰","text":"åè°ƒè¯•åŸºæœ¬åŸç†ã€WINAPIæ£€æµ‹ã€æ•°æ®æ£€æµ‹ã€è¿›ç¨‹æ£€æµ‹ åè°ƒè¯•åŸºæœ¬åŸç† åè°ƒè¯•æŠ€æœ¯é€šå¸¸å€ŸåŠ©æ“ä½œç³»ç»Ÿç›¸å…³çš„å†…å®¹æ¥å®ç°ï¼Œå¸¸è§åŠæ³•æœ‰è°ƒç”¨WindowsAPIè·å¾—ç›¸å…³æ•°æ®ã€æœ‰æ„è§¦å‘å¼‚å¸¸ç›‘æµ‹å¼‚å¸¸å¤„ç†ï¼ˆè°ƒè¯•å™¨ä¼šæ•è·å¼‚å¸¸ï¼‰ã€æ—¶é—´å·®æ£€æµ‹ï¼ˆå®é™…è¿è¡Œè¿‡ç¨‹ååˆ†è¿…é€Ÿï¼‰ã€ç¡¬ä»¶æ–­ç‚¹æ£€æµ‹ã€è¿›ç¨‹æ£€æµ‹ç­‰ WINAPIæ£€æµ‹ ç”±äºæ˜¯ç›´æ¥ä½¿ç”¨WINAPIï¼Œæ‰€ä»¥ä¸€èˆ¬åœ¨IDAæˆ–è€…åŠ¨æ€è°ƒè¯•å™¨é‡Œä¼šæœ‰æ˜æ˜¾çš„å‡½æ•°åå­—æ ·ï¼Œè¯†åˆ«ä¼šæ¯”è¾ƒå®¹æ˜“ æ­¤ç±»ä¸€èˆ¬æ˜¯åˆ©ç”¨å‡½æ•°çš„è¿”å›å€¼æˆ–è€…å‡½æ•°ä¼ é€’å›æ¥çš„å‚æ•°ä½œä¸ºåˆ¤æ–­æ ‡å‡†ï¼Œåº”å¯¹æ–¹æ³•ä¸»è¦æœ‰ä½¿ç”¨ååè°ƒè¯•æ’ä»¶ã€ä¿®æ”¹ç›¸å…³å€¼ã€hookç­‰ IsDebuggerPresent åŸç†ï¼š IsDebuggerPresent() å®é™…ä¸Šæ˜¯é€šè¿‡è®¿é—®PEBï¼ˆProcessEnvironmentBlockï¼Œè¿›ç¨‹ç¯å¢ƒå—ï¼Œä¸€ä¸ªæè¿°è¿›ç¨‹ç›¸å…³æ•°æ®çš„ç»“æ„ä½“ï¼‰ä¸­çš„BeingDebuggedæ ‡å¿—æ¥åˆ¤æ–­æ˜¯å¦è¢«è°ƒè¯•çš„ï¼Œè¢«è°ƒè¯•çš„è¯ï¼Œå‡½æ•°è¿”å›1ã€‚æœ‰å…³BeingDebuggedçš„å†…å®¹ï¼Œè§ä¸‹æ–‡ã€‚ IDAå’ŒXDbgçš„æ•ˆæœå›¾ï¼š å¯ä»¥çœ‹åˆ°æ˜æ˜¾çš„IsDebuggerPresentå­—æ ·ã€‚ åº”å¯¹æ–¹æ³•ï¼š åœ¨XDbgä¸­å¼€å¯scyllahideæ’ä»¶æˆ–è€…åœ¨TEST EAX,EAXåæ”¹å˜ä¸€ä¸‹ZFå°±å¯ä»¥äº† CheckRemoteDebuggerPresent åŸç†ï¼š å‡½æ•°åŸå‹ï¼š 1234BOOL WINAPI CheckRemoteDebuggerPresent( In HANDLE hProcess,//å‚æ•°1ï¼Œä¸€ä¸ªè¿›ç¨‹å¥æŸ„ï¼Œä¼ å…¥å½“å‰è¿›ç¨‹å¥æŸ„å°±æ˜¯checklocaläº† Inout PBOOL pbDebuggerPresent//å‚æ•°2ï¼Œä¸€ä¸ªç”¨æ¥ä¼ é€’çš„å¸ƒå°”å€¼ï¼Œç”¨æ¥è¡¨ç¤ºæ˜¯å¦è¢«è°ƒè¯•); è¿™ä¸ªå‡½æ•°å®é™…ä¸Šæ˜¯å€Ÿç”¨äº†NtQueryInfomationProcesså‡½æ•°æ¥å®ç°è°ƒè¯•æ£€æµ‹çš„ï¼Œç®€å•è®²å°±æ˜¯é€šè¿‡NtQueryInformationProcessæŸ¥è¯¢ä¸€ä¸ªæ•°æ®ç„¶åå’Œéè°ƒè¯•çŠ¶æ€ä¸‹è¿™ä¸ªæ•°æ®é¢„æœŸçš„å€¼è¿›è¡Œæ¯”è¾ƒï¼Œæ¯”è¾ƒç»“æœå†ä¼ ç»™è‡ªå·±çš„å‚æ•°2ã€‚æ›´è¯¦ç»†çš„åŸç†è§ä¸‹ä¸€ä¸ªAPI æ•ˆæœå›¾ï¼š åº”å¯¹æ–¹æ³•ï¼š scyllahideä¾æ—§ç®¡ç”¨ï¼Œä¹Ÿå¯ä»¥åœ¨call CheckRemoteDebuggerPresentä¸‹é¢çš„cmpåæ”¹å˜zfæ¥å®ç°ååè°ƒè¯• NtQueryInformationProcess åŸç†ï¼š å‡½æ•°åŸå‹ï¼š 1234567__kernel_entry NTSTATUS NtQueryInformationProcess( IN HANDLE ProcessHandle,//è¦æŸ¥è¯¢çš„è¿›ç¨‹å¥æŸ„ IN PROCESSINFOCLASS ProcessInformationClass,//è¦æŸ¥è¯¢çš„ä¿¡æ¯ç±»å‹ OUT PVOID ProcessInformation,//æ¥æ”¶æŸ¥è¯¢ç»“æœçš„ç¼“å†²åŒºï¼ˆå˜é‡ï¼‰ IN ULONG ProcessInformationLength,//ç¼“å†²åŒºå¤§å° OUT PULONG ReturnLength OPTIONAL//å®é™…è¿”å›çš„æ•°æ®å¤§å°ï¼Œå¯é€‰); é€šè¿‡è®¾ç½®ç¬¬äºŒä¸ªå‚æ•°ä¸º0x7ï¼ˆè¡¨ç¤ºæŸ¥è¯¢ä¸€ä¸ªå«ProcessDebugPortçš„å˜é‡ï¼‰ï¼Œå‡½æ•°ä¼šé€šè¿‡ç¬¬ä¸‰ä¸ªå‚æ•°ä¼ é€’è°ƒè¯•ä¿¡æ¯ï¼Œè¢«è°ƒè¯•åˆ™ä¼ é€’é0 æˆ–è€…è®¾ç½®ç¬¬äºŒä¸ªå‚æ•°ä¸º0x1Eï¼ˆè¡¨ç¤ºæŸ¥è¯¢ä¸€ä¸ªå«ProcessDebugObjectHandleçš„å˜é‡ï¼‰ï¼Œè¢«è°ƒè¯•åˆ™ä¼ é€’éNULL æˆ–è€…è®¾ç½®ç¬¬äºŒä¸ªå‚æ•°ä¸º0x1Fï¼ˆè¡¨ç¤ºæŸ¥è¯¢ä¸€ä¸ªå«ProcessDebugFlagsçš„å˜é‡ï¼‰ï¼Œè¢«è°ƒè¯•åˆ™ä¼ é€’0 åŸå‹æ˜¯è¿™æ ·ï¼Œä½†æ˜¯è¿™ä¸ªå‡½æ•°æ˜¯Windowså†…éƒ¨APIï¼Œå³ç³»ç»Ÿä¸æƒ³ç”¨æˆ·ä½¿ç”¨è¿™ä¸ªå‡½æ•°ï¼ˆå¯èƒ½æ˜¯å‡ºäºå®‰å…¨è€ƒè™‘ï¼‰ï¼Œæ‰€ä»¥ç›´æ¥è°ƒç”¨æ˜¯ä¸è¡Œçš„ï¼Œè¦åŠ¨æ€åŠ è½½ã€‚ä¸‹é¢æ˜¯DSç»™çš„å®ç°æºç å‚è€ƒï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950#include &lt;windows.h&gt;#include &lt;stdio.h&gt;// 1. å®šä¹‰å‡½æ•°æŒ‡é’ˆç±»å‹ï¼ˆå¿…é¡»æ‰‹åŠ¨å£°æ˜ï¼‰typedef LONG NTSTATUS;typedef NTSTATUS (NTAPI* PNtQueryInformationProcess)( HANDLE ProcessHandle, int ProcessInformationClass, // ç›´æ¥ä½¿ç”¨ int ä»£æ›¿ PROCESSINFOCLASS PVOID ProcessInformation, ULONG ProcessInformationLength, PULONG ReturnLength);int main() { // 2. åŠ¨æ€åŠ è½½ ntdll.dll HMODULE hNtdll = GetModuleHandleW(L&quot;ntdll.dll&quot;); if (!hNtdll) { printf(&quot;hello\\n&quot;); system(&quot;pause&quot;); return 0; } // 3. è·å– NtQueryInformationProcess å‡½æ•°åœ°å€ PNtQueryInformationProcess NtQueryInformationProcess = (PNtQueryInformationProcess)GetProcAddress(hNtdll, &quot;NtQueryInformationProcess&quot;); if (!NtQueryInformationProcess) { printf(&quot;hello\\n&quot;); system(&quot;pause&quot;); return 0; } // 4. è°ƒç”¨å‡½æ•°æŸ¥è¯¢è°ƒè¯•ç«¯å£ï¼ˆ0x7 = ProcessDebugPortï¼‰ DWORD debugPort = 0; NTSTATUS status = NtQueryInformationProcess( GetCurrentProcess(), 0x7, // ProcessDebugPort &amp;debugPort, sizeof(debugPort), NULL ); // 5. ä¸¥æ ¼æŒ‰ç…§ä½ çš„é€»è¾‘è¾“å‡º if (debugPort) printf(&quot;bye\\n&quot;); else printf(&quot;hello\\n&quot;); system(&quot;pause&quot;); return 0;} ä¸‹é¢æ˜¯IDAçš„åæ±‡ç¼–ç»“æœ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105.text:000000014007E130 sub_14007E130 proc near ; CODE XREF: sub_14007920Bâ†‘j.text:000000014007E130 ; DATA XREF: .pdata:00000001401AB818â†“o.text:000000014007E130.text:000000014007E130 var_180 = byte ptr -180h.text:000000014007E130 var_160 = qword ptr -160h.text:000000014007E130 var_150 = byte ptr -150h.text:000000014007E130 hModule = qword ptr -148h.text:000000014007E130 var_128 = qword ptr -128h.text:000000014007E130 var_10C = dword ptr -10Ch.text:000000014007E130 var_EC = dword ptr -0ECh.text:000000014007E130 var_18 = qword ptr -18h.text:000000014007E130.text:000000014007E130 ; __unwind { // j___GSHandlerCheck.text:000000014007E130 push rbp.text:000000014007E132 push rdi.text:000000014007E133 sub rsp, 178h.text:000000014007E13A lea rbp, [rsp+30h].text:000000014007E13F lea rdi, [rsp+180h+var_150].text:000000014007E144 mov ecx, 22h ; '&quot;'.text:000000014007E149 mov eax, 0CCCCCCCCh.text:000000014007E14E rep stosd.text:000000014007E150 mov rax, cs:__security_cookie.text:000000014007E157 xor rax, rbp.text:000000014007E15A mov [rbp+150h+var_18], rax.text:000000014007E161 lea rcx, unk_1401B80A2.text:000000014007E168 call sub_14007A313.text:000000014007E16D nop.text:000000014007E16E lea rcx, ModuleName ; &quot;ntdll.dll&quot;.text:000000014007E175 call cs:GetModuleHandleW ;æ­¤å¤„åŠ è½½ntdllåº“.text:000000014007E17B mov [rbp+150h+hModule], rax.text:000000014007E17F cmp [rbp+150h+hModule], 0.text:000000014007E184 jnz short loc_14007E1A7.text:000000014007E186 lea rcx, aHello ; &quot;hello\\n&quot;.text:000000014007E18D call sub_14007886F.text:000000014007E192 nop.text:000000014007E193 lea rcx, aPause ; &quot;pause&quot;.text:000000014007E19A call sub_140078810.text:000000014007E19F nop.text:000000014007E1A0 xor eax, eax.text:000000014007E1A2 jmp loc_14007E240.text:000000014007E1A7 ; ---------------------------------------------------------------------------.text:000000014007E1A7.text:000000014007E1A7 loc_14007E1A7: ; CODE XREF: sub_14007E130+54â†‘j.text:000000014007E1A7 lea rdx, ProcName ; &quot;NtQueryInformationProcess&quot;.text:000000014007E1AE mov rcx, [rbp+150h+hModule] ; hModule.text:000000014007E1B2 call cs:GetProcAddress ;æ­¤å¤„è·å–NtQueryInformationProcesså‡½æ•°åœ°å€.text:000000014007E1B8 mov [rbp+150h+var_128], rax ;æ­¤å¤„æŠŠå‡½æ•°åœ°å€ä¼ ç»™å±€éƒ¨å˜é‡.text:000000014007E1BC cmp [rbp+150h+var_128], 0.text:000000014007E1C1 jnz short loc_14007E1E1.text:000000014007E1C3 lea rcx, aHello ; &quot;hello\\n&quot;.text:000000014007E1CA call sub_14007886F.text:000000014007E1CF nop.text:000000014007E1D0 lea rcx, aPause ; &quot;pause&quot;.text:000000014007E1D7 call sub_140078810.text:000000014007E1DC nop.text:000000014007E1DD xor eax, eax.text:000000014007E1DF jmp short loc_14007E240.text:000000014007E1E1 ; ---------------------------------------------------------------------------.text:000000014007E1E1.text:000000014007E1E1 loc_14007E1E1: ; CODE XREF: sub_14007E130+91â†‘j.text:000000014007E1E1 mov [rbp+150h+var_10C], 0.text:000000014007E1E8 call cs:GetCurrentProcess .text:000000014007E1EE mov [rsp+180h+var_160], 0.text:000000014007E1F7 mov r9d, 4 ;ç¼“å†²åŒºå¤§å°.text:000000014007E1FD lea r8, [rbp+150h+var_10C] ;æ¥æ”¶ç»“æœçš„ç¼“å†²åŒº.text:000000014007E201 mov edx, 7 ;æŒ‡å®šæŸ¥è¯¢çš„ä¿¡æ¯ç±»å‹.text:000000014007E206 mov rcx, rax ;æŸ¥è¯¢çš„è¿›ç¨‹å¥æŸ„.text:000000014007E209 call [rbp+150h+var_128] ;è°ƒç”¨NtQueryInformationProcess.text:000000014007E20C mov [rbp+150h+var_EC], eax.text:000000014007E20F cmp [rbp+150h+var_10C], 0.text:000000014007E213 jz short loc_14007E224.text:000000014007E215 lea rcx, aBye ; &quot;bye\\n&quot;.text:000000014007E21C call sub_14007886F.text:000000014007E221 nop.text:000000014007E222 jmp short loc_14007E231.text:000000014007E224 ; ---------------------------------------------------------------------------.text:000000014007E224.text:000000014007E224 loc_14007E224: ; CODE XREF: sub_14007E130+E3â†‘j.text:000000014007E224 lea rcx, aHello ; &quot;hello\\n&quot;.text:000000014007E22B call sub_14007886F.text:000000014007E230 nop.text:000000014007E231.text:000000014007E231 loc_14007E231: ; CODE XREF: sub_14007E130+F2â†‘j.text:000000014007E231 lea rcx, aPause ; &quot;pause&quot;.text:000000014007E238 call sub_140078810.text:000000014007E23D nop.text:000000014007E23E xor eax, eax.text:000000014007E240.text:000000014007E240 loc_14007E240: ; CODE XREF: sub_14007E130+72â†‘j.text:000000014007E240 ; sub_14007E130+AFâ†‘j.text:000000014007E240 mov rdi, rax.text:000000014007E243 lea rcx, [rbp+150h+var_180].text:000000014007E247 lea rdx, unk_140171FF0.text:000000014007E24E call sub_140079A35.text:000000014007E253 mov rax, rdi.text:000000014007E256 mov rcx, [rbp+150h+var_18].text:000000014007E25D xor rcx, rbp ; StackCookie.text:000000014007E260 call j___security_check_cookie.text:000000014007E265 lea rsp, [rbp+148h].text:000000014007E26C pop rdi.text:000000014007E26D pop rbp.text:000000014007E26E retn.text:000000014007E26E ; } // starts at 14007E130.text:000000014007E26E sub_14007E130 endp.text:000000014007E26E ç‰¹å¾åº”è¯¥æ˜¯ call cs:GetModuleHandleWã€call cs:GetProcAddressã€ call cs:GetCurrentProcess åº”å¯¹æ–¹æ³•ï¼š scyllahideä¹Ÿæ˜¯æ”¯æŒåNtQueryInformationProcessåè°ƒè¯•çš„ï¼Œæ‰‹åŠ¨ç»•è¿‡ä¸€èˆ¬æ˜¯æ›´æ”¹ç¼“å†²åŒºçš„å€¼ä¸æ ‡å‡†å€¼çš„æ¯”è¾ƒç»“æœï¼Œå½“ç„¶åœ¨DSç»™çš„æºç ä¸­å› ä¸ºåŠ å…¥äº†ä¸€äº›é”™è¯¯å¤„ç†ï¼ˆå¦‚ntdllè½½å…¥å¤±è´¥å°±è·³è¿‡åè°ƒè¯•ï¼‰ï¼Œå¯ä»¥é€šè¿‡äººä¸ºæ”¹åŠ¨é”™è¯¯åˆ¤æ–­çš„ç»“æœæ¥å®ç°ç›´æ¥è·³è¿‡åè°ƒè¯• GetLastError è¿™ä¸ªå‡½æ•°ç”¨äºè·å–æœ€è¿‘ä¸€æ¬¡å¼‚å¸¸çš„è¿”å›å€¼ã€‚ä½¿ç”¨çš„æ–¹æ³•ä¸€èˆ¬æ˜¯æ•…æ„æ„é€ å¼‚å¸¸ï¼Œå¦‚æœå¤„äºè¢«è°ƒè¯•çŠ¶æ€ï¼Œè°ƒè¯•å™¨ä¼šæ•è·å¼‚å¸¸å¯¼è‡´è¿”å›çš„é”™è¯¯ç å’Œé¢„æœŸçš„ä¸ç¬¦ã€‚ æ•ˆæœï¼š åº”å¯¹æ–¹æ³•ï¼š å¯ä»¥çœ‹åˆ°ï¼ŒGetLastErrorä¹‹åï¼Œä¼šæŠŠè¿”å›å€¼å’Œé¢„è®¾çš„å€¼è¿›è¡Œæ¯”è¾ƒï¼Œæ‰€ä»¥ä¿®æ”¹cmpåçš„zfå°±å¯ä»¥äº†ã€‚ç”±äºGetLastErrorçš„è‡ªç”±åº¦æ¯”è¾ƒé«˜ï¼ˆè§¦å‘å¼‚å¸¸çš„æ–¹æ³•å¤šæ ·ï¼‰ï¼Œæ‰€ä»¥scyllahideåº”è¯¥æ˜¯ä¸æ”¯æŒçš„ï¼ˆç¬”è€…æ²¡æœ‰è®¤å‡ºä»€ä¹ˆç›¸å…³çš„è®¾ç½®ï¼‰ æ•°æ®æ£€æµ‹BeingDebugged BeingDebuggedæ˜¯PEBçš„æˆå‘˜å˜é‡ä¹‹ä¸€ï¼Œç”¨äºæè¿°è¿›ç¨‹æ˜¯å¦å¤„äºè¢«è°ƒè¯•çŠ¶æ€ï¼Œä¸º1æ—¶è¡¨ç¤ºå¤„äºè¢«è°ƒè¯•çŠ¶æ€ã€‚ PEBç»“æ„ä½“å…·ä½“å¦‚ä¸‹ï¼š 123456789101112131415161718192021typedef struct _PEB { BYTE Reserved1[2]; BYTE BeingDebugged;//åç§»ä¸º2 BYTE Reserved2[1]; PVOID Reserved3[2]; PPEB_LDR_DATA Ldr; PRTL_USER_PROCESS_PARAMETERS ProcessParameters; PVOID Reserved4[3]; PVOID AtlThunkSListPtr; PVOID Reserved5; ULONG Reserved6; PVOID Reserved7; ULONG Reserved8; ULONG AtlThunkSListPtr32; PVOID Reserved9[45]; BYTE Reserved10[96]; PPS_POST_PROCESS_INIT_ROUTINE PostProcessInitRoutine; BYTE Reserved11[128]; PVOID Reserved12[1]; ULONG SessionId;} PEB, *PPEB; åè°ƒè¯•æ‰‹æ®µé€šå¸¸æ˜¯è®¿é—®è¿›ç¨‹çš„è¯¥å‚æ•°ï¼ˆå¦‚WINAPIçš„IsDebuggerPresent()ï¼‰æ¥åˆ¤æ–­æ˜¯å¦å¤„äºè¢«è°ƒè¯•çŠ¶æ€ã€‚32ä½ä¸‹ï¼ŒPEBç”¨FS:[0x30]è¡¨ç¤ºï¼›64ä½ä¸‹ï¼ŒPEBç”¨FS:[0x60]è¡¨ç¤ºã€‚åŠ ä¸Šåç§»2å°±æ˜¯å¯¹BeingDebuggedçš„è®¿é—®äº†ï¼ˆè¿™å°±æ˜¯è¿™ç§æ–¹æ³•çš„ç‰¹å¾äº†ï¼‰ æ•ˆæœå›¾ï¼š åº”å¯¹æ–¹æ³•ï¼š scyllahideå¯ç»•è¿‡ï¼Œæ‰‹åŠ¨ç»•è¿‡åªéœ€è¦åœ¨è®¿é—®æŒ‡ä»¤ä¸‹æ–¹çš„cmpåä¿®æ”¹ZFå³å¯ NTGlobalFlag NTGlobalFlagä¹Ÿæ˜¯PEBç»“æ„ä½“çš„æˆå‘˜ï¼Œä½†æ˜¯æ˜¯éå…¬å¼€çš„ï¼ˆå› æ­¤ä¸Šæ–‡çš„PEBç»“æ„ä½“å®šä¹‰ä¸­çœ‹ä¸åˆ°ï¼‰ã€‚32ä½ä¸‹ï¼Œå®ƒä½äºPEBåç§»0x68å¤„ï¼Œ64ä½ä¸‹ï¼Œå®ƒä½äºPEBåç§»0xBCå¤„ï¼ˆç‰¹å¾ï¼‰ã€‚å®ƒæœ¬æ˜¯æè¿°è¿›ç¨‹å †ç®¡ç†çš„ï¼Œä½†æ˜¯ç”±äºè°ƒè¯•å™¨ä¸­çš„è¿›ç¨‹åˆ›å»ºå †çš„æ–¹å¼å’Œæ­£å¸¸æƒ…å†µæœ‰æ‰€ä¸åŒï¼Œè¢«è°ƒè¯•æ—¶è¯¥å€¼ä¼šè¢«è®¾ä¸º0x70ï¼ˆåˆä¸€ä¸ªç‰¹å¾ï¼‰ï¼Œå› æ­¤ä¹Ÿè¢«ç”¨æ¥åˆ¤æ–­æ˜¯å¦è¢«è°ƒè¯• æ•ˆæœï¼š åº”å¯¹æ–¹æ³•ï¼š syllahideå¯ä»¥ç»•è¿‡ï¼Œä¹Ÿå¯ä»¥åœ¨ä¸‹é¢çš„æ¯”è¾ƒé€»è¾‘ï¼ˆå› ä¸ºæ˜¯å†…è”æ±‡ç¼–ï¼Œæ‰€ä»¥æ¯”è¾ƒé€»è¾‘çš„å®ç°ä¼šæœ‰ä¸åŒï¼‰åä¿®æ”¹ZFç»•è¿‡ è¿›ç¨‹æ£€æµ‹FindWindow å®é™…ä¸Šæ˜¯çª—å£æ£€æµ‹ï¼Œè¿™ä¸ªå‡½æ•°è·å–çš„æ˜¯è¿›ç¨‹çª—å£çš„ç±»åæˆ–è€…æ ‡ç­¾ï¼Œé€šè¿‡ä¸é¢„æœŸçš„åå­—è¿›è¡Œæ¯”è¾ƒæ¥åˆ¤æ–­æ˜¯å¦å¤„äºè¢«è°ƒè¯•çŠ¶æ€ã€‚ç”±äºä½¿ç”¨çš„æ˜¯ç³»ç»Ÿå‡½æ•°ï¼Œæ‰€ä»¥å®é™…ä¸Šä¹Ÿå±äºWINAPIæ£€æµ‹ï¼Œä½†æ˜¯ä¸é‡è¦ã€‚ç‰¹å¾å’ŒWINAPIæ£€æµ‹ä¸€æ ·ï¼Œä¼šæœ‰æ˜æ˜¾çš„æ ‡è®° æ•ˆæœï¼š æœ¬ä¾‹çš„ç¨‹åºåˆ›å»ºäº†ä¸€ä¸ªåˆ¤æ–­å‡½æ•°ï¼Œåœ¨ä¸»å‡½æ•°ä¸­æ˜¯å°†è¿”å›å€¼teståæ¥åˆ¤æ–­æ˜¯å¦è¢«è°ƒè¯•çš„ï¼Œæ‰€ä»¥åªéœ€è¦ä¿®æ”¹ä¸»å‡½æ•°ä¸­çš„test eax,eaxåçš„ZFå°±å¯ä»¥å®ç°ç»•è¿‡äº†ã€‚scyllahideåº”è¯¥æ˜¯ä¸æ”¯æŒçš„ çˆ¶è¿›ç¨‹æ£€æµ‹ åŸç†æ˜¯æ­£å¸¸ç¨‹åºåŒå‡»è¿è¡Œçˆ¶è¿›ç¨‹ä¸ºexplorer.exeï¼Œè€Œæ‹–è¿›è°ƒè¯•å™¨æ‰“å¼€çˆ¶è¿›ç¨‹ä¸ºè°ƒè¯•å™¨ï¼Œé€šè¿‡æ¯”è¾ƒè·å¾—çš„çˆ¶è¿›ç¨‹åå’Œé¢„è®¾çš„çˆ¶è¿›ç¨‹åå¯ä»¥åˆ¤æ–­æ˜¯å¦å¤„äºè¢«è°ƒè¯•çŠ¶æ€ã€‚ä¸€èˆ¬ä¼šé€šè¿‡éå†è¿›ç¨‹æˆ–è€…é€šè¿‡NtQueryInfomationProcessæŸ¥è¯¢æ¥å®ç°ã€‚ç‰¹å¾æ˜¯å‡ºç°å¤§é‡å’Œè¿›ç¨‹ç›¸å…³çš„apiï¼Œå¦‚éå†è¿›ç¨‹æ—¶ä¼šè°ƒç”¨CreateToolhelp32Snapshotã€th32ParentProcessIDã€Process32Nextç­‰ï¼ŒNtQueryInfomationProcessæŸ¥è¯¢ä¼šå‡ºç°QueryFullProcessImageNameAæˆ–è€…å…¶ä»–ç›¸å…³å‡½æ•°ä¸è°ƒè¯•å™¨åç§°å­—ç¬¦ä¸²åŒæ—¶å‡ºç°çš„æƒ…å†µ æ•ˆæœï¼š å®æµ‹scyllahideç»•è¿‡ä¸äº†ç¬¬ä¸€ç§æ–¹æ³•ä½†å¯ä»¥ç»•è¿‡ç¬¬äºŒç§æ–¹æ³•ã€‚æ‰‹åŠ¨ç»•è¿‡ä¹Ÿå¯ä»¥ï¼Œä¸»è¦åŸºäºåç»­å¯¹è¿›ç¨‹åçš„åˆ¤æ–­ï¼Œä¿®æ”¹åˆ¤æ–­ç»“æœå³å¯ç»•è¿‡ ç‰¹å¾ç æ£€æµ‹ æœ‰çš„è°ƒè¯•å™¨åœ¨å†…å­˜ä¸­ä¼šæœ‰ç‰¹å¾ç ï¼Œé€šè¿‡éå†è¿›ç¨‹å’Œæœç´¢ç‰¹å¾ç å¯ä»¥åˆ¤æ–­æ˜¯å¦è¢«è°ƒè¯•ã€‚è¿™ç§æƒ…å†µä¼šæ¯”è¾ƒå¤æ‚ï¼Œéš¾ç‚¹åº”è¯¥åœ¨è¯†åˆ«ä¸Šã€‚ä¸€æ–¹é¢å¯ä»¥é€šè¿‡åˆ†ææ˜¯å¦å‡ºç°ç‰¹å¾ç ï¼ˆå¯èƒ½ä¼šæ˜¯å¾ˆæ˜æ˜¾çš„ä¸€è¿ä¸²æ•°å­—åˆå§‹åŒ–ï¼‰ï¼Œå¦ä¸€æ–¹é¢éå†è¿›ç¨‹ä¼šå‡ºç°çˆ¶è¿›ç¨‹æ£€æµ‹ä¸­æåŠçš„apiï¼Œä½†æ˜¯è¿™äº›ä¸€èˆ¬ä¸ä¼šå‡ºç°åœ¨ä¸»å‡½æ•°ä¸­ï¼Œéœ€è¦è·Ÿè¿›å‡½æ•°æŸ¥çœ‹ã€‚ ç‰¹å¾ç ç¤ºä¾‹ï¼š scyllahideä¸€èˆ¬ç»•è¿‡ä¸äº†ï¼Œå¯ä»¥åœ¨ä¸»å‡½æ•°æ¶‰åŠåˆ¤æ–­ç»“æœçš„é€»è¾‘ä¸­è¿›è¡Œæ”¹åŠ¨ç»•è¿‡ã€‚","link":"/2025/08/02/Day12-%E5%8F%8D%E8%B0%83%E8%AF%95/"},{"title":"Day13:åè°ƒè¯•ï¼ˆäºŒï¼‰","text":"æ—¶é—´å·®æ£€æµ‹ã€æ–­ç‚¹æ£€æµ‹ æ—¶é—´å·®æ£€æµ‹ CPUçš„è¿è¡Œååˆ†è¿…é€Ÿï¼Œä¸€æ®µä»£ç å¯èƒ½åœ¨å‡ æ¯«ç§’å†…å°±å¯ä»¥æ‰§è¡Œå®Œæ¯•ï¼Œä½†æ˜¯è°ƒè¯•çš„æ—¶å€™ï¼Œä»£ç è¿è¡Œæ—¶é—´ä¼šæ˜¾è‘—åœ°å˜æ…¢ï¼Œè¿™å°±æ˜¯æ—¶é—´å·®æ£€æµ‹çš„åŸç†ã€‚æ—¶é—´å·®æ£€æµ‹ä¸»è¦é€šè¿‡è®¡ç®—æ—¶é—´å·®ç„¶åä¸é¢„è®¾çš„å€¼æ¯”è¾ƒå®ç°ã€‚ RDTSCæŒ‡ä»¤è®¡ç®— rdtscæ˜¯ä¸€ä¸ªæ±‡ç¼–æŒ‡ä»¤ï¼Œç”¨äºå°†æ—¶é—´è¯»å…¥edx:eaxå¯„å­˜å™¨ï¼ˆé«˜32ä½ï¼šä½32ä½ï¼‰ã€‚é€šè¿‡å–ä¸¤æ¬¡æ—¶é—´æŠŠç»“æœç›¸å‡å¯ä»¥å¾—åˆ°ä¸€ä¸ªæ—¶é—´å·®ã€‚æ˜¾è‘—ç‰¹å¾å°±æ˜¯rdtscæŒ‡ä»¤ æ•ˆæœï¼š åº”å¯¹æ–¹æ³•ï¼š æ ¹æ®ç¨‹åºçš„é€»è¾‘ï¼Œå¯ä»¥åœ¨è®¡ç®—å‡ºæ—¶é—´å·®å¹¶æ¯”è¾ƒä¹‹åæ”¹å˜æ¯”è¾ƒç»“æœã€‚ GetTickCountè®¡ç®— åŸç†å’ŒRDTSCç±»ä¼¼ï¼Œåªä¸è¿‡æ—¶é—´å·®é‡‡ç”¨GetTickCountè®¡ç®—ã€‚GetTickCountä¹Ÿæ˜¯WINAPIï¼Œä¼šæœ‰æ˜æ˜¾æ ‡è®°ã€‚ æ•ˆæœï¼š åº”å¯¹æ–¹æ³•ï¼š ä¿®æ”¹æ¯”è¾ƒç»“æœå³å¯ QueryPerformanceCounterè®¡ç®— åŸç†ç±»ä¼¼ï¼Œåªæ˜¯é‡‡ç”¨QueryPerformanceCounterè®¡ç®—ï¼Œä¹Ÿæ˜¯WINAPIï¼Œæ¯”è¾ƒå¥½è¯†åˆ« æ•ˆæœï¼š åº”å¯¹æ–¹æ³•ï¼š ä¿®æ”¹æ¯”è¾ƒç»“æœå³å¯ æ–­ç‚¹æ£€æµ‹ æ–­ç‚¹æ˜¯è°ƒè¯•çš„ä¸€ä¸ªæ˜¾è‘—ç‰¹ç‚¹ã€‚æ–­ç‚¹å¯ä»¥åˆ†ä¸ºè½¯ä»¶æ–­ç‚¹ã€ç¡¬ä»¶æ–­ç‚¹å’Œå†…å­˜æ–­ç‚¹ã€‚è½¯ä»¶æ–­ç‚¹é€šè¿‡å°†ç›®æ ‡ä»£ç ä¿®æ”¹ä¸ºä¸­æ–­æŒ‡ä»¤ï¼ˆX86\\X64ä¸‹ä¸€èˆ¬ä¸ºINT3\\0xCCï¼‰å®ç°ï¼›ç¡¬ä»¶æ–­ç‚¹é€šè¿‡å°†æŒ‡ä»¤åœ°å€å†™å…¥è°ƒè¯•å¯„å­˜å™¨çš„DR0-DR3ç›‘æ§åœ°å€è®¿é—®æ¥å®ç°ï¼›å†…å­˜æ–­ç‚¹é€šè¿‡ä¿®æ”¹å†…å­˜é¡µï¼ˆä¸€ç‰‡ç‰‡å†…å­˜åŒºåŸŸï¼‰çš„è®¿é—®æƒé™å®ç°ã€‚ä¸‰è€…çš„å®ç°æ–¹æ³•éƒ½ä¼šè§¦å‘å¼‚å¸¸è®©è°ƒè¯•å™¨æ•è·è¿›è€Œä¸­æ–­ã€‚åè°ƒè¯•çš„æ–­ç‚¹æ£€æµ‹ä¸»è¦åˆ©ç”¨è½¯ä»¶æ–­ç‚¹å’Œç¡¬ä»¶æ–­ç‚¹ï¼Œå†…å­˜æ–­ç‚¹ç”±äºé’ˆå¯¹å†…å­˜åŒºåŸŸè€Œéå…·ä½“æŒ‡ä»¤ï¼Œç²¾åº¦å¤ªä½ï¼Œä¸€èˆ¬ä¸è€ƒè™‘ã€‚ è½¯ä»¶æ–­ç‚¹æ£€æµ‹ å¸¸è§æ‰‹æ®µæ˜¯åœ¨å†…å­˜åŒºåŸŸæœç´¢0xCCï¼ˆä½¿ç”¨æ±‡ç¼–æŒ‡ä»¤repnz scasbï¼‰ æ•ˆæœï¼š å› ä¸ºè¿›è¡Œäº†æ¯”è¾ƒï¼Œæ‰€ä»¥ä¿®æ”¹æ¯”è¾ƒç»“æœå³å¯ç»•è¿‡ ç¡¬ä»¶æ–­ç‚¹æ£€æµ‹ å¸¸è§æ‰‹æ®µæ˜¯è·å–DRå¯„å­˜å™¨çš„å€¼å¹¶å’Œ0æ¯”è¾ƒã€‚ç‰¹å¾æ˜¯GetThreadContextå‡½æ•°ï¼ˆæˆ–è€…å…¶ä»–ThreadContextç›¸å…³çš„å‡½æ•°ï¼‰å’Œä¸0çš„æ¯”è¾ƒ æ•ˆæœï¼š åº”å¯¹æ–¹æ³•ï¼š è¿˜æ˜¯è¿›è¡Œäº†æ¯”è¾ƒï¼Œä¿®æ”¹æ¯”è¾ƒç»“æœç»•è¿‡","link":"/2025/08/03/Day13-%E5%8F%8D%E8%B0%83%E8%AF%95%EF%BC%88%E4%BA%8C%EF%BC%89/"},{"title":"Day15:æŒ‡ä»¤è™šæ‹ŸåŒ–","text":"æŒ‡ä»¤è™šæ‹ŸåŒ–ã€å®ç°ä¸€ä¸ªå°å‹è™šæ‹Ÿæœºç¨‹åºã€VMé€†å‘å®è·µ ä»€ä¹ˆæ˜¯æŒ‡ä»¤è™šæ‹ŸåŒ– CPUå‚å•†åœ¨å¼€å‘CPUå‰ä¼šåˆ¶å®šä¸€ä¸ªè§„èŒƒï¼Œå»ºç«‹èµ·æ•°æ®å’Œæ“ä½œçš„å¯¹åº”å…³ç³»ï¼ˆå¦‚x86-64è§„å®š0x30å¯¹åº”å¼‚æˆ–æ“ä½œï¼‰ï¼Œè€Œè¿™ä¸ªæ•°æ®åˆå¯ä»¥æ ¹æ®æ“ä½œå‘½åå‡ºæ±‡ç¼–æŒ‡ä»¤ï¼ˆå¦‚0x30å‘½åä¸ºxorï¼‰ï¼Œå› æ­¤æœ‰äº†æ•°æ®ä¸æ“ä½œçš„å¯¹åº”å…³ç³»å’Œæ±‡ç¼–æŒ‡ä»¤ä¸æ“ä½œçš„å¯¹åº”å…³ç³»ï¼Œç§°ä¹‹ä¸ºæŒ‡ä»¤é›†ã€‚CPUå¯ä»¥è§†ä½œä¸€ä¸ªè§£é‡Šå™¨ï¼Œè´Ÿè´£è¯»å–æ•°æ®æˆ–è€…æ±‡ç¼–æŒ‡ä»¤ç„¶åå¸¦åŠ¨æœºå™¨äº§ç”Ÿæ“ä½œã€‚ é€šä¿—çš„è®²ï¼ŒæŒ‡ä»¤è™šæ‹ŸåŒ–å®é™…ä¸Šå°±æ˜¯è‡ªå®šä¹‰æŒ‡ä»¤é›†å¹¶ä¸ºè‡ªå·±çš„æŒ‡ä»¤é›†æ„å»ºè§£é‡Šå™¨ï¼Œç”¨è‡ªå®šä¹‰çš„æŒ‡ä»¤å®ç°ç¨‹åºçš„è¿‡ç¨‹ã€‚è¿™ä¸ªè¿‡ç¨‹åˆ©ç”¨é«˜çº§è¯­è¨€ä»£ç å®ç°ï¼Œä¹Ÿå°±æ˜¯ç”¨è½¯ä»¶æ¥æ¨¡æ‹Ÿç¡¬ä»¶ï¼Œç±»ä¼¼äºè™šæ‹Ÿæœºï¼Œå› æ­¤ç§°ä¹‹ä¸ºæŒ‡ä»¤è™šæ‹ŸåŒ–ã€‚ å®ç°æŒ‡ä»¤è™šæ‹ŸåŒ–ï¼Œéœ€è¦å®šä¹‰å¯„å­˜å™¨å˜é‡ï¼ˆè‡³å°‘éœ€è¦ä¸€ä¸ªEIPæ¥æŒ‡å‘è¿è¡Œçš„æŒ‡ä»¤ï¼‰ã€å†…å­˜ç©ºé—´æ•°ç»„ã€è§£é‡Šå™¨å’ŒæŒ‡ä»¤æ•°ç»„ã€‚ å®ç°è‡ªå®šä¹‰æŒ‡ä»¤é›†çš„è§£é‡Šå™¨ï¼Œå¯ä»¥é‡‡ç”¨Cè¯­è¨€çš„switchï¼ˆå…¶ä¸­codeæ˜¯è‡ªå®šä¹‰æŒ‡ä»¤ï¼Œé€šè¿‡å¾ªç¯è¾“å…¥ï¼‰ï¼š 1234567891011//è§£é‡Šå™¨ï¼š1è¾“å‡º11111ï¼Œ2è¾“å‡º22222ï¼Œ3è¾“å‡º33333switch(code):case 1: printf(&quot;11111&quot;); break;case 2: print(&quot;22222&quot;); break:case 3: print(&quot;33333&quot;); break; å®ç°ä¸€ä¸ªå°å‹è™šæ‹Ÿæœºç¨‹åº å°è¯•ç¼–å†™ä¸€ä¸ªè¾“å…¥ä¸¤ä¸ªæ•°ï¼Œè¾“å‡ºå’Œçš„ç¨‹åº å£°æ˜è™šæ‹Ÿç¡¬ä»¶ç»“æ„ä½“1234567typedef struct{ unsigned int r1;//å¯„å­˜å™¨r1 unsigned int r2;//å¯„å­˜å™¨r2 unsigned int eip;//å¯„å­˜å™¨eip unsigned char mem[256];//è™šæ‹Ÿå†…å­˜æ•°ç»„ unsigned char code[1024];//æŒ‡ä»¤æ•°ç»„} VM; å®šä¹‰æŒ‡ä»¤é›† ä½¿ç”¨op1ã€op2è¡¨ç¤ºæŒ‡ä»¤åé¢è·Ÿçš„æ“ä½œæ•°ï¼Œå¯„å­˜å™¨ä½œä¸ºéšå¼å‚æ•°ä¸ä¼šå‡ºç°åœ¨codeä¸­ æŒ‡ä»¤ ä½¿ç”¨æ ¼å¼ å¯¹åº”æ±‡ç¼–æŒ‡ä»¤/ä¼ªä»£ç  æ“ä½œè§£è¯» 0x10 0x10,op1 mov r1,mem[op1] r1=mem[op1] 0x11 0x11,op1 mov r2,mem[op1] r2=mem[op1] 0x20 0x20 add r1,r2 r1+=r2 0x30 0x30,op1,op2 scanf-&gt;mem[op1],mem[op2] è¾“å…¥ç»™mem[op1]ï¼Œmem[op2] 0x40 0x40 printf r1 è¾“å‡ºr1çš„å€¼ 0x50 0x50 ret return 1 ç¼–å†™è§£é‡Šå™¨123456789101112131415161718192021222324252627282930313233343536373839404142int vm_run(VM* vm) { char opcode;//ç”¨æ¥å­˜æ”¾æŒ‡ä»¤ char op1, op2;//ç”¨æ¥å­˜æ”¾æ“ä½œæ•° while (1) { opcode = vm-&gt;code[vm-&gt;eip];//è¯»å–eipæŒ‡å‘çš„æŒ‡ä»¤ switch (opcode) { case 0x10: op1 = vm-&gt;code[vm-&gt;eip + 1];//è·å–æ“ä½œæ•° vm-&gt;r1 = vm-&gt;mem[op1];//r1=mem[op1] vm-&gt;eip += 2;//è·³è½¬åˆ°ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼ˆæŒ‡ä»¤+æ“ä½œæ•°å 2ä¸ªç´¢å¼•ä½ï¼‰ break; case 0x11: op1 = vm-&gt;code[vm-&gt;eip + 1];//è·å–æ“ä½œæ•° vm-&gt;r2 = vm-&gt;mem[op1];//r2=mem[op1] vm-&gt;eip += 2;//è·³è½¬åˆ°ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼ˆæŒ‡ä»¤+æ“ä½œæ•°å 2ä¸ªç´¢å¼•ä½ï¼‰ break; case 0x20: vm-&gt;r1 += vm-&gt;r2;//r1+=r2 vm-&gt;eip += 1;//è·³è½¬åˆ°ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼ˆåªæœ‰æŒ‡ä»¤ï¼Œå 1ä¸ªç´¢å¼•ä½ï¼‰ break; case 0x30: op1 = vm-&gt;code[vm-&gt;eip + 1];//è·å–æ“ä½œæ•°1 op2 = vm-&gt;code[vm-&gt;eip + 2];//è·å–æ“ä½œæ•°2 scanf(&quot;%d %d&quot;, &amp;vm-&gt;mem[op1], &amp;vm-&gt;mem[op2]);//è¾“å…¥ç»™mem[op1]ï¼Œmem[op2] vm-&gt;eip += 3;//è·³è½¬åˆ°ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼ˆæŒ‡ä»¤+æ“ä½œæ•°å 3ä¸ªç´¢å¼•ä½ï¼‰ break; case 0x40: printf(&quot;%d&quot;, vm-&gt;r1);//è¾“å‡ºr1çš„å€¼ vm-&gt;eip += 1;//è·³è½¬åˆ°ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼ˆåªæœ‰æŒ‡ä»¤ï¼Œå 1ä¸ªç´¢å¼•ä½ï¼‰ break; case 0x50: return 1;//å¾ªç¯ç»ˆæ­¢ï¼Œå‡½æ•°è¿”å›ï¼Œè™šæ‹Ÿæœºå…³æœº } }} æŒ‡ä»¤æ•°ç»„12345678unsigned char code[]={ 0x30,0x0,0x1,//è¾“å…¥ç»™mem[0]ï¼Œmem[1] 0x10,0x0,//r1=mem[0] 0x11,0x1,//r2=mem[1] 0x20,//r1+=r2 0x40,//è¾“å‡ºr1çš„å€¼ 0x50//è™šæ‹Ÿæœºå…³æœº} å®Œæ•´ç¨‹åº12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576#include &lt;windows.h&gt;#include &lt;stdio.h&gt;typedef struct{ unsigned int r1;//å¯„å­˜å™¨r1 unsigned int r2;//å¯„å­˜å™¨r2 unsigned int eip;//å¯„å­˜å™¨eip unsigned char mem[256];//è™šæ‹Ÿå†…å­˜æ•°ç»„ unsigned char code[1024];//æŒ‡ä»¤æ•°ç»„} VM;unsigned char code[]={ 0x30,0x0,0x1,//è¾“å…¥ç»™mem[0]ï¼Œmem[1] 0x10,0x0,//r1=mem[0] 0x11,0x1,//r2=mem[1] 0x20,//r1+=r2 0x40,//è¾“å‡ºr1çš„å€¼ 0x50//è™šæ‹Ÿæœºå…³æœº};VM* vm_new() { VM* vm = (VM*)malloc(sizeof(VM));//ä¸ºè™šæ‹Ÿç¡¬ä»¶ç»“æ„ä½“ç”³è¯·ç©ºé—´ memset(vm, 0, sizeof(VM));//åˆå§‹åŒ–ç»“æ„ä½“ memcpy(vm-&gt;code, code, sizeof(code));//åˆå§‹åŒ–code return vm;}int vm_run(VM* vm) { char opcode;//ç”¨æ¥å­˜æ”¾æŒ‡ä»¤ char op1, op2;//ç”¨æ¥å­˜æ”¾æ“ä½œæ•° while (1) { opcode = vm-&gt;code[vm-&gt;eip];//è¯»å–eipæŒ‡å‘çš„æŒ‡ä»¤ switch (opcode) { case 0x10: op1 = vm-&gt;code[vm-&gt;eip + 1];//è·å–æ“ä½œæ•° vm-&gt;r1 = vm-&gt;mem[op1];//r1=mem[op1] vm-&gt;eip += 2;//è·³è½¬åˆ°ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼ˆæŒ‡ä»¤+æ“ä½œæ•°å 2ä¸ªç´¢å¼•ä½ï¼‰ break; case 0x11: op1 = vm-&gt;code[vm-&gt;eip + 1];//è·å–æ“ä½œæ•° vm-&gt;r2 = vm-&gt;mem[op1];//r2=mem[op1] vm-&gt;eip += 2;//è·³è½¬åˆ°ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼ˆæŒ‡ä»¤+æ“ä½œæ•°å 2ä¸ªç´¢å¼•ä½ï¼‰ break; case 0x20: vm-&gt;r1 += vm-&gt;r2;//r1+=r2 vm-&gt;eip += 1;//è·³è½¬åˆ°ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼ˆåªæœ‰æŒ‡ä»¤ï¼Œå 1ä¸ªç´¢å¼•ä½ï¼‰ break; case 0x30: op1 = vm-&gt;code[vm-&gt;eip + 1];//è·å–æ“ä½œæ•°1 op2 = vm-&gt;code[vm-&gt;eip + 2];//è·å–æ“ä½œæ•°2 scanf(&quot;%d %d&quot;, &amp;vm-&gt;mem[op1], &amp;vm-&gt;mem[op2]);//è¾“å…¥ç»™mem[op1]ï¼Œmem[op2] vm-&gt;eip += 3;//è·³è½¬åˆ°ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼ˆæŒ‡ä»¤+æ“ä½œæ•°å 3ä¸ªç´¢å¼•ä½ï¼‰ break; case 0x40: printf(&quot;%d&quot;, vm-&gt;r1);//è¾“å‡ºr1çš„å€¼ vm-&gt;eip += 1;//è·³è½¬åˆ°ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼ˆåªæœ‰æŒ‡ä»¤ï¼Œå 1ä¸ªç´¢å¼•ä½ï¼‰ break; case 0x50: return 1;//å¾ªç¯ç»ˆæ­¢ï¼Œå‡½æ•°è¿”å›ï¼Œè™šæ‹Ÿæœºå…³æœº } }}int main() { VM* vm = vm_new();//ç”Ÿæˆä¸€ä¸ªè™šæ‹Ÿæœº if (vm_run(vm))//è¿è¡Œè™šæ‹Ÿæœº system(&quot;pause&quot;); return 0;} ç®€å•ç¤ºä¾‹çš„é€†å‘ VMé¢˜æœ€æ˜¾è‘—çš„ç‰¹å¾åº”è¯¥å°±æ˜¯è™šæ‹Ÿç¡¬ä»¶ç»“æ„ä½“çš„åˆå§‹åŒ–å’Œè§£é‡Šå™¨äº†ã€‚è§£å†³è¿™ç±»é—®é¢˜ï¼Œéœ€è¦å…ˆå¤åˆ»å‡ºä¸€ä¸ªè§£é‡Šå™¨ï¼Œé€šè¿‡åœ¨è§£é‡Šå™¨ä¸­å¢åŠ æ‰“å°åˆ†æå‡ºçš„ä»£ç çš„æ“ä½œï¼Œæ¥å¾—åˆ°å»è™šæ‹ŸåŒ–çš„åŸç¨‹åºï¼Œè¿›è€Œå¯ä»¥æ­£å¸¸é€†å‘åˆ†æ å…ˆæ¥çœ‹mainå‡½æ•°ï¼š ä¸‹é¢ä¸‰ä¸ªå¸¦å­—ç¬¦ä¸²çš„å‡½æ•°å¯ä»¥çœ‹å‡ºæ˜¯printfå’Œsystem çœ‹çœ‹v1=åé¢çš„å‡½æ•° ç›®å‰æ²¡ä»€ä¹ˆæ˜æ˜¾çš„VMç‰¹å¾ å†çœ‹çœ‹ifæ‹¬å·é‡Œçš„å‡½æ•° çœ‹åˆ°å‡ºç°switchäº†ï¼Œå¼€å§‹æ¨æµ‹æ˜¯VMçš„è§£é‡Šå™¨ å›åˆ°ä¸Šä¸€ä¸ªå‡½æ•°ï¼Œå‘ç°ç¡®å®å’ŒVMçš„åˆå§‹åŒ–å‡½æ•°å¾ˆåƒï¼Œæœ€åé¢ä¸€ä¸ªå‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°å¯¹åº”å‡ºæ¥çš„æ˜¯ä¸€å †æ•°å­—ï¼Œå’Œåˆå§‹åŒ–codeå¯¹åº”ä¸Šäº† OKï¼Œé‚£å°±å¯¹ä¼ªä»£ç è¿›è¡Œä¸€ç‚¹ç‚¹ä¼˜åŒ–ï¼Œç„¶åå¼€å§‹åˆ†æè§£é‡Šå™¨ 1234567891011121314151617181920212223242526272829303132333435363738//æ¨æµ‹è™šæ‹Ÿç¡¬ä»¶ç»“æ„ä½“__int64 __fastcall vm_run(unsigned int *vm){ sub_140001940(&amp;unk_1401150A2); while ( 1 ) { switch ( *((_BYTE *)vm + vm[2] + 268) )//vm+268æ˜¯codeæ‰€åœ¨ï¼Œç»“åˆä¸‹æ–‡åˆ†æï¼ŒåŠ ä¸Švm[2]å°±æ„æˆäº†code[eip] { case 0x10: *vm = *((char *)vm + vm[2] + 269);//*vm=code[eip+1]ï¼Œvmåº”è¯¥æ˜¯ä¸€ä¸ªå¯„å­˜å™¨ï¼Œè¿™å¥æ˜¯mov r1,op1 vm[2] += 2;//æ¯ä¸ªcaseéƒ½æœ‰ï¼Œæ¨æµ‹æ˜¯eipã€‚+=2ï¼Œè¯´æ˜æœ‰ä¸€ä¸ªæ“ä½œæ•° break; case 0x11: vm[1] = *((char *)vm + vm[2] + 269);//vm[1]=code[eip+1]ï¼Œvm[1]åº”è¯¥ä¹Ÿæ˜¯ä¸€ä¸ªå¯„å­˜å™¨,è¿™å¥æ˜¯mov r2,op1 vm[2] += 2;//æœ‰ä¸€ä¸ªæ“ä½œæ•° break; case 0x20: *((_BYTE *)vm + *((char *)vm + vm[2] + 269) + 12) = *((_BYTE *)vm + vm[2] + 270); //*((char *)vm + vm[2] + 269)æ˜¯code[eip+1]ï¼Œå³op1ï¼Œæ‰€ä»¥å·¦è¾¹æ˜¯vm+12+op1ï¼Œæ¨æµ‹vm+12æ˜¯è™šæ‹Ÿå†…å­˜ï¼Œåˆšå¥½è·¨è¿‡ä¸‰ä¸ªè¿ç»­çš„intå‹å¯„å­˜å™¨ //å³è¾¹å³vm+vm[2]+268+2å³code[eip+2]ï¼Œå³op2 vm[2] += 3;//æœ‰ä¸¤ä¸ªæ“ä½œæ•° break; case 0x30: *((_BYTE *)vm + *vm + 12) ^= *((_BYTE *)vm + 4);//mem[r1]^=r2 ++vm[2];//æ— æ“ä½œæ•° break; case 0x40: sub_140001610(&amp;unk_1400D74B0, vm + 3);//unkè¿™ä¸ªæ˜¯%5sï¼Œæ‰€ä»¥è¿™æ˜¯scanfã€‚è¿™é‡Œçš„vmæ˜¯intï¼ŒåŠ ä¸‰è·³è¿‡äº†å•ä¸ªå¯„å­˜å™¨ï¼Œæ˜¯mem[0] ++vm[2];//æ— æ“ä½œæ•° break; case 0x50: return sub_1400D4430(vm + 3, (char *)vm + *((char *)vm + vm[2] + 269) + 12, *((char *)vm + vm[2] + 270)); //ä¸‰ä¸ªå‚æ•°åˆ†åˆ«ä¸ºmem[0],mem[op1],op2ï¼Œæ¨æµ‹æ˜¯memcmpï¼ˆæ€ä¹ˆæ²¡æš—ç¤ºæ“ä½œæ•°ä¸ªæ•° default: continue; } }} æ¨æµ‹è™šæ‹Ÿç¡¬ä»¶ç»“æ„ä½“å¦‚ä¸‹ï¼š 1234567typedef struct{ unsigned int r1; unsigned int r2; unsigned int eip; unsigned char mem[268-3*4=256]; unsigned char code[36];} VM; å¸¦è¾“å‡ºåˆ†æå‡ºæ¥çš„ä»£ç çš„è§£é‡Šå™¨å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546int vm_run(VM* vm) { char opcode; char op1, op2; while (1) { opcode = vm-&gt;code[vm-&gt;eip]; switch (opcode) { case 0x10: vm-&gt;r1 = code[vm-&gt;eip + 1]; vm-&gt;eip += 2; cout &lt;&lt; &quot;mov r1,&quot; &lt;&lt; vm-&gt;r1 &lt;&lt; endl; break; case 0x11: vm-&gt;r2 = code[vm-&gt;eip + 1]; vm-&gt;eip += 2; cout &lt;&lt; &quot;mov r2,&quot; &lt;&lt; vm-&gt;r2 &lt;&lt; endl; break; case 0x20: op1 = code[vm-&gt;eip + 1]; op2 = code[vm-&gt;eip + 2]; vm-&gt;mem[op1] = op2; vm-&gt;eip += 3; cout &lt;&lt; &quot;mov mem[&quot; &lt;&lt; (int)op1 &lt;&lt; &quot;],&quot; &lt;&lt; op2 &lt;&lt; endl; break; case 0x30: vm-&gt;mem[vm-&gt;r1] ^= vm-&gt;r2; ++vm-&gt;eip; cout &lt;&lt; &quot;xor mem[&quot; &lt;&lt; vm-&gt;r1 &lt;&lt; &quot;],&quot; &lt;&lt; vm-&gt;r2 &lt;&lt; endl; break; case 0x40: scanf(&quot;%5s&quot;, &amp;vm-&gt;mem[0]); ++vm-&gt;eip; printf(&quot;scanf mem\\n&quot;); break; case 0x50: op1 = code[vm-&gt;eip + 1]; op2 = code[vm-&gt;eip + 2]; return memcmp(&amp;vm-&gt;mem[0], &amp;vm-&gt;mem[op1], op2); } }} å®Œæ•´çš„è„šæœ¬ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283#include &lt;windows.h&gt;#include &lt;stdio.h&gt;#include&lt;stdlib.h&gt;#include&lt;iostream&gt;using namespace std;typedef struct { unsigned int r1; unsigned int r2; unsigned int eip; unsigned char mem[256]; unsigned char code[36];} VM ;unsigned char code[] = { 0x20, 0x10, 0x48, 0x20, 0x11, 0x65, 0x20, 0x12, 0x6C, 0x20, 0x13, 0x6C, 0x20, 0x14, 0x6F, 0x40, 0x11, 0x21, 0x10, 0x00, 0x30, 0x10, 0x01, 0x30, 0x10, 0x02, 0x30, 0x10, 0x03, 0x30, 0x10, 0x04, 0x30, 0x50, 0x10, 0x05};VM* vm_new() { VM* vm = (VM*)malloc(sizeof(VM)); memset(vm, 0, sizeof(VM)); memcpy(vm-&gt;code, code, sizeof(code)); return vm;}int vm_run(VM* vm) { char opcode; char op1, op2; while (1) { opcode = vm-&gt;code[vm-&gt;eip]; switch (opcode) { case 0x10: vm-&gt;r1 = code[vm-&gt;eip + 1]; vm-&gt;eip += 2; cout &lt;&lt; &quot;mov r1,&quot; &lt;&lt; vm-&gt;r1 &lt;&lt; endl; break; case 0x11: vm-&gt;r2 = code[vm-&gt;eip + 1]; vm-&gt;eip += 2; cout &lt;&lt; &quot;mov r2,&quot; &lt;&lt; vm-&gt;r2 &lt;&lt; endl; break; case 0x20: op1 = code[vm-&gt;eip + 1]; op2 = code[vm-&gt;eip + 2]; vm-&gt;mem[op1] = op2; vm-&gt;eip += 3; cout &lt;&lt; &quot;mov mem[&quot; &lt;&lt; (int)op1 &lt;&lt; &quot;],&quot; &lt;&lt; op2 &lt;&lt; endl; break; case 0x30: vm-&gt;mem[vm-&gt;r1] ^= vm-&gt;r2; ++vm-&gt;eip; cout &lt;&lt; &quot;xor mem[&quot; &lt;&lt; vm-&gt;r1 &lt;&lt; &quot;],&quot; &lt;&lt; vm-&gt;r2 &lt;&lt; endl; break; case 0x40: scanf(&quot;%5s&quot;, &amp;vm-&gt;mem[0]); ++vm-&gt;eip; printf(&quot;scanf mem\\n&quot;); break; case 0x50: op1 = code[vm-&gt;eip + 1]; op2 = code[vm-&gt;eip + 2]; return memcmp(&amp;vm-&gt;mem[0], &amp;vm-&gt;mem[op1], op2); } }}int main() { VM* vm = vm_new(); if (vm_run(vm)) printf(&quot;failed\\n&quot;); else printf(&quot;good\\n&quot;); system(&quot;pause&quot;); return 0;} è¿™æ ·æˆ‘ä»¬å¾—åˆ°äº†åŸç¨‹åºçš„æ±‡ç¼–ä»£ç ï¼ˆå‚æ‚ç€å¥‡æ€ªçš„ä»£ç ï¼‰ 12345678910111213141516171819mov mem[16],Hmov mem[17],emov mem[18],lmov mem[19],lmov mem[20],o12345scanf memmov r2,33mov r1,0xor mem[0],33mov r1,1xor mem[1],33mov r1,2xor mem[2],33mov r1,3xor mem[3],33mov r1,4xor mem[4],33failed å¯ä»¥çœ‹åˆ°ï¼Œç¨‹åºå…ˆæŠŠâ€Helloâ€ä¼ ç»™äº†memçš„ä¸€ç‰‡åŒºåŸŸï¼Œç„¶åè·å–è¾“å…¥ï¼ŒæŠŠè¾“å…¥çš„æ•°ä¸33å¼‚æˆ–ï¼Œæœ€åæ‰§è¡Œè¿”å›å¤„çš„åˆ¤æ–­ã€‚è¿”å›å¤„æ˜¯å¯¹æ¯”mem[0]å’Œmem[op1]ï¼Œå¯¹æ¯”op2ä½ï¼Œç»“åˆcodeæœ€åå‡ ä½ï¼ŒçŸ¥é“æ˜¯å¯¹æ¯”mem[0]å’Œmem[16]ï¼Œå¯¹æ¯”5ä½ã€‚æ‰€ä»¥è¦æ±‚çš„è¾“å…¥æ˜¯â€Helloâ€é€ä½å¼‚æˆ–çš„ç»“æœï¼ˆä¸å¯è§å­—ç¬¦ï¼Œå°è¯•è¾“å…¥å¤±è´¥ï¼‰","link":"/2025/08/06/Day15-%E6%8C%87%E4%BB%A4%E8%99%9A%E6%8B%9F%E5%8C%96/"},{"title":"Day16:Z3æ±‚è§£å™¨","text":"z3æ±‚è§£å™¨ åŸºæœ¬æ•°æ®ç±»å‹ Intï¼šæ•´æ•° BitVecï¼šäºŒè¿›åˆ¶æ•°æ®ï¼ˆå¦‚BitVec(â€˜aâ€™,8)ï¼š8ä¸ªæ¯”ç‰¹ä½çš„ä¸€ä¸ªå˜é‡aï¼‰ Realï¼šæœ‰ç†æ•° Boolï¼šå¸ƒå°”å€¼ Arrayï¼šæ•°ç»„ åŸºæœ¬æµç¨‹è®¾å˜é‡ ä½¿ç”¨åŸºæœ¬æ•°æ®ç±»å‹æ¥å£°æ˜å˜é‡ï¼Œå¦‚ï¼šx=Int(â€˜xâ€™) åˆ›å»ºæ±‚è§£å™¨ ä½¿ç”¨å‡½æ•°Solve()åˆ›å»ºä¸€ä¸ªæ±‚è§£å™¨ï¼šs=Solver() æ·»åŠ çº¦æŸæ¡ä»¶ ä½¿ç”¨å‡½æ•°add()æ·»åŠ çº¦æŸæ¡ä»¶ï¼šs.add(ä¸€ä¸ªæ–¹ç¨‹/ä¸ç­‰å¼) åˆ¤æ–­æ˜¯å¦æœ‰è§£ ä½¿ç”¨å‡½æ•°check()æ£€æŸ¥æ˜¯å¦æœ‰è§£ï¼Œæœ‰è§£è¿”å›â€™satâ€™ï¼Œæ— è§£è¿”å›â€™unsatâ€™ å–è§£çš„äº¤é›† ä½¿ç”¨å‡½æ•°model()å–æ»¡è¶³æ¯ä¸ªæ¡ä»¶çš„è§£çš„äº¤é›†ï¼Œè¿”å›çš„æ˜¯å­—å…¸ï¼Œç”¨model[å˜é‡å]å¯ä»¥å¾—åˆ°å˜é‡çš„è§£ ç¤ºä¾‹è§£æ–¹ç¨‹{x,y|30x+15y=675,12x+5y=265} 1234567891011from z3 import *x=Int('x')y=Int('y')s=Solver()s.add(30*x+15*y==675)s.add(12*x+5*y==265)if s.check()==sat: print(s.model())#å¾—åˆ°è§£[x = 20, y = 5]","link":"/2025/08/21/Day16-Z3/"},{"title":"Day14:IDApythonä¸SMC","text":"IDApythonAPIã€SMCè‡ªä¿®æ”¹ä»£ç  IDApython å…ˆè´´ä¸Šå®˜æ–¹æ–‡æ¡£ï¼š https://python.docs.hex-rays.com/index.html åŸºç¡€API idc.here() / idc.get_screen_ea()ï¼šè¿”å›å…‰æ ‡æ‰€åœ¨å¤„çš„åœ°å€ idc.get_inf_attr(INF_MIN_EA) / idc.get_inf_attr(INF_MAX_EA)ï¼šè¿”å›æœ€å°/æœ€å¤§åœ°å€ï¼ˆæ²¡æœ‰éšæœºåŒ–åœ°å€æƒ…å†µä¸‹ï¼‰ idc.generate_disasm_line(ea,0)ï¼šè¿”å›eaæ‰€åœ¨å¤„çš„æ±‡ç¼–æŒ‡ä»¤ idc.prev_head(ea)/next_head(ea)ï¼šè¿”å›eaå¤„ä¸Šä¸€æ¡/ä¸‹ä¸€æ¡æŒ‡ä»¤åœ°å€ idc.print_insn_mnem(ea)ï¼šæ‰“å°eaå¤„çš„åŠ©è®°ç¬¦ï¼ˆå³mov,addä»€ä¹ˆçš„ï¼‰ idc.print_operand(ea,n)ï¼šæ‰“å°eaå¤„ç¬¬nä¸ªæ“ä½œæ•°ï¼ˆn=0æˆ–è€…1ï¼‰ æ®µç›¸å…³API idautils.Segments()ï¼šè¿”å›æ®µèµ·å§‹åœ°å€åˆ—è¡¨ idc.get_segm_name(ea)ï¼šè¿”å›eaæ‰€åœ¨æ®µçš„åå­— idc.get_segm_start(ea)/get_segm_end(ea)ï¼šè¿”å›eaæ‰€åœ¨æ®µçš„èµ·å§‹åœ°å€/ç»“æŸåœ°å€ idc.get_next_seg(ea)ï¼šè¿”å›eaæ‰€åœ¨æ®µçš„ä¸‹ä¸€ä¸ªæ®µçš„èµ·å§‹åœ°å€ å‡½æ•°ç›¸å…³API idautils.Functions(start_addr,end_addr)ï¼šè¿”å›åœ°å€é—´çš„å‡½æ•°å¯¹è±¡ï¼ˆä¸å†™å‚æ•°å°±æ˜¯æ‰€æœ‰å‡½æ•°å¯¹è±¡ï¼‰ idautils.FuncItems(ea)ï¼šè¿”å›eaæ‰€åœ¨å‡½æ•°æ‰€æœ‰æŒ‡ä»¤çš„åœ°å€ï¼ˆç›¸å½“äºåœ°å€åˆ—è¡¨ï¼‰ idaapi.get_func(ea)ï¼šè·å¾—eaæ‰€åœ¨å‡½æ•°çš„å¯¹è±¡ï¼ˆå«æœ‰å¦‚start_eaã€end_eaã€sizeç­‰å±æ€§ï¼‰ idc.get_func_name(ea)ï¼šè¿”å›eaæ‰€åœ¨å‡½æ•°çš„åå­— idc.get_func_attr(ea,FUNCATTR_START) / idc.get_func_attr(ea,FUNCATTR_END)ï¼šè¿”å›eaæ‰€åœ¨å‡½æ•°çš„èµ·å§‹åœ°å€/ç»“æŸåœ°å€ idc.get_next_func(ea) / idc.get_prev_func(ea)ï¼šè¿”å›eaæ‰€åœ¨å‡½æ•°çš„ä¸Šä¸€ä¸ª/ä¸‹ä¸€ä¸ªå‡½æ•°çš„èµ·å§‹åœ°å€ æŒ‡ä»¤ç›¸å…³API ida_ua.insn_t()ï¼Œè¿”å›ä¸€ä¸ªç©ºçš„æŒ‡ä»¤å¯¹è±¡ï¼ˆæˆ–è€…è¯´åˆ›å»ºä¸€ä¸ªç©ºçš„æŒ‡ä»¤å¯¹è±¡ï¼‰ï¼ŒåŒ…å«å‡½æ•°çš„ä¸€äº›å±æ€§ idaapi.decode_insn(out,ea)ï¼Œè§£æeaæ‰€åœ¨å¤„çš„æŒ‡ä»¤ï¼ŒæŠŠè§£æçš„ç»“æœç»™outï¼ˆoutå¿…é¡»æ˜¯ä¸€ä¸ªæŒ‡ä»¤å¯¹è±¡ï¼‰ out.eaï¼šæŒ‡ä»¤çš„èµ·å§‹åœ°å€ out.sizeï¼šæŒ‡ä»¤å ç”¨çš„å­—èŠ‚æ•° out.get_cannon_mnemonic()ï¼šæŒ‡ä»¤çš„åŠ©è®°ç¬¦ out.itypeï¼šåŠ©è®°ç¬¦çš„åè¿›åˆ¶ç  æ“ä½œæ•°ç›¸å…³API idc.get_operand_value(ea,n)ï¼šè¿”å›eaå¤„ç¬¬nä¸ªæ“ä½œæ•°çš„å€¼ idc.get_operand_type(ea,n)ï¼šè¿”å›eaå¤„ç¬¬nä¸ªæ“ä½œæ•°çš„ç±»å‹ æ•°æ®è¯»å†™ç›¸å…³API idc.get_bytes(ea,size)ï¼šè¿”å›eaå¤„sizeå¤§å°çš„bytes idc.patch_byte(ea,content)ï¼šä¿®æ”¹eaå¤„çš„1å­—èŠ‚ä¸ºcontent idc.patch_word(ea,content)ï¼šä¿®æ”¹eaå¤„çš„2å­—èŠ‚ä¸ºcontent idc.patch_dword(ea,content)ï¼šä¿®æ”¹eaå¤„çš„4å­—èŠ‚ä¸ºcontent idc.patch_qword(ea,content)ï¼šä¿®æ”¹eaå¤„çš„8å­—èŠ‚ä¸ºcontent è°ƒè¯•ç›¸å…³API ida_dbg.load_debugger(â€œlocalâ€,0)ï¼šå¯åŠ¨è°ƒè¯•å™¨ ida_dbg.add_bpt(ea)ï¼šåœ¨eaå¤„ä¸‹æ–­ç‚¹ ida_dbg.del_bpt(ea)ï¼šåˆ é™¤eaå¤„æ–­ç‚¹ ida_dbg.start_process(path,args,sdir)ï¼šå¯åŠ¨è°ƒè¯•è¿›ç¨‹ï¼Œå‚æ•°å¯¹åº”è·¯å¾„ã€å‘½ä»¤è¡Œå‚æ•°ã€å·¥ä½œç›®å½• ida_dbg.step_into()ï¼šå•æ­¥æ­¥å…¥ ida_dbg.step_over()ï¼šå•æ­¥æ­¥è¿‡ ida_dbg.step_until_ret()ï¼šè¿è¡Œåˆ°è¿”å› idc.get_reg_value(regname)ï¼šè·å–regnameå¯„å­˜å™¨çš„å€¼ idc.set_reg_value(value,regname)ï¼šè®¾ç½®regnameå¯„å­˜å™¨çš„å€¼ å…¶ä»–æ“ä½œç›¸å…³API idautils.XrefsFrom(ea)ï¼šè¿”å›eaå¤„å¼•ç”¨çš„å¯¹è±¡ï¼ˆæœ‰å±æ€§frmã€toã€typeï¼‰ idautils.XrefsTo(ea)ï¼šè¿”å›æ‰€æœ‰å¼•ç”¨eaå¤„çš„å¯¹è±¡ï¼ˆæœ‰å±æ€§frmã€toã€typeï¼‰ï¼ˆCtrl+Xï¼‰ ç¤ºä¾‹ï¼š 1234567import idautils,idaapifor xref in idautils.XrefsTo(here()): print(xref.to)#here() print(xref.frm)#è°ƒç”¨here()çš„å‡½æ•°åœ°å€for xref in idautils.XrefsFrom(here()): print(xref.frm)#here() print(xref.to)#here()å¼•ç”¨çš„å‡½æ•°åœ°å€ idautils.Strings()ï¼šè¿”å›åŒ…å«æ‰€æœ‰å­—ç¬¦ä¸²çš„å¯¹è±¡ï¼ˆæœ‰å±æ€§eaã€lengthã€strtypeï¼‰ï¼ˆshift+F12ï¼‰ idc.get_strlit_contents(ea)ï¼šè¿”å›eaå¤„çš„å­—ç¬¦ä¸² ç¤ºä¾‹ï¼š 12345import idc,idautilsfor s in idautils.Strings(): string=idc.get_strlit_contents(s.ea) print(string)#æ‰“å°æ‰€æœ‰å­—ç¬¦ä¸² è‡ªä¿®æ”¹ä»£ç ï¼ˆSMCï¼‰ è‡ªä¿®æ”¹ä»£ç ï¼ˆSelf-Modifying-Codeï¼‰æŒ‡æŸéƒ¨åˆ†ä»£ç ä»¥åŠ å¯†åçš„å½¢å¼å­˜åœ¨äºç¨‹åºä¸­ï¼Œç¨‹åºæ‰§è¡Œåˆ°è¿™éƒ¨åˆ†ä»£ç çš„æ—¶å€™æ‰ä¼šè¿›è¡ŒåŠ¨æ€è§£å¯†ï¼Œå’ŒåŠ å£³æœ‰ç‚¹å¼‚æ›²åŒå·¥ã€‚å¸¸ç”¨æ¥åŠ å¯†å…³é”®é€»è¾‘ï¼Œä½¿å…¶ä¸å¯ç›´æ¥é™æ€åˆ†æ ç‰¹å¾ï¼š ç¨‹åºä¸­å­˜åœ¨å¯¹ç¨‹åºè‡ªèº«æŸéƒ¨åˆ†çš„è¿ç®—ï¼Œä¸€èˆ¬è¿˜éœ€è¦VirtualProtect() / mprotect()æ¥æ”¹å˜å†…å­˜çš„å±æ€§ä»¥ä¾¿å°†è§£å¯†åçš„ä»£ç æ•°æ®å†™å…¥å†…å­˜ï¼Œæˆ–è€…ä½¿ç”¨VirtualAllocæŠŠè§£å¯†åçš„ä»£ç æ•°æ®å†™å…¥å †ä¸­æ‰§è¡Œï¼ˆä¸ºäº†é¿å…APIæš´éœ²ï¼Œè¿˜å¯èƒ½ä¼šæ–°å¢ä¸€ä¸ªæœ‰RWXå±æ€§çš„æ®µæ¥å­˜æ”¾åŠ å¯†åçš„ä»£ç ï¼‰ã€‚ åº”å¯¹æ–¹æ³•æœ‰ä¸¤ç§ï¼šä¸€ç§æ˜¯åŠ¨æ€è°ƒè¯•å¾—åˆ°è§£å¯†åçš„å…³é”®é€»è¾‘ï¼Œå¦ä¸€ç§æ˜¯ä½¿ç”¨è„šæœ¬è§£å¯†å…³é”®é€»è¾‘åå†è¦†ç›–å›å» ç¤ºä¾‹ï¼š2021-ç¾ŠåŸæ¯-babysmc PSï¼šæœ¬æ¥æƒ³è¦è‡ªå·±å†™ä¸€ä¸ªç®€å•ç¨‹åºè¯•è¯•æ‰‹çš„ï¼Œç ”ç©¶äº†åŠä¸ªä¸‹åˆæ²¡ç ”ç©¶å‡ºæ¥ï¼Œç¨‹åºä¿®æ­£åˆ°è§£å¯†å‡½æ•°å¯ä»¥è§£å¯†å‡ºæ­£ç¡®ä»£ç äº†ï¼Œä½†æ˜¯è°ƒç”¨å…³é”®é€»è¾‘checkçš„æ—¶å€™è«åå…¶å¦™è·‘é£äº†ï¼Œåœ¨é‚£ä¸ªå®‰å…¨æ£€æŸ¥çš„ä½ç½®ï¼Œè·³è½¬ååƒæ˜¯ä¸ªç•¸å½¢å‡½æ•°ï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯æ”¹å†…å­˜å±æ€§çš„æ—¶å€™å½±å“åˆ°äº†ï¼Œæ‰€ä»¥åªèƒ½å»æ‰¾ç½‘ä¸Šçš„é¢˜ç›®äº† è¿™æ˜¯ä¼˜åŒ–åçš„ä¸»å‡½æ•°ï¼š ä¼˜åŒ–çš„æ¥æºå°±æ˜¯ï¼Œencçš„ä½ç½®æ˜¯ä¸€å›¢æ•°å­—ï¼Œè€Œloc_7FF6BF081D00å¤„å¼€å§‹æ˜¯æ­£å¸¸ä»£ç ï¼ŒåŠ ä¸Šå¯¹ä¸‹é¢çš„decryptå‡½æ•°çš„åˆ†æï¼Œå¯ä»¥ç¡®å®šencå°±æ˜¯è¢«åŠ å¯†åçš„first_part è¿™æ˜¯decryptå‡½æ•°ï¼š éå¸¸æ˜æ˜¾åœ°è°ƒç”¨äº†VirtualProtectå‡½æ•°ï¼Œè§£å¯†é€»è¾‘å¾ˆç®€å•ï¼Œå°±æ˜¯roråå¼‚æˆ–0x5aï¼ˆroræŸ¥å‡ºæ¥æ˜¯å¾ªç¯å³ç§»ï¼Œ3å°±æ˜¯å³ç§»çš„ä½æ•°äº†ï¼Œè¿™ç‚¹çœ‹æ±‡ç¼–å¯èƒ½æ›´æ¸…æ™°ç‚¹ï¼‰ ä¸‹é¢å°±æ˜¯ä»Šå¤©çš„æˆæœå±•ç¤ºäº†ï¼ˆrorç”±DSååŠ©å®ç°ï¼‰ï¼ŒSMCè§£å¯†è„šæœ¬ï¼š 12345678910111213import idautils,idc,idaapienc=idc.get_bytes(0x00007FF6BF081085,0x00007FF6BF081D00-0x00007FF6BF081085)loc=0x00007FF6BF081085def ror(value, shift, bits=8): shift %= bits # ç¡®ä¿ä½ç§»é‡åœ¨æœ‰æ•ˆèŒƒå›´å†… return (value &gt;&gt; shift) | ((value &lt;&lt; (bits - shift)) &amp; ((1 &lt;&lt; bits) - 1))for i in enc: idc.patch_byte(loc,(ror(i,3)^0x5a)&amp;0xff) loc+=1print(&quot;done&quot;) æœ¬æ¥æ˜¯è¦å†™å®Œçš„ï¼Œä½†æ˜¯first_partçš„å‡½æ•°è§£æå®Œå¥½å‡ ç™¾è¡Œäº†ï¼Œæ˜¯æˆ‘çœ‹ä¸æ‡‚çš„åŠ å¯†ğŸ« å»æ‰¾WPï¼Œå‘ç°æ˜¯éå¸¸æ··æ·†çš„base64ï¼Œè¿˜åŠ äº†å¼‚æˆ–ï¼Œä½†æ˜¯æˆ‘æ²¡çœ‹å‡ºé€»è¾‘ï¼Œç´¢æ€§ç‚¹åˆ°ä¸ºæ­¢ï¼Œæ”¹å¤©æŠŠç¼–ç å’Œå¯†ç çš„éƒ¨åˆ†è¡¥ä¸Šå†è¯´ã€‚ æœ¬æ¥ä¹Ÿå°è¯•äº†åŠ¨è°ƒè§£å¯†ï¼Œä½†æ˜¯è°ƒç€è°ƒç€ç»™æˆ‘ä¸‹èµ·ä¸œè¥¿æ¥äº†ï¼Œè™½ç„¶é“¾æ¥çœ‹ç€æ˜¯å¾®è½¯çš„ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰ç‚¹æ€•ï¼Œå°±èˆå¼ƒè¿™ä¸ªæ–¹æ³•äº†ï¼ˆä¸‹çš„æ˜¯kernel.pdbå¥½åƒï¼ŒDSè¯´æ˜¯ç¼ºå¤±ç¬¦å·æ–‡ä»¶ğŸ« ğŸ« ï¼‰","link":"/2025/08/05/Day14-IDApython%E4%B8%8ESMC/"},{"title":"Day2:å¯»å€æ–¹å¼ã€æ ‡å¿—å¯„å­˜å™¨ã€JCCæŒ‡ä»¤","text":"å¯»å€æ–¹å¼ã€æ ‡å¿—å¯„å­˜å™¨ã€JCCæŒ‡ä»¤ å¯»å€æ–¹å¼ å¯»å€æ–¹å¼ ç¤ºä¾‹ å…¸å‹ç”¨é€” ç«‹å³æ•°å¯»å€ mov eax,42 åŠ è½½å¸¸æ•° å¯„å­˜å™¨å¯»å€ add eax,ebx å¯„å­˜å™¨è¿ç®— ç›´æ¥å¯»å€ mov eax,[0x8040000] è®¿é—®å…¨å±€å˜é‡ å¯„å­˜å™¨é—´æ¥å¯»å€ mov eax,[esi] æŒ‡é’ˆè§£å¼•ç”¨ åŸºå€å¯»å€ mov [ebp-4],ecx æ ˆå¸§å±€éƒ¨å˜é‡ å˜å€å¯»å€ mov eax,[esi*4] æ•°ç»„éå† åŸºå€å˜å€å¯»å€ mov eax,[ebx+esi*2+8] ç»“æ„ä½“ï¼Œå¤šç»´æ•°ç»„ ç›¸å¯¹å¯»å€ jmp label è·³è½¬ï¼Œå‡½æ•°è°ƒç”¨ æ ‡å¿—å¯„å­˜å™¨ æ ‡å¿—ä½ åç§° ä½œç”¨ CF Carry Flag è¿›ä½æ ‡å¿—ä½ æœ€é«˜ä½å‘ç”Ÿè¿›ä½/å€Ÿä½æ—¶ç½®1 PF Parity Flag å¥‡å¶æ ‡å¿—ä½ 1çš„ä¸ªæ•°ä¸ºå¶æ•°æ—¶ç½®1 AF Auxiliary Carry Flag è¾…åŠ©è¿›ä½æ ‡å¿—ä½ bit3å’Œbit4ä¹‹é—´å‘ç”Ÿè¿›ä½/å€Ÿä½æ—¶ç½®1 ZF Zoro Flag é›¶æ ‡å¿—ä½ ä¸º0æ—¶ç½®1 SF Sign Flag ç¬¦å·æ ‡å¿—ä½ æœ€é«˜ä½ä¸º1(è´Ÿæ•°)æ—¶ç½®1 OF Overflow Flag æº¢å‡ºæ ‡å¿—ä½ æœ‰ç¬¦å·æ•°æº¢å‡ºæ—¶ç½®1 DF Direction Flag æ–¹å‘æ ‡å¿—ä½ ä¸º1æ—¶ä»é«˜ä½åˆ°ä½ä½å¤„ç†å­—ç¬¦ä¸²ï¼Œstdæ‰“å¼€ï¼Œcldå…³é—­ IF Interrupt Flag ä¸­æ–­æ ‡å¿—ä½ ä¸º1æ—¶å¯ä»¥å“åº”ä¸­æ–­è¯·æ±‚ï¼Œstiæ‰“å¼€ï¼Œcliå…³é—­ TF Trap Flag é™·é˜±æ ‡å¿—ä½ ä¸º1æ—¶ä¼šè§¦å‘å¼‚å¸¸ï¼Œè¢«è°ƒè¯•å™¨æ•è·ï¼Œç”¨äºå•æ­¥è°ƒè¯• JCCæŒ‡ä»¤ TESTæŒ‡ä»¤ï¼šTEST op1,op2 å°†ä¸¤ä¸ªæ“ä½œæ•°è¿›è¡Œ&amp;æ“ä½œï¼ˆop1 &amp; op2ï¼‰å¹¶æ›´æ–°æ ‡å¿—ä½ï¼š CF=0ï¼ŒOF=0 &amp;ç»“æœä¸º0ï¼šZF=1 ç»“æœæœ€é«˜ä½ä¸º1ï¼šSF=1 CMPæŒ‡ä»¤ï¼šCMP op1,op2 è¿›è¡Œå‡æ³•æ“ä½œï¼ˆop1 - op2ï¼‰å¹¶æ›´æ–°æ ‡å¿—ä½ï¼š è‹¥op1 &lt; op2ï¼ˆå‘ç”Ÿå€Ÿä½ï¼‰ï¼ŒCF=1 è‹¥å‘ç”Ÿæœ‰ç¬¦å·æº¢å‡ºï¼ŒOF=1 op1 == op2ï¼ˆç»“æœä¸º0ï¼‰ï¼ŒZF=1 op1 &lt; op2ï¼ˆç»“æœä¸ºè´Ÿæ•°ï¼‰ï¼ŒSF=1 JCCæŒ‡ä»¤ï¼šJCC Label æŒ‡ä»¤ æ¡ä»¶ æè¿° JMP æ— æ¡ä»¶ æ— æ¡ä»¶è·³è½¬ JE / JZ ZF=1 Jump if Equal / Jump if ZF JNE / JNZ ZF=0 Jump if Not Equal / Jump if Not ZF JS SF=1 Jump if SF JNS SF=0 Jump if Not SF JP / JPE PF=1 Jump if PF / Jump if Parity Even JNP / JPO PF=0 Jump if Not PF / Jump if Parity Odd JO OF=1 Jump if OF JNO OF=0 Jump if Not OF JB / JNAE / JC CF=1 Jump if Below / Jump if Not Above or Equal / Jump if CF JNB / JAE / JNC CF=0 Jump if Not Below / Jump if Above or Equal / Jump if Not CF JBE / JNA CF=1 æˆ– ZF=1 Jump if Below or Equal / Jump if Not Above JA / JNBE CF=0 ä¸” ZF=0 Jump if Above / Jump if Not Below or Equal JL / JNGE SF â‰  OF Jump if Less / Jump if Not Greater or Equal JGE / JNL SF = OF Jump if Greater or Equal / Jump if Not Less JLE / JNG ZF=1 æˆ– SF â‰  OF Jump if Less or Equal / Jump if Not Greater JG / JNLE ZF=0 ä¸” SF = OF Jump if Greater / Jump if Not Less or Equal","link":"/2025/07/07/Day2-%E5%AF%BB%E5%9D%80%E6%96%B9%E5%BC%8F/"},{"title":"Day4:Linuxæ±‡ç¼–æ¡†æ¶ã€æ“ä½œç³»ç»Ÿä¸æ±‡ç¼–å™¨ã€ä¸»å‡½æ•°è·³è½¬æµç¨‹","text":"Linuxæ±‡ç¼–æ¡†æ¶ã€æ“ä½œç³»ç»Ÿä¸æ±‡ç¼–å™¨ã€ä¸»å‡½æ•°è·³è½¬æµç¨‹ Linux(NASM)æ±‡ç¼–æ¡†æ¶ Linuxå’ŒWindowsçš„ä¸åŒä¸»è¦æœ‰ï¼š ç³»ç»Ÿè°ƒç”¨æ–¹å¼ä¸åŒï¼š Windowsæä¾›APIï¼Œå¯ä»¥ç›´æ¥åˆ©ç”¨ç³»ç»Ÿå‡½æ•° Linuxéœ€è¦ç”¨ç³»ç»Ÿè°ƒç”¨å·è§¦å‘ç³»ç»Ÿè°ƒç”¨ã€‚ç³»ç»Ÿè°ƒç”¨å·å­˜å…¥ç‰¹å®šå¯„å­˜å™¨åä½¿ç”¨è§¦å‘æŒ‡ä»¤ï¼Œè§¦å‘ç³»ç»Ÿè°ƒç”¨ è§¦å‘æŒ‡ä»¤ï¼š â€‹ 32ä½(x86)ï¼šint 0x80 â€‹ 64ä½(x64)ï¼šsyscall å‚æ•°ä¼ é€’ï¼š â€‹ 32ä½ï¼šeaxï¼ˆç³»ç»Ÿè°ƒç”¨å·ï¼‰ï¼Œebxã€ecxã€edxã€esiã€ediã€ebpï¼ˆå‚æ•°ï¼‰ã€‚ â€‹ 64ä½ï¼šraxï¼ˆç³»ç»Ÿè°ƒç”¨å·ï¼‰ï¼Œrdiã€rsiã€rdxã€r10ã€r8ã€r9ï¼ˆå‚æ•°ï¼‰ã€‚ 32ä½ä¸‹exitç¤ºä¾‹ï¼š 12mov eax,1 ;32ä½ä¸‹ï¼Œexitçš„ç³»ç»Ÿè°ƒç”¨å·ä¸º1int 0x80 ;ç³»ç»Ÿè°ƒç”¨å·å­˜å…¥å¯„å­˜å™¨åï¼Œè§¦å‘ç³»ç»Ÿè°ƒç”¨ å¯æ‰§è¡Œæ–‡ä»¶æ ¼å¼ä¸åŒï¼š Windowsä½¿ç”¨PEæ–‡ä»¶æ ¼å¼ Linuxä½¿ç”¨ELFæ–‡ä»¶æ ¼å¼ å…¶ä»–ç»†èŠ‚ï¼š Linuxåœ¨æ®µåå‰å¿…é¡»æ·»åŠ sectionï¼Œåªæœ‰.textæ®µæ²¡æœ‰.codeæ®µï¼ˆå®é™…ä¸Šç”±æ±‡ç¼–å™¨å†³å®šï¼Œè¯¦è§ä¸‹ä¸€éƒ¨åˆ†ï¼‰ Linuxä½¿ç”¨0xAä½œä¸ºå­—ç¬¦ä¸²ç»“æŸç¬¦ 32ä½æ±‡ç¼–æ¡†æ¶ 12345678910111213141516section .data msg db &quot;HelloWorld&quot;,0xA len equ $ - msg ;ç”¨å˜é‡lenè®°å½•msgçš„é•¿åº¦ï¼ˆ$è¡¨ç¤ºå½“å‰å˜é‡çš„åœ°å€ï¼Œå‡å»msgçš„åœ°å€å°±æ˜¯msgçš„é•¿åº¦ï¼‰ section .text global _start_start: mov eax,4 ;eaxå­˜æ”¾ç³»ç»Ÿè°ƒç”¨å·4ï¼šsys_write mov ebx,1 ;å‚æ•°1ï¼šæ–‡ä»¶æè¿°ç¬¦ï¼Œ1è¡¨ç¤ºæ ‡å‡†è¾“å‡ºstdout mov ecx,msg ;å‚æ•°2ï¼šè¦æ‰“å°çš„æ•°æ®åœ°å€ mov edx,len ;å‚æ•°3ï¼šæ‰“å°çš„å­—èŠ‚æ•° int 0x80 mov eax,1 ;eaxå­˜æ”¾ç³»ç»Ÿè°ƒç”¨å·1ï¼šsys_exit mov ebx,0 ;å‚æ•°1ï¼šé€€å‡ºçŠ¶æ€ç ï¼ˆ0è¡¨ç¤ºæˆåŠŸï¼‰ int 0x80 64ä½æ±‡ç¼–æ¡†æ¶ 12345678910111213141516section .data msg db &quot;HelloWorld&quot;,0xA len equ $ - msg section .text global _start_start: mov rax,1 ;raxå­˜æ”¾ç³»ç»Ÿè°ƒç”¨å·1ï¼šsys_write mov rdi,1 ;å‚æ•°1ï¼šæ–‡ä»¶æè¿°ç¬¦ï¼Œ1è¡¨ç¤ºæ ‡å‡†è¾“å‡ºstdout mov rsi,msg ;å‚æ•°2ï¼šè¦æ‰“å°çš„æ•°æ®åœ°å€ mov rdx,len ;å‚æ•°3ï¼šæ‰“å°çš„å­—èŠ‚æ•° syscall mov rax,60 ;raxå­˜æ”¾ç³»ç»Ÿè°ƒç”¨å·60ï¼šsys_exit xor rdi,rdi ;å‚æ•°1ï¼šé€€å‡ºçŠ¶æ€ç ï¼ˆ0è¡¨ç¤ºæˆåŠŸï¼‰ syscall æ“ä½œç³»ç»Ÿä¸æ±‡ç¼–å™¨ Windowsï¼šä¸»è¦æœ‰MASMå’ŒNASMä¸¤ç§æ±‡ç¼–å™¨ MASMï¼ˆMicrosoft Macro Assemblerï¼‰ï¼Œä¸»è¦é›†æˆåœ¨visual studioä¸­ æ®µåå‰ä¸è¦æ±‚åŠ sectionï¼Œå¯ä»¥ç›´æ¥ç”¨ .æ®µå å£°æ˜ æŒ‡ä»¤å­˜æ”¾åœ¨.codeæ®µ .codeæ®µï¼Œå‡½æ•°ä»¥ func_name proc å¼€å§‹ï¼Œä»¥ func_name endp ç»“æŸ ä½¿ç”¨Intelé£æ ¼ï¼Œå³ æŒ‡ä»¤ ç›®æ ‡æ“ä½œæ•°ï¼Œæºæ“ä½œæ•° NASMï¼ˆNetwide Assemblerï¼‰ï¼Œè·¨å¹³å°æ±‡ç¼–å™¨ï¼Œæ”¯æŒWindowsã€Linuxã€macOS æ®µåå‰è¦æ±‚åŠ sectionï¼Œç”¨ sectino .æ®µå å£°æ˜ æŒ‡ä»¤å­˜æ”¾åœ¨.textæ®µ .textæ®µï¼Œå‡½æ•°ç”¨ global func_name å£°æ˜åå†å®šä¹‰ ä½¿ç”¨Intelé£æ ¼ Linuxï¼šä¸»è¦æœ‰NASMå’ŒGASä¸¤ç§æ±‡ç¼–å™¨ NASMåŒä¸Š GASï¼ˆGNU Assemblerï¼‰ï¼ŒLinuxé»˜è®¤æ±‡ç¼–å™¨ æ®µåå‰è¦æ±‚åŠ .sectionï¼Œç”¨ .section .æ®µå å£°æ˜ æŒ‡ä»¤å­˜æ”¾åœ¨.textæ®µ .textæ®µï¼Œå‡½æ•°ç”¨ .global func_name å£°æ˜åå†å®šä¹‰ ä½¿ç”¨AT&amp;Té£æ ¼ï¼Œå³ æŒ‡ä»¤ æºæ“ä½œæ•°ï¼Œç›®æ ‡æ“ä½œæ•° ä¸»å‡½æ•°è·³è½¬æµç¨‹ ç¯å¢ƒï¼švs2022ï¼ŒDebug x86/x64ï¼ŒRelease x86/x64 123456789101112131415161718192021222324252627;x86 debug è·³è½¬ç‰¹å¾;step1jmp ;ç›´æ¥jmp;step2call ;ç¬¬ä¸€ä¸ªcall;step3callcall &lt;-- ;è¿ç»­ä¸¤ä¸ªcallï¼Œè¿›ç¬¬äºŒä¸ª;step42*jz--&gt;callmovcall ;ä¸¤ä¸ªjzæŒ‡å‘çš„åŒä¸€ä¸ªcallä¸”æ­¤callåç´§è·Ÿmovå’Œcall;step5movpushmovpushmovpushcall ;è¿ç»­push3ä¸ªå‚æ•°å…¥æ ˆåçš„call;step6jmp 12345678910;x86 Release è·³è½¬ç‰¹å¾;step1calljmp ;callåçš„jmp;step2pushpushpushcall ;è¿ç»­push3ä¸ªå‚æ•°å…¥æ ˆåçš„call 1234567891011121314151617181920212223242526;x64 Debug è·³è½¬ç‰¹å¾ ;step1jmp ;ç›´æ¥jmp;step2call ;ç¬¬ä¸€ä¸ªcall;step3callcall &lt;-- ;è¿ç»­ä¸¤ä¸ªcallè¿›ç¬¬äºŒä¸ª;step42*jz--&gt;callmovcall ;ä¸¤ä¸ªjzæŒ‡å‘çš„åŒä¸€ä¸ªcallä¸”æ­¤callåç´§è·Ÿmovå’Œcall;step5movmovmovmovmovcall ;è¿ç»­5ä¸ªmovåçš„callï¼ˆä¼ å‚ï¼‰;step6jmp ;ç›´æ¥jmp 123456789101112;x64 Release è·³è½¬ç‰¹å¾ ;step1calljmp ;callåçš„jmp;step2movmovmovcallmovcall ;ä¸‰ä¸ªmovåçš„callï¼ˆä¼ å‚ï¼‰ä¸”æ­¤callåç´§è·Ÿmovå’Œcall","link":"/2025/07/11/Day4-Linux%E6%B1%87%E7%BC%96%E6%A1%86%E6%9E%B6/"},{"title":"Day3:å‡½æ•°ä¸æ ˆå¸§ã€æ•°ç»„ä¸ä¸²æŒ‡ä»¤ã€å®ä¸ç»“æ„ä½“ã€x64æ±‡ç¼–æ¡†æ¶ã€å†…è”æ±‡ç¼–ä¸æ··åˆç¼–ç¨‹","text":"å‡½æ•°ä¸æ ˆå¸§ã€æ•°ç»„ä¸ä¸²æŒ‡ä»¤ã€å®ä¸ç»“æ„ä½“ã€x64æ±‡ç¼–æ¡†æ¶ã€å†…è”æ±‡ç¼–ä¸æ··åˆç¼–ç¨‹ å‡½æ•°ä¸æ ˆå¸§ â€œæ ˆâ€œæ˜¯å†…å­˜ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œå¯ä»¥ç†è§£ä¸ºè¿ç»­çš„ä¸€å—å†…å­˜ï¼Œå®ƒä¸ºç¨‹åºè¿è¡Œæä¾›äº†ä¸€ä¸ªæš‚æ—¶çš„å­˜æ”¾æ•°æ®çš„åœ°æ–¹ï¼Œåœ°å€ã€æ•°æ®ç­‰å¯ä»¥é€šè¿‡pushæŒ‡ä»¤ä»å¯„å­˜å™¨ä¸­è¢«å¤åˆ¶åˆ°æ ˆä¸­ï¼Œè¿›è€Œå¯„å­˜å™¨å¯ä»¥è¿›è¡Œå…¶ä»–æ“ä½œï¼Œç­‰åˆ°è¿™äº›æ•°æ®å†æ¬¡è¢«éœ€è¦æ—¶å†ä»æ ˆä¸­è¢«popå‡ºæ¥ã€‚æ ˆéµå¾ªå…ˆè¿›åå‡ºçš„è§„åˆ™ï¼Œå…ˆpushçš„åœ¨é«˜åœ°å€ï¼Œåpushçš„åœ¨ä½åœ°å€ åœ¨ç¨‹åºè¿è¡Œæ—¶ï¼Œæ¯ä¸ªå‡½æ•°éƒ½ä¼šæ‹¥æœ‰ç‹¬ç«‹çš„æ ˆå¸§ï¼Œå³ç‹¬ç«‹çš„æ ˆä¸Šçš„ä¸€éƒ¨åˆ†ç©ºé—´ã€‚æœ‰ä¸¤ä¸ªå¯„å­˜å™¨ï¼Œespï¼Œebpï¼ˆx86å³32ä½ç¯å¢ƒä¸‹ï¼‰è´Ÿè´£ç»´æŠ¤å‡½æ•°çš„æ ˆç©ºé—´ã€‚ebpå­˜æ”¾çš„æ˜¯å‡½æ•°æ ˆç©ºé—´çš„æ ˆåŸºå€ï¼Œespå­˜æ”¾çš„æ˜¯å‡½æ•°æ ˆç©ºé—´çš„æ ˆé¡¶ã€‚å¯ä»¥ç†è§£ä¸ºebpæ˜¯æŒ‡å‘å‡½æ•°æ ˆç©ºé—´æœ€é«˜ä½çš„ä¸€ä¸ªæŒ‡é’ˆï¼ˆå› ä¸ºæ ˆç©ºé—´ä»é«˜åœ°å€å¼€å§‹åˆ†é…ï¼Œå› æ­¤æŒ‡å‘çš„æ˜¯æœ€é«˜ä½ï¼Œä½†æ˜¯æ˜¯æ ˆç©ºé—´çš„èµ·å§‹åœ°å€ï¼‰ï¼Œè€Œespæ˜¯æŒ‡å‘å‡½æ•°æ ˆç©ºé—´æœ€ä½ä½çš„ä¸€ä¸ªæŒ‡é’ˆï¼ˆæŒ‡å‘çš„æ˜¯æœ€ä½ä½ï¼Œä½†æ˜¯ä¼šéšç€åç»­æ ˆç©ºé—´çš„æ‰©å……è€Œå˜åŒ–ï¼‰ã€‚ CALLæŒ‡ä»¤ï¼š 123;callä¸€ä¸ªå‡½æ•°çš„æ—¶å€™ï¼Œä¼šå‘ç”Ÿä»¥ä¸‹å†…å®¹push è¿”å›åœ°å€ï¼ˆcallæ‰€åœ¨æŒ‡ä»¤çš„ä¸‹ä¸€æ¡ï¼‰jmp ç›®æ ‡å‡½æ•°åœ°å€ RETæŒ‡ä»¤ï¼š 12;å‡½æ•°ç»“æŸæ—¶ï¼ŒRETæŒ‡ä»¤ä¼šå‘ç”Ÿä»¥ä¸‹å†…å®¹pop eip ;ä»æ ˆä¸Šå¼¹å‡ºè¿”å›åœ°å€åˆ°eipï¼ˆä¿å­˜ä¸‹ä¸€æ­¥æŒ‡ä»¤åœ°å€çš„å¯„å­˜å™¨ï¼‰ æ ˆå¸§ï¼š 1234567;è·³è½¬åˆ°æ¯ä¸€ä¸ªå‡½æ•°ï¼Œä¼šå‘ç”Ÿä»¥ä¸‹å†…å®¹ä»¥å¼€è¾Ÿæ ˆå¸§push ebp ;æŠŠä¸Šä¸€ä¸ªå‡½æ•°çš„ebpå€¼æ”¾åˆ°æ ˆä¸Šmov ebp,esp ;æŠŠespå€¼ç»™ebpï¼Œå¼€è¾Ÿæ–°å‡½æ•°çš„æ ˆå¸§;å‡½æ•°æ‰§è¡Œå®Œæ¯•åï¼Œä¼šå‘ç”Ÿä»¥ä¸‹å†…å®¹æ¸…ç†æ ˆå¸§mov esp,ebp ;æŠŠebpå€¼ç»™espï¼Œæ¸…ç†å‡½æ•°æ ˆå¸§pop ebp ;æ¢å¤ebpåŸæ¥çš„å€¼ï¼Œå³ä¸Šä¸€ä¸ªå‡½æ•°çš„ebpret æ•°ç»„ä¸ä¸²æŒ‡ä»¤ å£°æ˜æ•°ç»„ï¼š 123.data ;åœ¨æ•°æ®æ®µå£°æ˜ szHello db 'HelloWorld',0 ;å£°æ˜ä¸€ä¸ªå­—ç¬¦ä¸² nNumber dd 20 dup(0) ;å£°æ˜ä¸€ä¸ªDWORDæ•°ç»„ï¼Œ20ä½ï¼Œä½¿ç”¨dup()åˆå§‹åŒ–æ•°ç»„å†…å®¹ä¸º0 ä½¿ç”¨æ•°ç»„åŸºå€çš„å‡ ç§æ–¹å¼ï¼š 12lea eax,szHellomov ebx,offset Nnumber è®¿é—®æ•°ç»„æˆå‘˜ï¼š 1234567891011;[æ•°ç»„èµ·å§‹åœ°å€+ç´¢å¼•å¯„å­˜å™¨*æ¯”ä¾‹å› å­+åç§»é‡]ï¼ˆç´¢å¼•å¯„å­˜å™¨ç”¨æ¥å­˜æ”¾ç´¢å¼•å€¼ï¼Œæ¯”ä¾‹å› å­å¯¹åº”ç±»å‹çš„å­—èŠ‚å¤§å°ï¼Œåç§»é‡å¯ç”¨äºç»“æ„ä½“æ•°ç»„ç­‰åœºæ™¯ï¼‰;å¦‚ï¼šmov ebx,offset Array ;æŠŠæ•°ç»„åŸºå€ç»™ebxmov esi,0 ;esiç”¨æ¥å½“ç´¢å¼•å¯„å­˜å™¨mov ecx,10 ;ecxç”¨æ¥æ”¾ç´¢å¼•ä¸Šé™ï¼ˆecxå¸¸ç”¨ä½œè®¡æ•°å™¨ï¼‰loop_start: ;åˆ›å»ºä¸€ä¸ªå¾ªç¯ mov eax,[ebx+esi*4] ;å–å‡ºæ•°ç»„å†…å®¹æ”¾åˆ°eaxä¸­ add esi,1 ;ç´¢å¼•é€’å¢ cmp esi,ecx ;ä¸ç´¢å¼•ä¸Šé™æ¯”è¾ƒï¼Œåˆ¤æ–­æ˜¯å¦éå†å®Œæ•°ç»„ jl loop_start ;è¿˜æ²¡éå†å®Œæ•°ç»„å°±å¾ªç¯æ“ä½œï¼Œjumpåˆ°loop_startå†èµ°ä¸€é ä¸²æŒ‡ä»¤ï¼š 1234;stosç³»åˆ—:stosb,stosw,stosd,stosqï¼ˆåˆ†åˆ«å¯¹åº”byte,word,dword,qword,åŠŸèƒ½æ˜¯æŠŠal/ax/eax/raxä¸­çš„å†…å®¹å­˜åˆ°edi/rdiï¼‰;lodsç³»åˆ—:lodsb,lodsw,lodsd,lodsqï¼ˆåŒæ ·åˆ†åˆ«å¯¹åº”å››ä¸ªç±»å‹ï¼ŒåŠŸèƒ½æ˜¯æŠŠesi/rsiçš„å†…å®¹åŠ è½½åˆ°al/ax/eax/raxä¸­ï¼‰;movsç³»åˆ—:movsb,movsw,movsd,movsqï¼ˆåŒæ ·åˆ†åˆ«å¯¹åº”å››ä¸ªç±»å‹ï¼ŒåŠŸèƒ½æ˜¯æŠŠesiçš„å†…å®¹å¤åˆ¶åˆ°ediä¸­ï¼‰;cmpsç³»åˆ—:cmpsb,cmpsw,cmpsd,cmpsqï¼ˆåŒæ ·åˆ†åˆ«å¯¹åº”å››ä¸ªç±»å‹ï¼ŒåŠŸèƒ½æ˜¯æ¯”è¾ƒesiå’Œediçš„å†…å®¹å¹¶è®¾ç½®æ ‡å¿—ä½ï¼‰ å®ä¸ç»“æ„ä½“ å®ï¼š 12345678;æ— å‚å®ä½¿ç”¨å…³é”®å­—EQUï¼Œå¦‚PI EQU 3 ;å®šä¹‰PI=3;å«å‚å®ä½¿ç”¨å…³é”®å­—MACROï¼Œç”¨endmç»“å°¾ï¼Œå¦‚Myadd MACRO Number add eax,Numberendm ;å®šä¹‰Myaddå‡½æ•°å®ç°eaxåŠ ä¸Šå‚æ•°;å«å‚å®çš„è°ƒç”¨ï¼šMyadd&lt;å‚æ•°&gt; ç»“æ„ä½“ï¼š 1234567891011;ä½¿ç”¨å…³é”®å­—structå’Œendsï¼Œå¦‚Point struct x word ? y word ?Point ends;å®ä¾‹åŒ–ç»“æ„ä½“MyPoint Point&lt;?&gt; ;å®ä¾‹åŒ–å‡ºMyPoint;è®¿é—®ç»“æ„ä½“æˆå‘˜mov MyPoint.x,123 x64æ±‡ç¼–æ¡†æ¶(MASM)1234567891011121314151617181920212223242526272829303132333435363738;x64ç¯å¢ƒä¸‹çš„ä»£ç ï¼Œä¼ å‚çš„æ—¶å€™å…ˆä½¿ç”¨å¯„å­˜å™¨(Windows:rcx,rdx,r8,r9 Linux:rdi,rsi,rdx,rcx,r8,r9)å†ä½¿ç”¨æ ˆ.code;Addå‡½æ•°å£°æ˜Add proc push rbp mov rbp,rsp lea rax,[rdi + rsi] ;ä»å¯„å­˜å™¨ä¸­å–å‚æ•° pop rbp retAdd endpmain proc mov rdi,2 ;æŠŠå‚æ•°ä¼ å…¥å¯„å­˜å™¨ä¸­ mov rsi,3 call Add retmain endpend;x86ç¯å¢ƒä¸‹çš„ä»£ç ï¼Œä¼ å‚ä½¿ç”¨æ ˆ.code;Addå‡½æ•°å£°æ˜Add proc push ebp mov ebp,esp mov eax,[esp+8] ;ä»æ ˆä¸Šå–å‚æ•° add eax,[esp+12] pop ebp retAdd endpmain proc push 3 ;æŠŠå‚æ•°å‹å…¥æ ˆä¸­ push 2 call Add add esp,8main endp å†…è”æ±‡ç¼–ä¸æ··åˆç¼–ç¨‹ x86ä¸‹ï¼Œåœ¨Microsoft Visual C++ (MSVC)ç¨‹åºä¸­ä½¿ç”¨æ±‡ç¼–ï¼Œå¯ä»¥é€šè¿‡_asm{}ç›´æ¥å†™åœ¨C++ä»£ç ä¸­: 123456789#include&lt;iostream&gt;int main(){ _asm{ xor eax,eax mov eax,1 add eax,1 } return 0;} x64ä¸‹ï¼Œåœ¨Microsoft Visual C++ (MSVC)ç¨‹åºä¸­ä½¿ç”¨æ±‡ç¼–ï¼Œéœ€è¦ç‹¬ç«‹çš„asmæ–‡ä»¶ï¼Œé€šè¿‡externå£°æ˜ä½¿ç”¨ï¼š 1234567891011121314151617181920#include&lt;iostream&gt;extern &quot;C&quot; long long Add(long long number1,long long number2);int main(){ long long res=Add(1,2); std::cout&lt;&lt;res&lt;&lt;std::endl; return 0;}//asmæ–‡ä»¶.codeAdd proc push rbp mov rbp,rsp xor rax,rax add rax,rcx add rax,rdx pop rbp retAdd endpend","link":"/2025/07/08/Day3-%E5%87%BD%E6%95%B0%E4%B8%8E%E5%A0%86%E6%A0%88/"},{"title":"0xGame2025Week4WriteUp","text":"0xGame2025 Week4 Reverseæ–¹å‘å…¨è§£&amp;è¯¦è§£ é•œæ¸ŠæŠ˜æ è€ƒç‚¹ï¼šnativeå±‚é€†å‘ï¼ŒAES é™„ä»¶apkè¿è¡Œèµ·æ¥æ˜¯è¿™æ ·ï¼š JEBæ‰“å¼€ï¼Œå¯ä»¥å¾—åˆ°ä¸‹é¢è¿™äº›MainActivityå’Œç›¸å…³å‡½æ•°çš„å†…å®¹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118package com.example.easynative;import android.content.Context;import android.os.Bundle;import android.view.View;import android.widget.Button;import android.widget.EditText;import android.widget.Toast;import androidx.activity.ComponentActivity;import java.io.InputStream;import kotlin.Metadata;import kotlin.io.ByteStreamsKt;import kotlin.jvm.internal.Intrinsics;@Metadata(d1 = {&quot;\\u0000\\u0018\\n\\u0002\\u0018\\u0002\\n\\u0002\\u0018\\u0002\\n\\u0002\\b\\u0002\\n\\u0002\\u0010\\u0002\\n\\u0000\\n\\u0002\\u0018\\u0002\\n\\u0000\\b\\u0007\\u0018\\u00002\\u00020\\u0001B\\u0005Â¢\\u0006\\u0002\\u0010\\u0002J\\u0012\\u0010\\u0003\\u001A\\u00020\\u00042\\b\\u0010\\u0005\\u001A\\u0004\\u0018\\u00010\\u0006H\\u0014Â¨\\u0006\\u0007&quot;}, d2 = {&quot;Lcom/example/easynative/MainActivity;&quot;, &quot;Landroidx/activity/ComponentActivity;&quot;, &quot;()V&quot;, &quot;onCreate&quot;, &quot;&quot;, &quot;savedInstanceState&quot;, &quot;Landroid/os/Bundle;&quot;, &quot;app_release&quot;}, k = 1, mv = {1, 9, 0}, xi = 0x30)public final class MainActivity extends ComponentActivity { public static final int $stable; static { } @Override // androidx.activity.ComponentActivity protected void onCreate(Bundle arg3) { super.onCreate(arg3); this.setContentView(layout.activity_main); EditText v3 = (EditText)this.findViewById(id.flagInput); ((Button)this.findViewById(id.button)).setOnClickListener((View arg2) -&gt; MainActivity.onCreate$lambda$0(v3, this, arg2)); } private static final void onCreate$lambda$0(EditText arg2, MainActivity arg3, View arg4) { Intrinsics.checkNotNullParameter(arg3, &quot;this$0&quot;); String v2 = arg2.getText().toString(); InputStream v4 = arg3.getAssets().open(&quot;secret.bin&quot;); Intrinsics.checkNotNullExpressionValue(v4, &quot;open(...)&quot;); byte[] v4_1 = ByteStreamsKt.readBytes(v4); if(((CharSequence)v2).length() &gt; 0) { Context v1 = (Context)arg3; if(new FlagChecker(v1, v2).check(v4_1)) { // v4ä»secret.binä¸­è¢«è¯»å–å‡ºæ¥ï¼Œè¯»å–çš„å†…å®¹ç»™äº†v4_1ä½œä¸ºcheckçš„å‚æ•°ï¼Œè¾“å…¥çš„å†…å®¹ä½œä¸ºFlagCheckerçš„ç¬¬äºŒä¸ªå‚æ•° Toast.makeText(v1, ((CharSequence)arg3.getString(string.correct)), 0).show(); return; } Toast.makeText(v1, ((CharSequence)arg3.getString(string.wrong)), 0).show(); } }}package com.example.easynative;import android.content.Context;import java.security.Key;import java.security.spec.AlgorithmParameterSpec;import javax.crypto.Cipher;import javax.crypto.spec.IvParameterSpec;import javax.crypto.spec.SecretKeySpec;import kotlin.Metadata;import kotlin.jvm.internal.DefaultConstructorMarker;import kotlin.jvm.internal.Intrinsics;import kotlin.text.Charsets;@Metadata(d1 = {&quot;\\u0000.\\n\\u0002\\u0018\\u0002\\n\\u0002\\u0010\\u0000\\n\\u0000\\n\\u0002\\u0018\\u0002\\n\\u0000\\n\\u0002\\u0010\\u000E\\n\\u0002\\b\\u0002\\n\\u0002\\u0010\\u000B\\n\\u0000\\n\\u0002\\u0010\\u0012\\n\\u0002\\b\\u0002\\n\\u0002\\u0010\\b\\n\\u0002\\b\\u0005\\b\\u0007\\u0018\\u0000 \\u00112\\u00020\\u0001:\\u0001\\u0011B\\u0015\\u0012\\u0006\\u0010\\u0002\\u001A\\u00020\\u0003\\u0012\\u0006\\u0010\\u0004\\u001A\\u00020\\u0005Â¢\\u0006\\u0002\\u0010\\u0006J\\u000E\\u0010\\u0007\\u001A\\u00020\\b2\\u0006\\u0010\\t\\u001A\\u00020\\nJ\\u0019\\u0010\\u000B\\u001A\\u00020\\b2\\u0006\\u0010\\f\\u001A\\u00020\\r2\\u0006\\u0010\\u000E\\u001A\\u00020\\nH\\u0086 J\\u001E\\u0010\\u000F\\u001A\\u00020\\n2\\u0006\\u0010\\u0004\\u001A\\u00020\\u00052\\u0006\\u0010\\u0010\\u001A\\u00020\\n2\\u0006\\u0010\\t\\u001A\\u00020\\nR\\u000E\\u0010\\u0002\\u001A\\u00020\\u0003X\\u0082\\u0004Â¢\\u0006\\u0002\\n\\u0000R\\u000E\\u0010\\u0004\\u001A\\u00020\\u0005X\\u0082\\u0004Â¢\\u0006\\u0002\\n\\u0000Â¨\\u0006\\u0012&quot;}, d2 = {&quot;Lcom/example/easynative/FlagChecker;&quot;, &quot;&quot;, &quot;context&quot;, &quot;Landroid/content/Context;&quot;, &quot;plainText&quot;, &quot;&quot;, &quot;(Landroid/content/Context;Ljava/lang/String;)V&quot;, &quot;check&quot;, &quot;&quot;, &quot;iv&quot;, &quot;&quot;, &quot;compare&quot;, &quot;length&quot;, &quot;&quot;, &quot;data&quot;, &quot;encrypt&quot;, &quot;key&quot;, &quot;Companion&quot;, &quot;app_release&quot;}, k = 1, mv = {1, 9, 0}, xi = 0x30)public final class FlagChecker { @Metadata(d1 = {&quot;\\u0000\\f\\n\\u0002\\u0018\\u0002\\n\\u0002\\u0010\\u0000\\n\\u0002\\b\\u0002\\b\\u0086\\u0003\\u0018\\u00002\\u00020\\u0001B\\u0007\\b\\u0002Â¢\\u0006\\u0002\\u0010\\u0002Â¨\\u0006\\u0003&quot;}, d2 = {&quot;Lcom/example/easynative/FlagChecker$Companion;&quot;, &quot;&quot;, &quot;()V&quot;, &quot;app_release&quot;}, k = 1, mv = {1, 9, 0}, xi = 0x30) public static final class Companion { private Companion() { } public Companion(DefaultConstructorMarker arg1) { } } public static final int $stable; public static final Companion Companion; private final Context context; private final String plainText; static { FlagChecker.Companion = new Companion(null); FlagChecker.$stable = 8; System.loadLibrary(&quot;easynative&quot;); } public FlagChecker(Context arg2, String arg3) { Intrinsics.checkNotNullParameter(arg2, &quot;context&quot;); Intrinsics.checkNotNullParameter(arg3, &quot;plainText&quot;); super(); this.context = arg2; this.plainText = arg3; // è¾“å…¥çš„å†…å®¹è¢«èµ‹å€¼ç»™plaintext } public final boolean check(byte[] arg4) { // å‚æ•°æ˜¯ä»secret.binè¯»å–çš„å†…å®¹ Intrinsics.checkNotNullParameter(((Object)arg4), &quot;iv&quot;); // arg4å³ä»secret.binè¯»å–çš„å†…å®¹è¢«æ ‡è¯†ä¸ºiv String v0 = this.context.getString(string.key); // v0ä¸ºstring.key Intrinsics.checkNotNullExpressionValue(v0, &quot;getString(...)&quot;); String v1 = this.plainText; // v1æ˜¯è¾“å…¥çš„å†…å®¹plaintext byte[] v0_1 = v0.getBytes(Charsets.UTF_8); // v0è¯»å–ä¸ºbytes Intrinsics.checkNotNullExpressionValue(((Object)v0_1), &quot;this as java.lang.String).getBytes(charset)&quot;); byte[] v4 = this.encrypt(v1, v0_1, arg4); // ä¸‰ä¸ªå‚æ•°åˆ†åˆ«ä¸ºï¼šè¾“å…¥çš„plaintextï¼Œstring.keyï¼Œä»secret.binè¯»å–çš„iv return this.compare(v4.length, v4); // compareä»nativeå±‚easynative.soå¯¼å…¥ } public final native boolean compare(int arg1, byte[] arg2) { } public final byte[] encrypt(String arg3, byte[] arg4, byte[] arg5) { Intrinsics.checkNotNullParameter(arg3, &quot;plainText&quot;); // æ­¤å¤„å†æ¬¡å¯¹å‚æ•°è¿›è¡Œäº†æ ‡è¯† Intrinsics.checkNotNullParameter(((Object)arg4), &quot;key&quot;); Intrinsics.checkNotNullParameter(((Object)arg5), &quot;iv&quot;); SecretKeySpec v0 = new SecretKeySpec(arg4, &quot;AES&quot;); // åŠ å¯†ç®—æ³•AESï¼ŒCTRæ¨¡å¼ Cipher v4 = Cipher.getInstance(&quot;AES/CTR/NoPadding&quot;); v4.init(1, ((Key)v0), ((AlgorithmParameterSpec)new IvParameterSpec(arg5))); byte[] v3 = arg3.getBytes(Charsets.UTF_8); Intrinsics.checkNotNullExpressionValue(((Object)v3), &quot;this as java.lang.String).getBytes(charset)&quot;); byte[] v3_1 = v4.doFinal(v3); Intrinsics.checkNotNull(((Object)v3_1)); return v3_1; }} å¯ä»¥çœ‹åˆ°Mainactivityä½¿ç”¨äº†FlagCheckeræ¥æ ¡éªŒï¼Œè€ŒFlagCheckerå¯¹è¾“å…¥çš„å†…å®¹è¿›è¡Œäº†AESåŠ å¯†ï¼Œç„¶åç”¨nativeå±‚çš„compareå‡½æ•°æ¥æ£€éªŒåŠ å¯†ç»“æœã€‚ä¸‹é¢æ˜¯nativeå±‚compareå‡½æ•°çš„å†…å®¹(IDAä¸­æ˜¾ç¤ºçš„å‡½æ•°åæ˜¯checkè€Œécompare)ï¼š 12345678910111213141516171819__int64 __fastcall check(JNIEnv *a1, __int64 a2, int a3, void *a4){ __int64 v5; // x0 __int64 i; // x9 int v7; // w11 int v8; // w10 v5 = (__int64)(*a1)-&gt;GetByteArrayElements(a1, a4, 0LL); if ( a3 != 48 ) return 0LL; for ( i = 0LL; i != 48; ++i ) { v7 = (unsigned __int8)byte_5A2[i]; v8 = *(unsigned __int8 *)(v5 + i) ^ (unsigned __int8)i; if ( v8 != v7 ) return 0LL; } return 1LL;} å¯ä»¥çœ‹åˆ°compareå‡½æ•°æ˜¯å…ˆæ‹¿AESåŠ å¯†ç»“æœå¼‚æˆ–ç´¢å¼•åæ‰è¿›è¡Œæ ¡éªŒçš„ï¼Œæ‰€ä»¥è§£å¯†åº”è¯¥æ‹¿compareä¸­çš„å¯†æ–‡å’Œç´¢å¼•å¼‚æˆ–å¾—åˆ°AESåŠ å¯†çš„æ•°æ®ï¼Œç„¶åæ‰¾å‡ºkeyå’Œivè¿›è¡ŒAESè§£å¯†ã€‚ è„šæœ¬ï¼š 12345678910111213from Crypto.Cipher import AESenc=[0x38, 0xEA, 0x9A, 0x5A, 0x3C, 0xFB, 0x0C, 0x98, 0x1A, 0x66, 0x8B, 0x46, 0x6A, 0x06, 0x19, 0x08, 0x41, 0xCB, 0x36, 0x9E, 0x16, 0xC5, 0xBE, 0x2F, 0xF0, 0x9D, 0xBF, 0xA7, 0x34, 0x67, 0x51, 0x4C, 0xE5, 0xC2, 0x78, 0xA5, 0x0F, 0x35, 0xFC, 0x1D, 0x39, 0x8B, 0x49, 0x38, 0x34, 0x69, 0x30, 0xF7]#å…ˆå¯¹æ•°æ®è¿›è¡Œå¼‚æˆ–è¿˜åŸfor i in range(len(enc)): enc[i]=enc[i]^i#æå–AESç›¸å…³å‚æ•°key=b&quot;0xgame-SecretKey&quot;iv=bytes.fromhex(&quot;8A A5 61 0C 74 41 1B 11 A3 53 68 DE 56 BF 6A B3&quot;)#AESè§£å¯†cipher=AES.new(key, AES.MODE_CTR, nonce=b'', initial_value=iv)flag=cipher.decrypt(bytes(enc))print(&quot;flag: &quot;,flag.decode()) flagï¼š0xGame{Native_1s_also_1nt3r3st1ng_ef492d80a257c} å¤œé›€ä¹‹æ­Œ è€ƒç‚¹ï¼šè¿·å®«é¢˜ï¼ŒåŠ¨æ€è°ƒè¯•ï¼Œåè°ƒè¯• é™„ä»¶ç¨‹åºè¿è¡Œèµ·æ¥æ˜¯è¿™æ ·çš„ï¼š ç”¨IDAæ‰“å¼€ï¼Œé€šè¿‡Shift+F12å­—ç¬¦ä¸²çª—å£å¯ä»¥æ‰¾åˆ°ä¸€äº›ä¿¡æ¯å®šä½mainå‡½æ•°çš„ä½ç½® mainå‡½æ•°æœ‰ä¸€å¤§ä¸²çš„å¾ªç¯è¯­å¥ï¼Œç»“åˆä¸Šå›¾ç»ˆç«¯è¾“å‡ºçš„WASDå¯ä»¥æ¨æµ‹è¿™æ˜¯ä¸€é“è¿·å®«é€†å‘é¢˜ã€‚#æ˜¯è¿·å®«çš„å¢™ï¼Œç»ˆç«¯æ˜¾ç¤ºçš„æ˜¯è¿·å®«çš„ä¸€å°éƒ¨åˆ†ï¼Œåœ¨ç»ˆç«¯æŒ‰ä¸‹WASDå¯ä»¥æ§åˆ¶Pç§»åŠ¨ã€‚æ‰€ä»¥ç¬¬ä¸€æ­¥è¦æå–è¿·å®« 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889//mainå‡½æ•°__int64 sub_7FF6645A1D2B(){ int v0; // eax int v1; // eax int v2; // eax int v3; // eax int v5; // [rsp+28h] [rbp-8h] int v6; // [rsp+2Ch] [rbp-4h] sub_7FF7EC581FC0(); sub_7FF7EC581B30(); sub_7FF7EC5815B6(); v6 = 0; do { sub_7FF7EC581C5F(); sub_7FF7EC5815B6(); puts(&amp;aWasdEsc); v5 = getch(); sub_7FF7EC583060(&quot;%c\\n&quot;, (unsigned int)v5); if ( v5 == 119 ) {LABEL_19: sub_7FF7EC581BB7(0LL, 0xFFFFFFFFLL); v0 = v6++; byte_7FF7EC58E0E0[v0] = 119; continue; } if ( v5 &lt;= 119 ) { if ( v5 == 115 ) goto LABEL_22; if ( v5 &lt;= 115 ) { if ( v5 == 100 ) goto LABEL_21; if ( v5 &lt;= 100 ) { if ( v5 == 97 ) goto LABEL_20; if ( v5 &lt;= 97 ) { if ( v5 == 87 ) goto LABEL_19; if ( v5 &lt;= 87 ) { if ( v5 == 83 ) {LABEL_22: sub_7FF7EC581BB7(0LL, 1LL); v3 = v6++; byte_7FF7EC58E0E0[v3] = 115; continue; } if ( v5 &lt;= 83 ) { if ( v5 == 68 ) {LABEL_21: sub_7FF7EC581BB7(1LL, 0LL); v2 = v6++; byte_7FF7EC58E0E0[v2] = 100; continue; } if ( v5 &lt;= 68 ) { if ( v5 == 27 ) return 0LL; if ( v5 == 65 ) {LABEL_20: sub_7FF7EC581BB7(0xFFFFFFFFLL, 0LL); v1 = v6++; byte_7FF7EC58E0E0[v1] = 97; } } } } } } } } } while ( dword_7FF7EC58E0C4 != dword_7FF7EC58E0D4 || dword_7FF7EC58E0C8 != dword_7FF7EC58E0D8 ); sub_7FF7EC583060(&quot;Congratulations your flag is: 0xGame{md5(your_path)} (lowercase)&quot;); return 0LL;} ç‚¹è¿›LABEL_19ä¸‹çš„ç¬¬ä¸€ä¸ªå‡½æ•°å¯ä»¥çœ‹åˆ°ä¸€ä¸ªæ¯”è¾ƒé€»è¾‘ 12345678910111213141516171819202122__int64 __fastcall sub_7FF7EC581BB7(int a1, int a2){ int v3; // [rsp+24h] [rbp-Ch] int v4; // [rsp+28h] [rbp-8h] int v5; // [rsp+2Ch] [rbp-4h] v5 = dword_7FF7EC58E0C4 + a1; v4 = dword_7FF7EC58E0C8 + a2; v3 = dword_7FF7EC58E0C4 + a1 + 101 * (dword_7FF7EC58E0C8 + a2); if ( byte_7FF7EC589040[v3] == 35 )//æ¯”è¾ƒé€»è¾‘ { puts(&quot;ä¸èƒ½ç§»åŠ¨åˆ°å¢™å£&quot;); } else { byte_7FF7EC589040[101 * dword_7FF7EC58E0C8 + dword_7FF7EC58E0C4] = 32; dword_7FF7EC58E0C4 = v5; dword_7FF7EC58E0C8 = v4; byte_7FF7EC589040[v3] = 80; } return 0LL;} åœ¨Hex Viewè·Ÿéšæ¯”è¾ƒé€»è¾‘ä¸­çš„è¿™ä¸ªæ•°ç»„çš„åœ°å€(7FF7EC589040)å¯ä»¥çœ‹åˆ°è¿·å®«ï¼š ä½†æ˜¯æå–å‡ºè¿·å®«ä¼šå‘ç°ï¼Œè¿™ä¸ªè¿·å®«å’Œç›´æ¥è¿è¡Œç¨‹åºæ—¶ç»ˆç«¯æ˜¾ç¤ºçš„è¿·å®«ä¸ä¸€æ · æ¨æµ‹ç¨‹åºåŠ äº†åè°ƒè¯•ã€‚æœ€ç›´æ¥çš„ç»•è¿‡æ–¹æ³•å°±æ˜¯ç”¨xdbgè°ƒè¯•ï¼Œç”¨æ’ä»¶ScyllaHideç›´æ¥ç»•è¿‡åè°ƒè¯•æ£€æµ‹ã€‚åœ¨è½¬å‚¨æ‰¾åˆ°ç›¸åŒçš„åœ°å€å¯ä»¥å¾—åˆ°çœŸæ­£çš„è¿·å®« é€‰ä¸­è¿·å®«åœ°å›¾æ•°æ®å³é”®äºŒè¿›åˆ¶ä¿å­˜åˆ°æ–‡ä»¶ï¼ŒæŠŠæ–‡ä»¶æ ¼å¼æ”¹ä¸ºtxt ç„¶åå°±å¯ä»¥è®©AIå†™ä¸ªè§£è¿·å®«è„šæœ¬è§£å‡ºè·¯å¾„ï¼ŒæŒ‰ç…§ç¨‹åºçš„æç¤ºæŠŠè·¯å¾„è¿›è¡ŒMD5åŠ å¯†å°±å¯ä»¥å¾—åˆ°flagäº† è§£è¿·å®«è„šæœ¬ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364from collections import dequedef solve_maze(maze, start, end, wall='#', free=' '): &quot;&quot;&quot;Maze solver using BFS&quot;&quot;&quot; directions = { (-1, 0): 'w', # up (1, 0): 's', # down (0, -1): 'a', # left (0, 1): 'd' # right } rows, cols = len(maze), len(maze[0]) visited = [[False] * cols for _ in range(rows)] # BFS queue = deque([(start[0], start[1], &quot;&quot;)]) visited[start[0]][start[1]] = True while queue: row, col, path = queue.popleft() if (row, col) == end: return path for dr, dc in directions.keys(): new_row, new_col = row + dr, col + dc if (0 &lt;= new_row &lt; rows and 0 &lt;= new_col &lt; cols and not visited[new_row][new_col] and maze[new_row][new_col] != wall): visited[new_row][new_col] = True new_path = path + directions[(dr, dc)] queue.append((new_row, new_col, new_path)) return None# Load maze and solvewith open(&quot;final_maze.txt&quot;, &quot;r&quot;) as f: maze = [list(line.strip()) for line in f]start = (1, 1)end = (99, 99)print(f&quot;Maze size: {len(maze)} x {len(maze[0])}&quot;)print(f&quot;Start: {start}, End: {end}&quot;)# Solve the mazesolution = solve_maze(maze, start, end, wall='#', free=' ')if solution: print(f&quot;Solution found!&quot;) print(f&quot;Path length: {len(solution)}&quot;) # Print FULL path print(f&quot;\\nFULL PATH:&quot;) print(solution) # Save full path with open(&quot;maze_solution.txt&quot;, &quot;w&quot;) as f: f.write(solution) print(f&quot;\\nFull path saved to maze_solution.txt&quot;)else: print(&quot;No solution found!&quot;) flagï¼š0xGame{44fc4bc18c87b3992af1d7726185ed36} ç»¯æƒ³å¤©åˆ™ è€ƒç‚¹ï¼šunityé€†å‘æ”¹æ¸¸æˆæœºåˆ¶ é™„ä»¶æ˜¯ä¸ªunityæ¸¸æˆ bossè¡€æ¡å¾ˆåšï¼Œæ€ä¹ˆæ‰“éƒ½æ‰“ä¸è¿‡ï¼Œè§’è‰²å¾ˆå®¹æ˜“æ­»ã€‚æ‰€ä»¥è€ƒè™‘æ”¹æ¸¸æˆæœºåˆ¶ å‚è€ƒä»å‡ºé¢˜åˆ°åšé¢˜â€”â€”æµ…æ¢Unityæ¸¸æˆé€†å‘ï¼Œæ‰¾åˆ°IWANNATENSHIFUMOã®INESBATTLE\\I WANNA TENSHI FUMOã®FIGHT WITH INES_Data\\Managed\\Assembly-CSharp.dllï¼Œç”¨dnspyæ‰“å¼€è¿›è¡Œä¿®æ”¹ã€‚ä¿®æ”¹æ€è·¯æ˜¯ç»™è§’è‰²åŠ ä¸Šé”è¡€å’Œä¸€å‡»æ¯™å‘½buffï¼Œä¿®æ”¹çš„ç±»æ˜¯CharacterStatsï¼Œè‡³äºæ€ä¹ˆä¿®æ”¹å¯ä»¥æŠŠæ•´ä¸ªç±»çš„ä»£ç å‘ç»™AIé—®æ€ä¹ˆæ”¹é”è¡€å’Œä¸€å‡»æ¯™å‘½ï¼Œå› ä¸ºé™„ä»¶ç¨‹åºå·¥ç¨‹æ¯”è¾ƒå¤§ï¼Œæ²¡æœ‰ä¸Šä¸‹æ–‡çš„è¯ä¸å¥½æè¿°ï¼Œæ­¤å¤„çœç•¥ä¿®æ”¹æ–¹æ¡ˆäº†ã€‚ä¿®æ”¹æ–¹æ³•æ˜¯åœ¨ç±»ä»£ç é¡µå³é”®é€‰æ‹©ç¼–è¾‘ç±» ä¿®æ”¹å®Œç‚¹å‡»å³ä¸‹è§’çš„ç¼–è¯‘å³å¯ã€‚æ­¤å¤–ï¼Œç¬”è€…åœ¨ç¼–è¯‘çš„æ—¶å€™é‡åˆ°äº†ä¸€äº›æŠ¥é”™ï¼šrandomâ€™is anbiguous reference between â€˜unityengine.randomâ€™and â€˜system.randomï¼Œæ­¤æ—¶æŠŠä»£ç ä¸­æ‰€æœ‰çš„Random.Rangeéƒ½æ”¹æˆUnityEngine.Random.Rangeå³å¯ã€‚ ä¿®æ”¹å®Œæˆåï¼Œé‡æ–°è¿è¡Œæ¸¸æˆå°±å¯ä»¥é€Ÿé€šå¾—åˆ°flagäº† flagï¼š0xGame{TenshiSamaSaiko_IWANNATENSHIFUMO_INESBATTLE} å¹»è§†è°ƒå¾‹ è€ƒç‚¹ï¼šå‡½æ•°é‡å†™ï¼ŒRC4ï¼ŒTEA é™„ä»¶ç¨‹åºè¿è¡Œèµ·æ¥æ˜¯å¾ˆå¸¸è§„çš„è¾“å…¥flagæç¤ºï¼š ç”¨IDAæ‰“å¼€ï¼ŒShift+F12å¯ä»¥çœ‹åˆ°å¯ç–‘å­—ç¬¦ä¸² è·Ÿè¸ªå¯ç–‘å­—ç¬¦ä¸²å¯ä»¥æ‰¾åˆ°mainå‡½æ•° ç®€å•ä¼˜åŒ–ä¸€ä¸‹ å¯ä»¥çœ‹åˆ°å‡½æ•°å¯¹è¾“å…¥çš„å†…å®¹è¿›è¡Œäº†RC4åŠ å¯†åæ‰æ ¡éªŒã€‚ä½†æ˜¯ä½œä¸ºç¬¬å››å‘¨çš„é¢˜ç›®ï¼Œè¿™æ ·å­æ˜¾ç„¶è¿˜æ˜¯å¤ªç›´ç™½äº†ã€‚åŠ¨è°ƒä¸€ä¸‹å¯ä»¥å‘ç°ï¼Œstrcmpå‡½æ•°è¢«é‡å†™äº† å¯ä»¥çœ‹åˆ°ï¼Œstrcmpæœ€åè¢«å¯¼å‘äº†sub_140003000ï¼Œå‡½æ•°åç¼–è¯‘å¦‚ä¸‹ï¼ˆç»è¿‡ä¼˜åŒ–ï¼‰ï¼Œæ˜¯ä¸ªTEAåŠ å¯† 1234567891011121314151617181920212223242526272829303132333435363738394041_BOOL8 __fastcall sub_140003000(void *a1, _DWORD *a2){ _DWORD Buf2[14]; // [rsp+20h] [rbp-60h] BYREF _DWORD *key; // [rsp+58h] [rbp-28h] void *Buf1; // [rsp+60h] [rbp-20h] int j; // [rsp+6Ch] [rbp-14h] int sum; // [rsp+70h] [rbp-10h] unsigned int p2; // [rsp+74h] [rbp-Ch] unsigned int p1; // [rsp+78h] [rbp-8h] int i; // [rsp+7Ch] [rbp-4h] Buf1 = a1; key = a2; Buf2[0] = 1111022553; Buf2[1] = 987309029; Buf2[2] = -1041056711; Buf2[3] = 979189025; Buf2[4] = 189565873; Buf2[5] = 173973774; Buf2[6] = 1090109393; Buf2[7] = -591836169; Buf2[8] = -394857933; Buf2[9] = 668605093; Buf2[10] = 0xB952BACB; for ( i = 0; i &lt;= 9; ++i ) { sum = 0; p1 = *((_DWORD *)Buf1 + i); p2 = *((_DWORD *)Buf1 + i + 1); sum = 0x9E3779B9; for ( j = 0; j &lt;= 31; ++j ) { p1 += (sum + p2) ^ (*key + 16 * p2) ^ ((p2 &gt;&gt; 5) + key[1]); sum -= 0x61C88647; p2 += (sum + p1) ^ (key[2] + 16 * p1) ^ ((p1 &gt;&gt; 5) + key[3]); } *((_DWORD *)Buf1 + i) = p1; *((_DWORD *)Buf1 + i + 1) = p2; } return memcmp(Buf1, Buf2, 0x2CuLL) != 0;} æ‰€ä»¥ï¼Œå®Œæ•´çš„åŠ å¯†æµç¨‹æ˜¯å…ˆRC4å†TEAï¼ŒTEAçš„keyæ˜¯mainå‡½æ•°ä¸­strcmpçš„å‚æ•°str2ï¼Œå¯†æ–‡æ˜¯TEAæœ€åé¢å‡ºç°çš„Buf2ã€‚ è¿˜æœ‰ä¸€äº›éœ€è¦å…³æ³¨çš„ç‚¹ï¼šç¨‹åºäº‹å®ä¸Šè¿›è¡Œäº†ä¸¤æ¬¡RC4åŠ å¯†ï¼Œç¬¬ä¸€æ¬¡æ˜¯ä¸ºäº†è¾“å‡ºâ€input your flag:â€ï¼Œç¬¬äºŒæ¬¡æ‰æ˜¯åŠ å¯†è¾“å…¥çš„å†…å®¹ã€‚æ‰€ä»¥ï¼ŒåŠ¨è°ƒæ—¶åœ¨å‡½æ•°è¿›è¡Œè¾“å‡ºåã€ç¬¬äºŒæ¬¡RC4åŠ å¯†å‰æ‰èƒ½æå–å‡ºçœŸçš„Sç›’ åœ¨åç¼–è¯‘å‡ºæ¥çš„å‡½æ•°çš„åŸºç¡€ä¸Šå¯ä»¥å†™å‡ºè§£å¯†è„šæœ¬ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798#include&lt;stdio.h&gt;#include&lt;stdint.h&gt;void RC4_decrypt(char *a1, int a2) { //ç›´æ¥æå–Sç›’ unsigned char byte_140008060[256] = { 0x99, 0x9B, 0x45, 0x40, 0x22, 0xF6, 0x8B, 0x79, 0x85, 0xD8, 0x7E, 0xF2, 0xBD, 0x98, 0x4C, 0x87, 0x2C, 0xB5, 0x1F, 0x25, 0xA5, 0xD7, 0xAA, 0x56, 0x3C, 0x42, 0x9A, 0x1D, 0x27, 0xC7, 0x0D, 0x4E, 0x3E, 0x71, 0x63, 0x8A, 0x82, 0x46, 0xF3, 0x53, 0x70, 0xE2, 0x11, 0x16, 0x2A, 0xD3, 0xA0, 0x2D, 0x5F, 0x60, 0x8D, 0xD9, 0xFA, 0xD0, 0xC5, 0x64, 0x00, 0xEE, 0xDF, 0xB3, 0x4A, 0x06, 0x8E, 0xB4, 0x8C, 0x86, 0xD2, 0x38, 0x58, 0x01, 0x48, 0x61, 0x32, 0xD6, 0x90, 0xD1, 0x5B, 0xAD, 0x7F, 0x77, 0x4B, 0x09, 0x12, 0xCE, 0x75, 0xC8, 0x05, 0x96, 0xDE, 0xF9, 0xA2, 0xE0, 0x66, 0x0B, 0xAB, 0xE1, 0xCD, 0x4D, 0xF0, 0x92, 0x9D, 0x83, 0x7B, 0xBF, 0x6E, 0xF7, 0xF8, 0x41, 0x6C, 0x30, 0x37, 0xCA, 0x89, 0xA8, 0xD5, 0xEF, 0x23, 0x68, 0xBB, 0xE3, 0xB2, 0x9F, 0xC6, 0xB6, 0xA3, 0xFD, 0xE8, 0xEB, 0x3A, 0x8F, 0x10, 0xA6, 0x1B, 0x67, 0xE5, 0xC0, 0xF5, 0x81, 0x97, 0x39, 0x57, 0x6A, 0x2E, 0xE9, 0x3F, 0x80, 0x2F, 0xA4, 0xE4, 0xEC, 0xE7, 0x24, 0x9C, 0x43, 0xDB, 0x52, 0xED, 0x08, 0x21, 0x51, 0xFB, 0xD4, 0x69, 0xC9, 0xFE, 0x17, 0x78, 0x14, 0x54, 0xDD, 0xCF, 0x74, 0xFC, 0x59, 0xC2, 0x7D, 0x7C, 0x84, 0x1E, 0x15, 0x72, 0x5A, 0x31, 0x0F, 0xDA, 0xB0, 0xCB, 0xBE, 0xAE, 0x73, 0x3D, 0x7A, 0xC3, 0x62, 0x29, 0xC4, 0x20, 0x6D, 0x36, 0x34, 0xDC, 0xAC, 0x33, 0xA7, 0xFF, 0x55, 0x93, 0xB1, 0xE6, 0xB8, 0xC1, 0xF1, 0xF4, 0x18, 0x6B, 0x91, 0xBA, 0x47, 0x65, 0x0C, 0x13, 0x1C, 0xB7, 0x3B, 0x35, 0xA1, 0x19, 0x6F, 0x0E, 0x49, 0x0A, 0x07, 0x5C, 0x02, 0x94, 0x1A, 0x4F, 0xAF, 0x04, 0x2B, 0xCC, 0xB9, 0x88, 0xA9, 0x5E, 0x26, 0xEA, 0x50, 0x44, 0x95, 0x28, 0x5D, 0x03, 0xBC, 0x76, 0x9E}; unsigned __int8 v3; // [rsp+0h] [rbp-10h] int i; // [rsp+4h] [rbp-Ch] int v5; // [rsp+8h] [rbp-8h] int v6; // [rsp+Ch] [rbp-4h] v6 = 0; v5 = 0; for ( i = 0; i &lt; a2; ++i ) { v6 = (v6 + 1) % 256; v5 = (byte_140008060[v6] + v5) % 256; v3 = byte_140008060[v6]; byte_140008060[v6] = byte_140008060[v5]; byte_140008060[v5] = v3; *(char *)(i + a1) = byte_140008060[(unsigned __int8)(byte_140008060[v6] + byte_140008060[v5])] ^ *(char *)(a1 + i); }}int main(){ //ç”¨ä½œkeyçš„str2 unsigned char Str2[44] = { 0x9F, 0xBE, 0xAF, 0x3F, 0x87, 0x12, 0xF0, 0x50, 0x75, 0xC0, 0xA4, 0xF6, 0x78, 0x42, 0x77, 0x55, 0x80, 0x7B, 0x02, 0x67, 0x5E, 0xFE, 0x07, 0xEC, 0x76, 0x77, 0xC8, 0x31, 0x66, 0x95, 0x0A, 0x25, 0x7B, 0xE2, 0x83, 0x02, 0x9C, 0x7B, 0x9C, 0xE9, 0x93, 0x2E, 0x66, 0xC7 }; //ä¸‹é¢æ˜¯åœ¨åç¼–è¯‘TEAçš„åŸºç¡€ä¸Šæ”¹çš„ï¼Œç›´æ¥è§£å¯†Buf2 uint32_t Buf2[14]; // [rsp+20h] [rbp-60h] BYREF uint32_t *key; // [rsp+58h] [rbp-28h] //void *Buf1; // [rsp+60h] [rbp-20h] int j; // [rsp+6Ch] [rbp-14h] int sum; // [rsp+70h] [rbp-10h] unsigned int p2; // [rsp+74h] [rbp-Ch] unsigned int p1; // [rsp+78h] [rbp-8h] int i; // [rsp+7Ch] [rbp-4h] //Buf1 = a1; key = (uint32_t *)Str2; Buf2[0] = 1111022553; Buf2[1] = 987309029; Buf2[2] = -1041056711; Buf2[3] = 979189025; Buf2[4] = 189565873; Buf2[5] = 173973774; Buf2[6] = 1090109393; Buf2[7] = -591836169; Buf2[8] = -394857933; Buf2[9] = 668605093; Buf2[10] = 0xB952BACB; //è¿™é‡ŒåŸæ¥æ˜¯ä»&lt;Buf[0],Buf[1]&gt;åˆ°&lt;Buf[9],Buf[10]&gt;ä¸€å¯¹ä¸€å¯¹åŠ å¯†ï¼Œç°åœ¨åè¿‡æ¥ä»&lt;Buf[9],Buf[10]&gt;å¼€å§‹åˆ°&lt;Buf[0],Buf[1]&gt; for ( i = 9; i &gt;= 0; --i ) { sum = 0; p1 = *((uint32_t*)Buf2 + i); p2 = *((uint32_t*)Buf2 + i + 1); sum = 0x9E3779B9; //æ¨¡æ‹Ÿæ­£å‘åŠ å¯†å¾—åˆ°æœ€åçš„sumå€¼ for(int i = 0; i &lt; 32; i++){ sum-=0x61C88647; } //p1ï¼Œp2çš„å¤„ç†é¡ºåºè°ƒæ¢ï¼ŒåŠ å‡è°ƒæ¢ï¼ŒsumåŠ å‡è°ƒæ¢ for ( j = 0; j &lt;= 31; ++j ) { p2 -= (sum + p1) ^ (key[2] + 16 * p1) ^ ((p1 &gt;&gt; 5) + key[3]); sum += 0x61C88647; p1 -= (sum + p2) ^ (*key + 16 * p2) ^ ((p2 &gt;&gt; 5) + key[1]); } *((uint32_t*)Buf2 + i) = p1; *((uint32_t*)Buf2 + i + 1) = p2; } RC4_decrypt((char *)Buf2,44); for(i=0;i&lt;44;i++) printf(&quot;%c&quot;,((char *)Buf2)[i]); return 0;} flagï¼š0xGame{20994d4d-30ab-4918-b00a-5ca6ae138613} èŠ±é¸Ÿé£æœˆ è€ƒç‚¹ï¼šèŠ±æŒ‡ä»¤ï¼Œé­”æ”¹base64ï¼Œå¼‚æˆ–ï¼ŒåŠ¨æ€è°ƒè¯• é™„ä»¶ç¨‹åºè¿è¡Œèµ·æ¥æ˜¯è¿™æ ·çš„ï¼š ç”¨IDAæ‰“å¼€ï¼ŒShift+F12åœ¨å­—ç¬¦ä¸²çª—å£å¯ä»¥æ‰¾åˆ°ç±»ä¼¼base64ç¼–ç è¡¨çš„å¯ç–‘å­—ç¬¦ä¸² éšåå¯ä»¥è·Ÿè¸ªåˆ°è¿™æ ·ä¸€ä¸ªè²Œä¼¼base64ç¼–ç çš„å‡½æ•° é€‰ä¸­å‡½æ•°åæŒ‰Xå›æº¯ä¸Šå±‚å‡½æ•°ï¼Œä¼šå‘ç°æ— æ³•åç¼–è¯‘äº†ï¼Œæ ˆå¸§æŠ¥é”™ åœ¨æŠ¥é”™çš„é™„è¿‘å¯ä»¥çœ‹åˆ°åæ±‡ç¼–å¤±è´¥çš„ä¸€å †æ•°å­—ï¼Œä»¥åŠä¸€ä¸ªå…¸å‹çš„jnz+jzèŠ±æŒ‡ä»¤ é€‰ä¸­ä¸Šå›¾ä¸­çš„loc_4012F2æŒ‰Uå¯ä»¥å¾—åˆ°ä¸‹å›¾ æ­¤æ—¶åªéœ€è¦æŠŠjnzå’Œjzä»¥åŠåé¢çš„0E8hç»™nopæ‰å³å¯ï¼Œå†é€‰ä¸­unk_4012F3æŒ‰Cå³å¯å¾—åˆ°ä¿®æ­£åçš„æ±‡ç¼–ä»£ç  åŒæ ·çš„èŠ±æŒ‡ä»¤å¤§æ¦‚æœ‰3ä¸ªï¼Œå»é™¤åå¯ä»¥åœ¨ä¸Šæ–‡æ‰¾åˆ°å¦ä¸€ä¸ªæŠ¥é”™ è¿™é‡Œå¯ä»¥å‘ç°æŠ¥é”™å¤„çš„ä¸Šä¸€å¥æ˜¯retnï¼Œæ‰€ä»¥æŠŠä¸‹é¢çš„loc_4012C0å³é”®create function ç„¶åå†å›è¿‡å¤´çœ‹è¿™ä¸ªæŠ¥é”™ï¼Œå‰é¢ä¸è¿œæœ‰ä¸€ä¸ªå¾ˆå¯ç–‘çš„call $+5ï¼Œæ˜¾ç„¶æ˜¯äººä¸ºä¿®æ”¹çš„ ä»”ç»†åˆ†æè¿™æ®µæ±‡ç¼–ä»£ç ä¼šå‘ç°ï¼Œè¿™ä¹Ÿæ˜¯ä¸€ä¸ªèŠ±æŒ‡ä»¤ å®é™…ä¸Šç¨‹åºåœ¨jzå¤„ä¸è·³ç›´æ¥retnåï¼Œä¼šå›åˆ°xor eax,1è¿™ä¸€è¡Œï¼ŒåŸå› æ˜¯ï¼šcall $+5å³call 0x0040122Dï¼Œåˆå³push rip(0x0040122D) jmp 0x0040122Dï¼Œæ‰€ä»¥retnåç¨‹åºå›åˆ°æ ˆä¸Šçš„rip(0x0040122D)å¤„ï¼Œå³xor eax,1ã€‚IDAåç¼–è¯‘ä¼šè¢«è¿™ä¸ªretnç»™æ¬ºéª—ï¼Œè¯¯ä»¥ä¸ºå‡½æ•°åˆ°æ­¤ç»“æŸï¼Œå…¶å®åé¢è¿˜æœ‰ä¸€äº›å†…å®¹ã€‚æ‰€ä»¥ç›´æ¥å§loc_401223è¿™ä¸€æ•´æ®µnopæ‰ï¼Œå°±å¯ä»¥å¾—åˆ°å®Œæ•´çš„åç¼–è¯‘ä»£ç  ä¼˜åŒ–ä¸€ä¸‹è¿™ä¸ªå‡½æ•°å’Œä¸Šæ–‡çš„ç±»ä¼¼baseç¼–ç çš„å‡½æ•°çš„å‘½åï¼Œå¯ä»¥å¾—åˆ°ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960int sub_4012C0(){ char *v0; // eax char *v1; // eax char *v2; // eax char *v3; // eax char *v5; // eax char *v6; // eax char *v7; // eax char *v8; // eax int v9; // [esp-4h] [ebp-ECh] int v10; // [esp+10h] [ebp-D8h] BYREF int v11; // [esp+14h] [ebp-D4h] int i; // [esp+18h] [ebp-D0h] _BYTE v13[100]; // [esp+1Ch] [ebp-CCh] BYREF _BYTE v14[100]; // [esp+80h] [ebp-68h] BYREF v11 = 0x81428113; v0 = sub_401000((int)&amp;unk_422054); sub_401670(v0); v1 = sub_401000((int)&amp;unk_422068); sub_4016B0(v1, (char)&amp;v10); for ( i = 0; i &lt; 10; ++i ) { v11 = 21106755 * v11 + 1126795285; v11 ^= __ROL4__( v10, i * (byte_422007 + byte_422004) % (byte_422008 + byte_422004 + byte_422005 * byte_422008 + byte_422AA0 * (byte_422002 + byte_422006 + byte_422003) - byte_422005 * byte_422005)); } if ( v11 == 0xA745DA5D ) { v2 = sub_401000((int)&amp;unk_42206C); sub_401670(v2); v5 = sub_401000((int)&amp;unk_422094); sub_401670(v5); v6 = sub_401000((int)&amp;unk_4220A4); sub_4016B0(v6, (char)v14); XORencrypt(v14, v10, byte_422004 + byte_422002 + byte_422008 * byte_422003); baseEncode((int)v14, (int)v13, byte_422005 + byte_422001 + byte_422008 * byte_422003); v9 = byte_422004 * byte_422003 * byte_422002; v7 = sub_401000((int)&amp;unk_4220A8); if ( sub_40B460(v13, v7, v9) ) v8 = sub_401000((int)&amp;unk_4220FC); else v8 = sub_401000((int)&amp;unk_4220E8); sub_401670(v8); return 0; } else { v3 = sub_401000((int)&amp;unk_422080); sub_401670(v3); return 0; }} å…¶ä¸­byte_42200xçš„å€¼éƒ½æ˜¯x+1ï¼Œæ‰€ä»¥å¯ä»¥è¿›ä¸€æ­¥ä¼˜åŒ– 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253int sub_4012C0(){ char *v0; // eax char *v1; // eax char *v2; // eax char *v3; // eax char *v5; // eax char *v6; // eax char *v7; // eax char *v8; // eax int v9; // [esp-4h] [ebp-ECh] int v10; // [esp+10h] [ebp-D8h] BYREF int v11; // [esp+14h] [ebp-D4h] int i; // [esp+18h] [ebp-D0h] _BYTE v13[100]; // [esp+1Ch] [ebp-CCh] BYREF _BYTE v14[100]; // [esp+80h] [ebp-68h] BYREF v11 = 0x81428113; v0 = sub_401000((int)&amp;unk_422054); sub_401670(v0); v1 = sub_401000((int)&amp;unk_422068); sub_4016B0(v1, (char)&amp;v10); for ( i = 0; i &lt; 10; ++i ) { v11 = 0x1421043 * v11 + 0x43298815; v11 ^= __ROL4__(v10, i * (8 + 5) % (9 + 5 + 6 * 9 + 0 * (3 + 7 + 4) - 6 * 6)); } if ( v11 == 0xA745DA5D ) { v2 = sub_401000((int)&amp;unk_42206C); sub_401670(v2); v5 = sub_401000((int)&amp;unk_422094); sub_401670(v5); v6 = sub_401000((int)&amp;unk_4220A4); sub_4016B0(v6, (char)v14); XORencrypt(v14, v10, 5 + 3 + 9 * 4); baseEncode((int)v14, (int)v13, 6 + 2 + 9 * 4); v9 = 5 * 4 * 3; v7 = sub_401000((int)&amp;unk_4220A8); if ( sub_40B460(v13, v7, v9) ) v8 = sub_401000((int)&amp;unk_4220FC); else v8 = sub_401000((int)&amp;unk_4220E8); sub_401670(v8); return 0; } else { v3 = sub_401000((int)&amp;unk_422080); sub_401670(v3); return 0; }} åŠ¨è°ƒå¯ä»¥å‘ç°ç¨‹åºçš„æç¤ºè¯æ˜¯å®æ—¶è§£å¯†çš„ï¼Œsub_401000æ˜¯è§£å¯†å‡½æ•°ï¼Œsub_401670æ˜¯è¾“å‡ºå‡½æ•°ï¼Œsub_4016B0æ˜¯è¾“å…¥å‡½æ•°ã€‚ä¸‹é¢æ˜¯å…·ä½“è¿‡ç¨‹ï¼š åœ¨å‡½æ•°çš„å¼€å¤´ä¸‹æ–­ç‚¹ï¼Œå¼€å§‹è°ƒè¯•ã€‚ç¨‹åºåœåœ¨äº†ä¸‹å›¾è¿™ä¸ªåœ°æ–¹ï¼Œå¯ä»¥çœ‹åˆ°éšåæœ‰ä¸€äº›å¥‡æ€ªçš„æ•°æ®ï¼Œç›´æ¥nopæ‰ ç»§ç»­è¿è¡Œç¨‹åºä¼šå‘ç°æ‰§è¡Œè¿‡sub_7C1670ï¼ˆå¯¹åº”é™æ€åˆ†ææ—¶çš„sub_401670ï¼ŒåŠ¨æ€è°ƒè¯•æ¢åŸºå€äº†æ‰€ä»¥åœ°å€å‰ä¸¤ä½æœ‰äº›ä¸åŒï¼‰åç¨‹åºä¼šæœ‰æç¤ºè¾“å‡ºï¼Œå› æ­¤æ¨æ–­sub_7C1670æ˜¯print è€Œè§‚å¯Ÿé™æ€åˆ†ææ—¶çš„ä»£ç å¯ä»¥å‘ç°ï¼Œsub_401000å‡ ä¹å’Œsub_401670æ˜¯åŒæ—¶å‡ºç°çš„ï¼ŒåŠ¨æ€è°ƒè¯•å¯¹åº”çš„sub_7C1000å‡½æ•°åç¼–è¯‘å¦‚ä¸‹ åŒæ—¶å¯ä»¥å‘ç°byte_7E3440æ­¤æ—¶å­˜å‚¨çš„æ­£å¥½æ˜¯Input key (Hex) ï¼ˆæ­¤æ—¶å·²ç»æ­¥è¿‡è¿™ä¸ªå‡½æ•°äº†ï¼Œæ‰€ä»¥byte_7E3440å·²ç»è¢«å¤„ç†è¿‡äº†ï¼‰: æ‰€ä»¥å¯ä»¥æ¨æµ‹æç¤ºè¯æ˜¯å®æ—¶è§£å¯†çš„ï¼Œsub_401000æ˜¯è§£å¯†å‡½æ•° æ¥ä¸‹æ¥è¿˜æœ‰ä¸ªsub_7C16B0ï¼Œæ¨æµ‹æ˜¯scanf åœ¨åŠ¨æ€è°ƒè¯•éšåçš„ä»£ç é‡Œï¼Œä¼šå‘ç°è¿˜æœ‰èŠ±æŒ‡ä»¤ï¼ˆæœ‰ä¸¤å¤„ï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯é™æ€åˆ†ææ—¶çš„å»æ··æ·†æ²¡æœ‰ä¿å­˜ï¼‰ åŒæ ·çš„æ“ä½œnopæ‰åï¼Œåç¼–è¯‘å¾—åˆ° 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051void sub_7C12C0(){ char *v0; // eax char *v1; // eax char *v2; // eax char *v3; // eax char *v4; // eax char *v5; // eax char *v6; // eax char *v7; // eax int v8; // [esp-4h] [ebp-ECh] int v9; // [esp+10h] [ebp-D8h] BYREF int v10; // [esp+14h] [ebp-D4h] int i; // [esp+18h] [ebp-D0h] _BYTE v12[100]; // [esp+1Ch] [ebp-CCh] BYREF _BYTE v13[100]; // [esp+80h] [ebp-68h] BYREF v10 = 0x81428113; v0 = decodeNotice((int)&amp;unk_7E2054); print(v0); v1 = decodeNotice((int)&amp;unk_7E2068); scanf(v1, (char)&amp;v9); for ( i = 0; i &lt; 10; ++i ) { v10 = 0x1421043 * v10 + 0x43298815; v10 ^= __ROL4__(v9, i * (8 + 5) % (9 + 5 + 6 * 9 + 0 * (3 + 7 + 4) - 6 * 6)); } if ( v10 == 0xA745DA5D ) { v2 = decodeNotice((int)&amp;unk_7E206C); print(v2); v4 = decodeNotice((int)&amp;unk_7E2094); print(v4); v5 = decodeNotice((int)&amp;unk_7E20A4); scanf(v5, (char)v13); XORencrypt((int)v13, v9, 5 + 3 + 9 * 4); baseEncode((int)v13, (int)v12, 6 + 2 + 9 * 4); v8 = 5 * 4 * 3; v6 = decodeNotice((int)&amp;unk_7E20A8); if ( sub_7CB460(v12, v6, v8) ) v7 = decodeNotice((int)&amp;unk_7E20FC); else v7 = decodeNotice((int)&amp;unk_7E20E8); print(v7); } else { v3 = decodeNotice((int)&amp;unk_7E2080); print(v3); }} æ­¤æ—¶å¾—åˆ°æ›´åŠ æ¸…æ™°çš„ä»£ç äº†ï¼ŒåŒæ—¶å¯ä»¥å‘ç°ç¨‹åºé¦–å…ˆå¯¹è¾“å…¥çš„keyè¿›è¡Œäº†æ ¡éªŒã€‚ ä¸ºäº†ç»§ç»­äº†è§£ç¨‹åºé€»è¾‘ï¼Œè¿™é‡Œé€‰æ‹©ä¿®æ”¹ifè¯­å¥æ¡ä»¶çš„åˆ¤æ–­ç»“æœæ¥ç»•è¿‡keyæ£€éªŒï¼Œåªéœ€è¦åœ¨cmpåä¿®æ”¹ZFæ ‡å¿—ä½ï¼Œè®©jnzä¸æˆç«‹å³å¯ ç»§ç»­è¿è¡Œç¨‹åºä¼šæœ‰è¾“å…¥flagçš„æç¤º è‡³æ­¤ï¼Œå¯ä»¥çŒœå‡ºç¨‹åºçš„å¤§è‡´é€»è¾‘ï¼šæ¥æ”¶ä¸€ä¸ªkeyå¹¶è¿›è¡Œæ£€éªŒï¼Œæ£€éªŒæˆåŠŸåˆ™ç»§ç»­æ£€éªŒflagï¼ŒåŒæ—¶éœ€è¦æ³¨æ„keyä¼šä½œä¸ºflagæ£€éªŒçš„ä¸€ä¸ªå‚æ•°ã€‚ä¸‹é¢æ˜¯ä¼˜åŒ–åçš„æœ€ç»ˆä»£ç  123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051void sub_7C12C0(){ char *v0; // eax char *v1; // eax char *v2; // eax char *v3; // eax char *v4; // eax char *v5; // eax char *targetResult; // eax char *v7; // eax int v8; // [esp-4h] [ebp-ECh] int key; // [esp+10h] [ebp-D8h] BYREF int v10; // [esp+14h] [ebp-D4h] int i; // [esp+18h] [ebp-D0h] _BYTE encodedInput[100]; // [esp+1Ch] [ebp-CCh] BYREF _BYTE input[100]; // [esp+80h] [ebp-68h] BYREF v10 = 0x81428113; v0 = decodeNotice((int)&amp;unk_7E2054); // input key print(v0); v1 = decodeNotice((int)&amp;unk_7E2068); scanf(v1, (char)&amp;key); for ( i = 0; i &lt; 10; ++i ) { v10 = 0x1421043 * v10 + 0x43298815; v10 ^= __ROL4__(key, i * (8 + 5) % (9 + 5 + 6 * 9 + 0 * (3 + 7 + 4) - 6 * 6)); } if ( v10 == 0xA745DA5D ) { v2 = decodeNotice((int)&amp;unk_7E206C); // key is correct print(v2); v4 = decodeNotice((int)&amp;unk_7E2094); // input flag print(v4); v5 = decodeNotice((int)&amp;unk_7E20A4); scanf(v5, (char)input); XORencrypt((int)input, key, 5 + 3 + 9 * 4); baseEncode((int)input, (int)encodedInput, 6 + 2 + 9 * 4); v8 = 5 * 4 * 3; targetResult = decodeNotice((int)&amp;unk_7E20A8);// æ­¤å¤„è§£å¯†çš„å€¼è¢«ç”¨æ¥å’Œè¾“å…¥å€¼çš„åŠ å¯†ç»“æœè¿›è¡Œæ¯”è¾ƒäº†ï¼Œæ‰€ä»¥æ¨æµ‹æ˜¯çœŸæ­£çš„flagå¯†æ–‡ if ( strcmp(encodedInput, targetResult, v8) ) v7 = decodeNotice((int)&amp;unk_7E20FC); else v7 = decodeNotice((int)&amp;unk_7E20E8); print(v7); } else { v3 = decodeNotice((int)&amp;unk_7E2080); print(v3); }} targetResultä¹Ÿæ˜¯å®æ—¶è§£å¯†çš„ç»“æœï¼Œæ‰€ä»¥å¯ä»¥åŠ¨è°ƒæå– ç¨‹åºçš„åŠ å¯†æµç¨‹æ˜¯å…ˆXORencryptå†baseEncodeï¼Œæ‰€ä»¥è§£å¯†è¦å…ˆbaseDecodeå†XORencã€‚baseEncodeä¼˜åŒ–åå¦‚ä¸‹ï¼Œå¯ä»¥å‘ç°ä¸æ˜¯æ ‡å‡†çš„base64ç¼–ç  1234567891011121314151617181920212223242526272829303132333435int __cdecl baseEncode(int input, int output, int length){ int result; // eax char code2; // [esp+Ah] [ebp-56h] int i; // [esp+Ch] [ebp-54h] char code4; // [esp+12h] [ebp-4Eh] char code3; // [esp+13h] [ebp-4Dh] int v8; // [esp+14h] [ebp-4Ch] int v9; // [esp+14h] [ebp-4Ch] char baseTable[68]; // [esp+18h] [ebp-48h] BYREF v8 = 0; strcpy(baseTable, &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;); for ( i = 0; i &lt; length; i += 3 ) { code3 = baseTable[((*(i + input + 1) &gt;&gt; 4) | (16 * *(i + input))) &amp; 63];// baseTable[((input[i+1]&gt;&gt;4)|(input[i]&lt;&lt;4))&amp;63] if ( i + 1 &gt;= length ) code3 = '='; else code2 = baseTable[((*(i + input + 2) &gt;&gt; 6) | (4 * *(i + input + 1))) &amp; 63];// baseTable[((input[i+2]&gt;&gt;6)|(input[i+1]&lt;&lt;2))&amp;63] if ( i + 2 &gt;= length ) code4 = '='; else code4 = baseTable[*(i + input + 2) &amp; 63]; // baseTable[input[i+2]&amp;63] *(v8 + output) = baseTable[(*(i + input) &gt;&gt; 2) &amp; 63];// baseTable[(input[i]&gt;&gt;2)&amp;63] v9 = v8 + 1; *(v9 + output) = code2; *(++v9 + output) = code3; *(++v9 + output) = code4; v8 = v9 + 1; result = i + 3; } *(v8 + output) = 0; return result;} æ ‡å‡†base64ç¼–ç æ˜¯æŒ‰ç…§å­—ç¬¦é¡ºåºï¼ŒæŠŠ3ä¸ª8bitçš„charè½¬æˆ4ä¸ª6bitï¼Œå³ 1234code1=baseTable[input[i]&gt;&gt;2];code2=baseTable[(input[i]&lt;&lt;6)|(input[i+1]&gt;&gt;4)];code3=baseTable[(input[i+1]&lt;&lt;4)|(input[i+2]&gt;&gt;6)];code4=baseTable[input[i+2]&lt;&lt;2]; è€Œç¨‹åºé‡Œcode2å’Œcode3é¡ºåºåäº† 12345code1=baseTable[(input[i]&gt;&gt;2)&amp;63];code2=baseTable[((input[i+1]&lt;&lt;2)|(input[i+2]&gt;&gt;6))&amp;63];code3=baseTable[((input[i]&lt;&lt;4)|(input[i+1]&gt;&gt;4))&amp;63];code4=baseTable[input[i+2]&amp;63];//PSï¼šè¿™é‡Œå› ä¸º&amp;äº†63ï¼Œæ‰€ä»¥æ‹¼æˆ8ä½çš„codeè¢«æˆªæ‰äº†é«˜2ä½ï¼Œå‰©ä¸‹6ä½ ä¹Ÿå°±æ˜¯è¯´ï¼Œç¨‹åºçš„é­”æ”¹base64ç¼–ç å’Œæ ‡å‡†base64ç¼–ç çš„ä¸åŒç‚¹åœ¨äºï¼Œç¼–ç æ—¶ç½®æ¢äº†ç¬¬2ã€3ä¸ªå­—ç¬¦ã€‚å› æ­¤æˆ‘ä»¬æ­¤å¤„çš„è§£å¯†å°±æ˜¯æŠŠæ¯4ä¸ªå­—ç¬¦çš„ç¬¬2ã€3ä¸ªå­—ç¬¦äº’æ¢ä½ç½®ï¼Œç„¶åä½¿ç”¨æ ‡å‡†base64è§£ç å³å¯ã€‚ä¸‹é¢æ˜¯basedecodeçš„è„šæœ¬ 123456789101112import base64enc=[0x4D, 0x41, 0x50, 0x44, 0x63, 0x33, 0x47, 0x74, 0x50, 0x51, 0x33, 0x34, 0x76, 0x4D, 0x33, 0x70, 0x4E, 0x42, 0x62, 0x31, 0x50, 0x57, 0x47, 0x78, 0x63, 0x63, 0x48, 0x74, 0x76, 0x78, 0x48, 0x31, 0x4E, 0x56, 0x61, 0x39, 0x4A, 0x50, 0x54, 0x74, 0x61, 0x63, 0x53, 0x35, 0x37, 0x49, 0x69, 0x6C, 0x4E, 0x35, 0x75, 0x78, 0x4A, 0x53, 0x57, 0x35, 0x49, 0x77, 0x6D, 0x3D]basedecoded=&quot;&quot;for i in range(0, len(enc),4): basedecoded+=chr(enc[i]) basedecoded+=chr(enc[i+2]) basedecoded+=chr(enc[i+1]) basedecoded+=chr(enc[i+3])print(basedecoded)#MPADcG3tP3Q4v3MpNbB1PGWxcHctvHx1NaV9JTPtaSc57iIlNu5xJWS5Imw=xorencoded=base64.b64decode(basedecoded) æ¥ä¸‹æ¥æ˜¯XORdecryptã€‚é¦–å…ˆéœ€è¦å¾—åˆ°å¯†é’¥ï¼Œæ—¢ç„¶ç¨‹åºç»™äº†å¯†é’¥çš„æ£€éªŒç®—æ³•ï¼Œå¯ä»¥å¤ç°è¿™ä¸ªç®—æ³•æ¥çˆ†ç ´å¯†é’¥ã€‚ä¸‹é¢æ˜¯çˆ†ç ´è„šæœ¬ï¼š 1234567891011121314151617#include&lt;stdio.h&gt;#define __ROL4__(x, y) ((((x) &lt;&lt; (y)) | ((x) &gt;&gt; (32 - (y))))&amp;0xFFFFFFFF)int main(){ unsigned int v9,key; for(key=0;key&lt;=0xFFFFFFFF;key++){ v9 = 0x81428113; for ( int i = 0; i &lt; 10; ++i ) { v9 = 0x1421043 * v9 + 0x43298815; v9 ^= __ROL4__(key, i * (8 + 5) % (9 + 5 + 6 * 9 + 0 * (3 + 7 + 4) - 6 * 6)); } if ( v9 == 0xA745DA5D ) printf(&quot;key: 0x%08x\\n&quot;,key); } return 0;}//key: 0x98bf3b77 ç„¶åæ˜¯XORè§£å¯†ï¼Œç”±äºå¼‚æˆ–è¿‡ç¨‹ä¸­ä¸æ¶‰åŠå¯†æ–‡å‰åä½ï¼Œåªæ˜¯å•çº¯ä½¿ç”¨keyï¼Œæ‰€ä»¥åªéœ€è¦å¤ç°å¼‚æˆ–è¿‡ç¨‹å°±è¡Œäº†ã€‚ä½†æ˜¯ç…§æŠ„ä¹Ÿä¸æ˜¯å¾ˆå¯¹ï¼ŒXORencryptä½¿ç”¨keyçš„æ—¶å€™æ˜¯è¿›è¡Œäº†å–ä½æ“ä½œï¼ŒæŠŠkeyåˆ†æˆäº†å››ä¸ªéƒ¨åˆ†çš„ï¼Œæ‰€ä»¥è¿™éƒ¨åˆ†è¦å•ç‹¬æ‹¿å‡ºæ¥å¤„ç†ã€‚è„šæœ¬ï¼š 12345678910def XORdecrypt(data, key): for i in range(44): key_byte=(key &gt;&gt; (8 * (i % 4)))&amp;0xff#å•ç‹¬å¤„ç†æ¯æ¬¡ä½¿ç”¨çš„keyï¼Œæ¯æ¬¡åªå–å››åˆ†ä¹‹ä¸€ï¼Œç›´æ¥æŠ„åŸä»£ç æ²¡æœ‰&amp;0xffçš„è¯ä¼šè§£å¯†å¤±è´¥ã€‚ data[i]^=key_byte data[i]=data[i]&amp;0xff for j in range(44): key_byte=(key &gt;&gt; (8 * (j % 4)))&amp;0xff data[j]^=((key_byte &gt;&gt; 4) | (16 * key_byte)) data[j]=data[j]&amp;0xff return bytes(data) å®Œæ•´è„šæœ¬ï¼š 12345678910111213141516171819202122232425import base64def XORdecrypt(data, key): for i in range(44): key_byte=(key &gt;&gt; (8 * (i % 4)))&amp;0xff data[i]^=key_byte data[i]=data[i]&amp;0xff for j in range(44): key_byte=(key &gt;&gt; (8 * (j % 4)))&amp;0xff data[j]^=((key_byte &gt;&gt; 4) | (16 * key_byte)) data[j]=data[j]&amp;0xff return bytes(data)enc=[0x4D, 0x41, 0x50, 0x44, 0x63, 0x33, 0x47, 0x74, 0x50, 0x51, 0x33, 0x34, 0x76, 0x4D, 0x33, 0x70, 0x4E, 0x42, 0x62, 0x31, 0x50, 0x57, 0x47, 0x78, 0x63, 0x63, 0x48, 0x74, 0x76, 0x78, 0x48, 0x31, 0x4E, 0x56, 0x61, 0x39, 0x4A, 0x50, 0x54, 0x74, 0x61, 0x63, 0x53, 0x35, 0x37, 0x49, 0x69, 0x6C, 0x4E, 0x35, 0x75, 0x78, 0x4A, 0x53, 0x57, 0x35, 0x49, 0x77, 0x6D, 0x3D]basedecoded=&quot;&quot;for i in range(0, len(enc),4): basedecoded+=chr(enc[i]) basedecoded+=chr(enc[i+2]) basedecoded+=chr(enc[i+1]) basedecoded+=chr(enc[i+3])#print(basedecoded)xorencoded=base64.b64decode(basedecoded)#print(len(xorencoded))flag=XORdecrypt(list(xorencoded),0x98bf3b77)print(flag) flagï¼š0xGame{e8778581-e94f-48d5-943e-69ff46f54d1f} äº‘æ¶ˆé›¾æ•£ è€ƒç‚¹ï¼šå¤æ‚ç¨‹åºåˆ†æï¼Œé­”æ”¹RC4 éš¾ç‚¹åœ¨äºå¤æ‚ï¼Œæ²¡æœ‰å…¶ä»–å¥—è·¯ é™„ä»¶ç»™äº†ä¸€ä¸ªimg.exeå’Œenc.bmpã€‚bmpæ˜¯ä¸€ç§å›¾ç‰‡æ ¼å¼ï¼Œæ¨æµ‹img.exeæ˜¯bmpå›¾ç‰‡åŠ å¯†ç¨‹åºï¼Œenc.bmpæ˜¯åŠ å¯†çš„å›¾ç‰‡ï¼Œè¦æ±‚é€†å‘åŠ å¯†ç¨‹åºè¿›è€Œè§£å¯†å›¾ç‰‡ img.exeç”¨IDAæ‰“å¼€ï¼Œshift+F12å¯ä»¥æ‰¾åˆ°â€enc.bmpâ€ è·Ÿè¸ªå¯ä»¥åˆ°è¿™æ ·ä¸€ä¸ªå‡½æ•° 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114__int64 __fastcall sub_140001936(int a1, int a2){ int v2; // r9d int v3; // edx int v4; // r8d int v5; // r9d int v6; // r9d int v7; // edx int v8; // r8d int v9; // r9d int v10; // r9d int v11; // edx int v12; // r8d int v13; // r9d int v14; // r9d int v15; // edx int v16; // r8d int v17; // r9d int v18; // r9d int v19; // r9d int v20; // r8d int v21; // r9d int v22; // edx int v23; // r8d int v24; // r9d int v25; // edx int v26; // r8d int v27; // r9d int v28; // r9d int v29; // r9d int v30; // r8d int v31; // r9d int v32; // edx int v33; // r8d int v34; // r9d int v35; // edx int v36; // r8d int v37; // r9d int v38; // edx int v39; // r8d int v40; // r9d int v41; // edx int v42; // r8d int v43; // r9d int v44; // edx int v45; // r8d int v46; // r9d int v47; // edx int v48; // r8d int v49; // r9d __int64 v51; // [rsp+0h] [rbp-80h] __int64 v52; // [rsp+0h] [rbp-80h] __int64 v53; // [rsp+0h] [rbp-80h] __int64 v54; // [rsp+0h] [rbp-80h] __int64 v55; // [rsp+0h] [rbp-80h] __int64 v56; // [rsp+0h] [rbp-80h] __int64 v57; // [rsp+0h] [rbp-80h] __int64 v58; // [rsp+0h] [rbp-80h] __int64 v59; // [rsp+0h] [rbp-80h] __int64 v60; // [rsp+0h] [rbp-80h] __int64 v61; // [rsp+0h] [rbp-80h] __int64 v62; // [rsp+0h] [rbp-80h] __int64 v63; // [rsp+0h] [rbp-80h] __int64 v64; // [rsp+0h] [rbp-80h] __int64 v65; // [rsp+0h] [rbp-80h] __int64 v66; // [rsp+8h] [rbp-78h] __int64 v67; // [rsp+10h] [rbp-70h] _BYTE v68[32]; // [rsp+20h] [rbp-60h] BYREF _BYTE v69[32]; // [rsp+40h] [rbp-40h] BYREF _BYTE v70[32]; // [rsp+60h] [rbp-20h] BYREF _BYTE v71[44]; // [rsp+80h] [rbp+0h] BYREF char v72; // [rsp+ACh] [rbp+2Ch] BYREF char v73; // [rsp+ADh] [rbp+2Dh] BYREF char v74; // [rsp+AEh] [rbp+2Eh] BYREF char v75; // [rsp+AFh] [rbp+2Fh] BYREF _BYTE v76[32]; // [rsp+B0h] [rbp+30h] BYREF _BYTE v77[32]; // [rsp+D0h] [rbp+50h] BYREF _BYTE v78[32]; // [rsp+F0h] [rbp+70h] BYREF _BYTE v79[32]; // [rsp+110h] [rbp+90h] BYREF char *v80; // [rsp+130h] [rbp+B0h] char *v81; // [rsp+138h] [rbp+B8h] char *v82; // [rsp+140h] [rbp+C0h] char *v83; // [rsp+148h] [rbp+C8h] sub_140001D70(); v83 = &amp;v72; sub_140004130(a1, a2, &quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025&quot;, v71, &amp;v72, v2); sub_140003580(a1, a2, v3, &amp;v72, v4, v5); v82 = &amp;v73; sub_140004130(a1, a2, &quot;flag.bmp&quot;, v70, &amp;v73, v6); sub_140003580(a1, a2, v7, &amp;v73, v8, v9); v81 = &amp;v74; sub_140004130(a1, a2, &quot;enc.bmp&quot;, v69, &amp;v74, v10); sub_140003580(a1, a2, v11, &amp;v74, v12, v13); v80 = &amp;v75; sub_140004130(a1, a2, &quot;114514puiqneravcixpbhqn;afnv-92piwgspdifjv&quot;, v68, &amp;v75, v14); sub_140003580(a1, a2, v15, &amp;v75, v16, v17); sub_140004670(a1, a2, v71, v77, &quot;\\\\&quot;, v18, v51); sub_140004620(a1, a2, v77, v76, v70, v19, v52); sub_140004210(a1, a2, v76, v70, v20, v21, v53); sub_1400041E0(a1, a2, v22, v76, v23, v24, v54); sub_1400041E0(a1, a2, v25, v77, v26, v27, v55); sub_140004670(a1, a2, v71, v79, &quot;\\\\&quot;, v28, v56); sub_140004620(a1, a2, v79, v78, v69, v29, v57); sub_140004210(a1, a2, v78, v69, v30, v31, v58); sub_1400041E0(a1, a2, v32, v78, v33, v34, v59); sub_1400041E0(a1, a2, v35, v79, v36, v37, v60); sub_14000164D(a1, a2, v69, v70, v68, 1, v61, v66, v67); sub_1400041E0(a1, a2, v38, v68, v39, v40, v62); sub_1400041E0(a1, a2, v41, v69, v42, v43, v63); sub_1400041E0(a1, a2, v44, v70, v45, v46, v64); sub_1400041E0(a1, a2, v47, v71, v48, v49, v65); return 0LL;} å€ŸåŠ©AIå¯ä»¥ä¼˜åŒ–å¾—åˆ°ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485__int64 __fastcall sub_140001936(char *input, char *output){ int v2; // r9d int v3; // r9d int v4; // r9d int v5; // r9d int v6; // r9d int v7; // r9d int v8; // r8d int v9; // r9d int v10; // edx int v11; // r8d int v12; // r9d int v13; // edx int v14; // r8d int v15; // r9d int v16; // r9d int v17; // r9d int v18; // r8d int v19; // r9d int v20; // edx int v21; // r8d int v22; // r9d int v23; // edx int v24; // r8d int v25; // r9d int v26; // edx int v27; // r8d int v28; // r9d int v29; // edx int v30; // r8d int v31; // r9d int v32; // edx int v33; // r8d int v34; // r9d int v35; // edx int v36; // r8d int v37; // r9d _BYTE v39[32]; // [rsp+20h] [rbp-60h] BYREF _BYTE outputFilename[32]; // [rsp+40h] [rbp-40h] BYREF _BYTE v41[32]; // [rsp+60h] [rbp-20h] BYREF _BYTE v42[44]; // [rsp+80h] [rbp+0h] BYREF char v43; // [rsp+ACh] [rbp+2Ch] BYREF char v44; // [rsp+ADh] [rbp+2Dh] BYREF char v45; // [rsp+AEh] [rbp+2Eh] BYREF char v46; // [rsp+AFh] [rbp+2Fh] BYREF _BYTE v47[32]; // [rsp+B0h] [rbp+30h] BYREF _BYTE v48[32]; // [rsp+D0h] [rbp+50h] BYREF _BYTE v49[32]; // [rsp+F0h] [rbp+70h] BYREF _BYTE v50[32]; // [rsp+110h] [rbp+90h] BYREF char *v51; // [rsp+130h] [rbp+B0h] char *v52; // [rsp+138h] [rbp+B8h] char *v53; // [rsp+140h] [rbp+C0h] char *v54; // [rsp+148h] [rbp+C8h] sub_140001D70(); v54 = &amp;v43; constructString(input, output, &quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025&quot;, v42, &amp;v43, v2); nothing(); // ä»€ä¹ˆä¹Ÿæ²¡æœ‰çš„ä¸€ä¸ªå‡½æ•° v53 = &amp;v44; constructString(input, output, &quot;flag.bmp&quot;, v41, &amp;v44, v3); nothing(); v52 = &amp;v45; constructString(input, output, &quot;enc.bmp&quot;, outputFilename, &amp;v45, v4); nothing(); v51 = &amp;v46; constructString(input, output, &quot;114514puiqneravcixpbhqn;afnv-92piwgspdifjv&quot;, v39, &amp;v46, v5); nothing(); makePath1(input, output, v42, v48, &quot;\\\\&quot;, v6); makePath2(input, output, v48, v47, v41, v7); makePath3(input, output, v47, v41, v8, v9); clearup(input, output, v10, v47, v11, v12); clearup(input, output, v13, v48, v14, v15); makePath1(input, output, v42, v50, &quot;\\\\&quot;, v16); makePath2(input, output, v50, v49, outputFilename, v17); makePath3(input, output, v49, outputFilename, v18, v19); clearup(input, output, v20, v49, v21, v22); clearup(input, output, v23, v50, v24, v25); encrypt(input, output, outputFilename, v41, v39, 1); clearup(input, output, v26, v39, v27, v28); clearup(input, output, v29, outputFilename, v30, v31); clearup(input, output, v32, v41, v33, v34); clearup(input, output, v35, v42, v36, v37); return 0LL;} è¿™é‡Œå®é™…ä¸Šæ˜¯åœ¨åˆå§‹åŒ–æ–‡ä»¶ç›¸å…³çš„ä¿¡æ¯ï¼Œç¨‹åºåº”è¯¥æ˜¯ä»E:\\WorkSpace\\Lab\\0xGame 2025ä¸‹è·å–flag.bmpï¼ŒåŠ å¯†åè¾“å‡ºä¸ºenc.bmpã€‚é‚£ä¸€ä¸²å­—ç¬¦ä¸²åº”è¯¥æ˜¯encryptå‡½æ•°ä½¿ç”¨çš„å¯†é’¥ã€‚encpytå‡½æ•°ä¼˜åŒ–åæ˜¯è¿™æ ·çš„ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120__int64 __fastcall encrypt( std::istream *input, char *output, __int64 outputFilename, __int64 inputfilename, __int64 a5, char a6){ __int64 v6; // rdx __int64 v7; // rdx __int64 v9; // rax __int64 v10; // rdx unsigned int v11; // ebx int v12; // eax __int64 v13; // rdx __int64 v14; // rdx __int64 v15; // rdx __int64 v17; // [rsp+20h] [rbp-60h] BYREF int v18; // [rsp+28h] [rbp-58h] unsigned __int16 v19; // [rsp+2Eh] [rbp-52h] __int64 v20; // [rsp+52h] [rbp-2Eh] BYREF _BYTE output_file_buffer[224]; // [rsp+60h] [rbp-20h] BYREF __int64 v22; // [rsp+140h] [rbp+C0h] BYREF _BYTE input_file_buffer[232]; // [rsp+250h] [rbp+1D0h] BYREF __int64 v24; // [rsp+338h] [rbp+2B8h] BYREF __int64 outputBuffer; // [rsp+448h] [rbp+3C8h] __int64 v26; // [rsp+450h] [rbp+3D0h] int v27; // [rsp+45Ch] [rbp+3DCh] __int64 header_buffer; // [rsp+460h] [rbp+3E0h] __int64 header_buffer_size; // [rsp+468h] [rbp+3E8h] std::ifstream::basic_ifstream(input, output, inputfilename, input_file_buffer, 4LL); std::ofstream::basic_ofstream(input, output, outputFilename, output_file_buffer, 4LL); if ( std::ios::operator!(input, output, v6, &amp;v24) || std::ios::operator!(input, output, v7, &amp;v22) ) { // é”™è¯¯å¤„ç† v9 = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(input, output, &amp;unk_7FF770D06000, &amp;std::cerr); std::ostream::operator&lt;&lt;(input, output, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;, v9); v11 = 0; } else { header_buffer_size = 1024LL; header_buffer = operator new[](input); std::istream::read(input, output, &amp;v20); // è·å–bitmap_file_header std::istream::read(input, output, &amp;v17); // è·å–bitmap_info_header std::istream::read(input, output, header_buffer); std::ostream::write(input, output, &amp;v20); std::ostream::write(input, output, &amp;v17); std::ostream::write(input, output, header_buffer); if ( header_buffer ) operator delete[](input); v12 = HIDWORD(v17) * v19 + 31; if ( v12 &lt; 0 ) v12 = HIDWORD(v17) * v19 + 62; v27 = 4 * (v12 &gt;&gt; 5); v26 = (v27 * abs32(v18)); outputBuffer = operator new[](input); std::istream::read(input, output, outputBuffer); std::ifstream::close(input, output, v13, input_file_buffer); if ( a6 ) modifiedRC4(input, output, v26, outputBuffer, a5); std::ostream::write(input, output, outputBuffer); std::ofstream::close(input, output, v14, output_file_buffer); if ( outputBuffer ) operator delete[](input); v11 = 1; } std::ofstream::~ofstream(input, output, v10, output_file_buffer); std::ifstream::~ifstream(input, output, v15, input_file_buffer); return v11;}//modifiedRC4__int64 __fastcall modifiedRC4(const char *a1, __int64 a2, int numOfDataBytes, __int64 outputBuffer, __int64 a5){ unsigned __int64 v5; // rax _BYTE *v6; // rax char v7; // dl __int64 result; // rax int i; // [rsp+24h] [rbp-Ch] int j; // [rsp+24h] [rbp-Ch] int k; // [rsp+24h] [rbp-Ch] int j_sbox; // [rsp+28h] [rbp-8h] int j_; // [rsp+28h] [rbp-8h] int i_sbox; // [rsp+2Ch] [rbp-4h] int i_; // [rsp+2Ch] [rbp-4h] for ( i = 0; i &lt;= 255; ++i ) S[i] = i; i_sbox = 0; j_sbox = 0; for ( j = 0; j &lt;= 255; ++j ) { i_sbox = (i_sbox + 1) % 256; a2 = S[i_sbox] + j_sbox; v5 = sub_7FF770D032B0(a1, a2, j_sbox, a5); v6 = sub_7FF770D033D0(a1, a2, i_sbox % v5, a5); v7 = a2 + *v6; LODWORD(v6) = ((a2 + *v6) &gt;&gt; 31) &gt;&gt; 24; j_sbox = (v6 + v7) - v6; swapbytes(a1, a2, &amp;S[j_sbox], &amp;S[i_sbox]); } i_ = 0; j_ = 0; for ( k = 0; ; ++k ) { result = ((numOfDataBytes / 256) &lt;&lt; 8); if ( k &gt;= result ) break; i_ = (i_ + 1) % 256; j_ = (S[i_] + j_) % 256; swapbytes(a1, a2, &amp;S[j_], &amp;S[i_]); swapBytes( a1, a2, (((k / 256) &lt;&lt; 8) + j_ + outputBuffer), // outputBuffer[((k/256)&lt;&lt;8)+j_] (outputBuffer + ((k / 256) &lt;&lt; 8) + i_)); // outputBuffer[((k/256)&lt;&lt;8)+i_] } return result;} ä»IDAçš„åç¼–è¯‘ç»“æœé‡Œå¯ä»¥å¾—åˆ°ä¸€äº›å¤§è‡´çš„å°è±¡ï¼šencryptå‡½æ•°åˆšå¼€å§‹å¯¹æ–‡ä»¶è¿›è¡Œäº†ä¸‰æ¬¡è¯»ä¸å†™ï¼Œé‡‡ç”¨çš„åŠ å¯†æ–¹å¼æ˜¯ç±»ä¼¼RC4çš„ç®—æ³•ï¼Œä½†æ˜¯ç›¸è¾ƒäºæ ‡å‡†RC4ï¼Œæ­¤å¤„åªæ˜¯å•çº¯çš„ç½®æ¢ï¼Œæ²¡æœ‰å¼‚æˆ–æ“ä½œã€‚ä¸ºäº†è¿›ä¸€æ­¥ç†è§£ç¨‹åºï¼Œæ¥ä¸‹æ¥å…ˆç ”ç©¶è¯»å†™æ–‡ä»¶çš„æ“ä½œé€»è¾‘ã€‚ ç®€å•äº†è§£ä¸€ä¸‹bmpæ–‡ä»¶æ ¼å¼ï¼Œå¯ä»¥çŸ¥é“æ–‡ä»¶å¼€å¤´å‰0x36hæ˜¯æ–‡ä»¶å¤´ï¼Œè¿™ä¸€éƒ¨åˆ†è‚¯å®šæ˜¯ä¸ä¼šæ€ä¹ˆå˜çš„ï¼Œå¦åˆ™å°±ä¼šæ”¹å˜æ–‡ä»¶çš„æ ¼å¼äº†ã€‚åœ¨ç”µè„‘é‡Œå¤åˆ»ä¸€ä¸ªä¸€æ‘¸ä¸€æ ·çš„è·¯å¾„ï¼Œè‡ªå·±åˆ›å»ºä¸€ä¸ªflag.bmpè¿è¡Œimg.exeå¯ä»¥å¾—åˆ°enc.bmpï¼Œæ­¤æ—¶ç”¨åå…­è¿›åˆ¶ç¼–è¾‘å™¨æ‰“å¼€ä¸¤ä¸ªæ–‡ä»¶å¯ä»¥å‘ç°å®ƒä»¬ä¹‹é—´å·®äº†1024bytesï¼Œæ›´å‡†ç¡®çš„è¯´ï¼Œæ˜¯åŠ å¯†åçš„æ–‡ä»¶æ¯”åŠ å¯†å‰å¤šäº†1024bytesã€‚ ä¸‹é¢è½¬ç”¨xdbgã€‚å¯¹ç…§IDAå¯ä»¥æ‰¾åˆ°è¯»å†™æ–‡ä»¶çš„ä½ç½®ï¼Œåˆ†æç»“æœå¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697989910010110210310410510610710810911011111211311411511611711811912012112212312412512612712812913013113213313413513613713813914014114214314414514614714814915015115215315415515615715815916016116216316416500007FF6077B164D | 55 | PUSH RBP | encrypt00007FF6077B164E | 53 | PUSH RBX |00007FF6077B164F | 48:81EC 78040000 | SUB RSP,478 |00007FF6077B1656 | 48:8DAC24 80000000 | LEA RBP,QWORD PTR SS:[RSP+80] | [rsp+80]:_register_onexit_function+21000007FF6077B165E | 48:898D 10040000 | MOV QWORD PTR SS:[RBP+410],RCX |00007FF6077B1665 | 48:8995 18040000 | MOV QWORD PTR SS:[RBP+418],RDX |00007FF6077B166C | 4C:8985 20040000 | MOV QWORD PTR SS:[RBP+420],R8 |00007FF6077B1673 | 44:89C8 | MOV EAX,R9D |00007FF6077B1676 | 8885 28040000 | MOV BYTE PTR SS:[RBP+428],AL |00007FF6077B167C | 48:8B95 10040000 | MOV RDX,QWORD PTR SS:[RBP+410] |00007FF6077B1683 | 48:8D85 D0010000 | LEA RAX,QWORD PTR SS:[RBP+1D0] |00007FF6077B168A | 41:B8 04000000 | MOV R8D,4 |00007FF6077B1690 | 48:89C1 | MOV RCX,RAX | rcx:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;, rax:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;00007FF6077B1693 | E8 E0050000 | CALL &lt;JMP.&amp;std::basic_ifstream&lt;char, std::char_traits&lt;ch | é”™è¯¯å¤„ç†00007FF6077B1698 | 48:8B95 18040000 | MOV RDX,QWORD PTR SS:[RBP+418] |00007FF6077B169F | 48:8D45 E0 | LEA RAX,QWORD PTR SS:[RBP-20] | [rbp-20]:&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;&quot;00007FF6077B16A3 | 41:B8 04000000 | MOV R8D,4 |00007FF6077B16A9 | 48:89C1 | MOV RCX,RAX | rcx:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;, rax:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;00007FF6077B16AC | E8 AF050000 | CALL &lt;JMP.&amp;std::basic_ofstream&lt;char, std::char_traits&lt;ch |00007FF6077B16B1 | 48:8D85 D0010000 | LEA RAX,QWORD PTR SS:[RBP+1D0] |00007FF6077B16B8 | 48:05 E8000000 | ADD RAX,E8 | rax:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;00007FF6077B16BE | 48:89C1 | MOV RCX,RAX | rcx:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;, rax:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;00007FF6077B16C1 | E8 DA050000 | CALL &lt;JMP.&amp;std::basic_ios&lt;char, std::char_traits&lt;char&gt; &gt; |00007FF6077B16C6 | 84C0 | TEST AL,AL |00007FF6077B16C8 | 75 16 | JNE img.7FF6077B16E0 |00007FF6077B16CA | 48:8D45 E0 | LEA RAX,QWORD PTR SS:[RBP-20] | [rbp-20]:&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;&quot;00007FF6077B16CE | 48:05 E0000000 | ADD RAX,E0 | rax:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;00007FF6077B16D4 | 48:89C1 | MOV RCX,RAX | rcx:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;, rax:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;00007FF6077B16D7 | E8 C4050000 | CALL &lt;JMP.&amp;std::basic_ios&lt;char, std::char_traits&lt;char&gt; &gt; |00007FF6077B16DC | 84C0 | TEST AL,AL |00007FF6077B16DE | 74 07 | JE img.7FF6077B16E7 |00007FF6077B16E0 | B8 01000000 | MOV EAX,1 |00007FF6077B16E5 | EB 05 | JMP img.7FF6077B16EC |00007FF6077B16E7 | B8 00000000 | MOV EAX,0 |00007FF6077B16EC | 84C0 | TEST AL,AL |00007FF6077B16EE | 74 32 | JE img.7FF6077B1722 |00007FF6077B16F0 | 48:8D15 09490000 | LEA RDX,QWORD PTR DS:[7FF6077B6000] | rdx:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\enc.bmp&quot;, 00007FF6077B6000:u8&quot;æ— æ³•æ‰“å¼€æ–‡ä»¶ï¼&quot;ame 2025\\\\enc.bmp&quot;00007FF6077B16F7 | 48:8B05 024F0000 | MOV RAX,QWORD PTR DS:[&lt;&amp;std::cerr&gt;] | rax:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;00007FF6077B16FE | 48:89C1 | MOV RCX,RAX | rcx:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;, rax:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;00007FF6077B1701 | E8 22050000 | CALL &lt;JMP.&amp;std::basic_ostream&lt;char, std::char_traits&lt;cha |00007FF6077B1706 | 48:89C1 | MOV RCX,RAX | rcx:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;, rax:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;00007FF6077B1709 | 48:8B05 004F0000 | MOV RAX,QWORD PTR DS:[&lt;&amp;JMP.&amp;std::basic_ostream&lt;char, st | rax:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;00007FF6077B1710 | 48:89C2 | MOV RDX,RAX | rdx:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\enc.bmp&quot;, rax:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;00007FF6077B1713 | E8 70050000 | CALL &lt;JMP.&amp;std::ostream::operator&lt;&lt;(std::ostream&amp; (*)(st |00007FF6077B1718 | BB 00000000 | MOV EBX,0 |00007FF6077B171D | E9 BD010000 | JMP img.7FF6077B18DF |00007FF6077B1722 | 48:C785 E8030000 00 | MOV QWORD PTR SS:[RBP+3E8],400 |00007FF6077B172D | B9 00040000 | MOV ECX,400 |00007FF6077B1732 | E8 D9040000 | CALL &lt;JMP.&amp;operator new[](unsigned long long)&gt; |00007FF6077B1737 | 48:8985 E0030000 | MOV QWORD PTR SS:[RBP+3E0],RAX |00007FF6077B173E | 48:8D55 D2 | LEA RDX,QWORD PTR SS:[RBP-2E] | RBP-2Eï¼šè¾“å…¥æµç¼“å†²åŒº1ï¼ˆå­˜æ”¾headerï¼‰00007FF6077B1742 | 48:8D85 D0010000 | LEA RAX,QWORD PTR SS:[RBP+1D0] |00007FF6077B1749 | 41:B8 0E000000 | MOV R8D,E | è¯»å–é•¿åº¦ï¼šEh00007FF6077B174F | 48:89C1 | MOV RCX,RAX | rcx:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;, rax:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;00007FF6077B1752 | E8 41050000 | CALL &lt;JMP.&amp;std::istream::read(char*, long long)&gt; | è¯»å…¥header00007FF6077B1757 | 48:8D55 A0 | LEA RDX,QWORD PTR SS:[RBP-60] | RBP-60ï¼šè¾“å…¥æµç¼“å†²åŒº2ï¼ˆå­˜æ”¾header infoï¼‰00007FF6077B175B | 48:8D85 D0010000 | LEA RAX,QWORD PTR SS:[RBP+1D0] |00007FF6077B1762 | 41:B8 28000000 | MOV R8D,28 | è¯»å–é•¿åº¦ï¼š28h00007FF6077B1768 | 48:89C1 | MOV RCX,RAX | rcx:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;, rax:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;00007FF6077B176B | E8 28050000 | CALL &lt;JMP.&amp;std::istream::read(char*, long long)&gt; | è¯»å…¥header info00007FF6077B1770 | 48:8B95 E0030000 | MOV RDX,QWORD PTR SS:[RBP+3E0] | [rbp-3E0]ï¼šè¾“å…¥æµç¼“å†²åŒº3ï¼ˆå­˜æ”¾æ–‡ä»¶å¤´åçš„1024bytes)00007FF6077B1777 | 48:8D85 D0010000 | LEA RAX,QWORD PTR SS:[RBP+1D0] |00007FF6077B177E | 41:B8 00040000 | MOV R8D,400 | è¯»å–é•¿åº¦ï¼š400h00007FF6077B1784 | 48:89C1 | MOV RCX,RAX | rcx:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;, rax:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;00007FF6077B1787 | E8 0C050000 | CALL &lt;JMP.&amp;std::istream::read(char*, long long)&gt; | è¯»å…¥æ–‡ä»¶å¤´åçš„1024bytes00007FF6077B178C | 48:8D55 D2 | LEA RDX,QWORD PTR SS:[RBP-2E] | [rbp-2E]ï¼šwriteå‚æ•°ï¼ˆheaderï¼‰00007FF6077B1790 | 48:8D45 E0 | LEA RAX,QWORD PTR SS:[RBP-20] | [rbp-20]:&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;&quot;00007FF6077B1794 | 41:B8 0E000000 | MOV R8D,E |00007FF6077B179A | 48:89C1 | MOV RCX,RAX | rcx:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;, rax:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;00007FF6077B179D | E8 EE040000 | CALL &lt;JMP.&amp;std::ostream::write(char const*, long long)&gt; | 00007FF6077B17A2 | 48:8D55 A0 | LEA RDX,QWORD PTR SS:[RBP-60] | [rbp-60]:&quot;114514puiqneravcixpbhqn;afnv-92piwgspdifjv&quot;00007FF6077B17A6 | 48:8D45 E0 | LEA RAX,QWORD PTR SS:[RBP-20] | [rbp-20]:&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;&quot;00007FF6077B17AA | 41:B8 28000000 | MOV R8D,28 | 28:'('00007FF6077B17B0 | 48:89C1 | MOV RCX,RAX | rcx:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;, rax:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;00007FF6077B17B3 | E8 D8040000 | CALL &lt;JMP.&amp;std::ostream::write(char const*, long long)&gt; |00007FF6077B17B8 | 48:8B95 E0030000 | MOV RDX,QWORD PTR SS:[RBP+3E0] |00007FF6077B17BF | 48:8D45 E0 | LEA RAX,QWORD PTR SS:[RBP-20] | [rbp-20]:&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;&quot;00007FF6077B17C3 | 41:B8 00040000 | MOV R8D,400 |00007FF6077B17C9 | 48:89C1 | MOV RCX,RAX | rcx:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;, rax:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;00007FF6077B17CC | E8 BF040000 | CALL &lt;JMP.&amp;std::ostream::write(char const*, long long)&gt; |00007FF6077B17D1 | 48:83BD E0030000 00 | CMP QWORD PTR SS:[RBP+3E0],0 |00007FF6077B17D9 | 74 0F | JE img.7FF6077B17EA |00007FF6077B17DB | 48:8B85 E0030000 | MOV RAX,QWORD PTR SS:[RBP+3E0] |00007FF6077B17E2 | 48:89C1 | MOV RCX,RAX | rcx:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;, rax:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;00007FF6077B17E5 | E8 36040000 | CALL &lt;JMP.&amp;operator delete[](void*)&gt; |00007FF6077B17EA | 8B55 A4 | MOV EDX,DWORD PTR SS:[RBP-5C] |00007FF6077B17ED | 0FB745 AE | MOVZX EAX,WORD PTR SS:[RBP-52] |00007FF6077B17F1 | 0FB7C0 | MOVZX EAX,AX |00007FF6077B17F4 | 0FAFC2 | IMUL EAX,EDX |00007FF6077B17F7 | 83C0 1F | ADD EAX,1F |00007FF6077B17FA | 8D50 1F | LEA EDX,QWORD PTR DS:[RAX+1F] |00007FF6077B17FD | 85C0 | TEST EAX,EAX |00007FF6077B17FF | 0F48C2 | CMOVS EAX,EDX |00007FF6077B1802 | C1F8 05 | SAR EAX,5 |00007FF6077B1805 | C1E0 02 | SHL EAX,2 |00007FF6077B1808 | 8985 DC030000 | MOV DWORD PTR SS:[RBP+3DC],EAX |00007FF6077B180E | 8B45 A8 | MOV EAX,DWORD PTR SS:[RBP-58] |00007FF6077B1811 | 99 | CDQ |00007FF6077B1812 | 31D0 | XOR EAX,EDX |00007FF6077B1814 | 29D0 | SUB EAX,EDX |00007FF6077B1816 | 0FAF85 DC030000 | IMUL EAX,DWORD PTR SS:[RBP+3DC] |00007FF6077B181D | 48:98 | CDQE |00007FF6077B181F | 48:8985 D0030000 | MOV QWORD PTR SS:[RBP+3D0],RAX |00007FF6077B1826 | 48:8B85 D0030000 | MOV RAX,QWORD PTR SS:[RBP+3D0] |00007FF6077B182D | 48:89C1 | MOV RCX,RAX | rcx:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;, rax:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;00007FF6077B1830 | E8 DB030000 | CALL &lt;JMP.&amp;operator new[](unsigned long long)&gt; |00007FF6077B1835 | 48:8985 C8030000 | MOV QWORD PTR SS:[RBP+3C8],RAX | 11100007FF6077B183C | 48:8B8D D0030000 | MOV RCX,QWORD PTR SS:[RBP+3D0] |00007FF6077B1843 | 48:8B95 C8030000 | MOV RDX,QWORD PTR SS:[RBP+3C8] | 11100007FF6077B184A | 48:8D85 D0010000 | LEA RAX,QWORD PTR SS:[RBP+1D0] |00007FF6077B1851 | 49:89C8 | MOV R8,RCX | r8:&amp;&quot;114514puiqneravcixpbhqn;afnv-92piwgspdifjv&quot;, rcx:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;&quot;00007FF6077B1854 | 48:89C1 | MOV RCX,RAX | rcx:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;, rax:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;00007FF6077B1857 | E8 3C040000 | CALL &lt;JMP.&amp;std::istream::read(char*, long long)&gt; |00007FF6077B185C | 48:8D85 D0010000 | LEA RAX,QWORD PTR SS:[RBP+1D0] |00007FF6077B1863 | 48:89C1 | MOV RCX,RAX | rcx:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;, rax:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;00007FF6077B1866 | E8 15040000 | CALL &lt;JMP.&amp;std::basic_ifstream&lt;char, std::char_traits&lt;ch |00007FF6077B186B | 80BD 28040000 00 | CMP BYTE PTR SS:[RBP+428],0 |00007FF6077B1872 | 74 24 | JE img.7FF6077B1898 |00007FF6077B1874 | 48:8B85 D0030000 | MOV RAX,QWORD PTR SS:[RBP+3D0] |00007FF6077B187B | 89C1 | MOV ECX,EAX |00007FF6077B187D | 48:8B95 20040000 | MOV RDX,QWORD PTR SS:[RBP+420] |00007FF6077B1884 | 48:8B85 C8030000 | MOV RAX,QWORD PTR SS:[RBP+3C8] | å…³æ³¨æ­¤å¤„[rbp+3C8]ï¼Œç–‘ä¼¼å­˜æ”¾å¤„ç†åçš„æ•°æ®çš„ç¼“å†²åŒº00007FF6077B188B | 49:89D0 | MOV R8,RDX | r8:&amp;&quot;114514puiqneravcixpbhqn;afnv-92piwgspdifjv&quot;, rdx:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\enc.bmp&quot;v&quot;00007FF6077B188E | 89CA | MOV EDX,ECX |00007FF6077B1890 | 48:89C1 | MOV RCX,RAX | rcx:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;, rax:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;00007FF6077B1893 | E8 A8FBFFFF | CALL img.7FF6077B1440 | modifiedRC400007FF6077B1898 | 48:8B8D D0030000 | MOV RCX,QWORD PTR SS:[RBP+3D0] |00007FF6077B189F | 48:8B95 C8030000 | MOV RDX,QWORD PTR SS:[RBP+3C8] | [rbp+3C8]ï¼šè¾“å‡ºçš„å›¾åƒæ•°æ®00007FF6077B18A6 | 48:8D45 E0 | LEA RAX,QWORD PTR SS:[RBP-20] | [rbp-20]:&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;&quot;00007FF6077B18AA | 49:89C8 | MOV R8,RCX | R8ï¼šæ•°æ®é•¿åº¦00007FF6077B18AD | 48:89C1 | MOV RCX,RAX | rcx:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;, rax:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;00007FF6077B18B0 | E8 DB030000 | CALL &lt;JMP.&amp;std::ostream::write(char const*, long long)&gt; | å†™å…¥åŠ å¯†åçš„æ•°æ®00007FF6077B18B5 | 48:8D45 E0 | LEA RAX,QWORD PTR SS:[RBP-20] | [rbp-20]:&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;&quot;00007FF6077B18B9 | 48:89C1 | MOV RCX,RAX | rcx:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;, rax:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;00007FF6077B18BC | E8 A7030000 | CALL &lt;JMP.&amp;std::basic_ofstream&lt;char, std::char_traits&lt;ch |00007FF6077B18C1 | 48:83BD C8030000 00 | CMP QWORD PTR SS:[RBP+3C8],0 |00007FF6077B18C9 | 74 0F | JE img.7FF6077B18DA |00007FF6077B18CB | 48:8B85 C8030000 | MOV RAX,QWORD PTR SS:[RBP+3C8] |00007FF6077B18D2 | 48:89C1 | MOV RCX,RAX | rcx:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;, rax:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;00007FF6077B18D5 | E8 46030000 | CALL &lt;JMP.&amp;operator delete[](void*)&gt; | 00007FF6077B18DA | BB 01000000 | MOV EBX,1 |00007FF6077B18DF | 48:8D45 E0 | LEA RAX,QWORD PTR SS:[RBP-20] | [rbp-20]:&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;&quot;00007FF6077B18E3 | 48:89C1 | MOV RCX,RAX | rcx:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;, rax:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;00007FF6077B18E6 | E8 6D030000 | CALL &lt;JMP.&amp;std::basic_ofstream&lt;char, std::char_traits&lt;ch |00007FF6077B18EB | 48:8D85 D0010000 | LEA RAX,QWORD PTR SS:[RBP+1D0] |00007FF6077B18F2 | 48:89C1 | MOV RCX,RAX | rcx:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;, rax:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;00007FF6077B18F5 | E8 76030000 | CALL &lt;JMP.&amp;std::basic_ifstream&lt;char, std::char_traits&lt;ch |00007FF6077B18FA | 89D8 | MOV EAX,EBX |00007FF6077B18FC | EB 2E | JMP img.7FF6077B192C |00007FF6077B18FE | 48:89C3 | MOV RBX,RAX | rax:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;00007FF6077B1901 | 48:8D45 E0 | LEA RAX,QWORD PTR SS:[RBP-20] | [rbp-20]:&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;&quot;00007FF6077B1905 | 48:89C1 | MOV RCX,RAX | rcx:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;, rax:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;00007FF6077B1908 | E8 4B030000 | CALL &lt;JMP.&amp;std::basic_ofstream&lt;char, std::char_traits&lt;ch |00007FF6077B190D | EB 03 | JMP img.7FF6077B1912 |00007FF6077B190F | 48:89C3 | MOV RBX,RAX | rax:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;00007FF6077B1912 | 48:8D85 D0010000 | LEA RAX,QWORD PTR SS:[RBP+1D0] |00007FF6077B1919 | 48:89C1 | MOV RCX,RAX | rcx:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;, rax:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;00007FF6077B191C | E8 4F030000 | CALL &lt;JMP.&amp;std::basic_ifstream&lt;char, std::char_traits&lt;ch |00007FF6077B1921 | 48:89D8 | MOV RAX,RBX | rax:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;00007FF6077B1924 | 48:89C1 | MOV RCX,RAX | rcx:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;, rax:&amp;&quot;E:\\\\WorkSpace\\\\Lab\\\\0xGame 2025\\\\flag.bmp&quot;00007FF6077B1927 | E8 74140000 | CALL &lt;JMP.&amp;_Unwind_Resume&gt; |00007FF6077B192C | 48:81C4 78040000 | ADD RSP,478 |00007FF6077B1933 | 5B | POP RBX |00007FF6077B1934 | 5D | POP RBP |00007FF6077B1935 | C3 | RET | é€šè¿‡è·Ÿè¸ªä¸‰æ¬¡readçš„å‚æ•°ï¼ˆæŸ¥çœ‹è¯»å…¥å†…å­˜çš„æ•°æ®ï¼‰å¯ä»¥å‘ç°ï¼Œç¨‹åºé™¤äº†è¯»å–æ–‡ä»¶å¤´ä¹‹å¤–è¿˜è¯»å–äº†éšåçš„1024bytesã€‚è¿™åˆšå¼€å§‹å…¶å®åªæ˜¯ä¸€ä¸ªçŒœæƒ³ï¼Œä½†æ˜¯é€šè¿‡ä¿®æ”¹è‡ªå·±åˆ›å»ºçš„flag.bmpæ–‡ä»¶å¤´åçš„éƒ¨åˆ†æ•°æ®å¯ä»¥éªŒè¯çŒœæƒ³ ç»§ç»­è¿è¡Œç¨‹åºï¼Œå¯ä»¥å‘ç°ç”Ÿæˆçš„enc.bmpä¸­ä¿ç•™äº†è¿™ä¸€éƒ¨åˆ†ä¿®æ”¹åçš„æ•°æ®ï¼Œäºæ˜¯çŒœæƒ³ç¨‹åºåœ¨åŠ å¯†ç»“æœä¸­ä¿ç•™äº†è¾“å…¥æµç¼“å†²åŒº3çš„1024bytesï¼Œå¯ä»¥é€šè¿‡æ‰©å¤§ä¿®æ”¹çš„æ•°æ®èŒƒå›´æ¥éªŒè¯çŒœæƒ³ï¼ˆè¿™é‡Œé€‰æ‹©è¿›ä¸€æ­¥ä¿®æ”¹flag.bmpé‡Œ1024bytesçš„ç»“å°¾ï¼Œè¿™æ ·å¼€å¤´ç»“å°¾éƒ½æœ‰è¢«ä¿®æ”¹çš„ç‰¹å¾äº†ï¼‰ äºæ˜¯åŠ å¯†ç»“æœä¸­å¤šå‡ºæ¥çš„1024bytesæ¥æºå°±æ˜¾è€Œæ˜“è§äº†ã€‚è‡³æ­¤ï¼Œç¨‹åºè¯»å†™æ–‡ä»¶çš„é€»è¾‘åŸºæœ¬å¯ä»¥æ˜ç¡®äº†ï¼šå…ˆä¿ç•™æ–‡ä»¶å¤´ï¼ˆ0-0x36hï¼‰å’Œæ–‡ä»¶å¤´åçš„1024bytesï¼Œç„¶åè¯»å–æ–‡ä»¶å¤´ä¹‹å¤–çš„æ•°æ®ï¼ˆ0x36h-0x3589A9hï¼‰è¿›è¡ŒåŠ å¯†ï¼ŒåŠ å¯†å®Œæˆåå…ˆå‘enc.bmpå†™å…¥äº‹å…ˆä¿ç•™çš„æ–‡ä»¶å¤´å’Œ1024bytesï¼Œå†æ‹¼æ¥ä¸ŠåŠ å¯†åçš„æ•°æ® 12flag.bmp:æ–‡ä»¶å¤´(å¤§å°0x36h)+å›¾ç‰‡æ•°æ®(å¤§å°0x358974h)enc.bmp:æ–‡ä»¶å¤´(å¤§å°0x36h)+å›¾ç‰‡æ•°æ®å‰1024bytes(å¤§å°0x400h)+åŠ å¯†åçš„å›¾ç‰‡æ•°æ®(å¤§å°0x358974h) è§£å†³å®Œæ–‡ä»¶è¯»å†™é€»è¾‘åˆ†æåï¼Œæ¥ä¸‹æ¥ç€æ‰‹è§£å†³ç®—æ³•é€†å‘ã€‚ä¸‹é¢æ˜¯modefiedRC4çš„è¯¦ç»†åˆ†æ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647__int64 __fastcall modifiedRC4(const char *input, __int64 a2, int numOfDataBytes, __int64 outputBuffer, __int64 key){ unsigned __int64 v5; // rax _BYTE *v6; // rax char v7; // dl __int64 numOfEncBytes; // rax int i; // [rsp+24h] [rbp-Ch] int j; // [rsp+24h] [rbp-Ch] int k; // [rsp+24h] [rbp-Ch] int j_sbox; // [rsp+28h] [rbp-8h] int j_; // [rsp+28h] [rbp-8h] int i_sbox; // [rsp+2Ch] [rbp-4h] int i_; // [rsp+2Ch] [rbp-4h] for ( i = 0; i &lt;= 255; ++i ) S[i] = i; i_sbox = 0; j_sbox = 0; for ( j = 0; j &lt;= 255; ++j ) { i_sbox = (i_sbox + 1) % 256; a2 = S[i_sbox] + j_sbox; v5 = sub_7FF7688232B0(input, a2, j_sbox, key);// å®é™…ä¸Šreturn key[8]ï¼Œè°ƒè¯•å¯ä»¥å‘ç°v5å³key[8]æ˜¯0x2Aï¼Œå¯¹åº”å¯†é’¥é•¿åº¦ v6 = sub_7FF7688233D0(input, a2, i_sbox % v5, key);// if(key_len &gt;= i_sbox%key_len ) return key[i_sbox%key_len] v7 = a2 + *v6; // v7=S[i_sbox] + j_sbox + key[i_sbox%key_len] LODWORD(v6) = ((a2 + *v6) &gt;&gt; 31) &gt;&gt; 24; j_sbox = (v6 + v7) - v6; // è¿™ä¸¤æ­¥å®é™…ä¸Šç­‰ä»·ä¸ºj_sbox = j_sboxv7%256 swapbytes(input, a2, &amp;S[j_sbox], &amp;S[i_sbox]);// å®é™…ä¸Šæ˜¯swapbytes(&amp;S[j_sbox],&amp;S[i_sbox])ï¼Œå‰ä¸¤ä¸ªå‚æ•°æ²¡æœ‰ä½¿ç”¨ } i_ = 0; j_ = 0; for ( k = 0; ; ++k ) { numOfEncBytes = ((numOfDataBytes / 256) &lt;&lt; 8);// æ€»æ•°æ®é‡å¯¹256å‘ä¸‹å–æ•´ï¼Œä¿è¯åŠ å¯†æ•°æ®é‡ä¸º256å€æ•° if ( k &gt;= numOfEncBytes ) // kä»0å¼€å§‹ç›´åˆ°æœ€å¤§åŠ å¯†æ•°æ®é‡ break; i_ = (i_ + 1) % 256; j_ = (S[i_] + j_) % 256; swapbytes(input, a2, &amp;S[j_], &amp;S[i_]); swapBytes( input, a2, (((k / 256) &lt;&lt; 8) + j_ + outputBuffer), // outputBuffer[((k/256)&lt;&lt;8)+j_]ï¼Œæ­¤å¤„(k/256)&lt;&lt;8å³å–æ¯å—256bytesçš„åŸºå€ï¼Œå› æ­¤äº¤æ¢èŒƒå›´æ˜¯å½“å‰æ‰€åœ¨çš„256byteså— (outputBuffer + ((k / 256) &lt;&lt; 8) + i_)); // outputBuffer[((k/256)&lt;&lt;8)+i_] } return numOfEncBytes;} ç®—æ³•ä¸­ç¬¬ä¸€ã€äºŒä¸ªå¾ªç¯åœ¨åˆå§‹åŒ–Sç›’ï¼Œæ²¡æœ‰å¯¹è¾“å‡ºæ•°æ®outputBufferè¿›è¡Œå¤„ç†ï¼Œç¬¬ä¸‰ä¸ªå¾ªç¯æ‰åˆ©ç”¨Sç›’çš„æ•°æ®æ¥åŠ å¯†outputBufferã€‚åŠ å¯†outputBufferçš„æ—¶å€™ï¼Œè®°å½•äº†åŠ å¯†çš„æ•°æ®é‡ï¼ŒåŠ å¯†è½®æ•°å’ŒåŠ å¯†æ•°æ®é‡ä¸€è‡´ã€‚æ¯è½®åŠ å¯†åŒæ­¥äº¤æ¢äº† i_ å’Œ j_ å¤„çš„Sç›’æ•°æ®ä»¥åŠoutputBufferæ•°æ®ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯outputBufferåœ¨äº¤æ¢çš„æ—¶å€™è¢«åˆ†æˆäº†è‹¥å¹²ä¸ª256byteså—ï¼Œäº¤æ¢åœ¨æ¯ä¸ª256byteså—å†…è¿›è¡Œã€‚æœ€ç›´è§‚çš„è§£å¯†ç®—æ³•æ˜¯è®°å½•ä¸‹æ¯è½®åŠ å¯†ä½¿ç”¨çš„ i_ å’Œ j_ ï¼Œç„¶åé€†åºä½¿ç”¨è¿™äº›ç´¢å¼•å¯¹äº¤æ¢æ•°æ®ã€‚è§£å¯†è„šæœ¬å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748def decrypt(input,output): with open(input,'rb') as f: enc=f.read() bmp_header=enc[:0x36]#ä¿ç•™æ–‡ä»¶å¤´ enc_data=bytearray(enc[0x436:])#åŠ å¯†æ•°æ®ä¸ºæ–‡ä»¶å¤´+1024bytesåçš„æ•°æ®ï¼Œèµ·å§‹åç§»å³ä¸º0x436 data_len=len(enc_data) aligned_len=(data_len//256)*256#æ€»æ•°æ®é‡å‘ä¸‹å¯¹256å–æ•´ï¼Œå³ä¿è¯æ•°æ®é‡ä¸º256çš„å€æ•° key=&quot;114514puiqneravcixpbhqn;afnv-92piwgspdifjv&quot; key_len=len(key) #åˆå§‹åŒ–Sç›’ S=list(range(256)) j_sbox=0 i_sbox=0 for i in range(256): i_sbox=(i_sbox+1)%256 j_sbox=(j_sbox+S[i_sbox]+ord(key[i_sbox%key_len]))%256 S[i_sbox],S[j_sbox]=S[j_sbox],S[i_sbox] #è§£å¯† #ç”Ÿæˆäº¤æ¢å¯¹ i_=0 j_=0 swap_couples=[] for k in range(aligned_len): i_=(i_+1)%256 j_=(j_+S[i_])%256 S[i_],S[j_]=S[j_],S[i_] base=(k//256)*256#å–æ¯å—256bytesçš„åŸºå€ pos1=base+i_ pos2=base+j_ if pos1&lt;aligned_len and pos2&lt;aligned_len: swap_couples.append((pos1,pos2)) #é€†åºä½¿ç”¨äº¤æ¢å¯¹ï¼Œè§£å¯†æ•°æ® for pos1,pos2 in reversed(swap_couples): enc_data[pos1],enc_data[pos2]=enc_data[pos2],enc_data[pos1] with open(output,'wb') as f: f.write(bmp_header) f.write(enc_data) print(&quot;[+]decrypt done!&quot;)decrypt(&quot;enc.bmp&quot;,&quot;flag.bmp&quot;) è§£å¯†å¯ä»¥å¾—åˆ°ä¸‹å›¾ï¼ˆæ²¡æœ‰å®Œå…¨è§£å¯†æˆåŠŸï¼Œä½†æ˜¯ä¸å½±å“æ‹¿åˆ°flagï¼‰ flagï¼š0xGame{5d0e6f18-ebc0-4231-b0e6-a5821327aefd} è”·è–‡åœ°ç‹± è€ƒç‚¹ï¼šå¤æ‚ç¨‹åºåˆ†æï¼ŒRSAè§£å¯† éš¾ç‚¹è¿˜æ˜¯åœ¨äºå¤æ‚ é™„ä»¶æ˜¯ä¸€ä¸ªInt.exeï¼Œä¸€ä¸ªæµé‡åŒ…ï¼Œè¿˜æœ‰ä¸¤ä¸ªencæ–‡ä»¶ã€‚è¿è¡Œç¨‹åºä¼šæ˜¾ç¤ºconnect failedç„¶åæ‰“å°ä¸€äº›æ•°æ®åé—ªé€€ï¼ŒåŒæ—¶åŒä¸€ç›®å½•ä¸‹çš„æ–‡ä»¶ä¼šè¢«åŠ å¯†ç”ŸæˆåŠ å¯†æ–‡ä»¶ ç”¨IDAæ‰“å¼€ç¨‹åºï¼Œshift+F12å¯ä»¥åœ¨å­—ç¬¦ä¸²çª—å£æ‰¾åˆ°è¿è¡Œç¨‹åºæ—¶æ˜¾ç¤ºçš„â€connect failedâ€ï¼ˆä»¥åŠå…¶ä»–ä¸€äº›çœ‹èµ·æ¥å’Œç½‘ç»œé€šä¿¡æœ‰å…³çš„å­—ç¬¦ä¸²ï¼Œå¦‚â€127.0.0.1â€ï¼Œâ€socket failedâ€ï¼‰ ç„¶åå¯ä»¥è·Ÿè¸ªåˆ°ä¸‹é¢è¿™æ ·ä¸€ä¸ªå¾ˆåƒç½‘ç»œé€šä¿¡çš„å‡½æ•° 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101__int64 __fastcall sub_140003D46(__int64 a1, __int64 a2, u_short a3, int a4){ __int64 v4; // rbx unsigned int Error; // eax __int64 v6; // rax unsigned int v7; // ebx __int64 v8; // rbx unsigned int v9; // eax __int64 v10; // rax int v11; // r8d int v12; // r9d __int64 v13; // rbx unsigned int v14; // eax __int64 v15; // rax int v16; // edx int v17; // r8d int v18; // r9d int v19; // ebx int v20; // edx int v21; // r8d int v22; // r9d const char *v23; // rax __int64 v24; // rbx unsigned int v25; // eax __int64 v26; // rax __int64 v27; // rax __int64 v28; // rax __int64 v29; // rax int v30; // edx int v31; // r8d int v32; // r9d __int64 v34[4]; // [rsp+0h] [rbp-80h] BYREF _BYTE v35[32]; // [rsp+20h] [rbp-60h] BYREF sockaddr name; // [rsp+40h] [rbp-40h] BYREF unsigned int v37; // [rsp+1F4h] [rbp+174h] SOCKET s; // [rsp+1F8h] [rbp+178h] if ( WSAStartup(0x202u, (LPWSADATA)&amp;v34[10]) ) { v4 = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(a1, a2, &quot;WSAStartup failed: &quot;, &amp;std::cerr); Error = WSAGetLastError(); v6 = std::ostream::operator&lt;&lt;(a1, a2, Error, v4); std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(a1, a2, &quot;\\n&quot;, v6); return 1; } else { s = socket(2, 1, 0); if ( s == -1LL ) { v8 = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(a1, a2, &quot;socket failed: &quot;, &amp;std::cerr); v9 = WSAGetLastError(); v10 = std::ostream::operator&lt;&lt;(a1, a2, v9, v8); std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(a1, a2, &quot;\\n&quot;, v10); WSACleanup(); return 1; } else { name.sa_family = 2; *(_WORD *)name.sa_data = htons(a3); *(_DWORD *)&amp;name.sa_data[2] = inet_addr(&quot;127.0.0.1&quot;); if ( connect(s, &amp;name, 16) == -1 ) { v13 = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(a1, a2, &quot;connect failed: &quot;, &amp;std::cerr); v14 = WSAGetLastError(); v15 = std::ostream::operator&lt;&lt;(a1, a2, v14, v13); std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(a1, a2, &quot;\\n&quot;, v15); closesocket(s); WSACleanup(); return 1; } else { sub_140001760(a1, a2, a4, (unsigned int)v35, v11, v12, v34[0], v34[1]); v19 = sub_1400087B0(a1, a2, v16, (unsigned int)v35, v17, v18, v34[0]); v23 = (const char *)sub_1400087F0(a1, a2, v20, (unsigned int)v35, v21, v22, v34[0]); v37 = send(s, v23, v19, 0); if ( v37 == -1 ) { v24 = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(a1, a2, &quot;send failed: &quot;, &amp;std::cerr); v25 = WSAGetLastError(); v26 = std::ostream::operator&lt;&lt;(a1, a2, v25, v24); } else { v27 = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(a1, a2, &quot;Sent &quot;, &amp;std::cout); v28 = std::ostream::operator&lt;&lt;(a1, a2, v37, v27); v29 = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(a1, a2, &quot; bytes: &quot;, v28); v26 = std::operator&lt;&lt;&lt;char&gt;(a1, a2, v35, v29); } std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(a1, a2, &quot;\\n&quot;, v26); closesocket(s); WSACleanup(); v7 = 0; sub_14000B400(a1, a2, v30, (unsigned int)v35, v31, v32, v34[0]); } } } return v7;} å›æº¯åˆ°ä¸Šçº§å‡½æ•°ï¼Œå¯ä»¥å¾—åˆ°ä¸€ä¸ªå¿«700è¡Œä»£ç çš„å‡½æ•°ã€‚ä»£ç é‡å¤ªå¤§ï¼Œäººå·¥åˆ†æå¾ˆæœ‰éš¾åº¦ï¼Œäºæ˜¯å€ŸåŠ©AIæ¥åˆ†æå¤§è‡´é€»è¾‘ã€‚åœ¨å…³é”®åœ°æ–¹åŠ ä¸Šæ³¨é‡Šåçš„å‡½æ•°å¦‚ä¸‹ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428429430431432433434435436437438439440441442443444445446447448449450451452453454455456457458459460461462463464465466467468469470471472473474475476477478479480481482483484485486487488489490491492493494495496497498499500501502503504505506507508509510511512513514515516517518519520521522523524525526527528529530531532533534535536537538539540541542543544545546547548549550551552553554555556557558559560561562563564565566567568569570571572573574575576577578579580581582583584585586587588589590591592593594595596597598599600601602603604605606607608609610611612613614615616617618619620621622623624625626627628629630631632633634635636637638639640641642643644645646647648649650651652653654655656657658659660661662663664665666667668669670671672673674675676677678679680681682683684685686687688689690691692__int64 __fastcall sub_140005769(__int64 a1, __int64 a2, _QWORD *a3, int a4){ int v4; // r9d char v5; // bl int v6; // esi int v7; // edx int v8; // r8d int v9; // r9d char v10; // bl int v11; // esi int v12; // edx int v13; // r8d int v14; // r9d char v15; // bl __int64 v16; // rsi int v17; // edx int v18; // r8d int v19; // r9d int v20; // edx int v21; // r8d int v22; // r9d unsigned int v23; // ebx int v24; // r8d int v25; // r9d int v26; // r8d int v27; // r9d int v28; // edx int v29; // r8d int v30; // r9d int v31; // r8d int v32; // r9d int v33; // r8d int v34; // r9d int v35; // edx int v36; // r8d int v37; // r9d int v38; // r8d int v39; // r9d __int64 v40; // rax int v41; // edx int v42; // r8d int v43; // r9d int v44; // edx int v45; // r8d int v46; // r9d int v47; // r8d int v48; // r9d __int64 v49; // rax int v50; // edx int v51; // r8d int v52; // r9d int v53; // edx int v54; // r8d int v55; // r9d int v56; // r8d int v57; // r9d int v58; // edx int v59; // r8d int v60; // r9d int v61; // edx int v62; // r8d int v63; // r9d int v64; // r8d int v65; // r9d int v66; // edx int v67; // r8d int v68; // r9d int v69; // edx int v70; // r8d int v71; // r9d __int64 v72; // rbx int v73; // r8d int v74; // r9d __int64 v75; // rax int v76; // edx int v77; // r8d int v78; // r9d int v79; // edx int v80; // r8d int v81; // r9d __int64 v82; // rbx int v83; // r8d int v84; // r9d __int64 v85; // rax int v86; // edx int v87; // r8d int v88; // r9d int v89; // edx int v90; // r8d int v91; // r9d __int64 v92; // rdx int v93; // r8d int v94; // r9d int v95; // edx int v96; // r8d int v97; // r9d int v98; // r8d int v99; // r9d int v100; // r8d int v101; // r9d int v102; // edx int v103; // r8d int v104; // r9d int v105; // r8d int v106; // r9d int v107; // r8d int v108; // r9d int v109; // edx int v110; // r8d int v111; // r9d int v112; // r8d int v113; // r9d int v114; // edx int v115; // r8d int v116; // r9d __int64 v117; // rdx int v118; // r8d int v119; // r9d int v120; // eax int v121; // r8d int v122; // r9d char v123; // r12 char v124; // r13 char v125; // r14 char v126; // r15 int v127; // r8d int v128; // r9d int v129; // r8d int v130; // r9d int v131; // r8d int v132; // r9d int v133; // edx int v134; // r8d int v135; // r9d int v136; // r8d int v137; // r9d int v138; // r8d int v139; // r9d int v140; // r8d int v141; // r9d int v142; // r8d int v143; // r9d int v144; // r8d int v145; // r9d int v146; // r8d int v147; // r9d int v148; // edx int v149; // r8d int v150; // r9d int v151; // edx int v152; // r8d int v153; // r9d int v154; // r8d int v155; // r9d int v156; // r8d int v157; // r9d char v158; // bl int v159; // edx int v160; // r8d int v161; // r9d int v162; // edx int v163; // r8d int v164; // r9d __int64 v165; // rbx int v166; // r8d int v167; // r9d __int64 v168; // rax int v169; // edx int v170; // r8d int v171; // r9d int v172; // r8d int v173; // r9d int v174; // r8d int v175; // r9d int v176; // r9d int v177; // r9d int v178; // r9d __int64 v179; // rdx __int64 v180; // rdx int v181; // edx int v182; // r8d int v183; // r9d int v184; // r8d int v185; // r9d int v186; // r8d int v187; // r9d char v188; // bl int v189; // edx int v190; // r8d int v191; // r9d int v192; // edx int v193; // r8d int v194; // r9d __int64 v195; // rbx int v196; // r8d int v197; // r9d __int64 v198; // rax int v199; // edx int v200; // r8d int v201; // r9d int v202; // r8d int v203; // r9d int v204; // r9d int v205; // edx int v206; // r8d int v207; // r9d int v208; // r9d int v209; // r9d int v210; // r9d __int64 v211; // rdx __int64 v212; // rdx int v213; // edx int v214; // r8d int v215; // r9d __int64 v216; // rdx int v217; // r8d int v218; // r9d int v219; // edx int v220; // r8d int v221; // r9d int v222; // edx int v223; // r8d int v224; // r9d int v225; // edx int v226; // r8d int v227; // r9d int v228; // edx int v229; // r8d int v230; // r9d __int64 v232; // [rsp+0h] [rbp-80h] __int64 v233; // [rsp+0h] [rbp-80h] __int64 v234; // [rsp+0h] [rbp-80h] __int64 v235; // [rsp+0h] [rbp-80h] __int64 v236; // [rsp+0h] [rbp-80h] __int64 v237; // [rsp+0h] [rbp-80h] __int64 v238; // [rsp+0h] [rbp-80h] __int64 v239; // [rsp+0h] [rbp-80h] __int64 v240; // [rsp+0h] [rbp-80h] __int64 v241; // [rsp+0h] [rbp-80h] __int64 v242; // [rsp+0h] [rbp-80h] __int64 v243; // [rsp+0h] [rbp-80h] __int64 v244; // [rsp+0h] [rbp-80h] __int64 v245; // [rsp+0h] [rbp-80h] __int64 v246; // [rsp+0h] [rbp-80h] __int64 v247; // [rsp+0h] [rbp-80h] __int64 v248; // [rsp+0h] [rbp-80h] __int64 v249; // [rsp+0h] [rbp-80h] __int64 v250; // [rsp+0h] [rbp-80h] __int64 v251; // [rsp+0h] [rbp-80h] __int64 v252; // [rsp+0h] [rbp-80h] __int64 v253; // [rsp+0h] [rbp-80h] __int64 v254; // [rsp+0h] [rbp-80h] __int64 v255; // [rsp+0h] [rbp-80h] __int64 v256; // [rsp+0h] [rbp-80h] __int64 v257; // [rsp+0h] [rbp-80h] __int64 v258; // [rsp+0h] [rbp-80h] __int64 v259; // [rsp+0h] [rbp-80h] __int64 v260; // [rsp+0h] [rbp-80h] __int64 v261; // [rsp+0h] [rbp-80h] __int64 v262; // [rsp+0h] [rbp-80h] __int64 v263; // [rsp+0h] [rbp-80h] __int64 v264; // [rsp+0h] [rbp-80h] __int64 v265; // [rsp+0h] [rbp-80h] __int64 v266; // [rsp+0h] [rbp-80h] __int64 v267; // [rsp+0h] [rbp-80h] __int64 v268; // [rsp+0h] [rbp-80h] __int64 v269; // [rsp+0h] [rbp-80h] __int64 v270; // [rsp+0h] [rbp-80h] __int64 v271; // [rsp+0h] [rbp-80h] __int64 v272; // [rsp+0h] [rbp-80h] __int64 v273; // [rsp+0h] [rbp-80h] __int64 v274; // [rsp+0h] [rbp-80h] __int64 v275; // [rsp+0h] [rbp-80h] __int64 v276; // [rsp+0h] [rbp-80h] __int64 v277; // [rsp+0h] [rbp-80h] __int64 v278; // [rsp+0h] [rbp-80h] __int64 v279; // [rsp+0h] [rbp-80h] __int64 v280; // [rsp+0h] [rbp-80h] __int64 v281; // [rsp+0h] [rbp-80h] __int64 v282; // [rsp+0h] [rbp-80h] __int64 v283; // [rsp+0h] [rbp-80h] HCRYPTKEY v284; // [rsp+0h] [rbp-80h] __int64 v285; // [rsp+0h] [rbp-80h] __int64 v286; // [rsp+0h] [rbp-80h] __int64 v287; // [rsp+0h] [rbp-80h] __int64 v288; // [rsp+0h] [rbp-80h] __int64 v289; // [rsp+0h] [rbp-80h] __int64 v290; // [rsp+0h] [rbp-80h] __int64 v291; // [rsp+0h] [rbp-80h] __int64 v292; // [rsp+0h] [rbp-80h] __int64 v293; // [rsp+0h] [rbp-80h] __int64 v294; // [rsp+0h] [rbp-80h] __int64 v295; // [rsp+0h] [rbp-80h] HCRYPTKEY v296; // [rsp+0h] [rbp-80h] __int64 v297; // [rsp+0h] [rbp-80h] __int64 v298; // [rsp+0h] [rbp-80h] __int64 v299; // [rsp+0h] [rbp-80h] __int64 v300; // [rsp+0h] [rbp-80h] __int64 v301; // [rsp+0h] [rbp-80h] __int64 v302; // [rsp+0h] [rbp-80h] __int64 v303; // [rsp+8h] [rbp-78h] __int64 v304; // [rsp+8h] [rbp-78h] __int64 v305; // [rsp+8h] [rbp-78h] __int64 v306; // [rsp+8h] [rbp-78h] __int64 v307; // [rsp+8h] [rbp-78h] __int64 v308; // [rsp+8h] [rbp-78h] __int64 v309; // [rsp+8h] [rbp-78h] __int64 v310; // [rsp+8h] [rbp-78h] __int64 v311; // [rsp+8h] [rbp-78h] __int64 v312; // [rsp+8h] [rbp-78h] __int64 v313; // [rsp+8h] [rbp-78h] __int64 v314; // [rsp+8h] [rbp-78h] __int64 v315; // [rsp+8h] [rbp-78h] __int64 v316; // [rsp+8h] [rbp-78h] __int64 v317; // [rsp+8h] [rbp-78h] __int64 v318; // [rsp+8h] [rbp-78h] __int64 v319; // [rsp+8h] [rbp-78h] __int64 v320; // [rsp+8h] [rbp-78h] __int64 v321; // [rsp+8h] [rbp-78h] __int64 v322; // [rsp+8h] [rbp-78h] __int64 v323; // [rsp+8h] [rbp-78h] __int64 v324; // [rsp+8h] [rbp-78h] __int64 v325; // [rsp+8h] [rbp-78h] __int64 v326; // [rsp+8h] [rbp-78h] __int64 v327; // [rsp+8h] [rbp-78h] __int64 v328; // [rsp+8h] [rbp-78h] __int64 v329; // [rsp+8h] [rbp-78h] __int64 v330; // [rsp+8h] [rbp-78h] __int64 v331; // [rsp+8h] [rbp-78h] __int64 v332; // [rsp+8h] [rbp-78h] __int64 v333; // [rsp+8h] [rbp-78h] __int64 v334; // [rsp+8h] [rbp-78h] __int64 v335; // [rsp+8h] [rbp-78h] __int64 v336; // [rsp+8h] [rbp-78h] __int64 v337; // [rsp+8h] [rbp-78h] __int64 v338; // [rsp+8h] [rbp-78h] __int64 v339; // [rsp+8h] [rbp-78h] int v340; // [rsp+10h] [rbp-70h] int v341; // [rsp+10h] [rbp-70h] __int64 v342; // [rsp+10h] [rbp-70h] int v343; // [rsp+10h] [rbp-70h] int v344; // [rsp+10h] [rbp-70h] __int64 v345; // [rsp+10h] [rbp-70h] char v346; // [rsp+30h] [rbp-50h] char v347; // [rsp+38h] [rbp-48h] _BYTE v348[48]; // [rsp+40h] [rbp-40h] BYREF _BYTE v349[48]; // [rsp+70h] [rbp-10h] BYREF int v350[124]; // [rsp+A0h] [rbp+20h] BYREF int v351[124]; // [rsp+290h] [rbp+210h] BYREF _BYTE v352[16]; // [rsp+480h] [rbp+400h] BYREF _BYTE v353[16]; // [rsp+490h] [rbp+410h] BYREF BYTE v354[28]; // [rsp+4A0h] [rbp+420h] BYREF BYTE v355[4]; // [rsp+4BCh] [rbp+43Ch] BYREF BYTE pbData[2]; // [rsp+4C0h] [rbp+440h] BYREF __int16 v357; // [rsp+4C2h] [rbp+442h] int v358; // [rsp+4C4h] [rbp+444h] int v359; // [rsp+4C8h] [rbp+448h] __int64 v360; // [rsp+4CCh] [rbp+44Ch] __int64 v361; // [rsp+4D4h] [rbp+454h] __int64 v362; // [rsp+4DCh] [rbp+45Ch] __int64 v363; // [rsp+4E4h] [rbp+464h] _BYTE IV[32]; // [rsp+4F0h] [rbp+470h] BYREF IV _BYTE key[32]; // [rsp+510h] [rbp+490h] BYREF å¯†é’¥ BYTE MODE[32]; // [rsp+530h] [rbp+4B0h] BYREF æ¨¡å¼å‚æ•° BYTE v367[16]; // [rsp+550h] [rbp+4D0h] BYREF BYTE pbBuffer[8]; // [rsp+560h] [rbp+4E0h] BYREF __int64 v369; // [rsp+568h] [rbp+4E8h] __int64 v370; // [rsp+570h] [rbp+4F0h] __int64 v371; // [rsp+578h] [rbp+4F8h] HCRYPTKEY hKey; // [rsp+588h] [rbp+508h] BYREF HCRYPTPROV phProv; // [rsp+590h] [rbp+510h] BYREF char v374; // [rsp+59Ah] [rbp+51Ah] BYREF char v375; // [rsp+59Bh] [rbp+51Bh] BYREF char v376; // [rsp+59Ch] [rbp+51Ch] BYREF char v377; // [rsp+59Dh] [rbp+51Dh] BYREF char v378; // [rsp+59Eh] [rbp+51Eh] BYREF char v379; // [rsp+59Fh] [rbp+51Fh] BYREF _BYTE v380[32]; // [rsp+5A0h] [rbp+520h] BYREF _BYTE v381[32]; // [rsp+5C0h] [rbp+540h] BYREF _BYTE v382[32]; // [rsp+5E0h] [rbp+560h] BYREF _BYTE v383[16]; // [rsp+600h] [rbp+580h] BYREF _BYTE v384[32]; // [rsp+610h] [rbp+590h] BYREF _BYTE v385[16]; // [rsp+630h] [rbp+5B0h] BYREF _BYTE v386[16]; // [rsp+640h] [rbp+5C0h] BYREF _BYTE v387[16]; // [rsp+650h] [rbp+5D0h] BYREF _BYTE v388[16]; // [rsp+660h] [rbp+5E0h] BYREF _BYTE v389[16]; // [rsp+670h] [rbp+5F0h] BYREF _BYTE v390[32]; // [rsp+680h] [rbp+600h] BYREF _BYTE v391[16]; // [rsp+6A0h] [rbp+620h] BYREF _BYTE v392[32]; // [rsp+6B0h] [rbp+630h] BYREF _BYTE v393[16]; // [rsp+6D0h] [rbp+650h] BYREF _BYTE v394[48]; // [rsp+6E0h] [rbp+660h] BYREF _BYTE v395[16]; // [rsp+710h] [rbp+690h] BYREF _BYTE v396[16]; // [rsp+720h] [rbp+6A0h] BYREF _BYTE v397[32]; // [rsp+730h] [rbp+6B0h] BYREF _BYTE v398[48]; // [rsp+750h] [rbp+6D0h] BYREF _BYTE v399[32]; // [rsp+780h] [rbp+700h] BYREF _BYTE v400[48]; // [rsp+7A0h] [rbp+720h] BYREF _BYTE v401[32]; // [rsp+7D0h] [rbp+750h] BYREF _BYTE v402[48]; // [rsp+7F0h] [rbp+770h] BYREF _BYTE v403[32]; // [rsp+820h] [rbp+7A0h] BYREF _BYTE v404[48]; // [rsp+840h] [rbp+7C0h] BYREF _BYTE v405[32]; // [rsp+870h] [rbp+7F0h] BYREF _BYTE v406[48]; // [rsp+890h] [rbp+810h] BYREF _BYTE v407[32]; // [rsp+8C0h] [rbp+840h] BYREF _BYTE v408[32]; // [rsp+8E0h] [rbp+860h] BYREF _BYTE v409[48]; // [rsp+900h] [rbp+880h] BYREF _BYTE v410[32]; // [rsp+930h] [rbp+8B0h] BYREF _BYTE v411[40]; // [rsp+950h] [rbp+8D0h] BYREF char *v412; // [rsp+978h] [rbp+8F8h] char *v413; // [rsp+980h] [rbp+900h] char *v414; // [rsp+988h] [rbp+908h] char *v415; // [rsp+990h] [rbp+910h] char *v416; // [rsp+998h] [rbp+918h] char *v417; // [rsp+9A0h] [rbp+920h] __int64 v418; // [rsp+9A8h] [rbp+928h] BYTE *v419; // [rsp+9B0h] [rbp+930h] char v420; // [rsp+9BFh] [rbp+93Fh] sub_140006CC0(); v420 = 0; v5 = 0; v6 = 0; if ( a4 &lt;= 1 ) // æ­¤å¤„å¼€å§‹è§£æå‘½ä»¤è¡Œå‚æ•°ï¼Œè¿™æ˜¯ç¬¬ä¸€ä¸ªå‚æ•°çš„å¤„ç† { v416 = &amp;v375; v6 = 1; sub_14000B350(a1, 1, (unsigned int)&amp;unk_14000E1D0, (unsigned int)MODE, (unsigned int)&amp;v375, v4); } else { v417 = &amp;v374; v5 = 1; sub_14000B350(a1, 0, a3[1], (unsigned int)MODE, (unsigned int)&amp;v374, v4); } if ( (_BYTE)v6 ) sub_140009C30(a1, v6, v7, (unsigned int)&amp;v375, v8, v9); if ( v5 ) sub_140009C30(a1, v6, v7, (unsigned int)&amp;v374, v8, v9); v10 = 0; v11 = 0; if ( a4 &lt;= 2 ) // è¿™æ˜¯ç¬¬äºŒä¸ªå‚æ•°çš„å¤„ç† { v414 = &amp;v377; v11 = 1; sub_14000B350(a1, 1, (unsigned int)&amp;unk_14000E1D0, (unsigned int)key, (unsigned int)&amp;v377, v9); } else { v415 = &amp;v376; v10 = 1; sub_14000B350(a1, 0, a3[2], (unsigned int)key, (unsigned int)&amp;v376, v9); } if ( (_BYTE)v11 ) sub_140009C30(a1, v11, v12, (unsigned int)&amp;v377, v13, v14); if ( v10 ) sub_140009C30(a1, v11, v12, (unsigned int)&amp;v376, v13, v14); v15 = 0; v16 = 0LL; if ( a4 &lt;= 3 ) // è¿™æ˜¯ç¬¬ä¸‰ä¸ªå‚æ•°çš„å¤„ç† { v412 = &amp;v379; v16 = 1LL; sub_14000B350(a1, 1, (unsigned int)&amp;unk_14000E1D0, (unsigned int)IV, (unsigned int)&amp;v379, v14); } else { v413 = &amp;v378; v15 = 1; sub_14000B350(a1, 0, a3[3], (unsigned int)IV, (unsigned int)&amp;v378, v14); } if ( (_BYTE)v16 ) sub_140009C30(a1, v16, v17, (unsigned int)&amp;v379, v18, v19); if ( v15 ) sub_140009C30(a1, v16, v17, (unsigned int)&amp;v378, v18, v19); if ( CryptAcquireContextA(&amp;phProv, 0LL, 0LL, 0x18u, 0xF0000000) )// ä½¿ç”¨Microsoft CryptoAPIï¼Œ0X18è¡¨ç¤ºPROV_RSA_AESï¼Œç¨‹åºä½¿ç”¨RSAåŠ å¯†å¯†é’¥å’ŒIVå‘é€åˆ°æœåŠ¡å™¨ { if ( a4 &lt;= 3 ) { if ( !CryptGenRandom(phProv, 0x20u, pbBuffer) )// ç”Ÿæˆ32å­—èŠ‚éšæœºå¯†é’¥ { v23 = 1; goto LABEL_63; } if ( !CryptGenRandom(phProv, 0x10u, v367) )// ç”Ÿæˆ16å­—èŠ‚éšæœºIV { v23 = 1; goto LABEL_63; } sub_1400028FE(a1, v16, (__int64)pbBuffer, (__int64)v387, 32); sub_140005071(a1, v16, (unsigned int)v387, (unsigned int)v386, v56, v57, v232, v308);// ç–‘ä¼¼åŠ å¯†å‡½æ•° sub_140003D46(a1, v16, 0x1F90u, (int)v386);// ç–‘ä¼¼ç½‘ç»œé€šä¿¡çš„å‡½æ•° sub_1400029A2(a1, v16, v58, (unsigned int)v386, v59, v60, v243); sub_1400029A2(a1, v16, v61, (unsigned int)v387, v62, v63, v244); sub_1400028FE(a1, v16, (__int64)v367, (__int64)v389, 16); sub_140005071(a1, v16, (unsigned int)v389, (unsigned int)v388, v64, v65, v245, v309); sub_140003D46(a1, v16, 0x1F90u, (int)v388); sub_1400029A2(a1, v16, v66, (unsigned int)v388, v67, v68, v246); sub_1400029A2(a1, v16, v69, (unsigned int)v389, v70, v71, v247); } else { if ( sub_14000C650(a1, v16, (int)&quot;-d&quot;, (int)MODE, v21, v22) ) v420 = 1; // å‘½ä»¤è¡Œå‚æ•°åŒ…å«&quot;-d&quot;çš„æ—¶å€™ï¼Œv449è¢«è®¾ä¸º1ï¼Œè¿›å…¥è§£å¯†æ¨¡å¼ sub_14000B130(a1, v16, (unsigned int)key, (unsigned int)v380, v24, v25, v232, v303);// ä»å‘½ä»¤è¡Œè·å–key sub_1400051EC(a1, v16, (__int64)pbBuffer, (int)v380, v26, v27);// å¤„ç†key sub_14000B400(a1, v16, v28, (unsigned int)v380, v29, v30, v233); sub_14000B130(a1, v16, (unsigned int)IV, (unsigned int)v381, v31, v32, v234, v304);// ä»å‘½ä»¤è¡Œè·å–IV sub_1400051EC(a1, v16, (__int64)v367, (int)v381, v33, v34);// å¤„ç†IV sub_14000B400(a1, v16, v35, (unsigned int)v381, v36, v37, v235); sub_1400028FE(a1, v16, (__int64)pbBuffer, (__int64)v383, 32); sub_140001534(a1, v16, (unsigned int)v383, (unsigned int)v382, v38, v39, v236, v305); v40 = std::operator&lt;&lt;&lt;char&gt;(a1, v16, v382, &amp;std::cout); std::ostream::operator&lt;&lt;(a1, v16, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;, v40); sub_14000B400(a1, v16, v41, (unsigned int)v382, v42, v43, v237); sub_1400029A2(a1, v16, v44, (unsigned int)v383, v45, v46, v238); sub_1400028FE(a1, v16, (__int64)v367, (__int64)v385, 16); sub_140001534(a1, v16, (unsigned int)v385, (unsigned int)v384, v47, v48, v239, v306); v49 = std::operator&lt;&lt;&lt;char&gt;(a1, v16, v384, &amp;std::cout); std::ostream::operator&lt;&lt;(a1, v16, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;, v49); sub_14000B400(a1, v16, v50, (unsigned int)v384, v51, v52, v240); sub_1400029A2(a1, v16, v53, (unsigned int)v385, v54, v55, v241); } v72 = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(a1, v16, &quot;Key: &quot;, &amp;std::cout); sub_1400028FE(a1, v16, (__int64)pbBuffer, (__int64)v391, 32); sub_140001534(a1, v16, (unsigned int)v391, (unsigned int)v390, v73, v74, v242, v307); v75 = std::operator&lt;&lt;&lt;char&gt;(a1, v16, v390, v72); std::ostream::operator&lt;&lt;(a1, v16, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;, v75); sub_14000B400(a1, v16, v76, (unsigned int)v390, v77, v78, v248); sub_1400029A2(a1, v16, v79, (unsigned int)v391, v80, v81, v249); v82 = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(a1, v16, &quot;IV: &quot;, &amp;std::cout); sub_1400028FE(a1, v16, (__int64)v367, (__int64)v393, 16); sub_140001534(a1, v16, (unsigned int)v393, (unsigned int)v392, v83, v84, v250, v310); v85 = std::operator&lt;&lt;&lt;char&gt;(a1, v16, v392, v82); std::ostream::operator&lt;&lt;(a1, v16, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;, v85); sub_14000B400(a1, v16, v86, (unsigned int)v392, v87, v88, v251); sub_1400029A2(a1, v16, v89, (unsigned int)v393, v90, v91, v252); pbData[0] = 8; pbData[1] = 2; v357 = 0; v358 = 26128; v359 = 32; v360 = *(_QWORD *)pbBuffer; v361 = v369; v362 = v370; v363 = v371; *(_DWORD *)v355 = 2; CryptImportKey(phProv, pbData, 0x2Cu, 0LL, 0, &amp;hKey);// å¯¼å…¥å¯†é’¥ CryptSetKeyParam(hKey, 4u, v355, 0); // è®¾ç½®å¯†é’¥å‚æ•° CryptSetKeyParam(hKey, 1u, v367, 0); // è®¾ç½®IV std::filesystem::current_path[abi:cxx11](a1, v16, v92, v394);// è·å–å½“å‰è·¯å¾„ sub_140008E50(a1, v16, (unsigned int)v394, (unsigned int)v354, v93, v94, v253, v311); v419 = v354; sub_1400091B0(a1, v16, v95, (unsigned int)v394, v96, v97, v254); sub_140008E90(a1, v16, (_DWORD)v419, (unsigned int)v395, v98, v99, v255, v312); sub_140009230(a1, v16, (unsigned int)v395, (unsigned int)v353, v100, v101, v256, v313); sub_140008EE0(a1, v16, v102, (unsigned int)v395, v103, v104, v257); sub_140008E90(a1, v16, (_DWORD)v419, (unsigned int)v396, v105, v106, v258, v314); sub_140008F00(a1, v16, (unsigned int)v396, (unsigned int)v352, v107, v108, v259, v315); sub_140008EE0(a1, v16, v109, (unsigned int)v396, v110, v111, v260); while ( (unsigned __int8)sub_1400092E0(a1, v16, (unsigned int)v352, (unsigned int)v353, v112, v113, v261, v316) )// éå†å½“å‰è·¯å¾„ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ { v418 = std::filesystem::__cxx11::directory_iterator::operator*(a1, v16, v216, v353); if ( (unsigned __int8)sub_1400082F0(a1, v16, v114, v418, v115, v116, v298) == 1 ) { v120 = sub_140008320(a1, v16, v117, v418, v118, v119, v261); sub_140009030(a1, v16, v120, (unsigned int)v348, v121, v122, v262, v316); a1 = 0LL; v123 = 0; v124 = 0; v125 = 0; v126 = 0; v347 = 0; sub_140008440(0, 0, (unsigned int)v348, (unsigned int)v398, v127, v128, v263, v317); sub_1400083D0(0, 0, (unsigned int)v398, (unsigned int)v397, v129, v130, v264, v318); v16 = 1LL; if ( (unsigned __int8)sub_14000C6D0(0, 1, (unsigned int)L&quot;.exe&quot;, (unsigned int)v397, v131, v132, v265, v319) )// è·³è¿‡exeæ–‡ä»¶ goto LABEL_39; sub_140008440(0, 1, (unsigned int)v348, (unsigned int)v400, v134, v135, v266, v316); a1 = 1LL; sub_1400083D0(1, 1, (unsigned int)v400, (unsigned int)v399, v136, v137, v267, v320); v123 = 1; if ( (unsigned __int8)sub_14000C6D0(1, 1, (unsigned int)&quot;.&quot;, (unsigned int)v399, v138, v139, v268, v321) ) goto LABEL_39; sub_140008440(1, 1, (unsigned int)v348, (unsigned int)v402, v134, v135, v266, v316); v124 = 1; sub_1400083D0(1, 1, (unsigned int)v402, (unsigned int)v401, v140, v141, v269, v322); v125 = 1; if ( (unsigned __int8)sub_14000C6D0(1, 1, (unsigned int)L&quot;.dec&quot;, (unsigned int)v401, v142, v143, v270, v323)// è·³è¿‡decæ–‡ä»¶ || (sub_140008440(1, 1, (unsigned int)v348, (unsigned int)v404, v134, v135, v266, v316), v126 = 1, sub_1400083D0(1, 1, (unsigned int)v404, (unsigned int)v403, v144, v145, v271, v324), v347 = 1, (unsigned __int8)sub_14000C6D0(1, 1, (unsigned int)&quot;.&quot;, (unsigned int)v403, v146, v147, v272, v325)) )// è·³è¿‡å½“å‰ç›®å½•çš„.æ–‡ä»¶ {LABEL_39: v346 = 1; } else { v346 = 0; } if ( v347 ) sub_14000C290(a1, 1, v133, (unsigned int)v403, v134, v135, v266); if ( v126 ) sub_1400091B0(a1, 1, v133, (unsigned int)v404, v134, v135, v266); if ( v125 ) sub_14000C290(a1, 1, v133, (unsigned int)v401, v134, v135, v266); if ( v124 ) sub_1400091B0(a1, 1, v133, (unsigned int)v402, v134, v135, v266); if ( v123 ) sub_14000C290(a1, 1, v133, (unsigned int)v399, v134, v135, v266); if ( (_BYTE)a1 ) sub_1400091B0(a1, 1, v133, (unsigned int)v400, v134, v135, v266); sub_14000C290(a1, 1, v133, (unsigned int)v397, v134, v135, v266); sub_1400091B0(a1, 1, v148, (unsigned int)v398, v149, v150, v273); if ( !v346 ) { if ( v420 != 1 ) // åŠ å¯†æ¨¡å¼ { sub_140008440(a1, 1, (unsigned int)v348, (unsigned int)v406, v152, v153, v274, v316); sub_1400083D0(a1, 1, (unsigned int)v406, (unsigned int)v405, v154, v155, v275, v326); v158 = sub_14000C6D0(a1, 1, (unsigned int)&quot;.&quot;, (unsigned int)v405, v156, v157, v276, v327); sub_14000C290(a1, 1, v159, (unsigned int)v405, v160, v161, v277); sub_1400091B0(a1, 1, v162, (unsigned int)v406, v163, v164, v278); if ( !v158 ) { v165 = std::operator&lt;&lt;&lt;wchar_t,std::char_traits&lt;wchar_t&gt;&gt;(a1, 1LL, L&quot;Encrypting file: &quot;, &amp;std::wcout); sub_1400083D0(a1, 1, (unsigned int)v348, (unsigned int)v407, v166, v167, v274, v316); v168 = std::operator&lt;&lt;&lt;wchar_t&gt;(a1, 1LL, v407, v165); std::wostream::operator&lt;&lt;(a1, 1LL, &amp;std::endl&lt;wchar_t,std::char_traits&lt;wchar_t&gt;&gt;, v168); sub_14000C290(a1, 1, v169, (unsigned int)v407, v170, v171, v279); sub_140009030(a1, 1, (unsigned int)v348, (unsigned int)v349, v172, v173, v280, v328); sub_1400091E0(a1, 1, (unsigned int)&quot;.&quot;, (unsigned int)v349, v174, v175, v281, v329); sub_140009B20(a1, 1, (unsigned int)v348, (unsigned int)v351, 4, v176, v282, v330, v340);// è¯»å–è¾“å…¥æ–‡ä»¶ sub_140009B60(a1, 1, (unsigned int)v349, (unsigned int)v350, 4, v177, v283, v331, v341);// å‡†å¤‡è¾“å‡ºæ–‡ä»¶ sub_1400052D0(a1, 1, (int)v351, hKey, (int)v350, v178, v284, v332, v342);// æ‰§è¡ŒåŠ å¯† std::ofstream::~ofstream(a1, 1LL, v179, v350); std::ifstream::~ifstream(a1, 1LL, v180, v351); sub_1400091B0(a1, 1, v181, (unsigned int)v349, v182, v183, v285); } } else // è§£å¯†æ¨¡å¼ { sub_140008440(a1, 1, (unsigned int)v348, (unsigned int)v409, v152, v153, v274, v316); sub_1400083D0(a1, 1, (unsigned int)v409, (unsigned int)v408, v184, v185, v286, v333); v188 = sub_14000C750(a1, 1, (unsigned int)&quot;.&quot;, (unsigned int)v408, v186, v187, v287, v334); sub_14000C290(a1, 1, v189, (unsigned int)v408, v190, v191, v288); sub_1400091B0(a1, 1, v192, (unsigned int)v409, v193, v194, v289); if ( !v188 ) { v195 = std::operator&lt;&lt;&lt;wchar_t,std::char_traits&lt;wchar_t&gt;&gt;(a1, 1LL, L&quot;Decrypting file: &quot;, &amp;std::wcout); sub_1400083D0(a1, 1, (unsigned int)v348, (unsigned int)v410, v196, v197, v274, v316); v198 = std::operator&lt;&lt;&lt;wchar_t&gt;(a1, 1LL, v410, v195); std::wostream::operator&lt;&lt;(a1, 1LL, &amp;std::endl&lt;wchar_t,std::char_traits&lt;wchar_t&gt;&gt;, v198); sub_14000C290(a1, 1, v199, (unsigned int)v410, v200, v201, v290); sub_140009030(a1, 1, (unsigned int)v348, (unsigned int)v349, v202, v203, v291, v335); sub_1400090C0(a1, 1, (unsigned int)L&quot;dec&quot;, (unsigned int)v411, 2, v204, v292, v336, v340); std::filesystem::__cxx11::path::replace_extension( (std::filesystem::__cxx11::path *)a1, (const std::filesystem::__cxx11::path *)1); sub_1400091B0(a1, 1, v205, (unsigned int)v411, v206, v207, v293); sub_140009B20(a1, 1, (unsigned int)v348, (unsigned int)v351, 4, v208, v294, v337, v343);// è¯»å–åŠ å¯†æ–‡ä»¶ sub_140009B60(a1, 1, (unsigned int)v349, (unsigned int)v350, 4, v209, v295, v338, v344);// å‡†å¤‡è¾“å‡ºæ–‡ä»¶ sub_140005522(a1, 1, (int)v351, hKey, (int)v350, v210, v296, v339, v345);// æ‰§è¡Œè§£å¯† std::ofstream::~ofstream(a1, 1LL, v211, v350); std::ifstream::~ifstream(a1, 1LL, v212, v351); sub_1400091B0(a1, 1, v213, (unsigned int)v349, v214, v215, v297); } } } sub_1400091B0(a1, 1, v151, (unsigned int)v348, v152, v153, v274); } std::filesystem::__cxx11::directory_iterator::operator++(a1, v16, v117, v353); } sub_140008EE0(a1, v16, v216, (unsigned int)v352, v217, v218, v298); sub_140008EE0(a1, v16, v219, (unsigned int)v353, v220, v221, v299); sub_140008EE0(a1, v16, v222, (unsigned int)v354, v223, v224, v300); CryptDestroyKey(hKey); CryptReleaseContext(phProv, 0); v23 = 0; } else { v23 = 1; }LABEL_63: sub_14000B400(a1, v16, v20, (unsigned int)IV, v21, v22, v232); sub_14000B400(a1, v16, v225, (unsigned int)key, v226, v227, v301); sub_14000B400(a1, v16, v228, (unsigned int)MODE, v229, v230, v302); return v23;} ä¸‹é¢æ˜¯ç–‘ä¼¼çš„åŠ å¯†å‡½æ•°çš„å†…å®¹ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859__int64 __fastcall sub_140005071(int a1, int a2, int a3, __int64 a4, __int64 a5, int a6){ int v6; // r8d int v7; // r9d int v8; // edx int v9; // r8d int v10; // r9d int v11; // edx int v12; // r8d int v13; // r9d int v14; // r9d int v15; // r8d int v16; // r9d int v17; // edx int v18; // r8d int v19; // r9d int v20; // edx int v21; // r8d int v22; // r9d int v23; // edx int v24; // r8d int v25; // r9d int v26; // edx int v27; // r8d int v28; // r9d __int64 v30; // [rsp+0h] [rbp-B0h] BYREF __int64 v31; // [rsp+8h] [rbp-A8h] __int64 v32; // [rsp+10h] [rbp-A0h] __int64 v33; // [rsp+18h] [rbp-98h] _BYTE v34[16]; // [rsp+20h] [rbp-90h] BYREF _BYTE v35[16]; // [rsp+30h] [rbp-80h] BYREF _BYTE v36[47]; // [rsp+40h] [rbp-70h] BYREF char v37; // [rsp+6Fh] [rbp-41h] BYREF _BYTE v38[47]; // [rsp+70h] [rbp-40h] BYREF char v39; // [rsp+9Fh] [rbp-11h] BYREF char *v40; // [rsp+A0h] [rbp-10h] char *v41; // [rsp+A8h] [rbp-8h] v41 = (char *)&amp;v30 + 111; sub_14000B350( a1, a2, (unsigned int)&quot;1294787702630841806287693875819503767329411267154281759595683996937344294354199&quot;, (unsigned int)(&amp;v30 - 14) + 176, (unsigned int)&amp;v30 - 65 + 176, a6); sub_1400024EE(a1, a2, (unsigned int)v36, (unsigned int)v35, v6, v7, v30, v31); sub_14000B400(a1, a2, v8, (unsigned int)v36, v9, v10, v30); sub_140009C30(a1, a2, v11, (unsigned int)&amp;v37, v12, v13); v40 = &amp;v39; sub_14000B350(a1, a2, (unsigned int)&quot;65537&quot;, (unsigned int)v38, (unsigned int)&amp;v39, v14);// 65537æ˜¯å…¸å‹RSAåŠ å¯†çš„ç‰¹å¾ï¼Œå› æ­¤æ¨æµ‹æ­¤å‡½æ•°ä¸ºRSAåŠ å¯† sub_1400024EE(a1, a2, (unsigned int)v38, (unsigned int)v34, v15, v16, v30, v31); sub_14000B400(a1, a2, v17, (unsigned int)v38, v18, v19, v30); sub_140009C30(a1, a2, v20, (unsigned int)&amp;v39, v21, v22); sub_1400031A0(a1, a2, a3, a4, (unsigned int)v34, (unsigned int)v35, v30, v31, v32, v33); sub_1400029A2(a1, a2, v23, (unsigned int)v34, v24, v25, v30); sub_1400029A2(a1, a2, v26, (unsigned int)v35, v27, v28, v30); return a4;} å¯ä»¥å¾—åˆ°å¦‚ä¸‹çš„å°è±¡ç‚¹ï¼š ç¨‹åºé€šè¿‡å‚æ•°ä¸ªæ•°åˆ¤æ–­ä½¿ç”¨åŠ å¯†æ¨¡å¼è¿˜æ˜¯è§£å¯†æ¨¡å¼ï¼› ç¨‹åºåœ¨åŠ å¯†æ¨¡å¼ä¸‹ä¼šéå†åŒä¸€è·¯å¾„ä¸‹çš„æ–‡ä»¶å¹¶è¿›è¡ŒåŠ å¯†ï¼Œè¾“å‡º.encæ–‡ä»¶ï¼ŒåŒæ—¶ç¨‹åºä¼šå°†åŠ å¯†ä½¿ç”¨çš„keyå’ŒIVè¿›è¡ŒRSAåŠ å¯†åå‘é€åˆ°æœåŠ¡å™¨ï¼ˆæ­¤å¤–ç”±äºç½‘ç»œé€šä¿¡å‡½æ•°å‡ºç°äº†127.0.0.1ï¼Œæ¨æµ‹æ˜¯æœ¬åœ°æœåŠ¡å™¨ï¼‰ï¼› ç¨‹åºåœ¨è§£å¯†æ¨¡å¼ä¸‹åªéœ€è¦ä½¿ç”¨Int.exe -d key IVå°±å¯ä»¥è§£å¯†æ–‡ä»¶ã€‚ ç»“åˆé™„ä»¶çš„å½¢å¼ï¼ˆé™„ä»¶åŒ…å«ä¸€ä¸ªæµé‡åŒ…ï¼‰ï¼Œå¯ä»¥æ¨æµ‹æœ¬é¢˜çš„çªç ´å£åœ¨äºåˆ†ææµé‡åŒ…æå–å‡ºRSAåŠ å¯†åçš„keyå’ŒIVï¼Œç„¶åå°±å¯ä»¥è§£å¯†å‡ºkeyå’ŒIVï¼Œä½¿ç”¨ç¨‹åºè‡ªå¸¦çš„è§£å¯†åŠŸèƒ½è§£å¯†æ–‡ä»¶ã€‚ å®‰å…¨èµ·è§ï¼Œç¬¬ä¸€æ­¥å…ˆéªŒè¯çŒœæƒ³ã€‚å€ŸåŠ©AIæ­å»ºä¸€ä¸ªæœ¬åœ°æœåŠ¡å™¨æ¥æ¥æ”¶ç¨‹åºçš„é€šä¿¡æ•°æ® 123456789101112# æœ¬åœ°æœåŠ¡å™¨è„šæœ¬# fake_server.pyimport socketsock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)sock.bind(('127.0.0.1', 8080))sock.listen(1)print(&quot;Listening on 127.0.0.1:8080...&quot;)while True: conn, addr = sock.accept() data = conn.recv(1024) print(f&quot;Received {len(data)} bytes: {data.hex()}&quot;) conn.close() å¯ç”¨æœåŠ¡å™¨åï¼Œé€šè¿‡å‘½ä»¤è¡Œè¿è¡ŒInt.exeå¯ä»¥çœ‹åˆ°æœ¬æ¬¡åŠ å¯†ä½¿ç”¨çš„keyå’ŒIVï¼Œä»¥åŠå‘é€çš„åè¿›åˆ¶æ•°æ® æœåŠ¡å™¨ä¼šæ¥æ”¶åˆ°å¦‚ä¸‹æ•°æ®ï¼ˆæœåŠ¡å™¨æ¥æ”¶çš„æ•°æ®æ˜¯å‘é€çš„æ•°æ®çš„åå…­è¿›åˆ¶å½¢å¼ï¼‰ ç„¶åå‚è€ƒRSAåŠ å¯†è§£å¯†åŸç†æ·±åº¦å‰–æå¯ä»¥å†™å‡ºä¸€ä¸ªè„šæœ¬æ¥è§£å¯† 1234567891011121314151617181920212223242526272829import gmpy2#æ±‚è§£dp =gmpy2.mpz(973424135910675582062565817184635606523)q =gmpy2.mpz( 1330137249390799512563582841814876337813)e =gmpy2.mpz(65537)phi_n= (p - 1) * (q - 1)d = gmpy2.invert(e, phi_n)print(&quot;d is:&quot;)print (d)#è§£å¯†keyå’ŒIVn = gmpy2.mpz(1294787702630841806287693875819503767329411267154281759595683996937344294354199)#key_rawæ˜¯æœåŠ¡å™¨æ¥æ”¶çš„ç¬¬ä¸€ä¸ªæ•°æ®ï¼Œå³keyåŠ å¯†æ•°æ®çš„åå…­è¿›åˆ¶æ•°æ®æµkey_raw=&quot;31323532333634383535303738343134373534303233363633363831313039303038333936313636303538303434333331323331383735303239343634393636353236373133353939343233363539&quot;#iv_rawæ˜¯æœåŠ¡å™¨æ¥æ”¶çš„ç¬¬äºŒä¸ªæ•°æ®ï¼Œå³ivåŠ å¯†æ•°æ®çš„åå…­è¿›åˆ¶æ•°æ®æµiv_raw=&quot;393235323537333232303933353132333132353838343232323434353732343930303235353236393838363134393132323438313237363234363634333434323034333234353839393230383333&quot;#åå…­è¿›åˆ¶è§£ç key_hexdec=bytes.fromhex(key_raw)iv_hexdec=bytes.fromhex(iv_raw)key_enc = gmpy2.mpz(key_hexdec)IV_enc = gmpy2.mpz(iv_hexdec)#RSAè§£å¯†key_dec = pow(key_enc, d, n)IV_dec = pow(IV_enc, d, n)print(&quot;key (hex):&quot;, hex(key_dec))print(&quot;IV (hex):&quot;, hex(IV_dec)) è¿è¡Œè§£å¯†è„šæœ¬å¾—åˆ°å¦‚ä¸‹ï¼Œkeyå’Œivä¸Int.exeçš„è¾“å‡ºä¸€è‡´ è‡³æ­¤ï¼Œå¯ä»¥ç¡®å®šå‘é€çš„æ•°æ®ä¸ºkeyå’ŒIVçš„RSAåŠ å¯†ç»“æœï¼ŒæœåŠ¡å™¨æ¥æ”¶çš„æ•°æ®æ˜¯åŠ å¯†ç»“æœçš„åå…­è¿›åˆ¶ç¼–ç æ•°æ®ã€‚ æ¥ä¸‹æ¥åˆ†ææµé‡åŒ…æå–åŠ å¯†æ•°æ®æµï¼ˆéœ€è¦ç”¨åˆ°WireSharkï¼‰ã€‚ç”±äºç¨‹åºå°†æ•°æ®å‘é€åˆ°æœ¬åœ°8080ç«¯å£ï¼Œä¸”æ•°æ®é•¿åº¦å¤§çº¦ä¸º78bytesï¼Œæ ¹æ®è¿™ä¸ªç‰¹å¾å¯ä»¥ç­›é€‰å‡ºkeyå’ŒIVçš„æµé‡ å°†æ‰¾åˆ°çš„ä¸¤ä¸²æ•°æ®å¤åˆ¶åˆ°è„šæœ¬çš„key_rawå’Œiv_rawï¼Œå¯ä»¥è§£å¯†å‡ºkeyå’ŒIV 1234567891011121314151617181920212223242526272829import gmpy2#æ±‚è§£dp =gmpy2.mpz(973424135910675582062565817184635606523)q =gmpy2.mpz( 1330137249390799512563582841814876337813)e =gmpy2.mpz(65537)phi_n= (p - 1) * (q - 1)d = gmpy2.invert(e, phi_n)print(&quot;d is:&quot;)print (d)#è§£å¯†keyå’ŒIVn = gmpy2.mpz(1294787702630841806287693875819503767329411267154281759595683996937344294354199)#key_rawæ˜¯æœåŠ¡å™¨æ¥æ”¶çš„ç¬¬ä¸€ä¸ªæ•°æ®ï¼Œå³keyåŠ å¯†æ•°æ®çš„åå…­è¿›åˆ¶æ•°æ®æµkey_raw=&quot;393430353632303933303434363731383332313634363031353936303437303036303837353338373330383137373132363136313931393431323130333436353936333530353534323336333632&quot;#iv_rawæ˜¯æœåŠ¡å™¨æ¥æ”¶çš„ç¬¬äºŒä¸ªæ•°æ®ï¼Œå³ivåŠ å¯†æ•°æ®çš„åå…­è¿›åˆ¶æ•°æ®æµiv_raw=&quot;323636373435303139343936383836343938363534323735373736393036303037343539343139323635373931333033373337353137333038363234343631363938313438363430393939363639&quot;#åå…­è¿›åˆ¶è§£ç key_hexdec=bytes.fromhex(key_raw)iv_hexdec=bytes.fromhex(iv_raw)key_enc = gmpy2.mpz(key_hexdec)IV_enc = gmpy2.mpz(iv_hexdec)#RSAè§£å¯†key_dec = pow(key_enc, d, n)IV_dec = pow(IV_enc, d, n)print(&quot;key (hex):&quot;, hex(key_dec))print(&quot;IV (hex):&quot;, hex(IV_dec)) ç„¶åå°±å¯ä»¥ä½¿ç”¨Int.exe -d key ivè§£å¯†æ–‡ä»¶äº†ï¼ˆæ³¨æ„keyå’ŒIVä¸è¦å¸¦0xï¼‰ æ‰“å¼€txt.decæ–‡ä»¶å°±å¯ä»¥æ‰¾åˆ°flagäº† flagï¼š0xGame{I_4m_3o_S1eepy_(Â´ï½`)zzZ_zzZ_zzZ_zzZ}","link":"/2025/11/16/0xGame2025Week4ReverseWriteUp/"},{"title":"Day5:å‡½æ•°è°ƒç”¨çº¦å®š","text":"å‡½æ•°è°ƒç”¨çº¦å®š å‡½æ•°è°ƒç”¨çº¦å®š ä¸»è¦æœ‰ä¸‰ç§ï¼šcdeclã€stdcallã€fastcallã€‚ä»¥æ±‚å’Œå‡½æ•°ä¸ºä¾‹ 12345678910//æ±‚å’Œ#include&lt;stdio.h&gt;int sum(int a,int b,int c){ return a+b+c;}int main(){ int res=sum(1,2,3); printf(&quot;%d\\n&quot;,res); return 0;} cdeclï¼šå®Œå…¨æ ˆä¼ å‚ï¼Œå‚æ•°ä»å³å¾€å·¦å…¥æ ˆï¼Œç”±è°ƒç”¨è€…æ¸…ç†å‚æ•°å ç”¨çš„æ ˆç©ºé—´ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283; int __cdecl main()_main proc near ; CODE XREF: j__mainâ†‘j var_C = byte ptr -0Chres = dword ptr -8 push ebp mov ebp, esp sub esp, 0CCh push ebx push esi push edi __$EncStackInitStart_2: lea edi, [ebp+var_C] mov ecx, 3 mov eax, 0CCCCCCCCh rep stosd __$EncStackInitEnd_2: ; JMC_flag mov ecx, offset _6005466B_entry@cpp call j_@__CheckForDebuggerJustMyCode@4 ; __CheckForDebuggerJustMyCode(x) nop push 3 ; å‚æ•°cå…¥æ ˆ push 2 ; å‚æ•°bå…¥æ ˆ push 1 ; å‚æ•°aå…¥æ ˆ call j_?sum@@YAHHHH@Z ; sum(int,int,int) add esp, 0Ch ;è¿™é‡Œè°ƒç”¨è€…è¿›è¡Œäº†æ¸…ç†å‚æ•°å ç”¨çš„æ ˆç©ºé—´çš„æ“ä½œ(3ä¸ªå‚æ•°Ã—4å­—èŠ‚)ï¼Œè¢«è°ƒç”¨è€…ä¸è´Ÿè´£ mov [ebp+res], eax mov eax, [ebp+res] push eax push offset _Format ; &quot;%d\\n&quot; call j__printf add esp, 8 xor eax, eax pop edi pop esi pop ebx add esp, 0CCh cmp ebp, esp call j___RTC_CheckEsp mov esp, ebp pop ebp retn_main endp; int __cdecl sum(int a, int b, int c)?sum@@YAHHHH@Z proc near ; CODE XREF: sum(int,int,int)â†‘j a = dword ptr 8b = dword ptr 0Chc = dword ptr 10h push ebp mov ebp, esp sub esp, 0C0h ;sumå‡½æ•°è‡ªèº«çš„æ ˆç©ºé—´ push ebx push esi push edi __$EncStackInitStart: mov edi, ebp xor ecx, ecx mov eax, 0CCCCCCCCh rep stosd __$EncStackInitEnd: ; JMC_flag mov ecx, offset _6005466B_entry@cpp call j_@__CheckForDebuggerJustMyCode@4 ; __CheckForDebuggerJustMyCode(x) nop mov eax, [ebp+a] add eax, [ebp+b] add eax, [ebp+c] pop edi pop esi pop ebx add esp, 0C0h ;æ¸…ç†è‡ªèº«æ ˆç©ºé—´ cmp ebp, esp call j___RTC_CheckEsp mov esp, ebp pop ebp retn?sum@@YAHHHH@Z endp stdcallï¼šå®Œå…¨æ ˆä¼ å‚ï¼Œå‚æ•°ä»å³å¾€å·¦å…¥æ ˆï¼Œç”±è¢«è°ƒç”¨è€…æ¸…ç†å‚æ•°å ç”¨çš„æ ˆç©ºé—´ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182; int __cdecl main()_main proc near ; CODE XREF: j__mainâ†‘j var_C = byte ptr -0Chres = dword ptr -8 push ebp mov ebp, esp sub esp, 0CCh push ebx push esi push edi __$EncStackInitStart_2: lea edi, [ebp+var_C] mov ecx, 3 mov eax, 0CCCCCCCCh rep stosd __$EncStackInitEnd_2: ; JMC_flag mov ecx, offset _6005466B_entry@cpp call j_@__CheckForDebuggerJustMyCode@4 ; __CheckForDebuggerJustMyCode(x) nop push 3 ; å‚æ•°cå…¥æ ˆ push 2 ; å‚æ•°bå…¥æ ˆ push 1 ; å‚æ•°aå…¥æ ˆ call j_?sum@@YGHHHH@Z ; sum(int,int,int) mov [ebp+res], eax ;è¿™é‡Œç›´æ¥åˆ°æŠŠè¿”å›å€¼ç»™resäº†ï¼Œè°ƒç”¨è€…ä¸è´Ÿè´£æ¸…ç†å‚æ•°å ç”¨çš„æ ˆç©ºé—´ mov eax, [ebp+res] push eax push offset _Format ; &quot;%d\\n&quot; call j__printf add esp, 8 xor eax, eax pop edi pop esi pop ebx add esp, 0CCh cmp ebp, esp call j___RTC_CheckEsp mov esp, ebp pop ebp retn_main endp ; int __stdcall sum(int a, int b, int c)?sum@@YGHHHH@Z proc near ; CODE XREF: sum(int,int,int)â†‘j a = dword ptr 8b = dword ptr 0Chc = dword ptr 10h push ebp mov ebp, esp sub esp, 0C0h ;sumçš„æ ˆç©ºé—´ push ebx push esi push edi __$EncStackInitStart: mov edi, ebp xor ecx, ecx mov eax, 0CCCCCCCCh rep stosd __$EncStackInitEnd: ; JMC_flag mov ecx, offset _6005466B_entry@cpp call j_@__CheckForDebuggerJustMyCode@4 ; __CheckForDebuggerJustMyCode(x) nop mov eax, [ebp+a] add eax, [ebp+b] add eax, [ebp+c] pop edi pop esi pop ebx add esp, 0C0h ;æ¸…ç†è‡ªèº«æ ˆç©ºé—´ cmp ebp, esp call j___RTC_CheckEsp mov esp, ebp pop ebp retn 0Ch ;è¢«è°ƒç”¨è€…é€šè¿‡è¿”å›æŒ‡ä»¤ç»™espå¢åŠ 0Chï¼Œæ¸…ç†å‚æ•°å ç”¨çš„æ ˆç©ºé—´?sum@@YGHHHH@Z endp fastcallï¼šå¯„å­˜å™¨+æ ˆä¼ å‚ï¼Œä¼˜å…ˆä½¿ç”¨å¯„å­˜å™¨ï¼Œå‰©ä½™å‚æ•°ä»å³å¾€å·¦å…¥æ ˆï¼Œç”±è¢«è°ƒç”¨è€…æ¸…ç†å‚æ•°å ç”¨çš„æ ˆç©ºé—´ å¯„å­˜å™¨ä¼ å‚ä¼˜å…ˆçº§ï¼š x86ï¼šecx edx æ ˆ x64ï¼šrcx rdx r8 r9 æ ˆ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687; int __cdecl main()_main proc near ; CODE XREF: j__mainâ†‘j var_C = byte ptr -0Chres = dword ptr -8 push ebp mov ebp, esp sub esp, 0CCh push ebx push esi push edi __$EncStackInitStart_2: lea edi, [ebp+var_C] mov ecx, 3 mov eax, 0CCCCCCCCh rep stosd __$EncStackInitEnd_2: ; JMC_flag mov ecx, offset _6005466B_entry@cpp call j_@__CheckForDebuggerJustMyCode@4 ; __CheckForDebuggerJustMyCode(x) nop push 3 ; å‚æ•°cå…¥æ ˆ mov edx, 2 ; å‚æ•°bå­˜å…¥å¯„å­˜å™¨ mov ecx, 1 ; å‚æ•°aå­˜å…¥å¯„å­˜å™¨ call j_?sum@@YIHHHH@Z ; sum(int,int,int) mov [ebp+res], eax ;è¿™é‡Œä¹Ÿæ˜¯æ²¡æœ‰è°ƒç”¨è€…å¯¹å‚æ•°å ç”¨çš„æ ˆç©ºé—´çš„æ¸…ç† mov eax, [ebp+res] push eax push offset _Format ; &quot;%d\\n&quot; call j__printf add esp, 8 xor eax, eax pop edi pop esi pop ebx add esp, 0CCh cmp ebp, esp call j___RTC_CheckEsp mov esp, ebp pop ebp retn_main endp; int __fastcall sum(int a, int b, int c)?sum@@YIHHHH@Z proc near ; CODE XREF: sum(int,int,int)â†‘j var_18 = byte ptr -18hb = dword ptr -14ha = dword ptr -8c = dword ptr 8 push ebp mov ebp, esp sub esp, 0D8h ;sumå¼€è¾Ÿæ ˆç©ºé—´ push ebx push esi push edi push ecx __$EncStackInitStart: lea edi, [ebp+var_18] mov ecx, 6 mov eax, 0CCCCCCCCh rep stosd __$EncStackInitEnd: pop ecx mov [ebp+b], edx mov [ebp+a], ecx mov ecx, offset _6005466B_entry@cpp ; JMC_flag call j_@__CheckForDebuggerJustMyCode@4 ; __CheckForDebuggerJustMyCode(x) nop mov eax, [ebp+a] add eax, [ebp+b] add eax, [ebp+c] pop edi pop esi pop ebx add esp, 0D8h ;sumæ¸…ç†æ ˆç©ºé—´ cmp ebp, esp call j___RTC_CheckEsp mov esp, ebp pop ebp retn 4 ;ç”±äºåªæœ‰ä¸€ä¸ªå‚æ•°è¢«pushåˆ°æ ˆä¸Šï¼Œæ‰€ä»¥è¢«è°ƒç”¨è€…è¿”å›4ï¼Œæ¸…ç†å‚æ•°å ç”¨çš„æ ˆç©ºé—´?sum@@YIHHHH@Z endp","link":"/2025/07/12/Day5-%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8%E7%BA%A6%E5%AE%9A/"},{"title":"Day17:pythoné€†å‘","text":"pycé€†å‘ï¼Œpythonå¯æ‰§è¡Œæ–‡ä»¶é€†å‘ pycæ–‡ä»¶ pycæ–‡ä»¶æ˜¯pyæ–‡ä»¶ç¼–è¯‘è¿‡ç¨‹ä¸­äº§ç”Ÿçš„ä¸­é—´æ–‡ä»¶ï¼Œæ˜¯ä¸€ç§äºŒè¿›åˆ¶æ–‡ä»¶ã€‚pycæ–‡ä»¶å¯ä»¥ç”±pythonè™šæ‹Ÿæœºç›´æ¥æ‰§è¡Œã€‚ä¸åŒç‰ˆæœ¬çš„pythonç¼–è¯‘å‡ºæ¥çš„pycæ–‡ä»¶æ˜¯ä¸åŒçš„ pycæ–‡ä»¶ç»“æ„ ä¸€ä¸ªpycæ–‡ä»¶ç”±ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ç»„æˆï¼š å…¶ä¸­CodeObjectæ˜¯ç»è¿‡åºåˆ—åŒ–å¤„ç†çš„pythonæºç çš„äºŒè¿›åˆ¶ç  pycå­—èŠ‚ç  pycæ–‡ä»¶æ˜¯äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå› æ­¤ä¹Ÿå¯ä»¥è¿›è¡Œåæ±‡ç¼–ã€‚pycæ–‡ä»¶æœ‰ä¸“é—¨çš„æ±‡ç¼–ä»£ç ï¼Œå°±åƒjavaæœ‰smaliæ±‡ç¼–ä¸€æ ·ã€‚ ä¸‹é¢æ˜¯ä¸€ä¸ªpycæ–‡ä»¶çš„åæ±‡ç¼–ä»£ç  1234567891011121314151617181920212223242526272829303132åŸä»£ç è¡Œå·|æŒ‡ä»¤çš„åç§»|æŒ‡ä»¤ç¬¦å·|æŒ‡ä»¤å‚æ•°ï¼ˆç´¢å¼•å€¼ï¼‰|å‚æ•°å®é™…å€¼ 0 0 RESUME 0 1 2 LOAD_CONST 0 (&lt;code object add at 0x00000186246D3770, file &quot;test.py&quot;, line 1&gt;) 4 MAKE_FUNCTION 0 6 STORE_NAME 0 (add)//æŠŠaddå‡½æ•°å­˜å…¥å‡½æ•°è¡¨ï¼Œç»™ç´¢å¼•å€¼0 3 8 PUSH_NULL 10 LOAD_NAME 1 (print)//åŠ è½½å‡½æ•°è¡¨ç´¢å¼•ä¸º1çš„å‡½æ•°print 12 LOAD_CONST 1 ('hello python')//åŠ è½½å¸¸é‡è¡¨ç´¢å¼•ä¸º1çš„&quot;hello python&quot; 14 CALL 1//callç´¢å¼•ä¸º1çš„å‡½æ•°print 22 POP_TOP 4 24 PUSH_NULL 26 LOAD_NAME 1 (print) 28 PUSH_NULL 30 LOAD_NAME 0 (add) 32 LOAD_CONST 2 (1) 34 LOAD_CONST 3 (2) 36 CALL 2 44 CALL 1 52 POP_TOP 54 RETURN_CONST 4 (None)Disassembly of &lt;code object add at 0x00000186246D3770, file &quot;test.py&quot;, line 1&gt;: 1 0 RESUME 0 2 2 LOAD_FAST 0 (a) 4 LOAD_FAST 1 (b) 6 BINARY_OP 0 (+) 10 RETURN_VALUE å¯¹ä¸Šé¢çš„ä¸€äº›æŒ‡ä»¤è¿›è¡Œè§£é‡Šï¼š LOAD_CONSTç”¨äºåŠ è½½å¸¸é‡ï¼Œåé¢è·Ÿç€çš„æ•°å­—æ˜¯å¸¸é‡åœ¨å¸¸é‡è¡¨ä¸­çš„ç´¢å¼• LOAD_NAMEç”¨äºåŠ è½½å‡½æ•°ï¼Œåé¢è·Ÿç€çš„æ•°å­—æ˜¯å‡½æ•°åœ¨å‡½æ•°è¡¨ä¸­çš„ç´¢å¼• LOAD_FASTç”¨äºåŠ è½½å±€éƒ¨å˜é‡ï¼ˆå¦‚å‡½æ•°å®šä¹‰æ—¶å€™çš„å‚æ•°æˆ–è€…å†…éƒ¨å˜é‡ï¼‰ å¯ä»¥æ³¨æ„åˆ°LOAD_NAMEæ€»æ˜¯å…ˆäºLOAD_CONSTçš„ï¼Œå³å‡½æ•°æ¯”å‚æ•°å…ˆä¸€æ­¥åŠ è½½ pythonè™šæ‹Ÿæœºæ˜¯åŸºäºæ ˆçš„ï¼Œæ‰€ä»¥å¯ä»¥çœ‹åˆ°POPç­‰å­—çœ¼ï¼ŒLOADç³»åˆ—æ“ä½œå®é™…ä¸Šæ˜¯å…¥æ ˆæ“ä½œ pycæ–‡ä»¶é€†å‘ æœªç»è¿‡æ··æ·†çš„pycæ–‡ä»¶ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡åœ¨çº¿å·¥å…·ï¼ˆå¦‚ï¼šåœ¨çº¿Python pycæ–‡ä»¶ç¼–è¯‘ä¸åç¼–è¯‘ï¼‰æˆ–è€…uncompyle6ã€decompyle3ï¼ˆå‡å¯é€šè¿‡pip installå®‰è£…ï¼‰è½¬æˆpythonä»£ç  pycæ–‡ä»¶çš„æ··æ·†ï¼Œå°±ç±»ä¼¼èŠ±æŒ‡ä»¤ï¼Œé€šè¿‡åœ¨æ±‡ç¼–å±‚é¢æ’å…¥åƒåœ¾æŒ‡ä»¤å¹²æ‰°é™æ€åˆ†æã€‚è§£å†³åŠæ³•å°±æ˜¯ä¿®æ”¹äºŒè¿›åˆ¶æ–‡ä»¶ï¼ŒæŠŠåƒåœ¾æŒ‡ä»¤çš„äºŒè¿›åˆ¶ç ç»™åˆ é™¤ã€‚å¯ä»¥çœ‹çœ‹è¿™ç¯‡ï¼š Pythonä»£ç ä¿æŠ¤ | pyc æ··æ·†ä»å…¥é—¨åˆ°å·¥å…·å®ç° - çŸ¥ä¹ pythonå¯æ‰§è¡Œæ–‡ä»¶ pythonæ–‡ä»¶å¯ä»¥è¢«æ‰“åŒ…æˆå¯æ‰§è¡Œæ–‡ä»¶ï¼Œé»˜è®¤å›¾æ ‡é•¿è¿™æ ·ï¼š å¯¹äºæ­¤ç±»é—®é¢˜ï¼Œå…ˆä½¿ç”¨pyinstxtractorè§£åŒ…ç¨‹åºï¼ˆè¿™é‡Œæ‹¿ä¸€ä¸ªä¸çŸ¥é“å“ªé‡Œæ¥çš„pythonexeæ–‡ä»¶ä¸¾ä¾‹ï¼‰ï¼š pyinstxtractorä¼šæŠŠå¯æ‰§è¡Œæ–‡ä»¶è§£åŒ…åˆ°å¸¦åç¼€extractedçš„ä¸€ä¸ªæ–‡ä»¶å¤¹é‡Œï¼Œé™¤æ­¤ä¹‹å¤–å¯ä»¥çœ‹åˆ°ï¼Œç¨‹åºä¼šç»™å‡ºå¯èƒ½çš„å…¥å£æ–‡ä»¶ï¼Œä»¥åŠå¯æ‰§è¡Œæ–‡ä»¶çš„pythonç‰ˆæœ¬ï¼Œç„¶åå°±å¯ä»¥åˆ†æè¿™äº›pycæ–‡ä»¶äº† pythonæ–‡ä»¶è¢«æ‰“åŒ…çš„æ—¶å€™è¿˜å¯ä»¥æŒ‡å®šåŠ å¯†å‚æ•°ï¼Œè§£å¯†çš„æ—¶å€™æ ¹æ®æ‰“åŒ…çš„pyinstallerç‰ˆæœ¬å¯ä»¥åˆ†ä¸ºä¸¤ç§ï¼Œå¤§äº4.0çš„å’Œå°äº4.0çš„ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„è„šæœ¬è§£å¯†ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647//å¤§äº4.0ç‰ˆæœ¬import tinyaesimport zlibCRYPT_BLOCK_SIZE=16key = butes('here_be_your_key','utf-8')inf=open('here_be_your_file_name','rb')outf=open('here_be_your_output_file','wb')iv=inf.read(CRYPT_BLOCK_SIZE)cipher=tinyaes.AES(key,iv)plaintext=zlib.decompress(cipher.CTR_xcrypt_buffer(inf.read()))outf.write(b'\\x55\\x0d\\x0d\\x0a\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0')#here be your magic number from pyfile in the same dir,16bytesoutf.write(plaintext)inf.close()outf.close()//å°äº4.0ç‰ˆæœ¬from Crypto.Cipher import AESimport zlibCRYPT_BLOCK_SIZE=16key=b'here_be_your_key'inf=open('here_be_your_cryptedfile_name','rb')outf=open('here_be_your_output_file_name','wb')iv=inf.read(CRYPT_BLOCK_SIZE)cipher-AES.new(key,AES.MODE_CFB,iv)plaintext=zlib.decompress(cipher,hecrypt(inf.read())) outf.write('here_be_your_magicnumber')#8bytesoutf.write(plaintext)inf.close()outf.close() ä»£ç é‡Œé¢çš„keyå¯ä»¥æ‰¾å¯ç–‘çš„pycæ–‡ä»¶è½¬æˆpythonä»£ç æŸ¥çœ‹ï¼Œè€Œç‰ˆæœ¬å¯ä»¥é€šè¿‡æŸ¥çœ‹pyimod01_archive.pycå¯¼å…¥çš„åŠ å¯†åº“æ¥è¯†åˆ«ï¼ˆä¸Šé¢ä¸¤ä¸ªç‰ˆæœ¬çš„è„šæœ¬å¯¼å…¥çš„åŠ å¯†åº“åˆ†åˆ«æ˜¯tinyaeså’ŒAESï¼Œæ˜¯ä¸ä¸€æ ·çš„ï¼‰","link":"/2025/10/05/Day17-python%E9%80%86%E5%90%91/"},{"title":"Day6:if-elseè¯­å¥è¯†åˆ«ã€switchè¯­å¥è¯†åˆ«ã€å¾ªç¯è¯­å¥è¯†åˆ«","text":"if-elseè¯­å¥è¯†åˆ«ã€switchè¯­å¥è¯†åˆ«ã€å¾ªç¯è¯­å¥è¯†åˆ« if-elseè¯­å¥è¯†åˆ« ç¬¬ä¸€ç§ï¼Œæ•°å€¼æ¯”è¾ƒä½œä¸ºæ¡ä»¶ï¼ˆx86debugä¸ºä¾‹ï¼Œå…¶ä½™ç±»ä¼¼ï¼Œä»…æ˜¯æ¯”è¾ƒæ–¹æ³•ï¼ˆå¦‚ä½¿ç”¨subè€Œä¸æ˜¯cmpï¼‰å’Œæ¨¡å¼ç‰¹å¾ä¸Šçš„å·®å¼‚ï¼‰ 1234567891011121314151617.text:004702D0 lea eax, [ebp+var_C].text:004702D3 push eax.text:004702D4 push offset unk_545E50 ; %d.text:004702D9 call sub_4681E0 ; scanf.text:004702DE add esp, 8.text:004702E1 cmp [ebp+var_C], 1.text:004702E5 jnz short loc_4702F6 ; if [ebp+var_C]!=1, jump to loc_4702f6.text:004702E7 push offset aNEquales1 ; &quot;n equales 1&quot;.text:004702EC call sub_468D1B ; printf.text:004702F1 add esp, 4.text:004702F4 jmp short loc_470303.text:004702F6 ; ---------------------------------------------------------------------------.text:004702F6.text:004702F6 loc_4702F6: ; CODE XREF: main+45â†‘j.text:004702F6 push offset aNDoesNotEqual1 ; &quot;n does not equal 1&quot;.text:004702FB call sub_468D1B ; printf.text:00470300 add esp, 4 æºç ï¼š 123456int n;scanf(&quot;%d&quot;, &amp;n);if (n == 1) printf(&quot;n equales 1&quot;);else printf(&quot;n does not equal 1&quot;); ç¬¬äºŒç§ï¼Œå˜é‡ç›´æ¥ä½œä¸ºæ¡ä»¶ 12345678910.text:00470303 lea eax, [ebp+var_18].text:00470306 push eax.text:00470307 push offset unk_545E50 ; %d.text:0047030C call sub_4681E0 ; scanf.text:00470311 add esp, 8.text:00470314 cmp [ebp+var_18], 0 ; å’Œ'0'æ¯”è¾ƒ.text:00470318 jz short loc_470327 ; if [ebp+var_18]==0, jump to loc_470327, è·³è¿‡printf.text:0047031A push offset aJudgeIsNotZero ; &quot;judge is not zero&quot;.text:0047031F call sub_468D1B ; printf.text:00470324 add esp, 4 æºç ï¼š 1234int judge;scanf(&quot;%d&quot;, &amp;judge);if (judge) printf(&quot;judge is not zero&quot;); ç¬¬ä¸‰ç§ï¼Œè¿”å›å€¼ï¼ˆå‡½æ•°å¼ï¼‰ä½œä¸ºæ¡ä»¶ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253.text:00470387 lea eax, [ebp+var_24].text:0047038A push eax.text:0047038B push offset unk_545E50 ; %d.text:00470390 call sub_4681E0 ; scanf.text:00470395 add esp, 8.text:00470398 mov eax, [ebp+var_24].text:0047039B push eax ; è¾“å…¥çš„å€¼å…¥æ ˆï¼Œå³å‡½æ•°ä¼ å‚.text:0047039C call sub_46B214 ; è‡ªå®šä¹‰å‡½æ•°.text:004703A1 add esp, 4.text:004703A4 test eax, eax ; 1 &amp; 1 = 0ï¼› 0 &amp; 0 = 1.text:004703A6 jz short loc_4703B5.text:004703A8 push offset aItS0 ; &quot;it's 0\\n&quot;.text:004703AD call sub_468D1B.text:004703B2 add esp, 4;sub_46b214.text:00470110 arg_0 = dword ptr 8.text:00470110.text:00470110 push ebp.text:00470111 mov ebp, esp.text:00470113 sub esp, 0C0h.text:00470119 push ebx.text:0047011A push esi.text:0047011B push edi.text:0047011C mov edi, ebp.text:0047011E xor ecx, ecx.text:00470120 mov eax, 0CCCCCCCCh.text:00470125 rep stosd.text:00470127 mov ecx, offset unk_57500E.text:0047012C call sub_46B660.text:00470131 nop.text:00470132 cmp [ebp+arg_0], 0 ; [ebp+8], eaxåœ¨æ ˆä¸Šçš„ä½ç½®.text:00470136 jnz short loc_470141 ; eax=0.text:00470138 mov eax, 1 ; if [ebp+arg_0]==0, eax=1, return 1(eax).text:0047013D jmp short loc_470143.text:0047013F ; ---------------------------------------------------------------------------.text:0047013F jmp short loc_470143.text:00470141 ; ---------------------------------------------------------------------------.text:00470141.text:00470141 loc_470141: ; CODE XREF: sub_470110+26â†‘j.text:00470141 xor eax, eax ; eax=0.text:00470143.text:00470143 loc_470143: ; CODE XREF: sub_470110+2Dâ†‘j.text:00470143 ; sub_470110+2Fâ†‘j.text:00470143 pop edi.text:00470144 pop esi.text:00470145 pop ebx.text:00470146 add esp, 0C0h.text:0047014C cmp ebp, esp.text:0047014E call sub_46A62A.text:00470153 mov esp, ebp.text:00470155 pop ebp.text:00470156 retn æºç  1234567891011121314int IfZero(int a) { if (a == 0) return 1; else return 0;}int main(){ int a; scanf(&quot;%d&quot;, &amp;a); if(IfZero(a)) printf(&quot;it's 0\\n&quot;); return 0;} switchè¯­å¥è¯†åˆ« æ¯”è¾ƒç®€å•çš„æƒ…å†µä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546.text:00470327 lea eax, [ebp+var_24].text:0047032A push eax.text:0047032B push offset unk_545E50 ; %d.text:00470330 call sub_4681E0 ; scanf.text:00470335 add esp, 8.text:00470338 mov eax, [ebp+var_24].text:0047033B mov [ebp+var_EC], eax ; [ebp+var_EC]==[ebp+var_24], ç”¨ä¸´æ—¶å˜é‡[ebp+var_EC]æ¥æ£€éªŒcase.text:00470341 cmp [ebp+var_EC], 1.text:00470348 jz short loc_47035E ; case1è¾“å‡º.text:0047034A cmp [ebp+var_EC], 5.text:00470351 jz short loc_470371 ; case5è¾“å‡º.text:00470353 cmp [ebp+var_EC], 0Ah.text:0047035A jz short loc_470384 ; case10è¾“å‡º.text:0047035C jmp short loc_470395 ; breakç„¶åsystem(&quot;pause&quot;).text:0047035E ; ---------------------------------------------------------------------------.text:0047035E.text:0047035E loc_47035E: ; CODE XREF: main+A8â†‘j.text:0047035E mov eax, [ebp+var_24].text:00470361 push eax.text:00470362 push offset aNEqualsD ; &quot;n equals %d&quot;.text:00470367 call sub_468D1B ; printf.text:0047036C add esp, 8.text:0047036F jmp short loc_470395.text:00470371 ; ---------------------------------------------------------------------------.text:00470371.text:00470371 loc_470371: ; CODE XREF: main+B1â†‘j.text:00470371 mov eax, [ebp+var_24].text:00470374 push eax.text:00470375 push offset aNEqualsD ; &quot;n equals %d&quot;.text:0047037A call sub_468D1B ; printf.text:0047037F add esp, 8.text:00470382 jmp short loc_470395.text:00470384 ; ---------------------------------------------------------------------------.text:00470384.text:00470384 loc_470384: ; CODE XREF: main+BAâ†‘j.text:00470384 mov eax, [ebp+var_24].text:00470387 push eax.text:00470388 push offset aNEqualsD ; &quot;n equals %d&quot;.text:0047038D call sub_468D1B ; printf.text:00470392 add esp, 8.text:00470395.text:00470395 loc_470395: ; CODE XREF: main+BCâ†‘j.text:00470395 ; main+CFâ†‘j ....text:00470395 push offset aPause ; &quot;pause&quot;.text:0047039A call sub_46AFAD ; system(&quot;pause&quot;).text:0047039F add esp, 4 æºç ï¼š 1234567891011121314int number;scanf(&quot;%d&quot;, &amp;number);switch (number) {case 1: printf(&quot;n equals %d&quot;, number); break;case 5: printf(&quot;n equals %d&quot;, number); break;case 10: printf(&quot;n equals %d&quot;, number); break;}system(&quot;pause&quot;); å†å¤æ‚ç‚¹ï¼Œä¼šä¼˜åŒ–å‡ºè·³è½¬è¡¨ï¼Œå³æ¯ä¸ªcaseè·³è½¬çš„åœ°å€ä¼šè¢«é›†åˆæˆä¸€ä¸ªæ•°ç»„ï¼Œåƒè¡¨ä¸€æ · 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889.text:004702D3 push eax.text:004702D4 push offset unk_545E50 ; %d.text:004702D9 call sub_4681E0 ; scanf.text:004702DE add esp, 8.text:004702E1 mov eax, [ebp+var_C].text:004702E4 mov [ebp+var_D4], eax.text:004702EA mov ecx, [ebp+var_D4] ; æŠŠè¾“å…¥å€¼ä¼ åˆ°ecxï¼Œä¸‹ä¸€æ­¥å‡å»1ï¼Œå‡1çš„åŸå› è§åé¢çš„è§£é‡Š.text:004702F0 sub ecx, 1 ; switch 67 cases.text:004702F3 mov [ebp+var_D4], ecx.text:004702F9 cmp [ebp+var_D4], 42h ; æŠŠè¾“å…¥å€¼å’Œ42h(66)æ¯”è¾ƒï¼Œä¸‹ä¸€æ­¥æ˜¯å¤§äº66å°±è·³å‡ºcaseçš„åˆ¤æ–­.text:00470300 ja def_470313 ; jumptable 00470313 default case, cases 2,4,6-9,12-16,18-66.text:00470306 mov edx, [ebp+var_D4].text:0047030C movzx eax, ds:byte_470418[edx] ; è·³è½¬è¡¨ç´¢å¼•å€¼è¡¨ï¼Œå³é¢„åˆ¤äº†è¾“å…¥å€¼çš„èŒƒå›´å¹¶ä¸”ä¸ºæ¯ä¸ªå¯èƒ½çš„å€¼å»ºç«‹äº†ç´¢å¼•å€¼è¡¨ï¼ˆæ¯”å¦‚è¯´ç°åœ¨ç¡®å®šäº†èŒƒå›´æ˜¯0-66ï¼Œå°±æšä¸¾äº†0-66è¿™äº›æ•°å€¼å¯¹åº”çš„ç´¢å¼•ï¼Œç„¶åå†æ ¹æ®ç´¢å¼•æ‰¾åˆ°åº”æ”¹è·³è½¬çš„åœ°å€.text:00470313 jmp ds:jpt_470313[eax*4] ; switch jump.text:0047031A ; ---------------------------------------------------------------------------.text:0047031A.text:0047031A loc_47031A: ; CODE XREF: sub_4702A0+73â†‘j.text:0047031A ; DATA XREF: .text:jpt_470313â†“o.text:0047031A mov eax, [ebp+var_C] ; jumptable 00470313 case 1.text:0047031D push eax.text:0047031E push offset aNEqualsD ; &quot;n equals %d&quot;.text:00470323 call sub_468D1B ; printf.text:00470328 add esp, 8.text:0047032B jmp short def_470313 ; jumptable 00470313 default case, cases 2,4,6-9,12-16,18-66.text:0047032D ; ---------------------------------------------------------------------------.text:0047032D.text:0047032D loc_47032D: ; CODE XREF: sub_4702A0+73â†‘j.text:0047032D ; DATA XREF: .text:jpt_470313â†“o.text:0047032D mov eax, [ebp+var_C] ; jumptable 00470313 case 5.text:00470330 push eax.text:00470331 push offset aNEqualsD ; &quot;n equals %d&quot;.text:00470336 call sub_468D1B ; printf.text:0047033B add esp, 8.text:0047033E jmp short def_470313 ; jumptable 00470313 default case, cases 2,4,6-9,12-16,18-66.text:00470340 ; ---------------------------------------------------------------------------.text:00470340.text:00470340 loc_470340: ; CODE XREF: sub_4702A0+73â†‘j.text:00470340 ; DATA XREF: .text:jpt_470313â†“o.text:00470340 mov eax, [ebp+var_C] ; jumptable 00470313 case 10.text:00470343 push eax.text:00470344 push offset aNEqualsD ; &quot;n equals %d&quot;.text:00470349 call sub_468D1B ; printf.text:0047034E add esp, 8.text:00470351 jmp short def_470313 ; jumptable 00470313 default case, cases 2,4,6-9,12-16,18-66.text:00470353 ; ---------------------------------------------------------------------------.text:00470353.text:00470353 loc_470353: ; CODE XREF: sub_4702A0+73â†‘j.text:00470353 ; DATA XREF: .text:jpt_470313â†“o.text:00470353 mov eax, [ebp+var_C] ; jumptable 00470313 case 17.text:00470356 push eax.text:00470357 push offset aNEqualsD ; &quot;n equals %d&quot;.text:0047035C call sub_468D1B ; printf.text:00470361 add esp, 8.text:00470364 jmp short def_470313 ; jumptable 00470313 default case, cases 2,4,6-9,12-16,18-66.text:00470366 ; ---------------------------------------------------------------------------.text:00470366.text:00470366 loc_470366: ; CODE XREF: sub_4702A0+73â†‘j.text:00470366 ; DATA XREF: .text:jpt_470313â†“o.text:00470366 mov eax, [ebp+var_C] ; jumptable 00470313 case 11.text:00470369 push eax.text:0047036A push offset aNEqualsD ; &quot;n equals %d&quot;.text:0047036F call sub_468D1B ; printf.text:00470374 add esp, 8.text:00470377 jmp short def_470313 ; jumptable 00470313 default case, cases 2,4,6-9,12-16,18-66.text:00470379 ; ---------------------------------------------------------------------------.text:00470379.text:00470379 loc_470379: ; CODE XREF: sub_4702A0+73â†‘j.text:00470379 ; DATA XREF: .text:jpt_470313â†“o.text:00470379 mov eax, [ebp+var_C] ; jumptable 00470313 case 67.text:0047037C push eax.text:0047037D push offset aNEqualsD ; &quot;n equals %d&quot;.text:00470382 call sub_468D1B ; printf.text:00470387 add esp, 8.text:0047038A jmp short def_470313 ; jumptable 00470313 default case, cases 2,4,6-9,12-16,18-66.text:0047038C ; ---------------------------------------------------------------------------.text:0047038C.text:0047038C loc_47038C: ; CODE XREF: sub_4702A0+73â†‘j.text:0047038C ; DATA XREF: .text:jpt_470313â†“o.text:0047038C mov eax, [ebp+var_C] ; jumptable 00470313 case 3.text:0047038F push eax.text:00470390 push offset aNEqualsD ; &quot;n equals %d&quot;.text:00470395 call sub_468D1B ; printf.text:0047039A add esp, 8.text:0047039D.text:0047039D def_470313: ; CODE XREF: sub_4702A0+60â†‘j.text:0047039D ; sub_4702A0+73â†‘j ....text:0047039D push offset aPause ; jumptable 00470313 default case, cases 2,4,6-9,12-16,18-66.text:004703A2 call sub_46AFAD ; system.text:004703A7 add esp, 4 æºç  1234567891011121314151617181920212223242526int number;scanf(&quot;%d&quot;, &amp;number);switch (number) {case 1: printf(&quot;n equals %d&quot;, number); break;case 5: printf(&quot;n equals %d&quot;, number); break;case 10: printf(&quot;n equals %d&quot;, number); break;case 17: printf(&quot;n equals %d&quot;, number); break;case 11: printf(&quot;n equals %d&quot;, number); break;case 67: printf(&quot;n equals %d&quot;, number); break;case 3: printf(&quot;n equals %d&quot;, number); break;}system(&quot;pause&quot;); å¯¹è·³è½¬è¡¨å’Œç´¢å¼•å€¼è¡¨è¿›è¡Œè¿›ä¸€æ­¥è§£é‡Šï¼š å…ˆçœ‹è·³è½¬è¡¨ï¼š å¯ä»¥çœ‹åˆ°è·³è½¬è¡¨åªæœ‰ç®€å•çš„8ç§æƒ…å†µã€‚ä½†æ˜¯ç¼–è¯‘å™¨ï¼ˆåç¼–è¯‘å™¨ï¼Ÿï¼‰åªèƒ½æ ¹æ®caseçš„æœ€å¤§å€¼ç”¨ç¬¨æ–¹æ³•æšä¸¾å¯èƒ½çš„å€¼ï¼Œè¿™æ—¶å€™ï¼Œå°±å¯ä»¥ç»™è¿™äº›æšä¸¾çš„å€¼åˆ†æˆä¸¤ç§ï¼šä¸€ç§æ˜¯caseé‡Œæœ‰çš„ï¼Œä¸€ç§æ˜¯caseé‡Œæ²¡æœ‰çš„ã€‚çœ‹è·³è½¬è¡¨çš„æœ€åä¸€ä¸ªï¼Œå«defè€Œä¸æ˜¯locï¼Œè¿™ä¸ªå°±æ˜¯ç»™caseé‡Œæ²¡æœ‰çš„æšä¸¾å€¼å‡†å¤‡çš„ã€‚å› ä¸ºåˆ†ä¸ºcaseé‡Œæœ‰çš„å’Œæ²¡æœ‰çš„ï¼Œå› æ­¤ï¼Œcaseé‡Œæœ‰çš„ï¼Œä¼šç»™å‡ºå…·ä½“çš„ç´¢å¼•å€¼ï¼›caseé‡Œæ²¡æœ‰çš„ï¼Œç»Ÿä¸€å¯¼å‘è·³è½¬è¡¨çš„æœ€åä¸€ä¸ªã€‚å†çœ‹ç´¢å¼•å€¼è¡¨ï¼š å¯ä»¥çœ‹åˆ°ï¼Œé‡Œé¢æšä¸¾äº†0åˆ°66å¯¹åº”çš„ç´¢å¼•å€¼ã€‚çœ‹æ±‡ç¼–ä»£ç ï¼Œæ˜¯å°†è¾“å…¥çš„å€¼ä½œä¸ºç´¢å¼•å€¼è¡¨çš„ç´¢å¼•æ¥ç”¨çš„ï¼Œç´¢å¼•å‡ºæ¥çš„å€¼å†ä½œä¸ºè·³è½¬è¡¨çš„ç´¢å¼•ã€‚æ³¨æ„çœ‹ï¼Œç´¢å¼•å€¼è¡¨çš„æœ€å°å€¼ä¸º0ï¼Œå› æ­¤ï¼Œè·³è½¬è¡¨å’Œæ•°ç»„ä¸€æ ·ä»0å¼€å§‹ç´¢å¼•ï¼Œè€Œ0-7å¯¹åº”è·³è½¬è¡¨çš„å…«ç§æƒ…å†µã€‚é€šè¿‡è¿›ä¸€æ­¥æŒ–æ˜ä¿¡æ¯ï¼Œè¿˜å¯ä»¥çŸ¥é“è·³è½¬è¡¨æ˜¯æŠŠcaseæŒ‰ç…§ä»å°åˆ°å¤§çš„é¡ºåºæ’åˆ—çš„ã€‚å› æ­¤ï¼Œæœ€å¼€å§‹ä¼šå¯¹è¾“å…¥å€¼æœ‰ä¸€ä¸ªå‡çš„æ“ä½œã€‚è‡³äºä¸ºä»€ä¹ˆå‡1ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ¨æµ‹æœ€å°çš„caseæ˜¯1äº†ï¼Œå› ä¸ºç´¢å¼•ä»0å¼€å§‹ï¼Œè€Œæœ€å°çš„caseåœ¨ç´¢å¼•0å¤„ã€‚ è¿™æ ·è§£é‡Šä¸‹æ¥å¯èƒ½è¿˜æœ‰ç‚¹ç»•ï¼Œæ‰€ä»¥æˆ‘ä»¬æŒ‰ç…§æœºå™¨çš„åŠ¨ä½œèµ°ä¸€éï¼š é¦–å…ˆï¼ŒæŠŠcaseæŒ‰é¡ºåºæ’å‡ºè·³è½¬è¡¨ã€‚ ç„¶åï¼Œå‡è®¾æˆ‘ä»¬æ‹¿åˆ°è¾“å…¥çš„å€¼ã€‚ä½œä¸ºæœºå™¨ï¼Œæˆ‘ä»¬çŸ¥é“caseæœ‰ï¼š1ï¼Œ3ï¼Œ5ï¼Œ10ï¼Œ17ï¼Œ11ï¼Œ67ï¼Œæ‰€ä»¥å…ˆç»™è¾“å…¥çš„å€¼å‡1ï¼Œä»¥ä¾¿è¿™ä¸ªå€¼æ˜¯1çš„æ—¶å€™æˆ‘ä»¬å¯ä»¥ç´¢å¼•åˆ°è·³è½¬è¡¨ä¸‹æ ‡0å¤„ã€‚åŒæ—¶ï¼Œå¦‚æœè¿™ä¸ªå€¼å¤§äº66ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ç›´æ¥è·³è¿‡caseæ£€æŸ¥ï¼Œç›´æ¥å¯¼å‡ºå»ï¼ˆåˆšå¥½å’Œåœ¨caseæœ€å¤§æœ€å°å€¼èŒƒå›´å†…ä½†ä¸æ˜¯caseçš„å€¼ä¸€æ ·å¯¹å¾…ï¼‰ å†ç„¶åï¼Œæˆ‘ä»¬æšä¸¾0-66çš„å€¼ï¼Œå¹¶ä¸”æŠŠè¿™äº›å€¼å’Œcaseé‡Œæœ‰çš„å€¼ä¸€ä¸€æ¯”è¾ƒï¼Œåˆ†å‡ºä¸¤ç§å€¼ï¼šä¸€ç§åœ¨caseé‡Œï¼Œä¸€ç§ä¸å†caseé‡Œã€‚ okï¼Œç„¶åæˆ‘ä»¬å»ºç«‹ç´¢å¼•å€¼è¡¨ï¼Œç»™åœ¨caseé‡Œçš„æšä¸¾å€¼å¯¹åº”çš„è·³è½¬è¡¨ç´¢å¼•å€¼ï¼Œæ¯”å¦‚è¯´æšä¸¾å€¼2ï¼ˆè¾“å…¥å€¼æ˜¯3ï¼‰ï¼Œåˆšå¥½caseé‡Œæœ‰3ï¼ŒæŒ‰é¡ºåºæ’ç¬¬äºŒï¼Œæˆ‘ä»¬å°±ç»™ç´¢å¼•å€¼1ï¼ˆä»0å¼€å§‹ç´¢å¼•ï¼‰ã€‚å›å¤´çœ‹æˆªå‡ºæ¥çš„ç´¢å¼•å€¼è¡¨ï¼Œåœ¨ä¸‹æ ‡2çš„åœ°æ–¹åˆšå¥½æ˜¯1ï¼ˆæšä¸¾å€¼ç´¢å¼•å‡ºè·³è½¬è¡¨ç´¢å¼•ï¼‰ï¼›ç»™ä¸åœ¨caseé‡Œçš„å€¼ç´¢å¼•åˆ°7ï¼Œå¯¹åº”è·³è½¬è¡¨æœ€åä¸€ä½ï¼ˆä¸ºæ²¡åœ¨caseé‡Œçš„å€¼ä¸“é—¨å‡†å¤‡çš„é‚£ä¸€ä½ï¼‰ã€‚ æœ€åï¼Œæˆ‘ä»¬å°±å‡†å¤‡å¥½æˆ‘ä»¬çš„è§£å†³æ–¹æ¡ˆäº†ï¼Œå¯¹äºä»»æ„è¾“å…¥çš„å€¼æˆ‘ä»¬å°±éƒ½æœ‰å¯¹ç­–äº†ã€‚ è¯·åŠ¡å¿…çœŸæ­£ç†è§£ä¸Šè¿°å†…å®¹ï¼Œå› ä¸ºåœ¨é€†å‘å·¥ç¨‹ä¸­ï¼Œè¿™ä¹ˆç»•çš„æ“ä½œå¾ˆå¸¸è§ã€‚åœ¨PEæ–‡ä»¶ç»“æ„éƒ¨åˆ†ï¼Œæˆ‘ä»¬æˆ–è®¸è¿˜æœ‰æœºä¼šå†æ¥è§¦åˆ°è¿™ä¹ˆç»•çš„æ“ä½œã€‚ï¼ˆå…¶å®åªéœ€è¦å†™å‡ºç¨‹åºæ‹¿åˆ°idaé‡Œç‚¹å¼€è·³è½¬è¡¨å’Œç´¢å¼•å€¼è¡¨ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰çœ‹å‡ çœ¼å°±æ˜ç™½äº†ï¼Œäº²èº«å®è·µæ€»æ¯”é˜…è¯»æ–‡å­—æ¥çš„æœ‰æ•ˆï¼Œå› ä¸ºæ–‡å­—è¿˜å–å†³äºä¹¦å†™è€…çš„è¡¨è¾¾æ°´å¹³(â—â€™â—¡â€™â—)ï¼‰ å¾ªç¯è¯­å¥è¯†åˆ« ç¬¬ä¸€ç§ï¼Œforå¾ªç¯ 12345678910111213141516171819202122232425.text:00464096 mov [ebp+var_8], 0 ; ä¸€ä¸ªå˜é‡åˆå§‹åŒ–ä¸º0.text:0046409D mov [ebp+var_14], 1 ; å¦ä¸€ä¸ªå˜é‡åˆå§‹åŒ–ä¸º1.text:004640A4 jmp short loc_4640AF.text:004640A6 ; ---------------------------------------------------------------------------.text:004640A6.text:004640A6 loc_4640A6: ; CODE XREF: sub_464070+4Eâ†“j.text:004640A6 mov eax, [ebp+var_14].text:004640A9 add eax, 1 ; ç”¨eaxè¿‡æ¸¡ï¼Œç»™[ebp+var_14]åŠ 1.text:004640AC mov [ebp+var_14], eax.text:004640AF.text:004640AF loc_4640AF: ; CODE XREF: sub_464070+34â†‘j.text:004640AF cmp [ebp+var_14], 0Ah.text:004640B3 jg short loc_4640C0 ; [ebp+var_14]å¤§äº0Ahæ—¶è·³è½¬ï¼ˆå‡ºå¾ªç¯ï¼‰.text:004640B5 mov eax, [ebp+var_8].text:004640B8 add eax, [ebp+var_14] ; ç”¨eaxè¿‡æ¸¡ï¼ŒæŠŠ[ebp+var_14]çš„å€¼åŠ åˆ°[ebp+var_8]ä¸Š.text:004640BB mov [ebp+var_8], eax.text:004640BE jmp short loc_4640A6 ; è·³å›å»ï¼Œå½¢æˆå¾ªç¯.text:004640C0 ; ---------------------------------------------------------------------------.text:004640C0.text:004640C0 loc_4640C0: ; CODE XREF: sub_464070+43â†‘j.text:004640C0 mov eax, [ebp+var_8].text:004640C3 push eax.text:004640C4 push offset aCountD ; &quot;count : %d &quot;.text:004640C9 call sub_45DB54 ; printf.text:004640CE add esp, 8 æºç  12345int count = 0;for (int i = 1; i &lt;= 10; i++) { count += i;}printf(&quot;count : %d &quot;, count); ç¬¬äºŒç§ï¼Œwhileå¾ªç¯ 123456789101112131415161718192021.text:004640D1 mov [ebp+var_8], 0 ; ä¸€ä¸ªå˜é‡åˆå§‹åŒ–ä¸º0.text:004640D8 mov [ebp+var_20], 0Ah ; å¦ä¸€ä¸ªå˜é‡åˆå§‹åŒ–ä¸º10.text:004640DF.text:004640DF loc_4640DF: ; CODE XREF: sub_464070+87â†“j.text:004640DF cmp [ebp+var_20], 0.text:004640E3 jle short loc_4640F9 ; [ebp+var_20]å°äºç­‰äº0æ—¶è·³è½¬ï¼ˆå‡ºå¾ªç¯ï¼‰.text:004640E5 mov eax, [ebp+var_8].text:004640E8 add eax, [ebp+var_20] ; eaxè¿‡æ¸¡ï¼ŒæŠŠ[ebp+var_20]å€¼åŠ åˆ°[ebp+var_8]ä¸Š.text:004640EB mov [ebp+var_8], eax.text:004640EE mov eax, [ebp+var_20].text:004640F1 sub eax, 1 ; eaxè¿‡æ¸¡ï¼Œç»™[ebp+var_20]å‡1.text:004640F4 mov [ebp+var_20], eax.text:004640F7 jmp short loc_4640DF ; å›è·³ï¼Œå½¢æˆå¾ªç¯.text:004640F9 ; ---------------------------------------------------------------------------.text:004640F9.text:004640F9 loc_4640F9: ; CODE XREF: sub_464070+73â†‘j.text:004640F9 mov eax, [ebp+var_8].text:004640FC push eax.text:004640FD push offset aCountD ; &quot;count : %d &quot;.text:00464102 call sub_45DB54 ; printf.text:00464107 add esp, 8 æºç  1234567int count = 0;int n = 10;while (n &gt; 0) { count += n; n--;}printf(&quot;count : %d &quot;, count); ç¬¬ä¸‰ç§ï¼Œdo-whileå¾ªç¯ 1234567891011121314151617.text:0046410A mov [ebp+var_8], 0 ; ä¸€ä¸ªå˜é‡åˆå§‹åŒ–ä¸º0.text:00464111 mov [ebp+var_2C], 0Ah ; å¦ä¸€ä¸ªå˜é‡åˆå§‹åŒ–ä¸º10.text:00464118.text:00464118 loc_464118: ; CODE XREF: sub_464070+BEâ†“j.text:00464118 mov eax, [ebp+var_8].text:0046411B add eax, [ebp+var_2C] ; eaxè¿‡æ¸¡ï¼ŒæŠŠ[ebp+var_2C]å€¼åŠ åˆ°[ebp+var_8]ä¸Š.text:0046411E mov [ebp+var_8], eax.text:00464121 mov eax, [ebp+var_2C].text:00464124 sub eax, 1 ; eaxè¿‡æ¸¡ï¼Œç»™[ebp+var_2C]å‡1.text:00464127 mov [ebp+var_2C], eax.text:0046412A cmp [ebp+var_2C], 0.text:0046412E jg short loc_464118 ; [ebp+var_2C]å¤§äº0æ—¶å›è·³.text:00464130 mov eax, [ebp+var_8].text:00464133 push eax.text:00464134 push offset aCountD ; &quot;count : %d &quot;.text:00464139 call sub_45DB54 ; printf.text:0046413E add esp, 8 æºç  1234567int count = 0;int i = 10;do { count += i; i--;} while (i &gt; 0);printf(&quot;count : %d &quot;, count);","link":"/2025/07/15/Day6-switch%E8%AF%AD%E5%8F%A5%E8%AF%86%E5%88%AB/"},{"title":"Day7:æ•°ç»„ä¸æŒ‡é’ˆè¯†åˆ«","text":"æ•°ç»„ä¸æŒ‡é’ˆè¯†åˆ« æ•°ç»„ä¸æŒ‡é’ˆè¯†åˆ« æ•´å‹ä¸€ç»´æ•°ç»„ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051.text:00464260 mov [ebp+var_14], 1.text:00464267 mov [ebp+var_10], 2.text:0046426E mov [ebp+var_C], 3.text:00464275 lea eax, [ebp+var_14] ; æ•°ç»„é¦–åœ°å€.text:00464278 push eax ; ä¼ å‚.text:00464279 call sub_45D447.text:0046427E add esp, 4;sub_45D447.text:004640D0 arg_0 = dword ptr 8.text:004640D0.text:004640D0 push ebp.text:004640D1 mov ebp, esp.text:004640D3 sub esp, 0C0h.text:004640D9 push ebx.text:004640DA push esi.text:004640DB push edi.text:004640DC mov edi, ebp.text:004640DE xor ecx, ecx.text:004640E0 mov eax, 0CCCCCCCCh.text:004640E5 rep stosd.text:004640E7 mov ecx, offset unk_54D014.text:004640EC call sub_45FF35.text:004640F1 nop.text:004640F2 mov eax, 4.text:004640F7 shl eax, 1 ; eax=4*2^1=8.text:004640F9 mov ecx, [ebp+arg_0] ; [ebp+arg_0]æ˜¯ä¼ å…¥çš„å‚æ•°ï¼Œå³æ•°ç»„é¦–åœ°å€.text:004640FC mov edx, [ecx+eax] ; [ecx+eax]å³[ebp+arg_0+eax]ï¼Œå³[ebp+10h].text:004640FF push edx.text:00464100 mov eax, 4.text:00464105 shl eax, 0 ; eax=4*2^0=4.text:00464108 mov ecx, [ebp+arg_0].text:0046410B mov edx, [ecx+eax] ; å³[ebp+0Ch].text:0046410E push edx.text:0046410F mov eax, 4.text:00464114 imul ecx, eax, 0 ; ecx=4*0=0.text:00464117 mov edx, [ebp+arg_0].text:0046411A mov eax, [edx+ecx] ; å³[ebp+8]ï¼Œå³[ebp+arg_0]ï¼Œæ•°ç»„é¦–ä½.text:0046411D push eax.text:0046411E push offset aDDD ; &quot;%d %d %d&quot;.text:00464123 call sub_45DB5E ; printf.text:00464128 add esp, 10h.text:0046412B pop edi.text:0046412C pop esi.text:0046412D pop ebx.text:0046412E add esp, 0C0h.text:00464134 cmp ebp, esp.text:00464136 call sub_45F17F.text:0046413B mov esp, ebp.text:0046413D pop ebp.text:0046413E retn æºç  12345678void IntShow(int* n) { printf(&quot;%d %d %d&quot;, n[0], n[1], n[2]);}int main(){ int arr[3] = { 1,2,3 }; IntShow(arr); return 0;} å­—ç¬¦å‹ä¸€ç»´æ•°ç»„ 123456789101112131415161718192021222324252627282930313233343536373839.text:00464281 mov eax, ds:dword_520E60 ; 'lleh'.text:00464286 mov [ebp+var_24], eax ; ç”¨eaxè¿‡æ¸¡ï¼Œä¼ ç»™å±€éƒ¨å˜é‡.text:00464289 mov cx, ds:word_520E64 ; 'o'.text:00464290 mov [ebp+var_20], cx ; ç”¨cxè¿‡æ¸¡ï¼Œä¼ ç»™å±€éƒ¨å˜é‡.text:00464294 lea eax, [ebp+var_24].text:00464297 push eax ; å‰åŠæ®µçš„åœ°å€å…¥æ ˆ.text:00464298 call sub_45E3AB.text:0046429D add esp, 4;sub_45E3AB.text:00463FC0 arg_0 = dword ptr 8.text:00463FC0.text:00463FC0 push ebp.text:00463FC1 mov ebp, esp.text:00463FC3 sub esp, 0C0h.text:00463FC9 push ebx.text:00463FCA push esi.text:00463FCB push edi.text:00463FCC mov edi, ebp.text:00463FCE xor ecx, ecx.text:00463FD0 mov eax, 0CCCCCCCCh.text:00463FD5 rep stosd.text:00463FD7 mov ecx, offset unk_54D014.text:00463FDC call sub_45FF35.text:00463FE1 nop.text:00463FE2 mov eax, [ebp+arg_0] ; å‚æ•°ä¼ ç»™eax.text:00463FE5 push eax.text:00463FE6 push offset aS ; &quot;%s&quot;.text:00463FEB call sub_45DB5E ; printf.text:00463FF0 add esp, 8.text:00463FF3 pop edi.text:00463FF4 pop esi.text:00463FF5 pop ebx.text:00463FF6 add esp, 0C0h.text:00463FFC cmp ebp, esp.text:00463FFE call sub_45F17F.text:00464003 mov esp, ebp.text:00464005 pop ebp.text:00464006 retn æºç  12345678void CharShow(char* n) { printf(&quot;%s&quot;, n);}int main(){ char buf[] = { &quot;hello&quot; }; CharShow(buf); return 0;} æ•°ç»„ä½œä¸ºè¿”å›å€¼ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657.text:004642C3 call sub_45FC79.text:004642C8 mov [ebp+var_40], eax ; ä»è¿”å›å€¼ä¸­å–å‡ºä¼ åˆ°å±€éƒ¨å˜é‡.text:004642CB mov eax, [ebp+var_40] ; æ”¾å…¥å¯„å­˜å™¨ä¸­pushä½œä¸ºå‚æ•°.text:004642CE push eax.text:004642CF push offset aS ; &quot;%s&quot;.text:004642D4 call sub_45DB59 ; printf.text:004642D9 add esp, 8;sub_45FC79.text:00464020 var_14 = byte ptr -14h.text:00464020 var_10 = dword ptr -10h.text:00464020 var_C = word ptr -0Ch.text:00464020 var_A = byte ptr -0Ah.text:00464020 var_4 = dword ptr -4.text:00464020.text:00464020 push ebp.text:00464021 mov ebp, esp.text:00464023 sub esp, 0D4h.text:00464029 push ebx.text:0046402A push esi.text:0046402B push edi.text:0046402C lea edi, [ebp+var_14].text:0046402F mov ecx, 5.text:00464034 mov eax, 0CCCCCCCCh.text:00464039 rep stosd.text:0046403B mov eax, ___security_cookie.text:00464040 xor eax, ebp.text:00464042 mov [ebp+var_4], eax.text:00464045 mov ecx, offset unk_54E014.text:0046404A call sub_45FF35.text:0046404F nop.text:00464050 mov eax, ds:dword_521E60 ; 'oviv'.text:00464055 mov [ebp+var_10], eax ; eaxè¿‡æ¸¡ï¼Œä¼ ç»™å±€éƒ¨å˜é‡.text:00464058 mov cx, ds:word_521E64 ; '05'.text:0046405F mov [ebp+var_C], cx ; cxè¿‡æ¸¡ï¼Œä¼ ç»™å±€éƒ¨å˜é‡.text:00464063 mov dl, ds:byte_521E66.text:00464069 mov [ebp+var_A], dl.text:0046406C lea eax, [ebp+var_10] ; å‰åŠæ®µç»™eaxï¼Œä½œä¸ºè¿”å›å€¼ä¼ é€’.text:0046406F push edx.text:00464070 mov ecx, ebp.text:00464072 push eax.text:00464073 lea edx, dword_4640A0.text:00464079 call sub_45EC52.text:0046407E pop eax.text:0046407F pop edx.text:00464080 pop edi.text:00464081 pop esi.text:00464082 pop ebx.text:00464083 mov ecx, [ebp+var_4].text:00464086 xor ecx, ebp ; StackCookie.text:00464088 call j_@__security_check_cookie@4 ; __security_check_cookie(x).text:0046408D add esp, 0D4h.text:00464093 cmp ebp, esp.text:00464095 call sub_45F17A.text:0046409A mov esp, ebp.text:0046409C pop ebp.text:0046409D retn æºç  123456789char* CrZT() { char temp[7] = &quot;vivo50&quot;; return temp;}int main(){ char* p = CrZT(); printf(&quot;%s&quot;, p); return 0;} æ•´å½¢äºŒç»´æ•°ç»„ï¼ˆå’Œä¸€ç»´æ•°ç»„æ²¡æœ‰æœ¬è´¨ä¸Šçš„åŒºåˆ«ï¼Œéƒ½æ˜¯å ç”¨ä¸€æ®µè¿ç»­çš„å†…å­˜ç©ºé—´ï¼‰ 1234567891011121314151617181920212223242526272829303132333435.text:004642DC mov [ebp+var_58], 1.text:004642E3 mov [ebp+var_54], 2.text:004642EA mov [ebp+var_50], 3.text:004642F1 mov [ebp+var_4C], 4.text:004642F8 mov eax, 8.text:004642FD shl eax, 0 ; eax=8*2^0=8.text:00464300 lea ecx, [ebp+eax+var_58] ; å³[ebp+var_58+8]ï¼Œå³[ebp+var_50].text:00464304 mov edx, 4.text:00464309 shl edx, 0 ; edx=4*2^0=4.text:0046430C mov eax, [ecx+edx] ; å³[ebp+var_58+0Ch]ï¼Œå³[ebp+var_4C].text:0046430F push eax.text:00464310 mov ecx, 8.text:00464315 shl ecx, 0 ; ecx=8*2^0=8.text:00464318 lea edx, [ebp+ecx+var_58] ; å³[ebp+var_58+8]ï¼Œå³[ebp+var_50].text:0046431C mov eax, 4.text:00464321 imul ecx, eax, 0 ; ecx=0.text:00464324 mov edx, [edx+ecx] ; å³[ebp+var_50].text:00464327 push edx.text:00464328 mov eax, 8.text:0046432D imul ecx, eax, 0 ; ecx=8*0=0.text:00464330 lea edx, [ebp+ecx+var_58] ; å³[ebp+var_58].text:00464334 mov eax, 4.text:00464339 shl eax, 0 ; eax=4*2^0=4.text:0046433C mov ecx, [edx+eax] ; å³[ebp+var_54].text:0046433F push ecx.text:00464340 mov edx, 8.text:00464345 imul eax, edx, 0 ; eax=8*0=0.text:00464348 lea ecx, [ebp+eax+var_58] ; å³[ebp+var_58].text:0046434C mov edx, 4.text:00464351 imul eax, edx, 0 ; ecx=4*0=0.text:00464354 mov ecx, [ecx+eax] ; å³[ebp+var_58].text:00464357 push ecx.text:00464358 push offset aDDDD ; &quot;%d,%d,%d,%d&quot;.text:0046435D call sub_45DB59 ; printf.text:00464362 add esp, 14h æºç  12int num[2][2] = { {1,2},{3,4} };printf(&quot;%d,%d,%d,%d&quot;, num[0][0], num[0][1], num[1][0], num[1][1]);","link":"/2025/07/17/Day7-%E6%95%B0%E7%BB%84%E4%B8%8E%E6%8C%87%E9%92%88%E8%AF%86%E5%88%AB/"},{"title":"Day8:thiscallã€ç±»","text":"thiscallã€ç±» è°ƒç”¨çº¦å®šï¼šthiscall å¯¹äºC++thisæŒ‡é’ˆçš„ç‰¹æ€§ï¼Œæœ‰ä¸€ç§ä¸“é—¨çš„è°ƒç”¨çº¦å®šå«thiscallï¼Œä¸»è¦ç”¨äºç±»å‡ºç°çš„åœºæ™¯ æ— è®ºx86/x64ï¼ŒthisæŒ‡é’ˆå‡ç”±ecx/rcxæ‰®æ¼”ï¼ŒæŒ‡å‘å¯¹è±¡çš„å†…å­˜åœ°å€ thiscallç”±è¢«è°ƒç”¨è€…æ¸…ç†å‚æ•°å ç”¨çš„æ ˆç©ºé—´ ç±»ï¼ˆä¸€ï¼‰ ç®€å•çš„æ„é€ ææ„åˆ†æ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130;mainå‡½æ•°.text:004641E0 var_EC = dword ptr -0ECh.text:004641E0 var_30 = byte ptr -30h.text:004641E0 var_20 = dword ptr -20h.text:004641E0 var_4 = dword ptr -4.text:004641E0.text:004641E0 push ebp.text:004641E1 mov ebp, esp.text:004641E3 sub esp, 0F0h.text:004641E9 push ebx.text:004641EA push esi.text:004641EB push edi.text:004641EC lea edi, [ebp+var_30].text:004641EF mov ecx, 0Ch.text:004641F4 mov eax, 0CCCCCCCCh.text:004641F9 rep stosd.text:004641FB mov eax, ___security_cookie.text:00464200 xor eax, ebp.text:00464202 mov [ebp+var_4], eax.text:00464205 mov ecx, offset unk_54D014.text:0046420A call sub_45FF30.text:0046420F nop.text:00464210 push offset aXiaoming ; å‚æ•°&quot;xiaoming&quot;.text:00464215 push 1 ; å¦ä¸€ä¸ªå‚æ•°.text:00464217 lea ecx, [ebp+var_20] ; [ebp+var_20]æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒthisæŒ‡é’ˆæŒ‡å‘è¯¥å¯¹è±¡.text:0046421A call sub_46062E ; æ„é€ å‡½æ•°.text:0046421F nop.text:00464220 push offset aPause ; &quot;pause&quot;.text:00464225 call sub_45F98B ; system.text:0046422A add esp, 4.text:0046422D mov [ebp+var_EC], 0.text:00464237 lea ecx, [ebp+var_20] ; thisæŒ‡é’ˆ.text:0046423A call sub_45D38E ; ææ„å‡½æ•°.text:0046423F mov eax, [ebp+var_EC].text:00464245 push edx.text:00464246 mov ecx, ebp.text:00464248 push eax.text:00464249 lea edx, dword_464274.text:0046424F call sub_45EC4D.text:00464254 pop eax.text:00464255 pop edx.text:00464256 pop edi.text:00464257 pop esi.text:00464258 pop ebx.text:00464259 mov ecx, [ebp+var_4].text:0046425C xor ecx, ebp ; StackCookie.text:0046425E call j_@__security_check_cookie@4 ; __security_check_cookie(x).text:00464263 add esp, 0F0h.text:00464269 cmp ebp, esp.text:0046426B call sub_45F175.text:00464270 mov esp, ebp.text:00464272 pop ebp.text:00464273 retn;æ„é€ å‡½æ•°.text:00463FC0 var_C = byte ptr -0Ch.text:00463FC0 var_8 = dword ptr -8.text:00463FC0 arg_0 = dword ptr 8.text:00463FC0 arg_4 = dword ptr 0Ch.text:00463FC0.text:00463FC0 push ebp.text:00463FC1 mov ebp, esp.text:00463FC3 sub esp, 0CCh.text:00463FC9 push ebx.text:00463FCA push esi.text:00463FCB push edi.text:00463FCC push ecx.text:00463FCD lea edi, [ebp+var_C].text:00463FD0 mov ecx, 3.text:00463FD5 mov eax, 0CCCCCCCCh.text:00463FDA rep stosd.text:00463FDC pop ecx.text:00463FDD mov [ebp+var_8], ecx ; å½“å‰å¯¹è±¡åœ°å€ä¿å­˜åˆ°[ebp+var_8].text:00463FE0 mov ecx, offset unk_54D014.text:00463FE5 call sub_45FF30.text:00463FEA nop.text:00463FEB mov eax, [ebp+var_8] ; ç¬¬ä¸€ä¸ªå¯¹è±¡æˆå‘˜.text:00463FEE mov ecx, [ebp+arg_0] ; ç¬¬ä¸€ä¸ªå‚æ•°1.text:00463FF1 mov [eax], ecx.text:00463FF3 push 4.text:00463FF5 mov eax, [ebp+arg_4] ; ç¬¬äºŒä¸ªå‚æ•°&quot;xiaoming&quot;.text:00463FF8 push eax.text:00463FF9 mov ecx, [ebp+var_8].text:00463FFC add ecx, 4 ; ç¬¬äºŒä¸ªå¯¹è±¡æˆå‘˜.text:00463FFF push ecx.text:00464000 call sub_45FCF1 ; memcpy().text:00464005 add esp, 0Ch.text:00464008 mov eax, [ebp+var_8] ; è¿”å›çš„æ˜¯å¯¹è±¡åœ°å€.text:0046400B pop edi.text:0046400C pop esi.text:0046400D pop ebx.text:0046400E add esp, 0CCh.text:00464014 cmp ebp, esp.text:00464016 call sub_45F175.text:0046401B mov esp, ebp.text:0046401D pop ebp.text:0046401E retn 8;ææ„å‡½æ•°.text:00464040 var_C = byte ptr -0Ch.text:00464040 var_8 = dword ptr -8.text:00464040.text:00464040 push ebp.text:00464041 mov ebp, esp.text:00464043 sub esp, 0CCh.text:00464049 push ebx.text:0046404A push esi.text:0046404B push edi.text:0046404C push ecx.text:0046404D lea edi, [ebp+var_C].text:00464050 mov ecx, 3.text:00464055 mov eax, 0CCCCCCCCh.text:0046405A rep stosd.text:0046405C pop ecx.text:0046405D mov [ebp+var_8], ecx ; æŠŠå¯¹è±¡åœ°å€å­˜åˆ°[ebp+var_8].text:00464060 mov ecx, offset unk_54D014.text:00464065 call sub_45FF30.text:0046406A nop.text:0046406B push offset aDestructing ; &quot;destructing......&quot;.text:00464070 call sub_45DB59 ; printf.text:00464075 add esp, 4.text:00464078 pop edi.text:00464079 pop esi.text:0046407A pop ebx.text:0046407B add esp, 0CCh.text:00464081 cmp ebp, esp.text:00464083 call sub_45F175.text:00464088 mov esp, ebp.text:0046408A pop ebp.text:0046408B retn æºç  12345678910111213141516171819202122232425#include&lt;stdio.h&gt;#include&lt;stdlib.h&gt;#include&lt;string.h&gt;class Student {private: int ID; char name[20];public: Student(int n = 0, const char* na = &quot;NONE&quot;) :ID(n) { memcpy(name, na, sizeof(na)); } void show(); ~Student();};void Student::show() { printf(&quot;%d %s\\n&quot;, ID, name);}Student::~Student() { printf(&quot;destructing......&quot;);}int main() { Student stu(001, &quot;xiaoming&quot;); system(&quot;pause&quot;); return 0;}","link":"/2025/07/21/Day8-%E7%B1%BB/"},{"title":"Day9:å£³ä¸è„±å£³ï¼ˆä¸€ï¼‰","text":"å£³ã€å£³çš„åŠ è½½è¿‡ç¨‹ã€å·¥å…·è„±å£³ã€æ‰‹åŠ¨è„±å£³æµç¨‹ã€espå®šå¾‹ï¼ˆåŸºäºXdbgï¼‰ å£³ å…ˆçœ‹ctf-wikiå¯¹å£³çš„ä»‹ç»ï¼š å£³ æ˜¯åœ¨ä¸€äº›è®¡ç®—æœºè½¯ä»¶é‡Œä¸€æ®µä¸“é—¨è´Ÿè´£ä¿æŠ¤è½¯ä»¶ä¸è¢«éæ³•ä¿®æ”¹æˆ–åç¼–è¯‘çš„ç¨‹åºã€‚ å®ƒä»¬ä¸€èˆ¬éƒ½æ˜¯å…ˆäºç¨‹åºè¿è¡Œï¼Œæ‹¿åˆ°æ§åˆ¶æƒï¼Œç„¶åå®Œæˆå®ƒä»¬ä¿æŠ¤è½¯ä»¶çš„ä»»åŠ¡ã€‚ å› æ­¤ï¼ŒåŠ å£³ç¨‹åºåŒ…å«å£³ç¨‹åºå’ŒåŸç¨‹åºä¸¤ä¸ªéƒ¨åˆ†ï¼Œä¸”åŸç¨‹åºåœ¨å£³ç¨‹åºè¿è¡Œåæ‰æ¢å¤åˆ°ç‹¬ç«‹å¯æ‰§è¡Œçš„çŠ¶æ€ã€‚å› æ­¤ï¼Œå¯ä»¥å€ŸåŠ©åŠ¨æ€è°ƒè¯•å™¨åœ¨å£³ç¨‹åºè¿è¡Œå®Œåè¿›è¡Œdumpï¼Œä»è€Œè·å¾—ç‹¬ç«‹å¯æ‰§è¡Œçš„åŸç¨‹åº å¸¸è§çš„å£³æœ‰å‹ç¼©å£³å’ŒåŠ å¯†å£³ä¸¤ç§ï¼š å‹ç¼©å£³ï¼šupxã€ASpackã€PECompatç­‰ åŠ å¯†å£³ï¼šVMProtectã€Themidaã€ASProtectorç­‰ å£³çš„åŠ è½½è¿‡ç¨‹ å£³å’ŒåŸç¨‹åºåœ¨é€»è¾‘ä¸ŠåŸºæœ¬æ²¡æœ‰å…³è”ï¼Œå› æ­¤ï¼Œå£³ç¨‹åºåœ¨è§£æåŠ å£³åçš„äºŒè¿›åˆ¶æ–‡ä»¶å‰ï¼Œä¼šå…ˆä¿å­˜å„å¯„å­˜å™¨çš„å€¼ï¼Œé€šå¸¸ç”¨pushad/puahfdå®ç° è§£æå®Œæˆåï¼Œæ˜¯åŸç¨‹åºçš„é€»è¾‘éƒ¨åˆ†ï¼Œæ­¤æ—¶ï¼Œå£³ç¨‹åºç»™å‡ºæ§åˆ¶æƒï¼Œå¯„å­˜å™¨æ¢å¤åˆ°è§£æå‰çš„çŠ¶æ€ï¼Œé€šå¸¸ç”¨popad/popfdå®ç° æœ€åï¼Œç¨‹åºè·³åˆ°åŸç¨‹åºå…¥å£ç‚¹å¼€å§‹æ‰§è¡Œ å·¥å…·è„±å£³ ç›´æ¥ä½¿ç”¨å·¥å…·è„±å£³çš„æƒ…å†µä¸»è¦æœ‰ä¸¤ç§ï¼šä¸€ç§æ˜¯æ— ä¿®æ”¹çš„ã€åªä½¿ç”¨åŠ å£³ç¨‹åºåŠ å£³ï¼›å¦ä¸€ç§æ˜¯ä½¿ç”¨åŠ å£³ç¨‹åºåŠ å£³åä¿®æ”¹äº†åŒºå—åçš„ã€‚å‰è€…å¯ä»¥ç›´æ¥ä½¿ç”¨åŠ å£³ç¨‹åºè„±å£³ï¼ˆå¦‚æœå…·å¤‡è„±å£³åŠŸèƒ½çš„è¯ï¼‰ï¼Œåè€…å…ˆä¿®æ”¹åŒºå—åå†ä½¿ç”¨åŠ å£³ç¨‹åºè„±å£³ã€‚ upxæ— ä¿®æ”¹åŠ å£³ç¤ºä¾‹ï¼š æ‹¿åˆ°å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå…ˆåˆ°DIEæŸ¥çœ‹ï¼Œå‘ç°æœ‰å£³ã€‚å¯¹å£³çš„ä¿¡æ¯æè¿°æ²¡æœ‰å‡ºç°â€œmodifiedâ€å­—çœ¼ï¼Œå› æ­¤åˆ¤æ–­æ˜¯æ— ä¿®æ”¹åŠ å£³ï¼Œç›´æ¥ä½¿ç”¨å·¥å…·è„±å£³ ç›´æ¥ä½¿ç”¨upx -dè„±å£³ å†æ¬¡ç”¨DIEæ‰“å¼€ï¼Œå‘ç°æ²¡æœ‰è¯†åˆ«å‡ºå£³äº† upxä¿®æ”¹åŒºå—ååŠ å£³ç¤ºä¾‹ï¼š å…ˆåˆ°DIEæŸ¥çœ‹å£³ä¿¡æ¯ï¼Œå‘ç°æ˜¯upx modified ç‚¹å‡»â€œåŒºå—â€œä¸‹æ–¹çš„â€&gt;â€œæŸ¥çœ‹åŒºå—ä¿¡æ¯ï¼Œå‘ç°åŒºå—åæœ‰æ”¹åŠ¨ 010editorä¿®æ”¹åŒºå—å å†æ¬¡æŸ¥çœ‹å£³ä¿¡æ¯ï¼Œå˜æˆæ— ä¿®æ”¹åŠ å£³äº†ï¼Œç›´æ¥å·¥å…·è„±å£³ æ‰‹åŠ¨è„±å£³æµç¨‹ æ­¥éª¤ï¼š æŸ¥å£³ï¼šä½¿ç”¨DIEã€ExeinfoPEã€PEiDç­‰å·¥å…·æŸ¥å£³ å¯»æ‰¾ç¨‹åºåŸå…¥å£ç‚¹(OEP)ï¼šé€šè¿‡å„ç§æ–¹æ³•æ‰¾åˆ°å£³ä»£ç ç»“æŸã€ç¨‹åºçœŸæ­£å¼€å§‹çš„åœ°æ–¹ dumpå†…å­˜ï¼šå€ŸåŠ©æ’ä»¶ä»OEPå¼€å§‹dumpå‡ºåŸç¨‹åº è¾“å…¥è¡¨(IAT)é‡å»ºï¼šå€ŸåŠ©æ’ä»¶é‡å»ºè¾“å…¥è¡¨ å…³é—­ç¨‹åºé‡å®šä½ï¼šä½¿ç”¨DIEç­‰å·¥å…·å…³é—­ç¨‹åºé‡å®šä½ å¯»æ‰¾OEPçš„æ–¹æ³•æœ‰å¾ˆå¤šï¼Œè€Œdumpå’ŒIATé‡å»ºä»¥åŠå…³é—­é‡å®šä½çš„æ–¹æ³•åŸºæœ¬å›ºå®šã€‚å…ˆç”¨ä¸€ä¸ªä¾‹å­å±•ç¤ºæ•´ä½“æµç¨‹ï¼Œå†è¯¦ç»†å±•å¼€å¯»æ‰¾OEPçš„æ–¹æ³•ã€‚upxæ‰‹åŠ¨è„±å£³ç¤ºä¾‹ï¼š æŸ¥å£³ï¼šæ˜¾ç¤ºæ˜¯upx å¯»æ‰¾OEPï¼š é‡‡ç”¨espå®šå¾‹æ³•ï¼ˆè¯¦è§ä¸‹æ–‡ï¼‰æ‰¾åˆ°push ebpå¼€å¤´çš„ä¸€æ®µä»£ç  dumpå†…å­˜ï¼š æ‰“å¼€æ’ä»¶scyllaï¼Œç‚¹å‡»â€œè½¬å‚¨â€æ ä¸­çš„â€œè½¬å‚¨â€ï¼Œä¼šè·å¾—ä¸€ä¸ª_dumpåç¼€çš„exeæ–‡ä»¶ IATé‡å»ºï¼š ç‚¹å‡»â€œIATè‡ªåŠ¨æœç´¢â€ï¼Œä¼šæœ‰å¼¹çª—é—®æ˜¯å¦ä½¿ç”¨é«˜çº§æœç´¢ç»“æœï¼Œç‚¹â€œæ˜¯â€ã€‚è¿™æ—¶å€™ï¼ŒVAå’Œâ€œå¤§å°â€ä¸¤ä¸ªæ¡†ä¼šè¢«å¡«å……ã€‚ æ¥ä¸‹æ¥ç‚¹â€œè·å–å¯¼å…¥â€ï¼Œä¸Šæ–¹çš„å¤§æ¡†ä¸­ä¼šå‡ºç°dllç»“å°¾çš„ä¸œè¥¿ï¼Œéœ€è¦æŠŠå¸¦çº¢è‰²Xçš„å–æ¶ˆå‹¾é€‰ ç„¶åç‚¹å‡»ä¿®å¤è½¬å‚¨ï¼Œé€‰æ‹©åˆšåˆšdumpå‡ºæ¥çš„æ–‡ä»¶ï¼Œä¼šå¾—åˆ°ä¸€ä¸ªå†åŠ ä¸Š_SCYçš„exeæ–‡ä»¶ã€‚ æ­¤æ—¶ç¨‹åºå¤§æ¦‚ç‡è¿è¡Œä¸äº†ï¼Œä¼šé—ªé€€ã€‚ä½†æ˜¯å¯¹äºé™æ€åˆ†ææ¥è¯´ï¼Œåˆ°è¿™ä¸€æ­¥å·²ç»è¶³å¤Ÿäº†ã€‚ å…³é—­é‡å®šä½ï¼šæŠŠå¾—åˆ°çš„_dump_SCY.exeæ–‡ä»¶æ‹–åˆ°DIEï¼Œç‚¹å‡»â€œåŒºå—â€æ çš„â€œ&gt;â€ï¼Œä¼šå¼¹å‡ºæ–‡ä»¶ç»“æ„ç•Œé¢ å…ˆå–æ¶ˆå‹¾é€‰å³ä¸Šè§’çš„â€œåªè¯»â€ ç‚¹å‡»IMAGE_NT_HEADERSä¸‹çš„IMAGE_FILE_HEADERï¼Œåœ¨â€œæ ‡å¿—â€é€‰é¡¹ä¸­å‹¾é€‰â€œRELOCS_STRIPPEDâ€ï¼ˆå›¾ä¸­æœªå‹¾é€‰ï¼‰ å†ç‚¹å‡»IMAGE_OPTIONAL_HEADERSï¼Œæ‰¾åˆ°å¦ä¸€ä¸ªæ ‡å¿—(DllCharacteristics)ï¼Œå–æ¶ˆå‹¾é€‰â€œDYNAMIC_BASEâ€ï¼ˆå›¾ä¸­æœªå–æ¶ˆï¼‰ è¿™æ ·å­ï¼Œæˆ‘ä»¬çš„ç¨‹åºå°±è„±å®Œå£³å¹¶ä¸”å¯ä»¥æ­£å¸¸è¿è¡Œäº† PSï¼šå…³äºIATé‡å»ºè¿™ä¸€æ­¥éª¤ï¼Œä¸ºä»€ä¹ˆä¸èƒ½IATè‡ªåŠ¨æœç´¢å†è½¬å‚¨ä¸€æ­¥åˆ°ä½ï¼Ÿ ç»“åˆAIçš„è§£é‡Šï¼Œä¸ªäººè§è§£æ˜¯IATè‡ªåŠ¨æœç´¢çš„è¿‡ç¨‹å¯èƒ½ä¼šè¿è¡Œç¨‹åºï¼Œå¯¼è‡´åœ°å€åˆ·æ–°ï¼ŒOEPå¤±æ•ˆï¼Œdumpå‡ºæ¥çš„ç¨‹åºä¸å®Œæ•´æˆ–è€…ä¸å¯¹ã€‚å› æ­¤ï¼Œdumpå’ŒIATé‡å»ºå®é™…ä¸Šæ˜¯ä¸¤ä¸ªæ­¥éª¤ï¼Œä¸è¿‡è¢«é›†æˆåˆ°äº†ä¸€ä¸ªç•Œé¢ã€‚å…¶å®è¿˜æœ‰æ‰‹åŠ¨é‡å»ºIATçš„æ–¹æ³•ï¼Œè¿™ç§æƒ…å†µä¸‹å°±ç¡®ç¡®å®å®éœ€è¦å…ˆdumpå†å¯¼å…¥é‡å»ºçš„IATäº†ï¼Œå› ä¸ºåœ¨è°ƒè¯•å™¨ä¸­æ‰¾åˆ°OEPåè¿˜è¦ç»§ç»­æ‰¾IAT å¯»æ‰¾OEPçš„æ–¹æ³•ï¼ˆä¸€ï¼‰ESPå®šå¾‹ å‰æ–‡ï¼Œæˆ‘ä»¬çŸ¥é“äº†å£³ç¨‹åºè§£ææ—¶ä¼šæœ‰pushad\\popadæˆ–è€…pushfd\\popfdçš„æ“ä½œã€‚pushadæ—¶ï¼Œéšç€é€šç”¨å¯„å­˜å™¨å€¼çš„å…¥æ ˆï¼Œespçš„å€¼ä¼šå‘ç”Ÿå˜åŒ–ï¼Œåˆå› ä¸ºæ ˆå¹³è¡¡çš„ç‰¹æ€§ï¼Œæœ€ç»ˆespçš„å€¼ä¼šå›åˆ°pushadåçš„è¿™ä¸ªå€¼ã€‚å› æ­¤ï¼Œå¯ä»¥å€ŸåŠ©è¿™ä¸€ç‚¹ï¼Œç»™pushadåçš„espå€¼ä¸‹ç¡¬ä»¶è®¿é—®æ–­ç‚¹ï¼Œpopadåå°±ä¼šè§¦å‘æ–­ç‚¹ï¼Œä¸­æ–­è°ƒè¯•ï¼Œè¿›è€Œå®ç°è·³è¿‡æ•´ä¸ªå£³è§£æè¿‡ç¨‹ã€‚å½“ç„¶ï¼Œä¸­æ–­å¤„è¿˜ä¸æ˜¯OEPï¼Œä¸€èˆ¬åœ¨ä¸­æ–­å¤„åä¼šæœ‰ä¸€ä¸ªè·¨åº¦æ˜æ˜¾çš„jmpï¼Œç”šè‡³jmpåè¿˜æœ‰ä¸€ä¸ªè·³è½¬è¡¨jmpæ‰ä¼šåˆ°è¾¾çœŸæ­£çš„OEP å…·ä½“æ“ä½œå¦‚ä¸‹ï¼š xdbgæ‰“å¼€ï¼ŒF9åˆ°ç¨‹åºæ‰€åœ¨å†…å­˜åŒºåŸŸ å¯ä»¥çœ‹åˆ°EIPæ‰€åœ¨å°±æ˜¯pushad F8æ­¥è¿‡ï¼Œespæ›´æ–° åœ¨å³ä¸‹è§’æ ˆçª—å£è®¾ä¸Šç¡¬ä»¶è®¿é—®æ–­ç‚¹ ç‚¹å‡»å·¥å…·æ â€œè§†å›¾â€ä¸‹æ–¹çš„â€œ-&gt;â€ï¼Œç¨‹åºä¼šæ‰§è¡Œè¿‡popadã€‚å¯ä»¥çœ‹åˆ°ä¸‹æ–¹ä¸è¿œå¤„æœ‰ä¸ªå¤§è·³ F8åˆ°å¤§è·³å¤„F7æ­¥å…¥ï¼Œæœ‰è·³è½¬è¡¨ç»§ç»­F7æ­¥å…¥ï¼Œå¯ä»¥çœ‹åˆ°å¼€è¾Ÿæ ˆå¸§æ“ä½œï¼Œè¿™é‡Œå°±æ˜¯OEPäº†ï¼Œåœ¨æ­¤å¤„ç›´æ¥ä½¿ç”¨scylla dumpå‡ºç¨‹åº å•æ­¥è·Ÿè¸ªæ³• å¦‚åï¼Œå°±æ˜¯ä¸€ç›´æŒ‰F8ï¼Œè®©ç¨‹åºå°½é‡å‘ä¸‹èµ°ï¼Œé‡åˆ°å¾ªç¯å°±è·³è¿‡ï¼Œé‡åˆ°è¿‘callå°±æ­¥å…¥ï¼Œé‡ç‚¹å…³æ³¨å¤§è·³ å‚è€ƒctf-wiki https://ctf-wiki.org/reverse/platform/windows/unpack/trace/","link":"/2025/07/29/Day9-%E5%A3%B3%E4%B8%8E%E8%84%B1%E5%A3%B3%EF%BC%88%E4%B8%80%EF%BC%89/"},{"title":"Re:ä»0åˆ°1çš„è„šæœ¬ä¹‹è·¯","text":"pythonè„šæœ¬åšé¢˜è®°å½• [SWPUCTF 2021 æ–°ç”Ÿèµ›]fakebase12345678910111213141516#ç»™çš„ä»£ç å¦‚ä¸‹ï¼šflag = 'xxxxxxxxxxxxxxxxxxx's_box = 'qwertyuiopasdfghjkzxcvb123456#$'tmp = ''for i in flag: tmp += str(bin(ord(i)))[2:].zfill(8)b1 = int(tmp,2)s = ''while b1//31 != 0: s += s_box[b1%31] b1 = b1//31print(s)# s = u#k4ggia61egegzjuqz12jhfspfkay ä»£ç ä¸­ï¼ŒæŠŠflagé€å­—ç¬¦è½¬åŒ–ä¸ºäºŒè¿›åˆ¶ï¼Œæˆªæ‰å‰ç¼€ï¼Œå¡«å……ä¸º8ä½ï¼Œå†æ‹¼æ¥è¿™äº›äºŒè¿›åˆ¶æ•°å¾—åˆ°tmp ç„¶åæŠŠtmpè½¬åŒ–ä¸ºåè¿›åˆ¶b1ï¼Œä¸æ–­é™¤31ï¼ŒåŒæ—¶ç”¨ä½™æ•°åšS_boxç´¢å¼•ï¼ŒæŠŠç´¢å¼•å€¼æ‹¼æ¥å¾—åˆ°S æ‰€ä»¥ï¼Œè§£å¯†æ€è·¯æ˜¯ï¼Œé¦–å…ˆï¼Œè¿˜åŸb1ï¼š b1åˆ©ç”¨åå¾—åˆ°ä¸€ç³»åˆ—ç´¢å¼•å€¼ï¼Œæ‰€ä»¥ç”±ç´¢å¼•å€¼åæ¨b1 é€†åºså¯¹ç…§s_boxå¾—å‡ºç´¢å¼•ï¼ˆä¸ºäº†ä»æœ€åä¸€ä¸ªä½™æ•°å¼€å§‹è¿˜åŸb1ï¼‰å¹¶ç»„æˆä¸€ä¸ªåˆ—è¡¨ã€‚å› ä¸ºå¾ªç¯ç»ˆæ­¢æ¡ä»¶æ˜¯b1//31==0ï¼Œæ‰€ä»¥æœ€åä¸€æ¬¡é™¤åªåˆ©ç”¨äº†å•†ç­‰äº0ï¼Œè€Œä½™æ•°æœªçŸ¥ï¼Œäºæ˜¯ä»0-30å‡è®¾è¢«å¼ƒæ‰çš„ä½™æ•°ï¼Œæšä¸¾å„ç§å¯èƒ½ã€‚ è€Œå¦‚ä½•åˆ¤æ–­å“ªç§å¯èƒ½æ˜¯æˆ‘ä»¬éœ€è¦çš„å‘¢ï¼Ÿå°±éœ€è¦è¿˜åŸå‡ºflagå¹¶åˆ¤æ–­ã€‚æŠŠè¿˜åŸå‡ºæ¥çš„b1è½¬äºŒè¿›åˆ¶ï¼Œå»æ‰å‰ç¼€ï¼Œå¡«å……åˆ°8çš„å€æ•°æ–¹ä¾¿æˆªå–äºŒè¿›åˆ¶æ•°ï¼Œç„¶å8ä¸ª8ä¸ªè¿˜åŸå‡ºå­—ç¬¦ï¼Œæœ€ååˆ¤æ–­æ˜¯ä¸æ˜¯flagå°±è¡Œäº†ã€‚ EXPï¼š 1234567891011121314151617181920212223242526buf=&quot;u#k4ggia61egegzjuqz12jhfspfkay&quot;s_box = 'qwertyuiopasdfghjkzxcvb123456#$'index_list=[]#æ±‚ç´¢å¼•å€¼åˆ—è¡¨for i in buf[::-1]: for j in range(len(s_box)): if i == s_box[j]: index_list.append(j)#print(index_list)#æšä¸¾è¾¾åˆ°ç»ˆæ­¢æ¡ä»¶æ—¶çš„ä½™æ•°for i in range(31): #å¼€å§‹è¿˜åŸb1 b1=i for j in range(len(buf)): b1=b1*31+index_list[j]#ä¸æ–­åŠ ä½™æ•°ï¼Œä¹˜31 tmp=str(bin(b1)[2:])#åŠ å¯†æµç¨‹æ˜¯æŠŠtmpä»2è¿›åˆ¶è½¬10è¿›åˆ¶ï¼Œè¿™é‡Œå°±åç€æ¥ï¼ŒæŠŠb1ä»10è¿›åˆ¶è½¬2è¿›åˆ¶ï¼Œæˆªå»å‰ç¼€ tmp=tmp.zfill((len(tmp)//8+1)*8)#åŠ å¯†æ—¶å­—ç¬¦è½¬æˆ8ä½2è¿›åˆ¶æ•°ï¼Œåç€æ¥å°±æ˜¯æŠŠ8ä½2è¿›åˆ¶æ•°è½¬ä¸ºå­—ç¬¦ï¼Œæ‰€ä»¥å…ˆæŠŠtmp 8ä½å¯¹é½æ–¹ä¾¿åç»­æˆªå– flag='' for i in range(0,len(tmp),8): flag+=chr(int(tmp[i:i+8],2)) if 'NSSCTF' in flag: print(flag) #flag = &quot;NSSCTF{WHAt_BASe31}&quot; [SWPUCTF 2021 æ–°ç”Ÿèµ›]éå¸¸ç®€å•çš„é€»è¾‘é¢˜ é¢˜ç›®ç»™çš„ä»£ç å¦‚ä¸‹ï¼š 123456789flag = 'xxxxxxxxxxxxxxxxxxxxx's = 'wesyvbniazxchjko1973652048@$+-&amp;*&lt;&gt;'result = ''for i in range(len(flag)): s1 = ord(flag[i])//17 s2 = ord(flag[i])%17 result += s[(s1+i)%34]+s[-(s2+i+1)%34]print(result)# result = 'v0b9n1nkajz@j0c4jjo3oi1h1i937b395i5y5e0e$i' åŠ å¯†æ€è·¯æ˜¯ï¼šé€å­—ç¬¦å–flagï¼Œé€šè¿‡//å’Œ%æ“ä½œå¾—åˆ°ä¸¤ä¸ªå€¼s1å’Œs2ï¼ŒæŠŠè¿™ä¸¤ä¸ªå€¼å¤„ç†åï¼Œä½œä¸ºç´¢å¼•åœ¨sä¸­ç´¢å¼•å‡ºå­—ç¬¦ï¼Œæ‹¼æ¥å¾—åˆ°result é€†ç€æ¥åº”è¯¥æ˜¯æŠŠresulté”™ä½åˆ†å¼€ï¼Œåˆ†æˆå’Œs1æœ‰å…³çš„ä¸å’Œs2æœ‰å…³çš„ï¼Œç„¶åæ±‚å‡ºç´¢å¼•å€¼ï¼Œé€†ä¸¤ä¸ªå–ä½™è¿‡ç¨‹å¾—åˆ°s1å’Œs2ï¼Œå†æŠŠs1å’Œs2è¿ç®—å¾—åˆ°flagå­—ç¬¦ å¾ˆæ˜¾ç„¶ï¼Œè¿™ä¸ªè¿‡ç¨‹ååˆ†å¤æ‚ï¼Œå› ä¸ºæ¶‰åŠå–æ¨¡çš„è¿˜åŸ æ‰€ä»¥è€ƒè™‘é¡ºç€åŠ å¯†çš„æ€è·¯èµ°ï¼Œä»å¸¸è§çš„å­—ç¬¦åè¿›åˆ¶å€¼æšä¸¾ï¼Œé‡åˆ°åŠ å¯†åç»“æœå’Œresultä¸€æ ·çš„å°±æ‹¿æ¥æ‹¼æ¥flag EXP: 123456789101112131415161718192021222324s = 'wesyvbniazxchjko1973652048@$+-&amp;*&lt;&gt;'result = 'v0b9n1nkajz@j0c4jjo3oi1h1i937b395i5y5e0e$i'tmp=''flag=''#æå–å‡ºresulté‡Œå’Œs1ã€s2ç›¸å…³çš„å­—ç¬¦s1_list=[]s2_list=[]for i in range(0,len(result),2): s1_list.append(result[i]) s2_list.append(result[i+1])#å¼€å§‹çˆ†ç ´#å…ˆæ±‚å‡ºåŠ å¯†è¿‡ç¨‹ä¸¤ä¸ªç´¢å¼•å€¼for i in range(len(s1_list)): index1=s.index(s1_list[i]) index2=s.index(s2_list[i]) #ä»¥ç´¢å¼•å€¼ä¸ºåˆ¤æ–­æ¡ä»¶ï¼Œåœ¨å¸¸è§å­—ç¬¦çš„èŒƒå›´å†…é‡ç°åŠ å¯†è¿‡ç¨‹ï¼ŒåŠ å¯†ç»“æœå’Œç´¢å¼•å€¼ä¸€è‡´å³ä¸ºflagçš„å­—ç¬¦ for j in range(33,126): s1=j//17 s2=j%17 if (s1 + i) % 34==index1 and -(s2 + i + 1) % 34==index2: flag+=chr(j) breakprint(flag)#flag = &quot;NSSCTF{Fake_RERE_QAQ}&quot;&quot; [SWPUCTF 2021 æ–°ç”Ÿèµ›]re2 IDAæ‰“å¼€ï¼Œä»£ç å¦‚ä¸‹ï¼š ç®€å•çš„å­—ç¬¦å¤„ç†ï¼Œå…ˆåˆ¤æ–­å­—ç¬¦æ˜¯å¦åœ¨èŒƒå›´å†…ï¼Œç„¶åé‡‡ç”¨ä¸åŒå¤„ç†æ–¹å¼ ç›´æ¥æ­£å‘åˆ©ç”¨ä»£ç ï¼Œçœç‚¹è„‘å­ã€‚ EXP: 12345678910111213alpha='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890{}-_'dic={}str='ylqq]aycqyp{'flag=''for i in alpha: if (ord(i)&lt;=96 or ord(i)&gt;98) and (ord(i)&lt;=64 or ord(i)&gt;66): dic[chr(ord(i)-2)]=i else: dic[chr(ord(i)+24)]=ifor i in str: flag+=dic[i]print(flag)#flag = 'NSSCTF{nss_caesar}' ç›´æ¥å¾—å‡ºæ¥çš„ç»“æœæ˜¯{nss_c{es{r}ï¼Œæ˜¾ç„¶ä¸å¯¹ï¼ŒçŒœæµ‹å¯¹åº”å…³ç³»ä¸å”¯ä¸€ã€‚æ‰“å°å‡ºalphaç»è¿‡å¤„ç†åçš„ç»“æœï¼Œå‘ç°â€™{â€˜å’Œâ€™aâ€™éƒ½å¯¹åº”â€™yâ€™ï¼Œæ‰€ä»¥æŠŠæ˜¾ç„¶ä¸å¯¹åŠ²çš„ä¸¤ä¸ªâ€™ { â€˜æ”¹æˆâ€™ a â€˜ [WUSTCTF 2020]level1 é™„ä»¶ç»™äº†ELFæ–‡ä»¶å’Œä¸€ä¸ªtxtï¼Œåæ±‡ç¼–ä»£ç å¦‚ä¸‹ï¼š é€»è¾‘å°±æ˜¯ä»flagæ–‡ä»¶é‡Œè¯»æ•°æ®ï¼Œç„¶åå­˜åˆ°ptré‡Œã€‚åé¢æ˜¯ç®€å•çš„å¯é€†å¤„ç†ï¼Œä½†æ˜¯è¦æ³¨æ„ptræ˜¯ä»ä¸‹æ ‡1å¼€å§‹ç”¨çš„ã€‚ç»™çš„txtåº”è¯¥å°±æ˜¯å¤„ç†åçš„ç»“æœï¼ŒæŠŠå®ƒè½¬æˆä¸€ä¸ªåˆ—è¡¨ï¼Œç¬¬ä¸€ä½éšä¾¿å¡«ä¸€ä¸ªæ•°ã€‚ç„¶åé€†ã€‚ EXP: 123456789output=[0, 198, 232, 816, 200, 1536, 300, 6144, 984, 51200, 570, 92160, 1200, 565248, 756, 1474560, 800, 6291456, 1782, 65536000]flag=''for i in range(1,len(output)): if (i&amp;1)!=0: flag+=chr(output[i]&gt;&gt;i) else: flag+=chr(output[i]//i)print(flag)#flag = 'NSSCTF{d9-dE6-20c}'ï¼ˆæ”¹äº†å‰ç¼€ï¼‰ [SWPUCTF 2021 æ–°ç”Ÿèµ›]ç®€ç®€å•å•çš„è§£å¯† ç»™çš„pythonä»£ç å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425import base64,urllib.parsekey = &quot;HereIsFlagggg&quot;flag = &quot;xxxxxxxxxxxxxxxxxxx&quot;s_box = list(range(256))j = 0for i in range(256): j = (j + s_box[i] + ord(key[i % len(key)])) % 256 s_box[i], s_box[j] = s_box[j], s_box[i]res = []i = j = 0for s in flag: i = (i + 1) % 256 j = (j + s_box[i]) % 256 s_box[i], s_box[j] = s_box[j], s_box[i] t = (s_box[i] + s_box[j]) % 256 k = s_box[t] res.append(chr(ord(s) ^ k))cipher = &quot;&quot;.join(res)crypt = (str(base64.b64encode(cipher.encode('utf-8')), 'utf-8'))enc = str(base64.b64decode(crypt),'utf-8')enc = urllib.parse.quote(enc)print(enc)# enc = %C2%A6n%C2%87Y%1Ag%3F%C2%A01.%C2%9C%C3%B7%C3%8A%02%C3%80%C2%92W%C3%8C%C3%BA é‡‡ç”¨çš„åŠ å¯†ç®—æ³•æ˜¯æ ‡å‡†RC4ï¼ŒåŠ å¯†ä¸¤éæ¢å¤æ˜æ–‡ã€‚æœ€åé¢çš„è°ƒç”¨baseçš„ä¸¤è¡Œç»è¿‡è°ƒè¯•å‘ç°ç›¸äº’æŠµæ¶ˆï¼Œæ‰€ä»¥æ•´ä¸ªé€»è¾‘å°±æ˜¯å…ˆRC4åŠ å¯†ï¼Œç„¶åç”¨urllib.parse.quote()æ–¹æ³•ç¼–ç ï¼Œç¼–ç éƒ¨åˆ†ç”¨åŸåº“è‡ªå¸¦çš„urllib.parse.unquote()å°±è¡Œäº† EXP: 12345678910111213141516171819202122232425262728293031import urllib.parseenc = '%C2%A6n%C2%87Y%1Ag%3F%C2%A01.%C2%9C%C3%B7%C3%8A%02%C3%80%C2%92W%C3%8C%C3%BA'buf=urllib.parse.unquote(enc)result=[]for i in buf: result.append(i)key = &quot;HereIsFlagggg&quot;flag = ''def RC4(flag): s_box = list(range(256)) j = 0 for i in range(256): j = (j + s_box[i] + ord(key[i % len(key)])) % 256 s_box[i], s_box[j] = s_box[j], s_box[i] res = [] i = j = 0 for s in flag: i = (i + 1) % 256 j = (j + s_box[i]) % 256 s_box[i], s_box[j] = s_box[j], s_box[i] t = (s_box[i] + s_box[j]) % 256 k = s_box[t] res.append(chr(ord(s) ^ k)) cipher = &quot;&quot;.join(res) return cipherflag+=RC4(result)print(flag)# flag = 'NSSCTF{REAL_EZ_RC4}' [LitCTF 2023]ez_XOR IDAæ‰“å¼€ï¼Œå¦‚å›¾ ç”¨XORå‡½æ•°å¯¹è¾“å…¥åšå¤„ç†åï¼Œä¸stræ¯”è¾ƒã€‚æ‰“å¼€XORï¼š åŠŸèƒ½å°±æ˜¯éå†å­—ç¬¦ï¼Œå¼‚æˆ–å¤„ç†ï¼Œå†å¼‚æˆ–ä¸€éå°±å¯ä»¥äº† EXP: 123456str='E`}J]OrQF[V8zV:hzpV}fVF[t'flag=''for i in range(len(str)): flag+=chr(ord(str[i])^9)print(flag)# flag = 'NSSCTF{XOR_1s_3asy_to_OR}'(å‰ç¼€åšäº†æ”¹åŠ¨) [HUBUCTF 2022 æ–°ç”Ÿèµ›]simple_RE IDAæ‰“å¼€ï¼Œå¦‚å›¾ åŠ å¯†å‡½æ•°çœ‹èµ·æ¥é€»è¾‘å¾ˆå¤æ‚ï¼Œä½†æ˜¯ç‚¹å¼€åå­—å¾ˆå¥‡æ€ªçš„æ•°ç»„ï¼Œå‘ç°ä¸€ä¸ªç¼–ç è¡¨ï¼Œå¯ä»¥æ¨æµ‹æ˜¯base64ç¼–ç ã€‚ å›è¿‡å¤´çœ‹ç»™çš„ç”¨æ¥æ¯”è¾ƒçš„å­—ç¬¦ä¸²ï¼ŒåŸºæœ¬å¯ä»¥ç¡®å®šæ˜¯base64æ¢è¡¨ç¼–ç  æ‰¾åˆ°äº†ä¸€ä¸ªå¯ä»¥è‡ªå®šä¹‰ç¼–ç è¡¨çš„pythonåº“cusbase64ï¼Œå¯ä»¥ç”¨configæŒ‡å®šç¼–ç è¡¨ï¼Œè¿™æ ·å°±å®¹æ˜“å¤šäº† EXP: 1234567import cusbase64table='qvEJAfHmUYjBac+u8Ph5n9Od17FrICL/X0gVtM4Qk6T2z3wNSsyoebilxWKGZpRD'enc='5Mc58bPHLiAx7J8ocJIlaVUxaJvMcoYMaoPMaOfg15c475tscHfM/8=='b=cusbase64.CusBase64()b.config(table)b.decode(enc)#flag = 'NSSCTF{a8d4347722800e72e34e1aba3fe914ae}' [NSSCTF 2022 Spring Recruit]easy C é¢˜ç›®ç»™çš„æ˜¯cæºæ–‡ä»¶ï¼Œå¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233#include &lt;stdio.h&gt;#include &lt;string.h&gt;int main(){ char a[]=&quot;wwwwwww&quot;; char b[]=&quot;d`vxbQd&quot;; //try to find out the flag printf(&quot;please input flag:&quot;); scanf(&quot; %s&quot;,&amp;a); if(strlen(a)!=7){ printf(&quot;NoNoNo\\n&quot;); system(&quot;pause&quot;); return 0; } for(int i=0;i&lt;7;i++){ a[i]++; a[i]=a[i]^2; } if(!strcmp(a,b)){ printf(&quot;good!\\n&quot;); system(&quot;pause&quot;); return 0; } printf(&quot;NoNoNo\\n&quot;); system(&quot;pause&quot;); return 0; //flag è®°å¾—åŒ…ä¸Š NSSCTF{} å†æäº¤!!!} åˆ†æé€»è¾‘ï¼ŒæŠŠè¾“å…¥çš„flagæŒ‰å­—ç¬¦å…ˆé€’å¢ï¼Œå†å’Œ2å¼‚æˆ–ï¼Œå¾—åˆ°çš„æ–°æ•°ç»„åº”è¯¥å’Œbä¸€æ ·ã€‚é€†ç€æ¥å°±æ˜¯å…ˆå¼‚æˆ–å†é€’å‡ã€‚ EXPï¼š 123456str='d`vxbQd'flag=''for i in str: flag+=chr((ord(i)^2)-1)print(flag)#flag = 'NSSCTF{easy_Re}' [NSSCTF 2022 Spring Recruit]easy Python é¢˜ç›®ç»™çš„pyæºç ï¼Œå¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031import stringdef encode(string,string2): tmp_str = str() ret = str() bit_string_str = string.encode() remain = len( string ) % 3 remain_str = str() for char in bit_string_str: b_char = (bin(char)[2:]) b_char = '0'*(8-len(b_char)) + b_char tmp_str += b_char for i in range(len(tmp_str)//6): temp_nub = int(tmp_str[i*6:6*(i+1)],2) ret += string2[temp_nub] if remain==2: remain_str = tmp_str[-4:] + '0'*2 temp_nub = int(remain_str,2) ret += string2[temp_nub] + &quot;=&quot; elif remain==1: remain_str = tmp_str[-2:] + '0'*4 temp_nub = int(remain_str,2) ret += string2[temp_nub] + &quot;=&quot;*2 return ret.replace(&quot;=&quot;,&quot;&quot;)res = encode(input(),string.ascii_uppercase+string.ascii_lowercase+string.digits+'+/')if res == &quot;TlNTQ1RGe2Jhc2U2NCEhfQ&quot;: print(&quot;good!&quot;)else: print(&quot;bad!&quot;) ç»†ç»†ä¸€çœ‹ï¼Œencode()é‡Œé¢æœ‰åŠ â€œ=â€çš„æ“ä½œï¼Œå¹¶ä¸”ä½¿ç”¨çš„string2æ˜¯å­—æ¯å¤§å°å†™+æ•°å­—+â€™+/â€˜ï¼Œæ¨æµ‹æ˜¯base64ï¼Œä½†æ˜¯æ³¨æ„åˆ°encode()è¿”å›çš„æ—¶å€™æŠŠâ€œ=â€æ›¿æ¢æˆäº†â€œâ€ï¼Œä¹Ÿå°±æ˜¯åˆ é™¤äº†â€œ==â€ï¼Œæ‰€ä»¥è¦æŠŠåé¢ç”¨äºæ¯”è¾ƒçš„ä¹Ÿå°±æ˜¯åŠ å¯†åçš„å­—ç¬¦ä¸²åŠ ä¸Šâ€œ=â€ EXP: 12345import pybase64str='TlNTQ1RGe2Jhc2U2NCEhfQ=='flag=pybase64.b64decode(str)print(flag)#flag = 'NSSCTF{base64!!}' [SWPUCTF 2021 æ–°ç”Ÿèµ›]fakerandom ä¾æ—§æ˜¯Pyæºç ï¼š 12345678910111213import randomflag = 'xxxxxxxxxxxxxxxxxxxx'random.seed(1)l = []for i in range(4): l.append(random.getrandbits(8))result=[]for i in range(len(l)): random.seed(l[i]) for n in range(5): result.append(ord(flag[i*5+n])^random.getrandbits(8))print(result)# result = [201, 8, 198, 68, 131, 152, 186, 136, 13, 130, 190, 112, 251, 93, 212, 1, 31, 214, 116, 244] é€»è¾‘å°±æ˜¯ï¼Œç”¨ç”Ÿæˆçš„ä¼ªéšæœºæ•°æ¥å¼‚æˆ–flagçš„ç‰¹å®šä½ã€‚å¼‚æˆ–å¯é€†ï¼Œå·²çŸ¥ç§å­ï¼Œä¼ªéšæœºæ•°å¯ä»¥ç¡®å®šã€‚æ‰€ä»¥åªéœ€è¦åœ¨æºç çš„åŸºç¡€ä¸Šç¨ä½œæ”¹åŠ¨ï¼ŒæŠŠresultå’Œflagçš„ä½ç½®è°ƒæ¢ä¸€ä¸‹å°±å¯ä»¥äº† EXPï¼š 12345678910111213import randomflag = ''result = [201, 8, 198, 68, 131, 152, 186, 136, 13, 130, 190, 112, 251, 93, 212, 1, 31, 214, 116, 244]random.seed(1)l = []for i in range(4): l.append(random.getrandbits(8))for i in range(len(l)): random.seed(l[i]) for n in range(5): flag+=chr(result[i*5+n]^random.getrandbits(8))print(flag)#flag = 'NSSCTF{FakeE_random}' [HNCTF 2022 Week1]X0r IDAæ‰“å¼€ï¼Œmainå‡½æ•°å¦‚ä¸‹ï¼š å¯ä»¥çœ‹å‡ºï¼Œé€»è¾‘å°±æ˜¯å¯¹è¾“å…¥çš„å­—ç¬¦ä¸²æŒ‰å­—ç¬¦å¼‚æˆ–å¤„ç†ï¼Œæœ€åä¸ç»™å®šçš„arræ¯”è¾ƒ EXPï¼š 123456arr=[0x000003FE, 0x000003EB, 0x000003EB, 0x000003FB, 0x000003E4, 0x000003F6, 0x000003D3, 0x000003D0, 0x00000388, 0x000003CA, 0x000003EF, 0x00000389, 0x000003CB, 0x000003EF, 0x000003CB, 0x00000388, 0x000003EF, 0x000003D5, 0x000003D9, 0x000003CB, 0x000003D1, 0x000003CD]flag=''for i in range(0,len(arr)): flag+=chr((arr[i]-900)^0x34)print(flag)flag = 'NSSCTF{x0r_1s_s0_easy}' [HGAME 2023 week1]easyenc IDAæ‰“å¼€ï¼Œmainå‡½æ•°å¦‚å›¾ å¯ä»¥çœ‹åˆ°é€»è¾‘å°±æ˜¯å…ˆéå†å‡ºè¾“å…¥å­—ç¬¦ä¸²çš„é•¿åº¦ï¼ˆ * ( ( _BYTE *) v9 + v4 )è¿™æ ·çš„æ ¼å¼å¯ä»¥çœ‹æˆï¼šv9[v4]ï¼Œç®—æ˜¯ä¸€ç§ç»éªŒå§ï¼‰ç„¶åå¾ªç¯å¯¹è¾“å…¥çš„å­—ç¬¦ä¸²æŒ‰å­—ç¬¦è¿›è¡Œè¿ç®—ï¼Œæœ€åä¸ç»™å®šçš„æ•°æ®æ¯”è¾ƒã€‚ éš¾ç‚¹åœ¨äºï¼Œç»™çš„æ˜¯10ä¸ªå…ƒç´ çš„æ•°ç»„ï¼Œè€Œè¾“å…¥çš„å­—ç¬¦ä¸²å´è¦æ±‚æ˜¯41ä¸ªå­—ç¬¦ã€‚çœ‹æ¥V7çš„æ ¼å¼ä¸æ˜¯å¾ˆå¯¹ï¼Œè¦æŠŠè¿™ä¹ˆå¤šä½çš„æ•°æ®è¿›è¡Œåˆ’åˆ†æ‰è¡Œã€‚v7æ˜¯DWORDç±»å‹ï¼Œè€Œå‚ä¸è¿ç®—çš„v9ç”¨çš„æ˜¯BYTEç±»å‹ï¼Œ1DWORD=4BYTEï¼Œè¦æŠŠv7çš„æ•°åˆ†æˆ4éƒ¨åˆ†ï¼Œè¿™é‡Œçš„æ•°æ®ä¸å¥½æå–ï¼Œå¯ä»¥ç›´æ¥ä¸¢ç»™AIã€‚å½“ç„¶æ‰‹åŠ¨å¤åˆ¶ä¹Ÿå¯ä»¥ã€‚ EXPï¼š 12345678910111213buf=[0x9FDFF04,0xB0F301,0xADF00500,0x5170607,0x17FD17EB,0x1EE01EA,0xFA05B1EA,0xAC170108,0xFDEA01EC,0x60705F0]flag=''buf1 = []for num in buf: bytes_data = num.to_bytes(4, byteorder='little') for byte in bytes_data: buf1.append(hex(byte))#print(buf1)for num in buf1: tmp=((int(num,16)+86)^0x32)&amp;0xff flag+=chr(tmp)print(flag)#flag = 'NSSCTF{4ddit1on_is_a_rever5ible_0peration}'ï¼ˆä¿®æ”¹äº†å‰ç¼€ï¼‰ å½“ç„¶å¾—å¤šå­¦ä¸€ç‚¹ï¼Œæ‰€ä»¥æ‰‹æ“v7ï¼Œæ‰¾DSé—®ä¸€ä¸‹æ€ä¹ˆå¤„ç†æ•°æ®ï¼Œå¾—åˆ°å¦‚ä¸Šçš„æ–¹æ³•ã€‚ ç”¨to_bytesæŠŠv7çš„æ•°è½¬æˆå­—èŠ‚å½¢å¼ï¼ŒbyteorderæŒ‡å®šäº†å°ç«¯åºï¼Œç„¶åhexè½¬æ¢æˆåå…­è¿›åˆ¶æ•°å­˜å…¥æ–°åˆ—è¡¨ã€‚è‡³äºä¸ºä»€ä¹ˆè¦è½¬æˆåå…­è¿›åˆ¶æ•°ï¼Œå’Œä¸‹é¢çš„ä»£ç æœ‰å…³ã€‚ ç„¶åç”¨æ–°åˆ—è¡¨çš„å…ƒç´ è¿›è¡Œé€†è¿ç®—ã€‚å› ä¸ºç›´æ¥ä½¿ç”¨è¿™äº›å…ƒç´ ä¼šè¢«åˆ¤æˆå­—ç¬¦ï¼Œæ‰€ä»¥å‰é¢å…ˆè½¬æˆåå…­è¿›åˆ¶æ•°ï¼Œå†ç”¨intè½¬æˆåè¿›åˆ¶æ•°ï¼Œè¿™æ ·å°±å¯ä»¥æ­£å¸¸è¿ç®—äº† æœ€åè¿˜è¦&amp;0xffï¼Œå› ä¸ºé€†å‡ºæ¥çš„æ•°æ®æœ‰ç‚¹è¶…å‡ºasciiç èŒƒå›´äº† è¿˜æœ‰å°±æ˜¯ï¼Œè¿™æ ·å¾—å‡ºæ¥çš„flagå…¶å®ç¼ºäº†ä¸€ä¸ªâ€œ } â€ã€‚å›å¤´çœ‹åç¼–è¯‘çš„ä»£ç ï¼Œé‚£ä¸ªæœªå‘½åçš„ç”¨æ¥è¾“å…¥v9çš„å®é™…ä¸Šä¸æ˜¯çº¯ç²¹çš„scanfé‚£æ ·çš„å‡½æ•°ã€‚é‡Œé¢æœ‰ä¸ªFILEæŒ‡é’ˆï¼Œæ¨æµ‹æ˜¯è¯»æ–‡ä»¶çš„å‡½æ•°ã€‚æ‰€ä»¥è¯»å–çš„å†…å®¹ç»“å°¾æŒ‰é“ç†ä¼šæœ‰â€™\\0â€™ã€‚ä½†æ˜¯ï¼ŒåŠ ä¸Šäº†â€™\\0â€™ç®—å‡ºæ¥çš„flagä¹Ÿæ²¡æœ‰â€™ } â€˜ã€‚æ‰€ä»¥ï¼Œå‡­å¸¸è¯†åŠ ä¸Šâ€™ } â€˜ã€‚","link":"/2025/06/02/Re-%E4%BB%8E0%E5%88%B01%E7%9A%84%E8%84%9A%E6%9C%AC%E4%B9%8B%E8%B7%AF/"},{"title":"icarusä¸»é¢˜ä¼˜åŒ–","text":"icarusä¸»é¢˜å¤åˆ¶åŠŸèƒ½é‡æ„ï¼ˆä»¿ç…§nextä¸»é¢˜ï¼‰ã€firebaseç»Ÿè®¡é˜…è¯»äººæ•° å¤åˆ¶åŠŸèƒ½é‡æ„ icarusä¸»é¢˜è‡ªå¸¦çš„å¤åˆ¶åŠŸèƒ½æ˜¯å¸¦æ–‡å­—é€‰ä¸­çš„ï¼ˆå¦‚ä¸‹å›¾ï¼‰ï¼Œä¸ªäººæ„Ÿè§‰éº»çƒ¦äº†ç‚¹ï¼Œäºæ˜¯è€ƒè™‘å€Ÿé‰´nextçš„å¤åˆ¶é£æ ¼ï¼Œä¸€é”®å¤åˆ¶ å®ç°ï¼š hexo-theme-icarus/source/js/main.jsï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586 if (clipboard) {- new ClipboardJS('.highlight .copy', {- target: function(trigger) {- return trigger.parentNode.nextElementSibling;- }- }).on('success', function(e) {- e.clearSelection();- const tmp = e.trigger.innerHTML;- e.trigger.innerHTML = '&lt;i class=&quot;fas fa-check&quot;&gt;&lt;/i&gt;';- setTimeout(function() {- e.trigger.innerHTML = tmp;- }, 2000);- });+ $('figure.highlight').each(function() {+ const target = $(this).find('figcaption div.level-right')[0];+ if (target) {+ registerCopyButton(target, this);+ }+ }); } ----------------------------------------------------------------------------------... $('.article &gt; .content &gt; table').each(function() { if ($(this).width() &gt; $(this).parent().width()) { $(this).wrap('&lt;div class=&quot;table-overflow&quot;&gt;&lt;/div&gt;'); } });+ // æ³¨å†Œå¤åˆ¶æŒ‰é’®åŠŸèƒ½ï¼Œä»¿ç…§Nextä¸»é¢˜å®ç°+ function registerCopyButton(target, element) {+ // æ·»åŠ å¤åˆ¶æŒ‰é’®+ target.insertAdjacentHTML('beforeend', '&lt;a href=&quot;javascript:;&quot; class=&quot;copy&quot; title=&quot;Copy&quot;&gt;&lt;i class=&quot;fas fa-copy&quot;&gt;&lt;/i&gt;&lt;/a&gt;');+ const button = target.querySelector('.copy');+ + button.addEventListener('click', function() {+ const code = element.querySelector('.code').innerText;+ + if (navigator.clipboard) {+ // ä½¿ç”¨ç°ä»£çš„Clipboard API+ navigator.clipboard.writeText(code).then(function() {+ button.querySelector('i').className = 'fas fa-check-circle';+ }, function() {+ button.querySelector('i').className = 'fas fa-times-circle';+ });+ } else {+ // å…¼å®¹æ€§å›é€€æ–¹æ¡ˆ+ const ta = document.createElement('textarea');+ ta.style.top = window.scrollY + 'px';+ ta.style.position = 'absolute';+ ta.style.opacity = '0';+ ta.readOnly = true;+ ta.value = code;+ document.body.append(ta);+ ta.select();+ ta.setSelectionRange(0, code.length);+ ta.readOnly = false;+ const result = document.execCommand('copy');+ button.querySelector('i').className = result ? 'fas fa-check-circle' : 'fas fa-times-circle';+ ta.blur();+ button.blur();+ document.body.removeChild(ta);+ }+ });+ + // é¼ æ ‡ç¦»å¼€300msåæ¢å¤å¤åˆ¶å›¾æ ‡+ element.addEventListener('mouseleave', function() {+ setTimeout(function() {+ const icon = button.querySelector('i');+ if (icon) {+ icon.className = 'fas fa-copy';+ }+ }, 300);+ });+ } function adjustNavbar() { const navbarWidth = $('.navbar-main .navbar-start').outerWidth() + $('.navbar-main .navbar-end').outerWidth(); if ($(document).outerWidth() &lt; navbarWidth) { $('.navbar-main .navbar-menu').addClass('justify-content-start'); } else { $('.navbar-main .navbar-menu').removeClass('justify-content-start'); } } hexo-theme-icarus/layout/common/scripts.jsx 12345678910 return &lt;Fragment&gt; &lt;script src={cdn('jquery', '3.3.1', 'dist/jquery.min.js')}&gt;&lt;/script&gt; &lt;script src={cdn('moment', '2.22.2', 'min/moment-with-locales.min.js')}&gt;&lt;/script&gt; &lt;script dangerouslySetInnerHTML={{ __html: `moment.locale(&quot;${language}&quot;);` }}&gt;&lt;/script&gt; &lt;script dangerouslySetInnerHTML={{ __html: embeddedConfig }}&gt;&lt;/script&gt; &lt;script data-pjax src={url_for('/js/column.js')}&gt;&lt;/script&gt; &lt;Plugins site={site} config={config} page={page} helper={helper} head={false} /&gt;- {clipboard &amp;&amp; &lt;script src={cdn('clipboard', '2.0.4', 'dist/clipboard.min.js')} defer&gt;&lt;/script&gt;} &lt;script data-pjax src={url_for('/js/main.js')} defer&gt;&lt;/script&gt; &lt;/Fragment&gt;; ä½¿ç”¨firebaseç»Ÿè®¡é˜…è¯»äººæ•°configæ–‡ä»¶æ·»åŠ é…ç½®_config.icarus.yml 1234567+# Firebase Firestore é˜…è¯»äººæ•°ç»Ÿè®¡+services:+ firebase:+ enable: true+ collection: articles # Firestoreæ•°æ®åº“ä¸­çš„é›†åˆåç§°+ apiKey: # ä½ çš„Firebase API Key+ projectId: # ä½ çš„Firebaseé¡¹ç›®ID æ–‡ç« headå¢åŠ äººæ•°ç»Ÿè®¡hexo-theme-icarus/layout/common/articles.jsx 123456789 {/* Visitor counter */} {!index &amp;&amp; plugins &amp;&amp; plugins.busuanzi === true ? &lt;span class=&quot;level-item&quot; id=&quot;busuanzi_container_page_pv&quot; dangerouslySetInnerHTML={{ __html: _p('plugin.visit_count', '&lt;span id=&quot;busuanzi_value_page_pv&quot;&gt;0&lt;/span&gt;') }}&gt;&lt;/span&gt; : null}+ {/* Firebase Visitor counter */}+ {config.services &amp;&amp; config.services.firebase &amp;&amp; config.services.firebase.enable ? &lt;span class=&quot;level-item&quot;&gt;+ &lt;i class=&quot;far fa-eye mr-1&quot;&gt;&lt;/i&gt;+ &lt;span class=&quot;firestore-visitors-count&quot;&gt;0&lt;/span&gt;+ &lt;/span&gt; : null} åŸºäºfirebaseçš„ç»Ÿè®¡åŠŸèƒ½å®ç°source/js/firebase_counter.jsï¼ˆæ–°å»ºï¼‰ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187+/* global IcarusThemeSettings, firebase */++// Firebase Counter - é˜…è¯»é‡ç»Ÿè®¡åŠŸèƒ½++if (IcarusThemeSettings &amp;&amp; IcarusThemeSettings.services &amp;&amp; IcarusThemeSettings.services.firebase &amp;&amp; IcarusThemeSettings.services.firebase.enable) {+ + // åˆå§‹åŒ–Firebase+ try {+ // ç¡®ä¿firebaseå¯¹è±¡å­˜åœ¨+ if (typeof firebase === 'undefined') {+ console.error('Firebase library not loaded');+ // å¦‚æœFirebaseåº“æœªåŠ è½½ï¼Œéšè—è®¡æ•°å™¨å…ƒç´ + document.querySelectorAll('.firestore-visitors-count').forEach(el =&gt; {+ el.style.display = 'none';+ });+ } else {+ + firebase.initializeApp({+ apiKey: IcarusThemeSettings.services.firebase.apiKey,+ projectId: IcarusThemeSettings.services.firebase.projectId+ });+ + // å¼€å‘ç¯å¢ƒæ£€æµ‹+ const isLocalhost = ['localhost', '127.0.0.1'].includes(window.location.hostname);+ const isDevelopment = isLocalhost || window.location.hostname.includes('192.168.');+ + // ç§»é™¤æ‰€æœ‰è°ƒè¯•æ—¥å¿—è¾“å‡º+ + // è·å–æ•°æ®åº“å¼•ç”¨+ const db = firebase.firestore();+ const articlesCollection = IcarusThemeSettings.services.firebase.collection || 'articles';+ const articles = db.collection(articlesCollection);+ + // è·å–é˜…è¯»æ¬¡æ•°å‡½æ•°+ const getCount = (doc, increaseCount) =&gt; {+ // è·å–æ–‡æ¡£æ•°æ®+ return doc.get().then(d =&gt; {+ // åˆå§‹åŒ–è®¡æ•°+ let count = d.exists ? d.data().count : 0;+ + // å¦‚æœéœ€è¦å¢åŠ è®¡æ•°ï¼ˆåªåœ¨æ–‡ç« é¡µé¢ä¸”æœªåœ¨åŒä¸€ä¼šè¯è®¿é—®è¿‡ï¼‰+ if (increaseCount) {+ // å¢åŠ è®¡æ•°+ count++;+ return doc.set({ count }).then(() =&gt; {+ if (isDevelopment) console.log('è®¡æ•°å·²æ›´æ–°:', count);+ return count;+ }).catch(error =&gt; {+ console.error('Error updating count:', error);+ return count; // è¿”å›å¢åŠ å‰çš„è®¡æ•°+ });+ }+ + return count;+ }).catch(error =&gt; {+ console.error('Error getting count:', error);+ // å‡ºé”™æ—¶è¿”å›é»˜è®¤å€¼0+ return 0;+ });+ };++ // å¤„ç†é˜…è¯»è®¡æ•°çš„å‡½æ•°+ const handleViewCount = () =&gt; {+ // è·å–å½“å‰URLè·¯å¾„+ const currentPath = window.location.pathname;+ + // å¢å¼ºé¦–é¡µè¯†åˆ«ï¼šä½¿ç”¨å¤šä¸ªå¯èƒ½çš„é€‰æ‹©å™¨+ const isIndexPage = document.querySelector('.article-list') !== null ||+ document.querySelector('.article-card-list') !== null ||+ document.querySelectorAll('.article-card').length &gt; 0 || // é™ä½é˜ˆå€¼ä»¥é€‚åº”é¦–é¡µ+ (currentPath === '/' &amp;&amp; document.querySelector('article.article') !== null); // ç‰¹æ®Šå¤„ç†ï¼šæ ¹è·¯å¾„+article.articleå…ƒç´ + + // å¢å¼ºæ–‡ç« é¡µé¢è¯†åˆ«ï¼šä½¿ç”¨æ›´ç²¾ç¡®çš„é€‰æ‹©å™¨ç»„åˆ+ // é‡è¦ï¼šé¦–é¡µä¼˜å…ˆåˆ¤æ–­ï¼Œä¸”æ–‡ç« é¡µåˆ¤æ–­è¦æ’é™¤é¦–é¡µçš„æƒ…å†µï¼Œå¹¶å¢åŠ ç‰¹å®šçš„æ–‡ç« é¡µç‰¹å¾+ const isArticlePage = !isIndexPage &amp;&amp; (+ // ä¼ ç»Ÿæ–‡ç« é¡µé€‰æ‹©å™¨+ (document.querySelector('.article-container') !== null &amp;&amp; document.querySelector('.article-content') !== null) ||+ (document.querySelector('article.post') !== null &amp;&amp; document.querySelector('.article-content') !== null) ||+ document.querySelector('[id=&quot;post-content&quot;]') !== null ||+ // é’ˆå¯¹hexo sç¯å¢ƒçš„å¢å¼ºé€‰æ‹©å™¨ï¼Œä½†éœ€è¦ç¡®ä¿ä¸æ˜¯é¦–é¡µ+ (document.querySelector('article.article') !== null &amp;&amp; + document.querySelector('article.card-content.article') !== null &amp;&amp;+ document.querySelectorAll('.article-card').length === 0 &amp;&amp;+ currentPath !== '/')+ );+ + // é¡µé¢ç±»å‹ä¿¡æ¯ - ä»…åœ¨å¼€å‘ç¯å¢ƒæ˜¾ç¤º+ if (isDevelopment) {+ console.log(`[Firebase] å½“å‰é¡µé¢ç±»å‹: ${isArticlePage ? 'æ–‡ç« é¡µ' : isIndexPage ? 'é¦–é¡µ' : 'å…¶ä»–é¡µé¢'}`);+ }++ if (isArticlePage) {+ // æ–‡ç« é¡µé¢å¤„ç†+ const titleElement = document.querySelector('.title.is-3, .title.is-4-mobile');+ const countElement = document.querySelector('.firestore-visitors-count');+ + if (titleElement &amp;&amp; countElement) {+ const title = titleElement.textContent.trim();+ const doc = articles.doc(title);+ + // ç¡®å®šæ˜¯å¦å¢åŠ è®¡æ•°ï¼šä¸åœ¨æœ¬åœ°å¼€å‘ç¯å¢ƒä¸”åŒä¸€ä¼šè¯æœªè®¿é—®è¿‡+ let increaseCount = !isDevelopment;+ + if (sessionStorage.getItem(title)) {+ increaseCount = false;+ } else {+ // æ ‡è®°ä¸ºåœ¨å½“å‰ä¼šè¯ä¸­å·²è®¿é—®+ sessionStorage.setItem(title, true);+ }+ + getCount(doc, increaseCount).then(count =&gt; {+ countElement.innerText = count;+ }).catch(e =&gt; {+ // ç§»é™¤é”™è¯¯æ—¥å¿—+ });+ } else {+ // é™é»˜å¤„ç†ï¼šæœªæ‰¾åˆ°æ–‡ç« æ ‡é¢˜æˆ–è®¡æ•°å…ƒç´ + }+ } else if (isIndexPage) {+ // é¦–é¡µæ–‡ç« åˆ—è¡¨å¤„ç†+ // ä¿®æ”¹é€‰æ‹©å™¨ä»¥åŒ¹é…å®é™…HTMLç»“æ„+ // é¦–é¡µæ–‡ç« ç»“æ„: .card &gt; .card-content.article &gt; .title.is-3.is-size-4-mobile+ const titleElements = document.querySelectorAll(+ '.card .article .title.is-3, .card .article .title.is-4-mobile, ' ++ '.card article .title.is-3, .card article .title.is-4-mobile, ' ++ '.card .article p.title, .card article p.title'+ );+ const countElements = document.querySelectorAll('.card .article .firestore-visitors-count, .card article .firestore-visitors-count');+ + // ç§»é™¤é¦–é¡µå…ƒç´ æ£€æµ‹æ—¥å¿—+ + if (titleElements.length &gt; 0 &amp;&amp; countElements.length &gt; 0) {+ const promises = [...titleElements].map(element =&gt; {+ const title = element.textContent.trim();+ const doc = articles.doc(title);+ // é¦–é¡µåªè·å–è®¡æ•°ï¼Œä¸å¢åŠ è®¡æ•°+ return getCount(doc, false).then(count =&gt; {+ return count;+ });+ });+ + Promise.all(promises).then(counts =&gt; {+ counts.forEach((val, idx) =&gt; {+ if (countElements[idx]) {+ countElements[idx].innerText = val;+ }+ });+ }).catch(e =&gt; {+ // é”™è¯¯å¤„ç†ï¼šå°è¯•æ˜¾ç¤ºä¸€äº›é»˜è®¤å€¼æˆ–æ›¿ä»£æ–‡æœ¬+ countElements.forEach(el =&gt; {+ if (el.innerText === '0') {+ el.innerText = 'åŠ è½½ä¸­...';+ }+ });+ });+ } else {+ // å°è¯•ä½¿ç”¨æ›´é€šç”¨çš„é€‰æ‹©å™¨+ const fallbackTitleElements = document.querySelectorAll('.article-card a[href^=&quot;/&quot;]');+ const fallbackCountElements = document.querySelectorAll('.article-card .firestore-visitors-count');+ + if (fallbackTitleElements.length &gt; 0 &amp;&amp; fallbackCountElements.length &gt; 0) {+ // è¿™é‡Œå¯ä»¥æ·»åŠ å¤‡é€‰é€»è¾‘+ }+ }+ } else {+ // é™é»˜å¤„ç†ï¼šå½“å‰é¡µé¢æ—¢ä¸æ˜¯æ–‡ç« é¡µä¹Ÿä¸æ˜¯é¦–é¡µ+ }+ };+++ // ç›‘å¬ä¼ ç»Ÿé¡µé¢åŠ è½½å®Œæˆäº‹ä»¶+ document.addEventListener('DOMContentLoaded', () =&gt; {+ handleViewCount();+ });+ + // ç›‘å¬PJAXé¡µé¢åŠ è½½å®Œæˆäº‹ä»¶ï¼ˆé€‚é…Icarusä¸»é¢˜çš„PJAXæœºåˆ¶ï¼‰+ document.addEventListener('page:loaded', () =&gt; {+ handleViewCount();+ });+ }+ } catch (error) {+ // ç§»é™¤åˆå§‹åŒ–å¤±è´¥æ—¥å¿—+ // å¦‚æœåˆå§‹åŒ–å¤±è´¥ï¼Œå°è¯•éšè—è®¡æ•°å™¨å…ƒç´ ä»¥é¿å…æ˜¾ç¤ºä¸º0+ document.querySelectorAll('.firestore-visitors-count').forEach(el =&gt; {+ el.style.display = 'none';+ });+ }+} å…¶ä»–ä¸€äº›ä¼˜åŒ–hexo-theme-icarus/layout/common/scripts.jsx 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556const { Component, Fragment } = require('inferno');const { toMomentLocale } = require('hexo/dist/plugins/helper/date');const Plugins = require('./plugins');module.exports = class extends Component { render() { const { site, config, helper, page } = this.props; const { url_for, cdn } = helper; const { article } = config; const language = toMomentLocale(page.lang || page.language || config.language || 'en'); let fold = 'unfolded'; let clipboard = true; if (article &amp;&amp; article.highlight) { if (typeof article.highlight.clipboard !== 'undefined') { clipboard = !!article.highlight.clipboard; } if (typeof article.highlight.fold === 'string') { fold = article.highlight.fold; } } const embeddedConfig = `var IcarusThemeSettings = { article: { highlight: { clipboard: ${clipboard}, fold: '${fold}' }+ },+ services: {+ firebase: ${config.services &amp;&amp; config.services.firebase ? JSON.stringify(config.services.firebase) : 'false'} } };`; return &lt;Fragment&gt; &lt;script src={cdn('jquery', '3.3.1', 'dist/jquery.min.js')}&gt;&lt;/script&gt; &lt;script src={cdn('moment', '2.22.2', 'min/moment-with-locales.min.js')}&gt;&lt;/script&gt; &lt;script dangerouslySetInnerHTML={{ __html: `moment.locale(&quot;${language}&quot;);` }}&gt;&lt;/script&gt; &lt;script dangerouslySetInnerHTML={{ __html: embeddedConfig }}&gt;&lt;/script&gt;+ {/* Firebase Firestore */}+ {config.services &amp;&amp; config.services.firebase &amp;&amp; config.services.firebase.enable ? (+ &lt;Fragment&gt;+ &lt;script src=&quot;https://www.gstatic.com/firebasejs/9.6.11/firebase-app-compat.js&quot;&gt;&lt;/script&gt;+ &lt;script src=&quot;https://www.gstatic.com/firebasejs/9.6.11/firebase-firestore-compat.js&quot;&gt;&lt;/script&gt;+ &lt;/Fragment&gt;+ ) : null} &lt;script data-pjax src={url_for('/js/column.js')}&gt;&lt;/script&gt; &lt;Plugins site={site} config={config} page={page} helper={helper} head={false} /&gt; &lt;script data-pjax src={url_for('/js/main.js')} defer&gt;&lt;/script&gt;+ {/* Firebase counter script */}+ {config.services &amp;&amp; config.services.firebase &amp;&amp; config.services.firebase.enable ? (+ &lt;script data-pjax src={url_for('/js/firebase_counter.js')} defer&gt;&lt;/script&gt;+ ) : null} &lt;/Fragment&gt;; }};","link":"/2025/09/02/icarus%E4%B8%BB%E9%A2%98%E4%BC%98%E5%8C%96/"},{"title":"week27-week30","text":"2025å¹´9æœˆç¯‡ week27 (2025.9.1-2025.9.7) æ¥ä¸‹æ¥æ‰“ç®—æŠŠå‘¨è®°åˆ†æˆå››å‘¨ä¸€ç¯‡äº†ï¼Œæ¯å‘¨ç…§æ ·æ›´æ–°ï¼Œä½†æ˜¯å››å‘¨ä¸€ç¯‡æ–‡ç«  è¿™å‘¨ï¼ˆå…¶å®æ˜¯ä¸Šå‘¨ï¼Œè¿™æ®µæ˜¯è¡¥çš„ï¼‰æŠŠåšå®¢ä¸»é¢˜ç»™æ¢äº†ã€‚åŸå…ˆæƒ³ç€å…ˆé…ç½®å®Œï¼Œåˆ°æ—¶å€™ç›´æ¥æŠŠæ–‡ç« ç§»åˆ°æ–°çš„åšå®¢æ–‡ä»¶é‡Œï¼Œä½†æ˜¯è¿›åº¦å¤ªæ…¢äº†ã€‚è¿™å‘¨ç›´æ¥ç»™åŸåšå®¢æ¢çš®ğŸ˜‹è¿˜æ›´äº†ä¸€ç¯‡åšå®¢,çœŸå¥½ğŸ˜‹(è™½ç„¶è¿˜æ˜¯AIå‡ºåŠ›) moe week4ä¸Šæ–°é¢˜äº†,ä½†æ˜¯week3ç”šè‡³week2è¿˜æœ‰æ²¡å†™å®Œçš„é¢˜ å®‰å“è¿™å—çš„ç¬”è®°è¿˜æ²¡æ›´,å¼€å­¦äº†æ‰¾æ‰¾æ—¶é—´è¡¥ä¸Š week28 (2025.9.8-2025.9.14) å¥½çš„æ‰‹å¿™è„šä¹±çš„å¼€å­¦ç¬¬ä¸€å‘¨ï¼Œç›®å‰å­¦ä¹ è®¡åˆ’æœ‰å¾…æ›´æ–°ã€‚ è¿™å‘¨å’ŒX2cçš„æ–°å¸ˆå‚…ä»¬ç»„é˜Ÿå‚åŠ äº†æ¹¾åŒºæ¯ï¼Œç‹¬ç«‹è§£å‡ºäº†ä¸€é“é¢˜ï¼Œè¿˜æ˜¯å¤ªèœäº†ã€‚è€ƒå¯Ÿæ–¹å‘è¿˜æŒºå…¨é¢ï¼Œpcç«¯ã€å®‰å“ç”šè‡³å¾®ä¿¡å°ç¨‹åºéƒ½æœ‰ã€‚ week29 (2025.9.15-2025.9.21) è¿™å‘¨æœ‰ä¸ªé•¿åŸæ¯ï¼ˆè¿˜æœ‰ä¸ªé“äººä¸‰é¡¹é•¿åŸæ¯ï¼Œè¿™ä¿©å¥½åƒä¸æ˜¯ä¸€ä¸ªï¼‰ï¼Œåªåˆ†webã€AIå®‰å…¨ã€æ•°æ®å®‰å…¨ä¸‰ä¸ªæ–¹å‘ï¼Œæ²¡åšå‡ºæ¥ï¼Œçˆ†0äº† å¼€å­¦äº†å­¦ä¹ çŠ¶æ€åˆå¼€å§‹ä¸ç¨³å®šäº†ï¼Œè€æ˜¯å·æ‡’ä¸æ‰¾æ—¶é—´å­¦ğŸ˜–è¿™å­¦æœŸå¥½å‡ é—¨æ•°å­¦ç›¸å…³è¯¾ï¼Œè¦ç‡ƒå°½äº† ç»™åšå®¢æ–°å¼€äº†æ•°æ®ç»“æ„åˆ†ç±»ï¼Œèƒ½ä¸èƒ½æ›´ä¸‹å»çœ‹é€ åŒ–äº†( week30 (2025.9.22-2025.9.28) è¿™å‘¨åˆæ˜¯æ²¡æœ‰æ–°çŸ¥è¯†çš„ä¸€å‘¨ å‘¨å…­åˆå¹²æ‰ä¸€é“moectfçš„é¢˜ï¼Œåªå‰©æœ€åä¸€é“week2çš„upx_revengeäº†ï¼Œå®åœ¨æ²¡æ‹›äº†ğŸ˜– æ„Ÿè§‰è¿˜æ˜¯æ²¡æ‰¾åˆ°å­¦ä¸šå’Œæ¯”èµ›çš„å¹³è¡¡ç‚¹ï¼Œè¿™æ ·ä¸‹å»ææ€•ä¸€å­¦æœŸå­¦çš„éƒ½æ²¡æœ‰ä¸€ä¸ªæš‘å‡å¤šğŸ˜–ä¸å¾—ä¸åæ§½ä¸ºä»€ä¹ˆä¹±ä¸ƒå…«ç³Ÿçš„è¯¾è¿™ä¹ˆå¤šå•ŠğŸ˜–","link":"/2025/09/08/week27-week30/"},{"title":"week40-week44","text":"2025å¹´12æœˆç¯‡ week40 (2025.12.1-2025.12.7) è¿™å‘¨æ‘†çƒ‚åŠ›/_ \\ week41 (2025.12.8-2025.12.14) å‘¨æœ«æ‰“äº†é¹åŸæ¯ï¼Œä¸€é“é¢˜è€—æ‰ä¸€æ•´å¤©(T_T)ã€‚åˆæ˜¯è¿‡äºä¾èµ–AIï¼Œå¯¼è‡´å¤§åŠæ—¶é—´éƒ½åœ¨ç­‰AIå’Œè°ƒæ•™AIï¼ˆä¸€é“èŠ±æŒ‡ä»¤+VMçš„é¢˜ï¼Œä¸€å¼€å§‹çœ‹å‡ºæ˜¯VMæ²¡çœ‹å‡ºèŠ±æŒ‡ä»¤åœ¨å“ªé‡Œï¼Œä¸¢ç»™AIåˆ†æï¼Œä¸€æ—©ä¸Š3hæ²¡å‡ºç»“æœï¼Œä¸­åˆè‡ªå·±ç¢ç£¨äº†ä¸‹æ±‡ç¼–ä»£ç æ‰çœ‹å‡ºèŠ±æŒ‡ä»¤çš„è§„å¾‹ã€‚å€¼å¾—é«˜å…´çš„æ˜¯ä»Šå¤©æ²¡é AIè‡ªå·±å†™äº†IDApythonè„šæœ¬å»èŠ±(ã€‚ä½†æ˜¯åé¢å†™VMè§£é‡Šå™¨åˆä¸¢ç»™AIäº†ï¼ŒAIåˆ†æä¸€ä¸‹åˆæ²¡åˆ†æå‡ºä¸€æ ¹æ¯›ï¼Œåˆæ˜¯æ¯”èµ›ç»“æŸåè‡ªå·±ç¢ç£¨å‡ºäº†ä¸‹ä¸€æ­¥ï¼ˆæ‚²ï¼‰ã€‚å¤åˆ¶åŸä»£ç æ’ä¸ªæ¡©å‡ ååˆ†é’Ÿå¯ä»¥è·‘çš„åæ±‡ç¼–éè¦è®©AIæ¥ï¼Œè¿™ä¹ˆå¤šçš„æ—¶é—´é—¹ç€ç©å‘¢å±äºæ˜¯ğŸ˜¡ å«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIå«ä½ ç”¨AIğŸ˜¡ ä¸‹ä¸‹å‘¨CISCNä¸èƒ½ç”¨AIçœ‹ä½ æ€ä¹ˆåŠğŸ˜¡ week42 (2025.12.15-2025.12.21) è€ƒè¯•å‘¨æ–­æ›´( week43 (2025.12.22-2025.12.28) è¿™å‘¨æœ«CISCNï¼Œè¿˜æ˜¯å¤ªèœäº†ã€‚å¤æ‚ç¨‹åºçš„é€†å‘èƒ½åŠ›ä¸€ç‚¹æ²¡æœ‰ã€‚ã€‚ã€‚ week44 (2025.12.29-2026.1.4) å…ƒæ—¦æœŸé—´æ— èŠå¤ç°äº†CISCNçš„wasm-loginï¼Œè¿™é¢˜ä¸ä¼šå†™è„šæœ¬è´¥åŒ—äº†ğŸ˜­ æ­¤å¤–è¿˜æŠ˜è…¾äº†ä¸€ä¸‹WSL2ï¼Œæƒ³ä½“éªŒä½“éªŒArchç”Ÿæ€ï¼ˆå…¶å®ä¸»è¦æ˜¯æ˜¯å¹³é“ºå¼æ¡Œé¢ç®¡ç†å™¨ï¼‰ï¼Œç„¶è€ŒWSL2è²Œä¼¼ä¸æ”¯æŒç›´æ¥å›¾å½¢åŒ–æ¡Œé¢ï¼Œåé¢åˆå»æŠ˜è…¾VNCè¿æ¥WSL2ææ¡Œé¢ï¼Œæ²¡æå‡ºæ¥ã€‚è™½ç„¶ä½†æ˜¯ï¼ŒæŠ˜è…¾ä½¿æˆ‘å¿«ä¹â—‹( ï¼¾çš¿ï¼¾)ã£","link":"/2025/12/07/week40-week44/"},{"title":"week31-week34","text":"2025å¹´10æœˆç¯‡ week31 (2025.9.29-2025.10.5) è¿™å‘¨ç¢°ä¸Šå›½åº†å‡æœŸï¼Œè¶ç€å‡æœŸç‹ ç‹ ç ”ç©¶moectfçš„upx_revengeã€‚èŠ±äº†ä¸¤å¤©æ—¶é—´ç¢ç£¨å‡ºäº†.rsrcæ®µåº”è¯¥æœ‰é—®é¢˜ï¼ˆä¹‹å‰ä¸çŸ¥é“å“ªé‡Œæ‰¾çš„å·¥å…·ç»™ä¿®å¤åˆ°ç¨‹åºèƒ½è¿è¡Œä½†æ˜¯é—ªé€€äº†ï¼Œåé¢æ‹¿æ­£å¸¸åŠ å£³ç¨‹åºå¯¹æ¯”ä¸€ä¸‹ä¸åŒçš„åœ°æ–¹åœ¨.rsrcæ®µï¼‰ï¼Œç„¶åæŠŠ.rsrcæ®µçš„ResourceDirectoryTableç»™ä¿®å¤çš„å·®ä¸å¤šäº†ï¼Œå‰©ä¸€ä¸ªDataä¸€ç›´å¯¹ä¸ä¸Šã€‚æ²¡æ‹›äº†å»æ‰¾å‡ºé¢˜äººäº¤æµï¼Œç»“æœå‘ç°æ˜¯upxç‰¹å¾æ®µçš„é—®é¢˜ğŸ« ä¸€ä¸ªæœˆäº†ç»ˆäºè§£å‡ºè¿™é“é¢˜äº†ğŸ˜­å¤ªå¥½äº†ï¼Œç»ˆäºæ˜¯akè¿‡çš„äººäº†ğŸ˜­ 0xGame2025ä¹Ÿæ˜¯å¼€æ‰“äº†ï¼Œé æ–°ç”Ÿèµ›æ”’ç»éªŒè¿™ä¸€å—( æƒ³ç€æ¥ä¸‹æ¥æœé€†å‘å¼€å‘è¿™ä¸€å—å­¦å­¦ï¼Œå‘ç°è¿™ä¸€ç±»ç¬”è®°åº”è¯¥å½’ä¸ºå¼€å‘è€Œä¸æ˜¯é€†å‘ğŸ¤”æ‰€ä»¥åˆå¼€äº†ä¸€ä¸ªæ–°åˆ†ç±»ã€‚ å“ˆåŸºç±³çš„ï¼Œè€æ˜¯æ„Ÿè§‰è‡ªå·±æ‡‚å¾—å¤ªå°‘äº†ï¼Œä½†æ˜¯åˆä¸çŸ¥é“ä»å“ªé‡Œå¼€å§‹å­¦è¿™äº›çŸ¥è¯†ğŸ˜­ week32 (2025.10.6-2025.10.12) è¿™å‘¨å¥½åƒæ²¡ä»€ä¹ˆå¯ä»¥å†™çš„ğŸ«¥ä¸€åŠæ”¾å‡ä¸€åŠä¸Šè¯¾çš„ï¼Œæœ‰ç‚¹å‰²è£‚æ„Ÿ 0xGameweek1å’ŒMoectfçš„WriteUPä¹Ÿæ˜¯æ”¾ä¸Šäº†ã€‚è¿™å‘¨ä¸»è¦åœ¨åš0xGameè¿˜æœ‰?CTFçš„é¢˜ï¼Œå‘¨æœ«æœ‰ä¸ªç¾ŠåŸæ¯å¯ä»¥æ‰“ï¼Œä½†æ˜¯å›½åº†ç©è¿‡å¤´äº†æ²¡æŠ¥ä¸ŠåğŸ«¥è¿˜æœ‰ä¸ªé¢†èˆªæ¯æ¥ç€ï¼Œè¿™ä¸ªæˆªæ­¢çš„æ›´æ—©ï¼Œ9.29æˆªæ­¢çš„ï¼Œæ²¡æ³¨æ„çœ‹æ—¶é—´ä¹Ÿé”™è¿‡äº†ğŸ«  å¥½æƒ³è«åå…¶å¦™çš„å“ˆå‡ ä¸‹æ°”ğŸ«¥ week33 (2025.10.13-2025.10.19) è¿™å‘¨è¿˜æ˜¯ä¸»è¦åš0xGameå’Œ?CTFçš„é¢˜ã€‚ç›®å‰ä¸¤ä¸ªæ¯”èµ›week1week2çš„é¢˜ç›®æ˜¯éƒ½åšå‡ºæ¥äº†ï¼Œä½†æ˜¯å€Ÿç”¨äº†ä¸å±äºè‡ªå·±çš„åŠ›é‡( åŠ å¯†ç®—æ³•é€†å‘å’Œè„šæœ¬è¿™å—è¿˜æ˜¯å¾—ç»ƒå•ŠğŸ«  å‘¨æœ«æ‰“äº†å¼ºç½‘æ¯ï¼Œæ‹¼å°½å…¨åŠ›æ— æ³•æˆ˜èƒœï¼Œåªåšå‡ºäº†ä¸€é“Reç®€å•é¢˜ï¼Œè„šæœ¬è¿˜æ˜¯AIæ¢­çš„ğŸ«  week34 (2025.10.20-2025.10.26) è¿™å‘¨æ‰çŠ¶æ€äº†ã€‚0xGameweek3ä¸Šéš¾åº¦äº†ï¼Œå·®ç‚¹æ²¡åšå®Œï¼ˆCalamaity_Fortneå› ä¸ºæ•°æ®æå–é”™è¯¯æ²¡åŠæ—¶è§£å‡ºæ¥ğŸ˜­ï¼‰ï¼Œweek4æ›´æ˜¯æœ‰ç‚¹é­”é¬¼ï¼ˆé¢˜ç›®éƒ½å¥½æŠ½è±¡ ?CTFweek3å¼€å§‹æ²¡æ‰“äº†ï¼ŒèŠ‚å¥æœ‰ç‚¹ä¹±äº†ï¼ŒWPæ²¡æœ‰åŠæ—¶å†™ç§¯äº†å¥½å¤šï¼ˆ0xGameweek3å’Œ?CTFweek1ã€2ï¼‰ï¼ŒåŠ ä¸Šèµ›é¢˜éš¾åº¦å¼€å§‹ä¸Šæ¥äº†ï¼Œæ‰€ä»¥å®åœ¨å¿™ä¸è¿‡æ¥ï¼Œæ›´åˆ«è¯´è¿˜æœ‰å­¦ä¸š ğŸ˜­ğŸ˜­ğŸ« ğŸ« ğŸ«¥ğŸ«¥","link":"/2025/10/05/week31-week34/"},{"title":"week35-week39","text":"2025å¹´11æœˆç¯‡ week35 (2025.10.27-2025.11.2) 0xGameçš„æœ€åä¸€å‘¨ï¼Œåœ¨AIçš„å¸®åŠ©ä¸‹ä¹Ÿæ˜¯å…¨è§£å‡ºæ¥äº†ã€‚è¿™å‘¨é¢˜ç›®æŒºå¥½ç©çš„ï¼Œæœ‰Unityé€†å‘æ”¹æ¸¸æˆæœºåˆ¶å’Œä»¿çœŸï¼ˆä¸ªäººè®¤ä¸ºï¼‰çš„é¢˜ç›®ï¼ˆå›¾åƒåŠ å¯†ç¨‹åºå’Œç½‘ç»œé€šä¿¡ç¨‹åºï¼‰ä»€ä¹ˆçš„ï¼Œå‡½æ•°é‡å†™ä¹Ÿæ˜¯å‡ºç°äº†å‡ æ¬¡ï¼Œå­¦ä¹ åˆ°äº†ğŸ˜‹ å‘¨äºŒæ¯”èµ›ç»“æŸåæ‘†çƒ‚äº†ï¼Œweek4WriteUpè¿˜æ²¡å†™ï¼Œ?CTFweek4ä¹Ÿæ²¡å»çœ‹ï¼Œç­‰å¤ç°å¥½äº†ã€‚GeekChallengesæ™šç‚¹å†åš å‘¨æœ«é—²å¾—æ— èŠåœ¨ZLibä¸Šæ‰¾åˆ°äº†å‡ æœ¬ä¹¦ï¼Œé€†å‘å·¥ç¨‹å®æˆ˜(BruceÂ·Dang)è¿˜æœ‰ç¨‹åºå‘˜çš„è‡ªæˆ‘ä¿®å…»è¿™ä¸¤æœ¬æ„Ÿè§‰å†™å¾—æŒºå¥½çš„ï¼Œç¬¦åˆæˆ‘ç°åœ¨çš„å­¦ä¹ éœ€æ±‚ğŸ˜‹ week36 (2025.11.3-2025.11.9) è¿™å‘¨æœ‰ç‚¹æ‘†çƒ‚äº†ğŸ™ˆğŸ™ˆğŸ™ˆæ²¡ä»€ä¹ˆå¯ä»¥å†™çš„ ç›®å‰0xGame2025week4WriteUpè¿˜æœ‰2.5é¢˜æ²¡æœ‰å†™ï¼Œäº‰å–ä¸‹å‘¨å¯ä»¥ç»“æŸè¿™ä»¶äº‹ å¯¹äº†è¿™å‘¨è¿˜å°è¯•äº†å¤ç°æ¹¾åŒºæ¯ï¼Œä½†æ˜¯å‘ç°strangappçš„è¿è¡Œç¯å¢ƒæ­ä¸èµ·æ¥ğŸ˜¡ğŸ˜¡ğŸ˜¡å‘¨æœ«ä¹Ÿæ²¡æœ‰å¤„ç†è¿™äº‹ åæ€åæ€ç…®å•µçš„ç”Ÿæ´»ï¼Œæœ‰ç‚¹å¤ªæ— èŠäº†ï¼Œä»¥è‡³äºæ€»æ˜¯åœ¨çŸ­è§†é¢‘é‡Œéº»ç—¹è‡ªå·±ã€‚æ‰€ä»¥è¿™å‘¨æœ«ç…®å•µä¸‹è¡€æœ¬ä¹°äº†å°ç”µé’¢æ¥ä¸°å¯Œä¸°å¯Œç”Ÿæ´»ï¼ˆ è¿˜æœ‰å¬è¯´æœ€è¿‘PCLå’ŒHMCLå‡ºäº†è”æœºåŠŸèƒ½ï¼Œå‘¨æœ«å’Œæœ‹å‹è¯•ç€è”æœºäº†ä¸€ä¸‹ï¼Œå¤ªå¥½äº†ç…®å•µä¹Ÿæ˜¯ç»ˆäºæœ‰ä¸ªæœ‰ç‚¹å…´è¶£ç©çš„æ¸¸æˆäº†ğŸ˜‹ğŸ˜‹ğŸ˜‹ è¿™å‘¨è™½ç„¶è¯´æ²¡ä»€ä¹ˆæŠ€æœ¯ä¸Šçš„æ”¶è·ï¼Œä½†æ˜¯ç…®å•µæ„Ÿè§‰äººç”Ÿåˆä¸°å¯Œäº†ä¸€ç‚¹ğŸ± week37 (2025.11.10-2025.11.16) å¥½å§è¿™å‘¨çœ‹èµ·æ¥æ›´æ‘†ä¸€ç‚¹ï¼ŒX2cçš„å‡é˜Ÿè€ƒæ ¸å·²ç»å¼€å§‹äº†ï¼Œä½†æ˜¯ç…®å•µè¿˜æ²¡æœ‰åšå¥½å‡†å¤‡ğŸ˜¶â€ğŸŒ«ï¸ğŸ˜¶â€ğŸŒ«ï¸ğŸ˜¶â€ğŸŒ«ï¸å¯ä»¥çš„è¯ï¼Œè®¡åˆ’ä¸‹å‘¨è¡¥å……ç‚¹SMCå’Œfridahookçš„çŸ¥è¯†å†å»å‚åŠ è€ƒæ ¸ï¼ˆä¸»è¦è¿˜æ˜¯è„šæœ¬è¿™ä¸€å—ğŸ™ˆï¼‰ 0xGame2025week4WriteUpè¿˜å‰©2é¢˜ï¼Œä¸»è¦æ˜¯é¢˜ç›®è¿˜æ˜¯æœ‰ç‚¹å¤æ‚åº¦åœ¨çš„ï¼Œè¦æè¿°å‡ºä¸€æ¡æ¯”è¾ƒæ¸…æ™°çš„æ€è·¯æœ‰ç‚¹éš¾åº¦ã€‚ä½†æ˜¯å·²ç»æŠŠå†™å®Œçš„éƒ¨åˆ†æ”¾å‡ºæ¥äº† week38 (2025.11.17-2025.11.23) OKè¿™å‘¨ä¹Ÿæ˜¯æˆåŠŸå†™å®Œäº†0xGame2025week4WriteUp(ï½ï¿£â–½ï¿£)ï½ è¿™å‘¨å‚åŠ äº†å‡é˜Ÿè€ƒæ ¸ï¼ŒæˆåŠŸå‡é˜Ÿäº†(ï½ï¿£â–½ï¿£)ï½ å”‰ï¼Œè€ƒæ ¸å…¶å®å¹¶ä¸éš¾ï¼Œä½†æ˜¯å‚åŠ è€ƒæ ¸å‰æˆ‘ä¸€ç›´åœ¨çŠ¹è±«ï¼Œæ€»æ˜¯è®¾æƒ³è‡ªå·±ç¦»é€šè¿‡è€ƒæ ¸çš„æ ‡å‡†è¿˜å·®å¤ªè¿œã€‚è¿™å‡ ä¹å°±æ˜¯æˆ‘é•¿æœŸä»¥æ¥çš„é—®é¢˜ï¼Œåœ¨æ²¡æœ‰çœŸæ­£æ¥è§¦ä¸€ä»¶äº‹ç‰©çš„æ—¶å€™æ€»çˆ±è®¾æƒ³ï¼Œæ€»æ˜¯ç¼ºä¹å†²åŠ¨çš„å‹‡æ°”ğŸ˜¶â€ğŸŒ«ï¸ç”Ÿæ´»ä¸Šä¹Ÿæ˜¯ï¼Œæ˜æ˜æ„Ÿå—åˆ°äº†å®¿èˆä¸é€‚åˆå­¦ä¹ ï¼Œä½†æ˜¯åœ¨ä¸€ç‚¹ç‚¹çš„ä¸ç†æƒ³ï¼ˆæ¯”å¦‚èµ·åºŠæ™šäº†ã€æ‰‹æœºç©è¿‡å¤´å¿˜äº†æ—¶é—´äº†ï¼‰çš„å½±å“ä¸‹è¿˜æ˜¯ä¼šæ‰“æ¶ˆå‡ºå»è‡ªä¹ çš„å¿µå¤´ğŸ˜¶â€ğŸŒ«ï¸å…«æœˆä»½çš„å…¥é˜Ÿè€ƒæ ¸å’Œè¿™å‘¨çš„å‡é˜Ÿè€ƒæ ¸éƒ½ä¸€æ ·ï¼Œå…¶å®éƒ½æ˜¯sprengå¸ˆå‚…å…ˆæ¥æ‰¾æˆ‘äº†ï¼Œä¹‹åæˆ‘æ‰å»å‚åŠ çš„è€ƒæ ¸ğŸ˜¶â€ğŸŒ«ï¸å¼€å­¦åˆ°ç°åœ¨å¿«3ä¸ªæœˆäº†ï¼ŒåŠä¸ªå­¦æœŸä¹Ÿè¿‡å»äº†ï¼Œé™¤äº†å‚åŠ äº†å‡ åœºæ¯”èµ›ç§¯æ”’äº†äº›ç»éªŒï¼ŒçœŸçš„æ˜¯æ²¡æœ‰å…¶ä»–æ”¶è·äº†ï¼ŒçœŸå°±å’Œä¹‹å‰æƒ³çš„ä¸€æ ·ç¡®å®æ²¡æœ‰æš‘å‡å­¦çš„å¤šğŸ«¥å­¦ä¸šä¸Šå…¶å®ä¹Ÿè½ä¸‹äº†å¥½å¤šï¼Œæ²¡æœ‰ä¸€é—¨è¯¾è®°äº†ç¬”è®°ï¼Œå†™ä½œä¸šå‰è¿˜å¾—å…ˆç¿»ä¹¦ï¼Œé¢˜å†™ä¸å‡ºæ¥è¿˜å¾—æœé¢˜ğŸ«¥è¿˜æœ‰ä¸€äº›å°é¡¹ç›®å°ç‚¹å­ä¹Ÿæ˜¯è¿Ÿè¿Ÿæ²¡åŠ¨æ‰‹å»å†™ğŸ«¥ä¸Šäº†å¤§å­¦è¶Šæ´»è¶Šæ··ä¹±äº†å±äºæ˜¯ week39 (2025.11.24-2025.11.30) å‘¨å…­æ‰“äº†å¤å‰‘å±±ï¼Œæ‹‰äº†å¨å¤§çš„(ï¿£_ï¿£|||)ï¼Œå…¨é springå’Œecxä¸¤ä½å¸ˆå‚…å¸¦é£äº†ï¼ŒDamnï¼Œè¿˜å¾—ç»ƒå•ŠğŸ«  emmmï¼Œè¿™å‘¨æ²¡å­¦ä»€ä¹ˆè¯´æ˜¯ï¼_ï¼bï¼Œçº¯æ‘†äº†ï¼ŒçŠ¶æ€å¼€å§‹ä¸å¯¹åŠ²èµ·æ¥äº† æœ€è¿‘ç­¹åˆ’ç€ç”¨mkdocsç»™é€†å‘ç¬”è®°æ­ä¸ªä¸“é—¨çš„é¡µé¢","link":"/2025/11/03/week35-week39/"},{"title":"Moectf2025ReverseWriteUp","text":"Moectf2025 Reverseæ–¹å‘å…¨è§£&amp;è¯¦è§£ week1upx é™„ä»¶ç¨‹åºç”¨010editoræ‰“å¼€ï¼Œå¯ä»¥çœ‹åˆ°upxç‰ˆæœ¬ï¼Œå¯ä»¥æ‰¾å¯¹åº”ç‰ˆæœ¬upxç¨‹åºè„±å£³ï¼Œä¹Ÿå¯ä»¥æ‰‹åŠ¨è„±å£³ï¼ˆé‡‡ç”¨å†…å­˜é•œåƒæ³•ï¼‰ï¼š ç”¨x64dbgæ‰“å¼€ç¨‹åºï¼Œå…ˆç§»é™¤é¢„è®¾æ–­ç‚¹ åœ¨â€œå†…å­˜æ˜ å°„â€çª—å£ç»™ç¨‹åºçš„.rsrcæ®µä¸‹ä¸€æ¬¡æ€§å†…å­˜è®¿é—®æ–­ç‚¹ï¼ŒF9è¿è¡Œ ç„¶ååœ¨UPX0æ®µæˆ–è€…UPX1æ®µä¸‹ä¸€æ¬¡æ€§å†…å­˜å†™å…¥æ–­ç‚¹ï¼ŒF9è¿è¡Œ å›åˆ°â€œCPUâ€çª—å£ï¼Œå¯ä»¥çœ‹åˆ°åœ¨RIPä¸è¿œå¤„æœ‰ä¸€ä¸ªå¤§è·³ï¼ˆRIPåœ¨0x00007FF7BB887423å¤„) è·Ÿè¿›å»ï¼Œè¿˜æœ‰ä¸ªè·³è½¬è¡¨ï¼Œç»§ç»­è·Ÿè¿›ï¼Œå¯ä»¥çœ‹åˆ°ç¨‹åºçš„OEPäº† ç„¶ååœ¨æ­¤å¤„ä½¿ç”¨scylla dumpå‡ºç¨‹åºï¼Œå¹¶ä¸”ä¿®å¤IATï¼Œå¾—åˆ°upx_dump_SCY.exeï¼Œå¯ä»¥åˆ†æäº† åˆ†æmainå‡½æ•°ï¼Œå‘ç°æ¯ä¸ªè¾“å…¥çš„å­—ç¬¦å¼‚æˆ–äº†0x21ï¼Œè€Œéæœ«ä½å­—ç¬¦è¿˜å¼‚æˆ–äº†åŸæ¥çš„ä¸‹ä¸€ä½ã€‚ç”±äºå¼‚æˆ–æœ‰äº¤æ¢å¾‹ï¼Œæ‰€ä»¥è§£å¯†é€»è¾‘å¯ä»¥æ˜¯ï¼šå…ˆå¯¹æ¯ä¸ªå¤„ç†å®Œçš„å­—ç¬¦å¼‚æˆ–0x21ï¼Œç„¶åå†ä»å€’æ•°ç¬¬äºŒä½å¼€å§‹å’Œä¸‹ä¸€ä½å¼‚æˆ–ï¼Œè¿™æ ·å°±æ¢å¤äº†å¤åŸå‡ºäº†flagï¼ˆä½†æ˜¯ç»™çš„å¯†æ–‡å°‘äº†æœ€åä¸€ä½ï¼Œå³å­—ç¬¦ä¸²çš„ç»“æŸç¬¦ã€‚æ ¹æ®æœ€åä¸€ä½å’Œå€’æ•°ç¬¬äºŒä½çš„å…³ç³»0x56=125 ^ 0x21 ^ æœ«ä½ å¾—å‡ºï¼šæœ«ä½=10ï¼Œæ‰€ä»¥æœ«ä½^0x21=43ï¼Œå°†å¯†æ–‡è¡¥å……å®Œæ•´ï¼‰ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980//mainå‡½æ•°__int64 sub_7FF6FC2718A0(){ char *v0; // rdi __int64 i; // rcx FILE *Stream; // rax _BYTE v4[32]; // [rsp+0h] [rbp-20h] BYREF char v5; // [rsp+20h] [rbp+0h] BYREF _DWORD cipher[44]; // [rsp+30h] [rbp+10h] char flag[132]; // [rsp+E0h] [rbp+C0h] BYREF int length; // [rsp+164h] [rbp+144h] _BYTE v9[60]; // [rsp+188h] [rbp+168h] int j; // [rsp+1C4h] [rbp+1A4h] int Char; // [rsp+1E4h] [rbp+1C4h] int k; // [rsp+204h] [rbp+1E4h] v0 = &amp;v5; for ( i = 130LL; i; --i ) { *(_DWORD *)v0 = -858993460; v0 += 4; } sub_7FF6FC271375((__int64)&amp;word_7FF6FC28200E); cipher[0] = 35; cipher[1] = 43; cipher[2] = 39; cipher[3] = 54; cipher[4] = 51; cipher[5] = 60; cipher[6] = 3; cipher[7] = 72; cipher[8] = 100; cipher[9] = 11; cipher[10] = 29; cipher[11] = 118; cipher[12] = 123; cipher[13] = 16; cipher[14] = 11; cipher[15] = 58; cipher[16] = 63; cipher[17] = 101; cipher[18] = 118; cipher[19] = 41; cipher[20] = 21; cipher[21] = 55; cipher[22] = 28; cipher[23] = 10; cipher[24] = 8; cipher[25] = 33; cipher[26] = 62; cipher[27] = 60; cipher[28] = 61; cipher[29] = 22; cipher[30] = 11; cipher[31] = 36; cipher[32] = 41; cipher[33] = 36; cipher[34] = 86; sub_7FF6FC27119F((__int64)aPleaseInputYou); // &quot;please input your flag: &quot; Stream = _acrt_iob_func(0); fgets(flag, 100, Stream); length = j_strlen(flag); for ( j = 0; j &lt; length; ++j ) { Char = flag[j] ^ 0x21; if ( j &lt; length - 1 ) Char ^= flag[j + 1]; v9[j] = Char; } for ( k = 0; k &lt; 35; ++k ) { if ( (char)v9[k] != cipher[k] ) { sub_7FF6FC27119F((__int64)aYouWillNeverGe);// &quot;you will never get the flag!!!!\\n&quot; break; } } sub_7FF6FC271311(v4, qword_7FF6FC27AD00); return 0LL;} è§£å¯†è„šæœ¬ï¼š 123456789101112131415enc=[ 0x23, 0x2b, 0x27, 0x36, 0x33, 0x3c, 0x03, 0x48, 0x64, 0x0b, 0x1d, 0x76, 0x7b, 0x10, 0x0b, 0x3a, 0x3f, 0x65, 0x76, 0x29, 0x15, 0x37, 0x1c, 0x0a, 0x08, 0x21, 0x3e, 0x3c, 0x3d, 0x16, 0x0b, 0x24, 0x29, 0x24, 0x56, 43 ]xored=[]for i in range(len(enc)): xored.append(enc[i]^0x21)#print(xored)for i in range(len(xored)-2,-1,-1): xored[i]=xored[i]^xored[i+1]flag=''.join(chr(i) for i in xored)print(flag) maze é™„ä»¶ç¨‹åºmainå‡½æ•°é€»è¾‘å¦‚ä¸‹ï¼Œwasdè¿·å®«é¢˜ï¼Œè¿·å®«åœ¨å‡½æ•°maze_initä¸­ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394int __fastcall main(int argc, const char **argv, const char **envp){ unsigned __int64 count; // rax int v4; // ebx __int64 index; // r9 int v6; // r11d unsigned __int64 y; // r8 __int64 x; // r10 unsigned __int64 n0x37_1; // rdi char *Format; // rcx _BYTE flag[1008]; // [rsp+20h] [rbp-408h] maze_init(); printf(asc_140004138); printf(&amp;Format_); while ( 1 ) {LABEL_2: while ( 1 ) { printf(asc_140004190); scanf(&quot;%s&quot;); count = -1LL; do ++count; while ( flag[count] ); if ( count &lt;= 999 ) break; printf(&amp;Format__0); } v4 = 1; index = 0LL; v6 = 1; y = 1LL;// èµ·ç‚¹y x = 1LL;// èµ·ç‚¹x if ( (int)count &gt; 0 ) break;LABEL_19: Format = (char *)&amp;byte_140004118;LABEL_20: printf(Format); printf(&amp;Format__1); } n0x37_1 = 1LL; while ( 1 ) { switch ( flag[index] ) { case 'A': case 'a': --v4; --x; --n0x37_1; break; case 'D': case 'd': ++v4; ++x; ++n0x37_1; break; case 'S': case 's': ++v6; ++y; break; case 'W': case 'w': --v6; --y; break; default: printf(&amp;Format__2); printf(&amp;Format__1); goto LABEL_2; } if ( y &gt; 0x37 || n0x37_1 &gt; 0x37 ) { Format = (char *)&amp;unk_1400040D8; goto LABEL_20; } if ( byte_140005660[56 * y + x] == 49 ) { Format = (char *)&amp;unk_1400040F8; goto LABEL_20; } if ( y == 15 &amp;&amp; x == 32 ) break; if ( ++index &gt;= (int)count ) goto LABEL_19; } printf(asc_1400041E0); printf(&quot;moectf{%s}\\n&quot;); return 0;} maze_initå‡½æ•°ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116__int64 maze_init(){ const char *all_1; // r9 const char **v1; // rbx int n56_2; // r11d __int64 v3; // r10 __int64 n56; // rax int v5; // r8d __int64 i; // rax char v7; // dl __int64 v8; // rcx _QWORD v9[56]; // [rsp+20h] [rbp-E0h] BYREF v9[1] = &quot;10100000000000000010000011011101011111111101011100000111&quot;; all_1 = &quot;11111111111111111111111111111111111111111111111111111111&quot;; v9[0] = &quot;11111111111111111111111111111111111111111111111111111111&quot;; v9[2] = &quot;10111010111111111010111011000001000001000001000101110111&quot;; v9[3] = &quot;10000010000010000010001011011111111101110111011101110111&quot;; v9[4] = &quot;10111111111011101110111011010000000000010100010001110111&quot;; v9[5] = &quot;10100000001000101000100011010101111111011101110101110111&quot;; v9[6] = &quot;10101011111110111011101011010101000001000000010101110111&quot;; v9[7] = &quot;10101010000010100000101011110101110101111101111111110111&quot;; v9[8] = &quot;10111010111010101111101011100101000100000101000101110111&quot;; v9[9] = &quot;10000010001010001000001011001111011111010101011101110111&quot;; v9[10] = &quot;11111011101011111011111111101000100000101100101001110111&quot;; v9[11] = &quot;10001010001000100010000010001010011000100010010011000001&quot;; v9[12] = &quot;10111010111110101010111011011001011111010101011101011101&quot;; v9[13] = &quot;10001010001000001010001011000101000100000101000101011101&quot;; v9[14] = &quot;11101011101111111011101011110101110111111101110101011101&quot;; v9[15] = &quot;10001000101000001010001011000100010100000101000101011101&quot;; v9[16] = &quot;10111111101011101110111011011111110101110111011101011101&quot;; v9[17] = &quot;10001000001000100000001011000100000100010000000101011001&quot;; v9[18] = &quot;11101011111011111111101011110101111101111111110101011011&quot;; v9[19] = &quot;10101000000010001000101011010100000001000100010101011011&quot;; v9[20] = &quot;10101111111110101010101011010111111111010101010101011011&quot;; v9[21] = &quot;10100000000000100010101011010000000000010001010101011011&quot;; v9[22] = &quot;10111111111111111110111011011111111111111111011101011011&quot;; v9[23] = &quot;10000000001111000000000011110111010000111100011111011011&quot;; v9[24] = &quot;11101111100000011011011111111010110111011101100001011011&quot;; v9[25] = &quot;11101111111111111011011111111101110111101101100001011011&quot;; v9[26] = &quot;10001000111111000010000011111010110111011101100001011011&quot;; v9[27] = &quot;10111010111111111010111011110111010000111101100001010011&quot;; v9[28] = &quot;10000010000010000010001011111111111111111101100001010111&quot;; v9[29] = &quot;10111111111011101110111011110001000110001101100001010001&quot;; v9[30] = &quot;10100000001000101000100011110111011101111101100001011101&quot;; v9[31] = &quot;10101011111110111011101011110001000101111101100001011101&quot;; v9[32] = &quot;10101010000010100000101011111101011101111101100001011101&quot;; v9[33] = &quot;10111010111010101111101011110001000110001101100001011101&quot;; v9[34] = &quot;10000010001010101000001011111111111111111101100001011101&quot;; v9[35] = &quot;11111011101011111011111110000000000000001101100001011101&quot;; v9[36] = &quot;10001010001000100010000011111111111111111100110011011101&quot;; v9[37] = &quot;10111010111110101010111010010000000011111110001111011101&quot;; v9[38] = &quot;10001010001000001010001010110111000001111110100101011101&quot;; v9[39] = &quot;11101011101111111011101000110011001111111100110111011101&quot;; v9[40] = &quot;10001000101000001010001011111111111111111111110111010001&quot;; v1 = (const char **)v9; v9[55] = &quot;11111111111111111111111111111111111111111111111111111111&quot;; v9[41] = &quot;10111111101011101110111010100001001100000000000011011011&quot;; n56_2 = 0; v9[42] = &quot;10001000001000100000001011111111111101011101111001011011&quot;; v3 = 0LL; v9[43] = &quot;10101011111011111111101011000000000001000100010111011011&quot;; v9[44] = &quot;10101000000010001000101010010111111111111111111111011011&quot;; v9[45] = &quot;10101111111110101010101010110111111111111111111101011011&quot;; v9[46] = &quot;10100000000000100010101011100000000000000000000011011011&quot;; v9[47] = &quot;10111111111111111110011011111111111111111111111011011011&quot;; v9[48] = &quot;10000011111111111111000010000000000000000000000000011001&quot;; v9[49] = &quot;11111011111111111111111111111111111111111111111111111101&quot;; v9[50] = &quot;11111011100001100110110111000000000000000000000111111101&quot;; v9[51] = &quot;11111011101111011010000111011111111111111111110111111101&quot;; v9[52] = &quot;11111011100001000010110110000111111111111111110000000001&quot;; v9[53] = &quot;11111011101111011010110111101111111111111111111111111111&quot;; v9[54] = &quot;11110000000000011000110000000000000000000000000000000011&quot;; while ( 1 ) { n56 = -1LL; do ++n56; while ( all_1[n56] ); if ( n56 != 56 ) { printf((char *)&amp;Format__3); exit(1); } v5 = 0; for ( i = 0LL; i &lt; 56; ++i ) { v7 = all_1[i]; if ( (unsigned __int8)(v7 - 48) &gt; 1u ) { printf((char *)&amp;Format__4); exit(1); } v8 = v3 + i; ++v5; byte_140005660[v8] = v7; } ++n56_2; ++v1; v3 += 56LL; if ( n56_2 &gt;= 56 ) break; all_1 = *v1; } if ( n48 != 48 ) { printf((char *)&amp;Format); exit(1); } if ( n48_0 != 48 ) { printf((char *)&amp;Format__5); exit(1); } return i;} ä½¿ç”¨ç¥å¥‡å¦™å¦™å·¥å…·å¾—åˆ°è¿·å®«è·¯å¾„ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122from mycode import mazeMaze = [ &quot;11111111111111111111111111111111111111111111111111111111&quot;, &quot;10100000000000000010000011011101011111111101011100000111&quot;, &quot;10111010111111111010111011000001000001000001000101110111&quot;, &quot;10000010000010000010001011011111111101110111011101110111&quot;, &quot;10111111111011101110111011010000000000010100010001110111&quot;, &quot;10100000001000101000100011010101111111011101110101110111&quot;, &quot;10101011111110111011101011010101000001000000010101110111&quot;, &quot;10101010000010100000101011110101110101111101111111110111&quot;, &quot;10111010111010101111101011100101000100000101000101110111&quot;, &quot;10000010001010001000001011001111011111010101011101110111&quot;, &quot;11111011101011111011111111101000100000101100101001110111&quot;, &quot;10001010001000100010000010001010011000100010010011000001&quot;, &quot;10111010111110101010111011011001011111010101011101011101&quot;, &quot;10001010001000001010001011000101000100000101000101011101&quot;, &quot;11101011101111111011101011110101110111111101110101011101&quot;, &quot;10001000101000001010001011000100010100000101000101011101&quot;, &quot;10111111101011101110111011011111110101110111011101011101&quot;, &quot;10001000001000100000001011000100000100010000000101011001&quot;, &quot;11101011111011111111101011110101111101111111110101011011&quot;, &quot;10101000000010001000101011010100000001000100010101011011&quot;, &quot;10101111111110101010101011010111111111010101010101011011&quot;, &quot;10100000000000100010101011010000000000010001010101011011&quot;, &quot;10111111111111111110111011011111111111111111011101011011&quot;, &quot;10000000001111000000000011110111010000111100011111011011&quot;, &quot;11101111100000011011011111111010110111011101100001011011&quot;, &quot;11101111111111111011011111111101110111101101100001011011&quot;, &quot;10001000111111000010000011111010110111011101100001011011&quot;, &quot;10111010111111111010111011110111010000111101100001010011&quot;, &quot;10000010000010000010001011111111111111111101100001010111&quot;, &quot;10111111111011101110111011110001000110001101100001010001&quot;, &quot;10100000001000101000100011110111011101111101100001011101&quot;, &quot;10101011111110111011101011110001000101111101100001011101&quot;, &quot;10101010000010100000101011111101011101111101100001011101&quot;, &quot;10111010111010101111101011110001000110001101100001011101&quot;, &quot;10000010001010101000001011111111111111111101100001011101&quot;, &quot;11111011101011111011111110000000000000001101100001011101&quot;, &quot;10001010001000100010000011111111111111111100110011011101&quot;, &quot;10111010111110101010111010010000000011111110001111011101&quot;, &quot;10001010001000001010001010110111000001111110100101011101&quot;, &quot;11101011101111111011101000110011001111111100110111011101&quot;, &quot;10001000101000001010001011111111111111111111110111010001&quot;, &quot;10111111101011101110111010100001001100000000000011011011&quot;, &quot;10001000001000100000001011111111111101011101111001011011&quot;, &quot;10101011111011111111101011000000000001000100010111011011&quot;, &quot;10101000000010001000101010010111111111111111111111011011&quot;, &quot;10101111111110101010101010110111111111111111111101011011&quot;, &quot;10100000000000100010101011100000000000000000000011011011&quot;, &quot;10111111111111111110011011111111111111111111111011011011&quot;, &quot;10000011111111111111000010000000000000000000000000011001&quot;, &quot;11111011111111111111111111111111111111111111111111111101&quot;, &quot;11111011100001100110110111000000000000000000000111111101&quot;, &quot;11111011101111011010000111011111111111111111110111111101&quot;, &quot;11111011100001000010110110000111111111111111110000000001&quot;, &quot;11111011101111011010110111101111111111111111111111111111&quot;, &quot;11110000000000011000110000000000000000000000000000000011&quot;, &quot;11111111111111111111111111111111111111111111111111111111&quot;]start=(1,1)end=(15,32)path=maze.solve(Maze,start,end)print(path)#mycode.maze:from collections import dequedef solve(maze, start, end, directions=None, wall='1', free='0'): &quot;&quot;&quot; å‚æ•°: maze: äºŒç»´å­—ç¬¦ä¸²åˆ—è¡¨ start: èµ·ç‚¹åæ ‡ (row, col) end: ç»ˆç‚¹åæ ‡ (row, col) directions: è‡ªå®šä¹‰æ–¹å‘æŒ‡ä»¤ (é»˜è®¤WASD) wall: å¢™å­—ç¬¦ (é»˜è®¤'1') free: é€šè·¯å­—ç¬¦ (é»˜è®¤'0') è¿”å›: ç§»åŠ¨æŒ‡ä»¤å­—ç¬¦ä¸² æˆ– None(æ— è§£) &quot;&quot;&quot; if directions is None: directions = { 'W': (-1, 0), # ä¸Š 'A': (0, -1), # å·¦ 'S': (1, 0), # ä¸‹ 'D': (0, 1) # å³ } rows, cols = len(maze), len(maze[0]) # åæ ‡éªŒè¯ def is_valid(pos): r, c = pos return (0 &lt;= r &lt; rows and 0 &lt;= c &lt; cols and maze[r][c] == free) if not is_valid(start): raise ValueError(f&quot;æ— æ•ˆèµ·ç‚¹ {start}&quot;) if not is_valid(end): raise ValueError(f&quot;æ— æ•ˆç»ˆç‚¹ {end}&quot;) # BFSæ ¸å¿ƒï¼ˆä¿®å¤äº†å˜é‡åå†²çªï¼‰ queue = deque([(start[0], start[1], &quot;&quot;)]) visited = set([(start[0], start[1])]) while queue: row, col, current_path = queue.popleft() # æ”¹åä¸º current_path if (row, col) == end: return current_path for move, (dr, dc) in directions.items(): new_row, new_col = row + dr, col + dc if (0 &lt;= new_row &lt; rows and 0 &lt;= new_col &lt; cols and maze[new_row][new_col] == free and # ä½¿ç”¨é€šè·¯å­—ç¬¦ free (new_row, new_col) not in visited): visited.add((new_row, new_col)) queue.append((new_row, new_col, current_path + move)) # ä½¿ç”¨ current_path return None # æ— è§£ flower é™„ä»¶ç¨‹åºç”¨IDAæ‰“å¼€ï¼Œåœ¨æ±‡ç¼–ç•Œé¢ä¸Šä¸‹æ»‘åŠ¨å¯ä»¥æ‰¾åˆ°èŠ±æŒ‡ä»¤å¼•èµ·çš„çº¢è‰²æ ˆå¸§æŠ¥é”™ã€‚æ‰“å¼€IDAå·¥å…·æ çš„â€œOptionsâ€é€‰é¡¹çš„â€œGeneralâ€ï¼Œå‹¾é€‰â€œStackpointerâ€ï¼Œå¯ä»¥çœ‹åˆ°æ ˆå¸§ä¿¡æ¯ å¯ä»¥çœ‹åˆ°çº¢è‰²æŠ¥é”™çš„å‡½æ•°æ ˆå¸§è¶…è¿‡äº†1000ï¼Œæœ‰ç‚¹åå¸¸ï¼Œæ‰¾åˆ°æ ˆå¸§å‘ç”Ÿçªå˜çš„åœ°æ–¹ï¼Œå‘ç°ç”¨sub rsp,1000hæ”¹å˜äº†æ ˆå¸§ï¼ŒæŠŠè¿™æ¡æŒ‡ä»¤nopæ‰ã€‚æœ¬é¢˜è¿™ä¸ªç±»å‹çš„èŠ±æŒ‡ä»¤å ç»å¤§å¤šæ•°ï¼Œéœ€è¦è€å¿ƒçš„ä¸€ä¸ªä¸€ä¸ªnopæ‰ã€‚ï¼ˆè¿˜æœ‰sub rsp,400hçš„ï¼Œä¸»è¦ç•™æ„æ ˆå¸§å¤§äº100ï¼‰ è¿˜æœ‰å¦ä¸€ç§èŠ±æŒ‡ä»¤ï¼š å›¾ä¸­Label+1æ˜¯0x004048EFï¼Œè¢«0x004048EEå¤„çš„æŒ‡ä»¤è¦†ç›–ä½äº†ï¼Œæ‰€ä»¥undefineä¸€ä¸‹ï¼ŒIDAå°±ä¼šè‡ªåŠ¨çº é”™ã€‚æŠŠæ²¡ç”¨çš„æŒ‡ä»¤nopæ‰ æ¥ä¸‹æ¥è¦åšçš„ä¿®æ”¹æœ‰2ç‚¹ã€‚é¦–å…ˆå¯ä»¥çœ‹åˆ°0x004048E5å¤„æœ‰ä¸€ä¸ªæ’è·³èŠ±æŒ‡ä»¤ï¼Œè¿™ä¸ªè¦nopæ‰ã€‚ ç„¶åæ˜¯call loc_4048EFï¼Œç”±äºcallæ˜¯ä¼šå ç”¨æ ˆå¸§çš„ï¼Œæ›´ä½•å†µcallä¸€ä¸ªæ ‡ç­¾æ²¡æœ‰retæ¢å¤æ ˆå¸§ï¼Œåé¢æ ˆå¸§è¿˜æ˜¯ä¼šæŠ¥é”™ï¼ˆè¿™é‡Œæœ‰ä¸€ä¸ªè¯•é”™è¿‡ç¨‹ï¼Œä¸æŠŠcallæ”¹æˆjmpçš„è¯ï¼Œå‡½æ•°undefine+code+create functionåä¾æ—§åç¼–è¯‘ä¸äº†ï¼‰ã€‚åšæ³•å°±æ˜¯å·¥å…·æ edit-&gt;patch program-&gt;change byteï¼ŒæŠŠåå…­è¿›åˆ¶ç E8æ”¹æˆE9 ç„¶åå°±æ˜¯é€‰ä¸­å‡½æ•°åundefine+code+create functionäº†ï¼Œå°±å¯ä»¥æ­£å¸¸åç¼–è¯‘äº† mainå‡½æ•°é€»è¾‘ä¸»è¦æ˜¯æŠŠflagæå¤´å»å°¾ï¼Œä¸­é—´éƒ¨åˆ†åŠ å¯†åæ¯”å¯¹ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061unsigned __int64 __fastcall solve(_QWORD *flag){ char v1; // bl bool v2; // r12 __int64 v3; // rax __int64 v4; // rbx __int64 v5; // rax char *flag[i]; // rax __int64 v7; // rax char v9; // [rsp+17h] [rbp-59h] BYREF int i; // [rsp+18h] [rbp-58h] int len; // [rsp+1Ch] [rbp-54h] __int64 flag_start; // [rsp+20h] [rbp-50h] BYREF __int64 flag_end; // [rsp+28h] [rbp-48h] BYREF void *fl4g[5]; // [rsp+30h] [rbp-40h] BYREF unsigned __int64 v15; // [rsp+58h] [rbp-18h] __int64 savedregs; // [rsp+70h] [rbp+0h] BYREF v15 = __readfsqword(0x28u); v1 = 0; v2 = 1; if ( (unsigned __int64)length((__int64)flag) &gt; 7 ) { substr(fl4g, flag, 0LL, 7uLL); v1 = 1; if ( !(unsigned __int8)cmp((__int64)fl4g, (__int64)&quot;moectf{&quot;) &amp;&amp; *(_BYTE *)get_last_str(flag) == 125 ) v2 = 0; } if ( v1 ) std::string::~string(fl4g); if ( v2 ) { v3 = cout((std::ostream *)&amp;std::cout); out(v3, (__int64 (*)(void))std::endl&lt;char,std::char_traits&lt;char&gt;&gt;); } else { std::allocator&lt;char&gt;::allocator((unsigned int)&amp;savedregs - 89); flag_end = getEnd(flag); v4 = cutTail(&amp;flag_end, 1LL); flag_start = getStart((__int64)flag); v5 = cutHead(&amp;flag_start, 7LL); std::string::basic_string&lt;__gnu_cxx::__normal_iterator&lt;char *,std::string&gt;,void&gt;(fl4g, v5, v4, (__int64)&amp;v9);// æå¤´å»å°¾ std::string::operator=(flag, fl4g); std::string::~string(fl4g); std::allocator&lt;char&gt;::~allocator(); len = length((__int64)flag); if ( len == 32 ) { for ( i = 0; i &lt; len; ++i ) { flag[i] = (char *)toList(flag, i); // flag[i] if ( (unsigned int)encode(*flag[i]) != enc[i] ) break; } } v7 = cout((std::ostream *)&amp;std::cout); out(v7, (__int64 (*)(void))std::endl&lt;char,std::char_traits&lt;char&gt;&gt;); } return v15 - __readfsqword(0x28u);} åŠ å¯†å‡½æ•°encodeå¦‚ä¸‹ï¼Œå°±æ˜¯æŠŠflag[i]å’Œkeyå¼‚æˆ–ï¼Œkeyä¼šé€’å¢ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œé™æ€åˆ†æä¸‹å¾—åˆ°çš„keyæ˜¯ä¸æ­£ç¡®çš„ï¼ˆé™æ€åˆ†æå¾—åˆ°çš„keyæ˜¯0x23ï¼Œä½†æ˜¯åŠ¨æ€è°ƒè¯•ä¼šå‘ç°ç¨‹åºè¿è¡Œåˆ°æ­¤å¤„keyå˜æˆ0x29ï¼‰ï¼ŒåŠ¨è°ƒå¾—åˆ°çš„keyæ‰èƒ½è§£å¯†å‡ºflag è§£å¯†è„šæœ¬ï¼š 12345678910111213data = [ 0x4F, 0x1A, 0x59, 0x1F, 0x5B, 0x1D, 0x5D, 0x6F, 0x7B, 0x47, 0x7E, 0x44, 0x6A, 0x07, 0x59, 0x67, 0x0E, 0x52, 0x08, 0x63, 0x5C, 0x1A, 0x52, 0x1F, 0x20, 0x7B, 0x21, 0x77, 0x70, 0x25, 0x74, 0x2B]key=0x29result=[]for i in range(len(data)): plaintext=(data[i]^key)&amp;0xff key+=1 result.append(plaintext)flag=''.join(chr(x) for x in result)print(flag) tea IDAæ‰“å¼€é™„ä»¶ç¨‹åºï¼Œmainå‡½æ•°é€»è¾‘æ˜¯å°†è¾“å…¥çš„flagåˆ†æˆ10ä»½ï¼Œæ¯æ¬¡å–ä¸¤ä»½è¿›è¡ŒåŠ å¯†ï¼ŒåŠ å¯†å‡ºæ¥çš„æ•°æ®å’Œencæ¯”è¾ƒã€‚keyå’Œencå·²ç»ç»™å®š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970//mainå‡½æ•°int __fastcall main(int argc, const char **argv, const char **envp){ char *v3; // rdi __int64 i; // rcx _BYTE v6[32]; // [rsp+0h] [rbp-20h] BYREF char v7; // [rsp+20h] [rbp+0h] BYREF _DWORD key[12]; // [rsp+28h] [rbp+8h] BYREF _DWORD enc[20]; // [rsp+58h] [rbp+38h] _DWORD fl4g[20]; // [rsp+A8h] [rbp+88h] BYREF _DWORD Flag[20]; // [rsp+F8h] [rbp+D8h] BYREF char flag[64]; // [rsp+148h] [rbp+128h] BYREF size_t length; // [rsp+188h] [rbp+168h] int j; // [rsp+1A4h] [rbp+184h] unsigned int part1; // [rsp+1C8h] [rbp+1A8h] BYREF int part2; // [rsp+1CCh] [rbp+1ACh] int v17; // [rsp+1E4h] [rbp+1C4h] int k; // [rsp+204h] [rbp+1E4h] v3 = &amp;v7; for ( i = 130LL; i; --i ) { *(_DWORD *)v3 = -858993460; v3 += 4; } sub_7FF6DAA21384(byte_7FF6DAA33015); key[0] = 289739801; key[1] = 427884820; key[2] = 1363251608; key[3] = 269567252; enc[0] = 2026214571; enc[1] = 578894681; enc[2] = 1193947460; enc[3] = -229306230; enc[4] = 73202484; enc[5] = 961145356; enc[6] = -881456792; enc[7] = 358205817; enc[8] = -554069347; enc[9] = 119347883; enc[10] = 0; memset(fl4g, 0, 44uLL); memset(Flag, 0, 44uLL); printf(&amp;You_are_wrong___); scanf(&quot;%s&quot;, flag); length = j_strlen(flag); j_memcpy(fl4g, flag, length); for ( j = 0; j &lt; 5; ++j ) { part1 = fl4g[2 * j]; part2 = fl4g[2 * j + 1]; tea(&amp;part1, key);// è¿™é‡Œä¼ çš„æ˜¯åœ°å€ï¼Œteaå†…å¯ä»¥é€šè¿‡part1çš„åœ°å€å¾—åˆ°part2 Flag[2 * j] = part1; Flag[2 * j + 1] = part2; } v17 = 1; for ( k = 0; k &lt; 11; ++k ) { if ( Flag[k] != enc[k] ) { v17 = 0; printf(&quot;You are wrong!!&quot;); break; } } if ( v17 == 1 ) printf(&quot;Congratulations!!!!&quot;); sub_7FF6DAA21320(v6, &amp;unk_7FF6DAA2AE60); return 0;} åŠ å¯†å‡½æ•°æ˜¯æ”¹åŠ¨çš„teaåŠ å¯† 1234567891011121314151617181920212223__int64 __fastcall Tea(unsigned int *part1, _DWORD *key){ __int64 n4; // rax int delta; // [rsp+24h] [rbp+4h] unsigned int p1; // [rsp+44h] [rbp+24h] unsigned int p2; // [rsp+64h] [rbp+44h] int i; // [rsp+A4h] [rbp+84h] sub_7FF6DAA21384((__int64)&amp;byte_7FF6DAA33015); delta = 0; p1 = *part1; p2 = part1[1]; for ( i = 0; i &lt; 32; ++i ) { delta += 1131796; p1 += (key[1] + (p2 &gt;&gt; 5)) ^ (delta + p2) ^ (*key + 16 * p2); p2 += (key[3] + (p1 &gt;&gt; 5)) ^ (delta + p1) ^ (key[2] + 16 * p1); } *part1 = p1; n4 = 4LL; part1[1] = p2; return n4;} è§£å¯†é€»è¾‘ï¼šå°†teaå†…çš„p1 p2ä½ç½®å¯¹è°ƒï¼Œâ€+â€æ”¹æˆâ€-â€œï¼Œç„¶ådeltaä»æœ€åä¸€è½®çš„å€¼å¾€å›é€’å‡å°±å¯ä»¥äº†ã€‚è§£å¯†è„šæœ¬ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344#include&lt;stdio.h&gt;#include&lt;stdint.h&gt;void tea_decrypt(uint32_t *a,uint32_t *k) { uint32_t delta = 1131796 * 32; uint32_t p1 = *a; uint32_t p2 = *(a + 1); for (int i = 0; i &lt; 32; i++) { p2 -= ((k[3] + (p1 &gt;&gt; 5)) ^ (delta + p1) ^ (k[2] + 16 * p1)); p1 -= ((k[1] + (p2 &gt;&gt; 5)) ^ (delta + p2) ^ (*k + 16 * p2)); delta -= 1131796; } *a = p1; *(a+1)= p2;}int main() { uint32_t key[4]; uint32_t enc[11]; key[0] = 289739801; key[1] = 427884820; key[2] = 1363251608; key[3] = 269567252; enc[0] = 2026214571; enc[1] = 578894681; enc[2] = 1193947460; enc[3] = -229306230; enc[4] = 73202484; enc[5] = 961145356; enc[6] = -881456792; enc[7] = 358205817; enc[8] = -554069347; enc[9] = 119347883; enc[10] = 0; char flag[45] = { 0 }; for (int i = 0; i &lt; 5; i++) { uint32_t block[2] = {enc[2*i],enc[2*i+1]}; tea_decrypt(block, key); for (int j = 0; j &lt; 4; j++) { flag[8 * i + j] = (block[0] &gt;&gt; (j * 8)) &amp; 0xff;//å³ç§»jä¸ªå­—ç¬¦ï¼Œç„¶åå–æœ€åä¸€ä¸ª flag[8 * i + j + 4] = (block[1] &gt;&gt; (j * 8)) &amp; 0xff; } } printf(&quot;%s&quot;, flag); return 0;} ez3 é™„ä»¶ç¨‹åºmainå‡½æ•°é€»è¾‘ä¸»è¦æ˜¯è·å–flagï¼Œç„¶åæå¤´å»å°¾ï¼Œå¯¹ä¸­é—´éƒ¨åˆ†è¿›è¡Œcheckã€‚mainå‡½æ•°ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566int __fastcall main(int argc, const char **argv, const char **envp){ char v3; // bl bool v4; // r12 __int64 v5; // rbx __int64 v6; // rax char v8; // [rsp+Fh] [rbp-71h] BYREF __int64 Start; // [rsp+10h] [rbp-70h] BYREF __int64 end; // [rsp+18h] [rbp-68h] BYREF _BYTE flag[32]; // [rsp+20h] [rbp-60h] BYREF _QWORD fl4g[8]; // [rsp+40h] [rbp-40h] BYREF fl4g[5] = __readfsqword(0x28u); printf(&quot;Input your flag:\\n&gt; &quot;, argv, envp); fflush(stdout); std::string::basic_string(flag); cin(&amp;std::cin); if ( length(flag) == 42 ) { v3 = 0; v4 = 1; if ( length(flag) &gt; 7 ) { substr(fl4g, flag, 0LL, 7LL); v3 = 1; if ( !cmp(fl4g, &quot;moectf{&quot;) &amp;&amp; *get_last_str(flag) == 125 ) v4 = 0; } if ( v3 ) std::string::~string(fl4g); if ( v4 ) { puts(&quot;FORMAT ERROR!&quot;); } else { std::allocator&lt;char&gt;::allocator(&amp;v8); end = getEnd(flag); v5 = cutTail(&amp;end, 1LL); Start = getStart(flag); v6 = cutHead(&amp;Start, 7LL); std::string::basic_string&lt;__gnu_cxx::__normal_iterator&lt;char *,std::string&gt;,void&gt;(fl4g, v6, v5, &amp;v8); strcopy(flag, fl4g); std::string::~string(fl4g); std::allocator&lt;char&gt;::~allocator(&amp;v8); std::string::basic_string(fl4g, flag); LOBYTE(v5) = check(fl4g); std::string::~string(fl4g); if ( v5 ) { puts(&quot;OK&quot;); puts(&quot;But I don't know what the true flag is&quot;); } else { puts(&quot;try again~&quot;); } } } else { puts(&quot;Length error!&quot;); } std::string::~string(flag); return 0;} checkå‡½æ•°ï¼š é¢˜ç›®æç¤ºäº†z3ï¼Œæ‰€ä»¥ä½¿ç”¨z3çº¦æŸæ±‚è§£ã€‚æ€è·¯å°±æ˜¯å¤ç°checkå‡½æ•°é€»è¾‘ï¼Œçˆ†ç ´å‡ºflag è„šæœ¬ï¼š 12345678910111213141516171819202122232425262728293031from z3 import *enc = [ 0x0B1B0, 0x5678, 0x7FF2, 0xA332, 0xA0E8, 0x364C, 0x2BD4, 0xC8FE, 0x4A7C, 0x18, 0x2BE4, 0x4144, 0x3BA6, 0xBE8C, 0x8F7E, 0x35F8, 0x61AA, 0x2B4A, 0x6828, 0xB39E, 0xB542, 0x33EC, 0xC7D8, 0x448C, 0x9310, 0x8808, 0xADD4, 0x3CC2, 0x796, 0xC940, 0x4E32, 0x4E2E, 0x924A, 0x5B5C]s=Solver()flag=[BitVec(f'flag_{i}',32)for i in range(34)]b=[BitVec(f'b_{i}',32)for i in range(34)]for i in range(34): s.add(flag[i]&gt;=32,flag[i]&lt;=126)for i in range(34): if i==0: s.add(b[0]==(47806*flag[0])%51966) else: b_value=47806*(flag[i]+i) b_xored=b_value^(b[i-1]^0x114514) s.add(b[i]==b_xored%51966) s.add(b[i]==enc[i])print(&quot;solutions found:&quot;)while s.check()==sat: model=s.model() solution=''.join([chr(model[flag[i]].as_long())for i in range(34)]) print(solution) exception=Or([flag[i]!=model[flag[i]]for i in range(34)])#é¿å…é‡å¤æƒ…å†µ s.add(exception) é€†å‘å·¥ç¨‹å…¥é—¨æŒ‡åŒ— IDAæ‰“å¼€é™„ä»¶ç¨‹åºï¼Œåœ¨å­—ç¬¦ä¸²çª—å£å¯ä»¥ç›´æ¥çœ‹åˆ°flag week2base è¿è¡Œé™„ä»¶ç¨‹åºï¼Œç›´æ¥è®©è¾“å…¥flagã€‚IDAæ‰“å¼€åˆ†æmainå‡½æ•°ï¼Œå‘ç°ä½¿ç”¨äº†æ ‡å‡†base64åŠ å¯†ï¼Œå¹¶ä¸”å¯†æ–‡ç›´æ¥ç»™äº†ã€‚cyberchefä¸€æŠŠæ¢­ 1234567891011121314151617181920212223242526272829303132333435363738394041//mainå‡½æ•°int __fastcall main(int argc, const char **argv, const char **envp){ FILE *Stream; // rax __int64 v4; // rdx __int64 length; // rax unsigned __int64 n; // rax char *Str1; // rbx int v8; // eax char *Format; // rcx char v11[16]; // [rsp+20h] [rbp-98h] BYREF char flag[112]; // [rsp+30h] [rbp-88h] BYREF printf(::Format); printf((char *)&amp;Format_); Stream = _acrt_iob_func(0); fgets(flag, 100, Stream); v4 = -1LL; length = -1LL; do ++length; while ( flag[length] ); if ( length &amp;&amp; v11[length + 15] == 10 ) { n = length - 1; if ( n &gt;= 0x64 ) _report_securityfailure_(flag); flag[n] = 0; } do ++v4; while ( flag[v4] ); Str1 = (char *)baseEncode(flag, v4, v11);// æ ‡å‡†base64åŠ å¯† v8 = strcmp(Str1, &quot;bW9lY3Rme1kwdV9DNG5fRzAwZF9BdF9CNDVlNjQhIX0=&quot;); Format = (char *)&amp;unk_140003300; if ( v8 ) Format = (char *)&amp;byte_140003318; printf(Format); free(Str1); return 0;} speed é™„ä»¶ç¨‹åºè¿è¡Œå‡ºç°ä¸€é“é»‘å½±ï¼Œçœ‹ä¸æ¸…ã€‚IDAåˆ†æmainå‡½æ•°ï¼Œå‘ç°ä½¿ç”¨äº†WNDCLASSAç»“æ„ä½“ï¼ˆè¯¦ç»†ä¿¡æ¯è§ï¼šWNDCLASSA ï¼ˆwinuser.hï¼‰ - Win32 apps | Microsoft Learnï¼‰ï¼Œä¸»è¦é€»è¾‘æ˜¯åˆ›å»ºçª—å£ï¼Œå…³é”®éƒ¨åˆ†æ˜¯çª—å£ç»“æ„ä½“å˜é‡lpfnWndProcï¼Œå®ƒæŒ‡å‘äº†çª—å£çš„é€»è¾‘ï¼ˆå³ä»£ç ä¸­çš„WndProcå‡½æ•°ï¼‰ åˆ†æWndProcå‡½æ•°å‘ç°ï¼Œçª—å£ä¼¼ä¹ç›´æ¥è¾“å‡ºflagã€‚äºæ˜¯ä¸‹æ–­ç‚¹ï¼ŒåŠ¨æ€è°ƒè¯• 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172//WndProcå‡½æ•°LRESULT __fastcall WndProc(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam){ tagPAINTSTRUCT Paint; // [rsp+30h] [rbp-50h] BYREF char Destination[14]; // [rsp+80h] [rbp+0h] BYREF __int16 v7; // [rsp+8Eh] [rbp+Eh] __int64 v8; // [rsp+90h] [rbp+10h] __int64 v9; // [rsp+98h] [rbp+18h] __int64 v10; // [rsp+A0h] [rbp+20h] __int64 v11; // [rsp+A8h] [rbp+28h] __int64 v12; // [rsp+B0h] [rbp+30h] __int64 v13; // [rsp+B8h] [rbp+38h] __int64 v14; // [rsp+C0h] [rbp+40h] __int64 v15; // [rsp+C8h] [rbp+48h] __int64 v16; // [rsp+D0h] [rbp+50h] __int64 v17; // [rsp+D8h] [rbp+58h] __int64 v18; // [rsp+E0h] [rbp+60h] __int64 v19; // [rsp+E8h] [rbp+68h] __int64 v20; // [rsp+F0h] [rbp+70h] __int64 v21; // [rsp+F8h] [rbp+78h] struct tagRECT Rect; // [rsp+100h] [rbp+80h] BYREF char mylittlepony[13]; // [rsp+113h] [rbp+93h] BYREF char Source[8]; // [rsp+120h] [rbp+A0h] BYREF __int64 v25; // [rsp+128h] [rbp+A8h] _QWORD v26[2]; // [rsp+130h] [rbp+B0h] int i; // [rsp+140h] [rbp+C0h] int n12; // [rsp+144h] [rbp+C4h] HDC hdc; // [rsp+148h] [rbp+C8h] if ( Msg == 2 ) { PostQuitMessage(0); return 0LL; } else if ( Msg == 15 ) { hdc = BeginPaint(hWnd, &amp;Paint); strcpy(Destination, &quot;Your flag is &quot;); v7 = 0; v8 = 0LL; v9 = 0LL; v10 = 0LL; v11 = 0LL; v12 = 0LL; v13 = 0LL; v14 = 0LL; v15 = 0LL; v16 = 0LL; v17 = 0LL; v18 = 0LL; v19 = 0LL; v20 = 0LL; v21 = 0LL; *(_QWORD *)Source = 0x7F1B3E885EF9160LL; v25 = 0x2CD336BCB0464A89LL; v26[0] = 0xEF5FC91642917EE1uLL; *(_QWORD *)((char *)v26 + 6) = 0x739D40A4E356EF5FLL; strcpy(mylittlepony, &quot;mylittlepony&quot;); n12 = 12; i = strlen(Source); RC4Crypt((unsigned __int8 *)Source, i, (const unsigned __int8 *)mylittlepony, 12); strcat(Destination, Source); GetClientRect(hWnd, &amp;Rect); DrawTextA(hdc, Destination, -1, &amp;Rect, 0x40005u); EndPaint(hWnd, &amp;Paint); return 0LL; } else { return DefWindowProcA(hWnd, Msg, wParam, lParam); }} åŠ¨æ€è°ƒè¯•ç»“æœå¦‚å›¾ï¼š ezpy ä½¿ç”¨decompyle3åç¼–è¯‘å¾—åˆ°ï¼š 1234567891011121314151617181920212223def caesar_cipher_encrypt(text, shift): result = [] for char in text: if char.isalpha(): if char.islower(): new_char = chr((ord(char) - ord(&quot;a&quot;) + shift) % 26 + ord(&quot;a&quot;)) elif char.isupper(): new_char = chr((ord(char) - ord(&quot;A&quot;) + shift) % 26 + ord(&quot;A&quot;)) result.append(new_char) else: result.append(char) return &quot;&quot;.join(result)user_input = input(&quot;please input your flagï¼š&quot;)a = 1if a != 1: plaintext = user_input shift = 114514 encrypted_text = caesar_cipher_encrypt(plaintext, shift) if encrypted_text == &quot;wyomdp{I0e_Ux0G_zim}&quot;: print(&quot;Correct!!!!&quot;) å¯ä»¥çœ‹å‡ºå®ç°äº†ä¸€ä¸ªå‡¯æ’’åŠ å¯†ï¼Œåˆ†æé€»è¾‘å¯ä»¥çœ‹å‡ºå®é™…ä¸Šæ˜¯ç»™æ¯ä¸ªå­—æ¯ç§»ä½äº†10ï¼ˆasciiç +10ï¼‰ï¼Œæ‰€ä»¥ç»™å­—æ¯å‡10å°±okäº†ï¼Œå¯ä»¥åŸºäºæºç è¿›è¡Œå¾®å°æ”¹åŠ¨å¾—åˆ°è§£å¯†è„šæœ¬ï¼š 12345678910111213141516def caesar_cipher_decrypt(text, shift): result = [] for char in text: if char.isalpha(): if char.islower(): new_char = chr((ord(char) - ord(&quot;a&quot;) - shift) % 26 + ord(&quot;a&quot;))#'+'æ”¹ä¸º-&quot; elif char.isupper(): new_char = chr((ord(char) - ord(&quot;A&quot;) - shift) % 26 + ord(&quot;A&quot;)) result.append(new_char) else: result.append(char) return &quot;&quot;.join(result)enc=&quot;wyomdp{I0e_Ux0G_zim}&quot;flag=caesar_cipher_decrypt(enc,114514)print(flag) catch å…ˆçœ‹mainå‡½æ•°åç¼–è¯‘ç»“æœï¼Œå‘ç°åªæœ‰ç®€å•çš„ä¸¤ä¸ªå‡½æ•°ï¼Œå…¶ä¸­solveå‡½æ•°æœ‰æ›´å¤æ‚çš„é€»è¾‘ï¼š ç„¶è€Œsolveå‡½æ•°å¹¶ä¸èƒ½çœ‹å‡ºä»€ä¹ˆæœ‰ç”¨çš„é€»è¾‘å‡ºæ¥ï¼Œsub_114514å‡ºç°äº†flagå­—æ ·ï¼Œä½†æ˜¯åŠ¨è°ƒå‘ç°æ²¡æœ‰ç”¨å¤„ ç»“åˆé¢˜ç›®æç¤ºtry catchä¸èƒ½è¢«æ­£ç¡®åç¼–è¯‘ï¼Œäºæ˜¯ç›´æ¥æŸ¥çœ‹æ±‡ç¼–ä»£ç ã€‚åœ¨æ±‡ç¼–ä»£ç é‡Œçœ‹åˆ°ä¸€ä¸ªç±»ä¼¼flagæ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œåˆ†æåç»­é€»è¾‘å‘ç°å¯¹è¿™ä¸ªå­—ç¬¦ä¸²è¿›è¡Œäº†å¤„ç†ï¼Œåˆ†æå‘ç°å¤„ç†ç»“æœå°±æ˜¯flag 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154.text:00000001400014D6 ; =============== S U B R O U T I N E =======================================.text:00000001400014D6.text:00000001400014D6 ; Attributes: bp-based frame fpd=10h.text:00000001400014D6.text:00000001400014D6 ; void __noreturn solve(void).text:00000001400014D6 public _Z5solvev.text:00000001400014D6 _Z5solvev proc near ; CODE XREF: main+Dâ†“p.text:00000001400014D6 ; DATA XREF: .pdata:000000014002D078â†“o ....text:00000001400014D6.text:00000001400014D6 length = dword ptr -1Ch.text:00000001400014D6 C = dword ptr -18h.text:00000001400014D6 count = dword ptr -14h.text:00000001400014D6.text:00000001400014D6 ; __unwind { // __gxx_personality_seh0.text:00000001400014D6 push rbp.text:00000001400014D7 push rsi.text:00000001400014D8 push rbx.text:00000001400014D9 sub rsp, 30h.text:00000001400014DD lea rbp, [rsp+30h].text:00000001400014E2 lea rax, aMyFlagIsHidden ; &quot;my flag is hidden in this program. Can &quot;....text:00000001400014E9 mov rcx, rax ; char *.text:00000001400014EC call print.text:00000001400014F1 ; try {.text:00000001400014F1 call _Z10sub_114514v ; sub_114514(void).text:00000001400014F1 ; } // starts at 1400014F1.text:00000001400014F6 mov ecx, 10h ; thrown_size.text:00000001400014FB call __cxa_allocate_exception.text:0000000140001500 mov rbx, rax.text:0000000140001503 lea rax, aNothingButErro ; &quot;nothing but error&quot;.text:000000014000150A mov rdx, rax ; char *.text:000000014000150D mov rcx, rbx ; this.text:0000000140001510 ; try {.text:0000000140001510 call _ZNSt11logic_errorC1EPKc ; std::logic_error::logic_error(char const*).text:0000000140001510 ; } // starts at 140001510.text:0000000140001515 mov r8, cs:_refptr__ZNSt11logic_errorD1Ev ; void (*)(void *).text:000000014000151C lea rax, _ZTISt11logic_error ; `typeinfo for'std::logic_error.text:0000000140001523 mov rdx, rax ; lptinfo.text:0000000140001526 mov rcx, rbx ; void *.text:0000000140001529 ; try {.text:0000000140001529 call __cxa_throw.text:0000000140001529 ; } // starts at 140001529.text:000000014000152E ; ---------------------------------------------------------------------------.text:000000014000152E ; cleanup() // owned by 140001510.text:000000014000152E mov rsi, rax.text:0000000140001531 mov rcx, rbx ; void *.text:0000000140001534 call __cxa_free_exception.text:0000000140001539 mov rax, rsi.text:000000014000153C jmp short $+2.text:000000014000153E ; ---------------------------------------------------------------------------.text:000000014000153E.text:000000014000153E loc_14000153E: ; CODE XREF: solve(void)+66â†‘j.text:000000014000153E ; catch(...) // owned by 1400014F1 ; void *.text:000000014000153E ; catch(...) // owned by 140001529.text:000000014000153E mov rcx, rax.text:0000000140001541 call __cxa_begin_catch.text:0000000140001546 lea rax, enc ; &quot;zbrpgs{F4z3_Ge1px_jvgu_@sybjre_qrfhjn}&quot;.text:000000014000154D mov rcx, rax ; Str.text:0000000140001550 call strlen.text:0000000140001555 mov [rbp+10h+length], eax.text:0000000140001558 mov [rbp+10h+count], 0.text:000000014000155F jmp loc_14000160E.text:0000000140001564 ; ---------------------------------------------------------------------------.text:0000000140001564.text:0000000140001564 loc_140001564: ; CODE XREF: solve(void)+13Eâ†“j.text:0000000140001564 mov eax, [rbp+10h+count].text:0000000140001567 cdqe.text:0000000140001569 lea rdx, enc ; &quot;zbrpgs{F4z3_Ge1px_jvgu_@sybjre_qrfhjn}&quot;.text:0000000140001570 movzx eax, byte ptr [rax+rdx].text:0000000140001574 movzx eax, al.text:0000000140001577 mov [rbp+10h+C], eax.text:000000014000157A mov eax, [rbp+10h+C].text:000000014000157D mov ecx, eax ; C.text:000000014000157F mov rax, cs:__imp_islower.text:0000000140001586 call rax ; __imp_islower ; åˆ¤æ–­å­—æ¯å¤§å°å†™.text:0000000140001588 test eax, eax.text:000000014000158A jz short loc_1400015B9 ; å¤§å†™å­—æ¯è·³è½¬.text:000000014000158C mov eax, [rbp+10h+C] ; enc[count].text:000000014000158F lea edx, [rax-54h] ; enc[count]-0x54.text:0000000140001592 movsxd rax, edx.text:0000000140001595 imul rax, 4EC4EC4Fh ; ä»è¿™é‡Œå¼€å§‹.text:000000014000159C shr rax, 20h.text:00000001400015A0 sar eax, 3.text:00000001400015A3 mov ecx, edx.text:00000001400015A5 sar ecx, 1Fh.text:00000001400015A8 sub eax, ecx.text:00000001400015AA imul ecx, eax, 1Ah.text:00000001400015AD mov eax, edx.text:00000001400015AF sub eax, ecx ; åˆ°è¿™é‡Œç»“æŸï¼Œå®ç°çš„æ˜¯é™¤ä»¥26.text:00000001400015B1 add eax, 61h ; 'a' ; åŠ ä¸Š0x61.text:00000001400015B4 mov [rbp+10h+C], eax.text:00000001400015B7 jmp short loc_1400015F6.text:00000001400015B9 ; ---------------------------------------------------------------------------.text:00000001400015B9.text:00000001400015B9 loc_1400015B9: ; CODE XREF: solve(void)+B4â†‘j.text:00000001400015B9 mov eax, [rbp+10h+C].text:00000001400015BC mov ecx, eax ; C.text:00000001400015BE mov rax, cs:__imp_isupper.text:00000001400015C5 call rax ; __imp_isupper ; åˆ¤æ–­å­—æ¯å¤§å°å†™.text:00000001400015C7 test eax, eax.text:00000001400015C9 jz short loc_1400015F6 ; éå­—æ¯è·³è½¬.text:00000001400015CB mov eax, [rbp+10h+C] ; enc[count].text:00000001400015CE lea edx, [rax-34h] ; enc[count]-0x34.text:00000001400015D1 movsxd rax, edx.text:00000001400015D4 imul rax, 4EC4EC4Fh ; ä»è¿™é‡Œå¼€å§‹.text:00000001400015DB shr rax, 20h.text:00000001400015DF sar eax, 3.text:00000001400015E2 mov ecx, edx.text:00000001400015E4 sar ecx, 1Fh.text:00000001400015E7 sub eax, ecx.text:00000001400015E9 imul ecx, eax, 1Ah.text:00000001400015EC mov eax, edx.text:00000001400015EE sub eax, ecx ; åˆ°è¿™é‡Œç»“æŸï¼Œå®ç°çš„æ˜¯é™¤ä»¥26.text:00000001400015F0 add eax, 41h ; 'A' ; åŠ ä¸Š0x41.text:00000001400015F3 mov [rbp+10h+C], eax.text:00000001400015F6.text:00000001400015F6 loc_1400015F6: ; CODE XREF: solve(void)+E1â†‘j.text:00000001400015F6 ; solve(void)+F3â†‘j.text:00000001400015F6 mov eax, [rbp+10h+C].text:00000001400015F9 mov ecx, eax.text:00000001400015FB mov eax, [rbp+10h+count].text:00000001400015FE cdqe.text:0000000140001600 lea rdx, enc ; &quot;zbrpgs{F4z3_Ge1px_jvgu_@sybjre_qrfhjn}&quot;.text:0000000140001607 mov [rax+rdx], cl.text:000000014000160A add [rbp+10h+count], 1.text:000000014000160E.text:000000014000160E loc_14000160E: ; CODE XREF: solve(void)+89â†‘j.text:000000014000160E mov eax, [rbp+10h+count].text:0000000140001611 cmp eax, [rbp+10h+length].text:0000000140001614 jl loc_140001564.text:000000014000161A lea rax, aSoYouDidnTCatc ; &quot;so you didn't catch me?\\n&quot;.text:0000000140001621 mov rcx, rax ; char *.text:0000000140001624 ; try {.text:0000000140001624 call print.text:0000000140001624 ; } // starts at 140001624.text:0000000140001629 call __cxa_end_catch.text:000000014000162E jmp short loc_140001644.text:0000000140001630 ; ---------------------------------------------------------------------------.text:0000000140001630 ; cleanup() // owned by 140001624.text:0000000140001630 mov rbx, rax.text:0000000140001633 call __cxa_end_catch.text:0000000140001638 mov rax, rbx.text:000000014000163B mov rcx, rax ; gcc_exc.text:000000014000163E call _Unwind_Resume.text:000000014000163E ; ---------------------------------------------------------------------------.text:0000000140001643 align 4.text:0000000140001644.text:0000000140001644 loc_140001644: ; CODE XREF: solve(void)+158â†‘j.text:0000000140001644 add rsp, 30h.text:0000000140001648 pop rbx.text:0000000140001649 pop rsi.text:000000014000164A pop rbp.text:000000014000164B retn.text:000000014000164B ; } // starts at 1400014D6.text:000000014000164B _Z5solvev endp è§£å¯†è„šæœ¬ï¼š 12345678910111213141516171819def decode(s): result = [] for char in s: #å°å†™å­—æ¯ if 'a' &lt;= char &lt;= 'z': new_char = chr((ord(char) - 0x54) % 26 + 0x61) result.append(new_char) #å¤§å†™å­—æ¯ elif 'A' &lt;= char &lt;= 'Z': new_char = chr((ord(char) - 0x34) % 26 + 0x41) result.append(new_char) #éå­—æ¯ else: result.append(char) return ''.join(result)enc = &quot;zbrpgs{F4z3_Ge1px_jvgu_@sybjre_qrfhjn}&quot;flag = decode(enc)print(flag) upx_revenge é™„ä»¶ç¨‹åºè¿è¡Œä¸äº†ï¼Œå¦‚å›¾ï¼š é¢˜ç›®æç¤ºupxç‰¹å¾æ®µé­”æ”¹ï¼Œä½†æ˜¯è‡ªå·±å°è¯•åå‘ç°é­”æ”¹ç‰¹å¾æ®µä¸ä¼šå¯¼è‡´ç¨‹åºè¿è¡Œä¸äº† åæ¥ç¢ç£¨äº†åŠå¤©ï¼Œæ‹·æ‰“(bushiäº†ä¸€ä¸‹å‡ºé¢˜äººï¼Œæ‰å‘ç°è¿™ä¸ªç¨‹åºç¼ºäº†bytesï¼ˆçœ‹äº†å®˜æ–¹WriteUpï¼Œå‘ç°è¿™ç¡®å®æ˜¯ä¸€ä¸ªè€ƒç‚¹ğŸ˜­ï¼Œæˆ‘çœŸå‚»ï¼ŒçœŸçš„ï¼Œæˆ‘å•çŸ¥é“upxé­”æ”¹ä¼šæ”¹ç‰¹å¾æ®µæ•°æ®ï¼Œæˆ‘ä¸çŸ¥é“è¿˜å¯ä»¥åˆ æ•°æ®ğŸ˜­ï¼‰ ç¼ºå°‘çš„åœ°æ–¹åœ¨upxç‰¹å¾æ®µï¼Œå¯ä»¥å‘ç°upx1æ®µå¼€å¤´çš„å››ä¸ªå­—èŠ‚é”™ä½äº†ï¼Œé”™ä½åˆ°upxç‰¹å¾æ®µä¸Šäº†ï¼Œæ‰€ä»¥è¦ç»™ç‰¹å¾æ®µæ’å…¥å››ä¸ªå­—èŠ‚ ç”¨010editoråœ¨49 01 00 C3åé¢æŒ‰Ctrl+shift+Iæ’å…¥4bytesï¼ˆé»˜è®¤å¡«å……ä¸º0ï¼‰ï¼Œä¼šå‘ç°ç¨‹åºå¯ä»¥è¿è¡Œäº† é‡‡ç”¨æ‰‹åŠ¨è„±å£³çš„åŠæ³•ã€‚å…·ä½“æ“ä½œå¯ä»¥å‚è€ƒweek1_upxçš„è§£æ³•æˆ–è€…çœ‹çœ‹Day9:å£³ä¸è„±å£³ï¼ˆä¸€ï¼‰å’ŒDay10:å£³ä¸è„±å£³ï¼ˆäºŒï¼‰ï¼ˆç‹å©†å–ç“œè¿™ä¸€å—ï¼Œè¿™é‡Œä»æ‰¾åˆ°OEPå¼€å§‹ï¼š ä¸‹æ–­ç‚¹F9è¿è¡Œåˆ°ä¸Šå›¾è¿™ä¸ªå¤§è·³ï¼Œç„¶åF7æ­¥å…¥ RIPæŒ‡å‘æ­¤å¤„æ—¶ï¼Œæ‰“å¼€scyllaè¿›è¡Œè½¬å‚¨å’ŒIATé‡å»ºä¿®å¤è½¬å‚¨ã€‚è¿™é‡Œéœ€è¦æ³¨æ„ï¼ŒIATæœç´¢å‡ºæ¥çš„ç»“æœé‡Œæœ‰ä¸€ä¸ªæŸåçš„å¯¼å…¥ï¼Œéœ€è¦æŠŠå®ƒåˆ æ‰ è„±å£³åçš„_dump_SCY.exeæ–‡ä»¶å°±å¯ä»¥ç”¨IDAæ‰“å¼€æ­£å¸¸åˆ†æäº† é¦–å…ˆæŸ¥çœ‹å­—ç¬¦ä¸²è¡¨ï¼Œå¯ä»¥å‘ç°å¯ç–‘çš„çš„æç¤ºâ€correctâ€ è·Ÿè¸ªcorrectå¯ä»¥æ‰¾åˆ°mainå‡½æ•°ã€‚ä¸‹é¢æ˜¯ä¼˜åŒ–åçš„mainå‡½æ•°å’Œç›¸å…³çš„å‡½æ•° 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192// Hidden C++ exception states: #wind=5int __fastcall main(int argc, const char **argv, const char **envp){ __int64 v3; // rax __int64 v4; // rdx unsigned __int8 v5; // al __int64 v6; // r8 void **v7; // rdx void **v8; // rsi size_t length; // rdi void *v10; // rax void *v11; // rcx _QWORD *newBuffer; // rax char *v13; // rbx char *enc; // rax char *v15; // rbx void **encryptedFlag; // rcx int v17; // eax char *outString; // rdx __int64 v19; // rax void *v20; // rcx void *v21; // rcx void *v22; // rcx void *v23; // rcx void *CopiedFlag[2]; // [rsp+28h] [rbp-51h] BYREF char *bufferEnd; // [rsp+38h] [rbp-41h] void *flag[2]; // [rsp+40h] [rbp-39h] BYREF __m128i si128; // [rsp+50h] [rbp-29h] void *encodeResult[2]; // [rsp+60h] [rbp-19h] BYREF size_t Size; // [rsp+70h] [rbp-9h] unsigned __int64 v31; // [rsp+78h] [rbp-1h] void *modifiedBaseTable[2]; // [rsp+80h] [rbp+7h] BYREF __m128i v33; // [rsp+90h] [rbp+17h] __int128 v34; // [rsp+A0h] [rbp+27h] __int64 v35; // [rsp+B0h] [rbp+37h] __int64 v36; // [rsp+B8h] [rbp+3Fh] v3 = output(std::cout, pleaseEnterYourFlag); std::istream::operator&gt;&gt;(v3, out_flush); *flag = 0LL; si128 = _mm_load_si128(&amp;xmmword_7FF7420B44B0); LOBYTE(flag[0]) = 0; LOBYTE(v4) = 10; v5 = std::ios::widen(&amp;std::cin + *(std::cin + 4LL), v4); input(std::cin, flag, v5); v7 = flag; if ( si128.m128i_i64[1] &gt; 0xFuLL ) // si128.m128i_i64[1]æ˜¯è¾“å…¥çš„flagçš„é•¿åº¦ v7 = flag[0]; v8 = flag; if ( si128.m128i_i64[1] &gt; 0xFuLL ) v8 = flag[0]; *CopiedFlag = 0LL; bufferEnd = 0LL; length = v7 + si128.m128i_i64[0] - v8; if ( length ) { if ( length &gt; 0x7FFFFFFFFFFFFFFFLL ) lengthError(); if ( length &lt; 0x1000 ) { newBuffer = operator new(length); } else { if ( length + 39 &lt; length ) sub_7FF7420B1170(); v10 = operator new(length + 39); v11 = v10; if ( !v10 )LABEL_31: invalid_parameter_noinfo_noreturn(); newBuffer = ((v10 + 39) &amp; 0xFFFFFFFFFFFFFFE0uLL); *(newBuffer - 1) = v11; } CopiedFlag[0] = newBuffer; v13 = newBuffer + length; bufferEnd = newBuffer + length; memmove(newBuffer, v8, length); CopiedFlag[1] = v13; } XORencrypt(modifiedBaseTable, v7, v6); // é­”æ”¹base64çš„ç¼–ç è¡¨ baseEncode(encodeResult, CopiedFlag, modifiedBaseTable);// base64ç¼–ç  v34 = 0LL; enc = operator new(0x30uLL); v15 = enc; *&amp;v34 = enc; v35 = 44LL; v36 = 47LL; strcpy(enc, &quot;lY7bW=\\\\ck?eyjX7]TZ\\\\}CVbh\\\\tOyTH6&gt;jH7XmFifG]H7&quot;); encryptedFlag = encodeResult; if ( v31 &gt; 0xF ) encryptedFlag = encodeResult[0]; if ( Size != 44 || (v17 = memcmp(encryptedFlag, enc, 0x2CuLL), outString = aCorrect, v17) ) outString = aWrong; v19 = output(std::cout, outString); std::istream::operator&gt;&gt;(v19, out_flush); j_j_free(v15); if ( v31 &gt; 0xF ) { v20 = encodeResult[0]; if ( v31 + 1 &gt;= 0x1000 ) { v20 = *(encodeResult[0] - 1); if ( (encodeResult[0] - v20 - 8) &gt; 0x1F ) invalid_parameter_noinfo_noreturn(); } j_j_free(v20); } Size = 0LL; v31 = 15LL; LOBYTE(encodeResult[0]) = 0; if ( v33.m128i_i64[1] &gt; 0xFuLL ) { v21 = modifiedBaseTable[0]; if ( (v33.m128i_i64[1] + 1) &gt;= 0x1000 ) { v21 = *(modifiedBaseTable[0] - 1); if ( (modifiedBaseTable[0] - v21 - 8) &gt; 0x1F ) invalid_parameter_noinfo_noreturn(); } j_j_free(v21); } v33 = _mm_load_si128(&amp;xmmword_7FF7420B44B0); LOBYTE(modifiedBaseTable[0]) = 0; v22 = CopiedFlag[0]; if ( CopiedFlag[0] ) { if ( (bufferEnd - CopiedFlag[0]) &gt;= 0x1000 ) { v22 = *(CopiedFlag[0] - 1); if ( (CopiedFlag[0] - v22 - 8) &gt; 0x1F ) goto LABEL_31; } j_j_free(v22); } if ( si128.m128i_i64[1] &gt; 0xFuLL ) { v23 = flag[0]; if ( (si128.m128i_i64[1] + 1) &gt;= 0x1000 ) { v23 = *(flag[0] - 1); if ( (flag[0] - v23 - 8) &gt; 0x1F ) invalid_parameter_noinfo_noreturn(); } j_j_free(v23); } return 0;}// Hidden C++ exception states: #wind=5_QWORD *__fastcall XORencrypt(_QWORD *modifiedTable, __int64 a2, __int64 a3){ void **pTableStart; // rdx void **pCurrentPos; // rdi void **i; // rsi char xored; // r9 unsigned __int64 cucrrentSize; // rcx unsigned __int64 capacity; // rdx _QWORD *Table; // rax *modifiedTable = 0LL; modifiedTable[2] = 0LL; modifiedTable[3] = 15LL; *modifiedTable = 0; pTableStart = &amp;oriTable; pCurrentPos = &amp;oriTable; if ( *(&amp;xmmword_7FF7420B6760 + 1) &gt; 0xFuLL ) { pCurrentPos = oriTable; // oriTableæ˜¯åŸå§‹çš„base64ç¼–ç è¡¨ pTableStart = oriTable; } for ( i = (pTableStart + xmmword_7FF7420B6760); pCurrentPos != i; pCurrentPos = (pCurrentPos + 1) ) { xored = *pCurrentPos ^ 0xE; // éå†Tableå¹¶å¼‚æˆ–0xEï¼Œåˆ›å»ºä¸€ä¸ªé­”æ”¹çš„ç¼–ç è¡¨ cucrrentSize = modifiedTable[2]; capacity = modifiedTable[3]; if ( cucrrentSize &gt;= capacity ) { needExpand(modifiedTable, capacity, a3, xored); } else { modifiedTable[2] = cucrrentSize + 1; // æ­¤å¤„å¼€å§‹å†™å…¥xorå¤„ç†åçš„tableå­—ç¬¦ Table = modifiedTable; if ( capacity &gt; 0xF ) Table = *modifiedTable; *(Table + cucrrentSize) = xored; *(Table + cucrrentSize + 1) = 0; } } return modifiedTable;} å¯ä»¥çœ‹å‡ºé€»è¾‘å°±æ˜¯å…ˆé­”æ”¹base64çš„ç¼–ç è¡¨ï¼Œç„¶åå†ç”¨é­”æ”¹çš„ç¼–ç è¡¨å¯¹flagè¿›è¡Œbase64ç¼–ç ï¼Œæœ€åå’Œç»™å®šçš„å¯†æ–‡æ¯”è¾ƒã€‚å¯ä»¥å…ˆå¯¹encè¿›è¡Œå¼‚æˆ–ï¼Œç„¶åå†base64è§£ç  1234567enc = &quot;lY7bW=\\\\ck?eyjX7]TZ\\\\}CVbh\\\\tOyTH6&gt;jH7XmFifG]H7&quot;data = &quot;&quot;for char in enc: data += chr(ord(char) ^ 0xE)print(data)#bW9lY3Rme1kwdV9SZTRsMXlfRzAwZF80dF9VcHghISF9 Two cups of tea åç¼–è¯‘çš„ä»£ç åˆ†æä¼˜åŒ–åå¤§æ¦‚æ˜¯è¿™æ ·ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164//mainå‡½æ•°éƒ¨åˆ†int __fastcall main(int argc, const char **argv, const char **envp){ __int64 n; // rbx FILE *Stream; // rax size_t length; // rax __int64 v6; // rdx __int64 count; // rax unsigned __int64 tmp4key; // [rsp+20h] [rbp-E0h] BYREF char key_2; // [rsp+28h] [rbp-D8h] __int64 key_1; // [rsp+30h] [rbp-D0h] BYREF int key_3; // [rsp+38h] [rbp-C8h] int key_4; // [rsp+3Ch] [rbp-C4h] _DWORD enc[10]; // [rsp+40h] [rbp-C0h] _OWORD flag[2]; // [rsp+68h] [rbp-98h] BYREF __int64 v16; // [rsp+88h] [rbp-78h] char Buffer[16]; // [rsp+90h] [rbp-70h] BYREF __int128 v18; // [rsp+A0h] [rbp-60h] __int64 v19; // [rsp+B0h] [rbp-50h] n = 0LL; key_1 = 2LL; key_2 = 0; key_3 = 2; key_4 = 5; enc[0] = 0x5D624C34; enc[1] = 0x8629FEAD; enc[2] = 0x9D11379B; enc[3] = 0xFCD53211; enc[4] = 0x460F63CE; enc[5] = 0xC5816E68; enc[6] = 0xFE5300AD; enc[7] = 0xA0015EE; enc[8] = 0x9806DBBB; enc[9] = 0xEF4A2648; tmp4key = 0xD0FCC6A7B8941CAFuLL; key_init(*&amp;argc, &amp;tmp4key, &amp;key_1);// è¿™é‡Œåˆå§‹åŒ–äº†key,ä¸å¿…ç†ä¼šå…·ä½“å®ç°ï¼Œå¯ä»¥åŠ¨è°ƒå¾—åˆ°ç»“æœ printf(&amp;pleaseEnterYourFlag); Stream = _acrt_iob_func(0); fgets(Buffer, 100, Stream); length = strcspn(Buffer, &quot;\\n&quot;);// è·å–flagçš„é•¿åº¦ if ( length &gt;= 0x64 ) _report_securityfailure_(); Buffer[length] = 0; flag[0] = *Buffer; key_1 = tmp4key; v16 = v19; flag[1] = v18; key_3 = 0x12345678; key_4 = 0x9ABCDEF0; modefiedTea(flag, v6, &amp;key_1);// é­”æ”¹çš„teaï¼ŒåŠ å¯†flagä»¥ä¾¿æ¯”å¯¹éªŒè¯ count = -1LL; do ++count; while ( Buffer[count] );// ç¡®è®¤flagé•¿åº¦ if ( count == 40 ) { while ( *(flag + n * 4) == enc[n] )// æ¯”å¯¹éªŒè¯ { if ( ++n &gt;= 10 ) { printf(right); return 0; } } printf(wrong); } else { printf(Format_0); } return 0;}//é­”æ”¹teaéƒ¨åˆ†__int64 __fastcall modefiedTea(unsigned int *flag, __int64 a2, __int64 key){ unsigned int flag_9; // r9d int delta; // r11d unsigned int flag_eight; // edx unsigned int flag_1; // esi unsigned int flag_2; // ebp unsigned int flag_3; // r14d unsigned int flag_4; // r15d unsigned int flag_5; // r12d unsigned int flag_6; // r13d int flag_o; // ebx unsigned int flag_7; // ecx int key_0; // edi int key_1; // ebx __int64 key_3; // r10 int key_2; // r11d int v18; // eax bool Count; // zf __int64 flag_seven; // rax unsigned int flag_0; // [rsp+0h] [rbp-58h] unsigned int flag_nine; // [rsp+4h] [rbp-54h] int count; // [rsp+8h] [rbp-50h] int delta_1; // [rsp+68h] [rbp+10h] __int64 Key; // [rsp+70h] [rbp+18h] unsigned int flag_8; // [rsp+78h] [rbp+20h] Key = key; flag_9 = flag[9]; delta = 0; flag_eight = flag[8]; flag_1 = flag[1]; flag_2 = flag[2]; flag_3 = flag[3]; flag_4 = flag[4]; flag_5 = flag[5]; flag_6 = flag[6]; flag_o = *flag; flag_7 = flag[7]; flag_8 = flag_eight; flag_nine = flag_9; count = 11; while ( 1 ) { delta_1 = delta - 1640531527; key_0 = *(key + 4LL * (((delta - 1640531527) &gt;&gt; 2) &amp; 3)); flag_0 = flag_o + ((((16 * flag_9) ^ (flag_1 &gt;&gt; 3)) + ((flag_9 &gt;&gt; 5) ^ (4 * flag_1))) ^ (((delta - 1640531527) ^ flag_1) + (key_0 ^ flag_9))); key_1 = *(Key + 4 * (((delta - 1640531527) &gt;&gt; 2) &amp; 3 ^ 1LL)); flag_1 += ((flag_0 ^ key_1) + ((delta - 1640531527) ^ flag_2)) ^ (((16 * flag_0) ^ (flag_2 &gt;&gt; 3)) + ((flag_0 &gt;&gt; 5) ^ (4 * flag_2))); key_3 = ((delta - 1640531527) &gt;&gt; 2) &amp; 3 ^ 3LL; key_2 = *(Key + 4 * (((delta - 1640531527) &gt;&gt; 2) &amp; 3 ^ 2LL)); flag_2 += ((flag_1 ^ key_2) + (delta_1 ^ flag_3)) ^ (((16 * flag_1) ^ (flag_3 &gt;&gt; 3)) + ((flag_1 &gt;&gt; 5) ^ (4 * flag_3))); flag_3 += ((delta_1 ^ flag_4) + (flag_2 ^ *(Key + 4 * key_3))) ^ (((16 * flag_2) ^ (flag_4 &gt;&gt; 3)) + ((flag_2 &gt;&gt; 5) ^ (4 * flag_4))); flag_4 += ((flag_3 ^ key_0) + (delta_1 ^ flag_5)) ^ (((16 * flag_3) ^ (flag_5 &gt;&gt; 3)) + ((flag_3 &gt;&gt; 5) ^ (4 * flag_5))); flag_5 += ((flag_4 ^ key_1) + (delta_1 ^ flag_6)) ^ (((16 * flag_4) ^ (flag_6 &gt;&gt; 3)) + ((flag_4 &gt;&gt; 5) ^ (4 * flag_6))); v18 = (flag_5 ^ key_2) + (delta_1 ^ flag_7); delta = delta_1; flag_6 += v18 ^ (((16 * flag_5) ^ (flag_7 &gt;&gt; 3)) + ((flag_5 &gt;&gt; 5) ^ (4 * flag_7))); flag_7 += ((flag_6 ^ *(Key + 4 * key_3)) + (delta_1 ^ flag_8)) ^ (((16 * flag_6) ^ (flag_8 &gt;&gt; 3)) + ((flag_6 &gt;&gt; 5) ^ (4 * flag_8))); flag_8 += ((flag_7 ^ key_0) + (delta_1 ^ flag_nine)) ^ (((16 * flag_7) ^ (flag_nine &gt;&gt; 3)) + ((flag_7 &gt;&gt; 5) ^ (4 * flag_nine))); flag_9 = (((flag_8 ^ key_1) + (delta_1 ^ flag_0)) ^ (((16 * flag_8) ^ (flag_0 &gt;&gt; 3)) + ((flag_8 &gt;&gt; 5) ^ (4 * flag_0)))) + flag_nine; key = Key; Count = count-- == 1; flag_nine = flag_9; if ( Count ) break; flag_o = flag_0; } flag_seven = flag_7; flag[1] = flag_1; flag[2] = flag_2; flag[3] = flag_3; flag[4] = flag_4; flag[5] = flag_5; flag[6] = flag_6; flag[7] = flag_7; flag[8] = flag_8; flag[9] = flag_9; *flag = flag_0; return flag_seven;} ç”±äºåŠ å¯†ä¸»è¦ä¾èµ–çš„æ˜¯å¼‚æˆ–ï¼Œåªè¦å¤åŸå‡ºåŠ å¯†æ—¶çš„ç¯å¢ƒï¼ˆç›¸å…³å˜é‡ï¼‰ï¼Œå°±å¯ä»¥å†æ¬¡åŠ å¯†å®ç°å¤åŸã€‚ä¸‹å›¾æ˜¯AIç»™çš„åŠ å¯†é€»è¾‘åˆ†æã€‚é¦–å…ˆæ¯è½®åŠ å¯†çš„å¯†é’¥ä¸åŒï¼Œå…¶æ¬¡æ¯ä¸ªå­—ç¬¦å—çš„åŠ å¯†éƒ½ä¾èµ–å‰ä¸€å—å’Œåä¸€å—ã€‚çªç ´å£ï¼šå¯¹äºflag9è€Œè¨€ï¼Œå®ƒçš„å‰ä¸€å—å’Œåä¸€å—éƒ½æ˜¯ç»è¿‡æœ¬è½®åŠ å¯†çš„ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨æœ€åä¸€è½®ï¼Œflag9ä¾èµ–çš„æ˜¯æœ€ç»ˆå¯†æ–‡çš„flag0å’Œflag8ï¼Œå¯ä»¥åˆ©ç”¨æœ€ç»ˆå¯†æ–‡ç›´æ¥è§£å¯†ã€‚è§£å¯†å‡ºæœ€åä¸€è½®çš„æœªåŠ å¯†flag9åï¼Œå°±å¯ä»¥å¾€å›è§£å¯†flag8-flag0ï¼Œå°±è¿™æ ·11è½®è§£å¯†å›å»ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ ä¿®æ”¹ç‰ˆTEAåŠ å¯†ï¼ˆ10å—Feistelç»“æ„ï¼Œ11è½®ï¼‰ â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜è¾“å…¥: flag[0]...flag[9] (10ä¸ª32ä½å­—), key[0]...key[3] (128ä½å¯†é’¥)åˆå§‹åŒ–: delta = 0 count = 11å¼€å§‹å¾ªç¯ï¼ˆ11è½®ï¼‰: delta_1 = delta - 0x61C88647 (æ— ç¬¦å·å‡æ³•ï¼Œ1640531527çš„åå…­è¿›åˆ¶) å¯†é’¥è°ƒåº¦: k0 = key[(delta_1&gt;&gt;2) &amp; 3] k1 = key[((delta_1&gt;&gt;2) &amp; 3) ^ 1] k2 = key[((delta_1&gt;&gt;2) &amp; 3) ^ 2] k3 = key[((delta_1&gt;&gt;2) &amp; 3) ^ 3] åŠ å¯†é“¾ï¼ˆæ¯è½®æ›´æ–°æ‰€æœ‰10ä¸ªå­—ï¼Œé¡ºåºä¾èµ–ï¼‰: flag0 += F(flag9, flag1, delta_1, k0) flag1 += F(flag0, flag2, delta_1, k1) flag2 += F(flag1, flag3, delta_1, k2) flag3 += F(flag2, flag4, delta_1, k3) flag4 += F(flag3, flag5, delta_1, k0) flag5 += F(flag4, flag6, delta_1, k1) flag6 += F(flag5, flag7, delta_1, k2) flag7 += F(flag6, flag8, delta_1, k3) flag8 += F(flag7, flag9, delta_1, k0) flag9 += F(flag8, flag0, delta_1, k1) å…¶ä¸­ F(a, b, delta, k) = ((16*a) ^ (b&gt;&gt;3)) + ((a&gt;&gt;5) ^ (4*b))) ^ ( (delta ^ b) + (k ^ a) ) æ›´æ–°delta = delta_1å¾ªç¯ç»“æŸï¼ˆcountå‡è‡³1ï¼‰è¾“å‡º: åŠ å¯†åçš„flag[0]...flag[9] è§£å¯†è„šæœ¬ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556#include &lt;stdio.h&gt;#include &lt;stdint.h&gt;void modefiedTea_decrypt(uint32_t* flag, uint32_t* key) { int32_t deltas[11]; int32_t delta = 0; for (int i = 0; i &lt; 11; i++) { delta -= 1640531527; deltas[i] = delta; } for (int round = 10; round &gt;= 0; round--) { uint32_t delta_1 = deltas[round]; uint32_t k0 = key[((delta_1 &gt;&gt; 2) &amp; 3)]; uint32_t k1 = key[((delta_1 &gt;&gt; 2) &amp; 3) ^ 1]; uint32_t k2 = key[((delta_1 &gt;&gt; 2) &amp; 3) ^ 2]; uint32_t k3 = key[((delta_1 &gt;&gt; 2) &amp; 3) ^ 3]; flag[9] -= ((flag[8] ^ k1) + (delta_1 ^ flag[0])) ^ (((16 * flag[8]) ^ (flag[0] &gt;&gt; 3)) + ((flag[8] &gt;&gt; 5) ^ (4 * flag[0]))); flag[8] -= ((flag[7] ^ k0) + (delta_1 ^ flag[9])) ^ (((16 * flag[7]) ^ (flag[9] &gt;&gt; 3)) + ((flag[7] &gt;&gt; 5) ^ (4 * flag[9]))); flag[7] -= ((flag[6] ^ k3) + (delta_1 ^ flag[8])) ^ (((16 * flag[6]) ^ (flag[8] &gt;&gt; 3)) + ((flag[6] &gt;&gt; 5) ^ (4 * flag[8]))); flag[6] -= ((flag[5] ^ k2) + (delta_1 ^ flag[7])) ^ (((16 * flag[5]) ^ (flag[7] &gt;&gt; 3)) + ((flag[5] &gt;&gt; 5) ^ (4 * flag[7]))); flag[5] -= ((flag[4] ^ k1) + (delta_1 ^ flag[6])) ^ (((16 * flag[4]) ^ (flag[6] &gt;&gt; 3)) + ((flag[4] &gt;&gt; 5) ^ (4 * flag[6]))); flag[4] -= ((flag[3] ^ k0) + (delta_1 ^ flag[5])) ^ (((16 * flag[3]) ^ (flag[5] &gt;&gt; 3)) + ((flag[3] &gt;&gt; 5) ^ (4 * flag[5]))); flag[3] -= ((flag[2] ^ k3) + (delta_1 ^ flag[4])) ^ (((16 * flag[2]) ^ (flag[4] &gt;&gt; 3)) + ((flag[2] &gt;&gt; 5) ^ (4 * flag[4]))); flag[2] -= ((flag[1] ^ k2) + (delta_1 ^ flag[3])) ^ (((16 * flag[1]) ^ (flag[3] &gt;&gt; 3)) + ((flag[1] &gt;&gt; 5) ^ (4 * flag[3]))); flag[1] -= ((flag[0] ^ k1) + (delta_1 ^ flag[2])) ^ (((16 * flag[0]) ^ (flag[2] &gt;&gt; 3)) + ((flag[0] &gt;&gt; 5) ^ (4 * flag[2]))); flag[0] -= ((flag[9] ^ k0) + (delta_1 ^ flag[1])) ^ (((16 * flag[9]) ^ (flag[1] &gt;&gt; 3)) + ((flag[9] &gt;&gt; 5) ^ (4 * flag[1]))); }}int main() { uint32_t enc[10] = { 0x5D624C34, 0x8629FEAD, 0x9D11379B, 0xFCD53211, 0x460F63CE, 0xC5816E68, 0xFE5300AD, 0x0A0015EE, 0x9806DBBB, 0xEF4A2648 }; uint32_t key[4] = { 0x63656F6D, 0x21216674, 0x12345678, 0x9ABCDEF0 }; modefiedTea_decrypt(enc, key); unsigned char* flag_str = (unsigned char*)enc; for (int i = 0; i &lt; 40; i++) { if (flag_str[i] &gt;= 32 &amp;&amp; flag_str[i] &lt;= 126) { printf(&quot;%c&quot;, flag_str[i]); } else { printf(&quot;\\\\x%02X&quot;, flag_str[i]); } } printf(&quot;\\n&quot;); return 0;} week3have_fun é™„ä»¶æ˜¯ä¸€ä¸ªWindows GUIç¨‹åºï¼Œç•Œé¢å¦‚å›¾ã€‚å·¥å…·æ çš„â€œäº¤äº’â€å®ç°flagçš„éªŒè¯ã€‚ mainå‡½æ•°ä¸»è¦å®ç°çš„æ˜¯åˆ›å»ºçª—å£ï¼Œæ¶‰åŠåˆ°WNDCLASSEXWç»“æ„ä½“ï¼ˆè¯¦ç»†ä¿¡æ¯è§ï¼šWNDCLASSEXW ï¼ˆwinuser.hï¼‰ - Win32 apps | Microsoft Learnï¼‰ã€‚å…¶ä¸­ï¼Œç»“æ„ä½“å˜é‡lpfnWndProcæ¶‰åŠçª—å£è¿‡ç¨‹çš„å®ç°ï¼Œæ‰€ä»¥flagéªŒè¯çš„ç›¸å…³é€»è¾‘åœ¨lpfnWndProcæŒ‡å‘çš„å‡½æ•°ä¸­æŸ¥çœ‹ï¼ˆå›¾ä¸­é‡å‘½åä¸ºToolBarï¼‰ ToolBarä¸­ï¼Œå®ç°äº†å·¥å…·æ ä¸‰ä¸ªé€‰é¡¹çš„äº¤äº’é€»è¾‘ï¼Œå…¶ä¸­ï¼ŒDialogBoxParamWå®ç°çš„æ˜¯â€äº¤äº’â€œé€‰é¡¹ï¼ˆå› ä¸ºå‚æ•°DialogFuncçœ‹ç€æœ€å¤æ‚ï¼Œæœ€åƒflagéªŒè¯é€»è¾‘ï¼‰ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546//ToolBarå‡½æ•°LRESULT __fastcall ToolBar(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam){ HDC hdc; // rsi HFONT FontW; // rdi HGDIOBJ h; // rbx tagPAINTSTRUCT Paint; // [rsp+70h] [rbp-88h] BYREF switch ( Msg ) { case 2u: PostQuitMessage(0); break; case 0xFu: hdc = BeginPaint(hWnd, &amp;Paint); SetTextColor(hdc, 0xFFu); SetBkMode(hdc, 1); FontW = CreateFontW(36, 0, 0, 0, 700, 0, 0, 0, 1u, 0, 0, 0, 0x20u, &amp;pszFaceName); h = SelectObject(hdc, FontW); TextOutW(hdc, 500, 160, &amp;String, 15); TextOutW(hdc, 500, 200, &amp;word_7FF6D7EA3350, 10); SelectObject(hdc, h); DeleteObject(FontW); EndPaint(hWnd, &amp;Paint); break; case 0x111u: switch ( wParam ) { case 0x68u: DialogBoxParamW(hInstance, 0x67, hWnd, sub_7FF6D7EA1420, 0LL); break; case 0x69u: DestroyWindow(hWnd); break; case 0x9C42u: DialogBoxParamW(hInstance, 0x66, hWnd, DialogFunc, 0LL);//â€œäº¤äº’â€é€‰é¡¹ break; default: return DefWindowProcW(hWnd, Msg, wParam, lParam); } break; default: return DefWindowProcW(hWnd, Msg, wParam, lParam); } return 0LL;} DialogFuncå‡½æ•°ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596INT_PTR __fastcall DialogFunc(HWND hDlg, int a2, unsigned __int16 n1003){ HWND hDlg_1; // rbx int v4; // edx __int64 length; // rax int n32_2; // r8d __m128 si128; // xmm2 __int64 v8; // rdx unsigned __int64 v9; // rcx __m128 v10; // xmm0 __m128 v11; // xmm1 __m128 v12; // xmm0 __m128 v13; // xmm1 __int64 count; // rdx unsigned __int16 *currentChar; // rdx int currentEnc; // r8d int judgeNumber; // r9d const WCHAR *PrintText; // r8 _OWORD v20[2]; // [rsp+0h] [rbp-1D8h] BYREF WCHAR flag[8]; // [rsp+20h] [rbp-1B8h] BYREF _OWORD v22[12]; // [rsp+30h] [rbp-1A8h] BYREF _WORD flag_xored[104]; // [rsp+F0h] [rbp-E8h] BYREF hDlg_1 = hDlg; v4 = a2 - 272; if ( !v4 ) { PrintText = &amp;word_7FF6D7EA3368;LABEL_22: SetDlgItemTextW(hDlg, 1002, PrintText); return 1LL; } if ( v4 != 1 ) return 0LL; if ( (n1003 - 1) &gt; 1u ) { if ( n1003 == 1003 ) { GetDlgItemTextW(hDlg, 1001, flag, 100); length = -1LL; do ++length; while ( flag[length] ); n32_2 = 0; if ( length &gt;= 32 )// flagé•¿åº¦å¤§äº32çš„æƒ…å†µï¼ˆå®é™…ä¸Šä¸èƒ½æ˜¯è¿™ç§æƒ…å†µï¼‰ { si128 = _mm_load_si128(&amp;xmmword_7FF6D7EA33F0); v8 = 0LL; v9 = 0LL; do { v10 = _mm_loadu_si128(&amp;flag[v9 / 2]); n32_2 += 32; v8 += 32LL; v11 = _mm_loadu_si128(&amp;v22[v9 / 0x10]); v9 += 64LL; v22[v9 / 0x10 + 8] = _mm_xor_ps(v10, si128); v12 = _mm_loadu_si128(&amp;v20[v9 / 0x10]); v22[v9 / 0x10 + 9] = _mm_xor_ps(v11, si128); v13 = _mm_loadu_si128(&amp;v20[v9 / 0x10 + 1]); v22[v9 / 0x10 + 10] = _mm_xor_ps(v12, si128); v22[v9 / 0x10 + 11] = _mm_xor_ps(v13, si128); } while ( v8 &lt; (length - (length &amp; 31)) ); } count = n32_2;// ä¸Šè¿°æƒ…å†µåº”ä¸æˆç«‹ï¼Œå› æ­¤n32_2ä¸º0 if ( n32_2 &lt; length ) { do { flag_xored[count] = flag[count] ^ 0x2A; ++count; } while ( count &lt; length ); } flag_xored[length] = 0; currentChar = flag_xored; do { currentEnc = *(currentChar + &amp;enc - flag_xored);// enc[currentChar-flag_xored] judgeNumber = *currentChar - currentEnc; if ( judgeNumber ) break; ++currentChar; } while ( currentEnc ); if ( judgeNumber || (PrintText = &amp;right, length != 16) )// flagé•¿åº¦ç”±æ­¤å¤„å¾—å‡º PrintText = &amp;wrong; hDlg = hDlg_1; goto LABEL_22; } return 0LL; } EndDialog(hDlg, n1003); return 1LL;} é€»è¾‘å¾ˆæ˜æ˜¾ï¼Œéå†flagï¼Œæ¯ä¸ªå­—ç¬¦å¼‚æˆ–0x2Aï¼Œç„¶åå’Œencæ¯”è¾ƒã€‚è§£å¯†è„šæœ¬ï¼š 12345enc = [ 0x0047, 0x0045, 0x004F, 0x0049, 0x005E, 0x004C, 0x0051, 0x0062, 0x006A, 0x005C, 0x001E, 0x0075, 0x004C, 0x007F, 0x0044, 0x0057]flag = ''.join(chr(b ^ 0x2A) for b in enc)print(flag) guess é™„ä»¶ç¨‹åºæ˜¯ä¸€ä¸ªçŒœæ•°å­—æ¸¸æˆï¼Œç”¨IDAæ‰“å¼€ï¼Œé€šè¿‡å­—ç¬¦ä¸²è¡¨çš„å…³é”®æ•°æ®â€You are right!\\nâ€å¯ä»¥å¿«é€Ÿå®šä½åˆ°mainå‡½æ•°çš„ä½ç½® mainå‡½æ•°F5åç¼–è¯‘ä¸äº†ï¼Œsp valueæŠ¥é”™ï¼Œè¯´æ˜æœ‰èŠ±æŒ‡ä»¤ã€‚æŠŠæ ˆæŒ‡é’ˆå‹¾é€‰ä¸Šï¼Œä¼šå‘ç°æ ˆå¸§çªå˜çš„ä½ç½®ï¼š æ ˆå¸§æ”¹å˜å¤ªå¤šï¼Œæ˜æ˜¾ä¸å¯¹ï¼ŒæŠŠsub rsp, raxç»™nopæ‰ã€‚ç„¶åå¯ä»¥å‘ç°å‡½æ•°æœ«å°¾æ ˆå¸§ä¼šæœ‰ç‚¹é—®é¢˜ï¼š æŠŠadd rsp, 1428hä¹Ÿç»™nopæ‰ï¼Œè¿™æ ·mainå‡½æ•°åŸºæœ¬ä¸Šå¯ä»¥åç¼–è¯‘äº† 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172//ä¼˜åŒ–åçš„mainå‡½æ•°// bad sp value at call has been detected, the output may be wrong!int __fastcall main(int argc, const char **argv, const char **envp){ bool v3; // dl std::ostream *v4; // rax unsigned int v5; // eax _QWORD *v6; // rax std::ostream *v8; // rax __int64 v9; // rax __int64 v10; // rbx std::ostream *v11; // rax std::ostream *v12; // rax std::ostream *v13; // rax std::ostream *v14; // rax unsigned int n0x64; // [rsp+2Ch] [rbp-54h] _BYTE v17[2512]; // [rsp+30h] [rbp-50h] BYREF _BYTE v18[2512]; // [rsp+A00h] [rbp+980h] BYREF _BYTE v19[32]; // [rsp+13D0h] [rbp+1350h] BYREF _BYTE v20[40]; // [rsp+13F0h] [rbp+1370h] BYREF unsigned int n0x64_1; // [rsp+1418h] [rbp+1398h] int i; // [rsp+141Ch] [rbp+139Ch] _main(argc, argv, envp); std::ios_base::sync_with_stdio(0LL, v3); std::ios::tie((char *)in + 16, 0LL); cout(out, &quot;Welcome to MoeCTF 2025!\\n&quot;); cout(out, &quot;Let's play a game!\\n&quot;); cout(out, &quot;I have a secret number between 0 and 99, and you can guess it 10 times.\\n&quot;); v4 = (std::ostream *)cout(out, &quot;If you successly guessed it, I will give you the flag!&quot;); endl(v4); random_device((std::random_device *)v18); v5 = random_operator(v18); mersenne_twister_engine(v17, v5); std::random_device::~random_device((std::random_device *)v18); n0x64_1 = (unsigned int)mersenne_twister_engine_operator(v17) % 0x64; for ( i = 0; i &lt;= 9; ++i ) { cout(out, &quot;Please input your number: &quot;); std::ostream::flush(out); v6 = (_QWORD *)cin(in); if ( (unsigned __int8)std::ios::operator!((char *)v6 + *(_QWORD *)(*v6 - 24LL)) || n0x64 &gt;= 0x64 ) { v8 = (std::ostream *)cout(out, &quot;Invalid input&quot;); endl(v8); std::ios::clear((char *)in + 16, 0LL); v9 = std::numeric_limits&lt;long long&gt;::max(); std::istream::ignore(in, v9, 10); } else { if ( n0x64_1 == n0x64 ) { cout(out, &quot;You are right!\\n&quot;); v10 = cout(out, &quot;The flag is moectf{&quot;); hex_to_binary(v20, &amp;enc[abi:cxx11]); rc4_decrypt(v19, v20, &amp;key[abi:cxx11]); v11 = (std::ostream *)std::operator&lt;&lt;&lt;char&gt;(v10, v19); v12 = (std::ostream *)cout(v11, &quot;}.&quot;); endl(v12); std::string::~string(v19); std::string::~string(v20); break; } v13 = (std::ostream *)cout(out, &quot;That's not right...&quot;); endl(v13); } } v14 = (std::ostream *)cout(out, &quot;Thanks for your playing!&quot;); endl(v14); return 0;} å¯ä»¥çœ‹å‡ºï¼Œmainå‡½æ•°çš„é€»è¾‘æ˜¯å…ˆè·å–ä¸€ä¸ªæ•°å­—è¾“å…¥ï¼Œç„¶åç»è¿‡å’Œéšæœºæ•°æœ‰å…³çš„å„ç§æ“ä½œæ¥åˆ¤æ–­æ˜¯å¦ç¬¦åˆæ¡ä»¶ï¼Œç¬¦åˆæ¡ä»¶å°±è¾“å‡ºflagã€‚æ—¢ç„¶å¯ä»¥ç›´æ¥è¾“å‡ºflagï¼Œä¸å¦¨å°±åŠ¨è°ƒæ”¹å˜åˆ¤æ–­ç»“æœç›´æ¥å¾—åˆ°flagã€‚æ‰¾åˆ°å’Œè¾“å‡ºæœ‰å…³çš„åˆ¤æ–­é€»è¾‘çš„ä½ç½®ï¼š åŠ¨è°ƒç¨‹åºæ­¥è¿‡æ­¤å¤„åï¼Œæ”¹ä¸€ä¸‹ZFå³å¯è®©ç¨‹åºè·³åˆ°â€You are right!\\nâ€å¤„è·å¾—flagè¾“å‡ºã€‚å¥½åœ¨æœ¬é¢˜æ²¡æœ‰ç»™åŠ¨è°ƒæŒ–å‘ï¼Œå¯ä»¥ç›´æ¥å¾—åˆ°flagï¼š rusty_sudoku rustè¯­è¨€çš„æ•°ç‹¬æ¸¸æˆã€‚è¿è¡Œé™„ä»¶ç¨‹åºï¼Œæç¤ºé€†å‘åˆ†æç¨‹åºæ‰¾åˆ°æ•°ç‹¬å¹¶æ±‚è§£ã€‚ç”¨IDAæ‰“å¼€ï¼Œç»“åˆAIè¾…åŠ©ä¼˜åŒ–åmainå‡½æ•°é•¿è¿™æ ·ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428429430431432433434435436437438439440441442443444445446447448449450451452453454455456457458459460461462463464465466467468469470471472473474__int64 __fastcall rusty_sudoku::main(__int64 a1, __int64 a2, __int64 a3){ __int128 *md5_ctx_prt; // rdi __int64 temp; // rdx size_t cupy_size; // rdx unsigned __int8 *input_end; // rcx unsigned __int8 *trimmed_length; // rsi unsigned __int8 *trimmed_start; // r9 unsigned __int8 *input_ptr; // r8 char is_whitespace; // r11 unsigned __int8 *current_ptr; // rbx unsigned __int8 *trimmed_count; // rax unsigned int codepoint; // r11d int v14; // r9d int temp_val1; // r14d int temp_val2; // ebp unsigned int high_byte; // ebx __int64 alloc_result; // rbx char is_whitespace2; // bl unsigned __int8 *end_ptr; // r11 unsigned int codepoint2; // esi char byte1; // bl char byte2; // bp int temp_val3; // ebp int temp_val4; // ebx unsigned int high_byte2; // ebx size_t actual_size; // r15 __int64 alloc_size; // r14 __int64 allocated_mem; // rax __int64 expected_char; // r9 __int64 input_data; // rdx __int64 index; // rax int user_char; // ecx int v34; // edx int temp_val5; // r8d __int64 result; // rax __int64 user_index; // rax __int64 sudoku_index; // rdx int user_codepointer; // r8d int v40; // r9d int temp_val6; // r11d int temp_val7; // r10d int v43; // r10d int temp_val8; // ebp int temp_val9; // r11d __int64 temp_arg1; // rdx __int64 temp_arg2; // rdx __int64 temp_arg3; // rdx _BYTE buf[88]; // [rsp+30h] [rbp-178h] BYREF __int128 fmt_arg1; // [rsp+90h] [rbp-118h] BYREF __int128 fmt_arg2; // [rsp+A0h] [rbp-108h] __int128 fmt_arg3; // [rsp+B0h] [rbp-F8h] __int128 fmt_arg4; // [rsp+C0h] [rbp-E8h] __int128 fmt_arg5; // [rsp+D0h] [rbp-D8h] __int64 fmt_arg6; // [rsp+E0h] [rbp-C8h] _OWORD stdin_handle[5]; // [rsp+F0h] [rbp-B8h] BYREF char board_data; // [rsp+140h] [rbp-68h] _BYTE md5_hash[16]; // [rsp+150h] [rbp-58h] BYREF *buf = &amp;welcome; // &quot;Welcome to MoeCTF 2025!\\nPlease **find** my sudoku and fill it correctly.\\nAnd then I will give you the flag.\\nInput your answer in one line (without spaces).\\nfor example, 854219763397865421261473985785126394649538172132947856926384517513792648478651239 represents:\\n854|219|763\\n397|865|421\\n261|473|985\\n-----------\\n785|126|394\\n649|538|172\\n132|947|856\\n-----------\\n926|384|517\\n513|792|648\\n478|651|239\\n\\nYour answer:\\n&quot; *&amp;buf[8] = 1LL; *&amp;buf[16] = 8LL; *&amp;buf[24] = 0LL; std::io::stdio::_print(a1, a2, a3, buf); *buf = 0LL; *&amp;buf[8] = 1LL; *&amp;buf[16] = 0LL; *&amp;stdin_handle[0] = std::io::stdio::stdin(); md5_ctx_prt = stdin_handle; if ( (std::io::stdio::Stdin::read_line(stdin_handle, a2, buf, stdin_handle) &amp; 1) != 0 ) { *&amp;fmt_arg1 = temp; core::result::unwrap_failed(stdin_handle, a2, 14, &quot;Invalid input.src\\\\main.rs&quot;, &amp;fmt_arg1, &amp;off_7FF6BF752050); } cupy_size = *&amp;buf[8]; input_end = (*&amp;buf[8] + *&amp;buf[16]); if ( *&amp;buf[16] ) { trimmed_length = 0LL; trimmed_start = 0LL; input_ptr = *&amp;buf[8]; while ( 1 ) { current_ptr = input_ptr; trimmed_count = trimmed_start; codepoint = *input_ptr; if ( (codepoint &amp; 0x80u) != 0 ) { v14 = codepoint &amp; 0x1F; temp_val1 = input_ptr[1] &amp; 0x3F; if ( codepoint &lt;= 0xDFu ) { input_ptr += 2; codepoint = temp_val1 | (v14 &lt;&lt; 6); } else { temp_val2 = (temp_val1 &lt;&lt; 6) | input_ptr[2] &amp; 0x3F; if ( codepoint &lt; 0xF0u ) { input_ptr += 3; codepoint = (v14 &lt;&lt; 12) | temp_val2; } else { input_ptr += 4; codepoint = ((codepoint &amp; 7) &lt;&lt; 18) | (temp_val2 &lt;&lt; 6) | current_ptr[3] &amp; 0x3F; } } } else { ++input_ptr; } trimmed_start = &amp;trimmed_count[input_ptr - current_ptr]; if ( codepoint - 9 &gt;= 5 &amp;&amp; codepoint != 32 ) { if ( codepoint &lt; 0x80 ) goto LABEL_27; high_byte = codepoint &gt;&gt; 8; if ( codepoint &gt;&gt; 8 &gt; 0x1F ) { if ( high_byte == 32 ) { is_whitespace = *(core::unicode::unicode_data::white_space::WHITESPACE_MAP + codepoint) &gt;&gt; 1; } else { if ( high_byte != 48 ) goto LABEL_27; is_whitespace = codepoint == 12288; } } else if ( high_byte ) { if ( high_byte != 22 ) goto LABEL_27; is_whitespace = codepoint == 5760; } else { is_whitespace = *(core::unicode::unicode_data::white_space::WHITESPACE_MAP + codepoint); } if ( (is_whitespace &amp; 1) == 0 ) goto LABEL_27; } if ( input_ptr == input_end ) { alloc_result = 1LL; goto LABEL_58; } } } trimmed_start = 0LL; input_ptr = *&amp;buf[8]; trimmed_count = 0LL;LABEL_27: if ( input_ptr == input_end ) goto LABEL_53; while ( 1 ) { end_ptr = input_end; codepoint2 = *(input_end - 1); if ( (codepoint2 &amp; 0x80000000) != 0 ) { byte1 = *(input_end - 2); if ( byte1 &gt;= -64 ) { input_end -= 2; temp_val4 = byte1 &amp; 0x1F; } else { byte2 = *(input_end - 3); if ( byte2 &gt;= -64 ) { input_end -= 3; temp_val3 = byte2 &amp; 0xF; } else { input_end -= 4; temp_val3 = ((*(end_ptr - 4) &amp; 7) &lt;&lt; 6) | byte2 &amp; 0x3F; } temp_val4 = (temp_val3 &lt;&lt; 6) | byte1 &amp; 0x3F; } codepoint2 = (temp_val4 &lt;&lt; 6) | codepoint2 &amp; 0x3F; if ( codepoint2 - 9 &lt; 5 ) goto LABEL_31; } else { --input_end; if ( codepoint2 - 9 &lt; 5 ) goto LABEL_31; } if ( codepoint2 == 32 ) goto LABEL_31; if ( codepoint2 &lt; 0x80 ) break; high_byte2 = codepoint2 &gt;&gt; 8; if ( codepoint2 &gt;&gt; 8 &lt;= 0x1F ) { if ( high_byte2 ) { if ( high_byte2 != 22 ) break; is_whitespace2 = codepoint2 == 5760; } else { is_whitespace2 = *(core::unicode::unicode_data::white_space::WHITESPACE_MAP + codepoint2); } goto LABEL_30; } if ( high_byte2 == 32 ) { is_whitespace2 = *(core::unicode::unicode_data::white_space::WHITESPACE_MAP + codepoint2) &gt;&gt; 1; goto LABEL_30; } if ( high_byte2 != 48 ) break; is_whitespace2 = codepoint2 == 12288;LABEL_30: if ( (is_whitespace2 &amp; 1) == 0 ) break;LABEL_31: if ( input_ptr == input_end ) goto LABEL_53; } trimmed_start = &amp;end_ptr[trimmed_start - input_ptr];LABEL_53: trimmed_length = (trimmed_start - trimmed_count); if ( trimmed_start - trimmed_count &lt; 0 ) { alloc_size = 0LL; goto LABEL_110; } cupy_size = &amp;trimmed_count[*&amp;buf[8]]; if ( trimmed_start == trimmed_count ) { alloc_result = 1LL; trimmed_length = 0LL; goto LABEL_58; } actual_size = &amp;trimmed_count[*&amp;buf[8]]; RNvCs73fAdSrgOJL_7___rustc35___rust_no_alloc_shim_is_unstable_v2(stdin_handle, trimmed_length); alloc_size = 1LL; allocated_mem = __rustc::__rust_alloc(stdin_handle, trimmed_length, 1LL, trimmed_length); if ( !allocated_mem )LABEL_110: alloc::raw_vec::handle_error(stdin_handle, trimmed_length, trimmed_length, alloc_size, &amp;off_7FF6BF7521D8);// &quot;/rustc/29483883eed69d5fb4db01964cdf2af4d86e9cb2\\\\library\\\\alloc\\\\src\\\\slice.rs&quot; alloc_result = allocated_mem; cupy_size = actual_size;LABEL_58: memcpy(stdin_handle, trimmed_length, cupy_size); input_data = *buf; if ( *buf ) __rustc::__rust_dealloc(stdin_handle, trimmed_length, *buf, *&amp;buf[8], 1LL); if ( trimmed_length == 81 ) { index = 0LL; while ( index != 81 ) { user_char = *(alloc_result + index); if ( (user_char &amp; 0x80u) == 0 ) { ++index; } else { v34 = user_char &amp; 0x1F; expected_char = *(alloc_result + index + 1) &amp; 0x3F; if ( user_char &lt;= 0xDFu ) { index += 2LL; input_data = expected_char | (v34 &lt;&lt; 6); user_char = input_data; } else { expected_char = (expected_char &lt;&lt; 6); temp_val5 = expected_char | *(alloc_result + index + 2) &amp; 0x3F; if ( user_char &lt; 0xF0u ) { index += 3LL; input_data = (v34 &lt;&lt; 12); user_char = input_data | temp_val5; } else { input_data = (user_char &amp; 7) &lt;&lt; 18; user_char = input_data | (temp_val5 &lt;&lt; 6) | *(alloc_result + index + 3) &amp; 0x3F; if ( user_char == 1114112 ) break; index += 4LL; } } } if ( (user_char - 58) &lt; 0xFFFFFFF6 ) goto LABEL_72; } user_index = 0LL; sudoku_index = 0LL; while ( user_index != 81 ) { user_codepointer = *(alloc_result + user_index); if ( (user_codepointer &amp; 0x80u) != 0 ) { v40 = user_codepointer &amp; 0x1F; temp_val6 = *(alloc_result + user_index + 1) &amp; 0x3F; if ( user_codepointer &lt;= 0xDFu ) { user_index += 2LL; expected_char = temp_val6 | (v40 &lt;&lt; 6); user_codepointer = expected_char; if ( sudoku_index == 81 ) break; } else { temp_val7 = (temp_val6 &lt;&lt; 6) | *(alloc_result + user_index + 2) &amp; 0x3F; if ( user_codepointer &lt; 0xF0u ) { user_index += 3LL; expected_char = (v40 &lt;&lt; 12); user_codepointer = expected_char | temp_val7; if ( sudoku_index == 81 ) break; } else { expected_char = (user_codepointer &amp; 7) &lt;&lt; 18; user_codepointer = expected_char | (temp_val7 &lt;&lt; 6) | *(alloc_result + user_index + 3) &amp; 0x3F; if ( user_codepointer == 1114112 ) break; user_index += 4LL; if ( sudoku_index == 81 ) break; } } } else { ++user_index; if ( sudoku_index == 81 ) break; } expected_char = sudoku[sudoku_index]; if ( (expected_char &amp; 0x80u) != 0LL ) { v43 = expected_char &amp; 0x1F; temp_val8 = sudoku[sudoku_index + 1] &amp; 0x3F; if ( expected_char &lt;= 0xDFu ) { sudoku_index += 2LL; expected_char = temp_val8 | (v43 &lt;&lt; 6); if ( user_codepointer == 1114112 ) break; } else { temp_val9 = (temp_val8 &lt;&lt; 6) | sudoku[sudoku_index + 2] &amp; 0x3F; if ( expected_char &lt; 0xF0u ) { sudoku_index += 3LL; expected_char = (v43 &lt;&lt; 12) | temp_val9; if ( user_codepointer == 1114112 ) break; } else { expected_char = ((expected_char &amp; 7) &lt;&lt; 18) | (temp_val9 &lt;&lt; 6) | sudoku[sudoku_index + 3] &amp; 0x3Fu; if ( expected_char == 1114112 ) break; sudoku_index += 4LL; if ( user_codepointer == 1114112 ) break; } } } else { ++sudoku_index; if ( user_codepointer == 1114112 ) break; } if ( expected_char != 46 &amp;&amp; user_codepointer != expected_char ) { *&amp;stdin_handle[0] = aYouShouldNotCh; *(&amp;stdin_handle[0] + 1) = 32LL; *&amp;fmt_arg1 = stdin_handle; *(&amp;fmt_arg1 + 1) = &lt;&amp;T_as_core::fmt::Display&gt;::fmt; *buf = &amp;unk_7FF6BF7524E0; *&amp;buf[8] = 2LL; *&amp;buf[32] = 0LL; *&amp;buf[16] = &amp;fmt_arg1; *&amp;buf[24] = 1LL; result = std::io::stdio::_print(stdin_handle, 81LL, sudoku_index, buf); goto LABEL_73; } } sudoku::board::sudoku::Sudoku::from_str_line(stdin_handle, 81LL, alloc_result, buf, 81LL, expected_char); if ( buf[0] == 1 ) { *&amp;fmt_arg1 = *&amp;buf[4]; core::result::unwrap_failed( stdin_handle, 81, 43, &quot;called `Result::unwrap()` on an `Err` value&quot;, &amp;fmt_arg1, &amp;unk_7FF6BF752070); } board_data = buf[81]; stdin_handle[4] = *&amp;buf[65]; stdin_handle[3] = *&amp;buf[49]; stdin_handle[2] = *&amp;buf[33]; stdin_handle[1] = *&amp;buf[17]; stdin_handle[0] = *&amp;buf[1]; if ( sudoku::board::sudoku::Sudoku::is_solved(stdin_handle, 81LL, temp_arg1, stdin_handle) ) { *buf = &amp;off_7FF6BF752490; // &quot;Congratulation!\\n&quot; *&amp;buf[8] = 1LL; *&amp;buf[16] = 8LL; *&amp;buf[24] = 0LL; std::io::stdio::_print(stdin_handle, 81LL, temp_arg2, buf); fmt_arg4 = 0LL; fmt_arg3 = 0LL; fmt_arg2 = 0LL; fmt_arg1 = 0LL; fmt_arg6 = 0LL; fmt_arg5 = ::fmt_arg5; md5_ctx_prt = &amp;fmt_arg1; md5::consume(&amp;fmt_arg1, 81LL, alloc_result, &amp;fmt_arg1, 81LL); *&amp;buf[80] = fmt_arg6; *&amp;buf[64] = fmt_arg5; *&amp;buf[48] = fmt_arg4; *&amp;buf[32] = fmt_arg3; *&amp;buf[16] = fmt_arg2; *buf = fmt_arg1; md5::Context::finalize(&amp;fmt_arg1, 81LL, buf, md5_hash); *&amp;fmt_arg1 = md5_hash; *(&amp;fmt_arg1 + 1) = &lt;md5::Digest_as_core::fmt::LowerHex&gt;::fmt; *buf = &amp;YourFlagIs; // &quot;Your flag is moectf{&quot; *&amp;buf[8] = 2LL; *&amp;buf[32] = 0LL; *&amp;buf[16] = &amp;fmt_arg1; *&amp;buf[24] = 1LL; result = std::io::stdio::_print(&amp;fmt_arg1, 81LL, temp_arg3, buf); } else { *buf = &amp;TryAgain; // &quot;try again~\\n&quot; *&amp;buf[8] = 1LL; *&amp;buf[16] = 8LL; *&amp;buf[24] = 0LL; result = std::io::stdio::_print(stdin_handle, 81LL, temp_arg2, buf); } } else {LABEL_72: *buf = &amp;Invalid; // &quot;Invalid Solution.\\n&quot; *&amp;buf[8] = 1LL; *&amp;buf[16] = 8LL; *&amp;buf[24] = 0LL; result = std::io::stdio::_print(stdin_handle, trimmed_length, input_data, buf); }LABEL_73: if ( trimmed_length ) return __rustc::__rust_dealloc(md5_ctx_prt, trimmed_length, trimmed_length, alloc_result, 1LL); return result;} rusté€†å‘çš„ä¼ªä»£ç ä¸å¥½åˆ†æï¼Œä½†æ˜¯ä½œä¸ºæ•°ç‹¬æ¸¸æˆï¼Œåªéœ€è¦æ‰¾åˆ°æ•°ç‹¬å°±å¯ä»¥äº†ï¼Œå¯ä»¥shift+F12åœ¨å­—ç¬¦ä¸²è¡¨çª—å£æ‰¾åˆ°å¯ç–‘çš„æ•°æ®ï¼š ç»“åˆä¼ªä»£ç ï¼Œå¯ä»¥åˆ†æå‡ºç¨‹åºæ¥å—ç”¨æˆ·è¾“å…¥çš„å·²æ±‚è§£çš„æ•°ç‹¬åä¼šè¿›è¡Œæ£€éªŒï¼Œè‹¥æ•°ç‹¬æ­£ç¡®ä¸”æ±‚è§£æˆåŠŸï¼Œä¼šè¾“å‡ºflagï¼Œflagæ˜¯md5åŠ å¯†åçš„æ•°ç‹¬ã€‚æ‰€ä»¥ç›´æ¥åˆ©ç”¨ç¨‹åºå¾—åˆ°flagå³å¯ã€‚ç½‘ä¸Šæ‰¾ä¸€ä¸ªæ•°ç‹¬æ±‚è§£å·¥å…·æ±‚è§£ï¼šæ•°ç‹¬æ±‚è§£å™¨ - å…è´¹åœ¨çº¿æ•°ç‹¬æ–¹æ¡ˆè§£é¢˜å·¥å…·ï¼ˆå»ºè®®ä¸è¦ç›´æ¥æŠŠæ•°ç‹¬å¤åˆ¶ç»™AIæ±‚è§£ï¼Œå› ä¸ºAIä¼šä¹±æ”¹æ•°æ®ï¼Œç¬”è€…å¡åœ¨æ±‚è§£è¿™ä¸€æ­¥å¥½ä¹…ğŸ˜…ï¼‰ IDAåŠ¨æ€è°ƒè¯•ï¼ˆç›´æ¥è¿è¡Œç¨‹åºè¾“å…¥æ­£ç¡®æ•°ç‹¬è²Œä¼¼ä¼šé—ªé€€ï¼‰ï¼ŒæŠŠè§£å‡ºæ¥çš„æ•°ç‹¬æŒ‰æç¤ºçš„é¡ºåºè¾“å…¥ï¼Œå°±å¯ä»¥å¾—åˆ°flagï¼š week4ezandroid é™„ä»¶apkç”¨JEBæ‰“å¼€ï¼Œå‘ç°é€»è¾‘ä¸»è¦æ˜¯å°†è¾“å…¥çš„æ–‡æœ¬base64åŠ å¯†åè¿›è¡Œæ¯”è¾ƒ cyberchefä¸€æŠŠæ¢­ ezandroid.pro é™„ä»¶apkç”¨JEBæ‰“å¼€ï¼Œå¯ä»¥å‘ç°ä½¿ç”¨äº†ä¸€ä¸ªä»nativeå±‚ezandroidproåº“è½½å…¥çš„å‡½æ•°checkï¼Œç”±checkåˆ¤æ–­è¾“å…¥æ˜¯å¦æ­£ç¡® æŠŠapkè§£å‹ï¼Œåœ¨IDAä¸­æ‰“å¼€lib/armeabi-v7a/libezandroidpro.soï¼Œåœ¨Exportsç•Œé¢æ‰¾åˆ°Java_com_example_ezandroidpro_MainActivity_checkå‡½æ•°ï¼Œå³apkè½½å…¥çš„checkå‡½æ•° 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899bool __fastcall Java_com_example_ezandroidpro_MainActivity_check(int JENV, int a2, int a3){ _BOOL4 ret; // r5 const char *flag; // r0 const char *src; // r4 size_t length; // r0 size_t n; // r5 char *dest; // r9 unsigned int v11; // r10 char *str; // r4 int n96; // r2 int v14; // r0 unsigned __int8 *v15; // r2 int v16; // r1 char *_str; // r3 void *s1_1; // r6 unsigned __int8 v20; // [sp+4h] [bp-44h] BYREF _BYTE v21[7]; // [sp+5h] [bp-43h] BYREF void *s1; // [sp+Ch] [bp-3Ch] _DWORD v23[2]; // [sp+10h] [bp-38h] BYREF void *key; // [sp+18h] [bp-30h] _DWORD v25[2]; // [sp+1Ch] [bp-2Ch] BYREF void *dest_1; // [sp+24h] [bp-24h] ret = 0; flag = (const char *)(*(int (__fastcall **)(int, int, _DWORD))(*(_DWORD *)JENV + 676))(JENV, a3, 0); if ( !flag ) return ret; src = flag; length = strlen(flag); if ( length &gt;= 0xFFFFFFF0 ) std::__basic_string_common&lt;true&gt;::__throw_length_error(v25); n = length; if ( length &gt;= 0xB ) { v11 = (length + 16) &amp; 0xFFFFFFF0; dest = (char *)operator new(v11); v25[1] = n; dest_1 = dest; v25[0] = v11 + 1; goto LABEL_7; } LOBYTE(v25[0]) = 2 * length; dest = (char *)v25 + 1; if ( length )LABEL_7: j_memcpy(dest, src, n); dest[n] = 0; (*(void (__fastcall **)(int, int, const char *))(*(_DWORD *)JENV + 680))(JENV, a3, src); key = (void *)operator new(0x20u); strcpy((char *)key, &quot;moectf2025!!!!!!&quot;); v23[1] = 16; v23[0] = 33; str = (char *)operator new(0x70u); strcpy(str, &quot;4EEB1EEF2914D79BFA8C5006332097ED2EF06C4A59CAE31C827A08D45CC649C0B971BF2EFBCB160E531A646DF7A6AC0B&quot;); sm4Encrypt((int)&amp;v20, (int)v25, (int)v23); n96 = *(_DWORD *)&amp;v21[3]; v14 = v20 &amp; 1; if ( !v14 ) n96 = v20 &gt;&gt; 1; if ( n96 == 96 ) { if ( v14 ) { s1_1 = s1; ret = memcmp(s1, str, 0x60u) == 0; goto LABEL_20; } v15 = v21; v16 = v20 &gt;&gt; 1; _str = str; do { ret = *v15 == (unsigned __int8)*_str; if ( *v15 != (unsigned __int8)*_str ) break; ++_str; ++v15; --v16; } while ( v16 ); } else { ret = 0; } if ( v14 ) { s1_1 = s1;LABEL_20: operator delete(s1_1); } operator delete(str); if ( LOBYTE(v23[0]) &lt;&lt; 31 ) operator delete(key); if ( LOBYTE(v25[0]) &lt;&lt; 31 ) operator delete(dest_1); return ret;} å¯ä»¥çœ‹åˆ°ï¼Œcheckå‡½æ•°ä½¿ç”¨äº†sm4åŠ å¯†ï¼Œå¯†é’¥å¯èƒ½æ˜¯â€œmoectf2025!!!!!!â€ï¼Œè¿˜éœ€è¦çŸ¥é“åŠ å¯†æ¨¡å¼ã€‚å€ŸåŠ©AIåˆ†æå…·ä½“åŠ å¯†å‡½æ•°çŸ¥é“é‡‡ç”¨ECBåŠ å¯†æ¨¡å¼ï¼Œcyberchefä¸€æŠŠæ¢­ï¼š A simple program é™„ä»¶ç¨‹åºmainå‡½æ•°åç¼–è¯‘å‡ºæ¥å¤§æ¦‚æ˜¯è¿™æ ·ï¼š ä½†æ˜¯Str2è¿™ä¸ªåƒæ¨¡åƒæ ·çš„flagæ˜¯å‡çš„ï¼Œæäº¤ä¼šæ˜¾ç¤ºé”™è¯¯ã€‚ç»“åˆé¢˜ç›®æç¤ºï¼Œflagåº”è¯¥è—åœ¨å…¶ä»–åœ°æ–¹ã€‚ IDAçœ‹ä¸å‡ºæœ‰ä»€ä¹ˆå¥—è·¯åœ¨é‡Œé¢ï¼Œä½†æ˜¯åœ¨X32Dbgï¼Œstrncmpæ˜¯å¯ä»¥ç‚¹è¿›å»çš„ï¼ˆåœ¨IDAä¸­ï¼Œstrncmpæ˜¯ç²‰è‰²çš„å¯¼å…¥å‡½æ•°ï¼Œç‚¹å‡»å‡½æ•°æ²¡æœ‰è¯¦ç»†å†…å®¹ï¼‰ï¼Œç‚¹è¿›å»ä¼šå‘ç°ï¼Œé‡Œé¢è¿˜æœ‰ä¸€ä¸ªstrncmp åŠ ä¸Šæ³¨é‡Šï¼š æ‰€ä»¥çœŸæ­£çš„æ£€éªŒé€»è¾‘åœ¨strncmpé‡Œï¼Œç¨‹åºä»chall.4D31A4å–å‡ºçœŸæ­£çš„å¯†æ–‡ï¼Œç„¶åæŠŠè¾“å…¥çš„flagè¿›è¡Œå¼‚æˆ–å¤„ç†å†æ¯”è¾ƒã€‚åœ¨è½¬å‚¨ä¸­è·Ÿéš4D31A4å¯ä»¥è·å¾—å¯†æ–‡ï¼š è§£å¯†è„šæœ¬ï¼š 12345enc=[0x4E, 0x4C, 0x46, 0x40, 0x57, 0x45, 0x58, 0x7A, 0x13, 0x56, 0x7C, 0x73, 0x17, 0x50, 0x50, 0x66, 0x47, 0x02, 0x02, 0x5E]flag=&quot;&quot;for i in enc: flag+=chr(i^0x23)print(flag) week52048_master_re é™„ä»¶ç¨‹åºæ˜¯ä¸€ä¸ª2048å°æ¸¸æˆï¼Œé€šè¿‡æ–¹å‘é”®æ¥æ“ä½œæ•°å­—æ•´ä½“ç§»åŠ¨ã€‚æ ¹æ®æ¸¸æˆçª—å£å¯ä»¥æ¨æµ‹è¿™ä¹Ÿæ˜¯ä¸€ä¸ªGUIç¨‹åºã€‚ ç”¨IDAæ‰“å¼€é™„ä»¶ç¨‹åºï¼Œshift+F12å¯ä»¥åœ¨å­—ç¬¦ä¸²çª—å£çœ‹è§ä¸€äº›è››ä¸é©¬è¿¹ï¼ˆå› ä¸ºæ˜¯MFC GUIç¨‹åºï¼Œä¹Ÿå¯ä»¥ç›´æ¥æ‰¾WinMainå‡½æ•°ï¼Œç„¶åå†ä»ä¸­æ‰¾å‡ºå’Œflagæ£€éªŒæœ‰å…³çš„é€»è¾‘ï¼‰ï¼š è·Ÿè¸ªflag.txtå¯ä»¥å‘ç°ä¸€ä¸ªç–‘ä¼¼çš„å…³é”®å‡½æ•°ï¼š é€šè¿‡ç²—ç•¥åˆ†æå¯ä»¥æ¨æµ‹ç¨‹åºä»flag.txté‡Œè¯»å–æ•°æ®ï¼Œç„¶åè¿›è¡Œæ£€éªŒã€‚ä½†æ˜¯æ­¤å¤„æ²¡æœ‰ç›´æ¥çš„å’Œflagç›¸å…³çš„æç¤ºï¼Œè·Ÿè¸ªåˆ°ä¸Šçº§å‡½æ•°çœ‹çœ‹ã€‚é€‰ä¸­å‡½æ•°åæŒ‰XæŸ¥æ‰¾äº¤å‰å¼•ç”¨ï¼Œè·³è½¬åˆ°ä¸Šä¸€çº§å‡½æ•°ï¼š å‡ºé¢˜äººæ ¹æ®å¯ç–‘å‡½æ•°çš„è¿”å›å€¼è®¾ç½®äº†æç¤ºï¼Œçœ‹æ¥flagæ£€éªŒé€»è¾‘åœ¨æ­¤æ²¡é”™äº†ã€‚å›åˆ°å¯ç–‘å‡½æ•°ï¼Œå¯ä»¥çœ‹åˆ°å‡½æ•°ååŠéƒ¨åˆ†æ˜¯å¯¹Blockçš„æ£€éªŒï¼Œæ‰€ä»¥æ¨æµ‹sub_401A81æ˜¯ä¸€ä¸ªåŠ å¯†å‡½æ•°ã€‚è·Ÿè¸ªè¿›å»å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªé­”æ”¹xxteaå‡½æ•°å’Œä¸€ä¸ªç–‘ä¼¼æ•°æ®æ ¼å¼è½¬æ¢çš„å‡½æ•°ã€‚è¿™æ˜¯ä¼˜åŒ–åçš„æ ·å­ï¼š åˆ°è¿™é‡Œå¤§æ¦‚æŒæ¡äº†ä¸€äº›ä¿¡æ¯äº†ã€‚ä½†è¿˜æ˜¯è¦å®Œæ•´åˆ†æä¸€ä¸‹ç¨‹åºçš„æ•´ä½“é€»è¾‘ï¼Œç»§ç»­æ‰¾ä¸Šçº§å‡½æ•°ï¼Œå›æº¯åˆ°WinMainå‡½æ•°ã€‚ä¸‹é¢æ˜¯æ²¿ç€æ­£å‘è°ƒç”¨é€»è¾‘çš„åˆ†æï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352int __stdcall WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nShowCmd){ MSG Msg; // [rsp+60h] [rbp-90h] BYREF WNDCLASSEXA v6; // [rsp+90h] [rbp-60h] BYREF memset(&amp;v6, 0, sizeof(v6)); v6.cbSize = 80; v6.lpfnWndProc = check_2048; // æ¸¸æˆçš„æ£€éªŒé€»è¾‘ v6.hInstance = hInstance; v6.hCursor = LoadCursorA(0LL, 0x7F00); v6.hbrBackground = 5; v6.lpszClassName = &quot;WindowClass&quot;; v6.hIcon = LoadIconA(0LL, 0x7F00); v6.hIconSm = LoadIconA(0LL, 0x7F00); if ( RegisterClassExA(&amp;v6) ) { if ( CreateWindowExA( 0x200u, &quot;WindowClass&quot;, &quot;2048&quot;, 0x10CF0000u, 0x80000000, 0x80000000, 640, 480, 0LL, 0LL, hInstance, 0LL) ) { while ( GetMessageA(&amp;Msg, 0LL, 0, 0) &gt; 0 ) { TranslateMessage(&amp;Msg); DispatchMessageA(&amp;Msg); } return Msg.wParam; } else { MessageBoxA(0LL, &quot;Window Creation Failed!&quot;, &quot;Error!&quot;, 0x30u); return 0; } } else { MessageBoxA(0LL, &quot;Window Registration Failed!&quot;, &quot;Error!&quot;, 0x30u); return 0; }}//æ¸¸æˆæ£€éªŒå‡½æ•°LRESULT __fastcall check_2048(HWND hWnd, UINT n20, WPARAM wParam, LPARAM lParam){ unsigned int v4; // eax tagPAINTSTRUCT Paint; // [rsp+50h] [rbp-30h] BYREF struct tagRECT Rect; // [rsp+230h] [rbp+1B0h] BYREF HGDIOBJ h; // [rsp+248h] [rbp+1C8h] HDC hdcSrc; // [rsp+250h] [rbp+1D0h] HDC hdc; // [rsp+258h] [rbp+1D8h] LONG dwNewLong; // [rsp+264h] [rbp+1E4h] HMENU SystemMenu; // [rsp+268h] [rbp+1E8h] int i2; // [rsp+274h] [rbp+1F4h] int i1; // [rsp+278h] [rbp+1F8h] int nn; // [rsp+27Ch] [rbp+1FCh] int mm; // [rsp+280h] [rbp+200h] int kk; // [rsp+284h] [rbp+204h] int v18; // [rsp+288h] [rbp+208h] int jj; // [rsp+28Ch] [rbp+20Ch] int i14; // [rsp+290h] [rbp+210h] int i13; // [rsp+294h] [rbp+214h] int i12; // [rsp+298h] [rbp+218h] int i11; // [rsp+29Ch] [rbp+21Ch] int i10; // [rsp+2A0h] [rbp+220h] int v25; // [rsp+2A4h] [rbp+224h] int i9; // [rsp+2A8h] [rbp+228h] int i8; // [rsp+2ACh] [rbp+22Ch] int i7; // [rsp+2B0h] [rbp+230h] int i6; // [rsp+2B4h] [rbp+234h] int i5; // [rsp+2B8h] [rbp+238h] int i4; // [rsp+2BCh] [rbp+23Ch] int v32; // [rsp+2C0h] [rbp+240h] int i3; // [rsp+2C4h] [rbp+244h] int ii; // [rsp+2C8h] [rbp+248h] int n; // [rsp+2CCh] [rbp+24Ch] int m; // [rsp+2D0h] [rbp+250h] int k; // [rsp+2D4h] [rbp+254h] int j; // [rsp+2D8h] [rbp+258h] int v39; // [rsp+2DCh] [rbp+25Ch] int i; // [rsp+2E0h] [rbp+260h] char v41; // [rsp+2E7h] [rbp+267h] int i16; // [rsp+2E8h] [rbp+268h] int i15; // [rsp+2ECh] [rbp+26Ch] if ( n20 == 15 ) // ä¸‹é¢å¼€å§‹æ˜¯ä¸€å¤§ä¸²çš„æ£€éªŒæ“ä½œ { hdc = BeginPaint(hWnd, &amp;Paint); hdcSrc = CreateCompatibleDC(hdc); GetClientRect(hWnd, &amp;Rect); h = CreateCompatibleBitmap(hdc, Rect.right, Rect.bottom); SelectObject(hdcSrc, h); sub_4022AF(hdcSrc); BitBlt(hdc, 0, 0, Rect.right, Rect.bottom, hdcSrc, 0, 0, 0xCC0020u); DeleteObject(h); DeleteDC(hdcSrc); EndPaint(hWnd, &amp;Paint); } else if ( n20 &gt; 0xF ) { //...æ­¤å¤„çœç•¥ } else if ( n20 == 1 ) { SystemMenu = GetSystemMenu(hWnd, 0); dwNewLong = GetWindowLongA(hWnd, -16) &amp; 0xFFF8FFFF; SetWindowLongA(hWnd, -16, dwNewLong); SetWindowPos(hWnd, 0LL, 0, 0, 0, 0, 3u); ShowWindow(hWnd, 1); v4 = time64(0LL); srand(v4); hThread = CreateThread(0LL, 0LL, StartAddress, 0LL, 0, 0LL); CreateThread(0LL, 0LL, check_flag, 0LL, 0, 0LL);// è¿™é‡Œåˆ›å»ºäº†çº¿ç¨‹ï¼Œè€Œflagçš„æ£€éªŒå‡½æ•°å°±åœ¨è¿™ä¸ªçº¿ç¨‹é‡Œ if ( sub_401DBF(&quot;layout.dat&quot;) ) { sub_4645D0(&amp;Paint, &quot;layout.dat&quot;, 8); for ( i15 = 1; i15 &lt;= 4; ++i15 ) { for ( i16 = 1; i16 &lt;= 4; ++i16 ) sub_453880(&amp;Paint, &amp;dword_4B6040[5 * i15 + i16]); } sub_453880(&amp;Paint, &amp;dword_4B60A4); sub_464580(&amp;Paint); if ( MessageBoxA(0LL, &quot;Continue?&quot;, &quot;E=hv&quot;, 4u) == 7 ) { memset(dword_4B6040, 0, sizeof(dword_4B6040)); check(); check(); InvalidateRect(hWnd, 0LL, 1); dword_4B60A4 = 0; } sub_464C70(&amp;Paint); } else { check(); check(); dword_4B60A4 = 0; } } else { if ( n20 != 2 ) return DefWindowProcA(hWnd, n20, wParam, lParam); TerminateThread(hThread, 0); PostQuitMessage(0); } return 0LL;}//flagçš„æ£€éªŒå‡½æ•°__int64 __fastcall check_flag(LPVOID lpThreadParameter){ if ( !sub_401DBF(&quot;flag.txt&quot;) ) return 0LL; if ( get_check_flag() ) // è·å–å¹¶æ£€éªŒflag { MessageBoxA( hWnd, &quot;It seems you've uncovered some clues, but they're not enough to unlock the deepest secrets.&quot;, &quot;sandtea&quot;, 0x30u); return 1LL; } else { MessageBoxA(hWnd, &quot;You have found the final secret of 2048! - sandtea&quot;, &quot;Congratulations&quot;, 0x40u); return 0LL; }}//è·å–å¹¶æ£€éªŒflagçš„å‡½æ•°__int64 get_check_flag(){ size_t length; // rax char flag[136]; // [rsp+20h] [rbp-D0h] BYREF unsigned __int64 block_num; // [rsp+A8h] [rbp-48h] BYREF char key[32]; // [rsp+B0h] [rbp-40h] BYREF void *Block; // [rsp+D0h] [rbp-20h] FILE *FILE; // [rsp+D8h] [rbp-18h] unsigned __int64 i; // [rsp+E0h] [rbp-10h] unsigned int v8; // [rsp+ECh] [rbp-4h] FILE = fopen(&quot;flag.txt&quot;, &quot;r&quot;); file_read(FILE, &quot;%100s&quot;, flag); fclose(FILE); if ( strlen(flag) != 37 ) return 1LL; strcpy(key, &quot;2048master2048ma&quot;); length = strlen(flag); Block = encrypt(flag, length, key, &amp;block_num); if ( Block ) { v8 = 0; for ( i = 0LL; i &lt; block_num; ++i ) { if ( *(Block + i) != byte_495280[i] ) v8 = 1; } free(Block); return v8; } else { sub_428D00(&quot;Encryption failed\\n&quot;); return 1LL; }}//åŠ å¯†å‡½æ•°__int64 __fastcall encrypt(__int64 flag, unsigned __int64 length, _QWORD *key, __int64 block_num){ __int64 v5; // rdx _QWORD Key[3]; // [rsp+20h] [rbp-30h] BYREF unsigned __int64 word_num; // [rsp+38h] [rbp-18h] BYREF _WORD *block; // [rsp+40h] [rbp-10h] void *mem; // [rsp+48h] [rbp-8h] mem = new_mem(flag, length, &amp;word_num); // æ ¹æ®ä¼ å…¥çš„flagç”³è¯·äº†ä¸€å—å†…å­˜ï¼Œword_numæ˜¯ç”³è¯·çš„wordä¸ªæ•° if ( !mem ) return 0LL; v5 = key[1]; // è¿™æ˜¯ä¼ å…¥çš„å¯†é’¥ Key[0] = *key; Key[1] = v5; modifiedXXTea(mem, word_num, Key); // xxteaåŠ å¯† block = make_blocks(mem, word_num, block_num);// å¯¹åŠ å¯†åçš„æ•°æ®è¿›è¡Œä¸€äº›è½¬æ¢ï¼Œä»¥ä¾¿åç»­å’Œç»™å®šçš„æ•°æ®è¿›è¡Œæ ¡éªŒ free(mem); return block;}//ç”³è¯·å†…å­˜çš„å‡½æ•°_DWORD *__fastcall new_mem(__int64 flag, unsigned __int64 length, unsigned __int64 *word_num){ _DWORD *mem; // [rsp+28h] [rbp-18h] unsigned __int64 Word_num; // [rsp+30h] [rbp-10h] unsigned __int64 i; // [rsp+38h] [rbp-8h] Word_num = (length + 3) &gt;&gt; 2; // 10 mem = calloc(Word_num, 4uLL); // 10*4å­—èŠ‚çš„å†…å­˜ç©ºé—´ if ( !mem ) return 0LL; for ( i = 0LL; i &lt; length; ++i ) mem[i &gt;&gt; 2] |= *(flag + i) &lt;&lt; (8 * (i &amp; 3)); *word_num = Word_num; return mem;}//é­”æ”¹xxteaå‡½æ•°bool __fastcall modifiedXXTea(unsigned int *block, int word_num, __int64 key){ unsigned int *p1; // rax unsigned int *last_one1; // rax bool result; // al unsigned int *v6; // rax int v7; // [rsp+8h] [rbp-18h] unsigned int v8; // [rsp+8h] [rbp-18h] int round; // [rsp+Ch] [rbp-14h] int v10; // [rsp+Ch] [rbp-14h] unsigned int j; // [rsp+10h] [rbp-10h] int i; // [rsp+10h] [rbp-10h] unsigned int delta; // [rsp+14h] [rbp-Ch] unsigned int delta1; // [rsp+14h] [rbp-Ch] unsigned int last_one; // [rsp+18h] [rbp-8h] unsigned int v16; // [rsp+18h] [rbp-8h] unsigned int v17; // [rsp+18h] [rbp-8h] unsigned int p2; // [rsp+1Ch] [rbp-4h] unsigned int v19; // [rsp+1Ch] [rbp-4h] int v20; // [rsp+38h] [rbp+18h] if ( word_num &lt;= 1 ) { if ( word_num &lt; -1 ) { v20 = -word_num; v10 = 52 / -word_num + 6; delta1 = 0x3E9779B9 * v10; v19 = *block; do { v8 = (delta1 &gt;&gt; 2) &amp; 3; for ( i = v20 - 1; i; --i ) { v16 = block[i - 1]; v6 = &amp;block[i]; *v6 -= (((4 * v19) ^ (v16 &gt;&gt; 5)) + ((v19 &gt;&gt; 3) ^ (16 * v16))) ^ ((v19 ^ delta1) + (v16 ^ *(4LL * (v8 ^ i &amp; 3) + key))); v19 = *v6; } v17 = block[v20 - 1]; *block -= (((4 * v19) ^ (v17 &gt;&gt; 5)) + ((v19 &gt;&gt; 3) ^ (16 * v17))) ^ ((v19 ^ delta1) + (v17 ^ *(4LL * v8 + key))); v19 = *block; delta1 -= 0x3E9779B9; result = --v10 != 0; } while ( v10 ); } } else { round = 52 / word_num + 6; delta = 0; last_one = block[word_num - 1]; do { delta += 0x3E9779B9; v7 = (delta &gt;&gt; 2) &amp; 3; for ( j = 0; word_num - 1 &gt; j; ++j ) { p2 = block[j + 1]; p1 = &amp;block[j]; *p1 += (((4 * p2) ^ (last_one &gt;&gt; 5)) + ((p2 &gt;&gt; 3) ^ (16 * last_one))) ^ ((p2 ^ delta) + (last_one ^ *(4LL * (v7 ^ j &amp; 3) + key))); last_one = *p1; } last_one1 = &amp;block[word_num - 1]; *last_one1 += (((4 * *block) ^ (last_one &gt;&gt; 5)) + ((*block &gt;&gt; 3) ^ (16 * last_one))) ^ ((*block ^ delta) + (last_one ^ *(4LL * (v7 ^ j &amp; 3) + key))); last_one = *last_one1; result = --round != 0; } while ( round ); } return result;}//æ•°æ®æ ¼å¼è½¬æ¢å‡½æ•°_WORD *__fastcall make_blocks(__int64 mem, unsigned __int64 num_word, size_t *block_num){ _WORD *block; // [rsp+20h] [rbp-10h] unsigned __int64 i; // [rsp+28h] [rbp-8h] *block_num = 4 * num_word; block = malloc(*block_num); if ( !block ) return 0LL; for ( i = 0LL; i &lt; num_word; ++i ) { block[2 * i] = *(4 * i + mem); LOBYTE(block[2 * i + 1]) = BYTE2(*(4 * i + mem)); HIBYTE(block[2 * i + 1]) = HIBYTE(*(4 * i + mem)); } return block;} æ‰€ä»¥è¦è§£å‡ºflagï¼Œå°±éœ€è¦é€†å‘è¿™ä¸ªxxteaåŠ å¯†ã€‚æŠŠè¿™ä¸ªä»»åŠ¡äº¤ç»™AIï¼Œå¯ä»¥å¾—åˆ°è§£å¯†è„šæœ¬ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;string.h&gt;#include &lt;stdint.h&gt;// åŠ å¯†æ•°æ®ï¼ˆmake_blocksçš„è¾“å‡ºï¼‰uint8_t encrypted_data[40] = { 0x35, 0x79, 0x77, 0xCC, 0x1B, 0x13, 0x41, 0x34, 0xF9, 0xFF, 0x9F, 0x91, 0xFF, 0x5B, 0x94, 0x78, 0x86, 0x2A, 0xAF, 0xAE, 0xD7, 0x9E, 0x31, 0x4D, 0x7A, 0xC4, 0xA5, 0x51, 0xD1, 0xD9, 0x6E, 0x44, 0x18, 0x52, 0x86, 0x1B, 0x42, 0x8A, 0xC9, 0x63};// å¯†é’¥char key[17] = &quot;2048master2048ma&quot;;// é€†make_blocksï¼šå°†_WORDæ•°ç»„è½¬æ¢å›DWORDæ•°ç»„uint32_t* unmake_blocks(uint8_t* blocks, size_t block_bytes, size_t* num_dwords) { *num_dwords = block_bytes / 4; uint32_t* dwords = (uint32_t*)malloc(*num_dwords * 4); for (size_t i = 0; i &lt; *num_dwords; i++) { // å°†ä¸¤ä¸ªWORDåˆå¹¶ä¸ºä¸€ä¸ªDWORD uint16_t low_word = *(uint16_t*)&amp;blocks[4 * i]; uint16_t high_word = *(uint16_t*)&amp;blocks[4 * i + 2]; dwords[i] = (high_word &lt;&lt; 16) | low_word; } return dwords;}// é€†modifiedXXTeaè§£å¯†void decrypt_tea(uint32_t* data, int num_dwords, uint32_t* tea_key) { if (num_dwords &lt;= 1) return; int rounds = 52 / num_dwords + 6; uint32_t delta = 0x3E9779B9 * rounds; // 1050114489 uint32_t sum = delta; uint32_t y = data[0]; for (int i = 0; i &lt; rounds; i++) { uint32_t e = (sum &gt;&gt; 2) &amp; 3; for (int j = num_dwords - 1; j &gt; 0; j--) { uint32_t z = data[j - 1]; data[j] -= (((z &gt;&gt; 5) ^ (y &lt;&lt; 2)) + ((y &gt;&gt; 3) ^ (z &lt;&lt; 4))) ^ ((sum ^ y) + (tea_key[(j ^ e) &amp; 3] ^ z)); y = data[j]; } uint32_t z = data[num_dwords - 1]; data[0] -= (((z &gt;&gt; 5) ^ (y &lt;&lt; 2)) + ((y &gt;&gt; 3) ^ (z &lt;&lt; 4))) ^ ((sum ^ y) + (tea_key[e] ^ z)); y = data[0]; sum -= 0x3E9779B9; }}// ä»DWORDæ•°ç»„æå–å­—ç¬¦ä¸²char* extract_string(uint32_t* dwords, size_t num_dwords, size_t original_len) { char* str =(char*) malloc(original_len + 1); memset(str, 0, original_len + 1); for (size_t i = 0; i &lt; original_len; i++) { uint32_t dword = dwords[i &gt;&gt; 2]; str[i] = (dword &gt;&gt; (8 * (i &amp; 3))) &amp; 0xFF; } return str;}int main() { // æ­¥éª¤1: é€†make_blocks size_t num_dwords; uint32_t* tea_encrypted = unmake_blocks(encrypted_data, 40, &amp;num_dwords); printf(&quot;After unmake_blocks (%zu DWORDs):\\n&quot;, num_dwords); for (size_t i = 0; i &lt; num_dwords; i++) { printf(&quot;0x%08X &quot;, tea_encrypted[i]); } printf(&quot;\\n\\n&quot;); // æ­¥éª¤2: å‡†å¤‡TEAå¯†é’¥ï¼ˆå°†å­—ç¬¦ä¸²è½¬æ¢ä¸º4ä¸ª32ä½æ•´æ•°ï¼‰ uint32_t tea_key[4]; memcpy(tea_key, key, 16); printf(&quot;TEA Key:\\n&quot;); for (int i = 0; i &lt; 4; i++) { printf(&quot;0x%08X &quot;, tea_key[i]); } printf(&quot;\\n\\n&quot;); // æ­¥éª¤3: é€†modifiedXXTeaè§£å¯† decrypt_tea(tea_encrypted, num_dwords, tea_key); printf(&quot;After TEA decryption:\\n&quot;); for (size_t i = 0; i &lt; num_dwords; i++) { printf(&quot;0x%08X &quot;, tea_encrypted[i]); } printf(&quot;\\n\\n&quot;); // æ­¥éª¤4: æå–flagå­—ç¬¦ä¸²ï¼ˆåŸå§‹é•¿åº¦37å­—èŠ‚ï¼‰ char* flag = extract_string(tea_encrypted, num_dwords, 37); printf(&quot;Decrypted flag: %s\\n&quot;, flag); // æ¸…ç† free(tea_encrypted); free(flag); return 0;}","link":"/2025/10/12/Moectf2025ReverseWriteUp/"},{"title":"å‘¨è®°","text":"ç®€å•è®°å½•æ¯å‘¨æ”¶è· week1 (2025.3.4-2025.3.9) çœ‹åˆ°ç¾¤å‹è®²åˆ°å‘¨æŠ¥ï¼Œçµå…‰ä¸€é—ªè§‰å¾—å¯ä»¥å†™å†™å‘¨è®°æ¥è®°å½•è‡ªå·±çš„å­¦ä¹ ï¼Œä¹Ÿå½“ä½œä¸€ç§ç£ä¿ƒ è¿™å‘¨ä¸»è¦å­¦ä¹ ææ‰¿è¿œè€å¸ˆçš„ã€Šé€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç†ã€‹ï¼ˆå»å¹´12æœˆå›¾ä¹¦é¦†å€Ÿçš„ï¼Œè¿™å‘¨æ‰æ­£å¼å¼€å§‹çœ‹ğŸ˜“ï¼‰ ä¸»è¦å­¦ä¹ äº†åŠ¨æ€è°ƒè¯•çš„åŸºç¡€æŠ€èƒ½ã€‚æœ‰ï¼š è°ƒè¯•å™¨çš„åŸºç¡€æ“ä½œï¼ŒæŸ¥æ‰¾ç›®æ ‡ä»£ç çš„æ–¹æ³•ï¼ˆå¹²æ‰¾ï¼Œå­—ç¬¦ä¸²æ£€ç´¢ï¼Œä¸‹æ–­ç‚¹ï¼ŒAPIæ£€ç´¢åŠä¸‹æ–­ç‚¹ï¼‰ æ‰“è¡¥ä¸patchä¿®æ”¹è¾“å‡ºçš„å­—ç¬¦ä¸²ï¼ˆç›´æ¥ä¿®æ”¹æˆ–è€…å¯¼å‘ä¿®æ”¹çš„NULLå¡«å……åŒºåŸŸï¼‰å¹¶å¯¼å‡ºæ–°çš„å¯æ‰§è¡Œæ–‡ä»¶ å­—èŠ‚åºã€å¯„å­˜å™¨åŸºç¡€ æ ˆã€æ ˆå¸§ å‡½æ•°è°ƒç”¨çº¦å®šï¼ˆcdeclï¼ˆè°ƒç”¨è€…å¤„ç†æ ˆï¼‰ã€stdcallï¼ˆè¢«è°ƒç”¨è€…å¤„ç†æ ˆï¼‰ã€fastcallï¼ˆåŒstdcallï¼Œä½†æ˜¯ç»“åˆäº†æ ˆå’Œå¯„å­˜å™¨ï¼‰ï¼‰ week2 (2025.3.10-2025.3.16) è¿™å‘¨ä¸»è¦å­¦ä¹ äº†PEæ–‡ä»¶ç»“æ„çš„å†…å®¹ï¼ŒåŒæ­¥æ›´æ–°äº†å­¦ä¹ ç¬”è®° ï¼Œä¸»è¦æ˜¯PEæ–‡ä»¶çš„åŸºæœ¬ç»„æˆä»‹ç»ï¼Œç†è®ºçŸ¥è¯† å‘¨æœ«æœ¬æƒ³æ¥ç€ä¸‹ä¸€ç« çš„å­¦ä¹ ï¼Œä½†æ˜¯æ‘†å¤§çƒ‚äº†ï¼Œç”šè‡³PEç¬”è®°è¿˜æ²¡å†™å®Œ ä¸‹å‘¨æœ«å°±æ˜¯NCTFäº†ï¼Œä¸€ç‚¹å‡†å¤‡æ²¡æœ‰ï¼Œè¦ç‚¸æ‰äº† week3 (2025.3.17-2025.3.23) è¿™å‘¨è¿‡å¾—åˆå¿™åˆä¸çŸ¥é“åœ¨å¿™ä»€ä¹ˆï¼ŒPEæ–‡ä»¶ç»“æ„æœ€åçš„EATéƒ¨åˆ†æ²¡çœ‹æ‡‚ï¼Œ(T_T)ï¼Œç¬”è®°è¿˜æ²¡è¡¥å®Œ NCTFçˆ†é›¶äº†ï¼Œç¼–ç èƒ½åŠ›æ˜¯ç¡¬ä¼¤ï¼ŒçŸ¥è¯†æ›´æ˜¯ä¼¤ä¸ŠåŠ ä¼¤ (T_T) å¥½äº†ï¼ŒçœŸæ˜¯ç³Ÿç³•çš„ä¸€å‘¨ week4 (2025.3.24-2025.3.30) offlineä¸€å‘¨ week5 (2025.3.31-2025.4.6) æƒ³äº†æƒ³ï¼Œå‘ç°è‡ªå·±ä¸€ç›´å­˜åœ¨ä¸€ä¸ªé”™è¯¯ï¼Œå°±æ˜¯ä¸ºäº†ç¬”è®°è€Œåšç¬”è®°ï¼Œçº¯ç²¹çš„æ˜¯è®°å½•ï¼›ä½†æ˜¯å¥½åƒä»¥æ€»ç»“æˆ–è€…è¯´å¤è¿°çš„æ–¹å¼æ¥åšç¬”è®°æ‰æ¯”è¾ƒæœ‰ç”¨ è¿™å‘¨ç¢°ä¸Šæ¸…æ˜äº†ï¼Œæœ‰ä¸ªä¸‰å¤©å‡ã€‚è™½ç„¶ä½†æ˜¯ï¼Œä¾æ—§æ˜¯æ²¡æ€ä¹ˆå­¦æ–°ä¸œè¥¿ ä½†æ˜¯è‡³å°‘æ˜¯åšäº†ç‚¹ä»€ä¹ˆã€‚å‘¨æ—¥æŠŠPEæ–‡ä»¶æ ¼å¼æ”¶å°¾äº†ï¼ˆè¿˜æ˜¯æœ‰ç‚¹éš¾åº¦çš„ï¼Œå› ä¸ºå›å¤´çœ‹äº†å‰é¢åšçš„ç¬”è®°ï¼Œå‘ç°å¯¹IATå’ŒEATçš„è®¤è¯†æœ‰ç‚¹ä¸å¯¹åŠ²ï¼Œé‡æ–°æ¢³ç†äº†ä¸€éï¼Œåˆ åˆ æ”¹æ”¹ï¼‰ã€‚å­¦èªæ˜äº†ï¼Œè¿™æ¬¡æ˜¯çœ‹å®Œä¹¦å®Œæ•´åœ°æŠŠä¾‹å­å…ˆèµ°äº†ä¸€éå†åšçš„ç¬”è®° è¿™å‘¨åœ¨å’¸é±¼2å…ƒæ·˜åˆ°äº†ä¸€åŒ…è¯¾ï¼Œåé¢å‘ç°é‡Œé¢æœ‰ä¸€å¥—è¯¾ä½“ç³»æŒºå®Œæ•´çš„ï¼Œä¹Ÿæ˜¯æœ‰è¯¾è·Ÿäº† è¿˜æœ‰å°±æ˜¯å°è¯•äº†è‡ªå·±å†™pythonè§£å¯†è„šæœ¬ï¼Œå‘ç°æ²¡ä½“ç³»å­¦è¿‡ä¸€éçœŸä¸èƒ½ç¡¬ä¸Š week6 (2025.4.7-2025.4.13) è¿™å‘¨æ‰¾äº†ä¸ªçŸ­ä¸€äº›çš„pythonè§†é¢‘ï¼Œè·Ÿç€è¿‡äº†ä¸€éï¼Œç„¶åè¯•ç€åšé¢˜å†™è„šæœ¬ï¼Œæ‚¨çŒœæ€ä¹ˆç€ï¼Œè¿˜æ˜¯ä¸å¤ªä¼šğŸ¤¡ è§£å¯†å®åœ¨æ˜¯å¤ªåƒæ“ä½œäº†ï¼Œç»†ç»†ä¸€æƒ³ï¼Œå¥½åƒè§£å¯†è¿™ç©æ„æ›´åƒæ•°å­¦ï¼Œä¸€ä¸ªå–æ¨¡é€†å‘DSç›´æ¥ä¸Šå…¬å¼ï¼Œæˆ‘è¿˜åœ¨å¾ªç¯çˆ†ç ´è¢«é™¤æ•°ğŸ¤¡ ä¸å¾—ä¸æ‹¿å‡ºå››å­—çœŸè¨€ï¼šèœå°±å¤šç»ƒã€‚æ‰€ä»¥ï¼Œè¿™å‘¨å°±è¯•ç€åˆ·é¢˜æ¥äº† èŠ‚å¥è¿˜æ˜¯æ…¢äº†ç‚¹ï¼Œå”‰ week7 (2025.4.14-2025.4.20) emmmæ€ä¹ˆè¯´ï¼Œè¿™å‘¨å‰é¢å‡ å¤©å€’æ˜¯æŠ½æ—¶é—´åˆ·é¢˜äº†ï¼Œä½†æ˜¯ä¸€åˆ°å‘¨æœ«ï¼Œæ˜æ˜¾æ„Ÿåˆ°æ‡’äº† å‘¨ä¸‰èŠ±äº†ä¸€ä¸ªä¸‹åˆææ˜ç™½é‡å®šä½è¡¨ï¼Œç¬”è®°å†™äº†ï¼Œä½†æ˜¯åˆ‡å…¥ç‚¹å¥½åƒä¸æ˜¯å¾ˆå¯¹ã€‚è¿™æ¬¡çš„ç¬”è®°ï¼Œå› ä¸ºå‚è€ƒäº†DSç»™çš„è¾…åŠ©è®²è§£ï¼Œæ‰€ä»¥è·Ÿå‰é¢çš„æœ‰ç‚¹ä¸ä¸€æ ·ã€‚æ„Ÿè§‰ç”¨å½¢è±¡çš„ä¾‹å­æ¥ç±»æ¯”ä»¥åŠä»è®¾è®¡è€…è§’åº¦æè¿°ç»†èŠ‚ï¼Œæ›´æœ‰åˆ©äºåæœŸå¤ä¹ å†ç†è§£ è¿˜æ˜¯æ„Ÿè§‰æ•ˆç‡ä¸Šä¸æ¥ğŸ¤”ï¼Œæˆ‘åœ¨æƒ³è¦ä¸ç„¶å…ˆè·Ÿè¯¾èµ°ï¼Œä¸æ‡‚çš„åœ°æ–¹å†çœ‹ä¹¦ï¼Œä¼šä¸ä¼šå­¦çš„æ¸…æ¥šä¸€ç‚¹ï¼Œçœçš„è€å•ƒä¸€å¤„ æœ¬æ¥æ‰“ç®—å‘¨æœ«æ¥ä¸ªè„±å£³ç»ƒä¹ çš„ï¼Œé¸½äº†ï¼ˆï¼›Â´Ğ´ï½€ï¼‰ã‚ week8 (2025.4.21-2025.4.27) è¿™å‡ å¤©å›¾åºŠå´©äº†ï¼Œå›¾ç‰‡ä¸Šä¼ ä¸äº†ï¼Œä¹‹å‰çš„å›¾åœ¨åšå®¢é‡Œä¹Ÿæœ‰ç‚¹æ˜¾ç¤ºä¸å‡ºæ¥ï¼Œæ‰¾äº†å¥½ä¹…æ²¡æ‰¾åˆ°é—®é¢˜åœ¨å“ªé‡Œï¼Œåªèƒ½ä¼ åˆ°æœ¬åœ°å’Œå…¶ä»–æ–‡ä»¶ä¸€èµ·æ‰“åŒ…ä¼ githubäº† äº”ä¸€è°ƒä¼‘ä½¿æˆ‘æœ¬å°±çŸ­æš‚çš„å‘¨æœ«æ›´åŠ çŸ­æš‚ï¼ˆè™½ç„¶ç›®å‰ä¸ºæ­¢å‘¨æœ«è¿˜æ²¡æœ‰è¢«æˆ‘çœŸæ­£åˆ©ç”¨è¿‡ï¼‰ï¼Œè¿™å‘¨æ‹¿å¾—å‡ºæ‰‹çš„å°±åªæ˜¯ä¸€é“é¢˜ç›® emâ€¦å®é™…ä¸Šè¿™å‘¨èŠ±äº†ä¸å°‘æ—¶é—´æè„±å£³ç»ƒä¹ çš„ç¯å¢ƒã€‚ä¹°çš„è¯¾é‡Œå¤´è€å¸ˆè¯´ç”¨vs2008ç»ƒä¹ ï¼Œä½†æ˜¯è¯¥æ­»çš„è™šæ‹Ÿæœºæ²¡è”ç½‘å¾—è‡ªå·±å®‰è£…netframeworkï¼Œè¿™å°±èŠ±äº†ä¸å°‘æ—¶é—´ï¼Œä»¥åŠçµæœºä¸€åŠ¨æŠŠç¯å¢ƒæ­åœ¨win11ä¸Šäº†ï¼Œè¿™åˆèŠ±äº†ä¸€ç‚¹æ—¶é—´ã€‚è¿˜æœ‰ä¸€ç‚¹æ—¶é—´å°è¯•ç”¨è‡ªå·±å†™çš„ç¨‹åºåŠ å£³è„±å£³ï¼Œä½†æ˜¯æ²¡æŠ˜è…¾æˆåŠŸã€‚ è¿˜æœ‰ï¼Œæˆ‘æœ‰ç‚¹æ€€ç–‘è¿™ä¸ªè€å¸ˆçš„æˆåˆ†äº†ï¼Œä¸€å£ä¸€ä¸ªæŠ›ç –å¼•ç‰ï¼Œä¸€å£ä¸€ä¸ªè‡ªå·±çœ‹ï¼ˆæˆ‘è¦æ˜¯è‡ªå·±ä¼šå­¦è¿˜çœ‹è¯¾å¹²ä»€ä¹ˆï¼‰ğŸ« ã€‚ä½†æ˜¯æ‰¾ä¸åˆ°æ¯”ä»–çš„è¯¾æ›´å®Œæ•´çš„winé€†å‘èµ„æºäº†ğŸ˜” week9 (2025.4.28-2025.5.4) è¿™å‘¨ç¢°ä¸Šäº†å®éªŒå‘¨å’Œäº”ä¸€å‡æœŸï¼Œçœ‹ä¼¼ç©ºé—²æ—¶é—´å¾ˆå¤šï¼Œä½†å®é™…ä¸Šå¹¶éå¦‚æ­¤ï¼ˆå€Ÿå£ CSå•Šï¼Œä¸‰å¤©é€Ÿé€šæ•°å­¦å®éªŒï¼Œè¿˜è¦å†™è€åšä¸€æœ¬çš„å®éªŒæŠ¥å‘Šï¼Œç”šè‡³æŠ¥å‘Šè¿˜åŒ…æ‹¬ä¸¤ç¯‡è®ºæ–‡ï¼Œç¦»è°±äº†ğŸ«  å¥½çš„ï¼Œçœ‹æ¥è¿™å‘¨ä¾æ—§æ˜¯æ²¡ä»€ä¹ˆå­¦ä¹ æ”¶è·çš„ä¸€å‘¨ã€‚é™¤äº†å•å¼€äº†ä¸€ä¸ªIDAproçš„å­¦ä¹ ç¬”è®°ï¼ˆå››å¤„ç¢°å£åªèƒ½å­¦å­¦å·¥å…·çš„ä½¿ç”¨äº†ï¼‰ week10 (2025.5.5-2025.5.11) è¿™å‘¨æŠ˜è…¾ç”µè£…å®ä¹ å’Œæ•°å­¦å®éªŒï¼Œè¿˜è¦å¤ä¹ å¤§ç‰©å’Œé«˜æ•°ï¼Œå¿™æ­»äº†ï¼Œå”‰ week11 (2025.5.12-2025.5.18) è¯¶ï¼Œæµ…æ‘†ä¸€å‘¨ week12 (2025.5.19-2025.5.25) å¿«æœŸæœ«æœˆäº†å•Šï¼Œå“å‘€ï¼Œä¸€å­¦æœŸåˆè¦è¿‡å»äº† å¼€å§‹æœ‰ç‚¹è€ƒè¯•å‰çš„ç´§å¼ æ„Ÿäº†ï¼Œè¿™å‘¨ä¸»è¦æ‹¿æ¥æå­¦ä¸šäº†ï¼Œå¤§ç‰©ã€é«˜æ•°ã€ç”µå·¥æ¨¡ç”µè¿˜æœ‰å…­çº§å¤šæ‰‹æŠ“ğŸ™ƒ è¯¶ï¼Œä½†æ˜¯ä¼˜åŒ–äº†ä¸€ä¸‹åšå®¢çš„ç•Œé¢ï¼ŒæŠ˜è…¾äº†å¿«æœ‰ä¸‰å¤©æ—¶é—´ã€‚ä¸»è¦å°±æ˜¯ç»™ä¸»é¡µæ”¹æˆäº†åˆ†ç±»å¡ç‰‡ï¼Œä¸‹ä¸€çº§æ‰æ˜¯æ–‡ç« ï¼Œè¿™æ ·å­ç»“æ„æ›´æ¸…æ™°ä¸€ç‚¹ã€‚è¿˜æœ‰ä¸€äº›å°åœ°æ–¹çš„ç¾åŒ–ï¼Œä»¥åŠé˜…è¯»æ¬¡æ•°ç»Ÿè®¡çš„é—®é¢˜ï¼ˆä»leancloudå›½å†…ç‰ˆåˆ°ä¸è’œå­åˆ°leancloudå›½é™…ç‰ˆåˆå›åˆ°leancloudå›½å†…ç‰ˆâ€¦å“‡ï¼Œçœ‹æ¥æˆ‘å’ŒDSè€å¸ˆçš„åè°ƒèƒ½åŠ›è¿˜ä¸æ˜¯å¾ˆå¥½ï¼Œæ¯•ç«Ÿå…‰è¿™ä¸€é¡¹å°±è¦äº†å·®ä¸å¤š1å¤©æ—¶é—´ğŸ™ƒå¤´éƒ½å¤§äº†ï¼‰ æœ¬æ¥æ‰“ç®—å‘¨æœ«æŠŠæ²¡è·Ÿä¸Šçš„è¯¾ä¸šè¡¥ä¸Šï¼Œä½†æ˜¯ä¼˜åŒ–åšå®¢å°±å äº†å‘¨å…­ä¸€ä¸ªä¸Šåˆï¼Œå‘¨å…­ä¸€ä¸ªä¸‹åˆæé‚£ä¸ªC++æ…•è¯¾ï¼ˆä¸å½“äººå•Šï¼Œé¢˜ç›®è®©ç›´æ¥å¤åˆ¶çš„è¾“å‡ºå®ç°ä»£ç å’Œè¾“å‡ºè¦æ±‚ä¸€æ¨¡ä¸¤æ ·ï¼‰ï¼Œä½†æ˜¯æˆ‘è¿˜æœ‰é«˜æ•°å¤§ç‰©ç‰¹åˆ«æ˜¯æ¨¡ç”µå’Œå…­çº§ä»¥åŠè¿˜æœ‰ä¸ªç”µè£…å®ä¹ æŠ¥å‘Šå’Œç‰©ç†å®éªŒæŠ¥å‘Šï¼Œå‹åŠ›éƒ½ç»™åˆ°å‘¨æ—¥ï¼Œå¯æƒ³è€ŒçŸ¥ è¿˜æœ‰ä¸€ä»¶äº‹ï¼Œè¿™å‘¨é€®ç©ºçœ‹äº†çœ‹helloç®—æ³•ï¼ˆå°±æ˜¯è¿™ä¸ªï¼šhttps://www.hello-algo.com/chapter_hello_algo/ ï¼Œä¸Šå­¦æœŸå›¤ä¸‹æ¥çš„èµ„æºï¼‰æœ€è¿‘åˆšå¥½ä¹°çš„è¯¾é‡Œå¤´è®²Cå’ŒC++çš„æ—¶å€™æåˆ°äº†æ•°æ®ç»“æ„ï¼Œä½†æ˜¯å®åœ¨æ‰¾ä¸åˆ°æ—¶é—´çœ‹è§†é¢‘ï¼Œå°±åªèƒ½çœ‹çœ‹ä¹¦äº†ã€‚å“‡ï¼ŒU1S1æ˜¯çœŸä¼˜è´¨èµ„æ–™å•Šã€‚å›å¤´çœ‹çœ‹å†åŠ ä¸€ä¸ªæ•°æ®ç»“æ„ä¸ç®—æ³•çš„åˆ†ç±»ï¼Œåæ­£ä¸‹å­¦æœŸå¥½åƒä¹Ÿè¦å­¦äº† å…¶å®è¿˜æœ‰ç‚¹äº‹æƒ…ï¼Œå†™è¿™ä¸ªåšå®¢çš„åˆå¿ƒå…¶å®ä¸æ˜¯ä»€ä¹ˆè®°å½•æ”¶è·ï¼Œè€Œæ˜¯å› ä¸ºæˆ‘æ²¡æœ‰æ‰¾åˆ°å¯ä»¥å­¦ä¹ æ•ˆä»¿çš„å¯¹è±¡ï¼Œçœ‹å¤§ä½¬çš„åšå®¢éƒ½æ˜¯æ›´æ–°çŸ¥è¯†ï¼Œå¾ˆå°‘æœ‰äººæåˆ°ä¸ºä»€ä¹ˆä¼šæƒ³åˆ°å»å­¦è¿™äº›çŸ¥è¯†ï¼Œå°±æ˜¯ï¼Œæ²¡äººä¼šå‘Šè¯‰ä½ ä¸‹ä¸€æ­¥è¯¥å¹²ä»€ä¹ˆï¼ŒçŸ¥è¯†é‚£ä¹ˆå¤šå´åˆæ‰¾ä¸åˆ°å­¦ä¹ çš„æ–¹å‘ï¼Œå°±æ˜¯è¿™ç§æ„Ÿè§‰ã€‚æ‰€ä»¥æƒ³è®°å½•è®°å½•è‡ªå·±çš„å­¦ä¹ ç»å†ï¼Œæ–¹ä¾¿æ¢³ç†å­¦ä¹ è·¯çº¿ï¼Œä¹Ÿå¸Œæœ›å¤šå°‘å¯ä»¥ç»™å°†æ¥åƒæˆ‘ä¸€æ ·è¿·èŒ«çš„äººä¸€äº›æŒ‡å¼•ã€‚ å…¶å®å¼€å§‹å­¦ä¹ çš„æ—¶å€™ï¼Œæˆ‘ä¼šæ—¶ä¸æ—¶å»çœ‹çœ‹åŒçº§çš„å¤§ä½¬çš„åšå®¢ï¼Œçœ‹åˆ°ä»–ä»¬æ›´æ–°çš„éƒ½æ˜¯æˆ‘æ²¡æœ‰å¬è¯´è¿‡çš„çŸ¥è¯†ï¼Œçœ‹ç€ä»–ä»¬å˜å¾—è¶Šæ¥è¶Šä¸“ä¸šè¶Šæ¥è¶Šå‰å®³ï¼Œé•¿ä¹…ä¸‹æ¥å¿ƒé‡Œå¾ˆä¸æ˜¯æ»‹å‘³ã€‚é«˜ä¸­æ—¶å€™é‚£ç§æ— åŠ›æ„Ÿå°±åˆå‡ºç°äº†ã€‚åæ¥æˆ‘å°±éšçº¦è§‰å¾—ä¸å¯¹åŠ²ï¼Œè¿™ä¸å°±æŠŠå¤§å­¦åˆè¿‡æˆé«˜ä¸­äº†å—ï¼Ÿâ€œæ¯”è¾ƒçš„ç»ˆç‚¹æ˜¯è‡ªå‘ï¼Œä¸“æ³¨çš„ç»ˆç‚¹æ˜¯è‡ªç”±â€ï¼Œæƒ³æƒ³å½“åˆæƒ³å­¦ä¿¡å®‰ä¸å°±æ˜¯å› ä¸ºå–œæ¬¢å—ï¼ˆè™½ç„¶é‚£æ—¶å€™ç¡®å®ä¸çŸ¥é“å…·ä½“å¾—å­¦ä»€ä¹ˆï¼‰ï¼Œä¸ºä»€ä¹ˆè¦å’Œåˆ«äººæ¯”å‘¢ï¼Ÿé«˜ä¸­çš„æ—¶å€™æˆ‘æ€»æ˜¯åˆ»æ„ä¸èå…¥æ¯”è¾ƒçš„æ°›å›´ï¼Œè€Œç°åœ¨æ²¡æœ‰äº†é‚£æ ·åšé‡çš„å­¦ä¹ ç¯å¢ƒï¼Œæˆ‘å´ä¸è‡ªè§‰å¼€å§‹æ¯”è¾ƒèµ·æ¥äº†ï¼Œå”‰ğŸ˜”æ‰€ä»¥è¿™äº›å¤©å…¶å®ä¸€ç›´åœ¨è°ƒæ•´è‡ªå·±çš„å¿ƒæ€ï¼Œå¥½åœ¨ç°åœ¨æˆ‘æ„Ÿè§‰æ…¢æ…¢åœ°ä¸å†é¢‘ç¹ç«™åœ¨å¤–ç•Œå»å®¡è§†è‡ªå·±äº†ï¼Œå¼€å§‹è§‰å¾—æ¯å¤©èƒ½çœ‹è§é˜³å…‰ã€èƒ½å¤Ÿåœ¨æ™šè‡ªä¹ ä¸Šä¸‹è¯¾çš„è·¯ä¸Šè¾¹å¬æ­Œè¾¹èµ°è·¯ã€èƒ½å¤Ÿå®ç°å¼•ä½“å‘ä¸Šæ‹‰0ä¸ªåˆ°æ‹‰6ä¸ªï¼ˆå°½ç®¡æ˜¯åœ¨æœ‰å¼¹åŠ›å¸¦è¾…åŠ©çš„æƒ…å†µä¸‹ã€èƒ½å¤Ÿåœ¨ç¤¾å›¢çš„å®£è®²æ´»åŠ¨ä¸Šæ‰¿æ‹…ä¸€éƒ¨åˆ†å‘è¨€çš„è´£ä»»â€¦â€¦è¿™äº›éƒ½è®©æˆ‘çš„ç”Ÿæ´»å˜å¾—è¶Šæ¥è¶Šç¾å¥½ã€‚è¿™å¯èƒ½å°±æ˜¯çŸ¥è¶³å¸¸ä¹çš„æ„Ÿè§‰å§ï¼Œåæ­£æ´»å¾—æ›´å¼€å¿ƒäº†ï¼Œä¹Ÿæ›´æœ‰è¡ŒåŠ¨çš„èƒ½é‡äº†ï¼Œä¹ŸæŒºå¥½ ä»Šå¤©çš„å­—æ•°æœ‰ç‚¹è¶…æ ‡äº†å“ˆå“ˆğŸ˜„ä½†æ˜¯ä¸ç®¡äº† æ¥ä¸‹æ¥ä¸€ä¸ªæœˆå¤šä¸çŸ¥é“ä¼šä¸ä¼šè¿˜æœ‰æœºä¼šæ›´æ–°ç‚¹çŸ¥è¯†ç¬”è®°ï¼Œä½†æ˜¯å¸Œæœ›æš‘å‡å¯ä»¥å¥½å¥½å­¦å­¦å§ï¼ˆæ±‚æ±‚æˆ‘è‡ªå·±äº† æ—¢ç„¶æåˆ°äº†å­¦ä¹ è·¯çº¿ï¼Œè¦ä¸ç„¶è¿™é‡Œæ¢³ç†ä¸€æ®µå§ï¼Œå…¶å®æœ‰äº›ä¸œè¥¿æ²¡è®°ä¸Šæ¥ã€‚åˆšå¼€å§‹æ˜¯ä»ã€Šé€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç†ã€‹å¼€å§‹å­¦çš„ï¼Œä½†æ˜¯å­¦äº†å¿«ä¸€ä¸ªæœˆæ„Ÿè§‰æ•ˆç‡ä¹Ÿä¸è¡Œå•Šï¼Œåé¢å¼€å§‹æ‰¾è¯¾ï¼Œæ‰¾åˆ°äº†ä¸€ä¸ªå…¨è·¯çº¿çš„è¯¾ï¼ˆç›®å½•é‡Œæ˜¯åŒ…å«äº†æ¸—é€æµ‹è¯•å’Œé€†å‘å…æ€çš„ï¼‰ä½†æ˜¯æ„Ÿè§‰é€†å‘é‚£éƒ¨åˆ†è€å¸ˆæœ‰ç‚¹æ··å•Šï¼Œä¸Šè¯¾å°±å±•ç¤ºç¬”è®° ï¼Œè¯´è¯ä¹Ÿå«å«ç³Šç³Šçš„ï¼Œè¿˜æ—¶ä¸æ—¶æ¥å¥ä¸»è¦æ˜¯æŠ›ç –å¼•ç‰ï¼Œå°±æ„Ÿè§‰è¿™æ ·ä¸‹æ¥ä¹Ÿå­¦å¾—è¿·è¿·ç³Šç³Šçš„ï¼Œæ‰€ä»¥åˆå»æ‰¾æ–°çš„è¯¾ã€‚ç°åœ¨æ˜¯æ‰¾åˆ°äº†å¦å¤–ä¸¤å¥—ï¼Œä¸€å¥—æ˜¯windowså†…æ ¸å®‰å…¨ï¼Œä¸€å¥—æ˜¯çº¢é˜Ÿå…æ€ï¼ˆä¸¤å¥—è¯¾åŒä¸€å®¶æœºæ„çš„ï¼Œjayxï¼‰ï¼Œè¿™ä¸ªä½“ç³»æ„Ÿè§‰ä¹Ÿå¾ˆæ¸…æ™°ï¼Œè€å¸ˆè®²è¯¾ï¼ˆè‡³å°‘çœ‹äº†å‡ èŠ‚è¯¾ä¸‹æ¥ï¼‰å€’ä¹Ÿæ¸…æ¥šï¼Œå®è·µä¸ºä¸»ã€‚æ‰€ä»¥ç°åœ¨ç¡®å®šä¸‹æ¥æ˜¯è·Ÿç€æœ€æ–°çš„ä¸¤å¥—å­¦ã€‚åé¢å¯èƒ½ä¼šè€ƒè™‘æ”¹æ”¹ä¹‹å‰è®°çš„ç¬”è®°ã€‚ å•Šå¯¹äº†ï¼Œè¿˜å¾—ç‹¡è¾©ä¸€ä¸‹ã€‚æˆ‘å‘ç°week2å¼€å§‹å°±ä¸æ˜¯è®°å½•æ”¶è·äº†ï¼Œåƒæ˜¯æŠ¥å¤‡å¹²äº†ä»€ä¹ˆğŸ˜„å…¶å®ä¹Ÿæ²¡ä»€ä¹ˆå†™çš„ï¼Œå› ä¸ºè¿˜åœ¨æ‘¸ç´¢ã€‚ week13 (2025.5.26-2025.6.1) è¿™å‘¨æœ¬æ¥æ˜¯è¯•ç€æŠŠåšå®¢éƒ¨ç½²åˆ°vercelä¸Šæ–¹ä¾¿å›½å†…è®¿é—®çš„ï¼ˆDeepSeekè¯´å¯ä»¥çš„ï¼‰ï¼Œä½†æ˜¯æ²¡æŠ˜è…¾æ˜ç™½ï¼Œæ‰€ä»¥æœ¬æ¥æ²¡æ‰“ç®—å†™ä»€ä¹ˆçš„ã€‚ç»“æœï¼Œå‘¨æ—¥æ™šä¸Š11ç‚¹å¤šæ‰“å¼€åšå®¢æ–‡ä»¶å¤¹ï¼Œå‘ç°æœ‰ç‚¹ä¸å¯¹åŠ²ï¼Œä¸€è®¿é—®ï¼Œåšå®¢å´©äº†ğŸ˜… åƒé”™ä¸‡é”™å°±ä¸è¯¥é”™åœ¨ä»€ä¹ˆéƒ½ä¸æ‡‚è¿˜è·Ÿç€DeepSeekèµ°ï¼Œå“‡ï¼ŒçœŸçš„ï¼Œéš¾ä»¥æè¿°è¿™ç§æ„Ÿè§‰ï¼Œå…‰è¿™ç¯‡å‘¨è®°å°±æœ‰77å¤©äº†å•Šï¼ŒğŸ˜… è¿™æ®µè¯å…¶å®æ˜¯6.2å†™çš„ï¼Œå‘¨æ—¥æ™šä¸Šä¿®åšå®¢ä¿®åˆ°1ç‚¹ï¼Œå°è¯•ä¿®å¤ä½†æ˜¯è¡Œä¸é€šğŸ˜… å“‡ï¼Œè¿™ä¸ªäººå·¥æ™ºèƒ½ï¼Œå®ƒæ•™æˆ‘ç”¨rm rfï¼Œè™½ç„¶ä¸æ˜¯windowsçš„æŒ‡ä»¤ï¼Œä½†æ˜¯å®ƒèƒ½åœ¨æ•™ç¨‹é‡Œç”¨ä¸Šè¿™æ ·çš„æŒ‡ä»¤ï¼Œå“‡ï¼ŒçœŸçš„ï¼ŒçœŸæ˜¯è¿™ä¸ªğŸ‘ã€‚æˆ‘çœŸçš„ï¼Œå“‡ï¼Œè¦æ— è¯­æ­»äº† 6.2å°±æŠ˜è…¾ä¸€å¤©çš„åšå®¢ï¼ŒæŠŠåŸæ¥çš„åšå®¢åºŸæ‰äº†ï¼Œé‡æ„äº†ä¸€ä¸ªã€‚å“‡ï¼Œä¸€æœæ•™ç¨‹ï¼Œå’Œå½“åˆåˆšå¼€å§‹æåšå®¢æ—¶çœ‹åˆ°çš„å®Œå…¨ä¸ä¸€æ ·äº†ï¼Œä¸‹ä¸‹æ¥çš„NexTè¿˜æ˜¯æ–°ç‰ˆçš„ï¼Œé…ç½®å˜äº†ä¸æ˜¯ä¸€ç‚¹ï¼Œå“‡ğŸ˜… åƒä¸€å ‘é•¿ä¸€æ™ºäº†ï¼Œä»¥åæ‰¾æ•™ç¨‹ä¸å…ˆæœåˆ«äººå†™çš„ç›´æ¥é—®AIæˆ‘å°±æ˜¯è¿™ä¸ªğŸ‘ week14 (2025.6.2-2025.6.8) OKï¼Œè¿™å‘¨ä¸»è¦ä»»åŠ¡å°±æ˜¯é‡æ–°æ­äº†ä¸€ä¸ªåšå®¢ã€‚åšå®¢å»ºäº†åŠå¹´äº†ï¼Œéƒ½å¿˜äº†æ€ä¹ˆå»ºèµ·æ¥çš„äº†ï¼Œé‡æ­å»æ‰¾æ•™ç¨‹ï¼Œæœå‡ºæ¥çš„ç»“æœå’Œå°è±¡é‡ŒåŠå¹´å‰çš„è¿˜ä¸ä¸€æ ·ï¼Œè¿­ä»£é€Ÿç‡çœŸå¿«å•Š å¥½åœ¨æ—§çš„åšå®¢æ²¡æœ‰å…¨æ¯ï¼Œåœ¨æ®‹å­˜çš„nextæ–‡ä»¶é‡Œæ‰¾åˆ°äº†ä¸€äº›è¿˜èƒ½æŠ„çš„é…ç½® æ‰åŠå¹´NexTéƒ½æ›´æ–°åˆ°8.23äº†ï¼Œè¯„è®ºç³»ç»Ÿå’Œè®¿å®¢ç³»ç»Ÿå˜äº†ä¸å°‘ï¼Œè€é…ç½®ç”¨ä¸ä¸Šåªèƒ½æ¢æ–°çš„é…ç½®äº† å®Œäº†éƒ½æ²¡ä»€ä¹ˆå¯ä»¥å†™çš„äº† é¢„è®¡æ¥ä¸‹æ¥å‡ å‘¨å°±ä¸ä¼šæœ‰ä»€ä¹ˆå†…å®¹äº†ï¼Œé©¬ä¸Šå°±æ˜¯æœŸæœ«å‘¨äº†ã€‚å”‰ï¼Œå¤§å¤§å°å°çš„ä½œä¸šæŠ¥å‘Šè€ƒè¯•åˆæ¥äº†ğŸ«  week15,16,17 (2025.6.9-2025.6.29) æœŸæœ«æœˆæ–­æ›´ week18 (2025.6.30-2025.7.6) OKï¼Œä¹Ÿæ˜¯è€ƒå®Œè¯•äº†ã€‚å›å®¶ä¸¤å¤©ä¹Ÿæ˜¯é—²é‡Œå·å¿™åœ°çœ‹äº†ä¸€ç‚¹è¯¾ æ¥ä¸‹æ¥çœ‹çœ‹èƒ½ä¸èƒ½æŒç»­æ›´ä¸ªå‡ åå¤©ï¼Œæˆ‘å·²ç»â€œè®¡åˆ’â€å¥½äº†ä¸€äº›è¦æ›´çš„å†…å®¹äº†ï¼Œèƒ½ä¸èƒ½æ›´æˆå°±çœ‹æˆ‘è‡ªå·±äº†ï¼ˆ week19 (2025.7.7-2025.7.13) è¿™å‘¨å¼€å§‹å­¦ä¹ åŸºç¡€ä¸€ç‚¹çš„çŸ¥è¯†ï¼Œä¸»è¦æ˜¯æ±‡ç¼–ã€‚ä¸‹å‘¨åº”è¯¥æ˜¯ç¨‹åºé€†å‘åŸºç¡€çš„ä¸œè¥¿äº†ã€‚ ç¬”è®°æœ‰ç‚¹ä¹±ã€‚è¿™å‘¨ä¸»è¦å›´ç»•æ±‡ç¼–ï¼Œå­¦ä¹ äº†ä¸åŒæ¶æ„ä¸åŒæ¨¡å¼ä¸‹çš„æ±‡ç¼–çš„åŸºç¡€çŸ¥è¯†ï¼ŒåŒ…æ‹¬æœ€åŸºæœ¬çš„å¯„å­˜å™¨ã€æ±‡ç¼–æŒ‡ä»¤ã€å‡½æ•°çš„æ±‡ç¼–å½¢å¼ã€æ ˆå¸§ã€ä¸åŒæ¶æ„æ¨¡å¼çš„æ±‡ç¼–å·®å¼‚ç­‰ã€‚æ•´ä½“è€Œè¨€å…¶å®ä¸æ˜¯å¾ˆç¹æ‚çš„ä¸œè¥¿ï¼Œå†…å®¹ä¹Ÿä¸å¤šï¼Œæ‰€ä»¥è¯´å…¶å®è¿™å‘¨è¿˜æ˜¯å¤„äºæƒ³èµ·æ¥è¯¥å­¦äº†çš„æ—¶å€™æ‰å­¦çš„çŠ¶æ€ã€‚çœ‹äº†çœ‹å…¶ä»–çš„å›¤èµ·æ¥çš„èµ„æ–™ï¼Œæœ‰ä¸€è¯´ä¸€ï¼Œå¼€å­¦åè¿˜çœŸä¸ä¸€å®šå¯ä»¥æœ‰è¿ç»­çš„æ—¶é—´å­¦ï¼Œè¿™æ ·å­æ²¡æœ‰å…ˆèµ·ä¸ªä½“ç³»æ„Ÿè§‰è¿˜æ˜¯å¾ˆéš¾çœŸæ­£å­¦æ‡‚ã€‚ week20 (2025.7.14-2025.7.20) ä¸€è¨€éš¾å°½å±äºæ˜¯ï¼Œæ€»è€Œè¨€ä¹‹è¿™å‘¨æ²¡æ€ä¹ˆé›†ä¸­ç²¾åŠ›å»ç»™ç¬¬ä¸€éƒ¨åˆ†çš„æ±‡ç¼–å­¦ä¹ æ”¶å°¾ è¿˜æœ‰ç»“æ„ä½“ã€ç±»ä»€ä¹ˆçš„è¿˜æ²¡æœ‰å°è¯•ï¼Œä¸ºäº†é™ä½éš¾åº¦æ²¡æœ‰å¼•å…¥C++å¤æ‚çš„è¯­æ³•ï¼Œä½†æ˜¯æ€»æ„Ÿè§‰å“ªé‡Œæœ‰ç‚¹ä¸å¯¹åŠ² è¿™æ ·ä¸‹å»ä¸æ˜¯å¾ˆokå•Š(Ë‰â–½Ë‰ï¼›)â€¦ week21 (2025.7.21-2025.7.27) æ‘†çƒ‚ä¸€å‘¨ğŸ¤ªğŸ¤ª å…¶å®è¿™ä¸€å‘¨æˆ‘æ²¡å†™å‘¨è®°ï¼Œç”šè‡³æŠŠå®ƒéšè—äº†ã€‚week22å­¦äº†å‡ å¤©è‰¯å¿ƒè¿‡ä¸å»åˆæ¢å¤æ–‡ç« äº†(ï½ï¿£â–½ï¿£)ï½ week22 (2025.7.28-2025.8.3) è¿™å‘¨æ”¶è·é¢‡ä¸°å•Šï¼Œè„±å£³è¿™ä¸€å—å¡äº†åŠå¹´å¤šäº†åº”è¯¥æœ‰ï¼Œä¹Ÿæ˜¯ç»ˆäºèµ°åˆ°é€†å‘çœŸæ­£æœ‰é­…åŠ›çš„åœ°æ–¹äº†ï¼Œè„±å£³ã€èŠ±æŒ‡ä»¤ã€åè°ƒè¯•éƒ½å­¦ä¸Šäº†ï¼Œè™½ç„¶åç†è®ºï¼Œä½†æ˜¯è‡³å°‘æœ‰ç‚¹è§è¯†äº† ç¾ä¸­ä¸è¶³çš„æ˜¯ï¼Œä»£ç ç¼–è¯‘ç€ç¼–è¯‘ç€çªç„¶å†’å‡ºäº†ä¸€ä¸ªè°ƒç”¨çº¦å®šå†²çªï¼ˆx86ç¯å¢ƒï¼‰ğŸ« èŠ±æŒ‡ä»¤ä¹‹å‰éƒ½æ²¡å‘ç°è¿™ä¸ªé—®é¢˜ï¼ŒçœŸæ˜¯å¥‡äº†æ€ªäº†ğŸ« é‡è£…ä¸€éVSç”šè‡³è¿˜æ˜¯æœ‰è¿™ä¸ªé—®é¢˜ è¿™å‘¨æ‰¾æ ¡é˜Ÿå¸ˆå‚…æ²Ÿé€šäº†ä¸€ä¸‹ï¼Œå¥½åƒå‚åŠ è€ƒæ ¸å¾—è·Ÿç€æ–°ä¸€è½®æ‹›æ–°æ—¶é—´çº¿æ¥ï¼Œä¸ç„¶è¦æœ‰æ‹¿å¾—å‡ºæ‰‹çš„å®åŠ›æ‰å¯ä»¥æ‰“ç ´äººå®¶çš„æ‹›æ–°è®¡åˆ’ğŸ« ğŸ«  week23 (2025.8.4-2025.8.10) ä¸Šå‘¨æœ«å¼€å§‹æƒ³ç€ç»™åšå®¢æ¢ä¸ªä¸»é¢˜ï¼ˆè¿™ä¸ªä¸»é¢˜æ„Ÿè§‰è¢«æˆ‘æå¾—æœ‰ç‚¹è€äº†ï¼‰ï¼Œä¸€å¦‚æ—¢å¾€çš„é­ç½ªå•ŠğŸ« è¿™å‘¨æœ¬æ¥æƒ³æ‰¾æœºä¼šæŠŠè¦æ¢çš„ä¸»é¢˜å‡†å¤‡å¥½ï¼Œä½†æ˜¯ï¼Œä¸€æŠ˜è…¾å°±æ˜¯åŠå¤©ğŸ«  x2cå¼€å§‹æ‹›æ–°äº†ï¼Œå”‰ï¼Œè¿˜æ²¡å‡†å¤‡å¥½ğŸ«  æœ¬æ¥è¿™å‘¨åˆ°OLLVMäº†ï¼Œä½†æ˜¯å°è¯•åå‘ç°è‡ªå·±å†™çš„ç¨‹åºOLLVMæ²¡æœ‰æ•ˆæœï¼Œä¸çŸ¥é“æ˜¯é€»è¾‘å¤ªç®€å•è¿˜æ˜¯IDAå¤ªå¼ºå¤§äº†è¿˜æ˜¯ä»€ä¹ˆï¼Œå¦å¤–è§£æ³•è¿˜æœ‰ç‰µæ‰¯åˆ°angrçš„ï¼Œç´¢æ€§æ·±çš„å°±å¾€åå»¶å»¶äº†ï¼Œå…ˆæŠŠçŸ¥è¯†é¢æ‹“å¼€ï¼Œå®‰å“è¿˜æ²¡çœ‹å‘¢ï¼Œpyè¿˜æœ‰å…¶å®ƒè¯­è¨€çš„é€†å‘ä¹Ÿæ²¡æ€ä¹ˆæ¥è§¦è¿‡å‘¢ğŸ«  æ€ä¹ˆæ„Ÿè§‰çŠ¶æ€èµ·èµ·è½è½çš„ğŸ˜… week24 (2025.8.11-2025.8.17) è¿™å‘¨å¼€å§‹èµ¶è¿›åº¦ï¼Œå­¦äº†ç‚¹å®‰å“é€†å‘åŸºç¡€ï¼Œç„¶åæŠ•äº†ç®€å†ã€‚ä¹Ÿç®—æ˜¯è§è¯†åˆ°äº†æ‹›æ–°è€ƒæ ¸äº†ã€‚æ„Ÿè°¢å¸ˆå‚…æ‰‹ä¸‹ç•™æƒ…ï¼Œä¹Ÿæ˜¯ç»ˆäºè¢«æ”¶ç•™äº†ğŸ«¡ã€‚ ç„¶åå°±æ˜¯æ‰“moeï¼Œæ„Ÿè§‰æ¯”0xGameè¿˜ä¸Šäº†ç‚¹éš¾åº¦ï¼Œç¬¬ä¸€å‘¨å°±æœ‰upxçš„é¢˜äº†ï¼Œè¿˜æœ‰C++çš„ã€‚é¡ºé“æ‰“äº†LILCTFï¼Œåšå‡ºäº†ä¸€é¢˜ğŸ˜‹ä½†æ˜¯å…¶ä»–é¢˜æ²¡æ€è·¯äº†ï¼ˆåŠ ä¸Šå‡†å¤‡ç§‘ç›®ä¸€ğŸ« ï¼Œå°±æ²¡å¾€ä¸‹åšï¼Œåé¢å†å­¦å­¦å†å¤ç°ğŸ˜‹ è€ƒè™‘åˆ°Winé€†å‘è¿˜æ²¡æ›´å®Œï¼Œæ‰€ä»¥å®‰å“è¿™éƒ¨åˆ†å°±æ²¡æœ‰å†™ç¬”è®°äº†ï¼Œå›å¤´å†ç†Ÿæ‚‰ç†Ÿæ‚‰å†è¡¥ week25 (2025.8.18-2025.8.24) moeä¸Šå¼ºåº¦äº†ï¼Œä½†æ˜¯ç¬¬äºŒå‘¨çš„é¢˜è¿˜æ²¡å†™å®Œ è¿™å‘¨æ‘†çƒ‚äº† week26 (2025.8.25-2025.8.31) è¿™å‘¨ä¸»è¦è¿˜æ˜¯ç ”ç©¶moeçš„é¢˜ï¼Œæ²¡æœ‰å­¦ä»€ä¹ˆæ–°çŸ¥è¯†ã€‚","link":"/2025/06/02/%E5%91%A8%E8%AE%B0/"},{"title":"è®°ä¸€æ¬¡blogä¼˜åŒ–","text":"Hexo+NexTåšå®¢çš„å°ä¼˜åŒ– (æ³¨ï¼šæ­¤ç¯‡è®°å½•çš„æ˜¯ç¬”è€…åŸæ¥å´©æºƒçš„åšå®¢çš„ä¼˜åŒ–ï¼Œæ˜¯æ—§ç‰ˆNexTä¼˜åŒ–) è¿™å‡ å¤©çªç„¶äº§ç”Ÿä¸€ä¸ªæƒ³æ³•ï¼šåšå®¢ä¸»é¡µæ”¹æˆåˆ†ç±»çš„æ ·å¼ä¼šä¸ä¼šæ›´å¥½çœ‹ä¸€ç‚¹ï¼Œä¸»é¡µæ˜¯ä¸»é¢˜é›†åˆï¼Œæ¯ä¸ªä¸»é¢˜é‡Œé¢æ‰æ˜¯ç›¸å…³çš„æ–‡ç«  å¿ƒåŠ¨ä¸å¦‚è¡ŒåŠ¨ï¼Œç›´æ¥å¼€å¹²ï¼ é¦–é¡µåˆ†ç±»å¡ç‰‡å®ç° è¿™éƒ¨åˆ†å…¶å®èŠ±äº†ä¸å°‘æ—¶é—´ï¼Œå› ä¸ºæ²¡æœ‰å…·ä½“å­¦è¿‡Hexo+NexTçš„ç»“æ„ï¼Œå¥½åœ¨æœ‰Deepseekè€å¸ˆçš„å¸®åŠ© ä¿®æ”¹çš„éƒ¨åˆ†ä¸»è¦åœ¨themes/next/layout/index.swigï¼Œä¸‹é¢ç›´æ¥è´´ä»£ç ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162{% extends '_layout.swig' %}{% import '_macro/sidebar.swig' as sidebar_template with context %}{% block title %}{{ title }}{%- if theme.index_with_subtitle and subtitle %} - {{ subtitle }}{%- endif %}{% endblock %}{% block class %}index categories-page{% endblock %}{% block content %}{# è¿™éƒ¨åˆ†æ˜¯å®ç°categoryå¡ç‰‡ï¼Œæœ€åé¢è¿˜æœ‰æ²¡categoryçš„æ–‡ç« çš„å¤„ç†ï¼Œå› ä¸ºæˆ‘ä¸¥æ ¼äº†æ¯ç¯‡æ–‡ç« æœ‰categoryï¼Œå°±æ²¡ç®¡ç”»é¢å¦‚ä½•äº† #}{% if site.categories.length &gt; 0 %} &lt;div class=&quot;category-cards-container&quot;&gt; {% for cat in site.categories.toArray() %} &lt;div class=&quot;category-card&quot;&gt; &lt;div class=&quot;category-header&quot;&gt; &lt;h2 class=&quot;category-name&quot;&gt;{{ cat.name }}&lt;/h2&gt; &lt;span class=&quot;post-count&quot;&gt;{{ cat.posts.length }}ç¯‡æ–‡ç« &lt;/span&gt; &lt;/a&gt; &lt;/div&gt; {# è¿™ä¸€éƒ¨åˆ†å®ç°å¡ç‰‡æ˜¾ç¤ºåŒ…å«çš„æ–‡ç« çš„æ ‡é¢˜ï¼Œæ•°é‡å¯ä»¥æ”¹ä¸‹é¢çš„limit()çš„æ•°å­— #} &lt;div class=&quot;recent-posts-list&quot;&gt; {% for post in cat.posts.sort('date', -1).limit(3).toArray() %} &lt;div class=&quot;recent-post-item&quot;&gt; &lt;a href=&quot;{{ url_for(post.path) }}&quot; class=&quot;post-title&quot; title=&quot;{{ post.title }}&quot;&gt; {{ post.title | truncate(18) }} &lt;/a&gt; &lt;span class=&quot;post-date&quot;&gt; {% if post.updated %} {{ post.updated.format('MM/DD') }} {% else %} {{ post.date.format('MM/DD') }} {% endif %} &lt;/span&gt; &lt;/div&gt; {% endfor %} &lt;div class=&quot;more-posts-wrapper&quot;&gt; &lt;a href=&quot;{{ url_for('/categories/' + cat.name + '/') }}&quot; class=&quot;more-posts-button&quot;&gt; æ›´å¤šæ–‡ç«  â†’ &lt;/a&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; {% endfor %} &lt;/div&gt;{% else %} &lt;div class=&quot;no-categories-notice&quot;&gt; &lt;p&gt;æš‚æ— åˆ†ç±»æ•°æ®ï¼Œè¯·ä¸ºæ–‡ç« æ·»åŠ åˆ†ç±»&lt;/p&gt; &lt;/div&gt;{% endif %}{% endblock %}{% block sidebar %} {{ sidebar_template.render(false) }}{% endblock %} è¿˜æœ‰source/_data/styles.styl 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152/* åˆ†ç±»å¡ç‰‡æ ·å¼ - å®‰å…¨è¿½åŠ  */.category-cards-container { margin: 40px auto; max-width: 1200px; padding: 0 20px; .category-card { background: rgba(255,255,255,0.85); /* åŠé€æ˜ç™½è‰²ï¼Œä¸ä½ çš„opacity 0.85åè°ƒ */ border-radius: 8px; box-shadow: 0 2px 15px rgba(0,0,0,0.1); margin-bottom: 25px; padding: 25px; transition: all 0.3s ease; backdrop-filter: blur(2px); /* æ¯›ç»ç’ƒæ•ˆæœå¢å¼ºèƒŒæ™¯èåˆ */ border: 1px solid rgba(255,255,255,0.3); /* æŸ”å’Œè¾¹æ¡† */ &amp;:hover { transform: translateY(-5px); box-shadow: 0 5px 25px rgba(0,0,0,0.15); } .category-name { color: #2c3e50; font-size: 1.4em; margin: 0 0 8px 0; font-weight: 600; } .post-count { color: #7f8c8d; font-size: 0.9em; display: block; } }}/* è¿™éƒ¨åˆ†æ˜¯æˆ‘è‡ªå·±ç”¨çš„èƒŒæ™¯å›¾çš„è®¾ç½® */body { background-image: url(/images/background.jpg); background-repeat: no-repeat; background-attachment: fixed; background-size: 100% 100%; opacity: 0.85;}/* ======================== *//* åˆ†ç±»å¡ç‰‡å†…çš„æ–‡ç« åˆ—è¡¨æ ·å¼ *//* ======================== */.category-card { position: relative; /* ä¸ºæ¯›ç»ç’ƒæ•ˆæœæä¾›å®šä½ä¸Šä¸‹æ–‡ */ .category-header { margin-bottom: 15px; padding-bottom: 12px; border-bottom: 1px solid rgba(0,0,0,0.08); } .recent-posts-list { margin-top: 10px; .recent-post-item { display: flex; justify-content: space-between; align-items: center; padding: 8px 0; transition: all 0.2s ease; &amp;:hover { transform: translateX(3px); } .post-title { color: #34495e; font-size: 0.95em; flex-grow: 1; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; padding-right: 10px; &amp;:hover { color: #3498db; text-decoration: underline; } } .post-date { color: #95a5a6; font-size: 0.8em; font-family: 'Arial', sans-serif; flex-shrink: 0; } } } * { border-bottom: none !important; box-shadow: none !important; } .category-header, .recent-post-item, .recent-posts-list { border: none !important; border-bottom: none !important; }}/* æ›´å¤šæ–‡ç« æŒ‰é’®æ ·å¼ */.more-posts-wrapper { text-align: left; margin-top: 12px; padding-top: 10px; .more-posts-button { display: inline-block; color:rgb(72, 168, 241); font-size: 0.9em; padding: 6px 12px; border-radius: 4px; transition: all 0.3s ease; background: rgba(52, 152, 219, 0.1); &amp;:hover { background: rgba(52, 152, 219, 0.2); transform: translateX(3px); } &amp;:hover::after { margin-left: 8px; } }}/* å“åº”å¼è°ƒæ•´ */@media (max-width: 767px) { .category-card { padding: 18px; .recent-post-item { flex-direction: column; align-items: flex-start; .post-date { margin-top: 3px; align-self: flex-end; } } }} æ•ˆæœï¼š ç‚¹å‡»æ›´å¤šæ–‡ç« åçš„æ–‡ç« åˆ—è¡¨å®ç° è¿™éƒ¨åˆ†ä¸»è¦åŸºäºåŸæ¥çš„Index.swigï¼Œå› ä¸ºæˆ‘è§‰å¾—åŸæ¥çš„é£æ ¼å°±æŒºç®€æ´å¥½çœ‹çš„ æ‰¾åˆ°themes/next/layout/category.swigï¼Œæ”¹æˆï¼š 1234567891011121314151617181920212223242526{% extends '_layout.swig' %}{% import '_macro/sidebar.swig' as sidebar_template with context %}{% block title %} {{ page.category }} | {{ __('title.category') }} | {{ config.title }} {%- if theme.index_with_subtitle and config.subtitle %} - {{ config.subtitle }}{%- endif %}{% endblock %}{% block class %}category posts-expand{% endblock %}{% block content %} &lt;div class=&quot;category-title&quot; style=&quot;text-align: center; margin: 30px 0;&quot;&gt;//è¿™é‡ŒæŠŠåˆ†ç±»åç§°ç½®ä¸­äº† &lt;h1&gt;{{ page.category }}&lt;/h1&gt; &lt;/div&gt; {%- for post in page.posts.toArray() %} {{ partial('_macro/post.swig', {post: post, is_index: true}) }} {%- endfor %} {% include '_partials/pagination.swig' %}{% endblock %}{% block sidebar %} {{ sidebar_template.render(false) }}{% endblock %} æ•ˆæœï¼š åˆ é™¤æ–‡ç« ä¾§è¾¹æ ç›®å½•éš¾çœ‹çš„ä¸‹åˆ’çº¿ åœ¨themes/next/layout/_partials/head.swigæœ€ååŠ ä¸Šï¼š 1234567891011121314151617181920&lt;!-- å¼ºåˆ¶ç§»é™¤ç›®å½•ä¸‹åˆ’çº¿ --&gt;&lt;style&gt; /* è¦†ç›–æ‰€æœ‰å¯èƒ½çš„ç›®å½•å®¹å™¨ */ [class*=&quot;toc&quot;] .nav-item a, [class*=&quot;TOC&quot;] .nav-item a, .active &gt; a, .active-current &gt; a { border-bottom: none !important; text-decoration: none !important; box-shadow: none !important; } /* è¦†ç›–ä¼ªå…ƒç´ ä¸‹åˆ’çº¿ */ [class*=&quot;toc&quot;] a::after, [class*=&quot;TOC&quot;] a::after { display: none !important; }&lt;/style&gt; æ•ˆæœï¼š åˆ é™¤æ–‡æœ«æ ‡ç­¾æ–‡å­—å‰çš„â€œ#â€ å…ˆè¯´æ–‡ä»¶ï¼šthemes/next/layout/_macro/post.swig è¿™ä¸ªé—®é¢˜ï¼Œç½‘ä¸Šæ‰¾åˆ°çš„è§£å†³æ–¹æ³•éƒ½æ˜¯åˆ æ‰11è¡Œçš„â€œ#â€ 123456789101112//è¿™æ˜¯åŸæ¥çš„ä»£ç ï¼Œå¯ä»¥ctrl+Fæœpost-footer&lt;footer class=&quot;post-footer&quot;&gt; {%- if post.tags and post.tags.length %} {%- if theme.tag_icon %} {%- set tag_indicate = '&lt;i class=&quot;fa fa-tag&quot;&gt;&lt;/i&gt;' %} {% else %} {%- set tag_indicate = '#' %} {%- endif %} &lt;div class=&quot;post-tags&quot;&gt; {%- for tag in post.tags.toArray() %} &lt;a href=&quot;{{ url_for(tag.path) }}&quot; rel=&quot;tag&quot;&gt;#&lt;i class=&quot;fa fa-tag&quot;&gt;&lt;/i&gt;{{ tag_indicate }} {{ tag.name }}&lt;/a&gt; {%- endfor %} ä½†æ˜¯åˆ é™¤åå‘ç°â€œ#â€è¿˜åœ¨ã€‚æŠŠä»£ç ç»™DSçœ‹äº†ä¸‹ï¼Œå‘ç°ç¬¬7è¡ŒæŠŠtag_indicateè®¾æˆäº†â€œ#â€ï¼Œåˆ æ‰è¿™ä¸ªå°±å¯ä»¥äº† æ•ˆæœï¼š æµ‹è¯•æ—¶é˜…è¯»æ–‡ç« ä¸è®¡æ•° 2025.6.2 æ³¨ï¼šåœ¨NexT8åçš„ç‰ˆæœ¬ï¼Œvalineä¸è¢«æ”¯æŒäº† åšå®¢æ­èµ·æ¥åä¸€ç›´æœ‰ä¸ªé—®é¢˜ï¼Œå°±æ˜¯è‡ªå·±çœ‹è‡ªå·±çš„åšå®¢æ–‡ç« ä¼šè¢«è®¡æ•°ï¼Œæœ€å¼€å§‹æ˜¯ç”¨ublockå±è”½ç»Ÿè®¡ç½‘ç«™æ¥å®ç°ï¼Œä½†æ˜¯è¿™ä¸¤å¤©æµ‹è¯•äº†ä¸€ä¸‹å‘ç°è¿™ä¸ªæ–¹æ³•ç”¨æ‰‹æœºè®¿é—®ä¹Ÿä¸ä¼šè®¡æ•°ï¼Œè¿™ä¸å°±æ„å‘³ç€ç»Ÿè®¡åŠŸèƒ½ç˜«ç—ªäº†å—ğŸ˜® æ‰€ä»¥å¼€å§‹å’ŒDSè€å¸ˆæ¢è®¨æ–°æ–¹æ³•ã€‚DSè€å¸ˆè¿™äººä¸å’‹è¡Œï¼Œå¥½æ–¹æ¡ˆè—ç€æ–ç€ï¼Œæ‹·é—®äº†åŠå¤©æ‰æœ‰äº†ä¸‹é¢çš„ç®€æ´çš„æ–¹æ³•ï¼š themes/next/layout/_third-party/comments/valine.swigä¸­ï¼Œåœ¨new Valine({ })çš„æ‹¬å·é‡Œï¼ŒæŠŠvisitorè®¾ç½®æˆ 1visitor : (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') ? false : {{ theme.valine.visitor }}, è¿™æ ·å­ï¼Œåœ¨hexo sä¸‹è®¿é—®localhostæŸ¥çœ‹æ–‡ç« ä¸ä¼šè¢«è®¡æ•°ã€‚DSè¯´è¿™æ˜¯æŠŠhexo så’Œhexo dä¸¤ä¸ªç¯å¢ƒéš”ç¦»äº†ï¼Œæ‰€ä»¥è¯´å¦‚æœhexo sä¸‹å‡ºç°æ–‡ç« é˜…è¯»æ•°ä¸ºé›¶çš„æƒ…å†µç®—æ­£å¸¸ï¼ˆæˆ‘å°±æ˜¯è¿™æ ·ï¼‰ å½“ç„¶äº†ï¼Œå¦‚æœè¦çœ‹é˜…è¯»æ•°ï¼Œå°±è¦è®¿é—®hexo déƒ¨ç½²åçš„ç½‘ç«™äº†ï¼Œè®°å¾—ä¸è¦ç‚¹è¿›æ–‡ç« å»çœ‹ï¼Œä¸ç„¶è¿˜æ˜¯ä¼šè¢«è®¡æ•° éº»çƒ¦æ˜¯éº»çƒ¦äº†ç‚¹ï¼Œä½†åŠŸèƒ½è‡³å°‘æ˜¯å®ç°äº†","link":"/2025/06/02/%E8%AE%B0%E4%B8%80%E6%AC%A1blog%E4%BC%98%E5%8C%96/"},{"title":"æ¹¾åŒºæ¯åˆèµ›WriteUp&amp;å¤ç°","text":"å’ŒX2cçš„nixwareã€Ky4niT3å¸ˆå‚…å‚åŠ äº†çº¿ä¸Šåˆèµ›ï¼Œä½†æ˜¯å¯„äº†ã€‚ç¬¬ä¸€æ¬¡ç»„é˜Ÿå‚èµ›ï¼Œè¿˜æ˜¯å¤ªèœäº†ã€‚Reæ–¹å‘è§£äº†ä¸€é“ï¼Œç„¶åå’Œå¸ˆå‚…ä»¬æ‹¼å‡‘å‡ºäº†ä¸€é“ã€‚åŸºæœ¬å°±æ˜¯ç­¾åˆ°é¢˜é AIï¼Œéš¾é¢˜æ²¡æ€è·¯ï¼Œè§è¯†è¿˜æ˜¯å¤ªå°‘äº† WriteUphardtest é™„ä»¶ç¨‹åºç”¨IDAæ‰“å¼€ï¼Œshift+F12åœ¨å­—ç¬¦ä¸²è¡¨é€šè¿‡å…³é”®å­—â€œflag:â€å¯ä»¥æ‰¾åˆ°mainå‡½æ•°ä½ç½® ä»¥ä¸‹æ˜¯ä¼˜åŒ–åçš„mainå‡½æ•°ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112__int64 __fastcall main(int a1, char **a2, char **a3){ unsigned int seed; // eax unsigned __int64 scale1; // rax void *temp1; // rsp unsigned __int64 scale2; // rax void *temp2; // rsp char temp; // al _QWORD buf[2]; // [rsp+8h] [rbp-F0h] BYREF __int64 i_2; // [rsp+18h] [rbp-E0h] __int64 v12; // [rsp+20h] [rbp-D8h] char input; // [rsp+29h] [rbp-CFh] BYREF char judge; // [rsp+2Ah] [rbp-CEh] char randNum; // [rsp+2Bh] [rbp-CDh] int j; // [rsp+2Ch] [rbp-CCh] int i; // [rsp+30h] [rbp-C8h] int length; // [rsp+34h] [rbp-C4h] __int64 v19; // [rsp+38h] [rbp-C0h] __int64 Buf; // [rsp+40h] [rbp-B8h] __int64 v21; // [rsp+48h] [rbp-B0h] _QWORD *Enc; // [rsp+50h] [rbp-A8h] char flag[104]; // [rsp+58h] [rbp-A0h] BYREF unsigned __int64 v24; // [rsp+C0h] [rbp-38h] v24 = __readfsqword(0x28u); setbuf(stdin, 0LL); setbuf(stdout, 0LL); setbuf(stderr, 0LL); seed = time(0LL); srand(seed); randNum = rand() % 255 + 1; printf(&quot;input your number(1-255): &quot;); if ( __isoc99_scanf(&quot;%d&quot;, &amp;input) == 1 &amp;&amp; randNum == input ) { while ( getchar() != 10 ) ; printf(&quot;flag: &quot;); fgets(flag, 100, stdin); // è·å–flagè¾“å…¥ flag[strcspn(flag, &quot;\\n&quot;)] = 0; length = strlen(flag); v19 = length - 1LL; i_2 = length; v12 = 0LL; buf[0] = length; buf[1] = 0LL; scale1 = 16 * ((length + 15LL) / 0x10uLL); // åœ¨åŠ¨æ€åˆ†é…æ ˆä¸Šçš„å†…å­˜ while ( buf != (buf - (scale1 &amp; 0xFFFFFFFFFFFFF000LL)) ) ; temp1 = alloca(scale1 &amp; 0xFFF); if ( (scale1 &amp; 0xFFF) != 0 ) *(&amp;buf[-1] + (scale1 &amp; 0xFFF)) = *(&amp;buf[-1] + (scale1 &amp; 0xFFF)); Buf = buf; // BufæŒ‡å‘åˆ†é…çš„å†…å­˜ encrypt1(flag, buf); // å¯¹flagè¿›è¡ŒåŠ å¯†ï¼ŒåŠ å¯†ç»“æœå®é™…ä¸Šç”±Bufè®°å½•ï¼Œbufæ˜¯ä¸€ä¸ªé€šç”¨çš„ç¼“å­˜ç©ºé—´ v21 = length - 1LL; scale2 = 16 * ((length + 15LL) / 0x10uLL); // å†æ¬¡åŠ¨æ€åˆ†é…æ ˆä¸Šçš„å†…å­˜ while ( buf != (buf - (scale2 &amp; 0xFFFFFFFFFFFFF000LL)) ) ; temp2 = alloca(scale2 &amp; 0xFFF); if ( (scale2 &amp; 0xFFF) != 0 ) *(&amp;buf[-1] + (scale2 &amp; 0xFFF)) = *(&amp;buf[-1] + (scale2 &amp; 0xFFF)); Enc = buf; // EncæŒ‡å‘åˆ†é…çš„å†…å­˜ for ( i = 0; i &lt; length; ++i ) { temp = encrypt2(*(Buf + i)); // å¯¹ä¸Šä¸€è½®åŠ å¯†çš„ç»“æœå†è¿›è¡Œä¸€æ¬¡åŠ å¯†ï¼ŒåŠ å¯†ç»“æœç”±Encè®°å½• *(Enc + i) = temp; } judge = 1; for ( j = 0; j &lt; length; ++j ) { if ( *(Enc + j) != byte_2120[j] ) // åˆ¤æ–­åŠ å¯†ç»“æœæ˜¯å¦æ­£ç¡® { judge = 0; break; } } if ( judge ) puts(&quot;right&quot;); return 0LL; } else { puts(&quot;error&quot;); return 1LL; }}__int64 __fastcall encrypt1(const char *flag, __int64 buf){ __int64 count; // rax signed int i; // [rsp+14h] [rbp-1Ch] signed int length; // [rsp+18h] [rbp-18h] length = strlen(flag); for ( i = 0; ; ++i ) { count = i; if ( i &gt;= length ) break; *(i + buf) = rol(flag[i], (i % 7) + 1); // return (flag[i] &lt;&lt; ((i%7)+1)) | (flag[i] &gt;&gt; (8 - ((i%7)+1))) } return count;}__int64 __fastcall encrypt2(char Buf_i){ unsigned __int8 v1; // al unsigned __int8 v3; // [rsp+15h] [rbp-3h] v1 = rol(Buf_i ^ 0x5Au, 3); // return (a1^0x5Au &lt;&lt; 3) | (a1^0x5Au &gt;&gt; (8 - 3)); v3 = sub_1313((16 * ((3 * (v1 &gt;&gt; 4)) &amp; 0xF)) | (5 * (v1 &amp; 0xF)) &amp; 0xFu);// AIè¯´æ˜¯æ¨¡å¹‚è¿ç®—å‡½æ•°ï¼Œè®¡ç®—a1^(255) mod 257 return byte_2020[ror(v3, 2)]; // return (v3 &gt;&gt; 2) | (v3 &lt;&lt; (8 - 2));æ­¤å¤„å»ºç«‹äº†æ˜ å°„å…³ç³»} ç¬”è€…åŠ è§£å¯†è¿™ä¸€å—å¤ªèœäº†ï¼Œæ²¡æœ‰æ•°å­¦å¤´è„‘ï¼Œåªèƒ½ä¾é AIè§£å¯†äº†ï¼ˆå› ä¸ºæ¶‰åŠæ•°è®ºï¼Œç¬”è€…è¿˜æ²¡å­¦è¿‡ï¼‰ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970def rol(b, n): n %= 8 return ((b &lt;&lt; n) | (b &gt;&gt; (8 - n))) &amp; 0xFFdef ror(b, n): n %= 8 return ((b &gt;&gt; n) | (b &lt;&lt; (8 - n))) &amp; 0xFFdef mod_inv(a, mod=257): # è®¡ç®—aåœ¨æ¨¡257ä¸‹çš„é€†å…ƒï¼Œä½¿ç”¨è´¹é©¬å°å®šç† return pow(a, 255, mod)byte_2020 = [ 0x63, 0x7C, 0x77, 0x7B, 0xF2, 0x6B, 0x6F, 0xC5, 0x30, 0x01, 0x67, 0x2B, 0xFE, 0xD7, 0xAB, 0x76, 0xCA, 0x82, 0xC9, 0x7D, 0xFA, 0x59, 0x47, 0xF0, 0xAD, 0xD4, 0xA2, 0xAF, 0x9C, 0xA4, 0x72, 0xC0, 0xB7, 0xFD, 0x93, 0x26, 0x36, 0x3F, 0xF7, 0xCC, 0x34, 0xA5, 0xE5, 0xF1, 0x71, 0xD8, 0x31, 0x15, 0x04, 0xC7, 0x23, 0xC3, 0x18, 0x96, 0x05, 0x9A, 0x07, 0x12, 0x80, 0xE2, 0xEB, 0x27, 0xB2, 0x75, 0x09, 0x83, 0x2C, 0x1A, 0x1B, 0x6E, 0x5A, 0xA0, 0x52, 0x3B, 0xD6, 0xB3, 0x29, 0xE3, 0x2F, 0x84, 0x53, 0xD1, 0x00, 0xED, 0x20, 0xFC, 0xB1, 0x5B, 0x6A, 0xCB, 0xBE, 0x39, 0x4A, 0x4C, 0x58, 0xCF, 0xD0, 0xEF, 0xAA, 0xFB, 0x43, 0x4D, 0x33, 0x85, 0x45, 0xF9, 0x02, 0x7F, 0x50, 0x3C, 0x9F, 0xA8, 0x51, 0xA3, 0x40, 0x8F, 0x92, 0x9D, 0x38, 0xF5, 0xBC, 0xB6, 0xDA, 0x21, 0x10, 0xFF, 0xF3, 0xD2, 0xCD, 0x0C, 0x13, 0xEC, 0x5F, 0x97, 0x44, 0x17, 0xC4, 0xA7, 0x7E, 0x3D, 0x64, 0x5D, 0x19, 0x73, 0x60, 0x81, 0x4F, 0xDC, 0x22, 0x2A, 0x90, 0x88, 0x46, 0xEE, 0xB8, 0x14, 0xDE, 0x5E, 0x0B, 0xDB, 0xE0, 0x32, 0x3A, 0x0A, 0x49, 0x06, 0x24, 0x5C, 0xC2, 0xD3, 0xAC, 0x62, 0x91, 0x95, 0xE4, 0x79, 0xE7, 0xC8, 0x37, 0x6D, 0x8D, 0xD5, 0x4E, 0xA9, 0x6C, 0x56, 0xF4, 0xEA, 0x65, 0x7A, 0xAE, 0x08, 0xBA, 0x78, 0x25, 0x2E, 0x1C, 0xA6, 0xB4, 0xC6, 0xE8, 0xDD, 0x74, 0x1F, 0x4B, 0xBD, 0x8B, 0x8A, 0x70, 0x3E, 0xB5, 0x66, 0x48, 0x03, 0xF6, 0x0E, 0x61, 0x35, 0x57, 0xB9, 0x86, 0xC1, 0x1D, 0x9E, 0xE1, 0xF8, 0x98, 0x11, 0x69, 0xD9, 0x8E, 0x94, 0x9B, 0x1E, 0x87, 0xE9, 0xCE, 0x55, 0x28, 0xDF, 0x8C, 0xA1, 0x89, 0x0D, 0xBF, 0xE6, 0x42, 0x68, 0x41, 0x99, 0x2D, 0x0F, 0xB0, 0x54, 0xBB, 0x16]# æ„å»ºåå‘æ˜ å°„rev_2020 = {}for idx, val in enumerate(byte_2020): rev_2020[val] = idxenc_data = [ 0x97, 0xD5, 0x60, 0x43, 0xB4, 0x10, 0x43, 0x73, 0x0F, 0xDA, 0x43, 0xCD, 0xD3, 0xE8, 0x73, 0x4A, 0x94, 0xC3, 0xCD, 0x71, 0xBD, 0xDC, 0x97, 0x1A]# é€†å‘encrypt2enc1_out = []for i, c in enumerate(enc_data): idx = rev_2020[c] # å¾—åˆ°ç´¢å¼•ï¼ˆå³v3å¾ªç¯å³ç§»2ä½åçš„å€¼ï¼‰ v3 = rol(idx, 2) # å¾ªç¯å·¦ç§»2ä½å¾—åˆ°v3ï¼ˆåŸå¾ªç¯å³ç§»2ä½çš„é€†ï¼‰ # å¦‚æœv3ä¸º0ï¼Ÿä½†åŸä»£ç ä¸­a1ä¸ä¸º0æ‰è®¡ç®—ï¼Œè¿™é‡Œå‡è®¾v3ä¸ä¸º0 if v3 == 0: x = 0 else: x = mod_inv(v3, 257) A = (x &gt;&gt; 4) &amp; 0xF B = x &amp; 0xF high = (11 * A) &amp; 0xF low = (13 * B) &amp; 0xF v1 = (high &lt;&lt; 4) | low tmp = ror(v1, 3) # å¾ªç¯å³ç§»3ä½ï¼ˆåŸå¾ªç¯å·¦ç§»3ä½çš„é€†ï¼‰ enc1_out.append(tmp ^ 0x5A)# é€†å‘encrypt1flag = []for i, c in enumerate(enc1_out): n = (i % 7) + 1 flag_char = ror(c, n) # å¾ªç¯å³ç§»nä½ï¼ˆåŸå¾ªç¯å·¦ç§»nä½çš„é€†ï¼‰ flag.append(flag_char)# è½¬æ¢ä¸ºå­—ç¬¦ä¸²flag_str = ''.join(chr(b) for b in flag)print(flag_str) minigame å¾®ä¿¡å°ç¨‹åºé€†å‘ï¼Œç¬¬ä¸€æ¬¡é‡åˆ°è¿™ä¸ªç±»å‹çš„é¢˜ ç”¨wedecodeè§£åŒ…é™„ä»¶ï¼Œè¾“å‡ºç»“æœåœ¨wedecode-main/OUTPUT/defaulté‡Œ æ²¡æœ‰è¿™æ–¹é¢çš„ç»éªŒï¼Œè®©AIåˆ†æé¡¹ç›®ï¼Œå‘ç°utils/validator.wasmé‡Œæœ‰æ£€éªŒé€»è¾‘ã€‚wasmæ˜¯ä¸€ç§äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¯ä»¥è½¬æˆwaté˜…è¯»ï¼ˆç±»ä¼¼æ±‡ç¼–ï¼‰ã€‚ä½¿ç”¨åœ¨çº¿å·¥å…·wasm2wat demoæŠŠwasmè½¬æˆwat: 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798(module (type $t0 (func (param i32) (result i32))) (type $t1 (func)) (func $c (export &quot;c&quot;) (type $t0) (param $p0 i32) (result i32) (local $l1 i32) (local $l2 i32) (local $l3 i32) (local $l4 i32) (if $I6 (i32.ne (block $B0 (result i32) (block $B1 (block $B2 (br_if $B2 (i32.eqz (i32.and (local.tee $l3 (local.get $p0)) (i32.const 3)))) (drop (br_if $B0 (i32.const 0) (i32.eqz (i32.load8_u (local.get $p0))))) (loop $L3 (br_if $B2 (i32.eqz (i32.and (local.tee $p0 (i32.add (local.get $p0) (i32.const 1))) (i32.const 3)))) (br_if $L3 (i32.load8_u (local.get $p0)))) (br $B1)) (loop $L4 (local.set $p0 (i32.add (local.tee $l1 (local.get $p0)) (i32.const 4))) (br_if $L4 (i32.eq (i32.and (i32.or (i32.sub (i32.const 16843008) (local.tee $l4 (i32.load (local.get $l1)))) (local.get $l4)) (i32.const -2139062144)) (i32.const -2139062144)))) (loop $L5 (local.set $l1 (i32.add (local.tee $p0 (local.get $l1)) (i32.const 1))) (br_if $L5 (i32.load8_u (local.get $p0))))) (i32.sub (local.get $p0) (local.get $l3))) (i32.const 38)) (then (return (i32.const 0)))) (loop $L7 (block $B8 (local.set $l1 (i32.eq (local.tee $p0 (i32.xor (i32.load8_u offset=1024 (local.get $l2)) (i32.load8_s (i32.add (local.get $l2) (local.get $l3))))) (i32.const 153))) (br_if $B8 (i32.ne (local.get $p0) (i32.const 153))) (br_if $L7 (i32.ne (local.tee $l2 (i32.add (local.get $l2) (i32.const 1))) (i32.const 38))))) (local.get $l1)) (func $b (export &quot;b&quot;) (type $t1)) (memory $a (export &quot;a&quot;) 258 258) (data $d0 (i32.const 1024) &quot;\\ff\\f5\\f8\\fe\\e2\\ff\\f8\\fc\\a9\\fb\\ab\\ae\\fa\\ad\\ac\\a8\\fa\\ae\\ab\\a1\\a1\\af\\ae\\f8\\ac\\af\\ae\\fc\\a1\\fa\\a8\\fb\\fb\\ad\\fc\\ac\\aa\\e4&quot;)) ç”±AIåˆ†æçŸ¥ï¼Œæ­¤å¤„ä¸»è¦æ˜¯æŠŠè¾“å…¥çš„å†…å®¹ä¸å¯†æ–‡å¼‚æˆ–ï¼Œå¼‚æˆ–çš„ç»“æœè¦ç­‰äº153ã€‚ç­‰ä»·äºå°†è¾“å…¥çš„å†…å®¹å’Œ153å¼‚æˆ–è¦ç­‰äºå¯†æ–‡ã€‚è§£å¯†å°±æ˜¯æ‹¿153å¼‚æˆ–å¯†æ–‡ã€‚exp: 123456789enc = [ 0xff, 0xf5, 0xf8, 0xfe, 0xe2, 0xff, 0xf8, 0xfc, 0xa9, 0xfb, 0xab, 0xae, 0xfa, 0xad, 0xac, 0xa8, 0xfa, 0xae, 0xab, 0xa1, 0xa1, 0xaf, 0xae, 0xf8, 0xac, 0xaf, 0xae, 0xfc, 0xa1, 0xfa, 0xa8, 0xfb, 0xfb, 0xad, 0xfc, 0xac, 0xaa, 0xe4]flag = ''.join([chr(data ^ 153) for data in enc])print(flag) å¤ç°strangapp apkç”¨JEBæ‰“å¼€ä¼šå‘ç°MainActivityå…¨æ˜¯nop: æ‹–è¿›GDAé‡Œçœ‹ä¸€ä¸‹ï¼Œä¼šå‘ç°apkåŠ äº†å£³ æ‰€ä»¥ç¬¬ä¸€æ­¥å…ˆè„±å£³ æ²¡è¾™äº†ï¼Œé¢˜ç›®ç¯å¢ƒå¡çš„å¥½æ­»ï¼Œé…äº†ä¸€ä¸‹åˆç¯å¢ƒæ²¡é…å‡ºèƒ½è¿è¡Œapkçš„ï¼Œæ”¹å¤©å†è¯•ğŸ˜¡","link":"/2025/10/03/%E6%B9%BE%E5%8C%BA%E6%9D%AF%E5%88%9D%E8%B5%9BWriteUp&%E5%A4%8D%E7%8E%B0/"},{"title":"è®°ä¸€æ¬¡blogé‡å»º","text":"éƒ¨ç½²Vercelå¤±è¯¯åçš„blogé‡å»ºï¼ˆåŸºäºhexo+NexT8.23.0ï¼Œé‡‡ç”¨utterancesè¯„è®ºç³»ç»Ÿå’Œfirestoreæ•°æ®è®°å½•ï¼‰ OKï¼Œè¿™æ˜¯ç¬”è€…åœ¨ä¾èµ–AIç›²ç›®æŠŠåšå®¢éƒ¨ç½²åˆ°Vercelä¸Šå¯¼è‡´åšå®¢å´©æºƒåçš„åšå®¢é‡å»ºè®°å½• è®°å½•çš„åŸå› é¦–å…ˆæ˜¯æ›´æ–°â€œè®°ä¸€æ¬¡blogä¼˜åŒ–â€çš„å†…å®¹ï¼Œè¿˜æœ‰æ–°ç‰ˆæœ¬NexTçš„ä¸€äº›ä¸ªäººé…ç½®ï¼ˆæ–°ç‰ˆæœ¬NexTçš„æ•™ç¨‹å¥½åƒä¸å¤šï¼Œè¯„è®ºç³»ç»Ÿå’Œè®¿å®¢è®¡æ•°ç³»ç»Ÿè¦è‡ªå·±ç¢ç£¨å¥½ä¸€ä¼šå„¿ï¼‰ é¦–é¡µåˆ†ç±»å¡ç‰‡å®ç° å› ä¸ºæ˜¯å¯¹â€œè®°ä¸€æ¬¡blogä¼˜åŒ–â€çš„æ›´æ–°ï¼Œæ‰€ä»¥è¿™éƒ¨åˆ†ç›´æ¥è´´ä»£ç äº†ï¼ˆæ³¨ï¼šåŒºåˆ«æ›´å¤šæ˜¯åœ¨æ–‡ä»¶åä»swigå˜æˆäº†njkï¼‰ themes/next/layout/index.njkï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263{% extends '_layout.njk' %}{% import '_macro/sidebar.njk' as sidebar_template with context %}{% block title %}{{ title }}{%- if theme.index_with_subtitle and subtitle %} - {{ subtitle }}{%- endif %}{% endblock %}{% block class %}index categories-page{% endblock %}{% block content %}{# è¿™éƒ¨åˆ†æ˜¯å®ç°categoryå¡ç‰‡ï¼Œæœ€åé¢è¿˜æœ‰æ²¡categoryçš„æ–‡ç« çš„å¤„ç†ï¼Œå› ä¸ºæˆ‘ä¸¥æ ¼äº†æ¯ç¯‡æ–‡ç« æœ‰categoryï¼Œå°±æ²¡ç®¡ç”»é¢å¦‚ä½•äº† #}{% if site.categories.length &gt; 0 %}&lt;div class=&quot;category-cards-container&quot;&gt; {% for cat in site.categories.toArray() %} &lt;div class=&quot;category-card&quot;&gt; &lt;div class=&quot;category-header&quot;&gt; &lt;h2 class=&quot;category-name&quot;&gt;{{ cat.name }}&lt;/h2&gt; &lt;span class=&quot;post-count&quot;&gt;{{ cat.posts.length }}ç¯‡æ–‡ç« &lt;/span&gt; &lt;/a&gt; &lt;/div&gt;{# è¿™ä¸€éƒ¨åˆ†å®ç°å¡ç‰‡æ˜¾ç¤ºåŒ…å«çš„æ–‡ç« çš„æ ‡é¢˜ï¼Œæ•°é‡å¯ä»¥æ”¹ä¸‹é¢çš„limit()çš„æ•°å­— #} &lt;div class=&quot;recent-posts-list&quot;&gt; {% for post in cat.posts.sort('date', -1).limit(3).toArray() %} &lt;div class=&quot;recent-post-item&quot;&gt; &lt;a href=&quot;{{ url_for(post.path) }}&quot; class=&quot;post-title&quot; title=&quot;{{ post.title }}&quot;&gt; {{ post.title | truncate(18) }} &lt;/a&gt; &lt;span class=&quot;post-date&quot;&gt; {% if post.updated %} {{ post.updated.format('MM/DD') }} {% else %} {{ post.date.format('MM/DD') }} {% endif %} &lt;/span&gt; &lt;/div&gt; {% endfor %} &lt;div class=&quot;more-posts-wrapper&quot;&gt; &lt;a href=&quot;{{ url_for('/categories/' + cat.name + '/') }}&quot; class=&quot;more-posts-button&quot;&gt; æ›´å¤šæ–‡ç«  â†’ &lt;/a&gt;&lt;/div&gt;&lt;/div&gt; &lt;/div&gt;{% endfor %}&lt;/div&gt;{% else %} &lt;div class=&quot;no-categories-notice&quot;&gt; &lt;p&gt;æš‚æ— åˆ†ç±»æ•°æ®ï¼Œè¯·ä¸ºæ–‡ç« æ·»åŠ åˆ†ç±»&lt;/p&gt; &lt;/div&gt; {% endif %}{% endblock %}{% block sidebar %} {{ sidebar_template.render(false) }}{% endblock %} source/_data/styles.stylï¼š å¾—å…ˆåœ¨next/config.ymlé‡Œæ‰“å¼€è¿™ä¸ªæ–‡ä»¶çš„æ”¯æŒï¼ˆå¯èƒ½æ˜¯æ–°ç‰¹æ€§å§ï¼Œç¬”è€…è®°å¾—ä¹‹å‰æ²¡æ”¹è¿‡configè®¾ç½®å°±æœ‰è¿™ä¸ªæ–‡ä»¶äº†ï¼Œä½†æ˜¯ç°åœ¨å¾—æ‰“å¼€æ”¯æŒå¹¶æ‰‹åŠ¨åˆ›å»º_dataæ–‡ä»¶å¤¹å’Œstyles.stylç­‰æ–‡ä»¶ï¼‰ï¼Œåœ¨custom_file_pathé‡Œåˆ é™¤styleçš„æ³¨é‡Š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157/* åˆ†ç±»å¡ç‰‡æ ·å¼ - å®‰å…¨è¿½åŠ  */.category-cards-container { margin: 40px auto; max-width: 1200px; padding: 0 20px; .category-card { background: rgba(255,255,255,0.85); /* åŠé€æ˜ç™½è‰²ï¼Œä¸ä½ çš„opacity 0.85åè°ƒ */ border-radius: 8px; box-shadow: 0 2px 15px rgba(0,0,0,0.1); margin-bottom: 25px; padding: 25px; transition: all 0.3s ease; backdrop-filter: blur(2px); /* æ¯›ç»ç’ƒæ•ˆæœå¢å¼ºèƒŒæ™¯èåˆ */ border: 1px solid rgba(255,255,255,0.3); /* æŸ”å’Œè¾¹æ¡† */ &amp;:hover { transform: translateY(-5px); box-shadow: 0 5px 25px rgba(0,0,0,0.15); } .category-name { color: #2c3e50; font-size: 1.4em; margin: 0 0 8px 0; font-weight: 600; } .post-count { color: #7f8c8d; font-size: 0.9em; display: block; } }}/* è¿™éƒ¨åˆ†æ˜¯æˆ‘è‡ªå·±ç”¨çš„èƒŒæ™¯å›¾çš„è®¾ç½® */body { background-image: url(/images/background.jpg); background-repeat: no-repeat; background-attachment: fixed; background-size: 100% 100%; opacity: 0.85;}/* ======================== *//* åˆ†ç±»å¡ç‰‡å†…çš„æ–‡ç« åˆ—è¡¨æ ·å¼ *//* ======================== */.category-card { position: relative; /* ä¸ºæ¯›ç»ç’ƒæ•ˆæœæä¾›å®šä½ä¸Šä¸‹æ–‡ */ .category-header { margin-bottom: 15px; padding-bottom: 12px; border-bottom: 1px solid rgba(0,0,0,0.08); } .recent-posts-list { margin-top: 10px; .recent-post-item { display: flex; justify-content: space-between; align-items: center; padding: 8px 0; transition: all 0.2s ease; &amp;:hover { transform: translateX(3px); } .post-title { color: #34495e; font-size: 0.95em; flex-grow: 1; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; padding-right: 10px; &amp;:hover { color: #3498db; text-decoration: underline; } } .post-date { color: #95a5a6; font-size: 0.8em; font-family: 'Arial', sans-serif; flex-shrink: 0; } } } * { border-bottom: none !important; box-shadow: none !important; } .category-header, .recent-post-item, .recent-posts-list { border: none !important; border-bottom: none !important; }}/* æ›´å¤šæ–‡ç« æŒ‰é’®æ ·å¼ */.more-posts-wrapper { text-align: left; margin-top: 12px; padding-top: 10px; .more-posts-button { display: inline-block; color:rgb(72, 168, 241); font-size: 0.9em; padding: 6px 12px; border-radius: 4px; transition: all 0.3s ease; background: rgba(52, 152, 219, 0.1); &amp;:hover { background: rgba(52, 152, 219, 0.2); transform: translateX(3px); } &amp;:hover::after { margin-left: 8px; } }}/* å“åº”å¼è°ƒæ•´ */@media (max-width: 767px) { .category-card { padding: 18px; .recent-post-item { flex-direction: column; align-items: flex-start; .post-date { margin-top: 3px; align-self: flex-end; } } }}.posts-container{ margin: 40px auto; max-width: 1200px; padding: 0 20px;} æ•ˆæœè¯·è§â€œè®°ä¸€æ¬¡blogä¼˜åŒ–â€ ç‚¹å‡»æ›´å¤šæ–‡ç« åçš„æ–‡ç« åˆ—è¡¨å®ç° ä»ç„¶æ˜¯åŸºäºåŸæ¥çš„Index.njk themes/next/layout/category.njkï¼š 123456789101112131415161718192021222324252627282930{% extends '_layout.njk' %}{% import '_macro/sidebar.njk' as sidebar_template with context %}{% block title %} {{ page.category }} | {{ __('title.category') }} | {{ config.title }}{% if theme.index_with_subtitle and subtitle %} - {{ subtitle }}{% endif %}{% endblock %}{% block class %}index posts-expand{% endblock %}{% block content %}&lt;div class=&quot;category-title&quot; style=&quot;text-align: center; margin: 30px 0;&quot;&gt; &lt;h1&gt;{{ page.category }}&lt;/h1&gt; &lt;/div&gt;{# æ–°å¢åŒ…è£¹å®¹å™¨å¹¶æ·»åŠ é—´è· class PS:è¿™ä¸€éƒ¨åˆ†æ˜¯ä¸ªäººæ„Ÿè§‰åˆ—è¡¨å¤ªè´´è¿‘ä¾§è¾¹æ äº†ï¼Œæ‰€ä»¥å’Œé¦–é¡µåˆ†ç±»å¡ç‰‡çš„ä½ç½®è®¾ç½®ä¿æŒä¸€è‡´äº†#} &lt;div class=&quot;posts-container&quot; style=&quot;margin-right: 30px ;&quot;&gt; {%- for post in page.posts.toArray() %} {{ partial('_macro/post.njk', {post: post, is_index: true}) }} {%- endfor %} {%- include '_partials/pagination.njk' -%} {% endblock %}{% block sidebar %} {{ sidebar_template.render(false) }}{% endblock %} æ•ˆæœä»è§ä¸Šä¸€ç¯‡åšå®¢ åˆ é™¤ä¾§è¾¹æ ç›®å½•ä¸‹åˆ’çº¿ä¸æ–‡æœ«æ ‡ç­¾çš„â€œ#â€ è¿™ä¸¤ä¸ªéƒ¨åˆ†æ²¡æœ‰å˜åŠ¨ï¼Œé™¤äº†æ–‡ä»¶åçš„åç¼€æ”¹å˜äº†ï¼Œå…¶ä½™éƒ½ä¸€æ ·ã€‚è¯¦è§ä¸Šä¸€ç¯‡åšå®¢ã€‚ utterancesè¯„è®ºç³»ç»Ÿ æ–°ç‰ˆæœ¬NexTå·²ç»ä¸æ”¯æŒvalineäº†ï¼Œç»™çš„é€‰é¡¹åªæœ‰ï¼š æ‰€ä»¥ç¬”è€…é€‰äº†utterancesã€‚è¿™ä¸ªç³»ç»Ÿå¥½åƒå’Œgithubæœ‰ç‚¹å…³ç³» åœ¨next/config.ymlçš„commentsé‡ŒæŠŠactiveæ”¹æˆutterances ç„¶åéœ€è¦ç»™githubä»“åº“å®‰è£…utterancesï¼Œè®¿é—®https://github.com/apps/utterances ï¼Œç„¶åç‚¹å‡»Install åœ¨è·³è½¬çš„é¡µé¢å‹¾é€‰only select repositoriesï¼Œç„¶åé€‰æ‹©åšå®¢ä»“åº“ ç‚¹å‡»installå°±å¯ä»¥äº† è¦æ³¨æ„çš„æ˜¯ï¼Œhexo sä¸‹æ˜¯è°ƒè¯•ä¸äº†è¿™ä¸ªåŠŸèƒ½çš„ï¼ˆè™½ç„¶ä¸çŸ¥é“æˆ‘ä¸ºä»€ä¹ˆè¦åœ¨hexo sä¸‹è°ƒè¯•è¿™ä¸ªåŠŸèƒ½ï¼‰ï¼Œä¼šæŠ¥é”™ï¼Œä½†æ˜¯éƒ¨ç½²åæ˜¯å¯ä»¥æ­£å¸¸å·¥ä½œçš„ firestoreç»Ÿè®¡è®¿é—®äººæ•° NexT8.23.0ä¸æ”¯æŒValineäº†ï¼Œå¾—é‡æ–°é€‰æ‹©æ•°æ®ç»Ÿè®¡ç³»ç»Ÿã€‚firestoreæ˜¯googleçš„äº§å“ï¼Œå› æ­¤éœ€è¦ç§‘å­¦ä¸Šç½‘ã€‚ å‚è€ƒå¤§ä½¬åšå®¢ï¼šhttps://weirenxue.github.io/2021/06/11/hexo_next_firestore_visitors/ æ­¥éª¤å¾ˆç®€æ´å®Œæ•´äº†ï¼Œä½†æ˜¯ä¸ªäººå®ç°çš„æ—¶å€™ä¼šæœ‰ä¸€äº›é—®é¢˜ï¼Œæ¥ä¸‹æ¥è¯¦ç»†ä»‹ç»ç›¸å…³æ­¥éª¤ é¦–å…ˆï¼Œåœ¨next/config.ymlé‡Œå¯ç”¨firestoreï¼š æœ‰ä¸¤ä¸ªç©ºéœ€è¦å¡«å†™ï¼Œapikeyå’ŒprojectIdã€‚ä¸æ€¥ï¼Œéœ€è¦å…ˆæœ‰firestoreçš„é¡¹ç›®ã€‚æ¥ä¸‹æ¥è®¿é—®firebaseï¼šhttps://console.firebase.google.com/ ï¼ˆç§‘å­¦ä¸Šç½‘ï¼‰ ç™»å½•åç‚¹å‡»â€œåˆ›å»ºé¡¹ç›®â€ æ¥ä¸‹æ¥æŒ‰ç…§å¼•å¯¼èµ°ä¸‹å»ï¼Œå¼€å‘è€…è®¡åˆ’ã€AIè¾…åŠ©ã€google analyticsæ ¹æ®ä¸ªäººéœ€æ±‚é€‰æ‹©ï¼Œç‚¹å‡»ç»§ç»­å¹¶ç¨ç­‰ç‰‡åˆ»å°±åˆ›å»ºæˆåŠŸäº†ã€‚ ç‚¹å‡»æ–°é¡¹ç›®ï¼Œåœ¨å·¦ä¸Šè§’â€œé¡¹ç›®æ¦‚è¿°â€é‡Œç‚¹â€œé¡¹ç›®è®¾ç½®â€ è¿™æ—¶å€™å¯ä»¥çœ‹è§é¡¹ç›®IDç­‰ä¿¡æ¯äº†ï¼Œä½†æ˜¯apiè¿˜æ²¡æœ‰æ˜¾ç¤º æ¥ä¸‹æ¥åœ¨å·¦ä¾§è¾¹æ â€œæ„å»ºâ€é‡Œæ‰¾åˆ°â€œAuthenticationâ€ï¼Œç‚¹å‡»â€œå¼€å§‹â€ï¼ˆå“‡ï¼Œè¿™ä¸ªç•Œé¢è®¾ç½®æˆ‘è¿˜ä»¥ä¸ºgoogleä¸è®©æ‰‹åŠ¨è®¾ç½®åªèƒ½ç”¨AIäº†ï¼ŒçæŒ‰äº†åŠå¤©æ‰çŸ¥é“ç‚¹â€å¼€å§‹â€ï¼‰ æ¥ä¸‹æ¥é€‰æ‹©ç™»é™†æ–¹å¼ç™»å½•å³å¯ã€‚æˆ‘é€‰æ‹©è°·æ­Œï¼Œç‚¹å‡»å³ä¸Šè§’å¯ç”¨ï¼Œé¡¹ç›®å…¬å¼€åç§°é»˜è®¤å³å¯ï¼Œé¡¹ç›®æ”¯æŒé‚®ç®±é€‰æ‹©ä¸ªäººè°·æ­Œé‚®ç®± å›åˆ°é¡¹ç›®è®¾ç½®é¡µé¢ï¼Œå¯ä»¥çœ‹åˆ°apiå·²ç»å‡ºç°äº† æ¥ä¸‹æ¥å°±å¯ä»¥æŠŠnext/config.ymlé‡Œçš„projectIdå’ŒapiKeyå¡«ä¸Šäº† ç„¶åæ‰“å¼€å·¦ä¾§è¾¹æ â€œæ„å»ºâ€é‡Œçš„â€œFirestore Databaseâ€ï¼Œç‚¹å‡»â€œåˆ›å»ºæ•°æ®åº“â€ æ¥ä¸‹æ¥çš„é¡µé¢ï¼Œè®¾ç½®ä½ç½®ï¼ˆæ•°æ®åº“IDä¼¼ä¹ä¸èƒ½æ”¹åŠ¨ï¼‰ï¼Œç„¶åä¸‹ä¸€æ­¥ æ¥ä¸‹æ¥é€‰æ‹©æµ‹è¯•æ¨¡å¼ï¼Œç­‰å¾…é¢„é…Cloud Firestore åŠ è½½æˆåŠŸåé•¿è¿™æ · æ¥ä¸‹æ¥é‡æ–°éƒ¨ç½²åšå®¢åå°±å¯ä»¥æµ‹è¯•è®¡æ•°æœºåˆ¶æ˜¯å¦æ­£å¸¸äº†ã€‚ä½†æ˜¯ç¬”è€…åœ¨è¿™ä¸€æ­¥æŠ˜è…¾äº†å¾ˆä¹…ï¼Œå› ä¸ºè°ƒè¯•çš„æ—¶å€™å‘ç°ï¼š 1.æ•°æ®åº“çš„ä¿¡æ¯åœ¨ç¬¬ä¸€æ¬¡å¯ç”¨è®¡æ•°æœºåˆ¶åä¼šè‡ªåŠ¨ç”Ÿæˆï¼Œä½†æ˜¯å¯¹è¿™äº›ä¿¡æ¯è¿›è¡Œæ”¹åŠ¨åè®¡æ•°æœºåˆ¶å°±å¤±æ•ˆäº† 2.å³ä½¿åœ¨è«åå…¶å¦™çš„æƒ…å†µä¸‹ï¼ˆå¯èƒ½æ˜¯å…³é—­firestoreé…ç½®åå†æ¬¡å¼€å¯çš„æƒ…å†µï¼‰é‡æ–°åˆå§‹åŒ–äº†æ•°æ®åº“ï¼Œè®¡æ•°1æ¬¡ä¹‹åå†æ€ä¹ˆè®¿é—®ï¼ˆå¦‚åˆ·æ–°ã€å…³é—­é¡µé¢é‡æ–°æ‰“å¼€ï¼‰ä¹Ÿä¸ä¼šè®°å½•ç¬¬2æ¬¡ è¿˜æœ‰ä¸€äº›è°ƒè¯•è¿‡ç¨‹å‘ç°çš„é—®é¢˜ï¼Œä½†æ˜¯è°ƒè¯•è¿‡ç¨‹å¤ªä¹±äº†ä¸å¥½æè¿°ï¼Œæ‰€ä»¥ä¸‹é¢ç›´æ¥æŒ‡å‡ºé—®é¢˜å¹¶ç»™å‡ºè§£å†³æ–¹æ¡ˆ é¦–å…ˆï¼Œfirestoreçš„è®¡æ•°æœºåˆ¶æœ‰ç‚¹ç‰¹åˆ«ï¼Œå®ƒä½¿ç”¨äº†localStorageæ¥åˆ¤æ–­æ˜¯å¦è®¿é—®è¿‡æ–‡ç« ï¼Œå¦‚æœè®¿é—®è¿‡æ–‡ç« ï¼Œå°†ä¸ä¼šå‡ºç°ç¬¬äºŒæ¬¡è®¡æ•°çš„æƒ…å†µï¼ˆæ°¸è¿œä¸ä¼šï¼Œé™¤éé‡ç½®localStorageï¼‰ã€‚è¿™ä¹Ÿè§£é‡Šäº†ä¸ºä»€ä¹ˆæ”¹åŠ¨æ•°æ®ä¿¡æ¯åè®¡æ•°æœºåˆ¶ä¼šå¤±æ•ˆï¼šå› ä¸ºæ²¡æœ‰ç¬¬äºŒæ¬¡è®¡æ•°ï¼Œæ‰€ä»¥æ•°æ®åº“ä¿¡æ¯ä¸ä¼šå†æ›´æ–°ã€‚å› æ­¤éœ€è¦å¯¹è®¡æ•°æœºåˆ¶è¿›è¡Œä¸€äº›ä¼˜åŒ–ï¼Œä¼˜åŒ–æ–¹æ¡ˆæ¥è‡ªDeepSeekï¼Œéœ€è¦æ”¹åŠ¨çš„é…ç½®ä¸ºnext/source/js/third-party/statistics/firestore.js 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859/* global CONFIG, firebase */firebase.initializeApp({ apiKey : CONFIG.firestore.apiKey, projectId: CONFIG.firestore.projectId});(function() { const getCount = (doc, increaseCount) =&gt; { // IncreaseCount will be false when not in article page return doc.get().then(d =&gt; { // Has no data, initialize count let count = d.exists ? d.data().count : 0; // If first view this article if (increaseCount) { // Increase count count++; doc.set({ count }); } return count; }); }; const db = firebase.firestore(); const articles = db.collection(CONFIG.firestore.collection); document.addEventListener('page:loaded', () =&gt; { if (CONFIG.page.isPost) { // Fix issue #118 // https://developer.mozilla.org/en-US/docs/Web/API/Node/textContent const title = document.querySelector('.post-title').textContent.trim(); const doc = articles.doc(title); let increaseCount = CONFIG.hostname === location.hostname; if (sessionStorage.getItem(title)) { increaseCount = false; } else { // Mark as visited in current session sessionStorage.setItem(title, true); } getCount(doc, increaseCount).then(count =&gt; { document.querySelector('.firestore-visitors-count').innerText = count; }).catch(e =&gt; console.error('Error updating count:', e)); } else if (CONFIG.page.isHome) { const promises = [...document.querySelectorAll('.post-title')].map(element =&gt; { const title = element.textContent.trim(); const doc = articles.doc(title); return getCount(doc); }); Promise.all(promises).then(counts =&gt; { const metas = document.querySelectorAll('.firestore-visitors-count'); counts.forEach((val, idx) =&gt; { metas[idx].innerText = val; }); }).catch(e =&gt; console.error('Error fetching counts:', e)); } });})(); ç®€å•è§£é‡Šä¸€ä¸‹ä¼˜åŒ–çš„ä¸»è¦æ€è·¯ï¼šä½¿ç”¨sessionStorageæ›¿æ¢localStorageï¼Œè®¡æ•°æœºåˆ¶å˜ä¸ºä¼šè¯çº§ï¼Œå³æ¯æ¬¡æ‰“å¼€æ–‡ç« éƒ½ä¼šè®¡æ•°ï¼Œè€Œåˆ·æ–°ä¸ä¼šè®¡æ•° é‚£ä¹ˆæ¥ä¸‹æ¥å°±è¦è®¾ç½®ä¸€ä¸‹æ•°æ®åº“çš„è§„åˆ™äº†ã€‚å¤§ä½¬çš„å®‰å…¨è§„åˆ™å¥½åƒæœ‰ä¸€äº›æ¼æ´ï¼Œä¸‹é¢æ˜¯DeepSeekç”Ÿæˆçš„å®‰å…¨è§„åˆ™ï¼š 1234567891011121314151617181920212223rules_version = '2';service cloud.firestore { match /databases/{database}/documents { // é’ˆå¯¹æ–‡ç« é›†åˆçš„è§„åˆ™ match /articles/{articleId} { // å…è®¸æ‰€æœ‰äººè¯»å– allow read: if true; // åˆ›å»ºæ–°æ–‡æ¡£æ—¶çš„è§„åˆ™ allow create: if request.resource.data.keys().hasOnly([&quot;count&quot;]) &amp;&amp; request.resource.data.count == 1; // æ›´æ–°æ–‡æ¡£æ—¶çš„è§„åˆ™ï¼ˆç¡®ä¿countåªèƒ½+1ï¼‰ allow update: if request.resource.data.keys().hasOnly([&quot;count&quot;]) &amp;&amp; request.resource.data.count == resource.data.count + 1; } // ç¦æ­¢å…¶ä»–æ‰€æœ‰æ“ä½œ match /{document=**} { allow read, write: if false; } }} æ‰“å¼€â€œFirestore Databaseâ€çš„â€œè§„åˆ™â€ï¼ŒæŠŠè§„åˆ™ç²˜è´´è¿›å»ï¼Œç‚¹å‡»å‘å¸ƒå³å¯","link":"/2025/06/05/%E8%AE%B0%E4%B8%80%E6%AC%A1blog%E9%87%8D%E5%BB%BA/"}],"tags":[{"name":"CTF","slug":"CTF","link":"/tags/CTF/"},{"name":"WriteUp","slug":"WriteUp","link":"/tags/WriteUp/"},{"name":"Reverse","slug":"Reverse","link":"/tags/Reverse/"},{"name":"å¤ç°","slug":"å¤ç°","link":"/tags/%E5%A4%8D%E7%8E%B0/"},{"name":"blog","slug":"blog","link":"/tags/blog/"},{"name":"æ‚è®°","slug":"æ‚è®°","link":"/tags/%E6%9D%82%E8%AE%B0/"},{"name":"å‘¨è®°","slug":"å‘¨è®°","link":"/tags/%E5%91%A8%E8%AE%B0/"}],"categories":[{"name":"WriteUp&amp;å¤ç°","slug":"WriteUp-å¤ç°","link":"/categories/WriteUp-%E5%A4%8D%E7%8E%B0/"},{"name":"Reverseå­¦ä¹ ç¬”è®°","slug":"Reverseå­¦ä¹ ç¬”è®°","link":"/categories/Reverse%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"},{"name":"æ‚è®°","slug":"æ‚è®°","link":"/categories/%E6%9D%82%E8%AE%B0/"},{"name":"å‘¨è®°","slug":"å‘¨è®°","link":"/categories/%E5%91%A8%E8%AE%B0/"}],"pages":[{"title":"about","text":"å…³äºæˆ‘ å—äº¬é‚®ç”µå¤§å­¦2024çº§ä¿¡æ¯å®‰å…¨æœ¬ç§‘åœ¨è¯» X1cT34mã€X2cT34mReæ‰‹ å­¦ä¹ æ–¹å‘æ˜¯ä¸»è¦æ˜¯é€†å‘å·¥ç¨‹ã€äºŒè¿›åˆ¶å®‰å…¨ æœ¬ç«™ä¸»è¦æ˜¯ä¸ºäº†è®°å½•å­¦ä¹ ç»å†ï¼Œå¸Œæœ›å¯ä»¥ä¸ºåƒæˆ‘ä¸€æ ·è¿·èŒ«çš„äººæä¾›ä¸€äº›å¸®åŠ© åˆ†äº«çš„æ–‡ç« ä¼šå°½é‡ä¿è¯å¯è¯»æ€§å’Œå¯å®è·µæ€§ è”ç³»æ–¹å¼ å¾®ä¿¡ï¼šbywnxhx_ QQï¼š2175241477 åšå®¢ï¼šhttps://sydzi.github.io/ æ¬¢è¿å¸ˆå‚…ä»¬æä¾›æŒ‡å¯¼å»ºè®®","link":"/about/index.html"},{"title":"tags","text":"","link":"/tags/index.html"},{"title":"categories","text":"","link":"/categories/index.html"},{"title":"","text":"/* global IcarusThemeSettings, firebase */ // Firebase Counter - é˜…è¯»é‡ç»Ÿè®¡åŠŸèƒ½ if (IcarusThemeSettings && IcarusThemeSettings.services && IcarusThemeSettings.services.firebase && IcarusThemeSettings.services.firebase.enable) { // åˆå§‹åŒ–Firebase try { // ç¡®ä¿firebaseå¯¹è±¡å­˜åœ¨ if (typeof firebase === 'undefined') { console.error('Firebase library not loaded'); // å¦‚æœFirebaseåº“æœªåŠ è½½ï¼Œéšè—è®¡æ•°å™¨å…ƒç´  document.querySelectorAll('.firestore-visitors-count').forEach(el => { el.style.display = 'none'; }); } else { firebase.initializeApp({ apiKey: IcarusThemeSettings.services.firebase.apiKey, projectId: IcarusThemeSettings.services.firebase.projectId }); // å¼€å‘ç¯å¢ƒæ£€æµ‹ const isLocalhost = ['localhost', '127.0.0.1'].includes(window.location.hostname); const isDevelopment = isLocalhost || window.location.hostname.includes('192.168.'); // ç§»é™¤æ‰€æœ‰è°ƒè¯•æ—¥å¿—è¾“å‡º // è·å–æ•°æ®åº“å¼•ç”¨ const db = firebase.firestore(); const articlesCollection = IcarusThemeSettings.services.firebase.collection || 'articles'; const articles = db.collection(articlesCollection); // è·å–é˜…è¯»æ¬¡æ•°å‡½æ•° const getCount = (doc, increaseCount) => { // è·å–æ–‡æ¡£æ•°æ® return doc.get().then(d => { // åˆå§‹åŒ–è®¡æ•° let count = d.exists ? d.data().count : 0; // å¦‚æœéœ€è¦å¢åŠ è®¡æ•°ï¼ˆåªåœ¨æ–‡ç« é¡µé¢ä¸”æœªåœ¨åŒä¸€ä¼šè¯è®¿é—®è¿‡ï¼‰ if (increaseCount) { // å¢åŠ è®¡æ•° count++; return doc.set({ count }).then(() => { if (isDevelopment) console.log('è®¡æ•°å·²æ›´æ–°:', count); return count; }).catch(error => { console.error('Error updating count:', error); return count; // è¿”å›å¢åŠ å‰çš„è®¡æ•° }); } return count; }).catch(error => { console.error('Error getting count:', error); // å‡ºé”™æ—¶è¿”å›é»˜è®¤å€¼0 return 0; }); }; // å¤„ç†é˜…è¯»è®¡æ•°çš„å‡½æ•° const handleViewCount = () => { // è·å–å½“å‰URLè·¯å¾„ const currentPath = window.location.pathname; // å¢å¼ºé¦–é¡µè¯†åˆ«ï¼šä½¿ç”¨å¤šä¸ªå¯èƒ½çš„é€‰æ‹©å™¨ const isIndexPage = document.querySelector('.article-list') !== null || document.querySelector('.article-card-list') !== null || document.querySelectorAll('.article-card').length > 0 || // é™ä½é˜ˆå€¼ä»¥é€‚åº”é¦–é¡µ (currentPath === '/' && document.querySelector('article.article') !== null); // ç‰¹æ®Šå¤„ç†ï¼šæ ¹è·¯å¾„+article.articleå…ƒç´  // å¢å¼ºæ–‡ç« é¡µé¢è¯†åˆ«ï¼šä½¿ç”¨æ›´ç²¾ç¡®çš„é€‰æ‹©å™¨ç»„åˆ // é‡è¦ï¼šé¦–é¡µä¼˜å…ˆåˆ¤æ–­ï¼Œä¸”æ–‡ç« é¡µåˆ¤æ–­è¦æ’é™¤é¦–é¡µçš„æƒ…å†µï¼Œå¹¶å¢åŠ ç‰¹å®šçš„æ–‡ç« é¡µç‰¹å¾ const isArticlePage = !isIndexPage && ( // ä¼ ç»Ÿæ–‡ç« é¡µé€‰æ‹©å™¨ (document.querySelector('.article-container') !== null && document.querySelector('.article-content') !== null) || (document.querySelector('article.post') !== null && document.querySelector('.article-content') !== null) || document.querySelector('[id=\"post-content\"]') !== null || // é’ˆå¯¹hexo sç¯å¢ƒçš„å¢å¼ºé€‰æ‹©å™¨ï¼Œä½†éœ€è¦ç¡®ä¿ä¸æ˜¯é¦–é¡µ (document.querySelector('article.article') !== null && document.querySelector('article.card-content.article') !== null && document.querySelectorAll('.article-card').length === 0 && currentPath !== '/') ); // é¡µé¢ç±»å‹ä¿¡æ¯ - ä»…åœ¨å¼€å‘ç¯å¢ƒæ˜¾ç¤º if (isDevelopment) { console.log(`[Firebase] å½“å‰é¡µé¢ç±»å‹: ${isArticlePage ? 'æ–‡ç« é¡µ' : isIndexPage ? 'é¦–é¡µ' : 'å…¶ä»–é¡µé¢'}`); } if (isArticlePage) { // æ–‡ç« é¡µé¢å¤„ç† const titleElement = document.querySelector('.title.is-3, .title.is-4-mobile'); const countElement = document.querySelector('.firestore-visitors-count'); if (titleElement && countElement) { const title = titleElement.textContent.trim(); const doc = articles.doc(title); // ç¡®å®šæ˜¯å¦å¢åŠ è®¡æ•°ï¼šä¸åœ¨æœ¬åœ°å¼€å‘ç¯å¢ƒä¸”åŒä¸€ä¼šè¯æœªè®¿é—®è¿‡ let increaseCount = !isDevelopment; if (sessionStorage.getItem(title)) { increaseCount = false; } else { // æ ‡è®°ä¸ºåœ¨å½“å‰ä¼šè¯ä¸­å·²è®¿é—® sessionStorage.setItem(title, true); } getCount(doc, increaseCount).then(count => { countElement.innerText = count; }).catch(e => { // ç§»é™¤é”™è¯¯æ—¥å¿— }); } else { // é™é»˜å¤„ç†ï¼šæœªæ‰¾åˆ°æ–‡ç« æ ‡é¢˜æˆ–è®¡æ•°å…ƒç´  } } else if (isIndexPage) { // é¦–é¡µæ–‡ç« åˆ—è¡¨å¤„ç† // ä¿®æ”¹é€‰æ‹©å™¨ä»¥åŒ¹é…å®é™…HTMLç»“æ„ // é¦–é¡µæ–‡ç« ç»“æ„: .card > .card-content.article > .title.is-3.is-size-4-mobile const titleElements = document.querySelectorAll( '.card .article .title.is-3, .card .article .title.is-4-mobile, ' + '.card article .title.is-3, .card article .title.is-4-mobile, ' + '.card .article p.title, .card article p.title' ); const countElements = document.querySelectorAll('.card .article .firestore-visitors-count, .card article .firestore-visitors-count'); // ç§»é™¤é¦–é¡µå…ƒç´ æ£€æµ‹æ—¥å¿— if (titleElements.length > 0 && countElements.length > 0) { const promises = [...titleElements].map(element => { const title = element.textContent.trim(); const doc = articles.doc(title); // é¦–é¡µåªè·å–è®¡æ•°ï¼Œä¸å¢åŠ è®¡æ•° return getCount(doc, false).then(count => { return count; }); }); Promise.all(promises).then(counts => { counts.forEach((val, idx) => { if (countElements[idx]) { countElements[idx].innerText = val; } }); }).catch(e => { // é”™è¯¯å¤„ç†ï¼šå°è¯•æ˜¾ç¤ºä¸€äº›é»˜è®¤å€¼æˆ–æ›¿ä»£æ–‡æœ¬ countElements.forEach(el => { if (el.innerText === '0') { el.innerText = 'åŠ è½½ä¸­...'; } }); }); } else { // å°è¯•ä½¿ç”¨æ›´é€šç”¨çš„é€‰æ‹©å™¨ const fallbackTitleElements = document.querySelectorAll('.article-card a[href^=\"/\"]'); const fallbackCountElements = document.querySelectorAll('.article-card .firestore-visitors-count'); if (fallbackTitleElements.length > 0 && fallbackCountElements.length > 0) { // è¿™é‡Œå¯ä»¥æ·»åŠ å¤‡é€‰é€»è¾‘ } } } else { // é™é»˜å¤„ç†ï¼šå½“å‰é¡µé¢æ—¢ä¸æ˜¯æ–‡ç« é¡µä¹Ÿä¸æ˜¯é¦–é¡µ } }; // ç›‘å¬ä¼ ç»Ÿé¡µé¢åŠ è½½å®Œæˆäº‹ä»¶ document.addEventListener('DOMContentLoaded', () => { handleViewCount(); }); // ç›‘å¬PJAXé¡µé¢åŠ è½½å®Œæˆäº‹ä»¶ï¼ˆé€‚é…Icarusä¸»é¢˜çš„PJAXæœºåˆ¶ï¼‰ document.addEventListener('page:loaded', () => { handleViewCount(); }); } } catch (error) { // ç§»é™¤åˆå§‹åŒ–å¤±è´¥æ—¥å¿— // å¦‚æœåˆå§‹åŒ–å¤±è´¥ï¼Œå°è¯•éšè—è®¡æ•°å™¨å…ƒç´ ä»¥é¿å…æ˜¾ç¤ºä¸º0 document.querySelectorAll('.firestore-visitors-count').forEach(el => { el.style.display = 'none'; }); } }","link":"/js/firebase_counter.js"}]}