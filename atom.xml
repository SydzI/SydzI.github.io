<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>SydzI&#39;s Blog</title>
  
  <subtitle>è·¯æ¼«æ¼«å…¶ä¿®è¿œå…®ï¼Œå¾å°†ä¸Šä¸‹è€Œæ±‚ç´¢</subtitle>
  <link href="https://sydzi.github.io/atom.xml" rel="self"/>
  
  <link href="https://sydzi.github.io/"/>
  <updated>2025-09-18T14:24:47.654Z</updated>
  <id>https://sydzi.github.io/</id>
  
  <author>
    <name>SydzI</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Day1:æ•°æ®ç»“æ„ä¸å¤æ‚åº¦</title>
    <link href="https://sydzi.github.io/2025/09/18/Day1-%E5%A4%8D%E6%9D%82%E5%BA%A6/"/>
    <id>https://sydzi.github.io/2025/09/18/Day1-%E5%A4%8D%E6%9D%82%E5%BA%A6/</id>
    <published>2025-09-18T04:16:30.000Z</published>
    <updated>2025-09-18T14:24:47.654Z</updated>
    
    <content type="html"><![CDATA[<p>æ•°æ®ç»“æ„ç®€è¿°ã€å¤æ‚åº¦åˆæ¢</p><span id="more"></span><h2 id="æ•°æ®ç»“æ„ç®€è¿°"><a href="#æ•°æ®ç»“æ„ç®€è¿°" class="headerlink" title="æ•°æ®ç»“æ„ç®€è¿°"></a>æ•°æ®ç»“æ„ç®€è¿°</h2><ul><li><p>â€œæ•°æ®ç»“æ„ï¼ˆdata structureï¼‰æ˜¯ç»„ç»‡å’Œå­˜å‚¨æ•°æ®çš„æ–¹å¼ï¼Œæ¶µç›–æ•°æ®å†…å®¹ã€æ•°æ®ä¹‹é—´å…³ç³»å’Œæ•°æ®æ“ä½œæ–¹æ³•â€ï¼Œè¿™æ˜¯<a href="https://www.hello-algo.com/">Hello ç®—æ³•</a>ä¸­ç»™å‡ºçš„å®šä¹‰ã€‚æ•°æ®ç»“æ„æ˜¯äººä¸ºåˆ›é€ çš„ã€æœåŠ¡äºæ•°æ®å­˜å‚¨ä¸å¤„ç†çš„ä¸€ç§è§„èŒƒï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®ä¸€ç§æ•°æ®ç»“æ„çš„æ¦‚å¿µï¼Œç”¨ä¸åŒçš„è¯­è¨€ã€ä¸åŒçš„ç‰¹æ€§æ¥å®ç°å®ƒã€‚</p></li><li><p>æ•°æ®ä¸»è¦æœ‰ä¸¤ç§å­˜å‚¨ç»“æ„ï¼šé¡ºåºå­˜å‚¨å’Œé“¾å¼å­˜å‚¨ã€‚è¿™ä¸¤ç§å­˜å‚¨ç»“æ„æ˜¯åç»­å„ç§æ•°æ®ç»“æ„å®ç°çš„åŸºç¡€ã€‚</p><ul><li><p>é¡ºåºå­˜å‚¨ï¼Œå°±æ˜¯æ•°æ®å­˜å‚¨åœ¨è¿ç»­çš„å†…å­˜ç©ºé—´ä¸Šã€‚</p></li><li><p>é“¾å¼å­˜å‚¨ï¼Œå°±æ˜¯æ•°æ®å­˜å‚¨åœ¨ä¸è¿ç»­çš„å†…å­˜ç©ºé—´ä¸Šï¼Œä½†æ˜¯æ¯ä¸ªå†…å­˜å•ä½ä¹‹é—´åˆæœ‰è”ç³»ï¼Œåƒé“¾æ¡ä¸€æ ·ä¸²è”åœ¨ä¸€èµ·ã€‚</p></li></ul></li><li><p>æ•°æ®ç»“æ„æŒ‰ç…§é€»è¾‘ç‰¹å¾å¯ä»¥åˆ†ä¸ºå››ç§ï¼šçº¿æ€§ç»“æ„ã€å›¾ç»“æ„ã€æ ‘å½¢ç»“æ„ã€é›†åˆç»“æ„ã€‚</p></li><li><p>æŠ½è±¡æ•°æ®ç±»å‹(ADT)ï¼šç”¨äºæè¿°æ•°æ®ç»“æ„çš„ä¸€ç§æ¨¡å‹ï¼ŒåŒ…æ‹¬äº†ç»“æ„ç‰¹æ€§çš„æè¿°ã€ç›¸å…³çš„è¿ç®—å‡½æ•°æè¿°ã€‚ADTå’Œç±»å¾ˆåƒï¼Œä½†æ˜¯ADTæ›´åƒæ˜¯ç”¨ä»£ç å®ç°å…·ä½“æ•°æ®ç»“æ„å‰åˆ—çš„çš„æçº²ã€‚</p></li><li><p>ç®—æ³•æ˜¯å¯¹æ•°æ®è¿›è¡Œå¤„ç†çš„ç­–ç•¥ï¼Œå³è¿ç®—æ–¹æ³•ã€‚ç®—æ³•ä¼šä¾èµ–æ•°æ®ç»“æ„æ¥å®ç°ã€‚ç®—æ³•è¿½æ±‚æ•ˆç‡ï¼Œå³æ›´çŸ­çš„è¿ç®—æ—¶é—´å’Œæ›´å°‘çš„èµ„æºå ç”¨ã€‚</p></li></ul><h2 id="å¤æ‚åº¦"><a href="#å¤æ‚åº¦" class="headerlink" title="å¤æ‚åº¦"></a>å¤æ‚åº¦</h2><ul><li><p>ç®—æ³•è¿½æ±‚æ—¶é—´å’Œç©ºé—´ä¸Šçš„æ•ˆç‡ï¼Œæ‰€ä»¥æè¿°ä¸€ä¸ªç®—æ³•çš„å¤æ‚åº¦åˆ†ä¸ºä¸¤ç§ï¼šæ—¶é—´å¤æ‚åº¦å’Œç©ºé—´å¤æ‚åº¦ã€‚</p></li><li><p>æ—¶é—´å¤æ‚åº¦è¯„ä¼°çš„æ˜¯ä¸€æ®µä»£ç çš„è¿è¡Œæ—¶é—´ï¼Œç”±äºè®¡ç®—æœºæ‰§è¡Œæ“ä½œçš„æ—¶é—´éƒ½å¾ˆçŸ­ï¼Œæ‰€ä»¥æ—¶é—´å¤æ‚åº¦çš„è¯„ä¼°å¾€å¾€ç­‰åŒäºæ“ä½œæ¬¡æ•°çš„è¯„ä¼°ã€‚æˆ‘ä»¬é€šå¸¸è¯´çš„æ—¶é—´å¤æ‚åº¦å®é™…ä¸Šæ˜¯æ¸è¿›æ—¶é—´å¤æ‚åº¦ã€‚æ ‡å‡†çš„æ—¶é—´å¤æ‚åº¦è€ƒè™‘ä»£ç ä¸­æ‰€æœ‰çš„æ“ä½œï¼Œæ¯”å¦‚èµ‹å€¼ä¼šè®°1æ¬¡æ“ä½œï¼Œä¸¤ä¸ªå˜é‡ç›¸åŠ ä¼šè®°1æ¬¡æ“ä½œç­‰ã€‚æ¸è¿›æ—¶é—´å¤æ‚åº¦åˆ™åªè€ƒè™‘æ“ä½œæ•°çš„é‡çº§ï¼Œæ‰€ä»¥å…³æ³¨çš„å¾€å¾€æ˜¯ä»£ç ä¸­çš„å…³é”®æ“ä½œã€‚</p><p>æ‰€è°“å…³é”®æ“ä½œï¼Œä¸€èˆ¬æ˜¯æŒ‡æ“ä½œè¾¹ç•Œå«nï¼Œå³æ“ä½œçš„è¾¹ç•Œå«æœ‰å˜é‡ã€ä¸åŒæƒ…å†µä¸‹è¾¹ç•Œä¸åŒçš„çš„æ“ä½œã€‚å¦‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs C"><span class="hljs-type">int</span> <span class="hljs-title function_">sum</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span>&#123;<br>    <span class="hljs-type">int</span> sum=<span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=n;i++)&#123;<br>        sum+=n;<br>    &#125;<br>    <span class="hljs-keyword">return</span> sum;<br>&#125;<br></code></pre></td></tr></table></figure><p>å…¶ä¸­ï¼Œforå¾ªç¯ä¸­çš„æ“ä½œæ‰§è¡Œæ¬¡æ•°ä¾èµ–äºè¾¹ç•Œnï¼Œè¿™å°±æ˜¯æˆ‘ä»¬éœ€è¦å…³æ³¨çš„åœ°æ–¹ã€‚</p><p>ä»¥è¿™æ®µä»£ç ä¸ºä¾‹ï¼Œç»™sumèµ‹å€¼çš„è¯­å¥è®°1æ¬¡æ“ä½œï¼Œforå¾ªç¯ä¸­ï¼Œç»™ièµ‹å€¼è®°1æ¬¡æ“ä½œï¼Œiçš„è¾¹ç•Œåˆ¤æ–­è®°n+1æ¬¡æ“ä½œï¼ˆå› ä¸ºiè‡ªå¢åˆ°n+1è¿˜ä¼šåˆ°i&lt;&#x3D;nè¿™é‡Œæ¥è¿›è¡Œè¾¹ç•Œåˆ¤æ–­ï¼‰ï¼Œforå¾ªç¯ä¸­sumç´¯åŠ è®°næ¬¡æ“ä½œï¼Œè¿”å›sumè®°1æ¬¡æ“ä½œã€‚è¿™æ ·å­ï¼Œè¿™æ®µä»£ç æ€»å…±è¿›è¡Œäº†2n+4æ¬¡æ“ä½œï¼Œåªè€ƒè™‘é‡çº§çš„è¯å°±æ˜¯nã€‚</p></li><li><p>å¯¹äºæ¸è¿›æ—¶é—´å¤æ‚åº¦ï¼Œé‡‡ç”¨å¤§Oè¡¨ç¤ºæ³•ï¼šO(ç®—æ³•é‡çº§)ã€‚å¦‚ä¸Šé¢è¿™æ®µä»£ç ï¼Œé‡çº§ä¸ºnï¼Œæ¸è¿›æ—¶é—´å¤æ‚åº¦è®°ä¸ºO(n)ã€‚</p></li><li><p>ç©ºé—´å¤æ‚åº¦è¯„ä¼°çš„æ˜¯ä¸€æ®µä»£ç å ç”¨çš„å†…å­˜ç©ºé—´ã€‚ç©ºé—´å¤æ‚åº¦å’Œæ—¶é—´å¤æ‚åº¦ç±»ä¼¼ï¼Œé€šå¸¸åªè€ƒè™‘é‡çº§ï¼Œä½†æ­¤å¤„æ˜¯å ç”¨å†…å­˜ç©ºé—´çš„é‡çº§ã€‚å†…å­˜ç©ºé—´çš„å ç”¨æ¯”è¾ƒç›´è§‚ï¼Œå…³æ³¨çš„é‡ç‚¹ä¾æ—§æ˜¯è¾¹ç•ŒåŒ…å«å˜é‡çš„æ“ä½œï¼Œè®°å½•çš„æ˜¯æ“ä½œå¸¦æ¥çš„å†…å­˜ç©ºé—´å ç”¨æƒ…å†µã€‚å¦‚èµ‹å€¼æ“ä½œï¼Œè®°1ä¸ªå•ä½çš„ç©ºé—´å ç”¨ï¼›åˆ›å»ºé•¿åº¦ä¸ºnçš„æ•°ç»„ï¼Œè®°nä¸ªå•ä½çš„ç©ºé—´å ç”¨ç­‰ã€‚è¿˜ç”¨ä¸Šé¢çš„ä»£ç ä¸ºä¾‹å­ï¼Œsumèµ‹å€¼è®°1ä¸ªå•ä½ï¼Œièµ‹å€¼è®°1ä¸ªå•ä½ï¼Œæ‰€ä»¥è¿™æ®µä»£ç æ€»å…±å°±å ç”¨2ä¸ªå•ä½çš„å†…å­˜ç©ºé—´ï¼Œé‡çº§ä¸º1ï¼Œç©ºé—´å¤æ‚åº¦è®°ä¸ºO(1)ã€‚</p></li><li><p>å¸¸è§æ“ä½œçš„æ—¶é—´å¤æ‚åº¦å’Œç©ºé—´å¤æ‚åº¦ï¼š</p><table><thead><tr><th align="left">è¯­å¥&#x2F;æ“ä½œ</th><th align="left">æ—¶é—´å¤æ‚åº¦</th><th align="left">ç©ºé—´å¤æ‚åº¦</th><th align="left">è¯´æ˜</th></tr></thead><tbody><tr><td align="left"><strong>èµ‹å€¼æ“ä½œ</strong> (<code>a = b</code>)</td><td align="left">O(1)</td><td align="left">O(1)</td><td align="left">åŸºæœ¬æ•°æ®ç±»å‹èµ‹å€¼</td></tr><tr><td align="left"><strong>ç®—æœ¯è¿ç®—</strong> (<code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>%</code>)</td><td align="left">O(1)</td><td align="left">O(1)</td><td align="left">å›ºå®šå¤§å°æ•°å€¼è¿ç®—</td></tr><tr><td align="left"><strong>æ¯”è¾ƒæ“ä½œ</strong> (<code>==</code>, <code>!=</code>, <code>&lt;</code>, <code>&gt;</code>)</td><td align="left">O(1)</td><td align="left">O(1)</td><td align="left">åŸºæœ¬æ•°æ®ç±»å‹æ¯”è¾ƒ</td></tr><tr><td align="left"><strong>æ•°ç»„ç´¢å¼•</strong> (<code>arr[i]</code>)</td><td align="left">O(1)</td><td align="left">O(1)</td><td align="left">éšæœºè®¿é—®</td></tr><tr><td align="left"><strong>å‡½æ•°è°ƒç”¨</strong></td><td align="left">O(1)</td><td align="left">O(1)</td><td align="left">è°ƒç”¨å¼€é”€æœ¬èº«</td></tr><tr><td align="left"><strong>if-else</strong></td><td align="left">O(1)</td><td align="left">O(1)</td><td align="left">æ¡ä»¶åˆ¤æ–­æœ¬èº«</td></tr><tr><td align="left"><strong>switch-case</strong></td><td align="left">O(1)</td><td align="left">O(1)</td><td align="left">è·³è½¬è¡¨å®ç°</td></tr><tr><td align="left"><strong>goto</strong></td><td align="left">O(1)</td><td align="left">O(1)</td><td align="left">è·³è½¬æŒ‡ä»¤</td></tr><tr><td align="left"><strong>å•å±‚forå¾ªç¯</strong></td><td align="left">O(n)</td><td align="left">O(1)</td><td align="left">å¾ªç¯næ¬¡ï¼Œä½“ä¸ºO(1)</td></tr><tr><td align="left"><strong>åµŒå¥—forå¾ªç¯</strong></td><td align="left">O(nÂ²)</td><td align="left">O(1)</td><td align="left">ä¸¤å±‚å„næ¬¡å¾ªç¯</td></tr><tr><td align="left"><strong>whileå¾ªç¯</strong></td><td align="left">O(n)</td><td align="left">O(1)</td><td align="left">å¾ªç¯næ¬¡ï¼Œä½“ä¸ºO(1)</td></tr><tr><td align="left"><strong>do-whileå¾ªç¯</strong></td><td align="left">O(n)</td><td align="left">O(1)</td><td align="left">å¾ªç¯næ¬¡ï¼Œä½“ä¸ºO(1)</td></tr><tr><td align="left"><strong>é€’å½’è°ƒç”¨</strong></td><td align="left">O(n)</td><td align="left">O(n)</td><td align="left">çº¿æ€§é€’å½’ï¼Œnä¸ºæ·±åº¦</td></tr><tr><td align="left"><strong>å°¾é€’å½’ä¼˜åŒ–</strong></td><td align="left">O(n)</td><td align="left">O(1)</td><td align="left">ç¼–è¯‘å™¨ä¼˜åŒ–å</td></tr><tr><td align="left"><strong>å‡½æ•°è¿”å›</strong></td><td align="left">O(1)</td><td align="left">O(1)</td><td align="left">æ ˆå¸§é”€æ¯</td></tr><tr><td align="left"><strong>malloc&#x2F;new</strong></td><td align="left">O(1)</td><td align="left">O(n)</td><td align="left">åˆ†é…nå­—èŠ‚å†…å­˜</td></tr><tr><td align="left"><strong>free&#x2F;delete</strong></td><td align="left">O(1)</td><td align="left">O(1)</td><td align="left">é‡Šæ”¾å†…å­˜</td></tr><tr><td align="left"><strong>å†…å­˜æ‹·è´</strong></td><td align="left">O(n)</td><td align="left">O(1)</td><td align="left">æ‹·è´nå­—èŠ‚</td></tr><tr><td align="left"><strong>å†…å­˜è®¾ç½®</strong></td><td align="left">O(n)</td><td align="left">O(1)</td><td align="left">è®¾ç½®nå­—èŠ‚</td></tr><tr><td align="left"><strong>try-catch</strong></td><td align="left">O(1)</td><td align="left">O(1)</td><td align="left">æ— å¼‚å¸¸æ—¶å¼€é”€</td></tr><tr><td align="left"><strong>throwæŠ›å‡º</strong></td><td align="left">O(n)</td><td align="left">O(1)</td><td align="left">nä¸ºè°ƒç”¨æ ˆæ·±åº¦</td></tr><tr><td align="left"><strong>å¼‚å¸¸æ•è·</strong></td><td align="left">O(1)</td><td align="left">O(1)</td><td align="left">åŒ¹é…å¼‚å¸¸ç±»å‹</td></tr></tbody></table></li></ul>]]></content>
    
    
    <summary type="html">æ•°æ®ç»“æ„ç®€è¿°ã€å¤æ‚åº¦åˆæ¢</summary>
    
    
    
    <category term="æ•°æ®ç»“æ„ä¸ç®—æ³•" scheme="https://sydzi.github.io/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/"/>
    
    
    <category term="æ•°æ®ç»“æ„ä¸ç®—æ³•" scheme="https://sydzi.github.io/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>week27-week30</title>
    <link href="https://sydzi.github.io/2025/09/08/week27-week30/"/>
    <id>https://sydzi.github.io/2025/09/08/week27-week30/</id>
    <published>2025-09-08T11:42:15.000Z</published>
    <updated>2025-09-21T12:25:14.447Z</updated>
    
    <content type="html"><![CDATA[<p>2025å¹´9æœˆç¯‡</p><span id="more"></span><h2 id="week27-2025-9-1-2025-9-7"><a href="#week27-2025-9-1-2025-9-7" class="headerlink" title="week27 (2025.9.1-2025.9.7)"></a>week27 (2025.9.1-2025.9.7)</h2><ul><li>æ¥ä¸‹æ¥æ‰“ç®—æŠŠå‘¨è®°åˆ†æˆå››å‘¨ä¸€ç¯‡äº†ï¼Œæ¯å‘¨ç…§æ ·æ›´æ–°ï¼Œä½†æ˜¯å››å‘¨ä¸€ç¯‡æ–‡ç« </li><li>è¿™å‘¨ï¼ˆå…¶å®æ˜¯ä¸Šå‘¨ï¼Œè¿™æ®µæ˜¯è¡¥çš„ï¼‰æŠŠåšå®¢ä¸»é¢˜ç»™æ¢äº†ã€‚åŸå…ˆæƒ³ç€å…ˆé…ç½®å®Œï¼Œåˆ°æ—¶å€™ç›´æ¥æŠŠæ–‡ç« ç§»åˆ°æ–°çš„åšå®¢æ–‡ä»¶é‡Œï¼Œä½†æ˜¯è¿›åº¦å¤ªæ…¢äº†ã€‚è¿™å‘¨ç›´æ¥ç»™åŸåšå®¢æ¢çš®ğŸ˜‹è¿˜æ›´äº†ä¸€ç¯‡åšå®¢,çœŸå¥½ğŸ˜‹(è™½ç„¶è¿˜æ˜¯AIå‡ºåŠ›)</li><li>moe week4ä¸Šæ–°é¢˜äº†,ä½†æ˜¯week3ç”šè‡³week2è¿˜æœ‰æ²¡å†™å®Œçš„é¢˜</li><li>å®‰å“è¿™å—çš„ç¬”è®°è¿˜æ²¡æ›´,å¼€å­¦äº†æ‰¾æ‰¾æ—¶é—´è¡¥ä¸Š</li></ul><h2 id="week28-2025-9-8-2025-9-14"><a href="#week28-2025-9-8-2025-9-14" class="headerlink" title="week28 (2025.9.8-2025.9.14)"></a>week28 (2025.9.8-2025.9.14)</h2><ul><li>å¥½çš„æ‰‹å¿™è„šä¹±çš„å¼€å­¦ç¬¬ä¸€å‘¨ï¼Œç›®å‰å­¦ä¹ è®¡åˆ’æœ‰å¾…æ›´æ–°ã€‚</li><li>è¿™å‘¨å’ŒX2cçš„æ–°å¸ˆå‚…ä»¬ç»„é˜Ÿå‚åŠ äº†æ¹¾åŒºæ¯ï¼Œç‹¬ç«‹è§£å‡ºäº†ä¸€é“é¢˜ï¼Œè¿˜æ˜¯å¤ªèœäº†ã€‚è€ƒå¯Ÿæ–¹å‘è¿˜æŒºå…¨é¢ï¼Œpcç«¯ã€å®‰å“ç”šè‡³å¾®ä¿¡å°ç¨‹åºéƒ½æœ‰ã€‚</li></ul><h2 id="week29-2025-9-15-2025-9-21"><a href="#week29-2025-9-15-2025-9-21" class="headerlink" title="week29 (2025.9.15-2025.9.21)"></a>week29 (2025.9.15-2025.9.21)</h2><ul><li>è¿™å‘¨æœ‰ä¸ªé•¿åŸæ¯ï¼ˆè¿˜æœ‰ä¸ªé“äººä¸‰é¡¹é•¿åŸæ¯ï¼Œè¿™ä¿©å¥½åƒä¸æ˜¯ä¸€ä¸ªï¼‰ï¼Œåªåˆ†webã€AIå®‰å…¨ã€æ•°æ®å®‰å…¨ä¸‰ä¸ªæ–¹å‘ï¼Œæ²¡åšå‡ºæ¥ï¼Œçˆ†0äº†</li><li>å¼€å­¦äº†å­¦ä¹ çŠ¶æ€åˆå¼€å§‹ä¸ç¨³å®šäº†ï¼Œè€æ˜¯å·æ‡’ä¸æ‰¾æ—¶é—´å­¦ğŸ˜–è¿™å­¦æœŸå¤šé—¨æ•°å­¦ç›¸å…³è¯¾ï¼Œè¦ç‡ƒå°½äº†</li><li>ç»™åšå®¢æ–°å¼€äº†æ•°æ®ç»“æ„åˆ†ç±»ï¼Œèƒ½ä¸èƒ½æ›´ä¸‹å»çœ‹é€ åŒ–äº†(</li></ul>]]></content>
    
    
    <summary type="html">&lt;p&gt;2025å¹´9æœˆç¯‡&lt;/p&gt;</summary>
    
    
    
    <category term="å‘¨è®°" scheme="https://sydzi.github.io/categories/%E5%91%A8%E8%AE%B0/"/>
    
    
    <category term="å‘¨è®°" scheme="https://sydzi.github.io/tags/%E5%91%A8%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>icarusä¸»é¢˜ä¼˜åŒ–</title>
    <link href="https://sydzi.github.io/2025/09/02/icarus%E4%B8%BB%E9%A2%98%E4%BC%98%E5%8C%96/"/>
    <id>https://sydzi.github.io/2025/09/02/icarus%E4%B8%BB%E9%A2%98%E4%BC%98%E5%8C%96/</id>
    <published>2025-09-02T04:13:44.000Z</published>
    <updated>2025-09-07T07:50:42.954Z</updated>
    
    <content type="html"><![CDATA[<p>icarusä¸»é¢˜å¤åˆ¶åŠŸèƒ½é‡æ„ï¼ˆä»¿ç…§nextä¸»é¢˜ï¼‰ã€firebaseç»Ÿè®¡é˜…è¯»äººæ•°</p><span id="more"></span><h2 id="å¤åˆ¶åŠŸèƒ½é‡æ„"><a href="#å¤åˆ¶åŠŸèƒ½é‡æ„" class="headerlink" title="å¤åˆ¶åŠŸèƒ½é‡æ„"></a>å¤åˆ¶åŠŸèƒ½é‡æ„</h2><ul><li><p>icarusä¸»é¢˜è‡ªå¸¦çš„å¤åˆ¶åŠŸèƒ½æ˜¯å¸¦æ–‡å­—é€‰ä¸­çš„ï¼ˆå¦‚ä¸‹å›¾ï¼‰ï¼Œä¸ªäººæ„Ÿè§‰éº»çƒ¦äº†ç‚¹ï¼Œäºæ˜¯è€ƒè™‘å€Ÿé‰´nextçš„å¤åˆ¶é£æ ¼ï¼Œä¸€é”®å¤åˆ¶</p><p><img src="/../images/image-20250902231901036.png" alt="å®˜ç½‘æŒ‡å—æˆªå›¾"></p></li><li><p>å®ç°ï¼š</p><p>hexo-theme-icarus&#x2F;source&#x2F;js&#x2F;main.jsï¼š</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><code class="hljs diff">        if (clipboard) &#123;<br><span class="hljs-deletion">-           new ClipboardJS(&#x27;.highlight .copy&#x27;, &#123;</span><br><span class="hljs-deletion">-               target: function(trigger) &#123;</span><br><span class="hljs-deletion">-                   return trigger.parentNode.nextElementSibling;</span><br><span class="hljs-deletion">-               &#125;</span><br><span class="hljs-deletion">-           &#125;).on(&#x27;success&#x27;, function(e) &#123;</span><br><span class="hljs-deletion">-               e.clearSelection();</span><br><span class="hljs-deletion">-               const tmp = e.trigger.innerHTML;</span><br><span class="hljs-deletion">-               e.trigger.innerHTML = &#x27;&lt;i class=&quot;fas fa-check&quot;&gt;&lt;/i&gt;&#x27;;</span><br><span class="hljs-deletion">-               setTimeout(function() &#123;</span><br><span class="hljs-deletion">-                   e.trigger.innerHTML = tmp;</span><br><span class="hljs-deletion">-               &#125;, 2000);</span><br><span class="hljs-deletion">-           &#125;);</span><br><span class="hljs-addition">+           $(&#x27;figure.highlight&#x27;).each(function() &#123;</span><br><span class="hljs-addition">+               const target = $(this).find(&#x27;figcaption div.level-right&#x27;)[0];</span><br><span class="hljs-addition">+               if (target) &#123;</span><br><span class="hljs-addition">+                   registerCopyButton(target, this);</span><br><span class="hljs-addition">+               &#125;</span><br><span class="hljs-addition">+           &#125;);</span><br>        &#125;<br>        <br><span class="hljs-comment">----------------------------------------------------------------------------------</span><br><br>...<br><br>    $(&#x27;.article &gt; .content &gt; table&#x27;).each(function() &#123;<br>        if ($(this).width() &gt; $(this).parent().width()) &#123;<br>            $(this).wrap(&#x27;&lt;div class=&quot;table-overflow&quot;&gt;&lt;/div&gt;&#x27;);<br>        &#125;<br>    &#125;);<br><br><span class="hljs-addition">+    // æ³¨å†Œå¤åˆ¶æŒ‰é’®åŠŸèƒ½ï¼Œä»¿ç…§Nextä¸»é¢˜å®ç°</span><br><span class="hljs-addition">+    function registerCopyButton(target, element) &#123;</span><br><span class="hljs-addition">+        // æ·»åŠ å¤åˆ¶æŒ‰é’®</span><br><span class="hljs-addition">+        target.insertAdjacentHTML(&#x27;beforeend&#x27;, &#x27;&lt;a href=&quot;javascript:;&quot; class=&quot;copy&quot; title=&quot;Copy&quot;&gt;&lt;i class=&quot;fas fa-copy&quot;&gt;&lt;/i&gt;&lt;/a&gt;&#x27;);</span><br><span class="hljs-addition">+        const button = target.querySelector(&#x27;.copy&#x27;);</span><br><span class="hljs-addition">+        </span><br><span class="hljs-addition">+        button.addEventListener(&#x27;click&#x27;, function() &#123;</span><br><span class="hljs-addition">+            const code = element.querySelector(&#x27;.code&#x27;).innerText;</span><br><span class="hljs-addition">+            </span><br><span class="hljs-addition">+            if (navigator.clipboard) &#123;</span><br><span class="hljs-addition">+                // ä½¿ç”¨ç°ä»£çš„Clipboard API</span><br><span class="hljs-addition">+                navigator.clipboard.writeText(code).then(function() &#123;</span><br><span class="hljs-addition">+                    button.querySelector(&#x27;i&#x27;).className = &#x27;fas fa-check-circle&#x27;;</span><br><span class="hljs-addition">+                &#125;, function() &#123;</span><br><span class="hljs-addition">+                    button.querySelector(&#x27;i&#x27;).className = &#x27;fas fa-times-circle&#x27;;</span><br><span class="hljs-addition">+                &#125;);</span><br><span class="hljs-addition">+            &#125; else &#123;</span><br><span class="hljs-addition">+                // å…¼å®¹æ€§å›é€€æ–¹æ¡ˆ</span><br><span class="hljs-addition">+                const ta = document.createElement(&#x27;textarea&#x27;);</span><br><span class="hljs-addition">+                ta.style.top = window.scrollY + &#x27;px&#x27;;</span><br><span class="hljs-addition">+                ta.style.position = &#x27;absolute&#x27;;</span><br><span class="hljs-addition">+                ta.style.opacity = &#x27;0&#x27;;</span><br><span class="hljs-addition">+                ta.readOnly = true;</span><br><span class="hljs-addition">+                ta.value = code;</span><br><span class="hljs-addition">+                document.body.append(ta);</span><br><span class="hljs-addition">+                ta.select();</span><br><span class="hljs-addition">+                ta.setSelectionRange(0, code.length);</span><br><span class="hljs-addition">+                ta.readOnly = false;</span><br><span class="hljs-addition">+                const result = document.execCommand(&#x27;copy&#x27;);</span><br><span class="hljs-addition">+                button.querySelector(&#x27;i&#x27;).className = result ? &#x27;fas fa-check-circle&#x27; : &#x27;fas fa-times-circle&#x27;;</span><br><span class="hljs-addition">+                ta.blur();</span><br><span class="hljs-addition">+                button.blur();</span><br><span class="hljs-addition">+                document.body.removeChild(ta);</span><br><span class="hljs-addition">+            &#125;</span><br><span class="hljs-addition">+        &#125;);</span><br><span class="hljs-addition">+        </span><br><span class="hljs-addition">+        // é¼ æ ‡ç¦»å¼€300msåæ¢å¤å¤åˆ¶å›¾æ ‡</span><br><span class="hljs-addition">+        element.addEventListener(&#x27;mouseleave&#x27;, function() &#123;</span><br><span class="hljs-addition">+            setTimeout(function() &#123;</span><br><span class="hljs-addition">+                const icon = button.querySelector(&#x27;i&#x27;);</span><br><span class="hljs-addition">+                if (icon) &#123;</span><br><span class="hljs-addition">+                    icon.className = &#x27;fas fa-copy&#x27;;</span><br><span class="hljs-addition">+                &#125;</span><br><span class="hljs-addition">+            &#125;, 300);</span><br><span class="hljs-addition">+        &#125;);</span><br><span class="hljs-addition">+    &#125;</span><br><br>    function adjustNavbar() &#123;<br>        const navbarWidth = $(&#x27;.navbar-main .navbar-start&#x27;).outerWidth() + $(&#x27;.navbar-main .navbar-end&#x27;).outerWidth();<br>        if ($(document).outerWidth() &lt; navbarWidth) &#123;<br>            $(&#x27;.navbar-main .navbar-menu&#x27;).addClass(&#x27;justify-content-start&#x27;);<br>        &#125; else &#123;<br>            $(&#x27;.navbar-main .navbar-menu&#x27;).removeClass(&#x27;justify-content-start&#x27;);<br>        &#125;<br>    &#125;<br></code></pre></td></tr></table></figure><p>hexo-theme-icarus&#x2F;layout&#x2F;common&#x2F;scripts.jsx</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs diff">           return &lt;Fragment&gt;<br>            &lt;script src=&#123;cdn(&#x27;jquery&#x27;, &#x27;3.3.1&#x27;, &#x27;dist/jquery.min.js&#x27;)&#125;&gt;&lt;/script&gt;<br>            &lt;script src=&#123;cdn(&#x27;moment&#x27;, &#x27;2.22.2&#x27;, &#x27;min/moment-with-locales.min.js&#x27;)&#125;&gt;&lt;/script&gt;<br>            &lt;script dangerouslySetInnerHTML=&#123;&#123; __html: `moment.locale(&quot;$&#123;language&#125;&quot;);` &#125;&#125;&gt;&lt;/script&gt;<br>            &lt;script dangerouslySetInnerHTML=&#123;&#123; __html: embeddedConfig &#125;&#125;&gt;&lt;/script&gt;<br>            &lt;script data-pjax src=&#123;url_for(&#x27;/js/column.js&#x27;)&#125;&gt;&lt;/script&gt;<br>            &lt;Plugins site=&#123;site&#125; config=&#123;config&#125; page=&#123;page&#125; helper=&#123;helper&#125; head=&#123;false&#125; /&gt;<br><span class="hljs-deletion">-           &#123;clipboard &amp;&amp; &lt;script src=&#123;cdn(&#x27;clipboard&#x27;, &#x27;2.0.4&#x27;, &#x27;dist/clipboard.min.js&#x27;)&#125; defer&gt;&lt;/script&gt;&#125;</span><br>            &lt;script data-pjax src=&#123;url_for(&#x27;/js/main.js&#x27;)&#125; defer&gt;&lt;/script&gt;<br>        &lt;/Fragment&gt;;<br></code></pre></td></tr></table></figure></li></ul><h2 id="ä½¿ç”¨firebaseç»Ÿè®¡é˜…è¯»äººæ•°"><a href="#ä½¿ç”¨firebaseç»Ÿè®¡é˜…è¯»äººæ•°" class="headerlink" title="ä½¿ç”¨firebaseç»Ÿè®¡é˜…è¯»äººæ•°"></a>ä½¿ç”¨firebaseç»Ÿè®¡é˜…è¯»äººæ•°</h2><h3 id="configæ–‡ä»¶æ·»åŠ é…ç½®"><a href="#configæ–‡ä»¶æ·»åŠ é…ç½®" class="headerlink" title="configæ–‡ä»¶æ·»åŠ é…ç½®"></a>configæ–‡ä»¶æ·»åŠ é…ç½®</h3><p>_config.icarus.yml</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs diff"><span class="hljs-addition">+# Firebase Firestore é˜…è¯»äººæ•°ç»Ÿè®¡</span><br><span class="hljs-addition">+services:</span><br><span class="hljs-addition">+    firebase:</span><br><span class="hljs-addition">+        enable: true</span><br><span class="hljs-addition">+        collection: articles # Firestoreæ•°æ®åº“ä¸­çš„é›†åˆåç§°</span><br><span class="hljs-addition">+        apiKey:  # ä½ çš„Firebase API Key</span><br><span class="hljs-addition">+        projectId:  # ä½ çš„Firebaseé¡¹ç›®ID</span><br></code></pre></td></tr></table></figure><h3 id="æ–‡ç« headå¢åŠ äººæ•°ç»Ÿè®¡"><a href="#æ–‡ç« headå¢åŠ äººæ•°ç»Ÿè®¡" class="headerlink" title="æ–‡ç« headå¢åŠ äººæ•°ç»Ÿè®¡"></a>æ–‡ç« headå¢åŠ äººæ•°ç»Ÿè®¡</h3><p>hexo-theme-icarus&#x2F;layout&#x2F;common&#x2F;articles.jsx</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs diff">                            &#123;/* Visitor counter */&#125;                            <br>                            &#123;!index &amp;&amp; plugins &amp;&amp; plugins.busuanzi <span class="hljs-comment">=== true ? &lt;span class=&quot;level-item&quot; id=&quot;busuanzi_container_page_pv&quot; dangerouslySetInnerHTML=&#123;&#123;</span><br>                                __html: _p(&#x27;plugin.visit_count&#x27;, &#x27;&lt;span id=&quot;busuanzi_value_page_pv&quot;&gt;0&lt;/span&gt;&#x27;)<br>                            &#125;&#125;&gt;&lt;/span&gt; : null&#125;<br><span class="hljs-addition">+                           &#123;/* Firebase Visitor counter */&#125;</span><br><span class="hljs-addition">+                           &#123;config.services &amp;&amp; config.services.firebase &amp;&amp; config.services.firebase.enable ? &lt;span class=&quot;level-item&quot;&gt;</span><br><span class="hljs-addition">+                               &lt;i class=&quot;far fa-eye mr-1&quot;&gt;&lt;/i&gt;</span><br><span class="hljs-addition">+                               &lt;span class=&quot;firestore-visitors-count&quot;&gt;0&lt;/span&gt;</span><br><span class="hljs-addition">+                           &lt;/span&gt; : null&#125;</span><br></code></pre></td></tr></table></figure><h3 id="åŸºäºfirebaseçš„ç»Ÿè®¡åŠŸèƒ½å®ç°"><a href="#åŸºäºfirebaseçš„ç»Ÿè®¡åŠŸèƒ½å®ç°" class="headerlink" title="åŸºäºfirebaseçš„ç»Ÿè®¡åŠŸèƒ½å®ç°"></a>åŸºäºfirebaseçš„ç»Ÿè®¡åŠŸèƒ½å®ç°</h3><p>source&#x2F;js&#x2F;firebase_counter.jsï¼ˆæ–°å»ºï¼‰</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br></pre></td><td class="code"><pre><code class="hljs diff"><span class="hljs-addition">+/* global IcarusThemeSettings, firebase */</span><br><span class="hljs-addition">+</span><br><span class="hljs-addition">+// Firebase Counter - é˜…è¯»é‡ç»Ÿè®¡åŠŸèƒ½</span><br><span class="hljs-addition">+</span><br><span class="hljs-addition">+if (IcarusThemeSettings &amp;&amp; IcarusThemeSettings.services &amp;&amp; IcarusThemeSettings.services.firebase &amp;&amp; IcarusThemeSettings.services.firebase.enable) &#123;</span><br><span class="hljs-addition">+    </span><br><span class="hljs-addition">+    // åˆå§‹åŒ–Firebase</span><br><span class="hljs-addition">+    try &#123;</span><br><span class="hljs-addition">+        // ç¡®ä¿firebaseå¯¹è±¡å­˜åœ¨</span><br><span class="hljs-addition">+        if (typeof firebase === &#x27;undefined&#x27;) &#123;</span><br><span class="hljs-addition">+            console.error(&#x27;Firebase library not loaded&#x27;);</span><br><span class="hljs-addition">+            // å¦‚æœFirebaseåº“æœªåŠ è½½ï¼Œéšè—è®¡æ•°å™¨å…ƒç´ </span><br><span class="hljs-addition">+            document.querySelectorAll(&#x27;.firestore-visitors-count&#x27;).forEach(el =&gt; &#123;</span><br><span class="hljs-addition">+                el.style.display = &#x27;none&#x27;;</span><br><span class="hljs-addition">+            &#125;);</span><br><span class="hljs-addition">+        &#125; else &#123;</span><br><span class="hljs-addition">+            </span><br><span class="hljs-addition">+            firebase.initializeApp(&#123;</span><br><span class="hljs-addition">+                apiKey: IcarusThemeSettings.services.firebase.apiKey,</span><br><span class="hljs-addition">+                projectId: IcarusThemeSettings.services.firebase.projectId</span><br><span class="hljs-addition">+            &#125;);</span><br><span class="hljs-addition">+            </span><br><span class="hljs-addition">+            // å¼€å‘ç¯å¢ƒæ£€æµ‹</span><br><span class="hljs-addition">+            const isLocalhost = [&#x27;localhost&#x27;, &#x27;127.0.0.1&#x27;].includes(window.location.hostname);</span><br><span class="hljs-addition">+            const isDevelopment = isLocalhost || window.location.hostname.includes(&#x27;192.168.&#x27;);</span><br><span class="hljs-addition">+            </span><br><span class="hljs-addition">+            // ç§»é™¤æ‰€æœ‰è°ƒè¯•æ—¥å¿—è¾“å‡º</span><br><span class="hljs-addition">+            </span><br><span class="hljs-addition">+            // è·å–æ•°æ®åº“å¼•ç”¨</span><br><span class="hljs-addition">+            const db = firebase.firestore();</span><br><span class="hljs-addition">+            const articlesCollection = IcarusThemeSettings.services.firebase.collection || &#x27;articles&#x27;;</span><br><span class="hljs-addition">+            const articles = db.collection(articlesCollection);</span><br><span class="hljs-addition">+            </span><br><span class="hljs-addition">+            // è·å–é˜…è¯»æ¬¡æ•°å‡½æ•°</span><br><span class="hljs-addition">+            const getCount = (doc, increaseCount) =&gt; &#123;</span><br><span class="hljs-addition">+                // è·å–æ–‡æ¡£æ•°æ®</span><br><span class="hljs-addition">+                return doc.get().then(d =&gt; &#123;</span><br><span class="hljs-addition">+                    // åˆå§‹åŒ–è®¡æ•°</span><br><span class="hljs-addition">+                    let count = d.exists ? d.data().count : 0;</span><br><span class="hljs-addition">+                    </span><br><span class="hljs-addition">+                    // å¦‚æœéœ€è¦å¢åŠ è®¡æ•°ï¼ˆåªåœ¨æ–‡ç« é¡µé¢ä¸”æœªåœ¨åŒä¸€ä¼šè¯è®¿é—®è¿‡ï¼‰</span><br><span class="hljs-addition">+                    if (increaseCount) &#123;</span><br><span class="hljs-addition">+                        // å¢åŠ è®¡æ•°</span><br><span class="hljs-addition">+                        count++;</span><br><span class="hljs-addition">+                        return doc.set(&#123; count &#125;).then(() =&gt; &#123;</span><br><span class="hljs-addition">+                            if (isDevelopment) console.log(&#x27;è®¡æ•°å·²æ›´æ–°:&#x27;, count);</span><br><span class="hljs-addition">+                            return count;</span><br><span class="hljs-addition">+                        &#125;).catch(error =&gt; &#123;</span><br><span class="hljs-addition">+                            console.error(&#x27;Error updating count:&#x27;, error);</span><br><span class="hljs-addition">+                            return count; // è¿”å›å¢åŠ å‰çš„è®¡æ•°</span><br><span class="hljs-addition">+                        &#125;);</span><br><span class="hljs-addition">+                    &#125;</span><br><span class="hljs-addition">+                    </span><br><span class="hljs-addition">+                    return count;</span><br><span class="hljs-addition">+                &#125;).catch(error =&gt; &#123;</span><br><span class="hljs-addition">+                    console.error(&#x27;Error getting count:&#x27;, error);</span><br><span class="hljs-addition">+                    // å‡ºé”™æ—¶è¿”å›é»˜è®¤å€¼0</span><br><span class="hljs-addition">+                    return 0;</span><br><span class="hljs-addition">+                &#125;);</span><br><span class="hljs-addition">+            &#125;;</span><br><span class="hljs-addition">+</span><br><span class="hljs-addition">+            // å¤„ç†é˜…è¯»è®¡æ•°çš„å‡½æ•°</span><br><span class="hljs-addition">+            const handleViewCount = () =&gt; &#123;</span><br><span class="hljs-addition">+                // è·å–å½“å‰URLè·¯å¾„</span><br><span class="hljs-addition">+                const currentPath = window.location.pathname;</span><br><span class="hljs-addition">+                </span><br><span class="hljs-addition">+                // å¢å¼ºé¦–é¡µè¯†åˆ«ï¼šä½¿ç”¨å¤šä¸ªå¯èƒ½çš„é€‰æ‹©å™¨</span><br><span class="hljs-addition">+                const isIndexPage = document.querySelector(&#x27;.article-list&#x27;) !== null ||</span><br><span class="hljs-addition">+                                   document.querySelector(&#x27;.article-card-list&#x27;) !== null ||</span><br><span class="hljs-addition">+                                   document.querySelectorAll(&#x27;.article-card&#x27;).length &gt; 0 || // é™ä½é˜ˆå€¼ä»¥é€‚åº”é¦–é¡µ</span><br><span class="hljs-addition">+                                   (currentPath === &#x27;/&#x27; &amp;&amp; document.querySelector(&#x27;article.article&#x27;) !== null); // ç‰¹æ®Šå¤„ç†ï¼šæ ¹è·¯å¾„+article.articleå…ƒç´ </span><br><span class="hljs-addition">+                </span><br><span class="hljs-addition">+                // å¢å¼ºæ–‡ç« é¡µé¢è¯†åˆ«ï¼šä½¿ç”¨æ›´ç²¾ç¡®çš„é€‰æ‹©å™¨ç»„åˆ</span><br><span class="hljs-addition">+                // é‡è¦ï¼šé¦–é¡µä¼˜å…ˆåˆ¤æ–­ï¼Œä¸”æ–‡ç« é¡µåˆ¤æ–­è¦æ’é™¤é¦–é¡µçš„æƒ…å†µï¼Œå¹¶å¢åŠ ç‰¹å®šçš„æ–‡ç« é¡µç‰¹å¾</span><br><span class="hljs-addition">+                const isArticlePage = !isIndexPage &amp;&amp; (</span><br><span class="hljs-addition">+                    // ä¼ ç»Ÿæ–‡ç« é¡µé€‰æ‹©å™¨</span><br><span class="hljs-addition">+                    (document.querySelector(&#x27;.article-container&#x27;) !== null &amp;&amp; document.querySelector(&#x27;.article-content&#x27;) !== null) ||</span><br><span class="hljs-addition">+                    (document.querySelector(&#x27;article.post&#x27;) !== null &amp;&amp; document.querySelector(&#x27;.article-content&#x27;) !== null) ||</span><br><span class="hljs-addition">+                    document.querySelector(&#x27;[id=&quot;post-content&quot;]&#x27;) !== null ||</span><br><span class="hljs-addition">+                    // é’ˆå¯¹hexo sç¯å¢ƒçš„å¢å¼ºé€‰æ‹©å™¨ï¼Œä½†éœ€è¦ç¡®ä¿ä¸æ˜¯é¦–é¡µ</span><br><span class="hljs-addition">+                    (document.querySelector(&#x27;article.article&#x27;) !== null &amp;&amp; </span><br><span class="hljs-addition">+                     document.querySelector(&#x27;article.card-content.article&#x27;) !== null &amp;&amp;</span><br><span class="hljs-addition">+                     document.querySelectorAll(&#x27;.article-card&#x27;).length === 0 &amp;&amp;</span><br><span class="hljs-addition">+                     currentPath !== &#x27;/&#x27;)</span><br><span class="hljs-addition">+                );</span><br><span class="hljs-addition">+                                    </span><br><span class="hljs-addition">+                // é¡µé¢ç±»å‹ä¿¡æ¯ - ä»…åœ¨å¼€å‘ç¯å¢ƒæ˜¾ç¤º</span><br><span class="hljs-addition">+                if (isDevelopment) &#123;</span><br><span class="hljs-addition">+                    console.log(`[Firebase] å½“å‰é¡µé¢ç±»å‹: $&#123;isArticlePage ? &#x27;æ–‡ç« é¡µ&#x27; : isIndexPage ? &#x27;é¦–é¡µ&#x27; : &#x27;å…¶ä»–é¡µé¢&#x27;&#125;`);</span><br><span class="hljs-addition">+                &#125;</span><br><span class="hljs-addition">+</span><br><span class="hljs-addition">+                if (isArticlePage) &#123;</span><br><span class="hljs-addition">+                    // æ–‡ç« é¡µé¢å¤„ç†</span><br><span class="hljs-addition">+                    const titleElement = document.querySelector(&#x27;.title.is-3, .title.is-4-mobile&#x27;);</span><br><span class="hljs-addition">+                    const countElement = document.querySelector(&#x27;.firestore-visitors-count&#x27;);</span><br><span class="hljs-addition">+                    </span><br><span class="hljs-addition">+                    if (titleElement &amp;&amp; countElement) &#123;</span><br><span class="hljs-addition">+                        const title = titleElement.textContent.trim();</span><br><span class="hljs-addition">+                        const doc = articles.doc(title);</span><br><span class="hljs-addition">+                        </span><br><span class="hljs-addition">+                        // ç¡®å®šæ˜¯å¦å¢åŠ è®¡æ•°ï¼šä¸åœ¨æœ¬åœ°å¼€å‘ç¯å¢ƒä¸”åŒä¸€ä¼šè¯æœªè®¿é—®è¿‡</span><br><span class="hljs-addition">+                        let increaseCount = !isDevelopment;</span><br><span class="hljs-addition">+                        </span><br><span class="hljs-addition">+                        if (sessionStorage.getItem(title)) &#123;</span><br><span class="hljs-addition">+                            increaseCount = false;</span><br><span class="hljs-addition">+                        &#125; else &#123;</span><br><span class="hljs-addition">+                            // æ ‡è®°ä¸ºåœ¨å½“å‰ä¼šè¯ä¸­å·²è®¿é—®</span><br><span class="hljs-addition">+                            sessionStorage.setItem(title, true);</span><br><span class="hljs-addition">+                        &#125;</span><br><span class="hljs-addition">+                        </span><br><span class="hljs-addition">+                        getCount(doc, increaseCount).then(count =&gt; &#123;</span><br><span class="hljs-addition">+                            countElement.innerText = count;</span><br><span class="hljs-addition">+                        &#125;).catch(e =&gt; &#123;</span><br><span class="hljs-addition">+                            // ç§»é™¤é”™è¯¯æ—¥å¿—</span><br><span class="hljs-addition">+                        &#125;);</span><br><span class="hljs-addition">+                    &#125; else &#123;</span><br><span class="hljs-addition">+                        // é™é»˜å¤„ç†ï¼šæœªæ‰¾åˆ°æ–‡ç« æ ‡é¢˜æˆ–è®¡æ•°å…ƒç´ </span><br><span class="hljs-addition">+                    &#125;</span><br><span class="hljs-addition">+                &#125; else if (isIndexPage) &#123;</span><br><span class="hljs-addition">+                    // é¦–é¡µæ–‡ç« åˆ—è¡¨å¤„ç†</span><br><span class="hljs-addition">+                    // ä¿®æ”¹é€‰æ‹©å™¨ä»¥åŒ¹é…å®é™…HTMLç»“æ„</span><br><span class="hljs-addition">+                    // é¦–é¡µæ–‡ç« ç»“æ„: .card &gt; .card-content.article &gt; .title.is-3.is-size-4-mobile</span><br><span class="hljs-addition">+                    const titleElements = document.querySelectorAll(</span><br><span class="hljs-addition">+                        &#x27;.card .article .title.is-3, .card .article .title.is-4-mobile, &#x27; +</span><br><span class="hljs-addition">+                        &#x27;.card article .title.is-3, .card article .title.is-4-mobile, &#x27; +</span><br><span class="hljs-addition">+                        &#x27;.card .article p.title, .card article p.title&#x27;</span><br><span class="hljs-addition">+                    );</span><br><span class="hljs-addition">+                    const countElements = document.querySelectorAll(&#x27;.card .article .firestore-visitors-count, .card article .firestore-visitors-count&#x27;);</span><br><span class="hljs-addition">+                </span><br><span class="hljs-addition">+                // ç§»é™¤é¦–é¡µå…ƒç´ æ£€æµ‹æ—¥å¿—</span><br><span class="hljs-addition">+                </span><br><span class="hljs-addition">+                if (titleElements.length &gt; 0 &amp;&amp; countElements.length &gt; 0) &#123;</span><br><span class="hljs-addition">+                    const promises = [...titleElements].map(element =&gt; &#123;</span><br><span class="hljs-addition">+                            const title = element.textContent.trim();</span><br><span class="hljs-addition">+                            const doc = articles.doc(title);</span><br><span class="hljs-addition">+                            // é¦–é¡µåªè·å–è®¡æ•°ï¼Œä¸å¢åŠ è®¡æ•°</span><br><span class="hljs-addition">+                            return getCount(doc, false).then(count =&gt; &#123;</span><br><span class="hljs-addition">+                                return count;</span><br><span class="hljs-addition">+                            &#125;);</span><br><span class="hljs-addition">+                        &#125;);</span><br><span class="hljs-addition">+                    </span><br><span class="hljs-addition">+                    Promise.all(promises).then(counts =&gt; &#123;</span><br><span class="hljs-addition">+                            counts.forEach((val, idx) =&gt; &#123;</span><br><span class="hljs-addition">+                                if (countElements[idx]) &#123;</span><br><span class="hljs-addition">+                                    countElements[idx].innerText = val;</span><br><span class="hljs-addition">+                                &#125;</span><br><span class="hljs-addition">+                            &#125;);</span><br><span class="hljs-addition">+                        &#125;).catch(e =&gt; &#123;</span><br><span class="hljs-addition">+                            // é”™è¯¯å¤„ç†ï¼šå°è¯•æ˜¾ç¤ºä¸€äº›é»˜è®¤å€¼æˆ–æ›¿ä»£æ–‡æœ¬</span><br><span class="hljs-addition">+                            countElements.forEach(el =&gt; &#123;</span><br><span class="hljs-addition">+                                if (el.innerText === &#x27;0&#x27;) &#123;</span><br><span class="hljs-addition">+                                    el.innerText = &#x27;åŠ è½½ä¸­...&#x27;;</span><br><span class="hljs-addition">+                                &#125;</span><br><span class="hljs-addition">+                            &#125;);</span><br><span class="hljs-addition">+                        &#125;);</span><br><span class="hljs-addition">+                &#125; else &#123;</span><br><span class="hljs-addition">+                    // å°è¯•ä½¿ç”¨æ›´é€šç”¨çš„é€‰æ‹©å™¨</span><br><span class="hljs-addition">+                    const fallbackTitleElements = document.querySelectorAll(&#x27;.article-card a[href^=&quot;/&quot;]&#x27;);</span><br><span class="hljs-addition">+                    const fallbackCountElements = document.querySelectorAll(&#x27;.article-card .firestore-visitors-count&#x27;);</span><br><span class="hljs-addition">+                    </span><br><span class="hljs-addition">+                    if (fallbackTitleElements.length &gt; 0 &amp;&amp; fallbackCountElements.length &gt; 0) &#123;</span><br><span class="hljs-addition">+                        // è¿™é‡Œå¯ä»¥æ·»åŠ å¤‡é€‰é€»è¾‘</span><br><span class="hljs-addition">+                    &#125;</span><br><span class="hljs-addition">+                &#125;</span><br><span class="hljs-addition">+                &#125; else &#123;</span><br><span class="hljs-addition">+                    // é™é»˜å¤„ç†ï¼šå½“å‰é¡µé¢æ—¢ä¸æ˜¯æ–‡ç« é¡µä¹Ÿä¸æ˜¯é¦–é¡µ</span><br><span class="hljs-addition">+                &#125;</span><br><span class="hljs-addition">+            &#125;;</span><br><span class="hljs-addition">++</span><br><span class="hljs-addition">+            // ç›‘å¬ä¼ ç»Ÿé¡µé¢åŠ è½½å®Œæˆäº‹ä»¶</span><br><span class="hljs-addition">+            document.addEventListener(&#x27;DOMContentLoaded&#x27;, () =&gt; &#123;</span><br><span class="hljs-addition">+                handleViewCount();</span><br><span class="hljs-addition">+            &#125;);</span><br><span class="hljs-addition">+            </span><br><span class="hljs-addition">+            // ç›‘å¬PJAXé¡µé¢åŠ è½½å®Œæˆäº‹ä»¶ï¼ˆé€‚é…Icarusä¸»é¢˜çš„PJAXæœºåˆ¶ï¼‰</span><br><span class="hljs-addition">+            document.addEventListener(&#x27;page:loaded&#x27;, () =&gt; &#123;</span><br><span class="hljs-addition">+                handleViewCount();</span><br><span class="hljs-addition">+            &#125;);</span><br><span class="hljs-addition">+        &#125;</span><br><span class="hljs-addition">+    &#125; catch (error) &#123;</span><br><span class="hljs-addition">+        // ç§»é™¤åˆå§‹åŒ–å¤±è´¥æ—¥å¿—</span><br><span class="hljs-addition">+        // å¦‚æœåˆå§‹åŒ–å¤±è´¥ï¼Œå°è¯•éšè—è®¡æ•°å™¨å…ƒç´ ä»¥é¿å…æ˜¾ç¤ºä¸º0</span><br><span class="hljs-addition">+        document.querySelectorAll(&#x27;.firestore-visitors-count&#x27;).forEach(el =&gt; &#123;</span><br><span class="hljs-addition">+            el.style.display = &#x27;none&#x27;;</span><br><span class="hljs-addition">+        &#125;);</span><br><span class="hljs-addition">+    &#125;</span><br><span class="hljs-addition">+&#125;</span><br></code></pre></td></tr></table></figure><h3 id="å…¶ä»–ä¸€äº›ä¼˜åŒ–"><a href="#å…¶ä»–ä¸€äº›ä¼˜åŒ–" class="headerlink" title="å…¶ä»–ä¸€äº›ä¼˜åŒ–"></a>å…¶ä»–ä¸€äº›ä¼˜åŒ–</h3><p>hexo-theme-icarus&#x2F;layout&#x2F;common&#x2F;scripts.jsx</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs diff">const &#123; Component, Fragment &#125; = require(&#x27;inferno&#x27;);<br>const &#123; toMomentLocale &#125; = require(&#x27;hexo/dist/plugins/helper/date&#x27;);<br>const Plugins = require(&#x27;./plugins&#x27;);<br><br>module.exports = class extends Component &#123;<br>    render() &#123;<br>        const &#123; site, config, helper, page &#125; = this.props;<br>        const &#123; url_for, cdn &#125; = helper;<br>        const &#123; article &#125; = config;<br>        const language = toMomentLocale(page.lang || page.language || config.language || &#x27;en&#x27;);<br><br>        let fold = &#x27;unfolded&#x27;;<br>        let clipboard = true;<br>        if (article &amp;&amp; article.highlight) &#123;<br>            if (typeof article.highlight.clipboard !== &#x27;undefined&#x27;) &#123;<br>                clipboard = !!article.highlight.clipboard;<br>            &#125;<br>            if (typeof article.highlight.fold <span class="hljs-comment">=== &#x27;string&#x27;) &#123;</span><br>                fold = article.highlight.fold;<br>            &#125;<br>        &#125;<br><br>        const embeddedConfig = `var IcarusThemeSettings = &#123;<br>            article: &#123;<br>                highlight: &#123;<br>                    clipboard: $&#123;clipboard&#125;,<br>                    fold: &#x27;$&#123;fold&#125;&#x27;<br>                &#125;<br><span class="hljs-addition">+           &#125;,</span><br><span class="hljs-addition">+           services: &#123;</span><br><span class="hljs-addition">+               firebase: $&#123;config.services &amp;&amp; config.services.firebase ? JSON.stringify(config.services.firebase) : &#x27;false&#x27;&#125;</span><br>            &#125;<br>        &#125;;`;<br><br>        return &lt;Fragment&gt;<br>            &lt;script src=&#123;cdn(&#x27;jquery&#x27;, &#x27;3.3.1&#x27;, &#x27;dist/jquery.min.js&#x27;)&#125;&gt;&lt;/script&gt;<br>            &lt;script src=&#123;cdn(&#x27;moment&#x27;, &#x27;2.22.2&#x27;, &#x27;min/moment-with-locales.min.js&#x27;)&#125;&gt;&lt;/script&gt;<br>            &lt;script dangerouslySetInnerHTML=&#123;&#123; __html: `moment.locale(&quot;$&#123;language&#125;&quot;);` &#125;&#125;&gt;&lt;/script&gt;<br>            &lt;script dangerouslySetInnerHTML=&#123;&#123; __html: embeddedConfig &#125;&#125;&gt;&lt;/script&gt;<br><span class="hljs-addition">+           &#123;/* Firebase Firestore */&#125;</span><br><span class="hljs-addition">+           &#123;config.services &amp;&amp; config.services.firebase &amp;&amp; config.services.firebase.enable ? (</span><br><span class="hljs-addition">+               &lt;Fragment&gt;</span><br><span class="hljs-addition">+                   &lt;script src=&quot;https://www.gstatic.com/firebasejs/9.6.11/firebase-app-compat.js&quot;&gt;&lt;/script&gt;</span><br><span class="hljs-addition">+                   &lt;script src=&quot;https://www.gstatic.com/firebasejs/9.6.11/firebase-firestore-compat.js&quot;&gt;&lt;/script&gt;</span><br><span class="hljs-addition">+               &lt;/Fragment&gt;</span><br><span class="hljs-addition">+           ) : null&#125;</span><br>            &lt;script data-pjax src=&#123;url_for(&#x27;/js/column.js&#x27;)&#125;&gt;&lt;/script&gt;<br>            &lt;Plugins site=&#123;site&#125; config=&#123;config&#125; page=&#123;page&#125; helper=&#123;helper&#125; head=&#123;false&#125; /&gt;<br>            &lt;script data-pjax src=&#123;url_for(&#x27;/js/main.js&#x27;)&#125; defer&gt;&lt;/script&gt;<br><span class="hljs-addition">+           &#123;/* Firebase counter script */&#125;</span><br><span class="hljs-addition">+           &#123;config.services &amp;&amp; config.services.firebase &amp;&amp; config.services.firebase.enable ? (</span><br><span class="hljs-addition">+               &lt;script data-pjax src=&#123;url_for(&#x27;/js/firebase_counter.js&#x27;)&#125; defer&gt;&lt;/script&gt;</span><br><span class="hljs-addition">+           ) : null&#125;</span><br>        &lt;/Fragment&gt;;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">é‡æ„icarusä¸»é¢˜å¤åˆ¶åŠŸèƒ½ï¼ˆä»¿ç…§nextä¸»é¢˜ï¼‰ã€icarusä¸»é¢˜ä½¿ç”¨firebaseç»Ÿè®¡é˜…è¯»äººæ•°</summary>
    
    
    
    <category term="æ‚è®°" scheme="https://sydzi.github.io/categories/%E6%9D%82%E8%AE%B0/"/>
    
    
    <category term="blog" scheme="https://sydzi.github.io/tags/blog/"/>
    
    <category term="æ‚è®°" scheme="https://sydzi.github.io/tags/%E6%9D%82%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>Day16:Z3æ±‚è§£å™¨</title>
    <link href="https://sydzi.github.io/2025/08/21/Day16-Z3/"/>
    <id>https://sydzi.github.io/2025/08/21/Day16-Z3/</id>
    <published>2025-08-21T04:04:22.000Z</published>
    <updated>2025-09-18T03:57:34.068Z</updated>
    
    <content type="html"><![CDATA[<p>z3æ±‚è§£å™¨</p><span id="more"></span><h2 id="åŸºæœ¬æ•°æ®ç±»å‹"><a href="#åŸºæœ¬æ•°æ®ç±»å‹" class="headerlink" title="åŸºæœ¬æ•°æ®ç±»å‹"></a>åŸºæœ¬æ•°æ®ç±»å‹</h2><ul><li>Intï¼šæ•´æ•°</li><li>BitVecï¼šäºŒè¿›åˆ¶æ•°æ®ï¼ˆå¦‚BitVec(â€˜aâ€™,8)ï¼š8ä¸ªæ¯”ç‰¹ä½çš„ä¸€ä¸ªå˜é‡aï¼‰</li><li>Realï¼šæœ‰ç†æ•°</li><li>Boolï¼šå¸ƒå°”å€¼</li><li>Arrayï¼šæ•°ç»„</li></ul><h2 id="åŸºæœ¬æµç¨‹"><a href="#åŸºæœ¬æµç¨‹" class="headerlink" title="åŸºæœ¬æµç¨‹"></a>åŸºæœ¬æµç¨‹</h2><h3 id="è®¾å˜é‡"><a href="#è®¾å˜é‡" class="headerlink" title="è®¾å˜é‡"></a>è®¾å˜é‡</h3><ul><li>ä½¿ç”¨åŸºæœ¬æ•°æ®ç±»å‹æ¥å£°æ˜å˜é‡ï¼Œå¦‚ï¼šx&#x3D;Int(â€˜xâ€™)</li></ul><h3 id="åˆ›å»ºæ±‚è§£å™¨"><a href="#åˆ›å»ºæ±‚è§£å™¨" class="headerlink" title="åˆ›å»ºæ±‚è§£å™¨"></a>åˆ›å»ºæ±‚è§£å™¨</h3><ul><li>ä½¿ç”¨å‡½æ•°Solve()åˆ›å»ºä¸€ä¸ªæ±‚è§£å™¨ï¼šs&#x3D;Solver()</li></ul><h3 id="æ·»åŠ çº¦æŸæ¡ä»¶"><a href="#æ·»åŠ çº¦æŸæ¡ä»¶" class="headerlink" title="æ·»åŠ çº¦æŸæ¡ä»¶"></a>æ·»åŠ çº¦æŸæ¡ä»¶</h3><ul><li>ä½¿ç”¨å‡½æ•°add()æ·»åŠ çº¦æŸæ¡ä»¶ï¼šs.add(ä¸€ä¸ªæ–¹ç¨‹&#x2F;ä¸ç­‰å¼)</li></ul><h3 id="åˆ¤æ–­æ˜¯å¦æœ‰è§£"><a href="#åˆ¤æ–­æ˜¯å¦æœ‰è§£" class="headerlink" title="åˆ¤æ–­æ˜¯å¦æœ‰è§£"></a>åˆ¤æ–­æ˜¯å¦æœ‰è§£</h3><ul><li>ä½¿ç”¨å‡½æ•°check()æ£€æŸ¥æ˜¯å¦æœ‰è§£ï¼Œæœ‰è§£è¿”å›â€™satâ€™ï¼Œæ— è§£è¿”å›â€™unsatâ€™</li></ul><h3 id="å–è§£çš„äº¤é›†"><a href="#å–è§£çš„äº¤é›†" class="headerlink" title="å–è§£çš„äº¤é›†"></a>å–è§£çš„äº¤é›†</h3><ul><li>ä½¿ç”¨å‡½æ•°model()å–æ»¡è¶³æ¯ä¸ªæ¡ä»¶çš„è§£çš„äº¤é›†ï¼Œè¿”å›çš„æ˜¯å­—å…¸ï¼Œç”¨model[å˜é‡å]å¯ä»¥å¾—åˆ°å˜é‡çš„è§£</li></ul><h3 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h3><p>è§£æ–¹ç¨‹{x,y|30x+15y&#x3D;675,12x+5y&#x3D;265}</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> z3 <span class="hljs-keyword">import</span> *<br><br>x=Int(<span class="hljs-string">&#x27;x&#x27;</span>)<br>y=Int(<span class="hljs-string">&#x27;y&#x27;</span>)<br><br>s=Solver()<br>s.add(<span class="hljs-number">30</span>*x+<span class="hljs-number">15</span>*y==<span class="hljs-number">675</span>)<br>s.add(<span class="hljs-number">12</span>*x+<span class="hljs-number">5</span>*y==<span class="hljs-number">265</span>)<br><span class="hljs-keyword">if</span> s.check()==sat:<br>    <span class="hljs-built_in">print</span>(s.model())<br><span class="hljs-comment">#å¾—åˆ°è§£[x = 20, y = 5]</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">z3æ±‚è§£å™¨</summary>
    
    
    
    <category term="Reverse Engineering" scheme="https://sydzi.github.io/categories/Reverse-Engineering/"/>
    
    
    <category term="CTF" scheme="https://sydzi.github.io/tags/CTF/"/>
    
    <category term="Reverse" scheme="https://sydzi.github.io/tags/Reverse/"/>
    
  </entry>
  
  <entry>
    <title>Day15:æŒ‡ä»¤è™šæ‹ŸåŒ–</title>
    <link href="https://sydzi.github.io/2025/08/06/Day15-%E6%8C%87%E4%BB%A4%E8%99%9A%E6%8B%9F%E5%8C%96/"/>
    <id>https://sydzi.github.io/2025/08/06/Day15-%E6%8C%87%E4%BB%A4%E8%99%9A%E6%8B%9F%E5%8C%96/</id>
    <published>2025-08-06T07:41:01.000Z</published>
    <updated>2025-09-18T03:57:30.657Z</updated>
    
    <content type="html"><![CDATA[<p>æŒ‡ä»¤è™šæ‹ŸåŒ–ã€å®ç°ä¸€ä¸ªå°å‹è™šæ‹Ÿæœºç¨‹åºã€VMé€†å‘å®è·µ</p><span id="more"></span><h2 id="ä»€ä¹ˆæ˜¯æŒ‡ä»¤è™šæ‹ŸåŒ–"><a href="#ä»€ä¹ˆæ˜¯æŒ‡ä»¤è™šæ‹ŸåŒ–" class="headerlink" title="ä»€ä¹ˆæ˜¯æŒ‡ä»¤è™šæ‹ŸåŒ–"></a>ä»€ä¹ˆæ˜¯æŒ‡ä»¤è™šæ‹ŸåŒ–</h2><ul><li><p>CPUå‚å•†åœ¨å¼€å‘CPUå‰ä¼šåˆ¶å®šä¸€ä¸ªè§„èŒƒï¼Œå»ºç«‹èµ·æ•°æ®å’Œæ“ä½œçš„å¯¹åº”å…³ç³»ï¼ˆå¦‚x86-64è§„å®š0x30å¯¹åº”å¼‚æˆ–æ“ä½œï¼‰ï¼Œè€Œè¿™ä¸ªæ•°æ®åˆå¯ä»¥æ ¹æ®æ“ä½œå‘½åå‡ºæ±‡ç¼–æŒ‡ä»¤ï¼ˆå¦‚0x30å‘½åä¸ºxorï¼‰ï¼Œå› æ­¤æœ‰äº†æ•°æ®ä¸æ“ä½œçš„å¯¹åº”å…³ç³»å’Œæ±‡ç¼–æŒ‡ä»¤ä¸æ“ä½œçš„å¯¹åº”å…³ç³»ï¼Œç§°ä¹‹ä¸ºæŒ‡ä»¤é›†ã€‚CPUå¯ä»¥è§†ä½œä¸€ä¸ªè§£é‡Šå™¨ï¼Œè´Ÿè´£è¯»å–æ•°æ®æˆ–è€…æ±‡ç¼–æŒ‡ä»¤ç„¶åå¸¦åŠ¨æœºå™¨äº§ç”Ÿæ“ä½œã€‚</p></li><li><p>é€šä¿—çš„è®²ï¼ŒæŒ‡ä»¤è™šæ‹ŸåŒ–å®é™…ä¸Šå°±æ˜¯è‡ªå®šä¹‰æŒ‡ä»¤é›†å¹¶ä¸ºè‡ªå·±çš„æŒ‡ä»¤é›†æ„å»ºè§£é‡Šå™¨ï¼Œç”¨è‡ªå®šä¹‰çš„æŒ‡ä»¤å®ç°ç¨‹åºçš„è¿‡ç¨‹ã€‚è¿™ä¸ªè¿‡ç¨‹åˆ©ç”¨é«˜çº§è¯­è¨€ä»£ç å®ç°ï¼Œä¹Ÿå°±æ˜¯ç”¨è½¯ä»¶æ¥æ¨¡æ‹Ÿç¡¬ä»¶ï¼Œç±»ä¼¼äºè™šæ‹Ÿæœºï¼Œå› æ­¤ç§°ä¹‹ä¸ºæŒ‡ä»¤è™šæ‹ŸåŒ–ã€‚</p></li><li><p>å®ç°æŒ‡ä»¤è™šæ‹ŸåŒ–ï¼Œéœ€è¦å®šä¹‰å¯„å­˜å™¨å˜é‡ï¼ˆè‡³å°‘éœ€è¦ä¸€ä¸ªEIPæ¥æŒ‡å‘è¿è¡Œçš„æŒ‡ä»¤ï¼‰ã€å†…å­˜ç©ºé—´æ•°ç»„ã€è§£é‡Šå™¨å’ŒæŒ‡ä»¤æ•°ç»„ã€‚</p></li><li><p>å®ç°è‡ªå®šä¹‰æŒ‡ä»¤é›†çš„è§£é‡Šå™¨ï¼Œå¯ä»¥é‡‡ç”¨Cè¯­è¨€çš„switchï¼ˆå…¶ä¸­codeæ˜¯è‡ªå®šä¹‰æŒ‡ä»¤ï¼Œé€šè¿‡å¾ªç¯è¾“å…¥ï¼‰ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">//è§£é‡Šå™¨ï¼š1è¾“å‡º11111ï¼Œ2è¾“å‡º22222ï¼Œ3è¾“å‡º33333</span><br><span class="hljs-keyword">switch</span>(code):<br><span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;11111&quot;</span>);<br><span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<br>print(<span class="hljs-string">&quot;22222&quot;</span>);<br><span class="hljs-keyword">break</span>:<br><span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:<br>print(<span class="hljs-string">&quot;33333&quot;</span>);<br><span class="hljs-keyword">break</span>;<br></code></pre></td></tr></table></figure></li></ul><h2 id="å®ç°ä¸€ä¸ªå°å‹è™šæ‹Ÿæœºç¨‹åº"><a href="#å®ç°ä¸€ä¸ªå°å‹è™šæ‹Ÿæœºç¨‹åº" class="headerlink" title="å®ç°ä¸€ä¸ªå°å‹è™šæ‹Ÿæœºç¨‹åº"></a>å®ç°ä¸€ä¸ªå°å‹è™šæ‹Ÿæœºç¨‹åº</h2><ul><li>å°è¯•ç¼–å†™ä¸€ä¸ªè¾“å…¥ä¸¤ä¸ªæ•°ï¼Œè¾“å‡ºå’Œçš„ç¨‹åº</li></ul><h3 id="å£°æ˜è™šæ‹Ÿç¡¬ä»¶ç»“æ„ä½“"><a href="#å£°æ˜è™šæ‹Ÿç¡¬ä»¶ç»“æ„ä½“" class="headerlink" title="å£°æ˜è™šæ‹Ÿç¡¬ä»¶ç»“æ„ä½“"></a>å£°æ˜è™šæ‹Ÿç¡¬ä»¶ç»“æ„ä½“</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span>&#123;</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> r1;<span class="hljs-comment">//å¯„å­˜å™¨r1</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> r2;<span class="hljs-comment">//å¯„å­˜å™¨r2</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> eip;<span class="hljs-comment">//å¯„å­˜å™¨eip</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> mem[<span class="hljs-number">256</span>];<span class="hljs-comment">//è™šæ‹Ÿå†…å­˜æ•°ç»„</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> code[<span class="hljs-number">1024</span>];<span class="hljs-comment">//æŒ‡ä»¤æ•°ç»„</span><br>&#125; VM;<br></code></pre></td></tr></table></figure><h3 id="å®šä¹‰æŒ‡ä»¤é›†"><a href="#å®šä¹‰æŒ‡ä»¤é›†" class="headerlink" title="å®šä¹‰æŒ‡ä»¤é›†"></a>å®šä¹‰æŒ‡ä»¤é›†</h3><ul><li>ä½¿ç”¨op1ã€op2è¡¨ç¤ºæŒ‡ä»¤åé¢è·Ÿçš„æ“ä½œæ•°ï¼Œå¯„å­˜å™¨ä½œä¸ºéšå¼å‚æ•°ä¸ä¼šå‡ºç°åœ¨codeä¸­</li></ul><table><thead><tr><th align="center">æŒ‡ä»¤</th><th align="center">ä½¿ç”¨æ ¼å¼</th><th align="center">å¯¹åº”æ±‡ç¼–æŒ‡ä»¤&#x2F;ä¼ªä»£ç </th><th align="center">æ“ä½œè§£è¯»</th></tr></thead><tbody><tr><td align="center">0x10</td><td align="center">0x10,op1</td><td align="center">mov r1,mem[op1]</td><td align="center">r1&#x3D;mem[op1]</td></tr><tr><td align="center">0x11</td><td align="center">0x11,op1</td><td align="center">mov r2,mem[op1]</td><td align="center">r2&#x3D;mem[op1]</td></tr><tr><td align="center">0x20</td><td align="center">0x20</td><td align="center">add r1,r2</td><td align="center">r1+&#x3D;r2</td></tr><tr><td align="center">0x30</td><td align="center">0x30,op1,op2</td><td align="center">scanf-&gt;mem[op1],mem[op2]</td><td align="center">è¾“å…¥ç»™mem[op1]ï¼Œmem[op2]</td></tr><tr><td align="center">0x40</td><td align="center">0x40</td><td align="center">printf r1</td><td align="center">è¾“å‡ºr1çš„å€¼</td></tr><tr><td align="center">0x50</td><td align="center">0x50</td><td align="center">ret</td><td align="center">return 1</td></tr></tbody></table><h3 id="ç¼–å†™è§£é‡Šå™¨"><a href="#ç¼–å†™è§£é‡Šå™¨" class="headerlink" title="ç¼–å†™è§£é‡Šå™¨"></a>ç¼–å†™è§£é‡Šå™¨</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">vm_run</span><span class="hljs-params">(VM* vm)</span> &#123;<br>    <span class="hljs-type">char</span> opcode;<span class="hljs-comment">//ç”¨æ¥å­˜æ”¾æŒ‡ä»¤</span><br>    <span class="hljs-type">char</span> op1, op2;<span class="hljs-comment">//ç”¨æ¥å­˜æ”¾æ“ä½œæ•°</span><br><br>    <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>) &#123;<br>        opcode = vm-&gt;code[vm-&gt;eip];<span class="hljs-comment">//è¯»å–eipæŒ‡å‘çš„æŒ‡ä»¤</span><br><br>        <span class="hljs-keyword">switch</span> (opcode) &#123;<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">0x10</span>:<br>            op1 = vm-&gt;code[vm-&gt;eip + <span class="hljs-number">1</span>];<span class="hljs-comment">//è·å–æ“ä½œæ•°</span><br>            vm-&gt;r1 = vm-&gt;mem[op1];<span class="hljs-comment">//r1=mem[op1]</span><br>            vm-&gt;eip += <span class="hljs-number">2</span>;<span class="hljs-comment">//è·³è½¬åˆ°ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼ˆæŒ‡ä»¤+æ“ä½œæ•°å 2ä¸ªç´¢å¼•ä½ï¼‰</span><br>            <span class="hljs-keyword">break</span>;<br><br>        <span class="hljs-keyword">case</span> <span class="hljs-number">0x11</span>:<br>            op1 = vm-&gt;code[vm-&gt;eip + <span class="hljs-number">1</span>];<span class="hljs-comment">//è·å–æ“ä½œæ•°</span><br>            vm-&gt;r2 = vm-&gt;mem[op1];<span class="hljs-comment">//r2=mem[op1]</span><br>            vm-&gt;eip += <span class="hljs-number">2</span>;<span class="hljs-comment">//è·³è½¬åˆ°ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼ˆæŒ‡ä»¤+æ“ä½œæ•°å 2ä¸ªç´¢å¼•ä½ï¼‰</span><br>            <span class="hljs-keyword">break</span>;<br><br>        <span class="hljs-keyword">case</span> <span class="hljs-number">0x20</span>:<br>            vm-&gt;r1 += vm-&gt;r2;<span class="hljs-comment">//r1+=r2</span><br>            vm-&gt;eip += <span class="hljs-number">1</span>;<span class="hljs-comment">//è·³è½¬åˆ°ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼ˆåªæœ‰æŒ‡ä»¤ï¼Œå 1ä¸ªç´¢å¼•ä½ï¼‰</span><br>            <span class="hljs-keyword">break</span>;<br><br>        <span class="hljs-keyword">case</span> <span class="hljs-number">0x30</span>:<br>            op1 = vm-&gt;code[vm-&gt;eip + <span class="hljs-number">1</span>];<span class="hljs-comment">//è·å–æ“ä½œæ•°1</span><br>            op2 = vm-&gt;code[vm-&gt;eip + <span class="hljs-number">2</span>];<span class="hljs-comment">//è·å–æ“ä½œæ•°2</span><br>            <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d %d&quot;</span>, &amp;vm-&gt;mem[op1], &amp;vm-&gt;mem[op2]);<span class="hljs-comment">//è¾“å…¥ç»™mem[op1]ï¼Œmem[op2]</span><br>            vm-&gt;eip += <span class="hljs-number">3</span>;<span class="hljs-comment">//è·³è½¬åˆ°ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼ˆæŒ‡ä»¤+æ“ä½œæ•°å 3ä¸ªç´¢å¼•ä½ï¼‰</span><br>            <span class="hljs-keyword">break</span>;<br><br>        <span class="hljs-keyword">case</span> <span class="hljs-number">0x40</span>:<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d&quot;</span>, vm-&gt;r1);<span class="hljs-comment">//è¾“å‡ºr1çš„å€¼</span><br>            vm-&gt;eip += <span class="hljs-number">1</span>;<span class="hljs-comment">//è·³è½¬åˆ°ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼ˆåªæœ‰æŒ‡ä»¤ï¼Œå 1ä¸ªç´¢å¼•ä½ï¼‰</span><br>            <span class="hljs-keyword">break</span>;<br><br>        <span class="hljs-keyword">case</span> <span class="hljs-number">0x50</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<span class="hljs-comment">//å¾ªç¯ç»ˆæ­¢ï¼Œå‡½æ•°è¿”å›ï¼Œè™šæ‹Ÿæœºå…³æœº</span><br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="æŒ‡ä»¤æ•°ç»„"><a href="#æŒ‡ä»¤æ•°ç»„" class="headerlink" title="æŒ‡ä»¤æ•°ç»„"></a>æŒ‡ä»¤æ•°ç»„</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> code[]=&#123;<br><span class="hljs-number">0x30</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x1</span>,<span class="hljs-comment">//è¾“å…¥ç»™mem[0]ï¼Œmem[1]</span><br>    <span class="hljs-number">0x10</span>,<span class="hljs-number">0x0</span>,<span class="hljs-comment">//r1=mem[0]</span><br>    <span class="hljs-number">0x11</span>,<span class="hljs-number">0x1</span>,<span class="hljs-comment">//r2=mem[1]</span><br>    <span class="hljs-number">0x20</span>,<span class="hljs-comment">//r1+=r2</span><br>    <span class="hljs-number">0x40</span>,<span class="hljs-comment">//è¾“å‡ºr1çš„å€¼</span><br>    <span class="hljs-number">0x50</span><span class="hljs-comment">//è™šæ‹Ÿæœºå…³æœº</span><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="å®Œæ•´ç¨‹åº"><a href="#å®Œæ•´ç¨‹åº" class="headerlink" title="å®Œæ•´ç¨‹åº"></a>å®Œæ•´ç¨‹åº</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;windows.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><br><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span>&#123;</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> r1;<span class="hljs-comment">//å¯„å­˜å™¨r1</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> r2;<span class="hljs-comment">//å¯„å­˜å™¨r2</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> eip;<span class="hljs-comment">//å¯„å­˜å™¨eip</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> mem[<span class="hljs-number">256</span>];<span class="hljs-comment">//è™šæ‹Ÿå†…å­˜æ•°ç»„</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> code[<span class="hljs-number">1024</span>];<span class="hljs-comment">//æŒ‡ä»¤æ•°ç»„</span><br>&#125; VM;<br><br><span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> code[]=&#123;<br><span class="hljs-number">0x30</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x1</span>,<span class="hljs-comment">//è¾“å…¥ç»™mem[0]ï¼Œmem[1]</span><br>    <span class="hljs-number">0x10</span>,<span class="hljs-number">0x0</span>,<span class="hljs-comment">//r1=mem[0]</span><br>    <span class="hljs-number">0x11</span>,<span class="hljs-number">0x1</span>,<span class="hljs-comment">//r2=mem[1]</span><br>    <span class="hljs-number">0x20</span>,<span class="hljs-comment">//r1+=r2</span><br>    <span class="hljs-number">0x40</span>,<span class="hljs-comment">//è¾“å‡ºr1çš„å€¼</span><br>    <span class="hljs-number">0x50</span><span class="hljs-comment">//è™šæ‹Ÿæœºå…³æœº</span><br>&#125;;<br><br>VM* <span class="hljs-title function_">vm_new</span><span class="hljs-params">()</span> &#123;<br>    VM* vm = (VM*)<span class="hljs-built_in">malloc</span>(<span class="hljs-keyword">sizeof</span>(VM));<span class="hljs-comment">//ä¸ºè™šæ‹Ÿç¡¬ä»¶ç»“æ„ä½“ç”³è¯·ç©ºé—´</span><br>    <span class="hljs-built_in">memset</span>(vm, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(VM));<span class="hljs-comment">//åˆå§‹åŒ–ç»“æ„ä½“</span><br>    <span class="hljs-built_in">memcpy</span>(vm-&gt;code, code, <span class="hljs-keyword">sizeof</span>(code));<span class="hljs-comment">//åˆå§‹åŒ–code</span><br>    <span class="hljs-keyword">return</span> vm;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">vm_run</span><span class="hljs-params">(VM* vm)</span> &#123;<br>    <span class="hljs-type">char</span> opcode;<span class="hljs-comment">//ç”¨æ¥å­˜æ”¾æŒ‡ä»¤</span><br>    <span class="hljs-type">char</span> op1, op2;<span class="hljs-comment">//ç”¨æ¥å­˜æ”¾æ“ä½œæ•°</span><br><br>    <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>) &#123;<br>        opcode = vm-&gt;code[vm-&gt;eip];<span class="hljs-comment">//è¯»å–eipæŒ‡å‘çš„æŒ‡ä»¤</span><br><br>        <span class="hljs-keyword">switch</span> (opcode) &#123;<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">0x10</span>:<br>            op1 = vm-&gt;code[vm-&gt;eip + <span class="hljs-number">1</span>];<span class="hljs-comment">//è·å–æ“ä½œæ•°</span><br>            vm-&gt;r1 = vm-&gt;mem[op1];<span class="hljs-comment">//r1=mem[op1]</span><br>            vm-&gt;eip += <span class="hljs-number">2</span>;<span class="hljs-comment">//è·³è½¬åˆ°ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼ˆæŒ‡ä»¤+æ“ä½œæ•°å 2ä¸ªç´¢å¼•ä½ï¼‰</span><br>            <span class="hljs-keyword">break</span>;<br><br>        <span class="hljs-keyword">case</span> <span class="hljs-number">0x11</span>:<br>            op1 = vm-&gt;code[vm-&gt;eip + <span class="hljs-number">1</span>];<span class="hljs-comment">//è·å–æ“ä½œæ•°</span><br>            vm-&gt;r2 = vm-&gt;mem[op1];<span class="hljs-comment">//r2=mem[op1]</span><br>            vm-&gt;eip += <span class="hljs-number">2</span>;<span class="hljs-comment">//è·³è½¬åˆ°ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼ˆæŒ‡ä»¤+æ“ä½œæ•°å 2ä¸ªç´¢å¼•ä½ï¼‰</span><br>            <span class="hljs-keyword">break</span>;<br><br>        <span class="hljs-keyword">case</span> <span class="hljs-number">0x20</span>:<br>            vm-&gt;r1 += vm-&gt;r2;<span class="hljs-comment">//r1+=r2</span><br>            vm-&gt;eip += <span class="hljs-number">1</span>;<span class="hljs-comment">//è·³è½¬åˆ°ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼ˆåªæœ‰æŒ‡ä»¤ï¼Œå 1ä¸ªç´¢å¼•ä½ï¼‰</span><br>            <span class="hljs-keyword">break</span>;<br><br>        <span class="hljs-keyword">case</span> <span class="hljs-number">0x30</span>:<br>            op1 = vm-&gt;code[vm-&gt;eip + <span class="hljs-number">1</span>];<span class="hljs-comment">//è·å–æ“ä½œæ•°1</span><br>            op2 = vm-&gt;code[vm-&gt;eip + <span class="hljs-number">2</span>];<span class="hljs-comment">//è·å–æ“ä½œæ•°2</span><br>            <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d %d&quot;</span>, &amp;vm-&gt;mem[op1], &amp;vm-&gt;mem[op2]);<span class="hljs-comment">//è¾“å…¥ç»™mem[op1]ï¼Œmem[op2]</span><br>            vm-&gt;eip += <span class="hljs-number">3</span>;<span class="hljs-comment">//è·³è½¬åˆ°ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼ˆæŒ‡ä»¤+æ“ä½œæ•°å 3ä¸ªç´¢å¼•ä½ï¼‰</span><br>            <span class="hljs-keyword">break</span>;<br><br>        <span class="hljs-keyword">case</span> <span class="hljs-number">0x40</span>:<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d&quot;</span>, vm-&gt;r1);<span class="hljs-comment">//è¾“å‡ºr1çš„å€¼</span><br>            vm-&gt;eip += <span class="hljs-number">1</span>;<span class="hljs-comment">//è·³è½¬åˆ°ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼ˆåªæœ‰æŒ‡ä»¤ï¼Œå 1ä¸ªç´¢å¼•ä½ï¼‰</span><br>            <span class="hljs-keyword">break</span>;<br><br>        <span class="hljs-keyword">case</span> <span class="hljs-number">0x50</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<span class="hljs-comment">//å¾ªç¯ç»ˆæ­¢ï¼Œå‡½æ•°è¿”å›ï¼Œè™šæ‹Ÿæœºå…³æœº</span><br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    VM* vm = vm_new();<span class="hljs-comment">//ç”Ÿæˆä¸€ä¸ªè™šæ‹Ÿæœº</span><br>    <span class="hljs-keyword">if</span> (vm_run(vm))<span class="hljs-comment">//è¿è¡Œè™šæ‹Ÿæœº</span><br>        system(<span class="hljs-string">&quot;pause&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="ç®€å•ç¤ºä¾‹çš„é€†å‘"><a href="#ç®€å•ç¤ºä¾‹çš„é€†å‘" class="headerlink" title="ç®€å•ç¤ºä¾‹çš„é€†å‘"></a>ç®€å•ç¤ºä¾‹çš„é€†å‘</h2><ul><li><p>VMé¢˜æœ€æ˜¾è‘—çš„ç‰¹å¾åº”è¯¥å°±æ˜¯è™šæ‹Ÿç¡¬ä»¶ç»“æ„ä½“çš„åˆå§‹åŒ–å’Œè§£é‡Šå™¨äº†ã€‚è§£å†³è¿™ç±»é—®é¢˜ï¼Œéœ€è¦å…ˆå¤åˆ»å‡ºä¸€ä¸ªè§£é‡Šå™¨ï¼Œé€šè¿‡åœ¨è§£é‡Šå™¨ä¸­å¢åŠ æ‰“å°åˆ†æå‡ºçš„ä»£ç çš„æ“ä½œï¼Œæ¥å¾—åˆ°å»è™šæ‹ŸåŒ–çš„åŸç¨‹åºï¼Œè¿›è€Œå¯ä»¥æ­£å¸¸é€†å‘åˆ†æ</p></li><li><p>å…ˆæ¥çœ‹mainå‡½æ•°ï¼š</p><p><img src="/../images/image-20250806232124465.png" alt="mainå‡½æ•°"></p><p>ä¸‹é¢ä¸‰ä¸ªå¸¦å­—ç¬¦ä¸²çš„å‡½æ•°å¯ä»¥çœ‹å‡ºæ˜¯printfå’Œsystem</p></li><li><p>çœ‹çœ‹v1&#x3D;åé¢çš„å‡½æ•°</p><p><img src="/../images/image-20250806232516529.png" alt="v1=åé¢çš„å‡½æ•°"></p><p>ç›®å‰æ²¡ä»€ä¹ˆæ˜æ˜¾çš„VMç‰¹å¾</p></li><li><p>å†çœ‹çœ‹ifæ‹¬å·é‡Œçš„å‡½æ•°</p><p><img src="/../images/image-20250806232613438.png" alt="ifæ‹¬å·é‡Œçš„å‡½æ•°"></p><p>çœ‹åˆ°å‡ºç°switchäº†ï¼Œå¼€å§‹æ¨æµ‹æ˜¯VMçš„è§£é‡Šå™¨</p><p>å›åˆ°ä¸Šä¸€ä¸ªå‡½æ•°ï¼Œå‘ç°ç¡®å®å’ŒVMçš„åˆå§‹åŒ–å‡½æ•°å¾ˆåƒï¼Œæœ€åé¢ä¸€ä¸ªå‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°å¯¹åº”å‡ºæ¥çš„æ˜¯ä¸€å †æ•°å­—ï¼Œå’Œåˆå§‹åŒ–codeå¯¹åº”ä¸Šäº†</p><p><img src="/../images/image-20250806232947764.png" alt="ä¸€å †æ•°å­—"></p></li><li><p>OKï¼Œé‚£å°±å¯¹ä¼ªä»£ç è¿›è¡Œä¸€ç‚¹ç‚¹ä¼˜åŒ–ï¼Œç„¶åå¼€å§‹åˆ†æè§£é‡Šå™¨</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">//æ¨æµ‹è™šæ‹Ÿç¡¬ä»¶ç»“æ„ä½“</span><br>__int64 __fastcall <span class="hljs-title function_">vm_run</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> *vm)</span><br>&#123;<br>  sub_140001940(&amp;unk_1401150A2);<br>  <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>  &#123;<br>    <span class="hljs-keyword">switch</span> ( *((_BYTE *)vm + vm[<span class="hljs-number">2</span>] + <span class="hljs-number">268</span>) )<span class="hljs-comment">//vm+268æ˜¯codeæ‰€åœ¨ï¼Œç»“åˆä¸‹æ–‡åˆ†æï¼ŒåŠ ä¸Švm[2]å°±æ„æˆäº†code[eip]</span><br>    &#123;<br>      <span class="hljs-keyword">case</span> <span class="hljs-number">0x10</span>:<br>        *vm = *((<span class="hljs-type">char</span> *)vm + vm[<span class="hljs-number">2</span>] + <span class="hljs-number">269</span>);<span class="hljs-comment">//*vm=code[eip+1]ï¼Œvmåº”è¯¥æ˜¯ä¸€ä¸ªå¯„å­˜å™¨ï¼Œè¿™å¥æ˜¯mov r1,op1</span><br>        vm[<span class="hljs-number">2</span>] += <span class="hljs-number">2</span>;<span class="hljs-comment">//æ¯ä¸ªcaseéƒ½æœ‰ï¼Œæ¨æµ‹æ˜¯eipã€‚+=2ï¼Œè¯´æ˜æœ‰ä¸€ä¸ªæ“ä½œæ•°                            </span><br>        <span class="hljs-keyword">break</span>;<br>      <span class="hljs-keyword">case</span> <span class="hljs-number">0x11</span>:<br>        vm[<span class="hljs-number">1</span>] = *((<span class="hljs-type">char</span> *)vm + vm[<span class="hljs-number">2</span>] + <span class="hljs-number">269</span>);<span class="hljs-comment">//vm[1]=code[eip+1]ï¼Œvm[1]åº”è¯¥ä¹Ÿæ˜¯ä¸€ä¸ªå¯„å­˜å™¨,è¿™å¥æ˜¯mov r2,op1</span><br>        vm[<span class="hljs-number">2</span>] += <span class="hljs-number">2</span>;<span class="hljs-comment">//æœ‰ä¸€ä¸ªæ“ä½œæ•°</span><br>        <span class="hljs-keyword">break</span>;<br>      <span class="hljs-keyword">case</span> <span class="hljs-number">0x20</span>:<br>        *((_BYTE *)vm + *((<span class="hljs-type">char</span> *)vm + vm[<span class="hljs-number">2</span>] + <span class="hljs-number">269</span>) + <span class="hljs-number">12</span>) = *((_BYTE *)vm + vm[<span class="hljs-number">2</span>] + <span class="hljs-number">270</span>);<br>            <span class="hljs-comment">//*((char *)vm + vm[2] + 269)æ˜¯code[eip+1]ï¼Œå³op1ï¼Œæ‰€ä»¥å·¦è¾¹æ˜¯vm+12+op1ï¼Œæ¨æµ‹vm+12æ˜¯è™šæ‹Ÿå†…å­˜ï¼Œåˆšå¥½è·¨è¿‡ä¸‰ä¸ªè¿ç»­çš„intå‹å¯„å­˜å™¨</span><br>            <span class="hljs-comment">//å³è¾¹å³vm+vm[2]+268+2å³code[eip+2]ï¼Œå³op2</span><br>        vm[<span class="hljs-number">2</span>] += <span class="hljs-number">3</span>;<span class="hljs-comment">//æœ‰ä¸¤ä¸ªæ“ä½œæ•°</span><br>        <span class="hljs-keyword">break</span>;<br>      <span class="hljs-keyword">case</span> <span class="hljs-number">0x30</span>:<br>        *((_BYTE *)vm + *vm + <span class="hljs-number">12</span>) ^= *((_BYTE *)vm + <span class="hljs-number">4</span>);<span class="hljs-comment">//mem[r1]^=r2</span><br>        ++vm[<span class="hljs-number">2</span>];<span class="hljs-comment">//æ— æ“ä½œæ•°</span><br>        <span class="hljs-keyword">break</span>;<br>      <span class="hljs-keyword">case</span> <span class="hljs-number">0x40</span>:<br>        sub_140001610(&amp;unk_1400D74B0, vm + <span class="hljs-number">3</span>);<span class="hljs-comment">//unkè¿™ä¸ªæ˜¯%5sï¼Œæ‰€ä»¥è¿™æ˜¯scanfã€‚è¿™é‡Œçš„vmæ˜¯intï¼ŒåŠ ä¸‰è·³è¿‡äº†å•ä¸ªå¯„å­˜å™¨ï¼Œæ˜¯mem[0]</span><br>        ++vm[<span class="hljs-number">2</span>];<span class="hljs-comment">//æ— æ“ä½œæ•°</span><br>        <span class="hljs-keyword">break</span>;<br>      <span class="hljs-keyword">case</span> <span class="hljs-number">0x50</span>:<br>        <span class="hljs-keyword">return</span> sub_1400D4430(vm + <span class="hljs-number">3</span>, (<span class="hljs-type">char</span> *)vm + *((<span class="hljs-type">char</span> *)vm + vm[<span class="hljs-number">2</span>] + <span class="hljs-number">269</span>) + <span class="hljs-number">12</span>, *((<span class="hljs-type">char</span> *)vm + vm[<span class="hljs-number">2</span>] + <span class="hljs-number">270</span>));<br>            <span class="hljs-comment">//ä¸‰ä¸ªå‚æ•°åˆ†åˆ«ä¸ºmem[0],mem[op1],op2ï¼Œæ¨æµ‹æ˜¯memcmpï¼ˆæ€ä¹ˆæ²¡æš—ç¤ºæ“ä½œæ•°ä¸ªæ•°</span><br>      <span class="hljs-keyword">default</span>:<br>        <span class="hljs-keyword">continue</span>;<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>æ¨æµ‹è™šæ‹Ÿç¡¬ä»¶ç»“æ„ä½“å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span>&#123;</span><br>   <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> r1;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> r2;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> eip;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> mem[<span class="hljs-number">268</span><span class="hljs-number">-3</span>*<span class="hljs-number">4</span>=<span class="hljs-number">256</span>];<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> code[<span class="hljs-number">36</span>];<br>&#125; VM;<br></code></pre></td></tr></table></figure></li><li><p>å¸¦è¾“å‡ºåˆ†æå‡ºæ¥çš„ä»£ç çš„è§£é‡Šå™¨å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs C"><span class="hljs-type">int</span> <span class="hljs-title function_">vm_run</span><span class="hljs-params">(VM* vm)</span> &#123;<br>    <span class="hljs-type">char</span> opcode;<br>    <span class="hljs-type">char</span> op1, op2;<br>    <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>) &#123;<br>        opcode = vm-&gt;code[vm-&gt;eip];<br><br>        <span class="hljs-keyword">switch</span> (opcode) &#123;<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">0x10</span>:<br>            vm-&gt;r1 = code[vm-&gt;eip + <span class="hljs-number">1</span>];<br>            vm-&gt;eip += <span class="hljs-number">2</span>;<br>            <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;mov r1,&quot;</span> &lt;&lt; vm-&gt;r1 &lt;&lt; <span class="hljs-built_in">endl</span>;<br>            <span class="hljs-keyword">break</span>;<br><br>        <span class="hljs-keyword">case</span> <span class="hljs-number">0x11</span>:<br>            vm-&gt;r2 = code[vm-&gt;eip + <span class="hljs-number">1</span>];<br>            vm-&gt;eip += <span class="hljs-number">2</span>;<br>            <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;mov r2,&quot;</span> &lt;&lt; vm-&gt;r2 &lt;&lt; <span class="hljs-built_in">endl</span>;<br>            <span class="hljs-keyword">break</span>;<br><br>        <span class="hljs-keyword">case</span> <span class="hljs-number">0x20</span>:<br>            op1 = code[vm-&gt;eip + <span class="hljs-number">1</span>];<br>            op2 = code[vm-&gt;eip + <span class="hljs-number">2</span>];<br>            vm-&gt;mem[op1] = op2;<br>            vm-&gt;eip += <span class="hljs-number">3</span>;<br>            <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;mov mem[&quot;</span> &lt;&lt; (<span class="hljs-type">int</span>)op1 &lt;&lt; <span class="hljs-string">&quot;],&quot;</span> &lt;&lt; op2 &lt;&lt; <span class="hljs-built_in">endl</span>;<br>            <span class="hljs-keyword">break</span>;<br><br>        <span class="hljs-keyword">case</span> <span class="hljs-number">0x30</span>:<br>            vm-&gt;mem[vm-&gt;r1] ^= vm-&gt;r2;<br>            ++vm-&gt;eip;<br>            <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;xor mem[&quot;</span> &lt;&lt; vm-&gt;r1 &lt;&lt; <span class="hljs-string">&quot;],&quot;</span> &lt;&lt; vm-&gt;r2 &lt;&lt; <span class="hljs-built_in">endl</span>;<br>            <span class="hljs-keyword">break</span>;<br><br>        <span class="hljs-keyword">case</span> <span class="hljs-number">0x40</span>:<br>            <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%5s&quot;</span>, &amp;vm-&gt;mem[<span class="hljs-number">0</span>]);<br>            ++vm-&gt;eip;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;scanf mem\n&quot;</span>);<br>            <span class="hljs-keyword">break</span>;<br><br>        <span class="hljs-keyword">case</span> <span class="hljs-number">0x50</span>:<br>            op1 = code[vm-&gt;eip + <span class="hljs-number">1</span>];<br>            op2 = code[vm-&gt;eip + <span class="hljs-number">2</span>];<br>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">memcmp</span>(&amp;vm-&gt;mem[<span class="hljs-number">0</span>], &amp;vm-&gt;mem[op1], op2);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>å®Œæ•´çš„è„šæœ¬ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;windows.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;iostream&gt;</span></span><br>using namespace <span class="hljs-built_in">std</span>;<br><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> &#123;</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> r1;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> r2;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> eip;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> mem[<span class="hljs-number">256</span>];<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> code[<span class="hljs-number">36</span>];<br>&#125; VM ;<br><br><span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> code[] = &#123;<br>    <span class="hljs-number">0x20</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0x40</span>,<br>    <span class="hljs-number">0x11</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x04</span>,<br>    <span class="hljs-number">0x30</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x05</span><br>&#125;;<br><br>VM* <span class="hljs-title function_">vm_new</span><span class="hljs-params">()</span> &#123;<br>    VM* vm = (VM*)<span class="hljs-built_in">malloc</span>(<span class="hljs-keyword">sizeof</span>(VM));<br>    <span class="hljs-built_in">memset</span>(vm, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(VM));<br>    <span class="hljs-built_in">memcpy</span>(vm-&gt;code, code, <span class="hljs-keyword">sizeof</span>(code));<br>    <span class="hljs-keyword">return</span> vm;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">vm_run</span><span class="hljs-params">(VM* vm)</span> &#123;<br>    <span class="hljs-type">char</span> opcode;<br>    <span class="hljs-type">char</span> op1, op2;<br>    <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>) &#123;<br>        opcode = vm-&gt;code[vm-&gt;eip];<br><br>        <span class="hljs-keyword">switch</span> (opcode) &#123;<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">0x10</span>:<br>            vm-&gt;r1 = code[vm-&gt;eip + <span class="hljs-number">1</span>];<br>            vm-&gt;eip += <span class="hljs-number">2</span>;<br>            <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;mov r1,&quot;</span> &lt;&lt; vm-&gt;r1 &lt;&lt; <span class="hljs-built_in">endl</span>;<br>            <span class="hljs-keyword">break</span>;<br><br>        <span class="hljs-keyword">case</span> <span class="hljs-number">0x11</span>:<br>            vm-&gt;r2 = code[vm-&gt;eip + <span class="hljs-number">1</span>];<br>            vm-&gt;eip += <span class="hljs-number">2</span>;<br>            <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;mov r2,&quot;</span> &lt;&lt; vm-&gt;r2 &lt;&lt; <span class="hljs-built_in">endl</span>;<br>            <span class="hljs-keyword">break</span>;<br><br>        <span class="hljs-keyword">case</span> <span class="hljs-number">0x20</span>:<br>            op1 = code[vm-&gt;eip + <span class="hljs-number">1</span>];<br>            op2 = code[vm-&gt;eip + <span class="hljs-number">2</span>];<br>            vm-&gt;mem[op1] = op2;<br>            vm-&gt;eip += <span class="hljs-number">3</span>;<br>            <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;mov mem[&quot;</span> &lt;&lt; (<span class="hljs-type">int</span>)op1 &lt;&lt; <span class="hljs-string">&quot;],&quot;</span> &lt;&lt; op2 &lt;&lt; <span class="hljs-built_in">endl</span>;<br>            <span class="hljs-keyword">break</span>;<br><br>        <span class="hljs-keyword">case</span> <span class="hljs-number">0x30</span>:<br>            vm-&gt;mem[vm-&gt;r1] ^= vm-&gt;r2;<br>            ++vm-&gt;eip;<br>            <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;xor mem[&quot;</span> &lt;&lt; vm-&gt;r1 &lt;&lt; <span class="hljs-string">&quot;],&quot;</span> &lt;&lt; vm-&gt;r2 &lt;&lt; <span class="hljs-built_in">endl</span>;<br>            <span class="hljs-keyword">break</span>;<br><br>        <span class="hljs-keyword">case</span> <span class="hljs-number">0x40</span>:<br>            <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%5s&quot;</span>, &amp;vm-&gt;mem[<span class="hljs-number">0</span>]);<br>            ++vm-&gt;eip;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;scanf mem\n&quot;</span>);<br>            <span class="hljs-keyword">break</span>;<br><br>        <span class="hljs-keyword">case</span> <span class="hljs-number">0x50</span>:<br>            op1 = code[vm-&gt;eip + <span class="hljs-number">1</span>];<br>            op2 = code[vm-&gt;eip + <span class="hljs-number">2</span>];<br>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">memcmp</span>(&amp;vm-&gt;mem[<span class="hljs-number">0</span>], &amp;vm-&gt;mem[op1], op2);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    VM* vm = vm_new();<br>    <span class="hljs-keyword">if</span> (vm_run(vm))<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;failed\n&quot;</span>);<br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;good\n&quot;</span>);<br>    <br>    system(<span class="hljs-string">&quot;pause&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>è¿™æ ·æˆ‘ä»¬å¾—åˆ°äº†åŸç¨‹åºçš„æ±‡ç¼–ä»£ç ï¼ˆå‚æ‚ç€å¥‡æ€ªçš„ä»£ç ï¼‰</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-keyword">mov</span> mem[<span class="hljs-number">16</span>],H<br><span class="hljs-keyword">mov</span> mem[<span class="hljs-number">17</span>],e<br><span class="hljs-keyword">mov</span> mem[<span class="hljs-number">18</span>],l<br><span class="hljs-keyword">mov</span> mem[<span class="hljs-number">19</span>],l<br><span class="hljs-keyword">mov</span> mem[<span class="hljs-number">20</span>],o<br><span class="hljs-number">12345</span><br>scanf mem<br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">r2</span>,<span class="hljs-number">33</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">r1</span>,<span class="hljs-number">0</span><br><span class="hljs-keyword">xor</span> mem[<span class="hljs-number">0</span>],<span class="hljs-number">33</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">r1</span>,<span class="hljs-number">1</span><br><span class="hljs-keyword">xor</span> mem[<span class="hljs-number">1</span>],<span class="hljs-number">33</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">r1</span>,<span class="hljs-number">2</span><br><span class="hljs-keyword">xor</span> mem[<span class="hljs-number">2</span>],<span class="hljs-number">33</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">r1</span>,<span class="hljs-number">3</span><br><span class="hljs-keyword">xor</span> mem[<span class="hljs-number">3</span>],<span class="hljs-number">33</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">r1</span>,<span class="hljs-number">4</span><br><span class="hljs-keyword">xor</span> mem[<span class="hljs-number">4</span>],<span class="hljs-number">33</span><br>failed<br></code></pre></td></tr></table></figure></li><li><p>å¯ä»¥çœ‹åˆ°ï¼Œç¨‹åºå…ˆæŠŠâ€Helloâ€ä¼ ç»™äº†memçš„ä¸€ç‰‡åŒºåŸŸï¼Œç„¶åè·å–è¾“å…¥ï¼ŒæŠŠè¾“å…¥çš„æ•°ä¸33å¼‚æˆ–ï¼Œæœ€åæ‰§è¡Œè¿”å›å¤„çš„åˆ¤æ–­ã€‚è¿”å›å¤„æ˜¯å¯¹æ¯”mem[0]å’Œmem[op1]ï¼Œå¯¹æ¯”op2ä½ï¼Œç»“åˆcodeæœ€åå‡ ä½ï¼ŒçŸ¥é“æ˜¯å¯¹æ¯”mem[0]å’Œmem[16]ï¼Œå¯¹æ¯”5ä½ã€‚æ‰€ä»¥è¦æ±‚çš„è¾“å…¥æ˜¯â€Helloâ€é€ä½å¼‚æˆ–çš„ç»“æœï¼ˆä¸å¯è§å­—ç¬¦ï¼Œå°è¯•è¾“å…¥å¤±è´¥ï¼‰</p></li></ul>]]></content>
    
    
    <summary type="html">æŒ‡ä»¤è™šæ‹ŸåŒ–ã€å®ç°ä¸€ä¸ªå°å‹è™šæ‹Ÿæœºç¨‹åºã€VMé€†å‘å®è·µ</summary>
    
    
    
    <category term="Reverse Engineering" scheme="https://sydzi.github.io/categories/Reverse-Engineering/"/>
    
    
    <category term="CTF" scheme="https://sydzi.github.io/tags/CTF/"/>
    
    <category term="Reverse" scheme="https://sydzi.github.io/tags/Reverse/"/>
    
  </entry>
  
  <entry>
    <title>Day14:IDApythonä¸SMC</title>
    <link href="https://sydzi.github.io/2025/08/05/Day14-IDApython/"/>
    <id>https://sydzi.github.io/2025/08/05/Day14-IDApython/</id>
    <published>2025-08-05T01:53:56.000Z</published>
    <updated>2025-09-18T03:57:27.694Z</updated>
    
    <content type="html"><![CDATA[<p>IDApythonAPIã€SMCè‡ªä¿®æ”¹ä»£ç </p><span id="more"></span><h2 id="IDApython"><a href="#IDApython" class="headerlink" title="IDApython"></a>IDApython</h2><ul><li>å…ˆè´´ä¸Šå®˜æ–¹æ–‡æ¡£ï¼š <a href="https://python.docs.hex-rays.com/index.html">https://python.docs.hex-rays.com/index.html</a></li></ul><h3 id="åŸºç¡€API"><a href="#åŸºç¡€API" class="headerlink" title="åŸºç¡€API"></a>åŸºç¡€API</h3><ul><li>idc.here() &#x2F; idc.get_screen_ea()ï¼šè¿”å›å…‰æ ‡æ‰€åœ¨å¤„çš„åœ°å€</li><li>idc.get_inf_attr(INF_MIN_EA) &#x2F; idc.get_inf_attr(INF_MAX_EA)ï¼šè¿”å›æœ€å°&#x2F;æœ€å¤§åœ°å€ï¼ˆæ²¡æœ‰éšæœºåŒ–åœ°å€æƒ…å†µä¸‹ï¼‰</li><li>idc.generate_disasm_line(ea,0)ï¼šè¿”å›eaæ‰€åœ¨å¤„çš„æ±‡ç¼–æŒ‡ä»¤</li><li>idc.prev_head(ea)&#x2F;next_head(ea)ï¼šè¿”å›eaå¤„ä¸Šä¸€æ¡&#x2F;ä¸‹ä¸€æ¡æŒ‡ä»¤åœ°å€</li><li>idc.print_insn_mnem(ea)ï¼šæ‰“å°eaå¤„çš„åŠ©è®°ç¬¦ï¼ˆå³mov,addä»€ä¹ˆçš„ï¼‰</li><li>idc.print_operand(ea,n)ï¼šæ‰“å°eaå¤„ç¬¬nä¸ªæ“ä½œæ•°ï¼ˆn&#x3D;0æˆ–è€…1ï¼‰</li></ul><h3 id="æ®µç›¸å…³API"><a href="#æ®µç›¸å…³API" class="headerlink" title="æ®µç›¸å…³API"></a>æ®µç›¸å…³API</h3><ul><li>idautils.Segments()ï¼šè¿”å›æ®µèµ·å§‹åœ°å€åˆ—è¡¨</li><li>idc.get_segm_name(ea)ï¼šè¿”å›eaæ‰€åœ¨æ®µçš„åå­—</li><li>idc.get_segm_start(ea)&#x2F;get_segm_end(ea)ï¼šè¿”å›eaæ‰€åœ¨æ®µçš„èµ·å§‹åœ°å€&#x2F;ç»“æŸåœ°å€</li><li>idc.get_next_seg(ea)ï¼šè¿”å›eaæ‰€åœ¨æ®µçš„ä¸‹ä¸€ä¸ªæ®µçš„èµ·å§‹åœ°å€</li></ul><h3 id="å‡½æ•°ç›¸å…³API"><a href="#å‡½æ•°ç›¸å…³API" class="headerlink" title="å‡½æ•°ç›¸å…³API"></a>å‡½æ•°ç›¸å…³API</h3><ul><li>idautils.Functions(start_addr,end_addr)ï¼šè¿”å›åœ°å€é—´çš„å‡½æ•°å¯¹è±¡ï¼ˆä¸å†™å‚æ•°å°±æ˜¯æ‰€æœ‰å‡½æ•°å¯¹è±¡ï¼‰</li><li>idautils.FuncItems(ea)ï¼šè¿”å›eaæ‰€åœ¨å‡½æ•°æ‰€æœ‰æŒ‡ä»¤çš„åœ°å€ï¼ˆç›¸å½“äºåœ°å€åˆ—è¡¨ï¼‰</li><li>idaapi.get_func(ea)ï¼šè·å¾—eaæ‰€åœ¨å‡½æ•°çš„å¯¹è±¡ï¼ˆå«æœ‰å¦‚start_eaã€end_eaã€sizeç­‰å±æ€§ï¼‰</li><li>idc.get_func_name(ea)ï¼šè¿”å›eaæ‰€åœ¨å‡½æ•°çš„åå­—</li><li>idc.get_func_attr(ea,FUNCATTR_START) &#x2F; idc.get_func_attr(ea,FUNCATTR_END)ï¼šè¿”å›eaæ‰€åœ¨å‡½æ•°çš„èµ·å§‹åœ°å€&#x2F;ç»“æŸåœ°å€</li><li>idc.get_next_func(ea) &#x2F; idc.get_prev_func(ea)ï¼šè¿”å›eaæ‰€åœ¨å‡½æ•°çš„ä¸Šä¸€ä¸ª&#x2F;ä¸‹ä¸€ä¸ªå‡½æ•°çš„èµ·å§‹åœ°å€</li></ul><h3 id="æŒ‡ä»¤ç›¸å…³API"><a href="#æŒ‡ä»¤ç›¸å…³API" class="headerlink" title="æŒ‡ä»¤ç›¸å…³API"></a>æŒ‡ä»¤ç›¸å…³API</h3><ul><li>ida_ua.insn_t()ï¼Œè¿”å›ä¸€ä¸ªç©ºçš„æŒ‡ä»¤å¯¹è±¡ï¼ˆæˆ–è€…è¯´åˆ›å»ºä¸€ä¸ªç©ºçš„æŒ‡ä»¤å¯¹è±¡ï¼‰ï¼ŒåŒ…å«å‡½æ•°çš„ä¸€äº›å±æ€§</li><li>idaapi.decode_insn(out,ea)ï¼Œè§£æeaæ‰€åœ¨å¤„çš„æŒ‡ä»¤ï¼ŒæŠŠè§£æçš„ç»“æœç»™outï¼ˆoutå¿…é¡»æ˜¯ä¸€ä¸ªæŒ‡ä»¤å¯¹è±¡ï¼‰<ul><li>out.eaï¼šæŒ‡ä»¤çš„èµ·å§‹åœ°å€</li><li>out.sizeï¼šæŒ‡ä»¤å ç”¨çš„å­—èŠ‚æ•°</li><li>out.get_cannon_mnemonic()ï¼šæŒ‡ä»¤çš„åŠ©è®°ç¬¦</li><li>out.itypeï¼šåŠ©è®°ç¬¦çš„åè¿›åˆ¶ç </li></ul></li></ul><h3 id="æ“ä½œæ•°ç›¸å…³API"><a href="#æ“ä½œæ•°ç›¸å…³API" class="headerlink" title="æ“ä½œæ•°ç›¸å…³API"></a>æ“ä½œæ•°ç›¸å…³API</h3><ul><li>idc.get_operand_value(ea,n)ï¼šè¿”å›eaå¤„ç¬¬nä¸ªæ“ä½œæ•°çš„å€¼</li><li>idc.get_operand_type(ea,n)ï¼šè¿”å›eaå¤„ç¬¬nä¸ªæ“ä½œæ•°çš„ç±»å‹</li></ul><h3 id="æ•°æ®è¯»å†™ç›¸å…³API"><a href="#æ•°æ®è¯»å†™ç›¸å…³API" class="headerlink" title="æ•°æ®è¯»å†™ç›¸å…³API"></a>æ•°æ®è¯»å†™ç›¸å…³API</h3><ul><li>idc.get_bytes(ea,size)ï¼šè¿”å›eaå¤„sizeå¤§å°çš„bytes</li><li>idc.patch_byte(ea,content)ï¼šä¿®æ”¹eaå¤„çš„1å­—èŠ‚ä¸ºcontent</li><li>idc.patch_word(ea,content)ï¼šä¿®æ”¹eaå¤„çš„2å­—èŠ‚ä¸ºcontent</li><li>idc.patch_dword(ea,content)ï¼šä¿®æ”¹eaå¤„çš„4å­—èŠ‚ä¸ºcontent</li><li>idc.patch_qword(ea,content)ï¼šä¿®æ”¹eaå¤„çš„8å­—èŠ‚ä¸ºcontent</li></ul><h3 id="è°ƒè¯•ç›¸å…³API"><a href="#è°ƒè¯•ç›¸å…³API" class="headerlink" title="è°ƒè¯•ç›¸å…³API"></a>è°ƒè¯•ç›¸å…³API</h3><ul><li><p>ida_dbg.load_debugger(â€œlocalâ€,0)ï¼šå¯åŠ¨è°ƒè¯•å™¨</p></li><li><p>ida_dbg.add_bpt(ea)ï¼šåœ¨eaå¤„ä¸‹æ–­ç‚¹</p></li><li><p>ida_dbg.del_bpt(ea)ï¼šåˆ é™¤eaå¤„æ–­ç‚¹</p></li><li><p>ida_dbg.start_process(path,args,sdir)ï¼šå¯åŠ¨è°ƒè¯•è¿›ç¨‹ï¼Œå‚æ•°å¯¹åº”è·¯å¾„ã€å‘½ä»¤è¡Œå‚æ•°ã€å·¥ä½œç›®å½•</p></li><li><p>ida_dbg.step_into()ï¼šå•æ­¥æ­¥å…¥</p></li><li><p>ida_dbg.step_over()ï¼šå•æ­¥æ­¥è¿‡</p></li><li><p>ida_dbg.step_until_ret()ï¼šè¿è¡Œåˆ°è¿”å›</p></li><li><p>idc.get_reg_value(regname)ï¼šè·å–regnameå¯„å­˜å™¨çš„å€¼</p></li><li><p>idc.set_reg_value(value,regname)ï¼šè®¾ç½®regnameå¯„å­˜å™¨çš„å€¼</p></li></ul><h3 id="å…¶ä»–æ“ä½œç›¸å…³API"><a href="#å…¶ä»–æ“ä½œç›¸å…³API" class="headerlink" title="å…¶ä»–æ“ä½œç›¸å…³API"></a>å…¶ä»–æ“ä½œç›¸å…³API</h3><ul><li><p>idautils.XrefsFrom(ea)ï¼šè¿”å›eaå¤„å¼•ç”¨çš„å¯¹è±¡ï¼ˆæœ‰å±æ€§frmã€toã€typeï¼‰</p></li><li><p>idautils.XrefsTo(ea)ï¼šè¿”å›æ‰€æœ‰å¼•ç”¨eaå¤„çš„å¯¹è±¡ï¼ˆæœ‰å±æ€§frmã€toã€typeï¼‰ï¼ˆCtrl+Xï¼‰</p><p>ç¤ºä¾‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> idautils,idaapi<br><span class="hljs-keyword">for</span> xref <span class="hljs-keyword">in</span> idautils.XrefsTo(here()):<br>    <span class="hljs-built_in">print</span>(xref.to)<span class="hljs-comment">#here()</span><br>    <span class="hljs-built_in">print</span>(xref.frm)<span class="hljs-comment">#è°ƒç”¨here()çš„å‡½æ•°åœ°å€</span><br><span class="hljs-keyword">for</span> xref <span class="hljs-keyword">in</span> idautils.XrefsFrom(here()):<br>    <span class="hljs-built_in">print</span>(xref.frm)<span class="hljs-comment">#here()</span><br>    <span class="hljs-built_in">print</span>(xref.to)<span class="hljs-comment">#here()å¼•ç”¨çš„å‡½æ•°åœ°å€</span><br></code></pre></td></tr></table></figure></li><li><p>idautils.Strings()ï¼šè¿”å›åŒ…å«æ‰€æœ‰å­—ç¬¦ä¸²çš„å¯¹è±¡ï¼ˆæœ‰å±æ€§eaã€lengthã€strtypeï¼‰ï¼ˆshift+F12ï¼‰</p></li><li><p>idc.get_strlit_contents(ea)ï¼šè¿”å›eaå¤„çš„å­—ç¬¦ä¸²</p><p>ç¤ºä¾‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> idc,idautils<br><span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> idautils.Strings():<br>    string=idc.get_strlit_contents(s.ea)<br>    <span class="hljs-built_in">print</span>(string)<br><span class="hljs-comment">#æ‰“å°æ‰€æœ‰å­—ç¬¦ä¸²</span><br></code></pre></td></tr></table></figure></li></ul><h2 id="è‡ªä¿®æ”¹ä»£ç ï¼ˆSMCï¼‰"><a href="#è‡ªä¿®æ”¹ä»£ç ï¼ˆSMCï¼‰" class="headerlink" title="è‡ªä¿®æ”¹ä»£ç ï¼ˆSMCï¼‰"></a>è‡ªä¿®æ”¹ä»£ç ï¼ˆSMCï¼‰</h2><ul><li><p>è‡ªä¿®æ”¹ä»£ç ï¼ˆSelf-Modifying-Codeï¼‰æŒ‡æŸéƒ¨åˆ†ä»£ç ä»¥åŠ å¯†åçš„å½¢å¼å­˜åœ¨äºç¨‹åºä¸­ï¼Œç¨‹åºæ‰§è¡Œåˆ°è¿™éƒ¨åˆ†ä»£ç çš„æ—¶å€™æ‰ä¼šè¿›è¡ŒåŠ¨æ€è§£å¯†ï¼Œå’ŒåŠ å£³æœ‰ç‚¹å¼‚æ›²åŒå·¥ã€‚å¸¸ç”¨æ¥åŠ å¯†å…³é”®é€»è¾‘ï¼Œä½¿å…¶ä¸å¯ç›´æ¥é™æ€åˆ†æ</p></li><li><p>ç‰¹å¾ï¼š</p><p>ç¨‹åºä¸­å­˜åœ¨å¯¹ç¨‹åºè‡ªèº«æŸéƒ¨åˆ†çš„è¿ç®—ï¼Œä¸€èˆ¬è¿˜éœ€è¦VirtualProtect() &#x2F; mprotect()æ¥æ”¹å˜å†…å­˜çš„å±æ€§ä»¥ä¾¿å°†è§£å¯†åçš„ä»£ç æ•°æ®å†™å…¥å†…å­˜ï¼Œæˆ–è€…ä½¿ç”¨VirtualAllocæŠŠè§£å¯†åçš„ä»£ç æ•°æ®å†™å…¥å †ä¸­æ‰§è¡Œï¼ˆä¸ºäº†é¿å…APIæš´éœ²ï¼Œè¿˜å¯èƒ½ä¼šæ–°å¢ä¸€ä¸ªæœ‰RWXå±æ€§çš„æ®µæ¥å­˜æ”¾åŠ å¯†åçš„ä»£ç ï¼‰ã€‚</p></li><li><p>åº”å¯¹æ–¹æ³•æœ‰ä¸¤ç§ï¼šä¸€ç§æ˜¯åŠ¨æ€è°ƒè¯•å¾—åˆ°è§£å¯†åçš„å…³é”®é€»è¾‘ï¼Œå¦ä¸€ç§æ˜¯ä½¿ç”¨è„šæœ¬è§£å¯†å…³é”®é€»è¾‘åå†è¦†ç›–å›å»</p><ul><li><p>ç¤ºä¾‹ï¼š2021-ç¾ŠåŸæ¯-babysmc</p><p>PSï¼šæœ¬æ¥æƒ³è¦è‡ªå·±å†™ä¸€ä¸ªç®€å•ç¨‹åºè¯•è¯•æ‰‹çš„ï¼Œç ”ç©¶äº†åŠä¸ªä¸‹åˆæ²¡ç ”ç©¶å‡ºæ¥ï¼Œç¨‹åºä¿®æ­£åˆ°è§£å¯†å‡½æ•°å¯ä»¥è§£å¯†å‡ºæ­£ç¡®ä»£ç äº†ï¼Œä½†æ˜¯è°ƒç”¨å…³é”®é€»è¾‘checkçš„æ—¶å€™è«åå…¶å¦™è·‘é£äº†ï¼Œåœ¨é‚£ä¸ªå®‰å…¨æ£€æŸ¥çš„ä½ç½®ï¼Œè·³è½¬ååƒæ˜¯ä¸ªç•¸å½¢å‡½æ•°ï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯æ”¹å†…å­˜å±æ€§çš„æ—¶å€™å½±å“åˆ°äº†ï¼Œæ‰€ä»¥åªèƒ½å»æ‰¾ç½‘ä¸Šçš„é¢˜ç›®äº†</p></li><li><p>è¿™æ˜¯ä¼˜åŒ–åçš„ä¸»å‡½æ•°ï¼š</p><p><img src="/../images/image-20250805234429100.png" alt="ä¸»å‡½æ•°"></p><p>ä¼˜åŒ–çš„æ¥æºå°±æ˜¯ï¼Œencçš„ä½ç½®æ˜¯ä¸€å›¢æ•°å­—ï¼Œè€Œloc_7FF6BF081D00å¤„å¼€å§‹æ˜¯æ­£å¸¸ä»£ç ï¼ŒåŠ ä¸Šå¯¹ä¸‹é¢çš„decryptå‡½æ•°çš„åˆ†æï¼Œå¯ä»¥ç¡®å®šencå°±æ˜¯è¢«åŠ å¯†åçš„first_part</p></li><li><p>è¿™æ˜¯decryptå‡½æ•°ï¼š</p><p><img src="/../images/image-20250805234728191.png" alt="decryptå‡½æ•°"></p><p>éå¸¸æ˜æ˜¾åœ°è°ƒç”¨äº†VirtualProtectå‡½æ•°ï¼Œè§£å¯†é€»è¾‘å¾ˆç®€å•ï¼Œå°±æ˜¯roråå¼‚æˆ–0x5aï¼ˆroræŸ¥å‡ºæ¥æ˜¯å¾ªç¯å³ç§»ï¼Œ3å°±æ˜¯å³ç§»çš„ä½æ•°äº†ï¼Œè¿™ç‚¹çœ‹æ±‡ç¼–å¯èƒ½æ›´æ¸…æ™°ç‚¹ï¼‰</p></li><li><p>ä¸‹é¢å°±æ˜¯ä»Šå¤©çš„æˆæœå±•ç¤ºäº†ï¼ˆrorç”±DSååŠ©å®ç°ï¼‰ï¼ŒSMCè§£å¯†è„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> idautils,idc,idaapi<br><br>enc=idc.get_bytes(<span class="hljs-number">0x00007FF6BF081085</span>,<span class="hljs-number">0x00007FF6BF081D00</span>-<span class="hljs-number">0x00007FF6BF081085</span>)<br>loc=<span class="hljs-number">0x00007FF6BF081085</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ror</span>(<span class="hljs-params">value, shift, bits=<span class="hljs-number">8</span></span>):<br>    shift %= bits  <span class="hljs-comment"># ç¡®ä¿ä½ç§»é‡åœ¨æœ‰æ•ˆèŒƒå›´å†…</span><br>    <span class="hljs-keyword">return</span> (value &gt;&gt; shift) | ((value &lt;&lt; (bits - shift)) &amp; ((<span class="hljs-number">1</span> &lt;&lt; bits) - <span class="hljs-number">1</span>))<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> enc:<br>    idc.patch_byte(loc,(ror(i,<span class="hljs-number">3</span>)^<span class="hljs-number">0x5a</span>)&amp;<span class="hljs-number">0xff</span>)<br>    loc+=<span class="hljs-number">1</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;done&quot;</span>)<br></code></pre></td></tr></table></figure></li><li><p>æœ¬æ¥æ˜¯è¦å†™å®Œçš„ï¼Œä½†æ˜¯first_partçš„å‡½æ•°è§£æå®Œå¥½å‡ ç™¾è¡Œäº†ï¼Œæ˜¯æˆ‘çœ‹ä¸æ‡‚çš„åŠ å¯†ğŸ« å»æ‰¾WPï¼Œå‘ç°æ˜¯éå¸¸æ··æ·†çš„base64ï¼Œè¿˜åŠ äº†å¼‚æˆ–ï¼Œä½†æ˜¯æˆ‘æ²¡çœ‹å‡ºé€»è¾‘ï¼Œç´¢æ€§ç‚¹åˆ°ä¸ºæ­¢ï¼Œæ”¹å¤©æŠŠç¼–ç å’Œå¯†ç çš„éƒ¨åˆ†è¡¥ä¸Šå†è¯´ã€‚</p></li><li><p>æœ¬æ¥ä¹Ÿå°è¯•äº†åŠ¨è°ƒè§£å¯†ï¼Œä½†æ˜¯è°ƒç€è°ƒç€ç»™æˆ‘ä¸‹èµ·ä¸œè¥¿æ¥äº†ï¼Œè™½ç„¶é“¾æ¥çœ‹ç€æ˜¯å¾®è½¯çš„ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰ç‚¹æ€•ï¼Œå°±èˆå¼ƒè¿™ä¸ªæ–¹æ³•äº†ï¼ˆä¸‹çš„æ˜¯kernel.pdbå¥½åƒï¼ŒDSè¯´æ˜¯ç¼ºå¤±ç¬¦å·æ–‡ä»¶ğŸ« ğŸ« ï¼‰</p></li></ul></li></ul>]]></content>
    
    
    <summary type="html">IDApythonAPIã€SMCè‡ªä¿®æ”¹ä»£ç </summary>
    
    
    
    <category term="Reverse Engineering" scheme="https://sydzi.github.io/categories/Reverse-Engineering/"/>
    
    
    <category term="CTF" scheme="https://sydzi.github.io/tags/CTF/"/>
    
    <category term="Reverse" scheme="https://sydzi.github.io/tags/Reverse/"/>
    
  </entry>
  
  <entry>
    <title>Day13:åè°ƒè¯•ï¼ˆäºŒï¼‰</title>
    <link href="https://sydzi.github.io/2025/08/03/Day13-%E5%8F%8D%E8%B0%83%E8%AF%95%EF%BC%88%E4%BA%8C%EF%BC%89/"/>
    <id>https://sydzi.github.io/2025/08/03/Day13-%E5%8F%8D%E8%B0%83%E8%AF%95%EF%BC%88%E4%BA%8C%EF%BC%89/</id>
    <published>2025-08-03T00:38:55.000Z</published>
    <updated>2025-09-18T03:57:24.729Z</updated>
    
    <content type="html"><![CDATA[<p>æ—¶é—´å·®æ£€æµ‹ã€æ–­ç‚¹æ£€æµ‹</p><span id="more"></span><h2 id="æ—¶é—´å·®æ£€æµ‹"><a href="#æ—¶é—´å·®æ£€æµ‹" class="headerlink" title="æ—¶é—´å·®æ£€æµ‹"></a>æ—¶é—´å·®æ£€æµ‹</h2><ul><li>CPUçš„è¿è¡Œååˆ†è¿…é€Ÿï¼Œä¸€æ®µä»£ç å¯èƒ½åœ¨å‡ æ¯«ç§’å†…å°±å¯ä»¥æ‰§è¡Œå®Œæ¯•ï¼Œä½†æ˜¯è°ƒè¯•çš„æ—¶å€™ï¼Œä»£ç è¿è¡Œæ—¶é—´ä¼šæ˜¾è‘—åœ°å˜æ…¢ï¼Œè¿™å°±æ˜¯æ—¶é—´å·®æ£€æµ‹çš„åŸç†ã€‚æ—¶é—´å·®æ£€æµ‹ä¸»è¦é€šè¿‡è®¡ç®—æ—¶é—´å·®ç„¶åä¸é¢„è®¾çš„å€¼æ¯”è¾ƒå®ç°ã€‚</li></ul><h3 id="RDTSCæŒ‡ä»¤è®¡ç®—"><a href="#RDTSCæŒ‡ä»¤è®¡ç®—" class="headerlink" title="RDTSCæŒ‡ä»¤è®¡ç®—"></a>RDTSCæŒ‡ä»¤è®¡ç®—</h3><ul><li><p>rdtscæ˜¯ä¸€ä¸ªæ±‡ç¼–æŒ‡ä»¤ï¼Œç”¨äºå°†æ—¶é—´è¯»å…¥edx:eaxå¯„å­˜å™¨ï¼ˆé«˜32ä½ï¼šä½32ä½ï¼‰ã€‚é€šè¿‡å–ä¸¤æ¬¡æ—¶é—´æŠŠç»“æœç›¸å‡å¯ä»¥å¾—åˆ°ä¸€ä¸ªæ—¶é—´å·®ã€‚æ˜¾è‘—ç‰¹å¾å°±æ˜¯rdtscæŒ‡ä»¤</p></li><li><p>æ•ˆæœï¼š</p><p><img src="/../images/image-20250803103503205.png" alt="IDA"></p><p><img src="/../images/image-20250803103510223.png" alt="XDbg"></p></li><li><p>åº”å¯¹æ–¹æ³•ï¼š</p><p>æ ¹æ®ç¨‹åºçš„é€»è¾‘ï¼Œå¯ä»¥åœ¨è®¡ç®—å‡ºæ—¶é—´å·®å¹¶æ¯”è¾ƒä¹‹åæ”¹å˜æ¯”è¾ƒç»“æœã€‚</p></li></ul><h3 id="GetTickCountè®¡ç®—"><a href="#GetTickCountè®¡ç®—" class="headerlink" title="GetTickCountè®¡ç®—"></a>GetTickCountè®¡ç®—</h3><ul><li><p>åŸç†å’ŒRDTSCç±»ä¼¼ï¼Œåªä¸è¿‡æ—¶é—´å·®é‡‡ç”¨GetTickCountè®¡ç®—ã€‚GetTickCountä¹Ÿæ˜¯WINAPIï¼Œä¼šæœ‰æ˜æ˜¾æ ‡è®°ã€‚</p></li><li><p>æ•ˆæœï¼š</p><p><img src="/../images/image-20250803110132263.png" alt="IDA"></p><p><img src="/../images/image-20250803110151704.png" alt="XDbg"></p></li><li><p>åº”å¯¹æ–¹æ³•ï¼š</p><p>ä¿®æ”¹æ¯”è¾ƒç»“æœå³å¯</p></li></ul><h3 id="QueryPerformanceCounterè®¡ç®—"><a href="#QueryPerformanceCounterè®¡ç®—" class="headerlink" title="QueryPerformanceCounterè®¡ç®—"></a>QueryPerformanceCounterè®¡ç®—</h3><ul><li><p>åŸç†ç±»ä¼¼ï¼Œåªæ˜¯é‡‡ç”¨QueryPerformanceCounterè®¡ç®—ï¼Œä¹Ÿæ˜¯WINAPIï¼Œæ¯”è¾ƒå¥½è¯†åˆ«</p></li><li><p>æ•ˆæœï¼š</p><p><img src="/../images/image-20250803111252719.png" alt="IDA"></p><p><img src="/../images/image-20250803111302239.png" alt="XDbg"></p></li><li><p>åº”å¯¹æ–¹æ³•ï¼š</p><p>ä¿®æ”¹æ¯”è¾ƒç»“æœå³å¯</p></li></ul><h2 id="æ–­ç‚¹æ£€æµ‹"><a href="#æ–­ç‚¹æ£€æµ‹" class="headerlink" title="æ–­ç‚¹æ£€æµ‹"></a>æ–­ç‚¹æ£€æµ‹</h2><ul><li>æ–­ç‚¹æ˜¯è°ƒè¯•çš„ä¸€ä¸ªæ˜¾è‘—ç‰¹ç‚¹ã€‚æ–­ç‚¹å¯ä»¥åˆ†ä¸ºè½¯ä»¶æ–­ç‚¹ã€ç¡¬ä»¶æ–­ç‚¹å’Œå†…å­˜æ–­ç‚¹ã€‚è½¯ä»¶æ–­ç‚¹é€šè¿‡å°†ç›®æ ‡ä»£ç ä¿®æ”¹ä¸ºä¸­æ–­æŒ‡ä»¤ï¼ˆX86\X64ä¸‹ä¸€èˆ¬ä¸ºINT3\0xCCï¼‰å®ç°ï¼›ç¡¬ä»¶æ–­ç‚¹é€šè¿‡å°†æŒ‡ä»¤åœ°å€å†™å…¥è°ƒè¯•å¯„å­˜å™¨çš„DR0-DR3ç›‘æ§åœ°å€è®¿é—®æ¥å®ç°ï¼›å†…å­˜æ–­ç‚¹é€šè¿‡ä¿®æ”¹å†…å­˜é¡µï¼ˆä¸€ç‰‡ç‰‡å†…å­˜åŒºåŸŸï¼‰çš„è®¿é—®æƒé™å®ç°ã€‚ä¸‰è€…çš„å®ç°æ–¹æ³•éƒ½ä¼šè§¦å‘å¼‚å¸¸è®©è°ƒè¯•å™¨æ•è·è¿›è€Œä¸­æ–­ã€‚åè°ƒè¯•çš„æ–­ç‚¹æ£€æµ‹ä¸»è¦åˆ©ç”¨è½¯ä»¶æ–­ç‚¹å’Œç¡¬ä»¶æ–­ç‚¹ï¼Œå†…å­˜æ–­ç‚¹ç”±äºé’ˆå¯¹å†…å­˜åŒºåŸŸè€Œéå…·ä½“æŒ‡ä»¤ï¼Œç²¾åº¦å¤ªä½ï¼Œä¸€èˆ¬ä¸è€ƒè™‘ã€‚</li></ul><h3 id="è½¯ä»¶æ–­ç‚¹æ£€æµ‹"><a href="#è½¯ä»¶æ–­ç‚¹æ£€æµ‹" class="headerlink" title="è½¯ä»¶æ–­ç‚¹æ£€æµ‹"></a>è½¯ä»¶æ–­ç‚¹æ£€æµ‹</h3><ul><li><p>å¸¸è§æ‰‹æ®µæ˜¯åœ¨å†…å­˜åŒºåŸŸæœç´¢0xCCï¼ˆä½¿ç”¨æ±‡ç¼–æŒ‡ä»¤repnz scasbï¼‰</p></li><li><p>æ•ˆæœï¼š</p><p><img src="/../images/image-20250803184326511.png" alt="IDA"></p><p><img src="/../images/image-20250803184332179.png" alt="XDbg"></p></li><li><p>å› ä¸ºè¿›è¡Œäº†æ¯”è¾ƒï¼Œæ‰€ä»¥ä¿®æ”¹æ¯”è¾ƒç»“æœå³å¯ç»•è¿‡</p></li></ul><h3 id="ç¡¬ä»¶æ–­ç‚¹æ£€æµ‹"><a href="#ç¡¬ä»¶æ–­ç‚¹æ£€æµ‹" class="headerlink" title="ç¡¬ä»¶æ–­ç‚¹æ£€æµ‹"></a>ç¡¬ä»¶æ–­ç‚¹æ£€æµ‹</h3><ul><li><p>å¸¸è§æ‰‹æ®µæ˜¯è·å–DRå¯„å­˜å™¨çš„å€¼å¹¶å’Œ0æ¯”è¾ƒã€‚ç‰¹å¾æ˜¯GetThreadContextå‡½æ•°ï¼ˆæˆ–è€…å…¶ä»–ThreadContextç›¸å…³çš„å‡½æ•°ï¼‰å’Œä¸0çš„æ¯”è¾ƒ</p></li><li><p>æ•ˆæœï¼š</p><p><img src="/../images/image-20250803190042096.png" alt="IDA"></p><p><img src="/../images/image-20250803190057497.png" alt="XDbg"></p></li><li><p>åº”å¯¹æ–¹æ³•ï¼š</p><p>è¿˜æ˜¯è¿›è¡Œäº†æ¯”è¾ƒï¼Œä¿®æ”¹æ¯”è¾ƒç»“æœç»•è¿‡</p></li></ul>]]></content>
    
    
    <summary type="html">æ—¶é—´å·®æ£€æµ‹ã€æ–­ç‚¹æ£€æµ‹</summary>
    
    
    
    <category term="Reverse Engineering" scheme="https://sydzi.github.io/categories/Reverse-Engineering/"/>
    
    
    <category term="CTF" scheme="https://sydzi.github.io/tags/CTF/"/>
    
    <category term="Reverse" scheme="https://sydzi.github.io/tags/Reverse/"/>
    
  </entry>
  
  <entry>
    <title>Day12:åè°ƒè¯•ï¼ˆä¸€ï¼‰</title>
    <link href="https://sydzi.github.io/2025/08/02/Day12-%E5%8F%8D%E8%B0%83%E8%AF%95/"/>
    <id>https://sydzi.github.io/2025/08/02/Day12-%E5%8F%8D%E8%B0%83%E8%AF%95/</id>
    <published>2025-08-02T05:18:54.000Z</published>
    <updated>2025-09-18T03:57:21.797Z</updated>
    
    <content type="html"><![CDATA[<p>åè°ƒè¯•åŸºæœ¬åŸç†ã€WINAPIæ£€æµ‹ã€æ•°æ®æ£€æµ‹ã€è¿›ç¨‹æ£€æµ‹</p><span id="more"></span><h2 id="åè°ƒè¯•åŸºæœ¬åŸç†"><a href="#åè°ƒè¯•åŸºæœ¬åŸç†" class="headerlink" title="åè°ƒè¯•åŸºæœ¬åŸç†"></a>åè°ƒè¯•åŸºæœ¬åŸç†</h2><ul><li>åè°ƒè¯•æŠ€æœ¯é€šå¸¸å€ŸåŠ©æ“ä½œç³»ç»Ÿç›¸å…³çš„å†…å®¹æ¥å®ç°ï¼Œå¸¸è§åŠæ³•æœ‰è°ƒç”¨WindowsAPIè·å¾—ç›¸å…³æ•°æ®ã€æœ‰æ„è§¦å‘å¼‚å¸¸ç›‘æµ‹å¼‚å¸¸å¤„ç†ï¼ˆè°ƒè¯•å™¨ä¼šæ•è·å¼‚å¸¸ï¼‰ã€æ—¶é—´å·®æ£€æµ‹ï¼ˆå®é™…è¿è¡Œè¿‡ç¨‹ååˆ†è¿…é€Ÿï¼‰ã€ç¡¬ä»¶æ–­ç‚¹æ£€æµ‹ã€è¿›ç¨‹æ£€æµ‹ç­‰</li></ul><h2 id="WINAPIæ£€æµ‹"><a href="#WINAPIæ£€æµ‹" class="headerlink" title="WINAPIæ£€æµ‹"></a>WINAPIæ£€æµ‹</h2><ul><li>ç”±äºæ˜¯ç›´æ¥ä½¿ç”¨WINAPIï¼Œæ‰€ä»¥ä¸€èˆ¬åœ¨IDAæˆ–è€…åŠ¨æ€è°ƒè¯•å™¨é‡Œä¼šæœ‰æ˜æ˜¾çš„å‡½æ•°åå­—æ ·ï¼Œè¯†åˆ«ä¼šæ¯”è¾ƒå®¹æ˜“</li><li>æ­¤ç±»ä¸€èˆ¬æ˜¯åˆ©ç”¨å‡½æ•°çš„è¿”å›å€¼æˆ–è€…å‡½æ•°ä¼ é€’å›æ¥çš„å‚æ•°ä½œä¸ºåˆ¤æ–­æ ‡å‡†ï¼Œåº”å¯¹æ–¹æ³•ä¸»è¦æœ‰ä½¿ç”¨ååè°ƒè¯•æ’ä»¶ã€ä¿®æ”¹ç›¸å…³å€¼ã€hookç­‰</li></ul><h3 id="IsDebuggerPresent"><a href="#IsDebuggerPresent" class="headerlink" title="IsDebuggerPresent"></a>IsDebuggerPresent</h3><ul><li><p>åŸç†ï¼š</p><p>IsDebuggerPresent() å®é™…ä¸Šæ˜¯é€šè¿‡è®¿é—®PEBï¼ˆProcessEnvironmentBlockï¼Œè¿›ç¨‹ç¯å¢ƒå—ï¼Œä¸€ä¸ªæè¿°è¿›ç¨‹ç›¸å…³æ•°æ®çš„ç»“æ„ä½“ï¼‰ä¸­çš„BeingDebuggedæ ‡å¿—æ¥åˆ¤æ–­æ˜¯å¦è¢«è°ƒè¯•çš„ï¼Œè¢«è°ƒè¯•çš„è¯ï¼Œå‡½æ•°è¿”å›1ã€‚æœ‰å…³BeingDebuggedçš„å†…å®¹ï¼Œè§ä¸‹æ–‡ã€‚</p></li><li><p>IDAå’ŒXDbgçš„æ•ˆæœå›¾ï¼š</p><p><img src="/../images/image-20250802131116428.png" alt="IDAæ•ˆæœå›¾"></p><p><img src="/../images/image-20250802131150198.png" alt="XDbgæ•ˆæœå›¾"></p><p>å¯ä»¥çœ‹åˆ°æ˜æ˜¾çš„IsDebuggerPresentå­—æ ·ã€‚</p></li><li><p>åº”å¯¹æ–¹æ³•ï¼š</p><p>åœ¨XDbgä¸­å¼€å¯scyllahideæ’ä»¶æˆ–è€…åœ¨TEST EAX,EAXåæ”¹å˜ä¸€ä¸‹ZFå°±å¯ä»¥äº†</p></li></ul><h3 id="CheckRemoteDebuggerPresent"><a href="#CheckRemoteDebuggerPresent" class="headerlink" title="CheckRemoteDebuggerPresent"></a>CheckRemoteDebuggerPresent</h3><ul><li><p>åŸç†ï¼š</p><p>å‡½æ•°åŸå‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c">BOOL WINAPI <span class="hljs-title function_">CheckRemoteDebuggerPresent</span><span class="hljs-params">(</span><br><span class="hljs-params">InHANDLE hProcess,<span class="hljs-comment">//å‚æ•°1ï¼Œä¸€ä¸ªè¿›ç¨‹å¥æŸ„ï¼Œä¼ å…¥å½“å‰è¿›ç¨‹å¥æŸ„å°±æ˜¯checklocaläº†</span></span><br><span class="hljs-params">InoutPBOOL pbDebuggerPresent<span class="hljs-comment">//å‚æ•°2ï¼Œä¸€ä¸ªç”¨æ¥ä¼ é€’çš„å¸ƒå°”å€¼ï¼Œç”¨æ¥è¡¨ç¤ºæ˜¯å¦è¢«è°ƒè¯•</span></span><br><span class="hljs-params">)</span>;<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªå‡½æ•°å®é™…ä¸Šæ˜¯å€Ÿç”¨äº†NtQueryInfomationProcesså‡½æ•°æ¥å®ç°è°ƒè¯•æ£€æµ‹çš„ï¼Œç®€å•è®²å°±æ˜¯é€šè¿‡NtQueryInformationProcessæŸ¥è¯¢ä¸€ä¸ªæ•°æ®ç„¶åå’Œéè°ƒè¯•çŠ¶æ€ä¸‹è¿™ä¸ªæ•°æ®é¢„æœŸçš„å€¼è¿›è¡Œæ¯”è¾ƒï¼Œæ¯”è¾ƒç»“æœå†ä¼ ç»™è‡ªå·±çš„å‚æ•°2ã€‚æ›´è¯¦ç»†çš„åŸç†è§ä¸‹ä¸€ä¸ªAPI</p></li><li><p>æ•ˆæœå›¾ï¼š</p><p><img src="/../images/image-20250802151411075.png" alt="IDAæ•ˆæœå›¾"></p><p><img src="/../images/image-20250802151613861.png" alt="xdbgæ•ˆæœ"></p></li><li><p>åº”å¯¹æ–¹æ³•ï¼š</p><p>scyllahideä¾æ—§ç®¡ç”¨ï¼Œä¹Ÿå¯ä»¥åœ¨call CheckRemoteDebuggerPresentä¸‹é¢çš„cmpåæ”¹å˜zfæ¥å®ç°ååè°ƒè¯•</p></li></ul><h3 id="NtQueryInformationProcess"><a href="#NtQueryInformationProcess" class="headerlink" title="NtQueryInformationProcess"></a>NtQueryInformationProcess</h3><ul><li><p>åŸç†ï¼š</p><p>å‡½æ•°åŸå‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs c">__kernel_entry NTSTATUS <span class="hljs-title function_">NtQueryInformationProcess</span><span class="hljs-params">(</span><br><span class="hljs-params">    IN HANDLE           ProcessHandle,<span class="hljs-comment">//è¦æŸ¥è¯¢çš„è¿›ç¨‹å¥æŸ„</span></span><br><span class="hljs-params">    IN PROCESSINFOCLASS ProcessInformationClass,<span class="hljs-comment">//è¦æŸ¥è¯¢çš„ä¿¡æ¯ç±»å‹</span></span><br><span class="hljs-params">    OUT PVOID           ProcessInformation,<span class="hljs-comment">//æ¥æ”¶æŸ¥è¯¢ç»“æœçš„ç¼“å†²åŒºï¼ˆå˜é‡ï¼‰</span></span><br><span class="hljs-params">    IN ULONG            ProcessInformationLength,<span class="hljs-comment">//ç¼“å†²åŒºå¤§å°</span></span><br><span class="hljs-params">    OUT PULONG          ReturnLength OPTIONAL<span class="hljs-comment">//å®é™…è¿”å›çš„æ•°æ®å¤§å°ï¼Œå¯é€‰</span></span><br><span class="hljs-params">)</span>;<br></code></pre></td></tr></table></figure><p>é€šè¿‡è®¾ç½®ç¬¬äºŒä¸ªå‚æ•°ä¸º0x7ï¼ˆè¡¨ç¤ºæŸ¥è¯¢ä¸€ä¸ªå«ProcessDebugPortçš„å˜é‡ï¼‰ï¼Œå‡½æ•°ä¼šé€šè¿‡ç¬¬ä¸‰ä¸ªå‚æ•°ä¼ é€’è°ƒè¯•ä¿¡æ¯ï¼Œè¢«è°ƒè¯•åˆ™ä¼ é€’<strong>é</strong>0</p><p>æˆ–è€…è®¾ç½®ç¬¬äºŒä¸ªå‚æ•°ä¸º0x1Eï¼ˆè¡¨ç¤ºæŸ¥è¯¢ä¸€ä¸ªå«ProcessDebugObjectHandleçš„å˜é‡ï¼‰ï¼Œè¢«è°ƒè¯•åˆ™ä¼ é€’<strong>é</strong>NULL</p><p>æˆ–è€…è®¾ç½®ç¬¬äºŒä¸ªå‚æ•°ä¸º0x1Fï¼ˆè¡¨ç¤ºæŸ¥è¯¢ä¸€ä¸ªå«ProcessDebugFlagsçš„å˜é‡ï¼‰ï¼Œè¢«è°ƒè¯•åˆ™ä¼ é€’0</p><p>åŸå‹æ˜¯è¿™æ ·ï¼Œä½†æ˜¯è¿™ä¸ªå‡½æ•°æ˜¯Windowså†…éƒ¨APIï¼Œå³ç³»ç»Ÿä¸æƒ³ç”¨æˆ·ä½¿ç”¨è¿™ä¸ªå‡½æ•°ï¼ˆå¯èƒ½æ˜¯å‡ºäºå®‰å…¨è€ƒè™‘ï¼‰ï¼Œæ‰€ä»¥ç›´æ¥è°ƒç”¨æ˜¯ä¸è¡Œçš„ï¼Œè¦åŠ¨æ€åŠ è½½ã€‚ä¸‹é¢æ˜¯DSç»™çš„å®ç°æºç å‚è€ƒï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs C"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;windows.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><br><span class="hljs-comment">// 1. å®šä¹‰å‡½æ•°æŒ‡é’ˆç±»å‹ï¼ˆå¿…é¡»æ‰‹åŠ¨å£°æ˜ï¼‰</span><br><span class="hljs-keyword">typedef</span> LONG NTSTATUS;<br><span class="hljs-keyword">typedef</span> <span class="hljs-title function_">NTSTATUS</span> <span class="hljs-params">(NTAPI* PNtQueryInformationProcess)</span><span class="hljs-params">(</span><br><span class="hljs-params">    HANDLE ProcessHandle,</span><br><span class="hljs-params">    <span class="hljs-type">int</span> ProcessInformationClass,  <span class="hljs-comment">// ç›´æ¥ä½¿ç”¨ int ä»£æ›¿ PROCESSINFOCLASS</span></span><br><span class="hljs-params">    PVOID ProcessInformation,</span><br><span class="hljs-params">    ULONG ProcessInformationLength,</span><br><span class="hljs-params">    PULONG ReturnLength</span><br><span class="hljs-params">)</span>;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-comment">// 2. åŠ¨æ€åŠ è½½ ntdll.dll</span><br>    HMODULE hNtdll = GetModuleHandleW(<span class="hljs-string">L&quot;ntdll.dll&quot;</span>);<br>    <span class="hljs-keyword">if</span> (!hNtdll) &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;hello\n&quot;</span>);<br>        system(<span class="hljs-string">&quot;pause&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-comment">// 3. è·å– NtQueryInformationProcess å‡½æ•°åœ°å€</span><br>    PNtQueryInformationProcess NtQueryInformationProcess = <br>        (PNtQueryInformationProcess)GetProcAddress(hNtdll, <span class="hljs-string">&quot;NtQueryInformationProcess&quot;</span>);<br>    <span class="hljs-keyword">if</span> (!NtQueryInformationProcess) &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;hello\n&quot;</span>);<br>        system(<span class="hljs-string">&quot;pause&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-comment">// 4. è°ƒç”¨å‡½æ•°æŸ¥è¯¢è°ƒè¯•ç«¯å£ï¼ˆ0x7 = ProcessDebugPortï¼‰</span><br>    DWORD debugPort = <span class="hljs-number">0</span>;<br>    NTSTATUS status = NtQueryInformationProcess(<br>        GetCurrentProcess(),<br>        <span class="hljs-number">0x7</span>,  <span class="hljs-comment">// ProcessDebugPort</span><br>        &amp;debugPort,<br>        <span class="hljs-keyword">sizeof</span>(debugPort),<br>        <span class="hljs-literal">NULL</span><br>    );<br><br>    <span class="hljs-comment">// 5. ä¸¥æ ¼æŒ‰ç…§ä½ çš„é€»è¾‘è¾“å‡º</span><br>    <span class="hljs-keyword">if</span> (debugPort)<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;bye\n&quot;</span>);<br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;hello\n&quot;</span>);<br><br>    system(<span class="hljs-string">&quot;pause&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸‹é¢æ˜¯IDAçš„åæ±‡ç¼–ç»“æœ</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-symbol">.text:</span>000000014007E130 sub_14007E130   proc <span class="hljs-built_in">near</span>               <span class="hljs-comment">; CODE XREF: sub_14007920Bâ†‘j</span><br><span class="hljs-symbol">.text:</span>000000014007E130                                         <span class="hljs-comment">; DATA XREF: .pdata:00000001401AB818â†“o</span><br><span class="hljs-symbol">.text:</span>000000014007E130<br><span class="hljs-symbol">.text:</span>000000014007E130 var_180         = <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">180h</span><br><span class="hljs-symbol">.text:</span>000000014007E130 var_160         = <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">160h</span><br><span class="hljs-symbol">.text:</span>000000014007E130 var_150         = <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">150h</span><br><span class="hljs-symbol">.text:</span>000000014007E130 hModule         = <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">148h</span><br><span class="hljs-symbol">.text:</span>000000014007E130 var_128         = <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">128h</span><br><span class="hljs-symbol">.text:</span>000000014007E130 var_10C         = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">10Ch</span><br><span class="hljs-symbol">.text:</span>000000014007E130 var_EC          = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">0ECh</span><br><span class="hljs-symbol">.text:</span>000000014007E130 var_18          = <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">18h</span><br><span class="hljs-symbol">.text:</span>000000014007E130<br><span class="hljs-symbol">.text:</span>000000014007E130 <span class="hljs-comment">; __unwind &#123; // j___GSHandlerCheck</span><br><span class="hljs-symbol">.text:</span>000000014007E130                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">rbp</span><br><span class="hljs-symbol">.text:</span>000000014007E132                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">rdi</span><br><span class="hljs-symbol">.text:</span>000000014007E133                 <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">rsp</span>, <span class="hljs-number">178h</span><br><span class="hljs-symbol">.text:</span>000000014007E13A                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rbp</span>, [<span class="hljs-built_in">rsp</span>+<span class="hljs-number">30h</span>]<br><span class="hljs-symbol">.text:</span>000000014007E13F                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rdi</span>, [<span class="hljs-built_in">rsp</span>+<span class="hljs-number">180h</span>+var_150]<br><span class="hljs-symbol">.text:</span>000000014007E144                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-number">22h</span> <span class="hljs-comment">; &#x27;&quot;&#x27;</span><br><span class="hljs-symbol">.text:</span>000000014007E149                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">0CCCCCCCCh</span><br><span class="hljs-symbol">.text:</span>000000014007E14E                 <span class="hljs-keyword">rep</span> <span class="hljs-keyword">stosd</span><br><span class="hljs-symbol">.text:</span>000000014007E150                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">cs</span>:__security_cookie<br><span class="hljs-symbol">.text:</span>000000014007E157                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">rbp</span><br><span class="hljs-symbol">.text:</span>000000014007E15A                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">rbp</span>+<span class="hljs-number">150h</span>+var_18], <span class="hljs-built_in">rax</span><br><span class="hljs-symbol">.text:</span>000000014007E161                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rcx</span>, unk_1401B80A2<br><span class="hljs-symbol">.text:</span>000000014007E168                 <span class="hljs-keyword">call</span>    sub_14007A313<br><span class="hljs-symbol">.text:</span>000000014007E16D                 <span class="hljs-keyword">nop</span><br><span class="hljs-symbol">.text:</span>000000014007E16E                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rcx</span>, ModuleName <span class="hljs-comment">; &quot;ntdll.dll&quot;</span><br><span class="hljs-symbol">.text:</span>000000014007E175                 <span class="hljs-keyword">call</span>    <span class="hljs-built_in">cs</span>:GetModuleHandleW<span class="hljs-comment">;æ­¤å¤„åŠ è½½ntdllåº“</span><br><span class="hljs-symbol">.text:</span>000000014007E17B                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">rbp</span>+<span class="hljs-number">150h</span>+hModule], <span class="hljs-built_in">rax</span><br><span class="hljs-symbol">.text:</span>000000014007E17F                 <span class="hljs-keyword">cmp</span>     [<span class="hljs-built_in">rbp</span>+<span class="hljs-number">150h</span>+hModule], <span class="hljs-number">0</span><br><span class="hljs-symbol">.text:</span>000000014007E184                 <span class="hljs-keyword">jnz</span>     short loc_14007E1A7<br><span class="hljs-symbol">.text:</span>000000014007E186                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rcx</span>, aHello     <span class="hljs-comment">; &quot;hello\n&quot;</span><br><span class="hljs-symbol">.text:</span>000000014007E18D                 <span class="hljs-keyword">call</span>    sub_14007886F<br><span class="hljs-symbol">.text:</span>000000014007E192                 <span class="hljs-keyword">nop</span><br><span class="hljs-symbol">.text:</span>000000014007E193                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rcx</span>, aPause     <span class="hljs-comment">; &quot;pause&quot;</span><br><span class="hljs-symbol">.text:</span>000000014007E19A                 <span class="hljs-keyword">call</span>    sub_140078810<br><span class="hljs-symbol">.text:</span>000000014007E19F                 <span class="hljs-keyword">nop</span><br><span class="hljs-symbol">.text:</span>000000014007E1A0                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>000000014007E1A2                 <span class="hljs-keyword">jmp</span>     loc_14007E240<br><span class="hljs-symbol">.text:</span>000000014007E1A7 <span class="hljs-comment">; ---------------------------------------------------------------------------</span><br><span class="hljs-symbol">.text:</span>000000014007E1A7<br><span class="hljs-symbol">.text:</span>000000014007E1A7 loc_14007E1A7:                          <span class="hljs-comment">; CODE XREF: sub_14007E130+54â†‘j</span><br><span class="hljs-symbol">.text:</span>000000014007E1A7                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rdx</span>, ProcName   <span class="hljs-comment">; &quot;NtQueryInformationProcess&quot;</span><br><span class="hljs-symbol">.text:</span>000000014007E1AE                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rcx</span>, [<span class="hljs-built_in">rbp</span>+<span class="hljs-number">150h</span>+hModule] <span class="hljs-comment">; hModule</span><br><span class="hljs-symbol">.text:</span>000000014007E1B2                 <span class="hljs-keyword">call</span>    <span class="hljs-built_in">cs</span>:GetProcAddress<span class="hljs-comment">;æ­¤å¤„è·å–NtQueryInformationProcesså‡½æ•°åœ°å€</span><br><span class="hljs-symbol">.text:</span>000000014007E1B8                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">rbp</span>+<span class="hljs-number">150h</span>+var_128], <span class="hljs-built_in">rax</span><span class="hljs-comment">;æ­¤å¤„æŠŠå‡½æ•°åœ°å€ä¼ ç»™å±€éƒ¨å˜é‡</span><br><span class="hljs-symbol">.text:</span>000000014007E1BC                 <span class="hljs-keyword">cmp</span>     [<span class="hljs-built_in">rbp</span>+<span class="hljs-number">150h</span>+var_128], <span class="hljs-number">0</span><br><span class="hljs-symbol">.text:</span>000000014007E1C1                 <span class="hljs-keyword">jnz</span>     short loc_14007E1E1<br><span class="hljs-symbol">.text:</span>000000014007E1C3                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rcx</span>, aHello     <span class="hljs-comment">; &quot;hello\n&quot;</span><br><span class="hljs-symbol">.text:</span>000000014007E1CA                 <span class="hljs-keyword">call</span>    sub_14007886F<br><span class="hljs-symbol">.text:</span>000000014007E1CF                 <span class="hljs-keyword">nop</span><br><span class="hljs-symbol">.text:</span>000000014007E1D0                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rcx</span>, aPause     <span class="hljs-comment">; &quot;pause&quot;</span><br><span class="hljs-symbol">.text:</span>000000014007E1D7                 <span class="hljs-keyword">call</span>    sub_140078810<br><span class="hljs-symbol">.text:</span>000000014007E1DC                 <span class="hljs-keyword">nop</span><br><span class="hljs-symbol">.text:</span>000000014007E1DD                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>000000014007E1DF                 <span class="hljs-keyword">jmp</span>     short loc_14007E240<br><span class="hljs-symbol">.text:</span>000000014007E1E1 <span class="hljs-comment">; ---------------------------------------------------------------------------</span><br><span class="hljs-symbol">.text:</span>000000014007E1E1<br><span class="hljs-symbol">.text:</span>000000014007E1E1 loc_14007E1E1:                          <span class="hljs-comment">; CODE XREF: sub_14007E130+91â†‘j</span><br><span class="hljs-symbol">.text:</span>000000014007E1E1                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">rbp</span>+<span class="hljs-number">150h</span>+var_10C], <span class="hljs-number">0</span><br><span class="hljs-symbol">.text:</span>000000014007E1E8                 <span class="hljs-keyword">call</span>    <span class="hljs-built_in">cs</span>:GetCurrentProcess<br><span class="hljs-symbol">.text:</span>000000014007E1EE                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">rsp</span>+<span class="hljs-number">180h</span>+var_160], <span class="hljs-number">0</span><br><span class="hljs-symbol">.text:</span>000000014007E1F7                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">r9d</span>, <span class="hljs-number">4</span><span class="hljs-comment">;ç¼“å†²åŒºå¤§å°</span><br><span class="hljs-symbol">.text:</span>000000014007E1FD                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">r8</span>, [<span class="hljs-built_in">rbp</span>+<span class="hljs-number">150h</span>+var_10C]<span class="hljs-comment">;æ¥æ”¶ç»“æœçš„ç¼“å†²åŒº</span><br><span class="hljs-symbol">.text:</span>000000014007E201                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">edx</span>, <span class="hljs-number">7</span><span class="hljs-comment">;æŒ‡å®šæŸ¥è¯¢çš„ä¿¡æ¯ç±»å‹</span><br><span class="hljs-symbol">.text:</span>000000014007E206                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rcx</span>, <span class="hljs-built_in">rax</span><span class="hljs-comment">;æŸ¥è¯¢çš„è¿›ç¨‹å¥æŸ„</span><br><span class="hljs-symbol">.text:</span>000000014007E209                 <span class="hljs-keyword">call</span>    [<span class="hljs-built_in">rbp</span>+<span class="hljs-number">150h</span>+var_128]<span class="hljs-comment">;è°ƒç”¨NtQueryInformationProcess</span><br><span class="hljs-symbol">.text:</span>000000014007E20C                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">rbp</span>+<span class="hljs-number">150h</span>+var_EC], <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>000000014007E20F                 <span class="hljs-keyword">cmp</span>     [<span class="hljs-built_in">rbp</span>+<span class="hljs-number">150h</span>+var_10C], <span class="hljs-number">0</span><br><span class="hljs-symbol">.text:</span>000000014007E213                 <span class="hljs-keyword">jz</span>      short loc_14007E224<br><span class="hljs-symbol">.text:</span>000000014007E215                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rcx</span>, aBye       <span class="hljs-comment">; &quot;bye\n&quot;</span><br><span class="hljs-symbol">.text:</span>000000014007E21C                 <span class="hljs-keyword">call</span>    sub_14007886F<br><span class="hljs-symbol">.text:</span>000000014007E221                 <span class="hljs-keyword">nop</span><br><span class="hljs-symbol">.text:</span>000000014007E222                 <span class="hljs-keyword">jmp</span>     short loc_14007E231<br><span class="hljs-symbol">.text:</span>000000014007E224 <span class="hljs-comment">; ---------------------------------------------------------------------------</span><br><span class="hljs-symbol">.text:</span>000000014007E224<br><span class="hljs-symbol">.text:</span>000000014007E224 loc_14007E224:                          <span class="hljs-comment">; CODE XREF: sub_14007E130+E3â†‘j</span><br><span class="hljs-symbol">.text:</span>000000014007E224                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rcx</span>, aHello     <span class="hljs-comment">; &quot;hello\n&quot;</span><br><span class="hljs-symbol">.text:</span>000000014007E22B                 <span class="hljs-keyword">call</span>    sub_14007886F<br><span class="hljs-symbol">.text:</span>000000014007E230                 <span class="hljs-keyword">nop</span><br><span class="hljs-symbol">.text:</span>000000014007E231<br><span class="hljs-symbol">.text:</span>000000014007E231 loc_14007E231:                          <span class="hljs-comment">; CODE XREF: sub_14007E130+F2â†‘j</span><br><span class="hljs-symbol">.text:</span>000000014007E231                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rcx</span>, aPause     <span class="hljs-comment">; &quot;pause&quot;</span><br><span class="hljs-symbol">.text:</span>000000014007E238                 <span class="hljs-keyword">call</span>    sub_140078810<br><span class="hljs-symbol">.text:</span>000000014007E23D                 <span class="hljs-keyword">nop</span><br><span class="hljs-symbol">.text:</span>000000014007E23E                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>000000014007E240<br><span class="hljs-symbol">.text:</span>000000014007E240 loc_14007E240:                          <span class="hljs-comment">; CODE XREF: sub_14007E130+72â†‘j</span><br><span class="hljs-symbol">.text:</span>000000014007E240                                         <span class="hljs-comment">; sub_14007E130+AFâ†‘j</span><br><span class="hljs-symbol">.text:</span>000000014007E240                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rdi</span>, <span class="hljs-built_in">rax</span><br><span class="hljs-symbol">.text:</span>000000014007E243                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rcx</span>, [<span class="hljs-built_in">rbp</span>+<span class="hljs-number">150h</span>+var_180]<br><span class="hljs-symbol">.text:</span>000000014007E247                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rdx</span>, unk_140171FF0<br><span class="hljs-symbol">.text:</span>000000014007E24E                 <span class="hljs-keyword">call</span>    sub_140079A35<br><span class="hljs-symbol">.text:</span>000000014007E253                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">rdi</span><br><span class="hljs-symbol">.text:</span>000000014007E256                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rcx</span>, [<span class="hljs-built_in">rbp</span>+<span class="hljs-number">150h</span>+var_18]<br><span class="hljs-symbol">.text:</span>000000014007E25D                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">rcx</span>, <span class="hljs-built_in">rbp</span>        <span class="hljs-comment">; StackCookie</span><br><span class="hljs-symbol">.text:</span>000000014007E260                 <span class="hljs-keyword">call</span>    j___security_check_cookie<br><span class="hljs-symbol">.text:</span>000000014007E265                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rsp</span>, [<span class="hljs-built_in">rbp</span>+<span class="hljs-number">148h</span>]<br><span class="hljs-symbol">.text:</span>000000014007E26C                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">rdi</span><br><span class="hljs-symbol">.text:</span>000000014007E26D                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">rbp</span><br><span class="hljs-symbol">.text:</span>000000014007E26E                 <span class="hljs-keyword">retn</span><br><span class="hljs-symbol">.text:</span>000000014007E26E <span class="hljs-comment">; &#125; // starts at 14007E130</span><br><span class="hljs-symbol">.text:</span>000000014007E26E sub_14007E130   endp<br><span class="hljs-symbol">.text:</span>000000014007E26E<br></code></pre></td></tr></table></figure><p>ç‰¹å¾åº”è¯¥æ˜¯ call    cs:GetModuleHandleWã€call    cs:GetProcAddressã€ call    cs:GetCurrentProcess</p></li><li><p>åº”å¯¹æ–¹æ³•ï¼š</p><p>scyllahideä¹Ÿæ˜¯æ”¯æŒåNtQueryInformationProcessåè°ƒè¯•çš„ï¼Œæ‰‹åŠ¨ç»•è¿‡ä¸€èˆ¬æ˜¯æ›´æ”¹ç¼“å†²åŒºçš„å€¼ä¸æ ‡å‡†å€¼çš„æ¯”è¾ƒç»“æœï¼Œå½“ç„¶åœ¨DSç»™çš„æºç ä¸­å› ä¸ºåŠ å…¥äº†ä¸€äº›é”™è¯¯å¤„ç†ï¼ˆå¦‚ntdllè½½å…¥å¤±è´¥å°±è·³è¿‡åè°ƒè¯•ï¼‰ï¼Œå¯ä»¥é€šè¿‡äººä¸ºæ”¹åŠ¨é”™è¯¯åˆ¤æ–­çš„ç»“æœæ¥å®ç°ç›´æ¥è·³è¿‡åè°ƒè¯•</p></li></ul><h3 id="GetLastError"><a href="#GetLastError" class="headerlink" title="GetLastError"></a>GetLastError</h3><ul><li><p>è¿™ä¸ªå‡½æ•°ç”¨äºè·å–æœ€è¿‘ä¸€æ¬¡å¼‚å¸¸çš„è¿”å›å€¼ã€‚ä½¿ç”¨çš„æ–¹æ³•ä¸€èˆ¬æ˜¯æ•…æ„æ„é€ å¼‚å¸¸ï¼Œå¦‚æœå¤„äºè¢«è°ƒè¯•çŠ¶æ€ï¼Œè°ƒè¯•å™¨ä¼šæ•è·å¼‚å¸¸å¯¼è‡´è¿”å›çš„é”™è¯¯ç å’Œé¢„æœŸçš„ä¸ç¬¦ã€‚</p></li><li><p>æ•ˆæœï¼š</p><p><img src="/../images/image-20250802173635007.png" alt="IDA"></p><p><img src="/../images/image-20250802173655097.png" alt="XDbg"></p></li><li><p>åº”å¯¹æ–¹æ³•ï¼š</p><p>å¯ä»¥çœ‹åˆ°ï¼ŒGetLastErrorä¹‹åï¼Œä¼šæŠŠè¿”å›å€¼å’Œé¢„è®¾çš„å€¼è¿›è¡Œæ¯”è¾ƒï¼Œæ‰€ä»¥ä¿®æ”¹cmpåçš„zfå°±å¯ä»¥äº†ã€‚ç”±äºGetLastErrorçš„è‡ªç”±åº¦æ¯”è¾ƒé«˜ï¼ˆè§¦å‘å¼‚å¸¸çš„æ–¹æ³•å¤šæ ·ï¼‰ï¼Œæ‰€ä»¥scyllahideåº”è¯¥æ˜¯ä¸æ”¯æŒçš„ï¼ˆç¬”è€…æ²¡æœ‰è®¤å‡ºä»€ä¹ˆç›¸å…³çš„è®¾ç½®ï¼‰</p></li></ul><h2 id="æ•°æ®æ£€æµ‹"><a href="#æ•°æ®æ£€æµ‹" class="headerlink" title="æ•°æ®æ£€æµ‹"></a>æ•°æ®æ£€æµ‹</h2><h3 id="BeingDebugged"><a href="#BeingDebugged" class="headerlink" title="BeingDebugged"></a>BeingDebugged</h3><ul><li><p>BeingDebuggedæ˜¯PEBçš„æˆå‘˜å˜é‡ä¹‹ä¸€ï¼Œç”¨äºæè¿°è¿›ç¨‹æ˜¯å¦å¤„äºè¢«è°ƒè¯•çŠ¶æ€ï¼Œä¸º1æ—¶è¡¨ç¤ºå¤„äºè¢«è°ƒè¯•çŠ¶æ€ã€‚</p><p>PEBç»“æ„ä½“å…·ä½“å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs C"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">PEB</span> &#123;</span><br>  BYTE                          Reserved1[<span class="hljs-number">2</span>];<br>  BYTE                          BeingDebugged;<span class="hljs-comment">//åç§»ä¸º2</span><br>  BYTE                          Reserved2[<span class="hljs-number">1</span>];<br>  PVOID                         Reserved3[<span class="hljs-number">2</span>];<br>  PPEB_LDR_DATA                 Ldr;<br>  PRTL_USER_PROCESS_PARAMETERS  ProcessParameters;<br>  PVOID                         Reserved4[<span class="hljs-number">3</span>];<br>  PVOID                         AtlThunkSListPtr;<br>  PVOID                         Reserved5;<br>  ULONG                         Reserved6;<br>  PVOID                         Reserved7;<br>  ULONG                         Reserved8;<br>  ULONG                         AtlThunkSListPtr32;<br>  PVOID                         Reserved9[<span class="hljs-number">45</span>];<br>  BYTE                          Reserved10[<span class="hljs-number">96</span>];<br>  PPS_POST_PROCESS_INIT_ROUTINE PostProcessInitRoutine;<br>  BYTE                          Reserved11[<span class="hljs-number">128</span>];<br>  PVOID                         Reserved12[<span class="hljs-number">1</span>];<br>  ULONG                         SessionId;<br>&#125; PEB, *PPEB;<br></code></pre></td></tr></table></figure></li><li><p>åè°ƒè¯•æ‰‹æ®µé€šå¸¸æ˜¯è®¿é—®è¿›ç¨‹çš„è¯¥å‚æ•°ï¼ˆå¦‚WINAPIçš„IsDebuggerPresent()ï¼‰æ¥åˆ¤æ–­æ˜¯å¦å¤„äºè¢«è°ƒè¯•çŠ¶æ€ã€‚32ä½ä¸‹ï¼ŒPEBç”¨FS:[0x30]è¡¨ç¤ºï¼›64ä½ä¸‹ï¼ŒPEBç”¨FS:[0x60]è¡¨ç¤ºã€‚åŠ ä¸Šåç§»2å°±æ˜¯å¯¹BeingDebuggedçš„è®¿é—®äº†ï¼ˆè¿™å°±æ˜¯è¿™ç§æ–¹æ³•çš„ç‰¹å¾äº†ï¼‰</p></li><li><p>æ•ˆæœå›¾ï¼š</p><p><img src="/../images/image-20250802180316105.png" alt="IDA"></p><p><img src="/../images/image-20250802180438104.png" alt="XDbg"></p></li><li><p>åº”å¯¹æ–¹æ³•ï¼š</p><p>scyllahideå¯ç»•è¿‡ï¼Œæ‰‹åŠ¨ç»•è¿‡åªéœ€è¦åœ¨è®¿é—®æŒ‡ä»¤ä¸‹æ–¹çš„cmpåä¿®æ”¹ZFå³å¯</p></li></ul><h3 id="NTGlobalFlag"><a href="#NTGlobalFlag" class="headerlink" title="NTGlobalFlag"></a>NTGlobalFlag</h3><ul><li><p>NTGlobalFlagä¹Ÿæ˜¯PEBç»“æ„ä½“çš„æˆå‘˜ï¼Œä½†æ˜¯æ˜¯éå…¬å¼€çš„ï¼ˆå› æ­¤ä¸Šæ–‡çš„PEBç»“æ„ä½“å®šä¹‰ä¸­çœ‹ä¸åˆ°ï¼‰ã€‚32ä½ä¸‹ï¼Œå®ƒä½äºPEBåç§»0x68å¤„ï¼Œ64ä½ä¸‹ï¼Œå®ƒä½äºPEBåç§»0xBCå¤„ï¼ˆç‰¹å¾ï¼‰ã€‚å®ƒæœ¬æ˜¯æè¿°è¿›ç¨‹å †ç®¡ç†çš„ï¼Œä½†æ˜¯ç”±äºè°ƒè¯•å™¨ä¸­çš„è¿›ç¨‹åˆ›å»ºå †çš„æ–¹å¼å’Œæ­£å¸¸æƒ…å†µæœ‰æ‰€ä¸åŒï¼Œè¢«è°ƒè¯•æ—¶è¯¥å€¼ä¼šè¢«è®¾ä¸º0x70ï¼ˆåˆä¸€ä¸ªç‰¹å¾ï¼‰ï¼Œå› æ­¤ä¹Ÿè¢«ç”¨æ¥åˆ¤æ–­æ˜¯å¦è¢«è°ƒè¯•</p></li><li><p>æ•ˆæœï¼š</p><p><img src="/../images/image-20250802181920666.png" alt="IDA"></p><p><img src="/../images/image-20250802181950005.png" alt="XDbg"></p></li><li><p>åº”å¯¹æ–¹æ³•ï¼š</p><p>syllahideå¯ä»¥ç»•è¿‡ï¼Œä¹Ÿå¯ä»¥åœ¨ä¸‹é¢çš„æ¯”è¾ƒé€»è¾‘ï¼ˆå› ä¸ºæ˜¯å†…è”æ±‡ç¼–ï¼Œæ‰€ä»¥æ¯”è¾ƒé€»è¾‘çš„å®ç°ä¼šæœ‰ä¸åŒï¼‰åä¿®æ”¹ZFç»•è¿‡</p></li></ul><h2 id="è¿›ç¨‹æ£€æµ‹"><a href="#è¿›ç¨‹æ£€æµ‹" class="headerlink" title="è¿›ç¨‹æ£€æµ‹"></a>è¿›ç¨‹æ£€æµ‹</h2><h3 id="FindWindow"><a href="#FindWindow" class="headerlink" title="FindWindow"></a>FindWindow</h3><ul><li><p>å®é™…ä¸Šæ˜¯çª—å£æ£€æµ‹ï¼Œè¿™ä¸ªå‡½æ•°è·å–çš„æ˜¯è¿›ç¨‹çª—å£çš„ç±»åæˆ–è€…æ ‡ç­¾ï¼Œé€šè¿‡ä¸é¢„æœŸçš„åå­—è¿›è¡Œæ¯”è¾ƒæ¥åˆ¤æ–­æ˜¯å¦å¤„äºè¢«è°ƒè¯•çŠ¶æ€ã€‚ç”±äºä½¿ç”¨çš„æ˜¯ç³»ç»Ÿå‡½æ•°ï¼Œæ‰€ä»¥å®é™…ä¸Šä¹Ÿå±äºWINAPIæ£€æµ‹ï¼Œä½†æ˜¯ä¸é‡è¦ã€‚ç‰¹å¾å’ŒWINAPIæ£€æµ‹ä¸€æ ·ï¼Œä¼šæœ‰æ˜æ˜¾çš„æ ‡è®°</p></li><li><p>æ•ˆæœï¼š</p><p><img src="/../images/image-20250802184919847.png" alt="IDA"></p><p><img src="/../images/image-20250802185121993.png" alt="XDbg"></p></li><li><p>æœ¬ä¾‹çš„ç¨‹åºåˆ›å»ºäº†ä¸€ä¸ªåˆ¤æ–­å‡½æ•°ï¼Œåœ¨ä¸»å‡½æ•°ä¸­æ˜¯å°†è¿”å›å€¼teståæ¥åˆ¤æ–­æ˜¯å¦è¢«è°ƒè¯•çš„ï¼Œæ‰€ä»¥åªéœ€è¦ä¿®æ”¹ä¸»å‡½æ•°ä¸­çš„test eax,eaxåçš„ZFå°±å¯ä»¥å®ç°ç»•è¿‡äº†ã€‚scyllahideåº”è¯¥æ˜¯ä¸æ”¯æŒçš„</p></li></ul><h3 id="çˆ¶è¿›ç¨‹æ£€æµ‹"><a href="#çˆ¶è¿›ç¨‹æ£€æµ‹" class="headerlink" title="çˆ¶è¿›ç¨‹æ£€æµ‹"></a>çˆ¶è¿›ç¨‹æ£€æµ‹</h3><ul><li><p>åŸç†æ˜¯æ­£å¸¸ç¨‹åºåŒå‡»è¿è¡Œçˆ¶è¿›ç¨‹ä¸ºexplorer.exeï¼Œè€Œæ‹–è¿›è°ƒè¯•å™¨æ‰“å¼€çˆ¶è¿›ç¨‹ä¸ºè°ƒè¯•å™¨ï¼Œé€šè¿‡æ¯”è¾ƒè·å¾—çš„çˆ¶è¿›ç¨‹åå’Œé¢„è®¾çš„çˆ¶è¿›ç¨‹åå¯ä»¥åˆ¤æ–­æ˜¯å¦å¤„äºè¢«è°ƒè¯•çŠ¶æ€ã€‚ä¸€èˆ¬ä¼šé€šè¿‡éå†è¿›ç¨‹æˆ–è€…é€šè¿‡NtQueryInfomationProcessæŸ¥è¯¢æ¥å®ç°ã€‚ç‰¹å¾æ˜¯å‡ºç°å¤§é‡å’Œè¿›ç¨‹ç›¸å…³çš„apiï¼Œå¦‚éå†è¿›ç¨‹æ—¶ä¼šè°ƒç”¨CreateToolhelp32Snapshotã€th32ParentProcessIDã€Process32Nextç­‰ï¼ŒNtQueryInfomationProcessæŸ¥è¯¢ä¼šå‡ºç°QueryFullProcessImageNameAæˆ–è€…å…¶ä»–ç›¸å…³å‡½æ•°ä¸è°ƒè¯•å™¨åç§°å­—ç¬¦ä¸²åŒæ—¶å‡ºç°çš„æƒ…å†µ</p></li><li><p>æ•ˆæœï¼š</p><p><img src="/../images/image-20250802200208452.png" alt="IDAæ˜¾å¼ä½“ç°"></p><p><img src="/../images/image-20250802200407372.png" alt="XDbgè·³è½¬è¡¨ä¸­ä½“ç°"></p><p><img src="/../images/image-20250802201532370.png" alt="IDA"></p><p><img src="/../images/image-20250802201557678.png" alt="XDbg"></p></li><li><p>å®æµ‹scyllahideç»•è¿‡ä¸äº†ç¬¬ä¸€ç§æ–¹æ³•ä½†å¯ä»¥ç»•è¿‡ç¬¬äºŒç§æ–¹æ³•ã€‚æ‰‹åŠ¨ç»•è¿‡ä¹Ÿå¯ä»¥ï¼Œä¸»è¦åŸºäºåç»­å¯¹è¿›ç¨‹åçš„åˆ¤æ–­ï¼Œä¿®æ”¹åˆ¤æ–­ç»“æœå³å¯ç»•è¿‡</p></li></ul><h3 id="ç‰¹å¾ç æ£€æµ‹"><a href="#ç‰¹å¾ç æ£€æµ‹" class="headerlink" title="ç‰¹å¾ç æ£€æµ‹"></a>ç‰¹å¾ç æ£€æµ‹</h3><ul><li><p>æœ‰çš„è°ƒè¯•å™¨åœ¨å†…å­˜ä¸­ä¼šæœ‰ç‰¹å¾ç ï¼Œé€šè¿‡éå†è¿›ç¨‹å’Œæœç´¢ç‰¹å¾ç å¯ä»¥åˆ¤æ–­æ˜¯å¦è¢«è°ƒè¯•ã€‚è¿™ç§æƒ…å†µä¼šæ¯”è¾ƒå¤æ‚ï¼Œéš¾ç‚¹åº”è¯¥åœ¨è¯†åˆ«ä¸Šã€‚ä¸€æ–¹é¢å¯ä»¥é€šè¿‡åˆ†ææ˜¯å¦å‡ºç°ç‰¹å¾ç ï¼ˆå¯èƒ½ä¼šæ˜¯å¾ˆæ˜æ˜¾çš„ä¸€è¿ä¸²æ•°å­—åˆå§‹åŒ–ï¼‰ï¼Œå¦ä¸€æ–¹é¢éå†è¿›ç¨‹ä¼šå‡ºç°çˆ¶è¿›ç¨‹æ£€æµ‹ä¸­æåŠçš„apiï¼Œä½†æ˜¯è¿™äº›ä¸€èˆ¬ä¸ä¼šå‡ºç°åœ¨ä¸»å‡½æ•°ä¸­ï¼Œéœ€è¦è·Ÿè¿›å‡½æ•°æŸ¥çœ‹ã€‚</p><p>ç‰¹å¾ç ç¤ºä¾‹ï¼š</p><p><img src="/../images/image-20250802211300649.png" alt="IDA"></p><p><img src="/../images/image-20250802211316100.png" alt="XDbg"></p></li><li><p>scyllahideä¸€èˆ¬ç»•è¿‡ä¸äº†ï¼Œå¯ä»¥åœ¨ä¸»å‡½æ•°æ¶‰åŠåˆ¤æ–­ç»“æœçš„é€»è¾‘ä¸­è¿›è¡Œæ”¹åŠ¨ç»•è¿‡ã€‚</p></li></ul>]]></content>
    
    
    <summary type="html">åè°ƒè¯•åŸºæœ¬åŸç†ã€WINAPIæ£€æµ‹ã€æ•°æ®æ£€æµ‹ã€è¿›ç¨‹æ£€æµ‹</summary>
    
    
    
    <category term="Reverse Engineering" scheme="https://sydzi.github.io/categories/Reverse-Engineering/"/>
    
    
    <category term="CTF" scheme="https://sydzi.github.io/tags/CTF/"/>
    
    <category term="Reverse" scheme="https://sydzi.github.io/tags/Reverse/"/>
    
  </entry>
  
  <entry>
    <title>Day11:èŠ±æŒ‡ä»¤</title>
    <link href="https://sydzi.github.io/2025/07/31/Day11-%E8%8A%B1%E6%8C%87%E4%BB%A4/"/>
    <id>https://sydzi.github.io/2025/07/31/Day11-%E8%8A%B1%E6%8C%87%E4%BB%A4/</id>
    <published>2025-07-31T02:54:49.000Z</published>
    <updated>2025-09-18T03:57:17.978Z</updated>
    
    <content type="html"><![CDATA[<p>èŠ±æŒ‡ä»¤</p><span id="more"></span><h2 id="èŠ±æŒ‡ä»¤"><a href="#èŠ±æŒ‡ä»¤" class="headerlink" title="èŠ±æŒ‡ä»¤"></a>èŠ±æŒ‡ä»¤</h2><ul><li><p>åˆå«åƒåœ¾æŒ‡ä»¤ï¼Œä¸å½±å“ç¨‹åºåŸå§‹é€»è¾‘ï¼Œä½†ä¼šå¹²æ‰°IDAåç¼–è¯‘æˆ–è€…åæ±‡ç¼–ã€‚</p></li><li><p>åŸç†ï¼š</p><p>å› ä¸ºåç¼–è¯‘å™¨å¤šæ˜¯é™æ€åˆ†æçš„ï¼Œä¸ä¼šé€šè¿‡æ‰§è¡Œæ¥åˆ†æé€»è¾‘ï¼Œåªä¼šæ ¹æ®åæ±‡ç¼–å‡ºæ¥çš„æŒ‡ä»¤åˆ†æï¼Œå› æ­¤æœ‰ç©ºå¯ä¹˜ï¼šä¾‹å¦‚å¯ä»¥é€šè¿‡å†…è”æ±‡ç¼–ä¸å®Œæ•´æŒ‡ä»¤ä½†æ˜¯è·³è¿‡ä¸å®Œæ•´æŒ‡ä»¤æ¥æ¨¡ç³ŠæŒ‡ä»¤è¾¹ç•Œã€å†…è”æ±‡ç¼–æ°¸è·³æ°¸ä¸è·³åˆ†æ”¯æ¥è¯¯å¯¼è¿è¡Œé€»è¾‘åˆ†æã€å†…è”æ±‡ç¼–æ— æ„ä¹‰æŒ‡ä»¤è¯¯å¯¼ä¸»è¦é€»è¾‘</p></li><li><p>æ˜¾è‘—ç‰¹å¾æ˜¯å‡ºç°çº¢è‰²è¡Œï¼Œè€Œåº”å¯¹æ–¹æ³•æ˜¯é€‰ä¸­èŠ±æŒ‡ä»¤æ‰€åœ¨çš„åŒºåŸŸæ”¹ä¸ºâ€œnopâ€ï¼ˆç©ºæŒ‡ä»¤ï¼‰</p></li></ul><h3 id="æ’è·³å‹"><a href="#æ’è·³å‹" class="headerlink" title="æ’è·³å‹"></a>æ’è·³å‹</h3><ul><li><p>å®æµ‹IDA9.0.241217ä¸ä¼šæŠ¥çº¢ï¼Œä¹Ÿå°±æ˜¯æ··æ·†å¤±æ•ˆï¼Œæ‰€ä»¥å°±çœ‹çœ‹æºç å§</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs C"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;windows.h&gt;</span></span><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>_asm&#123;<br>xor eax, eax;<br>jz s;<br>add esp, <span class="hljs-number">0x11</span>;<br>s:<br>&#125;;<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;hello\n&quot;</span>);<br>system(<span class="hljs-string">&quot;pause&quot;</span>);<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></li></ul><h3 id="call-retç›¸æ¶ˆå‹"><a href="#call-retç›¸æ¶ˆå‹" class="headerlink" title="call-retç›¸æ¶ˆå‹"></a>call-retç›¸æ¶ˆå‹</h3><ul><li><p>æ¥çœ‹æ•ˆæœ</p><p><img src="/../images/image-20250731203000820.png" alt="æŠ¥çº¢"></p></li><li><p>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨å‡½æ•°ä¸­é—´å‡ºç°äº†sp-analysis failedï¼Œè€Œä¸Šé¢ä¸€æ¡å°±æ˜¯retnï¼Œæ˜æ˜¾ä¸å¯¹ã€‚</p><p>å¾€å‰çœ‹ï¼Œrep stosdåˆå§‹åŒ–åï¼Œcalläº†$+5ï¼Œå³å½“å‰ä½ç½®+5&#x3D;0046308Cï¼Œä¹Ÿå°±æ˜¯ä¸‹ä¸€æ¡çš„add</p><p>ç„¶åç»™espçš„å€¼+7ï¼ˆcallçš„æ—¶å€™push eipå³push 0046308cäº†ï¼‰</p><p>æ­¤æ—¶espå­˜æ”¾å€¼ä¸º0046308c+7&#x3D;00463093ï¼Œæ‰€ä»¥retnæ—¶ä¼špop 00463093ï¼Œç¨‹åºè·³åˆ°00463093</p><p>å¾€ä¸‹çœ‹ï¼Œ00463093æ­£æ˜¯æ²¡è¯†åˆ«å‡ºæ¥çš„ä¸‰ä¸ªæ•°çš„æœ€åä¸€ä¸ªï¼Œä¸‹é¢è¿˜æœ‰ä¸€ä¸ªoffsetæ²¡æœ‰æŒ‡ä»¤ã€‚</p><p>ç¬¬ä¸‰ä¸ªæ•°68hå’Œoffsetç»“åˆåˆšå¥½æ˜¯push offsetï¼Œå¯¹åº”ä¸Šäº†ä¸‹é¢çš„callï¼ˆå‡½æ•°ä¼ å‚ï¼‰</p></li><li><p>é€‰ä¸­æ²¡è¯†åˆ«çš„ä¸‰ä¸ªæ•°ï¼ŒæŒ‰â€œUâ€ï¼ˆundefine)ï¼Œå¯ä»¥çœ‹åˆ°ä¸‰ä¸ªæ•°åˆ†å¼€äº†</p><p><img src="/../images/image-20250731203817109.png" alt="æŒ‰U"></p></li><li><p>é€‰ä¸­db 68hå’Œdd offset aHelloï¼ŒæŒ‰Cè½¬åŒ–ä¸ºæ±‡ç¼–æŒ‡ä»¤ï¼Œå¯ä»¥çœ‹åˆ°push offsetæ¢å¤äº†</p><p><img src="/../images/image-20250731204815374.png" alt="æ¢å¤push"></p></li><li><p>é€‰ä¸­call $+5åˆ°db 34hï¼Œå³é”®é€‰æ‹©â€Fill with NOPsâ€œï¼ˆå®æµ‹db 34hä¼šnopä¸å¹²å‡€ï¼Œè¦é€‰ä¸­åˆ°db 34hä¸‹ä¸€è¡Œï¼‰</p><p><img src="/../images/image-20250731204858702.png" alt="NOP"></p></li><li><p>å¯ä»¥çœ‹åˆ°å‡½æ•°å˜æˆè¿™æ ·ï¼Œè¿™æ˜¯å› ä¸ºæ’å…¥äº†retnå¯¼è‡´å‡½æ•°èŒƒå›´åˆ†æé”™è¯¯ï¼Œéœ€è¦çº æ­£</p><p><img src="/../images/image-20250731205500606.png" alt="NOPå®Œ"></p></li><li><p>ç‚¹å‡»å‡½æ•°åï¼Œç„¶åå³é”®edit fuctionï¼ŒæŠŠend addressæ”¹æˆæœ«å°¾é‚£ä¸ªçœŸæ­£çš„retnçš„åœ°å€å°±OKäº†</p><p><img src="/../images/image-20250731205807130.png" alt="çº æ­£å‡½æ•°èŒƒå›´"></p></li></ul><h3 id="jz-æ“ä½œæ•°ä¸å…¨å‹"><a href="#jz-æ“ä½œæ•°ä¸å…¨å‹" class="headerlink" title="jz-æ“ä½œæ•°ä¸å…¨å‹"></a>jz-æ“ä½œæ•°ä¸å…¨å‹</h3><ul><li><p>è¿™ç§æƒ…å†µä¸‹ä¼šå‡ºç°å’Œä¸Šä¸€ç§ä¸€æ ·çš„æŒ‡ä»¤è¯†åˆ«é”™è¯¯çš„é—®é¢˜ï¼Œä¸”çœ‹å›¾ï¼š</p><p><img src="/../images/image-20250801002342967.png" alt="å›¾"></p></li><li><p>è¿™æ˜¯æŒ‰ç…§MSVS C++åˆå§‹åŒ–è§„åˆ™è·³è½¬åï¼Œåœ¨æœ¬æ¥mainå‡½æ•°çš„åœ°æ–¹çš„æˆªå›¾ã€‚ä½†æ˜¯è·³è½¬è¿‡ç¨‹ä¸­ä¼šå‘ç°ï¼Œè·³è½¬åˆ°mainå‡½æ•°çš„ä»£ç æ˜¯jmp loc_xxxxxxè€Œä¸æ˜¯jmp sub_xxxxxxã€‚ä½†æ˜¯ç›®å‰è¿˜ä¸å½±å“ï¼Œå…ˆåˆ†ææŠ¥é”™çš„åœ°æ–¹ã€‚</p></li><li><p>å¯ä»¥çœ‹åˆ° xor ebp,[eax+50h] å¤„æŠ¥çº¢äº†ï¼Œå¹¶ä¸”ä¸‹é¢æ˜¯ä¸€æ®µæ²¡åˆ†æå‡ºæ¥çš„æ•°å’Œå­—ç¬¦ä¸²â€pauseâ€ï¼Œä¸‹é¢è¿›è¡Œåˆ†æ</p></li><li><p>é¦–å…ˆï¼Œrep stosdåˆå§‹åŒ–åï¼Œè¿›è¡Œäº†ä¸€ä¸ªæ’è·³ï¼Œè·³è½¬çš„åœ°æ–¹æ˜¯0046308Eï¼Œåœ¨ xor ebp,[eax+50h] è¿™æ¡æŒ‡ä»¤é‡Œï¼Œæ‰€ä»¥è¿™é‡Œçº¢äº†</p></li><li><p>æŠŠ xor ebp,[eax+50h] è¿™æ¡æŒ‡ä»¤undefineä¸€ä¸‹</p><p><img src="/../images/image-20250801002409823.png" alt="undefineä¸€ä¸‹"></p></li><li><p>æ ¹æ®é€»è¾‘ï¼Œç¨‹åºæ˜¯è‚¯å®šä¼šè·³åˆ°0046308Eçš„ï¼Œæ‰€ä»¥å‰é¢çš„ä»£ç å†—ä½™ï¼Œç›´æ¥nopæ‰ã€‚é€‰ä¸­ xor eax,eax åˆ°0046308Eï¼ˆæ ¹æ®ä¸Šä¸€ç§ç±»å‹çš„ç»éªŒï¼Œè¦å¤šè¦†ç›–ä¸€ä½æ‰èƒ½åˆšå¥½nopæ‰ç›®æ ‡ä»£ç ï¼‰</p><p><img src="/../images/image-20250801002510740.png" alt="NOP"></p></li><li><p>nopå®Œæˆåï¼ˆå¦‚æœæœ‰db 90hå°±æŒ‰â€Câ€œè½¬æˆcodeï¼‰å°±ä¼šå‘ç°ä¸‹é¢æ²¡åˆ†æçš„æ•°ç«‹åˆ»åˆ†æå‡ºæŒ‡ä»¤äº†</p><p><img src="/../images/image-20250801002536258.png" alt="å»æ··æ·†æˆåŠŸ"></p></li><li><p>ä½†æ˜¯è¿˜æ²¡å®Œï¼Œæ­¤æ—¶æŒ‰F5æ˜¯æ— æ³•åç¼–è¯‘çš„ï¼Œå› ä¸ºæŠ¥é”™çš„åœ°æ–¹æ˜¯loc_xxxxxxèŒƒå›´é‡Œçš„ï¼Œä¸æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯å‰é¢è¯´çš„jmp loc_xxxxxxè€Œä¸æ˜¯jmp sub_xxxxxxçš„é—®é¢˜äº†ã€‚è¿™é‡Œå¯ä»¥çœ‹å‡ºï¼ŒIDAè¿™ç±»æ··æ·†ä¼šå¯¼è‡´IDAæŠŠå‡½æ•°è¯†åˆ«æˆä¸€ä¸ªå¼•ç”¨è€Œä¸æ˜¯å‡½æ•°ã€‚</p></li><li><p>åˆ°æœ€å¼€å§‹push ebpå¼€è¾Ÿæ ˆå¸§çš„å¼•ç”¨loc_463070å¤„ï¼ŒæŠŠå®ƒundefineä¸€ä¸‹ï¼Œå†æŒ‰â€œPâ€é‡æ–°åˆ†æä¸€ä¸‹ï¼Œå°±å¯ä»¥å¾—åˆ°mainå‡½æ•°äº†</p><p><img src="/../images/image-20250801002703125.png" alt="ä¿®å¤çš„mainå‡½æ•°"></p></li><li><p>è¿™ç±»æœ‰ä¸€ä¸ªç‰¹å¾å°±æ˜¯jz loc_xxxxxx+1ï¼Œæ®æ­¤å¯ä»¥å¿«é€Ÿæ‰¾åˆ°åŠ äº†æ··æ·†çš„åœ°æ–¹</p></li></ul><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ul><li>ä¸Šè¿°ä¸‰ç§ï¼ˆå®é™…ä¸Šæœ‰æ··æ·†æ•ˆæœçš„åªæœ‰ä¸¤ç§ï¼‰æ˜¯æ¯”è¾ƒåŸºç¡€çš„èŠ±æŒ‡ä»¤ã€‚è¯†åˆ«èŠ±æŒ‡ä»¤çš„è¦ç‚¹ä¸»è¦æ˜¯çœ‹çº¢è‰²é”™è¯¯ï¼Œä¹Ÿå¯ä»¥ç»“åˆä¸€äº›ç‰¹å¾æ¥è¯†åˆ«ã€‚è§£å†³æ–¹æ³•å°±æ˜¯nopæ‰æ··æ·†ä»£ç ã€‚</li><li>åœ¨å®é™…è®¾è®¡é¢˜ç›®æ—¶ï¼Œç¬”è€…æ„å¤–å‘ç°äº†ä¸€äº›æ›´å¼ºåŠ›çš„æ··æ·†ï¼Œå•å•æ˜¯åœ¨ä¸Šè¿°ä¸‰ç§ç±»å‹çš„åŸºç¡€ä¸ŠåŠ ä¸€ç‚¹å…¶ä»–æŒ‡ä»¤ï¼Œå°±ä¼šå¯¼è‡´ä¸€ä¸ªå‡½æ•°å®Œå…¨æ— æ³•è¢«è¯†åˆ«ï¼ˆè¢«æ”¾åœ¨rdataæ®µè€Œä¸æ˜¯textæ®µçš„é‚£ç§ï¼‰ï¼Œä½†æ˜¯ç¨‹åºè¿˜èƒ½æ­£å¸¸æ‰§è¡Œï¼Œè€ŒæŠ¥é”™çš„åœ°æ–¹åœ¨æ— æ³•è¯†åˆ«çš„å‡½æ•°çš„ä¸Šçº§å‡½æ•°é‡Œï¼ˆè·³è½¬åˆ°è¿™ä¸ªå‡½æ•°çš„é‚£ä¸ªå‡½æ•°ï¼‰ï¼Œå¯èƒ½è¦ç»“åˆAIæ‰èƒ½å®ç°å¿«æ·çš„åˆ†æã€‚å› æ­¤ï¼ŒèŠ±æŒ‡ä»¤è¿˜æ˜¯ä¸€ä¸ªå…·æœ‰æŒ‘æˆ˜æ€§çš„æ··æ·†æ–¹å¼ï¼ˆå½“ç„¶ä¹Ÿå¯èƒ½æ˜¯ç¬”è€…å¤ªèœäº†æ²¡çŸ³ç²’ï¼‰</li></ul>]]></content>
    
    
    <summary type="html">èŠ±æŒ‡ä»¤</summary>
    
    
    
    <category term="Reverse Engineering" scheme="https://sydzi.github.io/categories/Reverse-Engineering/"/>
    
    
    <category term="CTF" scheme="https://sydzi.github.io/tags/CTF/"/>
    
    <category term="Reverse" scheme="https://sydzi.github.io/tags/Reverse/"/>
    
  </entry>
  
  <entry>
    <title>Day10:å£³ä¸è„±å£³ï¼ˆäºŒï¼‰</title>
    <link href="https://sydzi.github.io/2025/07/30/Day10-%E5%A3%B3%E4%B8%8E%E8%84%B1%E5%A3%B3%EF%BC%88%E4%BA%8C%EF%BC%89/"/>
    <id>https://sydzi.github.io/2025/07/30/Day10-%E5%A3%B3%E4%B8%8E%E8%84%B1%E5%A3%B3%EF%BC%88%E4%BA%8C%EF%BC%89/</id>
    <published>2025-07-30T05:13:02.000Z</published>
    <updated>2025-09-18T03:57:12.835Z</updated>
    
    <content type="html"><![CDATA[<p>äºŒæ¬¡æ–­ç‚¹æ³•ã€ä¸€æ¬¡æ–­ç‚¹æ³•ã€ç‰¹å¾æŸ¥æ‰¾æ³•ï¼ˆå‡åŸºäºXdbgï¼‰ã€Dllæ‰‹åŠ¨è„±å£³</p><span id="more"></span><h2 id="å¯»æ‰¾OEPçš„æ–¹æ³•ï¼ˆäºŒï¼‰"><a href="#å¯»æ‰¾OEPçš„æ–¹æ³•ï¼ˆäºŒï¼‰" class="headerlink" title="å¯»æ‰¾OEPçš„æ–¹æ³•ï¼ˆäºŒï¼‰"></a>å¯»æ‰¾OEPçš„æ–¹æ³•ï¼ˆäºŒï¼‰</h2><h3 id="äºŒæ¬¡æ–­ç‚¹æ³•"><a href="#äºŒæ¬¡æ–­ç‚¹æ³•" class="headerlink" title="äºŒæ¬¡æ–­ç‚¹æ³•"></a>äºŒæ¬¡æ–­ç‚¹æ³•</h3><ul><li><p>åˆå«å†…å­˜é•œåƒæ³•ï¼ŒåŸç†æ˜¯å£³ç¨‹åºè§£ææ—¶ä¼šä».rsrcæ®µè·å–èµ„æºï¼Œè§£æåå›åˆ°ä»£ç æ®µï¼Œå› æ­¤å¯ä»¥é€šè¿‡ç°åœ¨.rsrcæ®µè®¾ç½®å†…å­˜è¯»å–æ–­ç‚¹ï¼Œç„¶ååœ¨ä»£ç æ®µ(.text&#x2F;.code)è®¾ç½®å†…å­˜å†™å…¥æ–­ç‚¹æ¥ç›‘æ§å£³ç¨‹åºæ‰§è¡Œã€‚</p></li><li><p>é€šå¸¸è¿™ä¸ªæ–¹æ³•æ˜¯åŸºäºOllyDbgçš„ï¼Œä½†æ˜¯ä»åŸç†å‡ºå‘Xdbgä¹Ÿä¸æ˜¯ä¸èƒ½ç”¨ã€‚é™¤äº†æœ‰ä¸€æ­¥æ˜¯åœ¨OllyDbgä¸­è®¾ç½®å¿½ç•¥æ‰€æœ‰å¼‚å¸¸ï¼ŒXdbgå¥½åƒæ²¡æœ‰è¿™ä¸ªè®¾ç½®é€‰é¡¹ï¼Œä½†æ˜¯ç»è¿‡å®æµ‹æ˜¯å¯ä»¥ç”¨è¿™ä¸ªæ–¹æ³•åœ¨Xdbgè„±upxå£³çš„ã€‚</p></li><li><p>Upxè„±å£³ç¤ºä¾‹ï¼š</p><ul><li><p>Xdbgè½½å…¥ç¨‹åºï¼Œå…ˆåœ¨â€œæ–­ç‚¹â€æ¨¡å—æŠŠé¢„è®¾çš„æ–­ç‚¹åˆ é™¤ï¼Œé¿å…ç¨‹åºåœ¨éå…³æ³¨çš„å¼‚å¸¸å¤„ï¼ˆæ–­ç‚¹å¤„ï¼‰åœä¸‹</p><p><img src="/../images/image-20250730155018782.png" alt="ç§»é™¤æ–­ç‚¹"></p></li><li><p>ç„¶ååˆ°â€œå†…å­˜æ˜ å°„â€æ¨¡å—æ‰¾åˆ°ç¨‹åºçš„.rsrcï¼ˆæ³¨æ„æ‰€å±æ–¹ä¸ºç”¨æˆ·ï¼‰ï¼Œä¸‹ä¸€æ¬¡æ€§å†…å­˜è¯»å–æ–­ç‚¹</p><p><img src="/../images/image-20250730155602928.png" alt="ä¸‹å†…å­˜è¯»å–æ–­ç‚¹"></p></li><li><p>shift+F9è¿è¡Œï¼Œç„¶ååœ¨ä¸Šæ–¹çš„upx0å¤„ä¸‹ä¸€æ¬¡æ€§å†…å­˜å†™å…¥æ–­ç‚¹</p><p><img src="/../images/image-20250730155656485.png" alt="ä¸‹å†…å­˜å†™å…¥æ–­ç‚¹"></p></li><li><p>shift+F9è¿è¡Œï¼Œå›åˆ°â€œCPUâ€æ¨¡å—ï¼Œä¼šå‘ç°ä¸‹æ–¹ä¸è¿œå¤„å°±æœ‰ä¸€ä¸ªå¤§è·³ï¼ˆéš”å¾—æœ‰ç‚¹è¿œæˆªä¸åˆ°eipå’Œå¤§è·³çš„åŒæ¡†å›¾ï¼‰ï¼Œåœ¨å¤§è·³å‰ä¸‹æ–­ç‚¹ï¼ŒF9è¿è¡Œåˆ°æ–­ç‚¹å¤„ï¼Œç„¶åæ­¥è¿›å°±å¯ä»¥åˆ°è¾¾OEPäº†</p></li></ul></li><li><p>ä½†æ˜¯æœ‰ä¸€ç‚¹å¥‡æ€ªçš„åœ°æ–¹ï¼šç»“åˆupxçš„è§£æåŸç†ï¼Œupxå¥½åƒæ˜¯ä»upx1æ®µåŠ è½½æ•°æ®è§£æåˆ°upx0æ®µçš„ï¼ˆAIè¯´çš„ï¼Œä¸ç¡®å®šå¯¹ä¸å¯¹ï¼‰ï¼Œæ‰€ä»¥æŒ‰é“ç†ï¼Œåœ¨upx1å¤„ä¸‹å†…å­˜è¯»å–æ–­ç‚¹ä¸æ˜¯ä¹Ÿæœ‰ç±»ä¼¼çš„ç›‘æ§æ•ˆæœå—ï¼Ÿä½†æ˜¯å®æµ‹è¿™æ ·å­ä¼šè·‘é£ğŸ¤”æœ‰è¿‡ä¸€ä¸ªæƒ³æ³•å°±æ˜¯ï¼Œå› ä¸ºåœ¨upx1æ®µä¸‹äº†è¯»å–æ–­ç‚¹ï¼Œå£³ç¨‹åºè§£æå‰ä¸­æ–­äº†ï¼Œç„¶ååˆåœ¨upx0æ®µä¸‹å†™å…¥æ–­ç‚¹ï¼Œç„¶åæŒ‰é“ç†åº”è¯¥åœåœ¨è§£æç„¶åå†™å…¥è¿™ä¸€æ­¥ï¼Œå°±æ˜¯è§£æäº†è¿˜æ²¡å†™å…¥ï¼Œæˆ–è€…è¯´åˆšåˆšå†™å…¥ä¸€æ¬¡ï¼Œé‚£è¿™æ ·ä¹Ÿä¸è‡³äºç›´æ¥è°ƒè¯•ç»ˆæ­¢å§ğŸ¤”</p></li></ul><h3 id="ä¸€æ¬¡æ–­ç‚¹æ³•ï¼ˆäºŒæ¬¡æ–­ç‚¹æ³•plus"><a href="#ä¸€æ¬¡æ–­ç‚¹æ³•ï¼ˆäºŒæ¬¡æ–­ç‚¹æ³•plus" class="headerlink" title="ä¸€æ¬¡æ–­ç‚¹æ³•ï¼ˆäºŒæ¬¡æ–­ç‚¹æ³•plus)"></a>ä¸€æ¬¡æ–­ç‚¹æ³•ï¼ˆäºŒæ¬¡æ–­ç‚¹æ³•plus)</h3><ul><li><p>è¿™ä¸ªæ–¹æ³•æ˜¯åŸºäºäºŒæ¬¡æ–­ç‚¹æ³•å’Œupxå®æµ‹å‡ºæ¥çš„ï¼Œå› ä¸ºæ ¹æ®å£³ç¨‹åºè§£æçš„åŸç†ï¼Œæœ€ç»ˆéƒ½ä¼šå‘ç”Ÿå‘å†…å­˜å†™å…¥è§£æå®Œçš„æ•°æ®çš„æ“ä½œï¼Œæ‰€ä»¥ç›´æ¥åœ¨å†™å…¥çš„åœ°æ–¹ä¸‹å†…å­˜å†™å…¥æ–­ç‚¹ï¼Œè¿™æ ·è°ƒè¯•å™¨ä¸­æ–­çš„åœ°æ–¹å°±ç¦»OEPä¸è¿œäº†ï¼ˆæ¥è¿‘å£³ç¨‹åºè§£æçš„å°¾å£°ï¼Œä½†è¿˜æ˜¯è¿œåˆ°æˆªä¸åˆ°eipå’Œå¤§è·³çš„åŒæ¡†å›¾ï¼‰</p></li><li><p>ç¤ºä¾‹</p><ul><li><p>é¦–å…ˆï¼ŒåŒæ ·è¦å…ˆå»æ‰é¢„è®¾æ–­ç‚¹</p><p><img src="/../images/image-20250730163429021.png" alt="å»æ‰é¢„è®¾æ–­ç‚¹"></p></li><li><p>ç„¶ååœ¨â€œå†…å­˜æ˜ å°„â€æ¨¡å—ç»™upx0ä¸‹ä¸€æ¬¡æ€§å†…å­˜å†™å…¥æ–­ç‚¹&#x2F;ç»™upx1ä¸‹ä¸€æ¬¡æ€§å†…å­˜è¯»å–æ–­ç‚¹</p><p><img src="/../images/image-20250730164034182.png" alt="ä¸‹å†…å­˜å†™å…¥æ–­ç‚¹"></p></li><li><p>shift+F9è¿è¡Œï¼Œä¸­æ–­çš„åœ°æ–¹å°±å·®ä¸å¤šæ˜¯å£³ç¨‹åºè§£æå†™å…¥&#x2F;å¼€å§‹è§£æçš„åœ°æ–¹äº†ï¼Œåœ¨ä¸‹æ–¹å¤§è·³å‰F2æ–­ç‚¹+F9è¿è¡Œä¸€æ­¥åˆ°ä½ï¼Œç„¶åå°±å¯ä»¥è·³è½¬åˆ°OEPäº†</p></li></ul></li></ul><h3 id="ç‰¹å¾æŸ¥æ‰¾æ³•"><a href="#ç‰¹å¾æŸ¥æ‰¾æ³•" class="headerlink" title="ç‰¹å¾æŸ¥æ‰¾æ³•"></a>ç‰¹å¾æŸ¥æ‰¾æ³•</h3><ul><li><p>å€ŸåŠ©ç‰¹å¾æŒ‡ä»¤popadï¼Œåœ¨ç¨‹åºåŒºåŸŸæœç´¢æŒ‡ä»¤ï¼Œç„¶åä¸‹æ–­ç‚¹è¿è¡Œè‡³æ­¤ï¼Œå†æ¥ç€è¿è¡Œåˆ°OEPå¤„</p></li><li><p>ç¤ºä¾‹ï¼š</p><ul><li><p>F9è¿è¡Œåˆ°ç¨‹åºåŒºåŸŸï¼Œæ­¤æ—¶æ–­åœ¨pushad</p><p><img src="/../images/image-20250730165414432.png" alt="F9è¿è¡Œ"></p></li><li><p>å³é”®åœ¨å½“å‰åŒºåŸŸæœç´¢å‘½ä»¤popad</p><p><img src="/../images/image-20250730165457171.png" alt="æœç´¢"></p></li><li><p>åŒå‡»æœç´¢ç»“æœè·³è½¬ï¼Œä¸‹æ–¹ä¸è¿œå¤„å°±æ˜¯åˆ°OEPçš„å¤§è·³äº†ã€‚ç›´æ¥åœ¨jmpå‰ä¸€æ¡æŒ‡ä»¤ä¸‹æ–­ç‚¹ï¼ŒF9åˆ°æ­¤ï¼Œç„¶åæ­¥è¿›</p><p><img src="/../images/image-20250730165636809.png" alt="æœç´¢ç»“æœ"></p></li></ul></li></ul><h2 id="Dllæ‰‹åŠ¨è„±å£³"><a href="#Dllæ‰‹åŠ¨è„±å£³" class="headerlink" title="Dllæ‰‹åŠ¨è„±å£³"></a>Dllæ‰‹åŠ¨è„±å£³</h2><ul><li><p>è‹¥å‡ºç°Dllç¨‹åºåŠ å£³çš„æƒ…å†µï¼Œå¯ä»¥å…ˆæŠŠDllç¨‹åºè½¬åŒ–æˆexeç¨‹åºï¼Œç„¶åä½¿ç”¨å’Œexeæ‰‹åŠ¨è„±å£³ä¸€æ ·çš„æ­¥éª¤å³å¯</p></li><li><p>ç¤ºä¾‹ï¼š</p><ul><li><p>ç”¨DIEæ‰“å¼€Dllç¨‹åºï¼Œå¯ä»¥çœ‹åˆ°æ˜¾ç¤ºåŠ äº†upxå£³</p><p><img src="/../images/image-20250730224157270.png" alt="DIEæŸ¥çœ‹"></p></li><li><p>ç‚¹å‡»â€œåŒºå—â€ä¸‹æ–¹çš„â€œ&gt;â€ï¼Œæ‰“å¼€æ–‡ä»¶ç»“æ„ç•Œé¢</p><p><img src="/../images/image-20250730224231764.png" alt="æ–‡ä»¶ç»“æ„é¡µé¢"></p></li><li><p>å–æ¶ˆå‹¾é€‰å³ä¸Šè§’â€åªè¯»â€œï¼Œç„¶åç‚¹å‡»IMAGE_FILE_HEADERï¼Œå–æ¶ˆå‹¾é€‰â€æ ‡å¿—â€œä¸­çš„â€Dllâ€œï¼ˆå›¾ä¸­æœªå–æ¶ˆï¼‰</p><p><img src="/../images/image-20250730224435928.png" alt="å–æ¶ˆå‹¾é€‰Dll"></p><p>æ­¤æ—¶å¯ä»¥å‘ç°ï¼ŒCharacteristicsçš„å€¼å˜äº†</p></li><li><p>ç„¶åæŠŠdllåç¼€æ”¹æˆexeå°±å¯ä»¥æŒ‰ç…§exeæ‰‹åŠ¨è„±å£³çš„æ­¥éª¤è¿›è¡Œè„±å£³äº†</p></li></ul></li></ul>]]></content>
    
    
    <summary type="html">äºŒæ¬¡æ–­ç‚¹æ³•ã€ä¸€æ¬¡æ–­ç‚¹æ³•ã€ç‰¹å¾æŸ¥æ‰¾æ³•ï¼ˆåŸºäºXdbgï¼‰ã€Dllæ‰‹åŠ¨è„±å£³</summary>
    
    
    
    <category term="Reverse Engineering" scheme="https://sydzi.github.io/categories/Reverse-Engineering/"/>
    
    
    <category term="CTF" scheme="https://sydzi.github.io/tags/CTF/"/>
    
    <category term="Reverse" scheme="https://sydzi.github.io/tags/Reverse/"/>
    
  </entry>
  
  <entry>
    <title>Day9:å£³ä¸è„±å£³ï¼ˆä¸€ï¼‰</title>
    <link href="https://sydzi.github.io/2025/07/29/Day9-%E5%A3%B3/"/>
    <id>https://sydzi.github.io/2025/07/29/Day9-%E5%A3%B3/</id>
    <published>2025-07-29T09:14:04.000Z</published>
    <updated>2025-09-18T03:57:10.874Z</updated>
    
    <content type="html"><![CDATA[<p>å£³ã€å£³çš„åŠ è½½è¿‡ç¨‹ã€å·¥å…·è„±å£³ã€æ‰‹åŠ¨è„±å£³æµç¨‹ã€espå®šå¾‹ï¼ˆåŸºäºXdbgï¼‰</p><span id="more"></span><h2 id="å£³"><a href="#å£³" class="headerlink" title="å£³"></a>å£³</h2><ul><li><p>å…ˆçœ‹ctf-wikiå¯¹å£³çš„ä»‹ç»ï¼š</p><p><strong>å£³</strong> æ˜¯åœ¨ä¸€äº›è®¡ç®—æœºè½¯ä»¶é‡Œä¸€æ®µä¸“é—¨è´Ÿè´£ä¿æŠ¤è½¯ä»¶ä¸è¢«éæ³•ä¿®æ”¹æˆ–åç¼–è¯‘çš„ç¨‹åºã€‚</p><p>å®ƒä»¬ä¸€èˆ¬éƒ½æ˜¯å…ˆäºç¨‹åºè¿è¡Œï¼Œæ‹¿åˆ°æ§åˆ¶æƒï¼Œç„¶åå®Œæˆå®ƒä»¬ä¿æŠ¤è½¯ä»¶çš„ä»»åŠ¡ã€‚</p></li><li><p>å› æ­¤ï¼ŒåŠ å£³ç¨‹åºåŒ…å«å£³ç¨‹åºå’ŒåŸç¨‹åºä¸¤ä¸ªéƒ¨åˆ†ï¼Œä¸”åŸç¨‹åºåœ¨å£³ç¨‹åºè¿è¡Œåæ‰æ¢å¤åˆ°ç‹¬ç«‹å¯æ‰§è¡Œçš„çŠ¶æ€ã€‚å› æ­¤ï¼Œå¯ä»¥å€ŸåŠ©åŠ¨æ€è°ƒè¯•å™¨åœ¨å£³ç¨‹åºè¿è¡Œå®Œåè¿›è¡Œdumpï¼Œä»è€Œè·å¾—ç‹¬ç«‹å¯æ‰§è¡Œçš„åŸç¨‹åº</p></li><li><p>å¸¸è§çš„å£³æœ‰å‹ç¼©å£³å’ŒåŠ å¯†å£³ä¸¤ç§ï¼š</p><p>å‹ç¼©å£³ï¼šupxã€ASpackã€PECompatç­‰</p><p>åŠ å¯†å£³ï¼šVMProtectã€Themidaã€ASProtectorç­‰</p></li></ul><h2 id="å£³çš„åŠ è½½è¿‡ç¨‹"><a href="#å£³çš„åŠ è½½è¿‡ç¨‹" class="headerlink" title="å£³çš„åŠ è½½è¿‡ç¨‹"></a>å£³çš„åŠ è½½è¿‡ç¨‹</h2><ul><li>å£³å’ŒåŸç¨‹åºåœ¨é€»è¾‘ä¸ŠåŸºæœ¬æ²¡æœ‰å…³è”ï¼Œå› æ­¤ï¼Œå£³ç¨‹åºåœ¨è§£æåŠ å£³åçš„äºŒè¿›åˆ¶æ–‡ä»¶å‰ï¼Œä¼šå…ˆä¿å­˜å„å¯„å­˜å™¨çš„å€¼ï¼Œé€šå¸¸ç”¨pushad&#x2F;puahfdå®ç°</li><li>è§£æå®Œæˆåï¼Œæ˜¯åŸç¨‹åºçš„é€»è¾‘éƒ¨åˆ†ï¼Œæ­¤æ—¶ï¼Œå£³ç¨‹åºç»™å‡ºæ§åˆ¶æƒï¼Œå¯„å­˜å™¨æ¢å¤åˆ°è§£æå‰çš„çŠ¶æ€ï¼Œé€šå¸¸ç”¨popad&#x2F;popfdå®ç°</li><li>æœ€åï¼Œç¨‹åºè·³åˆ°åŸç¨‹åºå…¥å£ç‚¹å¼€å§‹æ‰§è¡Œ</li></ul><h2 id="å·¥å…·è„±å£³"><a href="#å·¥å…·è„±å£³" class="headerlink" title="å·¥å…·è„±å£³"></a>å·¥å…·è„±å£³</h2><ul><li><p>ç›´æ¥ä½¿ç”¨å·¥å…·è„±å£³çš„æƒ…å†µä¸»è¦æœ‰ä¸¤ç§ï¼šä¸€ç§æ˜¯æ— ä¿®æ”¹çš„ã€åªä½¿ç”¨åŠ å£³ç¨‹åºåŠ å£³ï¼›å¦ä¸€ç§æ˜¯ä½¿ç”¨åŠ å£³ç¨‹åºåŠ å£³åä¿®æ”¹äº†åŒºå—åçš„ã€‚å‰è€…å¯ä»¥ç›´æ¥ä½¿ç”¨åŠ å£³ç¨‹åºè„±å£³ï¼ˆå¦‚æœå…·å¤‡è„±å£³åŠŸèƒ½çš„è¯ï¼‰ï¼Œåè€…å…ˆä¿®æ”¹åŒºå—åå†ä½¿ç”¨åŠ å£³ç¨‹åºè„±å£³ã€‚</p></li><li><p>upxæ— ä¿®æ”¹åŠ å£³ç¤ºä¾‹ï¼š</p><p>æ‹¿åˆ°å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå…ˆåˆ°DIEæŸ¥çœ‹ï¼Œå‘ç°æœ‰å£³ã€‚å¯¹å£³çš„ä¿¡æ¯æè¿°æ²¡æœ‰å‡ºç°â€œmodifiedâ€å­—çœ¼ï¼Œå› æ­¤åˆ¤æ–­æ˜¯æ— ä¿®æ”¹åŠ å£³ï¼Œç›´æ¥ä½¿ç”¨å·¥å…·è„±å£³</p><p><img src="/../images/image-20250729103439484.png" alt="æŸ¥çœ‹å£³ä¿¡æ¯"></p><p>ç›´æ¥ä½¿ç”¨upx -dè„±å£³</p><p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-07-29%20103724.png" alt="upx-dè„±å£³"></p><p>å†æ¬¡ç”¨DIEæ‰“å¼€ï¼Œå‘ç°æ²¡æœ‰è¯†åˆ«å‡ºå£³äº†</p><p><img src="/../images/image-20250729104311684.png" alt="è„±å£³åæŸ¥çœ‹å£³ä¿¡æ¯"></p></li><li><p>upxä¿®æ”¹åŒºå—ååŠ å£³ç¤ºä¾‹ï¼š</p><p>å…ˆåˆ°DIEæŸ¥çœ‹å£³ä¿¡æ¯ï¼Œå‘ç°æ˜¯upx modified</p><p><img src="/../images/image-20250729110711262.png" alt="æŸ¥çœ‹å£³ä¿¡æ¯"></p><p>ç‚¹å‡»â€œåŒºå—â€œä¸‹æ–¹çš„â€&gt;â€œæŸ¥çœ‹åŒºå—ä¿¡æ¯ï¼Œå‘ç°åŒºå—åæœ‰æ”¹åŠ¨</p><p><img src="/../images/image-20250729110752177.png" alt="åŒºå—åæ”¹åŠ¨"></p><p>010editorä¿®æ”¹åŒºå—å</p><p><img src="/../images/image-20250729111002665.png" alt="ä¿®æ”¹åŒºå—å"></p><p>å†æ¬¡æŸ¥çœ‹å£³ä¿¡æ¯ï¼Œå˜æˆæ— ä¿®æ”¹åŠ å£³äº†ï¼Œç›´æ¥å·¥å…·è„±å£³</p><p><img src="/../images/image-20250729111128932.png" alt="å†æ¬¡æŸ¥çœ‹å£³ä¿¡æ¯"></p></li></ul><h2 id="æ‰‹åŠ¨è„±å£³æµç¨‹"><a href="#æ‰‹åŠ¨è„±å£³æµç¨‹" class="headerlink" title="æ‰‹åŠ¨è„±å£³æµç¨‹"></a>æ‰‹åŠ¨è„±å£³æµç¨‹</h2><ul><li><p>æ­¥éª¤ï¼š</p><ul><li>æŸ¥å£³ï¼šä½¿ç”¨DIEã€ExeinfoPEã€PEiDç­‰å·¥å…·æŸ¥å£³</li><li>å¯»æ‰¾ç¨‹åºåŸå…¥å£ç‚¹(OEP)ï¼šé€šè¿‡å„ç§æ–¹æ³•æ‰¾åˆ°å£³ä»£ç ç»“æŸã€ç¨‹åºçœŸæ­£å¼€å§‹çš„åœ°æ–¹</li><li>dumpå†…å­˜ï¼šå€ŸåŠ©æ’ä»¶ä»OEPå¼€å§‹dumpå‡ºåŸç¨‹åº</li><li>è¾“å…¥è¡¨(IAT)é‡å»ºï¼šå€ŸåŠ©æ’ä»¶é‡å»ºè¾“å…¥è¡¨</li><li>å…³é—­ç¨‹åºé‡å®šä½ï¼šä½¿ç”¨DIEç­‰å·¥å…·å…³é—­ç¨‹åºé‡å®šä½</li></ul></li><li><p>å¯»æ‰¾OEPçš„æ–¹æ³•æœ‰å¾ˆå¤šï¼Œè€Œdumpå’ŒIATé‡å»ºä»¥åŠå…³é—­é‡å®šä½çš„æ–¹æ³•åŸºæœ¬å›ºå®šã€‚å…ˆç”¨ä¸€ä¸ªä¾‹å­å±•ç¤ºæ•´ä½“æµç¨‹ï¼Œå†è¯¦ç»†å±•å¼€å¯»æ‰¾OEPçš„æ–¹æ³•ã€‚upxæ‰‹åŠ¨è„±å£³ç¤ºä¾‹ï¼š</p><ul><li><p>æŸ¥å£³ï¼šæ˜¾ç¤ºæ˜¯upx</p><p><img src="/../images/image-20250729133015652.png" alt="æŸ¥å£³"></p></li><li><p>å¯»æ‰¾OEPï¼š</p><p>é‡‡ç”¨espå®šå¾‹æ³•ï¼ˆè¯¦è§ä¸‹æ–‡ï¼‰æ‰¾åˆ°push ebpå¼€å¤´çš„ä¸€æ®µä»£ç </p><p><img src="/../images/image-20250729134006853.png" alt="å¯»æ‰¾OEP"></p></li><li><p>dumpå†…å­˜ï¼š</p><p>æ‰“å¼€æ’ä»¶scyllaï¼Œç‚¹å‡»â€œè½¬å‚¨â€æ ä¸­çš„â€œè½¬å‚¨â€ï¼Œä¼šè·å¾—ä¸€ä¸ª_dumpåç¼€çš„exeæ–‡ä»¶</p><p><img src="/../images/image-20250729134119537.png" alt="dump"></p></li><li><p>IATé‡å»ºï¼š</p><p>ç‚¹å‡»â€œIATè‡ªåŠ¨æœç´¢â€ï¼Œä¼šæœ‰å¼¹çª—é—®æ˜¯å¦ä½¿ç”¨é«˜çº§æœç´¢ç»“æœï¼Œç‚¹â€œæ˜¯â€ã€‚è¿™æ—¶å€™ï¼ŒVAå’Œâ€œå¤§å°â€ä¸¤ä¸ªæ¡†ä¼šè¢«å¡«å……ã€‚</p><p><img src="/../images/image-20250729134901607.png" alt="IATè‡ªåŠ¨æœç´¢"></p><p>æ¥ä¸‹æ¥ç‚¹â€œè·å–å¯¼å…¥â€ï¼Œä¸Šæ–¹çš„å¤§æ¡†ä¸­ä¼šå‡ºç°dllç»“å°¾çš„ä¸œè¥¿ï¼Œéœ€è¦æŠŠå¸¦çº¢è‰²Xçš„å–æ¶ˆå‹¾é€‰</p><p><img src="/../images/image-20250729134937163.png" alt="è·å–å¯¼å…¥"></p><p>ç„¶åç‚¹å‡»ä¿®å¤è½¬å‚¨ï¼Œé€‰æ‹©åˆšåˆšdumpå‡ºæ¥çš„æ–‡ä»¶ï¼Œä¼šå¾—åˆ°ä¸€ä¸ªå†åŠ ä¸Š_SCYçš„exeæ–‡ä»¶ã€‚</p><p>æ­¤æ—¶ç¨‹åºå¤§æ¦‚ç‡è¿è¡Œä¸äº†ï¼Œä¼šé—ªé€€ã€‚ä½†æ˜¯å¯¹äºé™æ€åˆ†ææ¥è¯´ï¼Œåˆ°è¿™ä¸€æ­¥å·²ç»è¶³å¤Ÿäº†ã€‚</p></li><li><p>å…³é—­é‡å®šä½ï¼šæŠŠå¾—åˆ°çš„_dump_SCY.exeæ–‡ä»¶æ‹–åˆ°DIEï¼Œç‚¹å‡»â€œåŒºå—â€æ çš„â€œ&gt;â€ï¼Œä¼šå¼¹å‡ºæ–‡ä»¶ç»“æ„ç•Œé¢</p><p><img src="/../images/image-20250729135914719.png" alt="æ–‡ä»¶ç»“æ„ç•Œé¢"></p><p>å…ˆå–æ¶ˆå‹¾é€‰å³ä¸Šè§’çš„â€œåªè¯»â€</p><p><img src="/../images/image-20250729140239276.png" alt="å–æ¶ˆåªè¯»"></p><p>ç‚¹å‡»IMAGE_NT_HEADERSä¸‹çš„IMAGE_FILE_HEADERï¼Œåœ¨â€œæ ‡å¿—â€é€‰é¡¹ä¸­å‹¾é€‰â€œRELOCS_STRIPPEDâ€ï¼ˆå›¾ä¸­æœªå‹¾é€‰ï¼‰</p><p><img src="/../images/image-20250729140145721.png" alt="å‹¾é€‰RELOCS_STRIPPED"></p><p>å†ç‚¹å‡»IMAGE_OPTIONAL_HEADERSï¼Œæ‰¾åˆ°å¦ä¸€ä¸ªæ ‡å¿—(DllCharacteristics)ï¼Œå–æ¶ˆå‹¾é€‰â€œDYNAMIC_BASEâ€ï¼ˆå›¾ä¸­æœªå–æ¶ˆï¼‰</p><p><img src="/../images/image-20250729140545940.png" alt="å–æ¶ˆå‹¾é€‰DYNAMIC_BASE"></p><p>è¿™æ ·å­ï¼Œæˆ‘ä»¬çš„ç¨‹åºå°±è„±å®Œå£³å¹¶ä¸”å¯ä»¥æ­£å¸¸è¿è¡Œäº†</p></li><li><p>PSï¼šå…³äºIATé‡å»ºè¿™ä¸€æ­¥éª¤ï¼Œä¸ºä»€ä¹ˆä¸èƒ½IATè‡ªåŠ¨æœç´¢å†è½¬å‚¨ä¸€æ­¥åˆ°ä½ï¼Ÿ</p><p>ç»“åˆAIçš„è§£é‡Šï¼Œä¸ªäººè§è§£æ˜¯IATè‡ªåŠ¨æœç´¢çš„è¿‡ç¨‹å¯èƒ½ä¼šè¿è¡Œç¨‹åºï¼Œå¯¼è‡´åœ°å€åˆ·æ–°ï¼ŒOEPå¤±æ•ˆï¼Œdumpå‡ºæ¥çš„ç¨‹åºä¸å®Œæ•´æˆ–è€…ä¸å¯¹ã€‚å› æ­¤ï¼Œdumpå’ŒIATé‡å»ºå®é™…ä¸Šæ˜¯ä¸¤ä¸ªæ­¥éª¤ï¼Œä¸è¿‡è¢«é›†æˆåˆ°äº†ä¸€ä¸ªç•Œé¢ã€‚å…¶å®è¿˜æœ‰æ‰‹åŠ¨é‡å»ºIATçš„æ–¹æ³•ï¼Œè¿™ç§æƒ…å†µä¸‹å°±ç¡®ç¡®å®å®éœ€è¦å…ˆdumpå†å¯¼å…¥é‡å»ºçš„IATäº†ï¼Œå› ä¸ºåœ¨è°ƒè¯•å™¨ä¸­æ‰¾åˆ°OEPåè¿˜è¦ç»§ç»­æ‰¾IAT</p></li></ul></li></ul><h2 id="å¯»æ‰¾OEPçš„æ–¹æ³•ï¼ˆä¸€ï¼‰"><a href="#å¯»æ‰¾OEPçš„æ–¹æ³•ï¼ˆä¸€ï¼‰" class="headerlink" title="å¯»æ‰¾OEPçš„æ–¹æ³•ï¼ˆä¸€ï¼‰"></a>å¯»æ‰¾OEPçš„æ–¹æ³•ï¼ˆä¸€ï¼‰</h2><h3 id="ESPå®šå¾‹"><a href="#ESPå®šå¾‹" class="headerlink" title="ESPå®šå¾‹"></a>ESPå®šå¾‹</h3><ul><li><p>å‰æ–‡ï¼Œæˆ‘ä»¬çŸ¥é“äº†å£³ç¨‹åºè§£ææ—¶ä¼šæœ‰pushad\popadæˆ–è€…pushfd\popfdçš„æ“ä½œã€‚pushadæ—¶ï¼Œéšç€é€šç”¨å¯„å­˜å™¨å€¼çš„å…¥æ ˆï¼Œespçš„å€¼ä¼šå‘ç”Ÿå˜åŒ–ï¼Œåˆå› ä¸ºæ ˆå¹³è¡¡çš„ç‰¹æ€§ï¼Œæœ€ç»ˆespçš„å€¼ä¼šå›åˆ°pushadåçš„è¿™ä¸ªå€¼ã€‚å› æ­¤ï¼Œå¯ä»¥å€ŸåŠ©è¿™ä¸€ç‚¹ï¼Œç»™pushadåçš„espå€¼ä¸‹ç¡¬ä»¶è®¿é—®æ–­ç‚¹ï¼Œpopadåå°±ä¼šè§¦å‘æ–­ç‚¹ï¼Œä¸­æ–­è°ƒè¯•ï¼Œè¿›è€Œå®ç°è·³è¿‡æ•´ä¸ªå£³è§£æè¿‡ç¨‹ã€‚å½“ç„¶ï¼Œä¸­æ–­å¤„è¿˜ä¸æ˜¯OEPï¼Œä¸€èˆ¬åœ¨ä¸­æ–­å¤„åä¼šæœ‰ä¸€ä¸ªè·¨åº¦æ˜æ˜¾çš„jmpï¼Œç”šè‡³jmpåè¿˜æœ‰ä¸€ä¸ªè·³è½¬è¡¨jmpæ‰ä¼šåˆ°è¾¾çœŸæ­£çš„OEP</p></li><li><p>å…·ä½“æ“ä½œå¦‚ä¸‹ï¼š</p><ul><li><p>xdbgæ‰“å¼€ï¼ŒF9åˆ°ç¨‹åºæ‰€åœ¨å†…å­˜åŒºåŸŸ</p><p><img src="/../images/image-20250729172225632.png" alt="xdbgæ‰“å¼€"></p></li><li><p>å¯ä»¥çœ‹åˆ°EIPæ‰€åœ¨å°±æ˜¯pushad</p><p><img src="/../images/image-20250729172310628.png" alt="pushad"></p></li><li><p>F8æ­¥è¿‡ï¼Œespæ›´æ–°</p><p><img src="/../images/image-20250729172402698.png" alt="espæ›´æ–°"></p></li><li><p>åœ¨å³ä¸‹è§’æ ˆçª—å£è®¾ä¸Šç¡¬ä»¶è®¿é—®æ–­ç‚¹</p><p><img src="/../images/image-20250729172449826.png" alt="è®¾ç½®ç¡¬ä»¶è®¿é—®æ–­ç‚¹"></p></li><li><p>ç‚¹å‡»å·¥å…·æ â€œè§†å›¾â€ä¸‹æ–¹çš„â€œ-&gt;â€ï¼Œç¨‹åºä¼šæ‰§è¡Œè¿‡popadã€‚å¯ä»¥çœ‹åˆ°ä¸‹æ–¹ä¸è¿œå¤„æœ‰ä¸ªå¤§è·³</p><p><img src="/../images/image-20250729172606653.png" alt="popad"></p></li><li><p>F8åˆ°å¤§è·³å¤„F7æ­¥å…¥ï¼Œæœ‰è·³è½¬è¡¨ç»§ç»­F7æ­¥å…¥ï¼Œå¯ä»¥çœ‹åˆ°å¼€è¾Ÿæ ˆå¸§æ“ä½œï¼Œè¿™é‡Œå°±æ˜¯OEPäº†ï¼Œåœ¨æ­¤å¤„ç›´æ¥ä½¿ç”¨scylla dumpå‡ºç¨‹åº</p><p><img src="/../images/image-20250729172759829.png" alt="OEP"></p></li></ul></li></ul><h3 id="å•æ­¥è·Ÿè¸ªæ³•"><a href="#å•æ­¥è·Ÿè¸ªæ³•" class="headerlink" title="å•æ­¥è·Ÿè¸ªæ³•"></a>å•æ­¥è·Ÿè¸ªæ³•</h3><ul><li>å¦‚åï¼Œå°±æ˜¯ä¸€ç›´æŒ‰F8ï¼Œè®©ç¨‹åºå°½é‡å‘ä¸‹èµ°ï¼Œé‡åˆ°å¾ªç¯å°±è·³è¿‡ï¼Œé‡åˆ°è¿‘callå°±æ­¥å…¥ï¼Œé‡ç‚¹å…³æ³¨å¤§è·³</li><li>å‚è€ƒctf-wiki <a href="https://ctf-wiki.org/reverse/platform/windows/unpack/trace/">https://ctf-wiki.org/reverse/platform/windows/unpack/trace/</a></li></ul>]]></content>
    
    
    <summary type="html">å£³ã€å£³çš„åŠ è½½è¿‡ç¨‹ã€å·¥å…·è„±å£³ã€æ‰‹åŠ¨è„±å£³æµç¨‹ã€espå®šå¾‹ï¼ˆåŸºäºXdbgï¼‰</summary>
    
    
    
    <category term="Reverse Engineering" scheme="https://sydzi.github.io/categories/Reverse-Engineering/"/>
    
    
    <category term="CTF" scheme="https://sydzi.github.io/tags/CTF/"/>
    
    <category term="Reverse" scheme="https://sydzi.github.io/tags/Reverse/"/>
    
  </entry>
  
  <entry>
    <title>Day8:thiscallã€ç±»</title>
    <link href="https://sydzi.github.io/2025/07/21/Day8-%E7%B1%BB/"/>
    <id>https://sydzi.github.io/2025/07/21/Day8-%E7%B1%BB/</id>
    <published>2025-07-21T08:51:35.000Z</published>
    <updated>2025-09-18T03:57:07.101Z</updated>
    
    <content type="html"><![CDATA[<p>thiscallã€ç±»</p><span id="more"></span><h2 id="è°ƒç”¨çº¦å®šï¼šthiscall"><a href="#è°ƒç”¨çº¦å®šï¼šthiscall" class="headerlink" title="è°ƒç”¨çº¦å®šï¼šthiscall"></a>è°ƒç”¨çº¦å®šï¼šthiscall</h2><ul><li>å¯¹äºC++thisæŒ‡é’ˆçš„ç‰¹æ€§ï¼Œæœ‰ä¸€ç§ä¸“é—¨çš„è°ƒç”¨çº¦å®šå«thiscallï¼Œä¸»è¦ç”¨äºç±»å‡ºç°çš„åœºæ™¯</li><li>æ— è®ºx86&#x2F;x64ï¼ŒthisæŒ‡é’ˆå‡ç”±ecx&#x2F;rcxæ‰®æ¼”ï¼ŒæŒ‡å‘å¯¹è±¡çš„å†…å­˜åœ°å€</li><li>thiscallç”±è¢«è°ƒç”¨è€…æ¸…ç†å‚æ•°å ç”¨çš„æ ˆç©ºé—´</li></ul><h2 id="ç±»ï¼ˆä¸€ï¼‰"><a href="#ç±»ï¼ˆä¸€ï¼‰" class="headerlink" title="ç±»ï¼ˆä¸€ï¼‰"></a>ç±»ï¼ˆä¸€ï¼‰</h2><ul><li><p>ç®€å•çš„æ„é€ ææ„åˆ†æ</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-comment">;mainå‡½æ•°</span><br><span class="hljs-symbol">.text:</span>004641E0 var_EC          = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">0ECh</span><br><span class="hljs-symbol">.text:</span>004641E0 var_30          = <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">30h</span><br><span class="hljs-symbol">.text:</span>004641E0 var_20          = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">20h</span><br><span class="hljs-symbol">.text:</span>004641E0 var_4           = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">4</span><br><span class="hljs-symbol">.text:</span>004641E0<br><span class="hljs-symbol">.text:</span>004641E0                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span>004641E1                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">esp</span><br><span class="hljs-symbol">.text:</span>004641E3                 <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0F0h</span><br><span class="hljs-symbol">.text:</span>004641E9                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ebx</span><br><span class="hljs-symbol">.text:</span>004641EA                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">esi</span><br><span class="hljs-symbol">.text:</span>004641EB                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">edi</span><br><span class="hljs-symbol">.text:</span>004641EC                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">edi</span>, [<span class="hljs-built_in">ebp</span>+var_30]<br><span class="hljs-symbol">.text:</span>004641EF                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-number">0Ch</span><br><span class="hljs-symbol">.text:</span>004641F4                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">0CCCCCCCCh</span><br><span class="hljs-symbol">.text:</span>004641F9                 <span class="hljs-keyword">rep</span> <span class="hljs-keyword">stosd</span><br><span class="hljs-symbol">.text:</span>004641FB                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, ___security_cookie<br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464200</span>                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464202</span>                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_4], <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464205</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, offset unk_54D014<br><span class="hljs-symbol">.text:</span>0046420A                 <span class="hljs-keyword">call</span>    sub_45FF30<br><span class="hljs-symbol">.text:</span>0046420F                 <span class="hljs-keyword">nop</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464210</span>                 <span class="hljs-keyword">push</span>    offset aXiaoming <span class="hljs-comment">; å‚æ•°&quot;xiaoming&quot;</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464215</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-number">1</span>               <span class="hljs-comment">; å¦ä¸€ä¸ªå‚æ•°</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464217</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">ecx</span>, [<span class="hljs-built_in">ebp</span>+var_20] <span class="hljs-comment">; [ebp+var_20]æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒthisæŒ‡é’ˆæŒ‡å‘è¯¥å¯¹è±¡</span><br><span class="hljs-symbol">.text:</span>0046421A                 <span class="hljs-keyword">call</span>    sub_46062E      <span class="hljs-comment">; æ„é€ å‡½æ•°</span><br><span class="hljs-symbol">.text:</span>0046421F                 <span class="hljs-keyword">nop</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464220</span>                 <span class="hljs-keyword">push</span>    offset aPause   <span class="hljs-comment">; &quot;pause&quot;</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464225</span>                 <span class="hljs-keyword">call</span>    sub_45F98B      <span class="hljs-comment">; system</span><br><span class="hljs-symbol">.text:</span>0046422A                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">4</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0046422D</span>                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_EC], <span class="hljs-number">0</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464237</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">ecx</span>, [<span class="hljs-built_in">ebp</span>+var_20] <span class="hljs-comment">; thisæŒ‡é’ˆ</span><br><span class="hljs-symbol">.text:</span>0046423A                 <span class="hljs-keyword">call</span>    sub_45D38E      <span class="hljs-comment">; ææ„å‡½æ•°</span><br><span class="hljs-symbol">.text:</span>0046423F                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_EC]<br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464245</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">edx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464246</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464248</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464249</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">edx</span>, dword_464274<br><span class="hljs-symbol">.text:</span>0046424F                 <span class="hljs-keyword">call</span>    sub_45EC4D<br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464254</span>                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464255</span>                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">edx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464256</span>                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">edi</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464257</span>                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">esi</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464258</span>                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ebx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464259</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, [<span class="hljs-built_in">ebp</span>+var_4]<br><span class="hljs-symbol">.text:</span>0046425C                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-built_in">ebp</span>        <span class="hljs-comment">; StackCookie</span><br><span class="hljs-symbol">.text:</span>0046425E                 <span class="hljs-keyword">call</span>    j_@__security_check_cookie@<span class="hljs-number">4</span> <span class="hljs-comment">; __security_check_cookie(x)</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464263</span>                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0F0h</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464269</span>                 <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">esp</span><br><span class="hljs-symbol">.text:</span>0046426B                 <span class="hljs-keyword">call</span>    sub_45F175<br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464270</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464272</span>                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464273</span>                 <span class="hljs-keyword">retn</span><br><br><span class="hljs-comment">;æ„é€ å‡½æ•°</span><br><span class="hljs-symbol">.text:</span>00463FC0 var_C           = <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">0Ch</span><br><span class="hljs-symbol">.text:</span>00463FC0 var_8           = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span>00463FC0 arg_0           = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span>  <span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span>00463FC0 arg_4           = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span>  <span class="hljs-number">0Ch</span><br><span class="hljs-symbol">.text:</span>00463FC0<br><span class="hljs-symbol">.text:</span>00463FC0                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span>00463FC1                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">esp</span><br><span class="hljs-symbol">.text:</span>00463FC3                 <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0CCh</span><br><span class="hljs-symbol">.text:</span>00463FC9                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ebx</span><br><span class="hljs-symbol">.text:</span>00463FCA                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">esi</span><br><span class="hljs-symbol">.text:</span>00463FCB                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">edi</span><br><span class="hljs-symbol">.text:</span>00463FCC                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ecx</span><br><span class="hljs-symbol">.text:</span>00463FCD                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">edi</span>, [<span class="hljs-built_in">ebp</span>+var_C]<br><span class="hljs-symbol">.text:</span>00463FD0                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-number">3</span><br><span class="hljs-symbol">.text:</span>00463FD5                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">0CCCCCCCCh</span><br><span class="hljs-symbol">.text:</span>00463FDA                 <span class="hljs-keyword">rep</span> <span class="hljs-keyword">stosd</span><br><span class="hljs-symbol">.text:</span>00463FDC                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ecx</span><br><span class="hljs-symbol">.text:</span>00463FDD                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_8], <span class="hljs-built_in">ecx</span> <span class="hljs-comment">; å½“å‰å¯¹è±¡åœ°å€ä¿å­˜åˆ°[ebp+var_8]</span><br><span class="hljs-symbol">.text:</span>00463FE0                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, offset unk_54D014<br><span class="hljs-symbol">.text:</span>00463FE5                 <span class="hljs-keyword">call</span>    sub_45FF30<br><span class="hljs-symbol">.text:</span>00463FEA                 <span class="hljs-keyword">nop</span><br><span class="hljs-symbol">.text:</span>00463FEB                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_8] <span class="hljs-comment">; ç¬¬ä¸€ä¸ªå¯¹è±¡æˆå‘˜</span><br><span class="hljs-symbol">.text:</span>00463FEE                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, [<span class="hljs-built_in">ebp</span>+arg_0] <span class="hljs-comment">; ç¬¬ä¸€ä¸ªå‚æ•°1</span><br><span class="hljs-symbol">.text:</span>00463FF1                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">eax</span>], <span class="hljs-built_in">ecx</span><br><span class="hljs-symbol">.text:</span>00463FF3                 <span class="hljs-keyword">push</span>    <span class="hljs-number">4</span><br><span class="hljs-symbol">.text:</span>00463FF5                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+arg_4] <span class="hljs-comment">; ç¬¬äºŒä¸ªå‚æ•°&quot;xiaoming&quot;</span><br><span class="hljs-symbol">.text:</span>00463FF8                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>00463FF9                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, [<span class="hljs-built_in">ebp</span>+var_8]<br><span class="hljs-symbol">.text:</span>00463FFC                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-number">4</span>          <span class="hljs-comment">; ç¬¬äºŒä¸ªå¯¹è±¡æˆå‘˜</span><br><span class="hljs-symbol">.text:</span>00463FFF                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ecx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464000</span>                 <span class="hljs-keyword">call</span>    sub_45FCF1      <span class="hljs-comment">; memcpy()</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464005</span>                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0Ch</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464008</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_8] <span class="hljs-comment">; è¿”å›çš„æ˜¯å¯¹è±¡åœ°å€</span><br><span class="hljs-symbol">.text:</span>0046400B                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">edi</span><br><span class="hljs-symbol">.text:</span>0046400C                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">esi</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0046400D</span>                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ebx</span><br><span class="hljs-symbol">.text:</span>0046400E                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0CCh</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464014</span>                 <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">esp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464016</span>                 <span class="hljs-keyword">call</span>    sub_45F175<br><span class="hljs-symbol">.text:</span>0046401B                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0046401D</span>                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span>0046401E                 <span class="hljs-keyword">retn</span>    <span class="hljs-number">8</span><br><br><span class="hljs-comment">;ææ„å‡½æ•°</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464040</span> var_C           = <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">0Ch</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464040</span> var_8           = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464040</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464040</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464041</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">esp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464043</span>                 <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0CCh</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464049</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ebx</span><br><span class="hljs-symbol">.text:</span>0046404A                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">esi</span><br><span class="hljs-symbol">.text:</span>0046404B                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">edi</span><br><span class="hljs-symbol">.text:</span>0046404C                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ecx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0046404D</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">edi</span>, [<span class="hljs-built_in">ebp</span>+var_C]<br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464050</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-number">3</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464055</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">0CCCCCCCCh</span><br><span class="hljs-symbol">.text:</span>0046405A                 <span class="hljs-keyword">rep</span> <span class="hljs-keyword">stosd</span><br><span class="hljs-symbol">.text:</span>0046405C                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ecx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0046405D</span>                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_8], <span class="hljs-built_in">ecx</span> <span class="hljs-comment">; æŠŠå¯¹è±¡åœ°å€å­˜åˆ°[ebp+var_8]</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464060</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, offset unk_54D014<br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464065</span>                 <span class="hljs-keyword">call</span>    sub_45FF30<br><span class="hljs-symbol">.text:</span>0046406A                 <span class="hljs-keyword">nop</span><br><span class="hljs-symbol">.text:</span>0046406B                 <span class="hljs-keyword">push</span>    offset aDestructing <span class="hljs-comment">; &quot;destructing......&quot;</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464070</span>                 <span class="hljs-keyword">call</span>    sub_45DB59      <span class="hljs-comment">; printf</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464075</span>                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">4</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464078</span>                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">edi</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464079</span>                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">esi</span><br><span class="hljs-symbol">.text:</span>0046407A                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ebx</span><br><span class="hljs-symbol">.text:</span>0046407B                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0CCh</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464081</span>                 <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">esp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464083</span>                 <span class="hljs-keyword">call</span>    sub_45F175<br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464088</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span>0046408A                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span>0046408B                 <span class="hljs-keyword">retn</span><br></code></pre></td></tr></table></figure><p>æºç </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;string.h&gt;</span></span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Student</span> &#123;<br><span class="hljs-keyword">private</span>:<br><span class="hljs-type">int</span> ID;<br><span class="hljs-type">char</span> name[<span class="hljs-number">20</span>];<br><span class="hljs-keyword">public</span>:<br><span class="hljs-built_in">Student</span>(<span class="hljs-type">int</span> n = <span class="hljs-number">0</span>, <span class="hljs-type">const</span> <span class="hljs-type">char</span>* na = <span class="hljs-string">&quot;NONE&quot;</span>) :<span class="hljs-built_in">ID</span>(n) &#123;<br><span class="hljs-built_in">memcpy</span>(name, na, <span class="hljs-built_in">sizeof</span>(na));<br>&#125;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">show</span><span class="hljs-params">()</span></span>;<br>~<span class="hljs-built_in">Student</span>();<br>&#125;;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">Student::show</span><span class="hljs-params">()</span> </span>&#123;<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d %s\n&quot;</span>, ID, name);<br>&#125;<br>Student::~<span class="hljs-built_in">Student</span>() &#123;<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;destructing......&quot;</span>);<br>&#125;<br><span class="hljs-function"><span class="hljs-type">int</span>  <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br><span class="hljs-function">Student <span class="hljs-title">stu</span><span class="hljs-params">(<span class="hljs-number">001</span>, <span class="hljs-string">&quot;xiaoming&quot;</span>)</span></span>;<br><span class="hljs-built_in">system</span>(<span class="hljs-string">&quot;pause&quot;</span>);<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></li></ul>]]></content>
    
    
    <summary type="html">thiscallã€ç±»</summary>
    
    
    
    <category term="Reverse Engineering" scheme="https://sydzi.github.io/categories/Reverse-Engineering/"/>
    
    
    <category term="CTF" scheme="https://sydzi.github.io/tags/CTF/"/>
    
    <category term="Reverse" scheme="https://sydzi.github.io/tags/Reverse/"/>
    
  </entry>
  
  <entry>
    <title>Day7:æ•°ç»„ä¸æŒ‡é’ˆè¯†åˆ«</title>
    <link href="https://sydzi.github.io/2025/07/17/Day7-%E6%95%B0%E7%BB%84%E4%B8%8E%E6%8C%87%E9%92%88%E8%AF%86%E5%88%AB/"/>
    <id>https://sydzi.github.io/2025/07/17/Day7-%E6%95%B0%E7%BB%84%E4%B8%8E%E6%8C%87%E9%92%88%E8%AF%86%E5%88%AB/</id>
    <published>2025-07-17T05:28:29.000Z</published>
    <updated>2025-09-18T03:57:04.074Z</updated>
    
    <content type="html"><![CDATA[<p>æ•°ç»„ä¸æŒ‡é’ˆè¯†åˆ«</p><span id="more"></span><h2 id="æ•°ç»„ä¸æŒ‡é’ˆè¯†åˆ«"><a href="#æ•°ç»„ä¸æŒ‡é’ˆè¯†åˆ«" class="headerlink" title="æ•°ç»„ä¸æŒ‡é’ˆè¯†åˆ«"></a>æ•°ç»„ä¸æŒ‡é’ˆè¯†åˆ«</h2><ul><li><p>æ•´å‹ä¸€ç»´æ•°ç»„</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-symbol">.text:</span><span class="hljs-number">00464260</span>                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_14], <span class="hljs-number">1</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464267</span>                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_10], <span class="hljs-number">2</span><br><span class="hljs-symbol">.text:</span>0046426E                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_C], <span class="hljs-number">3</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464275</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_14] <span class="hljs-comment">; æ•°ç»„é¦–åœ°å€</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464278</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span>             <span class="hljs-comment">; ä¼ å‚</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464279</span>                 <span class="hljs-keyword">call</span>    sub_45D447<br><span class="hljs-symbol">.text:</span>0046427E                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">4</span><br><br><span class="hljs-comment">;sub_45D447</span><br><span class="hljs-symbol">.text:</span>004640D0 arg_0           = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span>  <span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span>004640D0<br><span class="hljs-symbol">.text:</span>004640D0                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span>004640D1                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">esp</span><br><span class="hljs-symbol">.text:</span>004640D3                 <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0C0h</span><br><span class="hljs-symbol">.text:</span>004640D9                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ebx</span><br><span class="hljs-symbol">.text:</span>004640DA                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">esi</span><br><span class="hljs-symbol">.text:</span>004640<span class="hljs-built_in">DB</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">edi</span><br><span class="hljs-symbol">.text:</span>004640DC                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">edi</span>, <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span>004640DE                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-built_in">ecx</span><br><span class="hljs-symbol">.text:</span>004640E0                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">0CCCCCCCCh</span><br><span class="hljs-symbol">.text:</span>004640E5                 <span class="hljs-keyword">rep</span> <span class="hljs-keyword">stosd</span><br><span class="hljs-symbol">.text:</span>004640E7                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, offset unk_54D014<br><span class="hljs-symbol">.text:</span>004640EC                 <span class="hljs-keyword">call</span>    sub_45FF35<br><span class="hljs-symbol">.text:</span>004640F1                 <span class="hljs-keyword">nop</span><br><span class="hljs-symbol">.text:</span>004640F2                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">4</span><br><span class="hljs-symbol">.text:</span>004640F7                 <span class="hljs-keyword">shl</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">1</span>          <span class="hljs-comment">; eax=4*2^1=8</span><br><span class="hljs-symbol">.text:</span>004640F9                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, [<span class="hljs-built_in">ebp</span>+arg_0] <span class="hljs-comment">; [ebp+arg_0]æ˜¯ä¼ å…¥çš„å‚æ•°ï¼Œå³æ•°ç»„é¦–åœ°å€</span><br><span class="hljs-symbol">.text:</span>004640FC                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">edx</span>, [<span class="hljs-built_in">ecx</span>+<span class="hljs-built_in">eax</span>]  <span class="hljs-comment">; [ecx+eax]å³[ebp+arg_0+eax]ï¼Œå³[ebp+10h]</span><br><span class="hljs-symbol">.text:</span>004640FF                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">edx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464100</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">4</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464105</span>                 <span class="hljs-keyword">shl</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">0</span>          <span class="hljs-comment">; eax=4*2^0=4</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464108</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, [<span class="hljs-built_in">ebp</span>+arg_0]<br><span class="hljs-symbol">.text:</span>0046410B                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">edx</span>, [<span class="hljs-built_in">ecx</span>+<span class="hljs-built_in">eax</span>]  <span class="hljs-comment">; å³[ebp+0Ch]</span><br><span class="hljs-symbol">.text:</span>0046410E                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">edx</span><br><span class="hljs-symbol">.text:</span>0046410F                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">4</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464114</span>                 <span class="hljs-keyword">imul</span>    <span class="hljs-built_in">ecx</span>, <span class="hljs-built_in">eax</span>, <span class="hljs-number">0</span>     <span class="hljs-comment">; ecx=4*0=0</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464117</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">edx</span>, [<span class="hljs-built_in">ebp</span>+arg_0]<br><span class="hljs-symbol">.text:</span>0046411A                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">edx</span>+<span class="hljs-built_in">ecx</span>]  <span class="hljs-comment">; å³[ebp+8]ï¼Œå³[ebp+arg_0]ï¼Œæ•°ç»„é¦–ä½</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0046411D</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>0046411E                 <span class="hljs-keyword">push</span>    offset aDDD     <span class="hljs-comment">; &quot;%d %d %d&quot;</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464123</span>                 <span class="hljs-keyword">call</span>    sub_45DB5E      <span class="hljs-comment">; printf</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464128</span>                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">10h</span><br><span class="hljs-symbol">.text:</span>0046412B                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">edi</span><br><span class="hljs-symbol">.text:</span>0046412C                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">esi</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0046412D</span>                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ebx</span><br><span class="hljs-symbol">.text:</span>0046412E                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0C0h</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464134</span>                 <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">esp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464136</span>                 <span class="hljs-keyword">call</span>    sub_45F17F<br><span class="hljs-symbol">.text:</span>0046413B                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0046413D</span>                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span>0046413E                 <span class="hljs-keyword">retn</span><br></code></pre></td></tr></table></figure><p>æºç </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">void</span> <span class="hljs-title function_">IntShow</span><span class="hljs-params">(<span class="hljs-type">int</span>* n)</span> &#123;<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d %d %d&quot;</span>, n[<span class="hljs-number">0</span>], n[<span class="hljs-number">1</span>], n[<span class="hljs-number">2</span>]);<br>&#125;<br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;<br>    <span class="hljs-type">int</span> arr[<span class="hljs-number">3</span>] = &#123; <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span> &#125;;<br>IntShow(arr);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>å­—ç¬¦å‹ä¸€ç»´æ•°ç»„</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-symbol">.text:</span><span class="hljs-number">00464281</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">ds</span>:dword_520E60 <span class="hljs-comment">; &#x27;lleh&#x27;</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464286</span>                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_24], <span class="hljs-built_in">eax</span> <span class="hljs-comment">; ç”¨eaxè¿‡æ¸¡ï¼Œä¼ ç»™å±€éƒ¨å˜é‡</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464289</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">cx</span>, <span class="hljs-built_in">ds</span>:word_520E64 <span class="hljs-comment">; &#x27;o&#x27;</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464290</span>                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_20], <span class="hljs-built_in">cx</span> <span class="hljs-comment">; ç”¨cxè¿‡æ¸¡ï¼Œä¼ ç»™å±€éƒ¨å˜é‡</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464294</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_24]<br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464297</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span>             <span class="hljs-comment">; å‰åŠæ®µçš„åœ°å€å…¥æ ˆ</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464298</span>                 <span class="hljs-keyword">call</span>    sub_45E3AB<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0046429D</span>                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">4</span><br><br><span class="hljs-comment">;sub_45E3AB</span><br><span class="hljs-symbol">.text:</span>00463FC0 arg_0           = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span>  <span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span>00463FC0<br><span class="hljs-symbol">.text:</span>00463FC0                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span>00463FC1                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">esp</span><br><span class="hljs-symbol">.text:</span>00463FC3                 <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0C0h</span><br><span class="hljs-symbol">.text:</span>00463FC9                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ebx</span><br><span class="hljs-symbol">.text:</span>00463FCA                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">esi</span><br><span class="hljs-symbol">.text:</span>00463FCB                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">edi</span><br><span class="hljs-symbol">.text:</span>00463FCC                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">edi</span>, <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span>00463FCE                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-built_in">ecx</span><br><span class="hljs-symbol">.text:</span>00463FD0                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">0CCCCCCCCh</span><br><span class="hljs-symbol">.text:</span>00463FD5                 <span class="hljs-keyword">rep</span> <span class="hljs-keyword">stosd</span><br><span class="hljs-symbol">.text:</span>00463FD7                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, offset unk_54D014<br><span class="hljs-symbol">.text:</span>00463FDC                 <span class="hljs-keyword">call</span>    sub_45FF35<br><span class="hljs-symbol">.text:</span>00463FE1                 <span class="hljs-keyword">nop</span><br><span class="hljs-symbol">.text:</span>00463FE2                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+arg_0] <span class="hljs-comment">; å‚æ•°ä¼ ç»™eax</span><br><span class="hljs-symbol">.text:</span>00463FE5                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>00463FE6                 <span class="hljs-keyword">push</span>    offset aS       <span class="hljs-comment">; &quot;%s&quot;</span><br><span class="hljs-symbol">.text:</span>00463FEB                 <span class="hljs-keyword">call</span>    sub_45DB5E      <span class="hljs-comment">; printf</span><br><span class="hljs-symbol">.text:</span>00463FF0                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span>00463FF3                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">edi</span><br><span class="hljs-symbol">.text:</span>00463FF4                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">esi</span><br><span class="hljs-symbol">.text:</span>00463FF5                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ebx</span><br><span class="hljs-symbol">.text:</span>00463FF6                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0C0h</span><br><span class="hljs-symbol">.text:</span>00463FFC                 <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">esp</span><br><span class="hljs-symbol">.text:</span>00463FFE                 <span class="hljs-keyword">call</span>    sub_45F17F<br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464003</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464005</span>                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464006</span>                 <span class="hljs-keyword">retn</span><br></code></pre></td></tr></table></figure><p>æºç </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">void</span> <span class="hljs-title function_">CharShow</span><span class="hljs-params">(<span class="hljs-type">char</span>* n)</span> &#123;<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s&quot;</span>, n);<br>&#125;<br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;<br>    <span class="hljs-type">char</span> buf[] = &#123; <span class="hljs-string">&quot;hello&quot;</span> &#125;;<br>CharShow(buf);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>æ•°ç»„ä½œä¸ºè¿”å›å€¼</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-symbol">.text:</span>004642C3                 <span class="hljs-keyword">call</span>    sub_45FC79<br><span class="hljs-symbol">.text:</span>004642C8                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_40], <span class="hljs-built_in">eax</span> <span class="hljs-comment">; ä»è¿”å›å€¼ä¸­å–å‡ºä¼ åˆ°å±€éƒ¨å˜é‡</span><br><span class="hljs-symbol">.text:</span>004642CB                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_40] <span class="hljs-comment">; æ”¾å…¥å¯„å­˜å™¨ä¸­pushä½œä¸ºå‚æ•°</span><br><span class="hljs-symbol">.text:</span>004642CE                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>004642CF                 <span class="hljs-keyword">push</span>    offset aS       <span class="hljs-comment">; &quot;%s&quot;</span><br><span class="hljs-symbol">.text:</span>004642D4                 <span class="hljs-keyword">call</span>    sub_45DB59      <span class="hljs-comment">; printf</span><br><span class="hljs-symbol">.text:</span>004642D9                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">8</span><br><br><span class="hljs-comment">;sub_45FC79</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464020</span> var_14          = <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">14h</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464020</span> var_10          = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">10h</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464020</span> var_C           = <span class="hljs-built_in">word</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">0Ch</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464020</span> var_A           = <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">0Ah</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464020</span> var_4           = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">4</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464020</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464020</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464021</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">esp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464023</span>                 <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0D4h</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464029</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ebx</span><br><span class="hljs-symbol">.text:</span>0046402A                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">esi</span><br><span class="hljs-symbol">.text:</span>0046402B                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">edi</span><br><span class="hljs-symbol">.text:</span>0046402C                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">edi</span>, [<span class="hljs-built_in">ebp</span>+var_14]<br><span class="hljs-symbol">.text:</span>0046402F                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-number">5</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464034</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">0CCCCCCCCh</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464039</span>                 <span class="hljs-keyword">rep</span> <span class="hljs-keyword">stosd</span><br><span class="hljs-symbol">.text:</span>0046403B                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, ___security_cookie<br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464040</span>                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464042</span>                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_4], <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464045</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, offset unk_54E014<br><span class="hljs-symbol">.text:</span>0046404A                 <span class="hljs-keyword">call</span>    sub_45FF35<br><span class="hljs-symbol">.text:</span>0046404F                 <span class="hljs-keyword">nop</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464050</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">ds</span>:dword_521E60 <span class="hljs-comment">; &#x27;oviv&#x27;</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464055</span>                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_10], <span class="hljs-built_in">eax</span> <span class="hljs-comment">; eaxè¿‡æ¸¡ï¼Œä¼ ç»™å±€éƒ¨å˜é‡</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464058</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">cx</span>, <span class="hljs-built_in">ds</span>:word_521E64 <span class="hljs-comment">; &#x27;05&#x27;</span><br><span class="hljs-symbol">.text:</span>0046405F                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_C], <span class="hljs-built_in">cx</span> <span class="hljs-comment">; cxè¿‡æ¸¡ï¼Œä¼ ç»™å±€éƒ¨å˜é‡</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464063</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">dl</span>, <span class="hljs-built_in">ds</span>:byte_521E66<br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464069</span>                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_A], <span class="hljs-built_in">dl</span><br><span class="hljs-symbol">.text:</span>0046406C                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_10] <span class="hljs-comment">; å‰åŠæ®µç»™eaxï¼Œä½œä¸ºè¿”å›å€¼ä¼ é€’</span><br><span class="hljs-symbol">.text:</span>0046406F                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">edx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464070</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464072</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464073</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">edx</span>, dword_4640A0<br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464079</span>                 <span class="hljs-keyword">call</span>    sub_45EC52<br><span class="hljs-symbol">.text:</span>0046407E                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>0046407F                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">edx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464080</span>                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">edi</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464081</span>                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">esi</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464082</span>                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ebx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464083</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, [<span class="hljs-built_in">ebp</span>+var_4]<br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464086</span>                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-built_in">ebp</span>        <span class="hljs-comment">; StackCookie</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464088</span>                 <span class="hljs-keyword">call</span>    j_@__security_check_cookie@<span class="hljs-number">4</span> <span class="hljs-comment">; __security_check_cookie(x)</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0046408D</span>                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0D4h</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464093</span>                 <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">esp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464095</span>                 <span class="hljs-keyword">call</span>    sub_45F17A<br><span class="hljs-symbol">.text:</span>0046409A                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span>0046409C                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0046409D</span>                 <span class="hljs-keyword">retn</span><br></code></pre></td></tr></table></figure><p>æºç </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">char</span>* <span class="hljs-title function_">CrZT</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-type">char</span> temp[<span class="hljs-number">7</span>] = <span class="hljs-string">&quot;vivo50&quot;</span>;<br><span class="hljs-keyword">return</span> temp;<br>&#125;<br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;<br>    <span class="hljs-type">char</span>* p = CrZT();<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s&quot;</span>, p);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>æ•´å½¢äºŒç»´æ•°ç»„ï¼ˆå’Œä¸€ç»´æ•°ç»„æ²¡æœ‰æœ¬è´¨ä¸Šçš„åŒºåˆ«ï¼Œéƒ½æ˜¯å ç”¨ä¸€æ®µè¿ç»­çš„å†…å­˜ç©ºé—´ï¼‰</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-symbol">.text:</span>004642DC                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_58], <span class="hljs-number">1</span><br><span class="hljs-symbol">.text:</span>004642E3                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_54], <span class="hljs-number">2</span><br><span class="hljs-symbol">.text:</span>004642EA                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_50], <span class="hljs-number">3</span><br><span class="hljs-symbol">.text:</span>004642F1                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_4C], <span class="hljs-number">4</span><br><span class="hljs-symbol">.text:</span>004642F8                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span>004642FD                 <span class="hljs-keyword">shl</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">0</span>          <span class="hljs-comment">; eax=8*2^0=8</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464300</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">ecx</span>, [<span class="hljs-built_in">ebp</span>+<span class="hljs-built_in">eax</span>+var_58] <span class="hljs-comment">; å³[ebp+var_58+8]ï¼Œå³[ebp+var_50]</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464304</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">edx</span>, <span class="hljs-number">4</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464309</span>                 <span class="hljs-keyword">shl</span>     <span class="hljs-built_in">edx</span>, <span class="hljs-number">0</span>          <span class="hljs-comment">; edx=4*2^0=4</span><br><span class="hljs-symbol">.text:</span>0046430C                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ecx</span>+<span class="hljs-built_in">edx</span>]  <span class="hljs-comment">; å³[ebp+var_58+0Ch]ï¼Œå³[ebp+var_4C]</span><br><span class="hljs-symbol">.text:</span>0046430F                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464310</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464315</span>                 <span class="hljs-keyword">shl</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-number">0</span>          <span class="hljs-comment">; ecx=8*2^0=8</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464318</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">edx</span>, [<span class="hljs-built_in">ebp</span>+<span class="hljs-built_in">ecx</span>+var_58] <span class="hljs-comment">; å³[ebp+var_58+8]ï¼Œå³[ebp+var_50]</span><br><span class="hljs-symbol">.text:</span>0046431C                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">4</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464321</span>                 <span class="hljs-keyword">imul</span>    <span class="hljs-built_in">ecx</span>, <span class="hljs-built_in">eax</span>, <span class="hljs-number">0</span>     <span class="hljs-comment">; ecx=0</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464324</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">edx</span>, [<span class="hljs-built_in">edx</span>+<span class="hljs-built_in">ecx</span>]  <span class="hljs-comment">; å³[ebp+var_50]</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464327</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">edx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464328</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0046432D</span>                 <span class="hljs-keyword">imul</span>    <span class="hljs-built_in">ecx</span>, <span class="hljs-built_in">eax</span>, <span class="hljs-number">0</span>     <span class="hljs-comment">; ecx=8*0=0</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464330</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">edx</span>, [<span class="hljs-built_in">ebp</span>+<span class="hljs-built_in">ecx</span>+var_58] <span class="hljs-comment">; å³[ebp+var_58]</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464334</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">4</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464339</span>                 <span class="hljs-keyword">shl</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">0</span>          <span class="hljs-comment">; eax=4*2^0=4</span><br><span class="hljs-symbol">.text:</span>0046433C                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, [<span class="hljs-built_in">edx</span>+<span class="hljs-built_in">eax</span>]  <span class="hljs-comment">; å³[ebp+var_54]</span><br><span class="hljs-symbol">.text:</span>0046433F                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ecx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464340</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">edx</span>, <span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464345</span>                 <span class="hljs-keyword">imul</span>    <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">edx</span>, <span class="hljs-number">0</span>     <span class="hljs-comment">; eax=8*0=0</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464348</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">ecx</span>, [<span class="hljs-built_in">ebp</span>+<span class="hljs-built_in">eax</span>+var_58] <span class="hljs-comment">; å³[ebp+var_58]</span><br><span class="hljs-symbol">.text:</span>0046434C                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">edx</span>, <span class="hljs-number">4</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464351</span>                 <span class="hljs-keyword">imul</span>    <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">edx</span>, <span class="hljs-number">0</span>     <span class="hljs-comment">; ecx=4*0=0</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464354</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, [<span class="hljs-built_in">ecx</span>+<span class="hljs-built_in">eax</span>]  <span class="hljs-comment">; å³[ebp+var_58]</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464357</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ecx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464358</span>                 <span class="hljs-keyword">push</span>    offset aDDDD    <span class="hljs-comment">; &quot;%d,%d,%d,%d&quot;</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0046435D</span>                 <span class="hljs-keyword">call</span>    sub_45DB59      <span class="hljs-comment">; printf</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464362</span>                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">14h</span><br></code></pre></td></tr></table></figure><p>æºç </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> num[<span class="hljs-number">2</span>][<span class="hljs-number">2</span>] = &#123; &#123;<span class="hljs-number">1</span>,<span class="hljs-number">2</span>&#125;,&#123;<span class="hljs-number">3</span>,<span class="hljs-number">4</span>&#125; &#125;;<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d,%d,%d,%d&quot;</span>, num[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>], num[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>], num[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>], num[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>]);<br></code></pre></td></tr></table></figure></li></ul>]]></content>
    
    
    <summary type="html">æ•°ç»„ä¸æŒ‡é’ˆè¯†åˆ«</summary>
    
    
    
    <category term="Reverse Engineering" scheme="https://sydzi.github.io/categories/Reverse-Engineering/"/>
    
    
    <category term="CTF" scheme="https://sydzi.github.io/tags/CTF/"/>
    
    <category term="Reverse" scheme="https://sydzi.github.io/tags/Reverse/"/>
    
  </entry>
  
  <entry>
    <title>Day6:if-elseè¯­å¥è¯†åˆ«ã€switchè¯­å¥è¯†åˆ«ã€å¾ªç¯è¯­å¥è¯†åˆ«</title>
    <link href="https://sydzi.github.io/2025/07/15/Day6-switch%E8%AF%AD%E5%8F%A5%E8%AF%86%E5%88%AB/"/>
    <id>https://sydzi.github.io/2025/07/15/Day6-switch%E8%AF%AD%E5%8F%A5%E8%AF%86%E5%88%AB/</id>
    <published>2025-07-15T07:50:16.000Z</published>
    <updated>2025-09-18T03:57:01.307Z</updated>
    
    <content type="html"><![CDATA[<p>if-elseè¯­å¥è¯†åˆ«ã€switchè¯­å¥è¯†åˆ«ã€å¾ªç¯è¯­å¥è¯†åˆ«</p><span id="more"></span><h2 id="if-elseè¯­å¥è¯†åˆ«"><a href="#if-elseè¯­å¥è¯†åˆ«" class="headerlink" title="if-elseè¯­å¥è¯†åˆ«"></a>if-elseè¯­å¥è¯†åˆ«</h2><ul><li><p>ç¬¬ä¸€ç§ï¼Œæ•°å€¼æ¯”è¾ƒä½œä¸ºæ¡ä»¶ï¼ˆx86debugä¸ºä¾‹ï¼Œå…¶ä½™ç±»ä¼¼ï¼Œä»…æ˜¯æ¯”è¾ƒæ–¹æ³•ï¼ˆå¦‚ä½¿ç”¨subè€Œä¸æ˜¯cmpï¼‰å’Œæ¨¡å¼ç‰¹å¾ä¸Šçš„å·®å¼‚ï¼‰</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-symbol">.text:</span>004702D0                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_C]<br><span class="hljs-symbol">.text:</span>004702D3                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>004702D4                 <span class="hljs-keyword">push</span>    offset unk_545E50 <span class="hljs-comment">; %d</span><br><span class="hljs-symbol">.text:</span>004702D9                 <span class="hljs-keyword">call</span>    sub_4681E0      <span class="hljs-comment">; scanf</span><br><span class="hljs-symbol">.text:</span>004702DE                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span>004702E1                 <span class="hljs-keyword">cmp</span>     [<span class="hljs-built_in">ebp</span>+var_C], <span class="hljs-number">1</span><br><span class="hljs-symbol">.text:</span>004702E5                 <span class="hljs-keyword">jnz</span>     short loc_4702F6 <span class="hljs-comment">; if [ebp+var_C]!=1, jump to loc_4702f6</span><br><span class="hljs-symbol">.text:</span>004702E7                 <span class="hljs-keyword">push</span>    offset aNEquales1 <span class="hljs-comment">; &quot;n equales 1&quot;</span><br><span class="hljs-symbol">.text:</span>004702EC                 <span class="hljs-keyword">call</span>    sub_468D1B      <span class="hljs-comment">; printf</span><br><span class="hljs-symbol">.text:</span>004702F1                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">4</span><br><span class="hljs-symbol">.text:</span>004702F4                 <span class="hljs-keyword">jmp</span>     short loc_470303<br><span class="hljs-symbol">.text:</span>004702F6 <span class="hljs-comment">; ---------------------------------------------------------------------------</span><br><span class="hljs-symbol">.text:</span>004702F6<br><span class="hljs-symbol">.text:</span>004702F6 loc_4702F6:                             <span class="hljs-comment">; CODE XREF: main+45â†‘j</span><br><span class="hljs-symbol">.text:</span>004702F6                 <span class="hljs-keyword">push</span>    offset aNDoesNotEqual1 <span class="hljs-comment">; &quot;n does not equal 1&quot;</span><br><span class="hljs-symbol">.text:</span>004702FB                 <span class="hljs-keyword">call</span>    sub_468D1B      <span class="hljs-comment">; printf</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470300</span>                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">4</span><br></code></pre></td></tr></table></figure><p>æºç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> n;<br><span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);<br><span class="hljs-keyword">if</span> (n == <span class="hljs-number">1</span>)<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;n equales 1&quot;</span>);<br><span class="hljs-keyword">else</span><br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;n does not equal 1&quot;</span>);<br></code></pre></td></tr></table></figure></li><li><p>ç¬¬äºŒç§ï¼Œå˜é‡ç›´æ¥ä½œä¸ºæ¡ä»¶</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-symbol">.text:</span><span class="hljs-number">00470303</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_18]<br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470306</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470307</span>                 <span class="hljs-keyword">push</span>    offset unk_545E50 <span class="hljs-comment">; %d</span><br><span class="hljs-symbol">.text:</span>0047030C                 <span class="hljs-keyword">call</span>    sub_4681E0      <span class="hljs-comment">; scanf</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470311</span>                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470314</span>                 <span class="hljs-keyword">cmp</span>     [<span class="hljs-built_in">ebp</span>+var_18], <span class="hljs-number">0</span> <span class="hljs-comment">; å’Œ&#x27;0&#x27;æ¯”è¾ƒ</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470318</span>                 <span class="hljs-keyword">jz</span>      short loc_470327 <span class="hljs-comment">; if [ebp+var_18]==0, jump to loc_470327, è·³è¿‡printf</span><br><span class="hljs-symbol">.text:</span>0047031A                 <span class="hljs-keyword">push</span>    offset aJudgeIsNotZero <span class="hljs-comment">; &quot;judge is not zero&quot;</span><br><span class="hljs-symbol">.text:</span>0047031F                 <span class="hljs-keyword">call</span>    sub_468D1B      <span class="hljs-comment">; printf</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470324</span>                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">4</span><br></code></pre></td></tr></table></figure><p>æºç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> judge;<br><span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;judge);<br><span class="hljs-keyword">if</span> (judge)<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;judge is not zero&quot;</span>);<br></code></pre></td></tr></table></figure></li><li><p>ç¬¬ä¸‰ç§ï¼Œè¿”å›å€¼ï¼ˆå‡½æ•°å¼ï¼‰ä½œä¸ºæ¡ä»¶</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-symbol">.text:</span><span class="hljs-number">00470387</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_24]<br><span class="hljs-symbol">.text:</span>0047038A                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>0047038B                 <span class="hljs-keyword">push</span>    offset unk_545E50 <span class="hljs-comment">; %d</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470390</span>                 <span class="hljs-keyword">call</span>    sub_4681E0      <span class="hljs-comment">; scanf</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470395</span>                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470398</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_24]<br><span class="hljs-symbol">.text:</span>0047039B                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span>             <span class="hljs-comment">; è¾“å…¥çš„å€¼å…¥æ ˆï¼Œå³å‡½æ•°ä¼ å‚</span><br><span class="hljs-symbol">.text:</span>0047039C                 <span class="hljs-keyword">call</span>    sub_46B214      <span class="hljs-comment">; è‡ªå®šä¹‰å‡½æ•°</span><br><span class="hljs-symbol">.text:</span>004703A1                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">4</span><br><span class="hljs-symbol">.text:</span>004703A4                 <span class="hljs-keyword">test</span>    <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">eax</span>        <span class="hljs-comment">; 1 &amp; 1 = 0ï¼› 0 &amp; 0 = 1</span><br><span class="hljs-symbol">.text:</span>004703A6                 <span class="hljs-keyword">jz</span>      short loc_4703B5<br><span class="hljs-symbol">.text:</span>004703A8                 <span class="hljs-keyword">push</span>    offset aItS0    <span class="hljs-comment">; &quot;it&#x27;s 0\n&quot;</span><br><span class="hljs-symbol">.text:</span>004703AD                 <span class="hljs-keyword">call</span>    sub_468D1B<br><span class="hljs-symbol">.text:</span>004703B2                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">4</span><br><br><span class="hljs-comment">;sub_46b214</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470110</span> arg_0           = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span>  <span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470110</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470110</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470111</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">esp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470113</span>                 <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0C0h</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470119</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ebx</span><br><span class="hljs-symbol">.text:</span>0047011A                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">esi</span><br><span class="hljs-symbol">.text:</span>0047011B                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">edi</span><br><span class="hljs-symbol">.text:</span>0047011C                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">edi</span>, <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span>0047011E                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-built_in">ecx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470120</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">0CCCCCCCCh</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470125</span>                 <span class="hljs-keyword">rep</span> <span class="hljs-keyword">stosd</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470127</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, offset unk_57500E<br><span class="hljs-symbol">.text:</span>0047012C                 <span class="hljs-keyword">call</span>    sub_46B660<br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470131</span>                 <span class="hljs-keyword">nop</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470132</span>                 <span class="hljs-keyword">cmp</span>     [<span class="hljs-built_in">ebp</span>+arg_0], <span class="hljs-number">0</span>  <span class="hljs-comment">; [ebp+8], eaxåœ¨æ ˆä¸Šçš„ä½ç½®</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470136</span>                 <span class="hljs-keyword">jnz</span>     short loc_470141 <span class="hljs-comment">; eax=0</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470138</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">1</span>          <span class="hljs-comment">; if [ebp+arg_0]==0, eax=1, return 1(eax)</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0047013D</span>                 <span class="hljs-keyword">jmp</span>     short loc_470143<br><span class="hljs-symbol">.text:</span>0047013F <span class="hljs-comment">; ---------------------------------------------------------------------------</span><br><span class="hljs-symbol">.text:</span>0047013F                 <span class="hljs-keyword">jmp</span>     short loc_470143<br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470141</span> <span class="hljs-comment">; ---------------------------------------------------------------------------</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470141</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470141</span> loc_470141:                             <span class="hljs-comment">; CODE XREF: sub_470110+26â†‘j</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470141</span>                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">eax</span>        <span class="hljs-comment">; eax=0</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470143</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470143</span> loc_470143:                             <span class="hljs-comment">; CODE XREF: sub_470110+2Dâ†‘j</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470143</span>                                         <span class="hljs-comment">; sub_470110+2Fâ†‘j</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470143</span>                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">edi</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470144</span>                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">esi</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470145</span>                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ebx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470146</span>                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0C0h</span><br><span class="hljs-symbol">.text:</span>0047014C                 <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">esp</span><br><span class="hljs-symbol">.text:</span>0047014E                 <span class="hljs-keyword">call</span>    sub_46A62A<br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470153</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470155</span>                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470156</span>                 <span class="hljs-keyword">retn</span><br></code></pre></td></tr></table></figure><p>æºç </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">IfZero</span><span class="hljs-params">(<span class="hljs-type">int</span> a)</span> &#123;<br><span class="hljs-keyword">if</span> (a == <span class="hljs-number">0</span>)<br><span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br><span class="hljs-keyword">else</span><br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;<br>    <span class="hljs-type">int</span> a;<br><span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;a);<br><span class="hljs-keyword">if</span>(IfZero(a))<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;it&#x27;s 0\n&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></li></ul><h2 id="switchè¯­å¥è¯†åˆ«"><a href="#switchè¯­å¥è¯†åˆ«" class="headerlink" title="switchè¯­å¥è¯†åˆ«"></a>switchè¯­å¥è¯†åˆ«</h2><ul><li><p>æ¯”è¾ƒç®€å•çš„æƒ…å†µä¸‹ï¼š</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-symbol">.text:</span><span class="hljs-number">00470327</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_24]<br><span class="hljs-symbol">.text:</span>0047032A                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>0047032B                 <span class="hljs-keyword">push</span>    offset unk_545E50 <span class="hljs-comment">; %d</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470330</span>                 <span class="hljs-keyword">call</span>    sub_4681E0      <span class="hljs-comment">; scanf</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470335</span>                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470338</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_24]<br><span class="hljs-symbol">.text:</span>0047033B                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_EC], <span class="hljs-built_in">eax</span> <span class="hljs-comment">; [ebp+var_EC]==[ebp+var_24], ç”¨ä¸´æ—¶å˜é‡[ebp+var_EC]æ¥æ£€éªŒcase</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470341</span>                 <span class="hljs-keyword">cmp</span>     [<span class="hljs-built_in">ebp</span>+var_EC], <span class="hljs-number">1</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470348</span>                 <span class="hljs-keyword">jz</span>      short loc_47035E <span class="hljs-comment">; case1è¾“å‡º</span><br><span class="hljs-symbol">.text:</span>0047034A                 <span class="hljs-keyword">cmp</span>     [<span class="hljs-built_in">ebp</span>+var_EC], <span class="hljs-number">5</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470351</span>                 <span class="hljs-keyword">jz</span>      short loc_470371 <span class="hljs-comment">; case5è¾“å‡º</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470353</span>                 <span class="hljs-keyword">cmp</span>     [<span class="hljs-built_in">ebp</span>+var_EC], <span class="hljs-number">0Ah</span><br><span class="hljs-symbol">.text:</span>0047035A                 <span class="hljs-keyword">jz</span>      short loc_470384 <span class="hljs-comment">; case10è¾“å‡º</span><br><span class="hljs-symbol">.text:</span>0047035C                 <span class="hljs-keyword">jmp</span>     short loc_470395 <span class="hljs-comment">; breakç„¶åsystem(&quot;pause&quot;)</span><br><span class="hljs-symbol">.text:</span>0047035E <span class="hljs-comment">; ---------------------------------------------------------------------------</span><br><span class="hljs-symbol">.text:</span>0047035E<br><span class="hljs-symbol">.text:</span>0047035E loc_47035E:                             <span class="hljs-comment">; CODE XREF: main+A8â†‘j</span><br><span class="hljs-symbol">.text:</span>0047035E                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_24]<br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470361</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470362</span>                 <span class="hljs-keyword">push</span>    offset aNEqualsD <span class="hljs-comment">; &quot;n equals %d&quot;</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470367</span>                 <span class="hljs-keyword">call</span>    sub_468D1B      <span class="hljs-comment">; printf</span><br><span class="hljs-symbol">.text:</span>0047036C                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span>0047036F                 <span class="hljs-keyword">jmp</span>     short loc_470395<br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470371</span> <span class="hljs-comment">; ---------------------------------------------------------------------------</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470371</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470371</span> loc_470371:                             <span class="hljs-comment">; CODE XREF: main+B1â†‘j</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470371</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_24]<br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470374</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470375</span>                 <span class="hljs-keyword">push</span>    offset aNEqualsD <span class="hljs-comment">; &quot;n equals %d&quot;</span><br><span class="hljs-symbol">.text:</span>0047037A                 <span class="hljs-keyword">call</span>    sub_468D1B      <span class="hljs-comment">; printf</span><br><span class="hljs-symbol">.text:</span>0047037F                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470382</span>                 <span class="hljs-keyword">jmp</span>     short loc_470395<br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470384</span> <span class="hljs-comment">; ---------------------------------------------------------------------------</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470384</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470384</span> loc_470384:                             <span class="hljs-comment">; CODE XREF: main+BAâ†‘j</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470384</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_24]<br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470387</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470388</span>                 <span class="hljs-keyword">push</span>    offset aNEqualsD <span class="hljs-comment">; &quot;n equals %d&quot;</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0047038D</span>                 <span class="hljs-keyword">call</span>    sub_468D1B      <span class="hljs-comment">; printf</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470392</span>                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470395</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470395</span> loc_470395:                             <span class="hljs-comment">; CODE XREF: main+BCâ†‘j</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470395</span>                                         <span class="hljs-comment">; main+CFâ†‘j ...</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470395</span>                 <span class="hljs-keyword">push</span>    offset aPause   <span class="hljs-comment">; &quot;pause&quot;</span><br><span class="hljs-symbol">.text:</span>0047039A                 <span class="hljs-keyword">call</span>    sub_46AFAD      <span class="hljs-comment">; system(&quot;pause&quot;)</span><br><span class="hljs-symbol">.text:</span>0047039F                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">4</span><br></code></pre></td></tr></table></figure><p>æºç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> number;<br><span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;number);<br><span class="hljs-keyword">switch</span> (number) &#123;<br><span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;n equals %d&quot;</span>, number);<br><span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-number">5</span>:<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;n equals %d&quot;</span>, number);<br><span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-number">10</span>:<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;n equals %d&quot;</span>, number);<br><span class="hljs-keyword">break</span>;<br>&#125;<br>system(<span class="hljs-string">&quot;pause&quot;</span>);<br></code></pre></td></tr></table></figure></li><li><p>å†å¤æ‚ç‚¹ï¼Œä¼šä¼˜åŒ–å‡ºè·³è½¬è¡¨ï¼Œå³æ¯ä¸ªcaseè·³è½¬çš„åœ°å€ä¼šè¢«é›†åˆæˆä¸€ä¸ªæ•°ç»„ï¼Œåƒè¡¨ä¸€æ ·</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-symbol">.text:</span>004702D3                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>004702D4                 <span class="hljs-keyword">push</span>    offset unk_545E50 <span class="hljs-comment">; %d</span><br><span class="hljs-symbol">.text:</span>004702D9                 <span class="hljs-keyword">call</span>    sub_4681E0      <span class="hljs-comment">; scanf</span><br><span class="hljs-symbol">.text:</span>004702DE                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span>004702E1                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_C]<br><span class="hljs-symbol">.text:</span>004702E4                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_D4], <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>004702EA                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, [<span class="hljs-built_in">ebp</span>+var_D4] <span class="hljs-comment">; æŠŠè¾“å…¥å€¼ä¼ åˆ°ecxï¼Œä¸‹ä¸€æ­¥å‡å»1ï¼Œå‡1çš„åŸå› è§åé¢çš„è§£é‡Š</span><br><span class="hljs-symbol">.text:</span>004702F0                 <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-number">1</span>          <span class="hljs-comment">; switch 67 cases</span><br><span class="hljs-symbol">.text:</span>004702F3                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_D4], <span class="hljs-built_in">ecx</span><br><span class="hljs-symbol">.text:</span>004702F9                 <span class="hljs-keyword">cmp</span>     [<span class="hljs-built_in">ebp</span>+var_D4], <span class="hljs-number">42h</span> <span class="hljs-comment">; æŠŠè¾“å…¥å€¼å’Œ42h(66)æ¯”è¾ƒï¼Œä¸‹ä¸€æ­¥æ˜¯å¤§äº66å°±è·³å‡ºcaseçš„åˆ¤æ–­</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470300</span>                 <span class="hljs-keyword">ja</span>      def_470313      <span class="hljs-comment">; jumptable 00470313 default case, cases 2,4,6-9,12-16,18-66</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470306</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">edx</span>, [<span class="hljs-built_in">ebp</span>+var_D4]<br><span class="hljs-symbol">.text:</span>0047030C                 <span class="hljs-keyword">movzx</span>   <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">ds</span>:byte_470418[<span class="hljs-built_in">edx</span>] <span class="hljs-comment">; è·³è½¬è¡¨ç´¢å¼•å€¼è¡¨ï¼Œå³é¢„åˆ¤äº†è¾“å…¥å€¼çš„èŒƒå›´å¹¶ä¸”ä¸ºæ¯ä¸ªå¯èƒ½çš„å€¼å»ºç«‹äº†ç´¢å¼•å€¼è¡¨ï¼ˆæ¯”å¦‚è¯´ç°åœ¨ç¡®å®šäº†èŒƒå›´æ˜¯0-66ï¼Œå°±æšä¸¾äº†0-66è¿™äº›æ•°å€¼å¯¹åº”çš„ç´¢å¼•ï¼Œç„¶åå†æ ¹æ®ç´¢å¼•æ‰¾åˆ°åº”æ”¹è·³è½¬çš„åœ°å€</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470313</span>                 <span class="hljs-keyword">jmp</span>     <span class="hljs-built_in">ds</span>:jpt_470313[<span class="hljs-built_in">eax</span>*<span class="hljs-number">4</span>] <span class="hljs-comment">; switch jump</span><br><span class="hljs-symbol">.text:</span>0047031A <span class="hljs-comment">; ---------------------------------------------------------------------------</span><br><span class="hljs-symbol">.text:</span>0047031A<br><span class="hljs-symbol">.text:</span>0047031A loc_47031A:                             <span class="hljs-comment">; CODE XREF: sub_4702A0+73â†‘j</span><br><span class="hljs-symbol">.text:</span>0047031A                                         <span class="hljs-comment">; DATA XREF: .text:jpt_470313â†“o</span><br><span class="hljs-symbol">.text:</span>0047031A                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_C] <span class="hljs-comment">; jumptable 00470313 case 1</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0047031D</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>0047031E                 <span class="hljs-keyword">push</span>    offset aNEqualsD <span class="hljs-comment">; &quot;n equals %d&quot;</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470323</span>                 <span class="hljs-keyword">call</span>    sub_468D1B      <span class="hljs-comment">; printf</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470328</span>                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span>0047032B                 <span class="hljs-keyword">jmp</span>     short def_470313 <span class="hljs-comment">; jumptable 00470313 default case, cases 2,4,6-9,12-16,18-66</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0047032D</span> <span class="hljs-comment">; ---------------------------------------------------------------------------</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0047032D</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0047032D</span> loc_47032D:                             <span class="hljs-comment">; CODE XREF: sub_4702A0+73â†‘j</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0047032D</span>                                         <span class="hljs-comment">; DATA XREF: .text:jpt_470313â†“o</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0047032D</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_C] <span class="hljs-comment">; jumptable 00470313 case 5</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470330</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470331</span>                 <span class="hljs-keyword">push</span>    offset aNEqualsD <span class="hljs-comment">; &quot;n equals %d&quot;</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470336</span>                 <span class="hljs-keyword">call</span>    sub_468D1B      <span class="hljs-comment">; printf</span><br><span class="hljs-symbol">.text:</span>0047033B                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span>0047033E                 <span class="hljs-keyword">jmp</span>     short def_470313 <span class="hljs-comment">; jumptable 00470313 default case, cases 2,4,6-9,12-16,18-66</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470340</span> <span class="hljs-comment">; ---------------------------------------------------------------------------</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470340</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470340</span> loc_470340:                             <span class="hljs-comment">; CODE XREF: sub_4702A0+73â†‘j</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470340</span>                                         <span class="hljs-comment">; DATA XREF: .text:jpt_470313â†“o</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470340</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_C] <span class="hljs-comment">; jumptable 00470313 case 10</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470343</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470344</span>                 <span class="hljs-keyword">push</span>    offset aNEqualsD <span class="hljs-comment">; &quot;n equals %d&quot;</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470349</span>                 <span class="hljs-keyword">call</span>    sub_468D1B      <span class="hljs-comment">; printf</span><br><span class="hljs-symbol">.text:</span>0047034E                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470351</span>                 <span class="hljs-keyword">jmp</span>     short def_470313 <span class="hljs-comment">; jumptable 00470313 default case, cases 2,4,6-9,12-16,18-66</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470353</span> <span class="hljs-comment">; ---------------------------------------------------------------------------</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470353</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470353</span> loc_470353:                             <span class="hljs-comment">; CODE XREF: sub_4702A0+73â†‘j</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470353</span>                                         <span class="hljs-comment">; DATA XREF: .text:jpt_470313â†“o</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470353</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_C] <span class="hljs-comment">; jumptable 00470313 case 17</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470356</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470357</span>                 <span class="hljs-keyword">push</span>    offset aNEqualsD <span class="hljs-comment">; &quot;n equals %d&quot;</span><br><span class="hljs-symbol">.text:</span>0047035C                 <span class="hljs-keyword">call</span>    sub_468D1B      <span class="hljs-comment">; printf</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470361</span>                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470364</span>                 <span class="hljs-keyword">jmp</span>     short def_470313 <span class="hljs-comment">; jumptable 00470313 default case, cases 2,4,6-9,12-16,18-66</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470366</span> <span class="hljs-comment">; ---------------------------------------------------------------------------</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470366</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470366</span> loc_470366:                             <span class="hljs-comment">; CODE XREF: sub_4702A0+73â†‘j</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470366</span>                                         <span class="hljs-comment">; DATA XREF: .text:jpt_470313â†“o</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470366</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_C] <span class="hljs-comment">; jumptable 00470313 case 11</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470369</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>0047036A                 <span class="hljs-keyword">push</span>    offset aNEqualsD <span class="hljs-comment">; &quot;n equals %d&quot;</span><br><span class="hljs-symbol">.text:</span>0047036F                 <span class="hljs-keyword">call</span>    sub_468D1B      <span class="hljs-comment">; printf</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470374</span>                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470377</span>                 <span class="hljs-keyword">jmp</span>     short def_470313 <span class="hljs-comment">; jumptable 00470313 default case, cases 2,4,6-9,12-16,18-66</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470379</span> <span class="hljs-comment">; ---------------------------------------------------------------------------</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470379</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470379</span> loc_470379:                             <span class="hljs-comment">; CODE XREF: sub_4702A0+73â†‘j</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470379</span>                                         <span class="hljs-comment">; DATA XREF: .text:jpt_470313â†“o</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470379</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_C] <span class="hljs-comment">; jumptable 00470313 case 67</span><br><span class="hljs-symbol">.text:</span>0047037C                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0047037D</span>                 <span class="hljs-keyword">push</span>    offset aNEqualsD <span class="hljs-comment">; &quot;n equals %d&quot;</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470382</span>                 <span class="hljs-keyword">call</span>    sub_468D1B      <span class="hljs-comment">; printf</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470387</span>                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span>0047038A                 <span class="hljs-keyword">jmp</span>     short def_470313 <span class="hljs-comment">; jumptable 00470313 default case, cases 2,4,6-9,12-16,18-66</span><br><span class="hljs-symbol">.text:</span>0047038C <span class="hljs-comment">; ---------------------------------------------------------------------------</span><br><span class="hljs-symbol">.text:</span>0047038C<br><span class="hljs-symbol">.text:</span>0047038C loc_47038C:                             <span class="hljs-comment">; CODE XREF: sub_4702A0+73â†‘j</span><br><span class="hljs-symbol">.text:</span>0047038C                                         <span class="hljs-comment">; DATA XREF: .text:jpt_470313â†“o</span><br><span class="hljs-symbol">.text:</span>0047038C                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_C] <span class="hljs-comment">; jumptable 00470313 case 3</span><br><span class="hljs-symbol">.text:</span>0047038F                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470390</span>                 <span class="hljs-keyword">push</span>    offset aNEqualsD <span class="hljs-comment">; &quot;n equals %d&quot;</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00470395</span>                 <span class="hljs-keyword">call</span>    sub_468D1B      <span class="hljs-comment">; printf</span><br><span class="hljs-symbol">.text:</span>0047039A                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0047039D</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0047039D</span> def_470313:                             <span class="hljs-comment">; CODE XREF: sub_4702A0+60â†‘j</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0047039D</span>                                         <span class="hljs-comment">; sub_4702A0+73â†‘j ...</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0047039D</span>                 <span class="hljs-keyword">push</span>    offset aPause   <span class="hljs-comment">; jumptable 00470313 default case, cases 2,4,6-9,12-16,18-66</span><br><span class="hljs-symbol">.text:</span>004703A2                 <span class="hljs-keyword">call</span>    sub_46AFAD      <span class="hljs-comment">; system</span><br><span class="hljs-symbol">.text:</span>004703A7                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">4</span><br></code></pre></td></tr></table></figure><p>æºç </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> number;<br><span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;number);<br><span class="hljs-keyword">switch</span> (number) &#123;<br><span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;n equals %d&quot;</span>, number);<br><span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-number">5</span>:<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;n equals %d&quot;</span>, number);<br><span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-number">10</span>:<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;n equals %d&quot;</span>, number);<br><span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-number">17</span>:<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;n equals %d&quot;</span>, number);<br><span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-number">11</span>:<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;n equals %d&quot;</span>, number);<br><span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-number">67</span>:<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;n equals %d&quot;</span>, number);<br><span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;n equals %d&quot;</span>, number);<br><span class="hljs-keyword">break</span>;<br>&#125;<br>system(<span class="hljs-string">&quot;pause&quot;</span>);<br></code></pre></td></tr></table></figure></li><li><p>å¯¹è·³è½¬è¡¨å’Œç´¢å¼•å€¼è¡¨è¿›è¡Œè¿›ä¸€æ­¥è§£é‡Šï¼š</p><p>å…ˆçœ‹è·³è½¬è¡¨ï¼š</p><p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-07-16%20000211.png" alt="è·³è½¬è¡¨"></p><p>å¯ä»¥çœ‹åˆ°è·³è½¬è¡¨åªæœ‰ç®€å•çš„8ç§æƒ…å†µã€‚ä½†æ˜¯ç¼–è¯‘å™¨ï¼ˆåç¼–è¯‘å™¨ï¼Ÿï¼‰åªèƒ½æ ¹æ®caseçš„æœ€å¤§å€¼ç”¨ç¬¨æ–¹æ³•æšä¸¾å¯èƒ½çš„å€¼ï¼Œè¿™æ—¶å€™ï¼Œå°±å¯ä»¥ç»™è¿™äº›æšä¸¾çš„å€¼åˆ†æˆä¸¤ç§ï¼šä¸€ç§æ˜¯caseé‡Œæœ‰çš„ï¼Œä¸€ç§æ˜¯caseé‡Œæ²¡æœ‰çš„ã€‚çœ‹è·³è½¬è¡¨çš„æœ€åä¸€ä¸ªï¼Œå«defè€Œä¸æ˜¯locï¼Œè¿™ä¸ªå°±æ˜¯ç»™caseé‡Œæ²¡æœ‰çš„æšä¸¾å€¼å‡†å¤‡çš„ã€‚å› ä¸ºåˆ†ä¸ºcaseé‡Œæœ‰çš„å’Œæ²¡æœ‰çš„ï¼Œå› æ­¤ï¼Œcaseé‡Œæœ‰çš„ï¼Œä¼šç»™å‡ºå…·ä½“çš„ç´¢å¼•å€¼ï¼›caseé‡Œæ²¡æœ‰çš„ï¼Œç»Ÿä¸€å¯¼å‘è·³è½¬è¡¨çš„æœ€åä¸€ä¸ªã€‚å†çœ‹ç´¢å¼•å€¼è¡¨ï¼š</p><p><img src="/../images/image-20250716001640839.png" alt="ç´¢å¼•å€¼è¡¨"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œé‡Œé¢æšä¸¾äº†0åˆ°66å¯¹åº”çš„ç´¢å¼•å€¼ã€‚çœ‹æ±‡ç¼–ä»£ç ï¼Œæ˜¯å°†è¾“å…¥çš„å€¼ä½œä¸ºç´¢å¼•å€¼è¡¨çš„ç´¢å¼•æ¥ç”¨çš„ï¼Œç´¢å¼•å‡ºæ¥çš„å€¼å†ä½œä¸ºè·³è½¬è¡¨çš„ç´¢å¼•ã€‚æ³¨æ„çœ‹ï¼Œç´¢å¼•å€¼è¡¨çš„æœ€å°å€¼ä¸º0ï¼Œå› æ­¤ï¼Œè·³è½¬è¡¨å’Œæ•°ç»„ä¸€æ ·ä»0å¼€å§‹ç´¢å¼•ï¼Œè€Œ0-7å¯¹åº”è·³è½¬è¡¨çš„å…«ç§æƒ…å†µã€‚é€šè¿‡è¿›ä¸€æ­¥æŒ–æ˜ä¿¡æ¯ï¼Œè¿˜å¯ä»¥çŸ¥é“è·³è½¬è¡¨æ˜¯æŠŠcaseæŒ‰ç…§ä»å°åˆ°å¤§çš„é¡ºåºæ’åˆ—çš„ã€‚å› æ­¤ï¼Œæœ€å¼€å§‹ä¼šå¯¹è¾“å…¥å€¼æœ‰ä¸€ä¸ªå‡çš„æ“ä½œã€‚è‡³äºä¸ºä»€ä¹ˆå‡1ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ¨æµ‹æœ€å°çš„caseæ˜¯1äº†ï¼Œå› ä¸ºç´¢å¼•ä»0å¼€å§‹ï¼Œè€Œæœ€å°çš„caseåœ¨ç´¢å¼•0å¤„ã€‚</p></li><li><p>è¿™æ ·è§£é‡Šä¸‹æ¥å¯èƒ½è¿˜æœ‰ç‚¹ç»•ï¼Œæ‰€ä»¥æˆ‘ä»¬æŒ‰ç…§æœºå™¨çš„åŠ¨ä½œèµ°ä¸€éï¼š</p><p>é¦–å…ˆï¼ŒæŠŠcaseæŒ‰é¡ºåºæ’å‡ºè·³è½¬è¡¨ã€‚</p><p>ç„¶åï¼Œå‡è®¾æˆ‘ä»¬æ‹¿åˆ°è¾“å…¥çš„å€¼ã€‚ä½œä¸ºæœºå™¨ï¼Œæˆ‘ä»¬çŸ¥é“caseæœ‰ï¼š1ï¼Œ3ï¼Œ5ï¼Œ10ï¼Œ17ï¼Œ11ï¼Œ67ï¼Œæ‰€ä»¥å…ˆç»™è¾“å…¥çš„å€¼å‡1ï¼Œä»¥ä¾¿è¿™ä¸ªå€¼æ˜¯1çš„æ—¶å€™æˆ‘ä»¬å¯ä»¥ç´¢å¼•åˆ°è·³è½¬è¡¨ä¸‹æ ‡0å¤„ã€‚åŒæ—¶ï¼Œå¦‚æœè¿™ä¸ªå€¼å¤§äº66ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ç›´æ¥è·³è¿‡caseæ£€æŸ¥ï¼Œç›´æ¥å¯¼å‡ºå»ï¼ˆåˆšå¥½å’Œåœ¨caseæœ€å¤§æœ€å°å€¼èŒƒå›´å†…ä½†ä¸æ˜¯caseçš„å€¼ä¸€æ ·å¯¹å¾…ï¼‰</p><p>å†ç„¶åï¼Œæˆ‘ä»¬æšä¸¾0-66çš„å€¼ï¼Œå¹¶ä¸”æŠŠè¿™äº›å€¼å’Œcaseé‡Œæœ‰çš„å€¼ä¸€ä¸€æ¯”è¾ƒï¼Œåˆ†å‡ºä¸¤ç§å€¼ï¼šä¸€ç§åœ¨caseé‡Œï¼Œä¸€ç§ä¸å†caseé‡Œã€‚</p><p>okï¼Œç„¶åæˆ‘ä»¬å»ºç«‹ç´¢å¼•å€¼è¡¨ï¼Œç»™åœ¨caseé‡Œçš„æšä¸¾å€¼å¯¹åº”çš„è·³è½¬è¡¨ç´¢å¼•å€¼ï¼Œæ¯”å¦‚è¯´æšä¸¾å€¼2ï¼ˆè¾“å…¥å€¼æ˜¯3ï¼‰ï¼Œåˆšå¥½caseé‡Œæœ‰3ï¼ŒæŒ‰é¡ºåºæ’ç¬¬äºŒï¼Œæˆ‘ä»¬å°±ç»™ç´¢å¼•å€¼1ï¼ˆä»0å¼€å§‹ç´¢å¼•ï¼‰ã€‚å›å¤´çœ‹æˆªå‡ºæ¥çš„ç´¢å¼•å€¼è¡¨ï¼Œåœ¨ä¸‹æ ‡2çš„åœ°æ–¹åˆšå¥½æ˜¯1ï¼ˆæšä¸¾å€¼ç´¢å¼•å‡ºè·³è½¬è¡¨ç´¢å¼•ï¼‰ï¼›ç»™ä¸åœ¨caseé‡Œçš„å€¼ç´¢å¼•åˆ°7ï¼Œå¯¹åº”è·³è½¬è¡¨æœ€åä¸€ä½ï¼ˆä¸ºæ²¡åœ¨caseé‡Œçš„å€¼ä¸“é—¨å‡†å¤‡çš„é‚£ä¸€ä½ï¼‰ã€‚</p><p>æœ€åï¼Œæˆ‘ä»¬å°±å‡†å¤‡å¥½æˆ‘ä»¬çš„è§£å†³æ–¹æ¡ˆäº†ï¼Œå¯¹äºä»»æ„è¾“å…¥çš„å€¼æˆ‘ä»¬å°±éƒ½æœ‰å¯¹ç­–äº†ã€‚</p></li><li><p>è¯·åŠ¡å¿…çœŸæ­£ç†è§£ä¸Šè¿°å†…å®¹ï¼Œå› ä¸ºåœ¨é€†å‘å·¥ç¨‹ä¸­ï¼Œè¿™ä¹ˆç»•çš„æ“ä½œå¾ˆå¸¸è§ã€‚åœ¨PEæ–‡ä»¶ç»“æ„éƒ¨åˆ†ï¼Œæˆ‘ä»¬æˆ–è®¸è¿˜æœ‰æœºä¼šå†æ¥è§¦åˆ°è¿™ä¹ˆç»•çš„æ“ä½œã€‚ï¼ˆå…¶å®åªéœ€è¦å†™å‡ºç¨‹åºæ‹¿åˆ°idaé‡Œç‚¹å¼€è·³è½¬è¡¨å’Œç´¢å¼•å€¼è¡¨ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰çœ‹å‡ çœ¼å°±æ˜ç™½äº†ï¼Œäº²èº«å®è·µæ€»æ¯”é˜…è¯»æ–‡å­—æ¥çš„æœ‰æ•ˆï¼Œå› ä¸ºæ–‡å­—è¿˜å–å†³äºä¹¦å†™è€…çš„è¡¨è¾¾æ°´å¹³(â—â€™â—¡â€™â—)ï¼‰</p></li></ul><h2 id="å¾ªç¯è¯­å¥è¯†åˆ«"><a href="#å¾ªç¯è¯­å¥è¯†åˆ«" class="headerlink" title="å¾ªç¯è¯­å¥è¯†åˆ«"></a>å¾ªç¯è¯­å¥è¯†åˆ«</h2><ul><li><p>ç¬¬ä¸€ç§ï¼Œforå¾ªç¯</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-symbol">.text:</span><span class="hljs-number">00464096</span>                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_8], <span class="hljs-number">0</span>  <span class="hljs-comment">; ä¸€ä¸ªå˜é‡åˆå§‹åŒ–ä¸º0</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0046409D</span>                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_14], <span class="hljs-number">1</span> <span class="hljs-comment">; å¦ä¸€ä¸ªå˜é‡åˆå§‹åŒ–ä¸º1</span><br><span class="hljs-symbol">.text:</span>004640A4                 <span class="hljs-keyword">jmp</span>     short loc_4640AF<br><span class="hljs-symbol">.text:</span>004640A6 <span class="hljs-comment">; ---------------------------------------------------------------------------</span><br><span class="hljs-symbol">.text:</span>004640A6<br><span class="hljs-symbol">.text:</span>004640A6 loc_4640A6:                             <span class="hljs-comment">; CODE XREF: sub_464070+4Eâ†“j</span><br><span class="hljs-symbol">.text:</span>004640A6                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_14]<br><span class="hljs-symbol">.text:</span>004640A9                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">1</span>          <span class="hljs-comment">; ç”¨eaxè¿‡æ¸¡ï¼Œç»™[ebp+var_14]åŠ 1</span><br><span class="hljs-symbol">.text:</span>004640AC                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_14], <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>004640AF<br><span class="hljs-symbol">.text:</span>004640AF loc_4640AF:                             <span class="hljs-comment">; CODE XREF: sub_464070+34â†‘j</span><br><span class="hljs-symbol">.text:</span>004640AF                 <span class="hljs-keyword">cmp</span>     [<span class="hljs-built_in">ebp</span>+var_14], <span class="hljs-number">0Ah</span><br><span class="hljs-symbol">.text:</span>004640B3                 <span class="hljs-keyword">jg</span>      short loc_4640C0 <span class="hljs-comment">; [ebp+var_14]å¤§äº0Ahæ—¶è·³è½¬ï¼ˆå‡ºå¾ªç¯ï¼‰</span><br><span class="hljs-symbol">.text:</span>004640B5                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_8]<br><span class="hljs-symbol">.text:</span>004640B8                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_14] <span class="hljs-comment">; ç”¨eaxè¿‡æ¸¡ï¼ŒæŠŠ[ebp+var_14]çš„å€¼åŠ åˆ°[ebp+var_8]ä¸Š</span><br><span class="hljs-symbol">.text:</span>004640BB                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_8], <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>004640BE                 <span class="hljs-keyword">jmp</span>     short loc_4640A6 <span class="hljs-comment">; è·³å›å»ï¼Œå½¢æˆå¾ªç¯</span><br><span class="hljs-symbol">.text:</span>004640C0 <span class="hljs-comment">; ---------------------------------------------------------------------------</span><br><span class="hljs-symbol">.text:</span>004640C0<br><span class="hljs-symbol">.text:</span>004640C0 loc_4640C0:                             <span class="hljs-comment">; CODE XREF: sub_464070+43â†‘j</span><br><span class="hljs-symbol">.text:</span>004640C0                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_8]<br><span class="hljs-symbol">.text:</span>004640C3                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>004640C4                 <span class="hljs-keyword">push</span>    offset aCountD  <span class="hljs-comment">; &quot;count : %d &quot;</span><br><span class="hljs-symbol">.text:</span>004640C9                 <span class="hljs-keyword">call</span>    sub_45DB54      <span class="hljs-comment">; printf</span><br><span class="hljs-symbol">.text:</span>004640CE                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">8</span><br></code></pre></td></tr></table></figure><p>æºç </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> count = <span class="hljs-number">0</span>;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">10</span>; i++) &#123;<br>count += i;<br>&#125;<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;count : %d &quot;</span>, count);<br></code></pre></td></tr></table></figure></li><li><p>ç¬¬äºŒç§ï¼Œwhileå¾ªç¯</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-symbol">.text:</span>004640D1                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_8], <span class="hljs-number">0</span>  <span class="hljs-comment">; ä¸€ä¸ªå˜é‡åˆå§‹åŒ–ä¸º0</span><br><span class="hljs-symbol">.text:</span>004640D8                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_20], <span class="hljs-number">0Ah</span> <span class="hljs-comment">; å¦ä¸€ä¸ªå˜é‡åˆå§‹åŒ–ä¸º10</span><br><span class="hljs-symbol">.text:</span>004640DF<br><span class="hljs-symbol">.text:</span>004640DF loc_4640DF:                             <span class="hljs-comment">; CODE XREF: sub_464070+87â†“j</span><br><span class="hljs-symbol">.text:</span>004640DF                 <span class="hljs-keyword">cmp</span>     [<span class="hljs-built_in">ebp</span>+var_20], <span class="hljs-number">0</span><br><span class="hljs-symbol">.text:</span>004640E3                 <span class="hljs-keyword">jle</span>     short loc_4640F9 <span class="hljs-comment">; [ebp+var_20]å°äºç­‰äº0æ—¶è·³è½¬ï¼ˆå‡ºå¾ªç¯ï¼‰</span><br><span class="hljs-symbol">.text:</span>004640E5                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_8]<br><span class="hljs-symbol">.text:</span>004640E8                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_20] <span class="hljs-comment">; eaxè¿‡æ¸¡ï¼ŒæŠŠ[ebp+var_20]å€¼åŠ åˆ°[ebp+var_8]ä¸Š</span><br><span class="hljs-symbol">.text:</span>004640EB                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_8], <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>004640EE                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_20]<br><span class="hljs-symbol">.text:</span>004640F1                 <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">1</span>          <span class="hljs-comment">; eaxè¿‡æ¸¡ï¼Œç»™[ebp+var_20]å‡1</span><br><span class="hljs-symbol">.text:</span>004640F4                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_20], <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>004640F7                 <span class="hljs-keyword">jmp</span>     short loc_4640DF <span class="hljs-comment">; å›è·³ï¼Œå½¢æˆå¾ªç¯</span><br><span class="hljs-symbol">.text:</span>004640F9 <span class="hljs-comment">; ---------------------------------------------------------------------------</span><br><span class="hljs-symbol">.text:</span>004640F9<br><span class="hljs-symbol">.text:</span>004640F9 loc_4640F9:                             <span class="hljs-comment">; CODE XREF: sub_464070+73â†‘j</span><br><span class="hljs-symbol">.text:</span>004640F9                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_8]<br><span class="hljs-symbol">.text:</span>004640FC                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>004640FD                 <span class="hljs-keyword">push</span>    offset aCountD  <span class="hljs-comment">; &quot;count : %d &quot;</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464102</span>                 <span class="hljs-keyword">call</span>    sub_45DB54      <span class="hljs-comment">; printf</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464107</span>                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">8</span><br></code></pre></td></tr></table></figure><p>æºç </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> count = <span class="hljs-number">0</span>;<br><span class="hljs-type">int</span> n = <span class="hljs-number">10</span>;<br><span class="hljs-keyword">while</span> (n &gt; <span class="hljs-number">0</span>) &#123;<br>count += n;<br>n--;<br>&#125;<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;count : %d &quot;</span>, count);<br></code></pre></td></tr></table></figure></li><li><p>ç¬¬ä¸‰ç§ï¼Œdo-whileå¾ªç¯</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-symbol">.text:</span>0046410A                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_8], <span class="hljs-number">0</span>  <span class="hljs-comment">; ä¸€ä¸ªå˜é‡åˆå§‹åŒ–ä¸º0</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464111</span>                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_2C], <span class="hljs-number">0Ah</span> <span class="hljs-comment">; å¦ä¸€ä¸ªå˜é‡åˆå§‹åŒ–ä¸º10</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464118</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464118</span> loc_464118:                             <span class="hljs-comment">; CODE XREF: sub_464070+BEâ†“j</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464118</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_8]<br><span class="hljs-symbol">.text:</span>0046411B                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_2C] <span class="hljs-comment">; eaxè¿‡æ¸¡ï¼ŒæŠŠ[ebp+var_2C]å€¼åŠ åˆ°[ebp+var_8]ä¸Š</span><br><span class="hljs-symbol">.text:</span>0046411E                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_8], <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464121</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_2C]<br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464124</span>                 <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">1</span>          <span class="hljs-comment">; eaxè¿‡æ¸¡ï¼Œç»™[ebp+var_2C]å‡1</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464127</span>                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+var_2C], <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>0046412A                 <span class="hljs-keyword">cmp</span>     [<span class="hljs-built_in">ebp</span>+var_2C], <span class="hljs-number">0</span><br><span class="hljs-symbol">.text:</span>0046412E                 <span class="hljs-keyword">jg</span>      short loc_464118 <span class="hljs-comment">; [ebp+var_2C]å¤§äº0æ—¶å›è·³</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464130</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+var_8]<br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464133</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464134</span>                 <span class="hljs-keyword">push</span>    offset aCountD  <span class="hljs-comment">; &quot;count : %d &quot;</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">00464139</span>                 <span class="hljs-keyword">call</span>    sub_45DB54      <span class="hljs-comment">; printf</span><br><span class="hljs-symbol">.text:</span>0046413E                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">8</span><br></code></pre></td></tr></table></figure><p>æºç </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> count = <span class="hljs-number">0</span>;<br><span class="hljs-type">int</span> i = <span class="hljs-number">10</span>;<br><span class="hljs-keyword">do</span> &#123;<br>count += i;<br>i--;<br>&#125; <span class="hljs-keyword">while</span> (i &gt; <span class="hljs-number">0</span>);<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;count : %d &quot;</span>, count);<br></code></pre></td></tr></table></figure></li></ul>]]></content>
    
    
    <summary type="html">if-elseè¯­å¥è¯†åˆ«ã€switchè¯­å¥è¯†åˆ«ã€å¾ªç¯è¯­å¥è¯†åˆ«</summary>
    
    
    
    <category term="Reverse Engineering" scheme="https://sydzi.github.io/categories/Reverse-Engineering/"/>
    
    
    <category term="CTF" scheme="https://sydzi.github.io/tags/CTF/"/>
    
    <category term="Reverse" scheme="https://sydzi.github.io/tags/Reverse/"/>
    
  </entry>
  
  <entry>
    <title>Day5:å‡½æ•°è°ƒç”¨çº¦å®š</title>
    <link href="https://sydzi.github.io/2025/07/12/Day5-%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8%E7%BA%A6%E5%AE%9A/"/>
    <id>https://sydzi.github.io/2025/07/12/Day5-%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8%E7%BA%A6%E5%AE%9A/</id>
    <published>2025-07-12T02:58:24.000Z</published>
    <updated>2025-09-18T03:56:58.663Z</updated>
    
    <content type="html"><![CDATA[<p>å‡½æ•°è°ƒç”¨çº¦å®š</p><span id="more"></span><h2 id="å‡½æ•°è°ƒç”¨çº¦å®š"><a href="#å‡½æ•°è°ƒç”¨çº¦å®š" class="headerlink" title="å‡½æ•°è°ƒç”¨çº¦å®š"></a>å‡½æ•°è°ƒç”¨çº¦å®š</h2><ul><li><p>ä¸»è¦æœ‰ä¸‰ç§ï¼šcdeclã€stdcallã€fastcallã€‚ä»¥æ±‚å’Œå‡½æ•°ä¸ºä¾‹</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">//æ±‚å’Œ</span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-type">int</span> <span class="hljs-title function_">sum</span><span class="hljs-params">(<span class="hljs-type">int</span> a,<span class="hljs-type">int</span> b,<span class="hljs-type">int</span> c)</span>&#123;<br>    <span class="hljs-keyword">return</span> a+b+c;<br>&#125;<br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;<br>    <span class="hljs-type">int</span> res=sum(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>,res);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>cdeclï¼šå®Œå…¨æ ˆä¼ å‚ï¼Œå‚æ•°ä»å³å¾€å·¦å…¥æ ˆï¼Œç”±è°ƒç”¨è€…æ¸…ç†å‚æ•°å ç”¨çš„æ ˆç©ºé—´</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-comment">; int __cdecl main()</span><br>_main           proc <span class="hljs-built_in">near</span>               <span class="hljs-comment">; CODE XREF: j__mainâ†‘j</span><br>  <br>var_C           = <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">0Ch</span><br>res             = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">8</span><br>  <br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ebp</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">esp</span><br>                <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0CCh</span><br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ebx</span><br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">esi</span><br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">edi</span><br><span class="hljs-symbol">  </span><br><span class="hljs-symbol">__$EncStackInitStart_2:</span><br>                <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">edi</span>, [<span class="hljs-built_in">ebp</span>+var_C]<br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-number">3</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">0CCCCCCCCh</span><br>                <span class="hljs-keyword">rep</span> <span class="hljs-keyword">stosd</span><br><span class="hljs-symbol">  </span><br><span class="hljs-symbol">__$EncStackInitEnd_2:</span>                   <span class="hljs-comment">; JMC_flag</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, offset _6005466B_entry@cpp<br>                <span class="hljs-keyword">call</span>    j_@__CheckForDebuggerJustMyCode@<span class="hljs-number">4</span> <span class="hljs-comment">; __CheckForDebuggerJustMyCode(x)</span><br>                <span class="hljs-keyword">nop</span><br>                <span class="hljs-keyword">push</span>    <span class="hljs-number">3</span>               <span class="hljs-comment">; å‚æ•°cå…¥æ ˆ</span><br>                <span class="hljs-keyword">push</span>    <span class="hljs-number">2</span>               <span class="hljs-comment">; å‚æ•°bå…¥æ ˆ</span><br>                <span class="hljs-keyword">push</span>    <span class="hljs-number">1</span>               <span class="hljs-comment">; å‚æ•°aå…¥æ ˆ</span><br>                <span class="hljs-keyword">call</span>    j_?sum@@YAHHHH@Z <span class="hljs-comment">; sum(int,int,int)</span><br>                <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0Ch</span><span class="hljs-comment">;è¿™é‡Œè°ƒç”¨è€…è¿›è¡Œäº†æ¸…ç†å‚æ•°å ç”¨çš„æ ˆç©ºé—´çš„æ“ä½œ(3ä¸ªå‚æ•°Ã—4å­—èŠ‚)ï¼Œè¢«è°ƒç”¨è€…ä¸è´Ÿè´£</span><br>                <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+res], <span class="hljs-built_in">eax</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+res]<br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br>                <span class="hljs-keyword">push</span>    offset _Format  <span class="hljs-comment">; &quot;%d\n&quot;</span><br>                <span class="hljs-keyword">call</span>    j__printf<br>                <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">8</span><br>                <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">eax</span><br>                <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">edi</span><br>                <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">esi</span><br>                <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ebx</span><br>                <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0CCh</span><br>                <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">esp</span><br>                <span class="hljs-keyword">call</span>    j___RTC_CheckEsp<br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-built_in">ebp</span><br>                <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ebp</span><br>                <span class="hljs-keyword">retn</span><br>_main           endp<br><br><span class="hljs-comment">; int __cdecl sum(int a, int b, int c)</span><br>?sum@@YAHHHH@Z  proc <span class="hljs-built_in">near</span>               <span class="hljs-comment">; CODE XREF: sum(int,int,int)â†‘j</span><br>  <br>a               = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span>  <span class="hljs-number">8</span><br>b               = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span>  <span class="hljs-number">0Ch</span><br>c               = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span>  <span class="hljs-number">10h</span><br>  <br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ebp</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">esp</span><br>                <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0C0h</span><span class="hljs-comment">;sumå‡½æ•°è‡ªèº«çš„æ ˆç©ºé—´</span><br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ebx</span><br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">esi</span><br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">edi</span><br><span class="hljs-symbol">  </span><br><span class="hljs-symbol">__$EncStackInitStart:</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">edi</span>, <span class="hljs-built_in">ebp</span><br>                <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-built_in">ecx</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">0CCCCCCCCh</span><br>                <span class="hljs-keyword">rep</span> <span class="hljs-keyword">stosd</span><br><span class="hljs-symbol">  </span><br><span class="hljs-symbol">__$EncStackInitEnd:</span>                     <span class="hljs-comment">; JMC_flag</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, offset _6005466B_entry@cpp<br>                <span class="hljs-keyword">call</span>    j_@__CheckForDebuggerJustMyCode@<span class="hljs-number">4</span> <span class="hljs-comment">; __CheckForDebuggerJustMyCode(x)</span><br>                <span class="hljs-keyword">nop</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+a]<br>                <span class="hljs-keyword">add</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+b]<br>                <span class="hljs-keyword">add</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+c]<br>                <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">edi</span><br>                <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">esi</span><br>                <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ebx</span><br>                <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0C0h</span><span class="hljs-comment">;æ¸…ç†è‡ªèº«æ ˆç©ºé—´</span><br>                <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">esp</span><br>                <span class="hljs-keyword">call</span>    j___RTC_CheckEsp<br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-built_in">ebp</span><br>                <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ebp</span><br>                <span class="hljs-keyword">retn</span><br>?sum@@YAHHHH@Z  endp<br></code></pre></td></tr></table></figure></li><li><p>stdcallï¼šå®Œå…¨æ ˆä¼ å‚ï¼Œå‚æ•°ä»å³å¾€å·¦å…¥æ ˆï¼Œç”±è¢«è°ƒç”¨è€…æ¸…ç†å‚æ•°å ç”¨çš„æ ˆç©ºé—´</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-comment">; int __cdecl main()</span><br>_main           proc <span class="hljs-built_in">near</span>               <span class="hljs-comment">; CODE XREF: j__mainâ†‘j</span><br>  <br>var_C           = <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">0Ch</span><br>res             = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">8</span><br>  <br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ebp</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">esp</span><br>                <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0CCh</span><br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ebx</span><br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">esi</span><br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">edi</span><br><span class="hljs-symbol">  </span><br><span class="hljs-symbol">__$EncStackInitStart_2:</span><br>                <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">edi</span>, [<span class="hljs-built_in">ebp</span>+var_C]<br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-number">3</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">0CCCCCCCCh</span><br>                <span class="hljs-keyword">rep</span> <span class="hljs-keyword">stosd</span><br><span class="hljs-symbol">  </span><br><span class="hljs-symbol">__$EncStackInitEnd_2:</span>                   <span class="hljs-comment">; JMC_flag</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, offset _6005466B_entry@cpp<br>                <span class="hljs-keyword">call</span>    j_@__CheckForDebuggerJustMyCode@<span class="hljs-number">4</span> <span class="hljs-comment">; __CheckForDebuggerJustMyCode(x)</span><br>                <span class="hljs-keyword">nop</span><br>                <span class="hljs-keyword">push</span>    <span class="hljs-number">3</span>               <span class="hljs-comment">; å‚æ•°cå…¥æ ˆ</span><br>                <span class="hljs-keyword">push</span>    <span class="hljs-number">2</span>               <span class="hljs-comment">; å‚æ•°bå…¥æ ˆ</span><br>                <span class="hljs-keyword">push</span>    <span class="hljs-number">1</span>               <span class="hljs-comment">; å‚æ•°aå…¥æ ˆ</span><br>                <span class="hljs-keyword">call</span>    j_?sum@@YGHHHH@Z <span class="hljs-comment">; sum(int,int,int)</span><br>                <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+res], <span class="hljs-built_in">eax</span><span class="hljs-comment">;è¿™é‡Œç›´æ¥åˆ°æŠŠè¿”å›å€¼ç»™resäº†ï¼Œè°ƒç”¨è€…ä¸è´Ÿè´£æ¸…ç†å‚æ•°å ç”¨çš„æ ˆç©ºé—´</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+res]<br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br>                <span class="hljs-keyword">push</span>    offset _Format  <span class="hljs-comment">; &quot;%d\n&quot;</span><br>                <span class="hljs-keyword">call</span>    j__printf<br>                <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">8</span><br>                <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">eax</span><br>                <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">edi</span><br>                <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">esi</span><br>                <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ebx</span><br>                <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0CCh</span><br>                <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">esp</span><br>                <span class="hljs-keyword">call</span>    j___RTC_CheckEsp<br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-built_in">ebp</span><br>                <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ebp</span><br>                <span class="hljs-keyword">retn</span><br>_main           endp<br>  <br><span class="hljs-comment">; int __stdcall sum(int a, int b, int c)</span><br>?sum@@YGHHHH@Z  proc <span class="hljs-built_in">near</span>               <span class="hljs-comment">; CODE XREF: sum(int,int,int)â†‘j</span><br>  <br>a               = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span>  <span class="hljs-number">8</span><br>b               = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span>  <span class="hljs-number">0Ch</span><br>c               = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span>  <span class="hljs-number">10h</span><br>  <br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ebp</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">esp</span><br>                <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0C0h</span><span class="hljs-comment">;sumçš„æ ˆç©ºé—´</span><br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ebx</span><br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">esi</span><br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">edi</span><br><span class="hljs-symbol">  </span><br><span class="hljs-symbol">__$EncStackInitStart:</span><br>               <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">edi</span>, <span class="hljs-built_in">ebp</span><br>                <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-built_in">ecx</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">0CCCCCCCCh</span><br>                <span class="hljs-keyword">rep</span> <span class="hljs-keyword">stosd</span><br><span class="hljs-symbol">  </span><br><span class="hljs-symbol">__$EncStackInitEnd:</span>                     <span class="hljs-comment">; JMC_flag</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, offset _6005466B_entry@cpp<br>                <span class="hljs-keyword">call</span>    j_@__CheckForDebuggerJustMyCode@<span class="hljs-number">4</span> <span class="hljs-comment">; __CheckForDebuggerJustMyCode(x)</span><br>                <span class="hljs-keyword">nop</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+a]<br>                <span class="hljs-keyword">add</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+b]<br>                <span class="hljs-keyword">add</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+c]<br>                <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">edi</span><br>                <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">esi</span><br>                <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ebx</span><br>                <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0C0h</span><span class="hljs-comment">;æ¸…ç†è‡ªèº«æ ˆç©ºé—´</span><br>                <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">esp</span><br>                <span class="hljs-keyword">call</span>    j___RTC_CheckEsp<br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-built_in">ebp</span><br>                <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ebp</span><br>                <span class="hljs-keyword">retn</span>    <span class="hljs-number">0Ch</span><span class="hljs-comment">;è¢«è°ƒç”¨è€…é€šè¿‡è¿”å›æŒ‡ä»¤ç»™espå¢åŠ 0Chï¼Œæ¸…ç†å‚æ•°å ç”¨çš„æ ˆç©ºé—´</span><br>?sum@@YGHHHH@Z  endp<br></code></pre></td></tr></table></figure></li><li><p>fastcallï¼šå¯„å­˜å™¨+æ ˆä¼ å‚ï¼Œä¼˜å…ˆä½¿ç”¨å¯„å­˜å™¨ï¼Œå‰©ä½™å‚æ•°ä»å³å¾€å·¦å…¥æ ˆï¼Œç”±è¢«è°ƒç”¨è€…æ¸…ç†å‚æ•°å ç”¨çš„æ ˆç©ºé—´</p><p>å¯„å­˜å™¨ä¼ å‚ä¼˜å…ˆçº§ï¼š</p><p>x86ï¼šecx  edx  æ ˆ</p><p>x64ï¼šrcx  rdx  r8  r9  æ ˆ</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-comment">; int __cdecl main()</span><br>_main           proc <span class="hljs-built_in">near</span>               <span class="hljs-comment">; CODE XREF: j__mainâ†‘j</span><br>  <br>var_C           = <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">0Ch</span><br>res             = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">8</span><br>  <br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ebp</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">esp</span><br>                <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0CCh</span><br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ebx</span><br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">esi</span><br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">edi</span><br><span class="hljs-symbol">  </span><br><span class="hljs-symbol">__$EncStackInitStart_2:</span><br>                <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">edi</span>, [<span class="hljs-built_in">ebp</span>+var_C]<br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-number">3</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">0CCCCCCCCh</span><br>                <span class="hljs-keyword">rep</span> <span class="hljs-keyword">stosd</span><br><span class="hljs-symbol">  </span><br><span class="hljs-symbol">__$EncStackInitEnd_2:</span>                   <span class="hljs-comment">; JMC_flag</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, offset _6005466B_entry@cpp<br>                <span class="hljs-keyword">call</span>    j_@__CheckForDebuggerJustMyCode@<span class="hljs-number">4</span> <span class="hljs-comment">; __CheckForDebuggerJustMyCode(x)</span><br>                <span class="hljs-keyword">nop</span><br>                <span class="hljs-keyword">push</span>    <span class="hljs-number">3</span>               <span class="hljs-comment">; å‚æ•°cå…¥æ ˆ</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">edx</span>, <span class="hljs-number">2</span>          <span class="hljs-comment">; å‚æ•°bå­˜å…¥å¯„å­˜å™¨</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-number">1</span>          <span class="hljs-comment">; å‚æ•°aå­˜å…¥å¯„å­˜å™¨</span><br>                <span class="hljs-keyword">call</span>    j_?sum@@YIHHHH@Z <span class="hljs-comment">; sum(int,int,int)</span><br>                <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+res], <span class="hljs-built_in">eax</span><span class="hljs-comment">;è¿™é‡Œä¹Ÿæ˜¯æ²¡æœ‰è°ƒç”¨è€…å¯¹å‚æ•°å ç”¨çš„æ ˆç©ºé—´çš„æ¸…ç†</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+res]<br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">eax</span><br>                <span class="hljs-keyword">push</span>    offset _Format  <span class="hljs-comment">; &quot;%d\n&quot;</span><br>                <span class="hljs-keyword">call</span>    j__printf<br>                <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">8</span><br>                <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">eax</span><br>                <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">edi</span><br>                <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">esi</span><br>                <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ebx</span><br>                <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0CCh</span><br>                <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">esp</span><br>                <span class="hljs-keyword">call</span>    j___RTC_CheckEsp<br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-built_in">ebp</span><br>                <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ebp</span><br>                <span class="hljs-keyword">retn</span><br>_main           endp<br><br><span class="hljs-comment">; int __fastcall sum(int a, int b, int c)</span><br>?sum@@YIHHHH@Z  proc <span class="hljs-built_in">near</span>               <span class="hljs-comment">; CODE XREF: sum(int,int,int)â†‘j</span><br>  <br>var_18          = <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">18h</span><br>b               = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">14h</span><br>a               = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">8</span><br>c               = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span>  <span class="hljs-number">8</span><br>  <br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ebp</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">esp</span><br>                <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0D8h</span><span class="hljs-comment">;sumå¼€è¾Ÿæ ˆç©ºé—´</span><br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ebx</span><br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">esi</span><br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">edi</span><br>                <span class="hljs-keyword">push</span>    <span class="hljs-built_in">ecx</span><br><span class="hljs-symbol">  </span><br><span class="hljs-symbol">__$EncStackInitStart:</span><br>                <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">edi</span>, [<span class="hljs-built_in">ebp</span>+var_18]<br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-number">6</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">0CCCCCCCCh</span><br>                <span class="hljs-keyword">rep</span> <span class="hljs-keyword">stosd</span><br><span class="hljs-symbol">  </span><br><span class="hljs-symbol">__$EncStackInitEnd:</span><br>                <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ecx</span><br>                <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+b], <span class="hljs-built_in">edx</span><br>                <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">ebp</span>+a], <span class="hljs-built_in">ecx</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, offset _6005466B_entry@cpp <span class="hljs-comment">; JMC_flag</span><br>                <span class="hljs-keyword">call</span>    j_@__CheckForDebuggerJustMyCode@<span class="hljs-number">4</span> <span class="hljs-comment">; __CheckForDebuggerJustMyCode(x)</span><br>                <span class="hljs-keyword">nop</span><br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+a]<br>                <span class="hljs-keyword">add</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+b]<br>                <span class="hljs-keyword">add</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">ebp</span>+c]<br>                <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">edi</span><br>                <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">esi</span><br>                <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ebx</span><br>                <span class="hljs-keyword">add</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-number">0D8h</span><span class="hljs-comment">;sumæ¸…ç†æ ˆç©ºé—´</span><br>                <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">esp</span><br>                <span class="hljs-keyword">call</span>    j___RTC_CheckEsp<br>                <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">esp</span>, <span class="hljs-built_in">ebp</span><br>                <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">ebp</span><br>                <span class="hljs-keyword">retn</span>    <span class="hljs-number">4</span><span class="hljs-comment">;ç”±äºåªæœ‰ä¸€ä¸ªå‚æ•°è¢«pushåˆ°æ ˆä¸Šï¼Œæ‰€ä»¥è¢«è°ƒç”¨è€…è¿”å›4ï¼Œæ¸…ç†å‚æ•°å ç”¨çš„æ ˆç©ºé—´</span><br>?sum@@YIHHHH@Z  endp<br></code></pre></td></tr></table></figure></li></ul>]]></content>
    
    
    <summary type="html">å‡½æ•°è°ƒç”¨çº¦å®š</summary>
    
    
    
    <category term="Reverse Engineering" scheme="https://sydzi.github.io/categories/Reverse-Engineering/"/>
    
    
    <category term="CTF" scheme="https://sydzi.github.io/tags/CTF/"/>
    
    <category term="Reverse" scheme="https://sydzi.github.io/tags/Reverse/"/>
    
  </entry>
  
  <entry>
    <title>Day4:Linuxæ±‡ç¼–æ¡†æ¶ã€æ“ä½œç³»ç»Ÿä¸æ±‡ç¼–å™¨ã€ä¸»å‡½æ•°è·³è½¬æµç¨‹</title>
    <link href="https://sydzi.github.io/2025/07/11/Day4-Linux%E6%B1%87%E7%BC%96%E6%A1%86%E6%9E%B6/"/>
    <id>https://sydzi.github.io/2025/07/11/Day4-Linux%E6%B1%87%E7%BC%96%E6%A1%86%E6%9E%B6/</id>
    <published>2025-07-11T06:46:16.000Z</published>
    <updated>2025-09-18T03:56:54.893Z</updated>
    
    <content type="html"><![CDATA[<p>Linuxæ±‡ç¼–æ¡†æ¶ã€æ“ä½œç³»ç»Ÿä¸æ±‡ç¼–å™¨ã€ä¸»å‡½æ•°è·³è½¬æµç¨‹</p><span id="more"></span><h2 id="Linux-NASM-æ±‡ç¼–æ¡†æ¶"><a href="#Linux-NASM-æ±‡ç¼–æ¡†æ¶" class="headerlink" title="Linux(NASM)æ±‡ç¼–æ¡†æ¶"></a>Linux(NASM)æ±‡ç¼–æ¡†æ¶</h2><ul><li><p>Linuxå’ŒWindowsçš„ä¸åŒä¸»è¦æœ‰ï¼š</p><ul><li><p>ç³»ç»Ÿè°ƒç”¨æ–¹å¼ä¸åŒï¼š</p><ul><li><p>Windowsæä¾›APIï¼Œå¯ä»¥ç›´æ¥åˆ©ç”¨ç³»ç»Ÿå‡½æ•°</p></li><li><p>Linuxéœ€è¦ç”¨ç³»ç»Ÿè°ƒç”¨å·è§¦å‘ç³»ç»Ÿè°ƒç”¨ã€‚ç³»ç»Ÿè°ƒç”¨å·å­˜å…¥ç‰¹å®šå¯„å­˜å™¨åä½¿ç”¨è§¦å‘æŒ‡ä»¤ï¼Œè§¦å‘ç³»ç»Ÿè°ƒç”¨</p><p>è§¦å‘æŒ‡ä»¤ï¼š</p><p>â€‹32ä½(x86)ï¼šint 0x80</p><p>â€‹64ä½(x64)ï¼šsyscall</p><p>å‚æ•°ä¼ é€’ï¼š</p><p>â€‹32ä½ï¼šeaxï¼ˆç³»ç»Ÿè°ƒç”¨å·ï¼‰ï¼Œebxã€ecxã€edxã€esiã€ediã€ebpï¼ˆå‚æ•°ï¼‰ã€‚</p><p>â€‹64ä½ï¼šraxï¼ˆç³»ç»Ÿè°ƒç”¨å·ï¼‰ï¼Œrdiã€rsiã€rdxã€r10ã€r8ã€r9ï¼ˆå‚æ•°ï¼‰ã€‚</p><p>32ä½ä¸‹exitç¤ºä¾‹ï¼š</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-keyword">mov</span> <span class="hljs-built_in">eax</span>,<span class="hljs-number">1</span><span class="hljs-comment">;32ä½ä¸‹ï¼Œexitçš„ç³»ç»Ÿè°ƒç”¨å·ä¸º1</span><br><span class="hljs-keyword">int</span> <span class="hljs-number">0x80</span><span class="hljs-comment">;ç³»ç»Ÿè°ƒç”¨å·å­˜å…¥å¯„å­˜å™¨åï¼Œè§¦å‘ç³»ç»Ÿè°ƒç”¨</span><br></code></pre></td></tr></table></figure></li></ul></li><li><p>å¯æ‰§è¡Œæ–‡ä»¶æ ¼å¼ä¸åŒï¼š</p><ul><li>Windowsä½¿ç”¨PEæ–‡ä»¶æ ¼å¼</li><li>Linuxä½¿ç”¨ELFæ–‡ä»¶æ ¼å¼</li></ul></li><li><p>å…¶ä»–ç»†èŠ‚ï¼š</p><ul><li>Linuxåœ¨æ®µåå‰å¿…é¡»æ·»åŠ sectionï¼Œåªæœ‰.textæ®µæ²¡æœ‰.codeæ®µï¼ˆå®é™…ä¸Šç”±æ±‡ç¼–å™¨å†³å®šï¼Œè¯¦è§ä¸‹ä¸€éƒ¨åˆ†ï¼‰</li><li>Linuxä½¿ç”¨0xAä½œä¸ºå­—ç¬¦ä¸²ç»“æŸç¬¦</li></ul></li></ul></li><li><p>32ä½æ±‡ç¼–æ¡†æ¶</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">section</span> .data<br>msg <span class="hljs-built_in">db</span> <span class="hljs-string">&quot;HelloWorld&quot;</span>,<span class="hljs-number">0xA</span><br>len <span class="hljs-built_in">equ</span> $ - msg<span class="hljs-comment">;ç”¨å˜é‡lenè®°å½•msgçš„é•¿åº¦ï¼ˆ$è¡¨ç¤ºå½“å‰å˜é‡çš„åœ°å€ï¼Œå‡å»msgçš„åœ°å€å°±æ˜¯msgçš„é•¿åº¦ï¼‰</span><br><br><span class="hljs-meta">section</span> .text<br><span class="hljs-meta">global</span> _start<br><span class="hljs-symbol">_start:</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">eax</span>,<span class="hljs-number">4</span><span class="hljs-comment">;eaxå­˜æ”¾ç³»ç»Ÿè°ƒç”¨å·4ï¼šsys_write</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ebx</span>,<span class="hljs-number">1</span><span class="hljs-comment">;å‚æ•°1ï¼šæ–‡ä»¶æè¿°ç¬¦ï¼Œ1è¡¨ç¤ºæ ‡å‡†è¾“å‡ºstdout</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ecx</span>,msg<span class="hljs-comment">;å‚æ•°2ï¼šè¦æ‰“å°çš„æ•°æ®åœ°å€</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">edx</span>,len<span class="hljs-comment">;å‚æ•°3ï¼šæ‰“å°çš„å­—èŠ‚æ•°</span><br><span class="hljs-keyword">int</span> <span class="hljs-number">0x80</span><br><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">eax</span>,<span class="hljs-number">1</span><span class="hljs-comment">;eaxå­˜æ”¾ç³»ç»Ÿè°ƒç”¨å·1ï¼šsys_exit</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ebx</span>,<span class="hljs-number">0</span><span class="hljs-comment">;å‚æ•°1ï¼šé€€å‡ºçŠ¶æ€ç ï¼ˆ0è¡¨ç¤ºæˆåŠŸï¼‰</span><br><span class="hljs-keyword">int</span> <span class="hljs-number">0x80</span><br></code></pre></td></tr></table></figure></li><li><p>64ä½æ±‡ç¼–æ¡†æ¶</p></li></ul><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">section</span> .data<br>msg <span class="hljs-built_in">db</span> <span class="hljs-string">&quot;HelloWorld&quot;</span>,<span class="hljs-number">0xA</span><br>len <span class="hljs-built_in">equ</span> $ - msg<br><br><span class="hljs-meta">section</span> .text<br><span class="hljs-meta">global</span> _start<br><span class="hljs-symbol">_start:</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>,<span class="hljs-number">1</span><span class="hljs-comment">;raxå­˜æ”¾ç³»ç»Ÿè°ƒç”¨å·1ï¼šsys_write</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>,<span class="hljs-number">1</span><span class="hljs-comment">;å‚æ•°1ï¼šæ–‡ä»¶æè¿°ç¬¦ï¼Œ1è¡¨ç¤ºæ ‡å‡†è¾“å‡ºstdout</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>,msg<span class="hljs-comment">;å‚æ•°2ï¼šè¦æ‰“å°çš„æ•°æ®åœ°å€</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>,len<span class="hljs-comment">;å‚æ•°3ï¼šæ‰“å°çš„å­—èŠ‚æ•°</span><br><span class="hljs-keyword">syscall</span><br><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>,<span class="hljs-number">60</span><span class="hljs-comment">;raxå­˜æ”¾ç³»ç»Ÿè°ƒç”¨å·60ï¼šsys_exit</span><br><span class="hljs-keyword">xor</span> <span class="hljs-built_in">rdi</span>,<span class="hljs-built_in">rdi</span><span class="hljs-comment">;å‚æ•°1ï¼šé€€å‡ºçŠ¶æ€ç ï¼ˆ0è¡¨ç¤ºæˆåŠŸï¼‰</span><br><span class="hljs-keyword">syscall</span><br></code></pre></td></tr></table></figure><h2 id="æ“ä½œç³»ç»Ÿä¸æ±‡ç¼–å™¨"><a href="#æ“ä½œç³»ç»Ÿä¸æ±‡ç¼–å™¨" class="headerlink" title="æ“ä½œç³»ç»Ÿä¸æ±‡ç¼–å™¨"></a>æ“ä½œç³»ç»Ÿä¸æ±‡ç¼–å™¨</h2><ul><li>Windowsï¼šä¸»è¦æœ‰MASMå’ŒNASMä¸¤ç§æ±‡ç¼–å™¨<ul><li>MASMï¼ˆMicrosoft Macro Assemblerï¼‰ï¼Œä¸»è¦é›†æˆåœ¨visual studioä¸­<ul><li>æ®µåå‰ä¸è¦æ±‚åŠ sectionï¼Œå¯ä»¥ç›´æ¥ç”¨ <strong>.æ®µå</strong> å£°æ˜</li><li>æŒ‡ä»¤å­˜æ”¾åœ¨.codeæ®µ</li><li>.codeæ®µï¼Œå‡½æ•°ä»¥ <strong>func_name proc</strong> å¼€å§‹ï¼Œä»¥ <strong>func_name endp</strong> ç»“æŸ</li><li>ä½¿ç”¨Intelé£æ ¼ï¼Œå³ <strong>æŒ‡ä»¤   ç›®æ ‡æ“ä½œæ•°ï¼Œæºæ“ä½œæ•°</strong></li></ul></li><li>NASMï¼ˆNetwide Assemblerï¼‰ï¼Œè·¨å¹³å°æ±‡ç¼–å™¨ï¼Œæ”¯æŒWindowsã€Linuxã€macOS<ul><li>æ®µåå‰è¦æ±‚åŠ sectionï¼Œç”¨ <strong>sectino .æ®µå</strong> å£°æ˜</li><li>æŒ‡ä»¤å­˜æ”¾åœ¨.textæ®µ</li><li>.textæ®µï¼Œå‡½æ•°ç”¨ <strong>global func_name</strong> å£°æ˜åå†å®šä¹‰ </li><li>ä½¿ç”¨Intelé£æ ¼</li></ul></li></ul></li><li>Linuxï¼šä¸»è¦æœ‰NASMå’ŒGASä¸¤ç§æ±‡ç¼–å™¨<ul><li>NASMåŒä¸Š </li><li>GASï¼ˆGNU Assemblerï¼‰ï¼ŒLinuxé»˜è®¤æ±‡ç¼–å™¨<ul><li>æ®µåå‰è¦æ±‚åŠ .sectionï¼Œç”¨ <strong>.section .æ®µå</strong> å£°æ˜</li><li>æŒ‡ä»¤å­˜æ”¾åœ¨.textæ®µ</li><li>.textæ®µï¼Œå‡½æ•°ç”¨ <strong>.global func_name</strong> å£°æ˜åå†å®šä¹‰</li><li>ä½¿ç”¨AT&amp;Té£æ ¼ï¼Œå³ <strong>æŒ‡ä»¤   æºæ“ä½œæ•°ï¼Œç›®æ ‡æ“ä½œæ•°</strong></li></ul></li></ul></li></ul><h2 id="ä¸»å‡½æ•°è·³è½¬æµç¨‹"><a href="#ä¸»å‡½æ•°è·³è½¬æµç¨‹" class="headerlink" title="ä¸»å‡½æ•°è·³è½¬æµç¨‹"></a>ä¸»å‡½æ•°è·³è½¬æµç¨‹</h2><ul><li><p>ç¯å¢ƒï¼švs2022ï¼ŒDebug  x86&#x2F;x64ï¼ŒRelease x86&#x2F;x64</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-comment">;x86 debug è·³è½¬ç‰¹å¾</span><br><span class="hljs-comment">;step1</span><br><span class="hljs-keyword">jmp</span><span class="hljs-comment">;ç›´æ¥jmp</span><br><br><span class="hljs-comment">;step2</span><br><span class="hljs-keyword">call</span><span class="hljs-comment">;ç¬¬ä¸€ä¸ªcall</span><br><br><span class="hljs-comment">;step3</span><br><span class="hljs-keyword">call</span><br><span class="hljs-keyword">call</span> &lt;--<span class="hljs-comment">;è¿ç»­ä¸¤ä¸ªcallï¼Œè¿›ç¬¬äºŒä¸ª</span><br><br><span class="hljs-comment">;step4</span><br><span class="hljs-number">2</span>*<span class="hljs-keyword">jz</span>--&gt;<span class="hljs-keyword">call</span><br><span class="hljs-keyword">mov</span><br><span class="hljs-keyword">call</span><span class="hljs-comment">;ä¸¤ä¸ªjzæŒ‡å‘çš„åŒä¸€ä¸ªcallä¸”æ­¤callåç´§è·Ÿmovå’Œcall</span><br><br><span class="hljs-comment">;step5</span><br><span class="hljs-keyword">mov</span><br><span class="hljs-keyword">push</span><br><span class="hljs-keyword">mov</span><br><span class="hljs-keyword">push</span><br><span class="hljs-keyword">mov</span><br><span class="hljs-keyword">push</span><br><span class="hljs-keyword">call</span><span class="hljs-comment">;è¿ç»­push3ä¸ªå‚æ•°å…¥æ ˆåçš„call</span><br><br><span class="hljs-comment">;step6</span><br><span class="hljs-keyword">jmp</span><br></code></pre></td></tr></table></figure><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-comment">;x86 Release è·³è½¬ç‰¹å¾</span><br><span class="hljs-comment">;step1</span><br><span class="hljs-keyword">call</span><br><span class="hljs-keyword">jmp</span><span class="hljs-comment">;callåçš„jmp</span><br><br><span class="hljs-comment">;step2</span><br><span class="hljs-keyword">push</span><br><span class="hljs-keyword">push</span><br><span class="hljs-keyword">push</span><br><span class="hljs-keyword">call</span><span class="hljs-comment">;è¿ç»­push3ä¸ªå‚æ•°å…¥æ ˆåçš„call</span><br></code></pre></td></tr></table></figure><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-comment">;x64 Debug è·³è½¬ç‰¹å¾ </span><br><span class="hljs-comment">;step1</span><br><span class="hljs-keyword">jmp</span><span class="hljs-comment">;ç›´æ¥jmp</span><br><br><span class="hljs-comment">;step2</span><br><span class="hljs-keyword">call</span><span class="hljs-comment">;ç¬¬ä¸€ä¸ªcall</span><br><br><span class="hljs-comment">;step3</span><br><span class="hljs-keyword">call</span><br><span class="hljs-keyword">call</span> &lt;--<span class="hljs-comment">;è¿ç»­ä¸¤ä¸ªcallè¿›ç¬¬äºŒä¸ª</span><br><br><span class="hljs-comment">;step4</span><br><span class="hljs-number">2</span>*<span class="hljs-keyword">jz</span>--&gt;<span class="hljs-keyword">call</span><br><span class="hljs-keyword">mov</span><br><span class="hljs-keyword">call</span><span class="hljs-comment">;ä¸¤ä¸ªjzæŒ‡å‘çš„åŒä¸€ä¸ªcallä¸”æ­¤callåç´§è·Ÿmovå’Œcall</span><br><br><span class="hljs-comment">;step5</span><br><span class="hljs-keyword">mov</span><br><span class="hljs-keyword">mov</span><br><span class="hljs-keyword">mov</span><br><span class="hljs-keyword">mov</span><br><span class="hljs-keyword">mov</span><br><span class="hljs-keyword">call</span><span class="hljs-comment">;è¿ç»­5ä¸ªmovåçš„callï¼ˆä¼ å‚ï¼‰</span><br><br><span class="hljs-comment">;step6</span><br><span class="hljs-keyword">jmp</span><span class="hljs-comment">;ç›´æ¥jmp</span><br></code></pre></td></tr></table></figure><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-comment">;x64 Release è·³è½¬ç‰¹å¾ </span><br><span class="hljs-comment">;step1</span><br><span class="hljs-keyword">call</span><br><span class="hljs-keyword">jmp</span><span class="hljs-comment">;callåçš„jmp</span><br><br><span class="hljs-comment">;step2</span><br><span class="hljs-keyword">mov</span><br><span class="hljs-keyword">mov</span><br><span class="hljs-keyword">mov</span><br><span class="hljs-keyword">call</span><br><span class="hljs-keyword">mov</span><br><span class="hljs-keyword">call</span><span class="hljs-comment">;ä¸‰ä¸ªmovåçš„callï¼ˆä¼ å‚ï¼‰ä¸”æ­¤callåç´§è·Ÿmovå’Œcall</span><br></code></pre></td></tr></table></figure></li></ul>]]></content>
    
    
    <summary type="html">Linuxæ±‡ç¼–æ¡†æ¶ã€æ“ä½œç³»ç»Ÿä¸æ±‡ç¼–å™¨ã€ä¸»å‡½æ•°è·³è½¬æµç¨‹</summary>
    
    
    
    <category term="Reverse Engineering" scheme="https://sydzi.github.io/categories/Reverse-Engineering/"/>
    
    
    <category term="CTF" scheme="https://sydzi.github.io/tags/CTF/"/>
    
    <category term="Reverse" scheme="https://sydzi.github.io/tags/Reverse/"/>
    
  </entry>
  
  <entry>
    <title>Day3:å‡½æ•°ä¸æ ˆå¸§ã€æ•°ç»„ä¸ä¸²æŒ‡ä»¤ã€å®ä¸ç»“æ„ä½“ã€x64æ±‡ç¼–æ¡†æ¶ã€å†…è”æ±‡ç¼–ä¸æ··åˆç¼–ç¨‹</title>
    <link href="https://sydzi.github.io/2025/07/08/Day3-%E5%87%BD%E6%95%B0%E4%B8%8E%E5%A0%86%E6%A0%88/"/>
    <id>https://sydzi.github.io/2025/07/08/Day3-%E5%87%BD%E6%95%B0%E4%B8%8E%E5%A0%86%E6%A0%88/</id>
    <published>2025-07-08T06:14:04.000Z</published>
    <updated>2025-09-18T03:56:51.904Z</updated>
    
    <content type="html"><![CDATA[<p>å‡½æ•°ä¸æ ˆå¸§ã€æ•°ç»„ä¸ä¸²æŒ‡ä»¤ã€å®ä¸ç»“æ„ä½“ã€x64æ±‡ç¼–æ¡†æ¶ã€å†…è”æ±‡ç¼–ä¸æ··åˆç¼–ç¨‹</p><span id="more"></span><h2 id="å‡½æ•°ä¸æ ˆå¸§"><a href="#å‡½æ•°ä¸æ ˆå¸§" class="headerlink" title="å‡½æ•°ä¸æ ˆå¸§"></a>å‡½æ•°ä¸æ ˆå¸§</h2><ul><li><p>â€œæ ˆâ€œæ˜¯å†…å­˜ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œå¯ä»¥ç†è§£ä¸ºè¿ç»­çš„ä¸€å—å†…å­˜ï¼Œå®ƒä¸ºç¨‹åºè¿è¡Œæä¾›äº†ä¸€ä¸ªæš‚æ—¶çš„å­˜æ”¾æ•°æ®çš„åœ°æ–¹ï¼Œåœ°å€ã€æ•°æ®ç­‰å¯ä»¥é€šè¿‡pushæŒ‡ä»¤ä»å¯„å­˜å™¨ä¸­è¢«å¤åˆ¶åˆ°æ ˆä¸­ï¼Œè¿›è€Œå¯„å­˜å™¨å¯ä»¥è¿›è¡Œå…¶ä»–æ“ä½œï¼Œç­‰åˆ°è¿™äº›æ•°æ®å†æ¬¡è¢«éœ€è¦æ—¶å†ä»æ ˆä¸­è¢«popå‡ºæ¥ã€‚æ ˆéµå¾ªå…ˆè¿›åå‡ºçš„è§„åˆ™ï¼Œå…ˆpushçš„åœ¨é«˜åœ°å€ï¼Œåpushçš„åœ¨ä½åœ°å€</p></li><li><p>åœ¨ç¨‹åºè¿è¡Œæ—¶ï¼Œæ¯ä¸ªå‡½æ•°éƒ½ä¼šæ‹¥æœ‰ç‹¬ç«‹çš„æ ˆå¸§ï¼Œå³ç‹¬ç«‹çš„æ ˆä¸Šçš„ä¸€éƒ¨åˆ†ç©ºé—´ã€‚æœ‰ä¸¤ä¸ªå¯„å­˜å™¨ï¼Œespï¼Œebpï¼ˆx86å³32ä½ç¯å¢ƒä¸‹ï¼‰è´Ÿè´£ç»´æŠ¤å‡½æ•°çš„æ ˆç©ºé—´ã€‚ebpå­˜æ”¾çš„æ˜¯å‡½æ•°æ ˆç©ºé—´çš„æ ˆåŸºå€ï¼Œespå­˜æ”¾çš„æ˜¯å‡½æ•°æ ˆç©ºé—´çš„æ ˆé¡¶ã€‚å¯ä»¥ç†è§£ä¸ºebpæ˜¯æŒ‡å‘å‡½æ•°æ ˆç©ºé—´æœ€é«˜ä½çš„ä¸€ä¸ªæŒ‡é’ˆï¼ˆå› ä¸ºæ ˆç©ºé—´ä»é«˜åœ°å€å¼€å§‹åˆ†é…ï¼Œå› æ­¤æŒ‡å‘çš„æ˜¯æœ€é«˜ä½ï¼Œä½†æ˜¯æ˜¯æ ˆç©ºé—´çš„èµ·å§‹åœ°å€ï¼‰ï¼Œè€Œespæ˜¯æŒ‡å‘å‡½æ•°æ ˆç©ºé—´æœ€ä½ä½çš„ä¸€ä¸ªæŒ‡é’ˆï¼ˆæŒ‡å‘çš„æ˜¯æœ€ä½ä½ï¼Œä½†æ˜¯ä¼šéšç€åç»­æ ˆç©ºé—´çš„æ‰©å……è€Œå˜åŒ–ï¼‰ã€‚</p></li><li><p>CALLæŒ‡ä»¤ï¼š</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-comment">;callä¸€ä¸ªå‡½æ•°çš„æ—¶å€™ï¼Œä¼šå‘ç”Ÿä»¥ä¸‹å†…å®¹</span><br><span class="hljs-keyword">push</span> è¿”å›åœ°å€ï¼ˆ<span class="hljs-keyword">call</span>æ‰€åœ¨æŒ‡ä»¤çš„ä¸‹ä¸€æ¡ï¼‰<br><span class="hljs-keyword">jmp</span> ç›®æ ‡å‡½æ•°åœ°å€<br></code></pre></td></tr></table></figure></li><li><p>RETæŒ‡ä»¤ï¼š</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-comment">;å‡½æ•°ç»“æŸæ—¶ï¼ŒRETæŒ‡ä»¤ä¼šå‘ç”Ÿä»¥ä¸‹å†…å®¹</span><br><span class="hljs-keyword">pop</span> <span class="hljs-built_in">eip</span> <span class="hljs-comment">;ä»æ ˆä¸Šå¼¹å‡ºè¿”å›åœ°å€åˆ°eipï¼ˆä¿å­˜ä¸‹ä¸€æ­¥æŒ‡ä»¤åœ°å€çš„å¯„å­˜å™¨ï¼‰</span><br></code></pre></td></tr></table></figure></li><li><p>æ ˆå¸§ï¼š</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-comment">;è·³è½¬åˆ°æ¯ä¸€ä¸ªå‡½æ•°ï¼Œä¼šå‘ç”Ÿä»¥ä¸‹å†…å®¹ä»¥å¼€è¾Ÿæ ˆå¸§</span><br><span class="hljs-keyword">push</span> <span class="hljs-built_in">ebp</span><span class="hljs-comment">;æŠŠä¸Šä¸€ä¸ªå‡½æ•°çš„ebpå€¼æ”¾åˆ°æ ˆä¸Š</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ebp</span>,<span class="hljs-built_in">esp</span><span class="hljs-comment">;æŠŠespå€¼ç»™ebpï¼Œå¼€è¾Ÿæ–°å‡½æ•°çš„æ ˆå¸§</span><br><span class="hljs-comment">;å‡½æ•°æ‰§è¡Œå®Œæ¯•åï¼Œä¼šå‘ç”Ÿä»¥ä¸‹å†…å®¹æ¸…ç†æ ˆå¸§</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">esp</span>,<span class="hljs-built_in">ebp</span><span class="hljs-comment">;æŠŠebpå€¼ç»™espï¼Œæ¸…ç†å‡½æ•°æ ˆå¸§</span><br><span class="hljs-keyword">pop</span> <span class="hljs-built_in">ebp</span><span class="hljs-comment">;æ¢å¤ebpåŸæ¥çš„å€¼ï¼Œå³ä¸Šä¸€ä¸ªå‡½æ•°çš„ebp</span><br><span class="hljs-keyword">ret</span><br></code></pre></td></tr></table></figure></li></ul><h2 id="æ•°ç»„ä¸ä¸²æŒ‡ä»¤"><a href="#æ•°ç»„ä¸ä¸²æŒ‡ä»¤" class="headerlink" title="æ•°ç»„ä¸ä¸²æŒ‡ä»¤"></a>æ•°ç»„ä¸ä¸²æŒ‡ä»¤</h2><ul><li><p>å£°æ˜æ•°ç»„ï¼š</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.data</span><span class="hljs-comment">;åœ¨æ•°æ®æ®µå£°æ˜</span><br> szHello <span class="hljs-built_in">db</span> <span class="hljs-string">&#x27;HelloWorld&#x27;</span>,<span class="hljs-number">0</span><span class="hljs-comment">;å£°æ˜ä¸€ä¸ªå­—ç¬¦ä¸²</span><br> nNumber <span class="hljs-built_in">dd</span> <span class="hljs-number">20</span> dup(<span class="hljs-number">0</span>)<span class="hljs-comment">;å£°æ˜ä¸€ä¸ªDWORDæ•°ç»„ï¼Œ20ä½ï¼Œä½¿ç”¨dup()åˆå§‹åŒ–æ•°ç»„å†…å®¹ä¸º0</span><br></code></pre></td></tr></table></figure></li><li><p>ä½¿ç”¨æ•°ç»„åŸºå€çš„å‡ ç§æ–¹å¼ï¼š</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-keyword">lea</span> <span class="hljs-built_in">eax</span>,szHello<br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ebx</span>,offset Nnumber<br></code></pre></td></tr></table></figure></li><li><p>è®¿é—®æ•°ç»„æˆå‘˜ï¼š</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-comment">;[æ•°ç»„èµ·å§‹åœ°å€+ç´¢å¼•å¯„å­˜å™¨*æ¯”ä¾‹å› å­+åç§»é‡]ï¼ˆç´¢å¼•å¯„å­˜å™¨ç”¨æ¥å­˜æ”¾ç´¢å¼•å€¼ï¼Œæ¯”ä¾‹å› å­å¯¹åº”ç±»å‹çš„å­—èŠ‚å¤§å°ï¼Œåç§»é‡å¯ç”¨äºç»“æ„ä½“æ•°ç»„ç­‰åœºæ™¯ï¼‰</span><br><span class="hljs-comment">;å¦‚ï¼š</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ebx</span>,offset Array<span class="hljs-comment">;æŠŠæ•°ç»„åŸºå€ç»™ebx</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">esi</span>,<span class="hljs-number">0</span><span class="hljs-comment">;esiç”¨æ¥å½“ç´¢å¼•å¯„å­˜å™¨</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ecx</span>,<span class="hljs-number">10</span><span class="hljs-comment">;ecxç”¨æ¥æ”¾ç´¢å¼•ä¸Šé™ï¼ˆecxå¸¸ç”¨ä½œè®¡æ•°å™¨ï¼‰</span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol">loop_start:</span><span class="hljs-comment">;åˆ›å»ºä¸€ä¸ªå¾ªç¯</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">eax</span>,[<span class="hljs-built_in">ebx</span>+<span class="hljs-built_in">esi</span>*<span class="hljs-number">4</span>]<span class="hljs-comment">;å–å‡ºæ•°ç»„å†…å®¹æ”¾åˆ°eaxä¸­</span><br><span class="hljs-keyword">add</span> <span class="hljs-built_in">esi</span>,<span class="hljs-number">1</span><span class="hljs-comment">;ç´¢å¼•é€’å¢</span><br><span class="hljs-keyword">cmp</span> <span class="hljs-built_in">esi</span>,<span class="hljs-built_in">ecx</span><span class="hljs-comment">;ä¸ç´¢å¼•ä¸Šé™æ¯”è¾ƒï¼Œåˆ¤æ–­æ˜¯å¦éå†å®Œæ•°ç»„</span><br><span class="hljs-keyword">jl</span> loop_start<span class="hljs-comment">;è¿˜æ²¡éå†å®Œæ•°ç»„å°±å¾ªç¯æ“ä½œï¼Œjumpåˆ°loop_startå†èµ°ä¸€é</span><br></code></pre></td></tr></table></figure></li><li><p>ä¸²æŒ‡ä»¤ï¼š</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-comment">;stosç³»åˆ—:stosb,stosw,stosd,stosqï¼ˆåˆ†åˆ«å¯¹åº”byte,word,dword,qword,åŠŸèƒ½æ˜¯æŠŠal/ax/eax/raxä¸­çš„å†…å®¹å­˜åˆ°edi/rdiï¼‰</span><br><span class="hljs-comment">;lodsç³»åˆ—:lodsb,lodsw,lodsd,lodsqï¼ˆåŒæ ·åˆ†åˆ«å¯¹åº”å››ä¸ªç±»å‹ï¼ŒåŠŸèƒ½æ˜¯æŠŠesi/rsiçš„å†…å®¹åŠ è½½åˆ°al/ax/eax/raxä¸­ï¼‰</span><br><span class="hljs-comment">;movsç³»åˆ—:movsb,movsw,movsd,movsqï¼ˆåŒæ ·åˆ†åˆ«å¯¹åº”å››ä¸ªç±»å‹ï¼ŒåŠŸèƒ½æ˜¯æŠŠesiçš„å†…å®¹å¤åˆ¶åˆ°ediä¸­ï¼‰</span><br><span class="hljs-comment">;cmpsç³»åˆ—:cmpsb,cmpsw,cmpsd,cmpsqï¼ˆåŒæ ·åˆ†åˆ«å¯¹åº”å››ä¸ªç±»å‹ï¼ŒåŠŸèƒ½æ˜¯æ¯”è¾ƒesiå’Œediçš„å†…å®¹å¹¶è®¾ç½®æ ‡å¿—ä½ï¼‰</span><br></code></pre></td></tr></table></figure></li></ul><h2 id="å®ä¸ç»“æ„ä½“"><a href="#å®ä¸ç»“æ„ä½“" class="headerlink" title="å®ä¸ç»“æ„ä½“"></a>å®ä¸ç»“æ„ä½“</h2><ul><li><p>å®ï¼š</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-comment">;æ— å‚å®ä½¿ç”¨å…³é”®å­—EQUï¼Œå¦‚</span><br>PI <span class="hljs-built_in">EQU</span> <span class="hljs-number">3</span><span class="hljs-comment">;å®šä¹‰PI=3</span><br><span class="hljs-comment">;å«å‚å®ä½¿ç”¨å…³é”®å­—MACROï¼Œç”¨endmç»“å°¾ï¼Œå¦‚</span><br>Myadd MACRO Number<br><span class="hljs-keyword">add</span> <span class="hljs-built_in">eax</span>,Number<br>endm<span class="hljs-comment">;å®šä¹‰Myaddå‡½æ•°å®ç°eaxåŠ ä¸Šå‚æ•°</span><br><span class="hljs-comment">;å«å‚å®çš„è°ƒç”¨ï¼š</span><br>Myadd&lt;å‚æ•°&gt;<br></code></pre></td></tr></table></figure></li><li><p>ç»“æ„ä½“ï¼š</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-comment">;ä½¿ç”¨å…³é”®å­—structå’Œendsï¼Œå¦‚</span><br>Point struct<br>x <span class="hljs-built_in">word</span> ?<br>y <span class="hljs-built_in">word</span> ?<br>Point ends<br><br><span class="hljs-comment">;å®ä¾‹åŒ–ç»“æ„ä½“</span><br>MyPoint Point&lt;?&gt;<span class="hljs-comment">;å®ä¾‹åŒ–å‡ºMyPoint</span><br><br><span class="hljs-comment">;è®¿é—®ç»“æ„ä½“æˆå‘˜</span><br><span class="hljs-keyword">mov</span> MyPoint<span class="hljs-number">.</span>x,<span class="hljs-number">123</span><br></code></pre></td></tr></table></figure></li></ul><h2 id="x64æ±‡ç¼–æ¡†æ¶-MASM"><a href="#x64æ±‡ç¼–æ¡†æ¶-MASM" class="headerlink" title="x64æ±‡ç¼–æ¡†æ¶(MASM)"></a>x64æ±‡ç¼–æ¡†æ¶(MASM)</h2><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-comment">;x64ç¯å¢ƒä¸‹çš„ä»£ç ï¼Œä¼ å‚çš„æ—¶å€™å…ˆä½¿ç”¨å¯„å­˜å™¨(Windows:rcx,rdx,r8,r9  Linux:rdi,rsi,rdx,rcx,r8,r9)å†ä½¿ç”¨æ ˆ</span><br><span class="hljs-meta">.code</span><br><span class="hljs-comment">;Addå‡½æ•°å£°æ˜</span><br><span class="hljs-keyword">Add</span> proc<br><span class="hljs-keyword">push</span> <span class="hljs-built_in">rbp</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rbp</span>,<span class="hljs-built_in">rsp</span><br><span class="hljs-keyword">lea</span> <span class="hljs-built_in">rax</span>,[<span class="hljs-built_in">rdi</span> + <span class="hljs-built_in">rsi</span>]<span class="hljs-comment">;ä»å¯„å­˜å™¨ä¸­å–å‚æ•°</span><br><span class="hljs-keyword">pop</span> <span class="hljs-built_in">rbp</span><br><span class="hljs-keyword">ret</span><br><span class="hljs-keyword">Add</span> endp<br><br>main proc<br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>,<span class="hljs-number">2</span><span class="hljs-comment">;æŠŠå‚æ•°ä¼ å…¥å¯„å­˜å™¨ä¸­</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>,<span class="hljs-number">3</span><br><span class="hljs-keyword">call</span> <span class="hljs-keyword">Add</span><br><span class="hljs-keyword">ret</span><br>main endp<br>end<br><br><br><span class="hljs-comment">;x86ç¯å¢ƒä¸‹çš„ä»£ç ï¼Œä¼ å‚ä½¿ç”¨æ ˆ</span><br><span class="hljs-meta">.code</span><br><span class="hljs-comment">;Addå‡½æ•°å£°æ˜</span><br><span class="hljs-keyword">Add</span> proc<br><span class="hljs-keyword">push</span> <span class="hljs-built_in">ebp</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ebp</span>,<span class="hljs-built_in">esp</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">eax</span>,[<span class="hljs-built_in">esp</span>+<span class="hljs-number">8</span>]<span class="hljs-comment">;ä»æ ˆä¸Šå–å‚æ•°</span><br><span class="hljs-keyword">add</span> <span class="hljs-built_in">eax</span>,[<span class="hljs-built_in">esp</span>+<span class="hljs-number">12</span>]<br><span class="hljs-keyword">pop</span> <span class="hljs-built_in">ebp</span><br><span class="hljs-keyword">ret</span><br><span class="hljs-keyword">Add</span> endp<br><br>main proc<br><span class="hljs-keyword">push</span> <span class="hljs-number">3</span><span class="hljs-comment">;æŠŠå‚æ•°å‹å…¥æ ˆä¸­</span><br><span class="hljs-keyword">push</span> <span class="hljs-number">2</span><br><span class="hljs-keyword">call</span> <span class="hljs-keyword">Add</span><br><span class="hljs-keyword">add</span> <span class="hljs-built_in">esp</span>,<span class="hljs-number">8</span><br>main endp<br></code></pre></td></tr></table></figure><h2 id="å†…è”æ±‡ç¼–ä¸æ··åˆç¼–ç¨‹"><a href="#å†…è”æ±‡ç¼–ä¸æ··åˆç¼–ç¨‹" class="headerlink" title="å†…è”æ±‡ç¼–ä¸æ··åˆç¼–ç¨‹"></a>å†…è”æ±‡ç¼–ä¸æ··åˆç¼–ç¨‹</h2><ul><li><p>x86ä¸‹ï¼Œåœ¨Microsoft Visual C++ (MSVC)ç¨‹åºä¸­ä½¿ç”¨æ±‡ç¼–ï¼Œå¯ä»¥é€šè¿‡_asm{}ç›´æ¥å†™åœ¨C++ä»£ç ä¸­:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    _asm&#123;<br>        <span class="hljs-keyword">xor</span> eax,eax<br>        mov eax,<span class="hljs-number">1</span><br>        add eax,<span class="hljs-number">1</span><br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>x64ä¸‹ï¼Œåœ¨Microsoft Visual C++ (MSVC)ç¨‹åºä¸­ä½¿ç”¨æ±‡ç¼–ï¼Œéœ€è¦ç‹¬ç«‹çš„asmæ–‡ä»¶ï¼Œé€šè¿‡externå£°æ˜ä½¿ç”¨ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-keyword">extern</span> <span class="hljs-string">&quot;C&quot;</span> <span class="hljs-function"><span class="hljs-type">long</span> <span class="hljs-type">long</span> <span class="hljs-title">Add</span><span class="hljs-params">(<span class="hljs-type">long</span> <span class="hljs-type">long</span> number1,<span class="hljs-type">long</span> <span class="hljs-type">long</span> number2)</span></span>;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-type">long</span> <span class="hljs-type">long</span> res=<span class="hljs-built_in">Add</span>(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>);<br>    std::cout&lt;&lt;res&lt;&lt;std::endl;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-comment">//asmæ–‡ä»¶</span><br>.code<br>Add proc<br>    push rbp<br>    mov rbp,rsp<br>    <span class="hljs-keyword">xor</span> rax,rax<br>    add rax,rcx<br>    add rax,rdx<br>    pop rbp<br>    ret<br>Add endp<br>end<br></code></pre></td></tr></table></figure></li></ul>]]></content>
    
    
    <summary type="html">å‡½æ•°ä¸æ ˆå¸§ã€æ•°ç»„ä¸ä¸²æŒ‡ä»¤ã€å®ä¸ç»“æ„ä½“ã€x64æ±‡ç¼–æ¡†æ¶ã€å†…è”æ±‡ç¼–ä¸æ··åˆç¼–ç¨‹</summary>
    
    
    
    <category term="Reverse Engineering" scheme="https://sydzi.github.io/categories/Reverse-Engineering/"/>
    
    
    <category term="CTF" scheme="https://sydzi.github.io/tags/CTF/"/>
    
    <category term="Reverse" scheme="https://sydzi.github.io/tags/Reverse/"/>
    
  </entry>
  
  <entry>
    <title>Day2:å¯»å€æ–¹å¼ã€æ ‡å¿—å¯„å­˜å™¨ã€JCCæŒ‡ä»¤</title>
    <link href="https://sydzi.github.io/2025/07/07/Day2-%E5%AF%BB%E5%9D%80%E6%96%B9%E5%BC%8F/"/>
    <id>https://sydzi.github.io/2025/07/07/Day2-%E5%AF%BB%E5%9D%80%E6%96%B9%E5%BC%8F/</id>
    <published>2025-07-07T06:23:19.000Z</published>
    <updated>2025-09-18T03:56:48.943Z</updated>
    
    <content type="html"><![CDATA[<p>å¯»å€æ–¹å¼ã€æ ‡å¿—å¯„å­˜å™¨ã€JCCæŒ‡ä»¤</p><span id="more"></span><h2 id="å¯»å€æ–¹å¼"><a href="#å¯»å€æ–¹å¼" class="headerlink" title="å¯»å€æ–¹å¼"></a>å¯»å€æ–¹å¼</h2><table><thead><tr><th align="center">å¯»å€æ–¹å¼</th><th align="center">ç¤ºä¾‹</th><th align="center">å…¸å‹ç”¨é€”</th></tr></thead><tbody><tr><td align="center">ç«‹å³æ•°å¯»å€</td><td align="center">mov eax,42</td><td align="center">åŠ è½½å¸¸æ•°</td></tr><tr><td align="center">å¯„å­˜å™¨å¯»å€</td><td align="center">add eax,ebx</td><td align="center">å¯„å­˜å™¨è¿ç®—</td></tr><tr><td align="center">ç›´æ¥å¯»å€</td><td align="center">mov eax,[0x8040000]</td><td align="center">è®¿é—®å…¨å±€å˜é‡</td></tr><tr><td align="center">å¯„å­˜å™¨é—´æ¥å¯»å€</td><td align="center">mov eax,[esi]</td><td align="center">æŒ‡é’ˆè§£å¼•ç”¨</td></tr><tr><td align="center">åŸºå€å¯»å€</td><td align="center">mov [ebp-4],ecx</td><td align="center">æ ˆå¸§å±€éƒ¨å˜é‡</td></tr><tr><td align="center">å˜å€å¯»å€</td><td align="center">mov eax,[esi*4]</td><td align="center">æ•°ç»„éå†</td></tr><tr><td align="center">åŸºå€å˜å€å¯»å€</td><td align="center">mov eax,[ebx+esi*2+8]</td><td align="center">ç»“æ„ä½“ï¼Œå¤šç»´æ•°ç»„</td></tr><tr><td align="center">ç›¸å¯¹å¯»å€</td><td align="center">jmp label</td><td align="center">è·³è½¬ï¼Œå‡½æ•°è°ƒç”¨</td></tr></tbody></table><h2 id="æ ‡å¿—å¯„å­˜å™¨"><a href="#æ ‡å¿—å¯„å­˜å™¨" class="headerlink" title="æ ‡å¿—å¯„å­˜å™¨"></a>æ ‡å¿—å¯„å­˜å™¨</h2><table><thead><tr><th align="center">æ ‡å¿—ä½</th><th align="center">åç§°</th><th align="center">ä½œç”¨</th></tr></thead><tbody><tr><td align="center">CF</td><td align="center">Carry Flag è¿›ä½æ ‡å¿—ä½</td><td align="center">æœ€é«˜ä½å‘ç”Ÿè¿›ä½&#x2F;å€Ÿä½æ—¶ç½®1</td></tr><tr><td align="center">PF</td><td align="center">Parity Flag å¥‡å¶æ ‡å¿—ä½</td><td align="center">1çš„ä¸ªæ•°ä¸ºå¶æ•°æ—¶ç½®1</td></tr><tr><td align="center">AF</td><td align="center">Auxiliary Carry Flag è¾…åŠ©è¿›ä½æ ‡å¿—ä½</td><td align="center">bit3å’Œbit4ä¹‹é—´å‘ç”Ÿè¿›ä½&#x2F;å€Ÿä½æ—¶ç½®1</td></tr><tr><td align="center">ZF</td><td align="center">Zoro Flag é›¶æ ‡å¿—ä½</td><td align="center">ä¸º0æ—¶ç½®1</td></tr><tr><td align="center">SF</td><td align="center">Sign Flag ç¬¦å·æ ‡å¿—ä½</td><td align="center">æœ€é«˜ä½ä¸º1(è´Ÿæ•°)æ—¶ç½®1</td></tr><tr><td align="center">OF</td><td align="center">Overflow Flag æº¢å‡ºæ ‡å¿—ä½</td><td align="center">æœ‰ç¬¦å·æ•°æº¢å‡ºæ—¶ç½®1</td></tr><tr><td align="center">DF</td><td align="center">Direction Flag æ–¹å‘æ ‡å¿—ä½</td><td align="center">ä¸º1æ—¶ä»é«˜ä½åˆ°ä½ä½å¤„ç†å­—ç¬¦ä¸²ï¼Œstdæ‰“å¼€ï¼Œcldå…³é—­</td></tr><tr><td align="center">IF</td><td align="center">Interrupt Flag ä¸­æ–­æ ‡å¿—ä½</td><td align="center">ä¸º1æ—¶å¯ä»¥å“åº”ä¸­æ–­è¯·æ±‚ï¼Œstiæ‰“å¼€ï¼Œcliå…³é—­</td></tr><tr><td align="center">TF</td><td align="center">Trap Flag é™·é˜±æ ‡å¿—ä½</td><td align="center">ä¸º1æ—¶ä¼šè§¦å‘å¼‚å¸¸ï¼Œè¢«è°ƒè¯•å™¨æ•è·ï¼Œç”¨äºå•æ­¥è°ƒè¯•</td></tr></tbody></table><h2 id="JCCæŒ‡ä»¤"><a href="#JCCæŒ‡ä»¤" class="headerlink" title="JCCæŒ‡ä»¤"></a>JCCæŒ‡ä»¤</h2><ul><li><p>TESTæŒ‡ä»¤ï¼šTEST op1,op2</p><p>å°†ä¸¤ä¸ªæ“ä½œæ•°è¿›è¡Œ&amp;æ“ä½œï¼ˆop1 &amp; op2ï¼‰å¹¶æ›´æ–°æ ‡å¿—ä½ï¼š</p><p>CF&#x3D;0ï¼ŒOF&#x3D;0</p><p>&amp;ç»“æœä¸º0ï¼šZF&#x3D;1</p><p>ç»“æœæœ€é«˜ä½ä¸º1ï¼šSF&#x3D;1</p></li><li><p>CMPæŒ‡ä»¤ï¼šCMP op1,op2</p><p>è¿›è¡Œå‡æ³•æ“ä½œï¼ˆop1 - op2ï¼‰å¹¶æ›´æ–°æ ‡å¿—ä½ï¼š</p><p>è‹¥op1 &lt; op2ï¼ˆå‘ç”Ÿå€Ÿä½ï¼‰ï¼ŒCF&#x3D;1</p><p>è‹¥å‘ç”Ÿæœ‰ç¬¦å·æº¢å‡ºï¼ŒOF&#x3D;1</p><p>op1 &#x3D;&#x3D; op2ï¼ˆç»“æœä¸º0ï¼‰ï¼ŒZF&#x3D;1</p><p>op1 &lt; op2ï¼ˆç»“æœä¸ºè´Ÿæ•°ï¼‰ï¼ŒSF&#x3D;1</p></li><li><p>JCCæŒ‡ä»¤ï¼šJCC Label</p><table><thead><tr><th align="center">æŒ‡ä»¤</th><th align="center">æ¡ä»¶</th><th align="center">æè¿°</th></tr></thead><tbody><tr><td align="center">JMP</td><td align="center">æ— æ¡ä»¶</td><td align="center">æ— æ¡ä»¶è·³è½¬</td></tr><tr><td align="center">JE &#x2F; JZ</td><td align="center">ZF&#x3D;1</td><td align="center"><strong>J</strong>ump if <strong>E</strong>qual &#x2F; <strong>J</strong>ump if <strong>Z</strong>F</td></tr><tr><td align="center">JNE &#x2F; JNZ</td><td align="center">ZF&#x3D;0</td><td align="center"><strong>J</strong>ump if <strong>N</strong>ot <strong>E</strong>qual &#x2F; <strong>J</strong>ump if <strong>N</strong>ot <strong>Z</strong>F</td></tr><tr><td align="center">JS</td><td align="center">SF&#x3D;1</td><td align="center"><strong>J</strong>ump if <strong>S</strong>F</td></tr><tr><td align="center">JNS</td><td align="center">SF&#x3D;0</td><td align="center"><strong>J</strong>ump if <strong>N</strong>ot <strong>S</strong>F</td></tr><tr><td align="center">JP &#x2F; JPE</td><td align="center">PF&#x3D;1</td><td align="center"><strong>J</strong>ump if <strong>P</strong>F &#x2F; <strong>J</strong>ump if <strong>P</strong>arity <strong>E</strong>ven</td></tr><tr><td align="center">JNP &#x2F; JPO</td><td align="center">PF&#x3D;0</td><td align="center"><strong>J</strong>ump if <strong>N</strong>ot <strong>P</strong>F &#x2F; <strong>J</strong>ump if <strong>P</strong>arity <strong>O</strong>dd</td></tr><tr><td align="center">JO</td><td align="center">OF&#x3D;1</td><td align="center"><strong>J</strong>ump if <strong>O</strong>F</td></tr><tr><td align="center">JNO</td><td align="center">OF&#x3D;0</td><td align="center"><strong>J</strong>ump if <strong>N</strong>ot <strong>O</strong>F</td></tr><tr><td align="center">JB &#x2F; JNAE &#x2F; JC</td><td align="center">CF&#x3D;1</td><td align="center"><strong>J</strong>ump if <strong>B</strong>elow &#x2F; <strong>J</strong>ump if <strong>N</strong>ot <strong>A</strong>bove or <strong>E</strong>qual &#x2F; <strong>J</strong>ump if <strong>C</strong>F</td></tr><tr><td align="center">JNB &#x2F; JAE &#x2F; JNC</td><td align="center">CF&#x3D;0</td><td align="center"><strong>J</strong>ump if <strong>N</strong>ot <strong>B</strong>elow &#x2F; <strong>J</strong>ump if <strong>A</strong>bove or <strong>E</strong>qual &#x2F; <strong>J</strong>ump if <strong>N</strong>ot <strong>C</strong>F</td></tr><tr><td align="center">JBE &#x2F; JNA</td><td align="center">CF&#x3D;1 æˆ– ZF&#x3D;1</td><td align="center"><strong>J</strong>ump if <strong>B</strong>elow or <strong>E</strong>qual &#x2F; <strong>J</strong>ump if <strong>N</strong>ot <strong>A</strong>bove</td></tr><tr><td align="center">JA &#x2F; JNBE</td><td align="center">CF&#x3D;0 ä¸” ZF&#x3D;0</td><td align="center"><strong>J</strong>ump if <strong>A</strong>bove &#x2F; <strong>J</strong>ump if <strong>N</strong>ot <strong>B</strong>elow or <strong>E</strong>qual</td></tr><tr><td align="center">JL &#x2F; JNGE</td><td align="center">SF â‰  OF</td><td align="center"><strong>J</strong>ump if <strong>L</strong>ess &#x2F; <strong>J</strong>ump if <strong>N</strong>ot <strong>G</strong>reater or <strong>E</strong>qual</td></tr><tr><td align="center">JGE &#x2F; JNL</td><td align="center">SF &#x3D; OF</td><td align="center"><strong>J</strong>ump if <strong>G</strong>reater or <strong>E</strong>qual &#x2F; <strong>J</strong>ump if <strong>N</strong>ot <strong>L</strong>ess</td></tr><tr><td align="center">JLE &#x2F; JNG</td><td align="center">ZF&#x3D;1 æˆ– SF â‰  OF</td><td align="center"><strong>J</strong>ump if <strong>L</strong>ess or <strong>E</strong>qual &#x2F; <strong>J</strong>ump if <strong>N</strong>ot <strong>G</strong>reater</td></tr><tr><td align="center">JG &#x2F; JNLE</td><td align="center">ZF&#x3D;0 ä¸” SF &#x3D; OF</td><td align="center"><strong>J</strong>ump if <strong>G</strong>reater &#x2F; <strong>J</strong>ump if <strong>N</strong>ot <strong>L</strong>ess or <strong>E</strong>qual</td></tr></tbody></table></li></ul>]]></content>
    
    
    <summary type="html">å¯»å€æ–¹å¼ã€æ ‡å¿—å¯„å­˜å™¨ã€JCCæŒ‡ä»¤</summary>
    
    
    
    <category term="Reverse Engineering" scheme="https://sydzi.github.io/categories/Reverse-Engineering/"/>
    
    
    <category term="CTF" scheme="https://sydzi.github.io/tags/CTF/"/>
    
    <category term="Reverse" scheme="https://sydzi.github.io/tags/Reverse/"/>
    
  </entry>
  
  <entry>
    <title>Day1:x86æ±‡ç¼–æ¡†æ¶ã€æ•°æ®ç±»å‹ã€åŸºæœ¬è¿ç®—ã€ä½è¿ç®—</title>
    <link href="https://sydzi.github.io/2025/07/05/Day1-x86%E6%B1%87%E7%BC%96%E6%A1%86%E6%9E%B6/"/>
    <id>https://sydzi.github.io/2025/07/05/Day1-x86%E6%B1%87%E7%BC%96%E6%A1%86%E6%9E%B6/</id>
    <published>2025-07-05T06:14:02.000Z</published>
    <updated>2025-09-18T03:56:40.324Z</updated>
    
    <content type="html"><![CDATA[<p>vs2022æ±‡ç¼–ç¯å¢ƒã€x86æ±‡ç¼–æ¡†æ¶ã€æ•°æ®ç±»å‹ã€åŸºæœ¬è¿ç®—ã€ä½è¿ç®—</p><span id="more"></span><h2 id="åœ¨vs2022ä¸­ç¼–å†™æ±‡ç¼–ä»£ç "><a href="#åœ¨vs2022ä¸­ç¼–å†™æ±‡ç¼–ä»£ç " class="headerlink" title="åœ¨vs2022ä¸­ç¼–å†™æ±‡ç¼–ä»£ç "></a>åœ¨vs2022ä¸­ç¼–å†™æ±‡ç¼–ä»£ç </h2><ul><li><p>æ–°å»ºä¸€ä¸ªç©ºé¡¹ç›®</p></li><li><p>åœ¨å·¥å…·æ çš„â€œå·¥å…·â€é€‰é¡¹ä¸­é€‰æ‹©â€œè·å–å·¥å…·å’ŒåŠŸèƒ½â€ï¼Œåœ¨â€œä½¿ç”¨C++çš„æ¡Œé¢å¼€å‘â€ä¸­å‹¾é€‰â€œWindows 10 SDKâ€ä»¥åŠâ€œMSVC v142 -VS 2015 C++ç”Ÿæˆå·¥å…·â€ï¼Œç„¶åå®‰è£…è¿™äº›æ–°å‹¾é€‰çš„é€‰é¡¹ï¼Œæ›´æ–°VS2022</p><p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-07-05%20233157.png" alt="å‹¾é€‰é€‰é¡¹"></p></li><li><p>å³é”®æ–°å»ºçš„ç©ºé¡¹ç›®ï¼Œé€‰æ‹©æœ€ä¸‹æ–¹çš„â€œå±æ€§â€ï¼Œåœ¨å¼¹å‡ºæ¥çš„é¡µé¢ä¸­é€‰æ‹©â€œå¸¸è§„â€ï¼Œç„¶åå°†å¹³å°ç‰ˆæœ¬æ”¹æˆwindows10ï¼Œå¯èƒ½éœ€è¦æ”¹ä¹Ÿå¯èƒ½ä¸éœ€è¦</p><p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-07-05%20233305.png" alt="å±æ€§é¡µ"></p></li><li><p>å³é”®æ–°å»ºçš„ç©ºé¡¹ç›®ï¼Œé€‰æ‹©â€œç”Ÿæˆä¾èµ–æ€§â€ï¼Œç„¶åæ˜¯â€œç”Ÿæˆè‡ªå®šä¹‰â€ï¼Œåœ¨ç•Œé¢ä¸­é€‰æ‹©masm</p><p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-07-05%20233422.png" alt="ç”Ÿæˆè‡ªå®šä¹‰"></p></li><li><p>ç„¶åå°±å¯ä»¥æ–°å»ºä¸€ä¸ª.asmæºæ–‡ä»¶äº†ã€‚æ–°å»ºå®Œæˆåï¼Œå³é”®æºæ–‡ä»¶é€‰æ‹©â€œå±æ€§â€ï¼Œç„¶ååœ¨â€œå¸¸è§„â€é‡Œæ£€æŸ¥é¡¹ç±»å‹æ˜¯å¦ä¸ºâ€œMicrosoft Macro Assemblerâ€</p><p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-07-05%20233723.png" alt="å¸¸è§„"></p></li><li><p>ä»¥ä¸Šæ˜¯é’ˆå¯¹æŠ¥é”™è¿›è¡Œçš„å°è¯•ä¿®æ­£æ€»ç»“ï¼Œå¯èƒ½æœ‰å¤šä½™æˆ–è€…ä¸è¶³ä¹‹å¤„</p></li></ul><h2 id="x86æ±‡ç¼–æ¡†æ¶-MASM"><a href="#x86æ±‡ç¼–æ¡†æ¶-MASM" class="headerlink" title="x86æ±‡ç¼–æ¡†æ¶(MASM)"></a>x86æ±‡ç¼–æ¡†æ¶(MASM)</h2><ul><li><p>xxxxxxxxxx2Â 1int num[2][2] &#x3D; { {1,2},{3,4} };2printf(â€œ%d,%d,%d,%dâ€, num[0][0], num[0][1], num[1][0], num[1][1]);c</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-comment">;é¢„å¤„ç†</span><br><span class="hljs-meta">.586</span><br><span class="hljs-meta">.model</span> flat,stdcall<br><br><span class="hljs-comment">;åŒ…å«çš„é“¾æ¥åº“</span><br>includelib ucrt<span class="hljs-number">.</span>lib<br>includelib legacy_stdio_definitions<span class="hljs-number">.</span>lib<br>includelib kernel32<span class="hljs-number">.</span>lib<br>includelib user32<span class="hljs-number">.</span>lib<br><br><span class="hljs-comment">;å¤–éƒ¨å‡½æ•°å£°æ˜</span><br><span class="hljs-meta">extern</span> printf:proc<br><br><span class="hljs-comment">;æ•°æ®æ®µ</span><br><span class="hljs-meta">.data</span><br>szHello <span class="hljs-built_in">db</span> <span class="hljs-string">&#x27;HelloWorld!&#x27;</span>,<span class="hljs-number">0</span><br><br><span class="hljs-comment">;ä»£ç æ®µ</span><br><span class="hljs-meta">.code</span><br><span class="hljs-comment">;å‡½æ•°å£°æ˜</span><br>main proc<br><span class="hljs-keyword">lea</span> <span class="hljs-built_in">eax</span>,szHello<br><span class="hljs-keyword">push</span> <span class="hljs-built_in">eax</span><br><span class="hljs-keyword">call</span> printf<br><span class="hljs-keyword">add</span> <span class="hljs-built_in">esp</span>,<span class="hljs-number">4</span><br>main endp<br>end<br></code></pre></td></tr></table></figure><ul><li><p>é‡ç‚¹å¦‚ä¸‹ï¼š</p></li><li><p>é“¾æ¥åº“å£°æ˜</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs x86asm">includelib NameOfLib<span class="hljs-number">.</span>lib<br></code></pre></td></tr></table></figure></li><li><p>ä¸åŒçš„æ®µ</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">.NameOfSection</span><br><span class="hljs-comment">;æ®µæ‰€åŒ…å«çš„æ•°æ®</span><br></code></pre></td></tr></table></figure></li><li><p>å‡½æ•°æ ¼å¼</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs x86asm">functionName proc å‚æ•°å<span class="hljs-number">1</span>:å‚æ•°ç±»å‹ï¼Œå‚æ•°å<span class="hljs-number">2</span>:å‚æ•°ç±»å‹...<br><span class="hljs-comment">;æ±‡ç¼–ä»£ç </span><br>functionName endp<br></code></pre></td></tr></table></figure></li><li><p>åœ¨ä¸€ä¸ªasmæ–‡ä»¶æœ«å°¾ï¼Œéœ€è¦</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs x86asm">end<span class="hljs-comment">;ç”¨äºæ— å…¥å£ç‚¹ï¼Œå³éå¯æ‰§è¡Œæ–‡ä»¶ï¼Œä¸éœ€è¦ä¸»å‡½æ•°æ—¶</span><br>end main<span class="hljs-comment">;ç”¨äºå¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¿…é¡»æŒ‡å®šå…¥å£ç‚¹(å¦‚mainå‡½æ•°)æ—¶</span><br></code></pre></td></tr></table></figure></li></ul></li></ul><h2 id="æ•°æ®ç±»å‹"><a href="#æ•°æ®ç±»å‹" class="headerlink" title="æ•°æ®ç±»å‹"></a>æ•°æ®ç±»å‹</h2><table><thead><tr><th align="center">ç±»å‹åç§°</th><th align="center">ç®€å†™</th><th align="center">å¯¹åº”ç±»å‹</th><th align="center">å ç”¨å­—èŠ‚æ•°</th></tr></thead><tbody><tr><td align="center">BYTE</td><td align="center">db</td><td align="center">char</td><td align="center">1</td></tr><tr><td align="center">WORD</td><td align="center">dw</td><td align="center">short</td><td align="center">2</td></tr><tr><td align="center">DWORD</td><td align="center">dd</td><td align="center">int</td><td align="center">4</td></tr><tr><td align="center">QWORD</td><td align="center">dq</td><td align="center">long long</td><td align="center">8</td></tr></tbody></table><h2 id="åŸºæœ¬è¿ç®—"><a href="#åŸºæœ¬è¿ç®—" class="headerlink" title="åŸºæœ¬è¿ç®—"></a>åŸºæœ¬è¿ç®—</h2><ul><li><p>æ•°æ®ä¼ é€æŒ‡ä»¤</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-keyword">mov</span> dest,src<span class="hljs-comment">;dest=src</span><br><br><span class="hljs-comment">;eax=1ç¤ºä¾‹</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">eax</span>,<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure></li><li><p>åœ°å€ä¼ é€æŒ‡ä»¤</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-keyword">lea</span> dest,[addr]<span class="hljs-comment">;dest=addr</span><br><br><span class="hljs-comment">;eax=77E75F38ç¤ºä¾‹</span><br><span class="hljs-keyword">lea</span> <span class="hljs-built_in">eax</span>,77E75F38<br></code></pre></td></tr></table></figure></li><li><p>åŠ æ³•</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-keyword">add</span> dest,src<span class="hljs-comment">;dest=dest+src</span><br><br><span class="hljs-comment">;1+1=2ç¤ºä¾‹ï¼Œæœ€åeaxé‡Œä¸º2</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">eax</span>,<span class="hljs-number">1</span><br><span class="hljs-keyword">add</span> <span class="hljs-built_in">eax</span>,<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure></li><li><p>è‡ªå¢</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-keyword">inc</span> dest<span class="hljs-comment">;dest=dest+1</span><br><br><span class="hljs-comment">;eax++ç¤ºä¾‹</span><br><span class="hljs-keyword">inc</span> <span class="hljs-built_in">eax</span><br></code></pre></td></tr></table></figure></li><li><p>å‡æ³•</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-keyword">sub</span> dest,src<span class="hljs-comment">;dest=dest-src</span><br><br><span class="hljs-comment">;6-2=4ç¤ºä¾‹ï¼Œæœ€åeaxé‡Œä¸º4</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">eax</span>,<span class="hljs-number">6</span><br><span class="hljs-keyword">sub</span> <span class="hljs-built_in">eax</span>,<span class="hljs-number">2</span><br></code></pre></td></tr></table></figure></li><li><p>è‡ªå‡</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-keyword">dec</span> dest<span class="hljs-comment">;dest=dest-1</span><br><br><span class="hljs-comment">;eax--ç¤ºä¾‹</span><br><span class="hljs-keyword">dec</span> <span class="hljs-built_in">eax</span><br></code></pre></td></tr></table></figure></li><li><p>ä¹˜æ³•</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-comment">;åˆ†ä¸ºmul(æ— ç¬¦å·)å’Œimul(æœ‰ç¬¦å·)</span><br><span class="hljs-comment">;ä¹˜æ³•ç»“æœå­˜æ”¾åœ¨edxå’Œeaxä¸­(edx:eax)ï¼Œä½ä½eaxï¼Œé«˜ä½edxã€‚æœªæŒ‡å®šæ—¶ï¼Œeaxé»˜è®¤ä½œä¸ºä¸€ä¸ªå› æ•°</span><br><span class="hljs-keyword">mul</span> src<span class="hljs-comment">;edx:eax=eax*src</span><br><span class="hljs-keyword">imul</span> src<span class="hljs-comment">;edx:eax=eax*src</span><br><span class="hljs-keyword">imul</span> dest,src<span class="hljs-comment">;dest=dest*src</span><br><span class="hljs-keyword">imul</span> dest,src,imm<span class="hljs-comment">;dest=src*imm</span><br><br><span class="hljs-comment">;4*2=8ç¤ºä¾‹ï¼Œeax*ebx</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">eax</span>,<span class="hljs-number">4</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ebx</span>,<span class="hljs-number">2</span><br><span class="hljs-keyword">mul</span> <span class="hljs-built_in">ebx</span><br></code></pre></td></tr></table></figure></li><li><p>é™¤æ³•</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-comment">;åˆ†ä¸ºdiv(æ— ç¬¦å·)å’Œidiv(æœ‰ç¬¦å·)</span><br><span class="hljs-comment">;è¢«é™¤æ•°æ”¾åœ¨edx:eaxä¸­ï¼Œé™¤æ•°ä»»æ„ï¼Œå•†å­˜æ”¾åœ¨eaxä¸­ï¼Œä½™æ•°å­˜æ”¾åœ¨edxä¸­</span><br><span class="hljs-keyword">div</span> src<span class="hljs-comment">;edx:eax%src=eax...edx</span><br><span class="hljs-keyword">idiv</span> src<span class="hljs-comment">;edx:eax%src=eax...edx</span><br><br><span class="hljs-comment">;101%2...1ç¤ºä¾‹</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">eax</span>,<span class="hljs-number">101</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">edx</span>,<span class="hljs-number">0</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ebx</span>,<span class="hljs-number">2</span><br><span class="hljs-keyword">div</span> <span class="hljs-built_in">ebx</span><br></code></pre></td></tr></table></figure></li></ul><h2 id="ä½è¿ç®—"><a href="#ä½è¿ç®—" class="headerlink" title="ä½è¿ç®—"></a>ä½è¿ç®—</h2><ul><li><p>ä¸</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-keyword">and</span> dest,src<span class="hljs-comment">;dest=dest &amp; src</span><br><br><span class="hljs-comment">;1&amp;2=0ç¤ºä¾‹</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">eax</span>,<span class="hljs-number">1</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ebx</span>,<span class="hljs-number">2</span><br><span class="hljs-keyword">and</span> <span class="hljs-built_in">eax</span>,<span class="hljs-built_in">ebx</span><br></code></pre></td></tr></table></figure></li><li><p>æˆ–</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-keyword">or</span> dest,src<span class="hljs-comment">;dest=dest | src</span><br><br><span class="hljs-comment">;1|2=3ç¤ºä¾‹</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">eax</span>,<span class="hljs-number">1</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ebx</span>,<span class="hljs-number">2</span><br><span class="hljs-keyword">or</span> <span class="hljs-built_in">eax</span>,<span class="hljs-built_in">ebx</span><br></code></pre></td></tr></table></figure></li><li><p>å–å</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-keyword">not</span> dest<span class="hljs-comment">;dest=~dest</span><br><br><span class="hljs-comment">;not 00000001=11111110ç¤ºä¾‹</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">eax</span>,<span class="hljs-number">1</span><br><span class="hljs-keyword">not</span> <span class="hljs-built_in">eax</span><br></code></pre></td></tr></table></figure></li><li><p>å¼‚æˆ–</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-keyword">xor</span> dest,src<span class="hljs-comment">;dest=dest^src</span><br><br><span class="hljs-comment">;1^2=3ç¤ºä¾‹</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">eax</span>,<span class="hljs-number">1</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ebx</span>,<span class="hljs-number">2</span><br><span class="hljs-keyword">xor</span> <span class="hljs-built_in">eax</span>,<span class="hljs-built_in">ebx</span><br></code></pre></td></tr></table></figure></li><li><p>å·¦ç§»ï¼Œå³ç§»</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-comment">;å·¦ç§»</span><br><span class="hljs-keyword">shl</span> dest,count<span class="hljs-comment">;dest=dest&lt;&lt;count</span><br><br><span class="hljs-comment">;1&lt;&lt;3=8ç¤ºä¾‹</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">eax</span>,<span class="hljs-number">1</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">cl</span>,<span class="hljs-number">3</span><br><span class="hljs-keyword">shl</span> <span class="hljs-built_in">eax</span>,<span class="hljs-built_in">cl</span><br><br><span class="hljs-comment">;å³ç§»</span><br><span class="hljs-keyword">shr</span> dest,count<span class="hljs-comment">;dest=dest&gt;&gt;count</span><br><br><span class="hljs-comment">;8&gt;&gt;3=1ç¤ºä¾‹</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">eax</span>,<span class="hljs-number">8</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">cl</span>,<span class="hljs-number">3</span><br><span class="hljs-keyword">shr</span> <span class="hljs-built_in">eax</span>,<span class="hljs-built_in">cl</span><br></code></pre></td></tr></table></figure></li></ul>]]></content>
    
    
    <summary type="html">vs2022æ±‡ç¼–ç¯å¢ƒã€x86æ±‡ç¼–æ¡†æ¶ã€æ•°æ®ç±»å‹ã€åŸºæœ¬è¿ç®—ã€ä½è¿ç®—</summary>
    
    
    
    <category term="Reverse Engineering" scheme="https://sydzi.github.io/categories/Reverse-Engineering/"/>
    
    
    <category term="CTF" scheme="https://sydzi.github.io/tags/CTF/"/>
    
    <category term="Reverse" scheme="https://sydzi.github.io/tags/Reverse/"/>
    
  </entry>
  
  <entry>
    <title>è®°ä¸€æ¬¡blogé‡å»º</title>
    <link href="https://sydzi.github.io/2025/06/05/%E8%AE%B0%E4%B8%80%E6%AC%A1blog%E9%87%8D%E5%BB%BA/"/>
    <id>https://sydzi.github.io/2025/06/05/%E8%AE%B0%E4%B8%80%E6%AC%A1blog%E9%87%8D%E5%BB%BA/</id>
    <published>2025-06-05T06:30:24.000Z</published>
    <updated>2025-09-02T16:27:02.885Z</updated>
    
    <content type="html"><![CDATA[<p>éƒ¨ç½²Vercelå¤±è¯¯åçš„blogé‡å»ºï¼ˆåŸºäºhexo+NexT8.23.0ï¼Œé‡‡ç”¨utterancesè¯„è®ºç³»ç»Ÿå’Œfirestoreæ•°æ®è®°å½•ï¼‰</p><span id="more"></span><ul><li>OKï¼Œè¿™æ˜¯ç¬”è€…åœ¨ä¾èµ–AIç›²ç›®æŠŠåšå®¢éƒ¨ç½²åˆ°Vercelä¸Šå¯¼è‡´åšå®¢å´©æºƒåçš„åšå®¢é‡å»ºè®°å½•</li><li>è®°å½•çš„åŸå› é¦–å…ˆæ˜¯æ›´æ–°â€œè®°ä¸€æ¬¡blogä¼˜åŒ–â€çš„å†…å®¹ï¼Œè¿˜æœ‰æ–°ç‰ˆæœ¬NexTçš„ä¸€äº›ä¸ªäººé…ç½®ï¼ˆæ–°ç‰ˆæœ¬NexTçš„æ•™ç¨‹å¥½åƒä¸å¤šï¼Œè¯„è®ºç³»ç»Ÿå’Œè®¿å®¢è®¡æ•°ç³»ç»Ÿè¦è‡ªå·±ç¢ç£¨å¥½ä¸€ä¼šå„¿ï¼‰</li></ul><h2 id="é¦–é¡µåˆ†ç±»å¡ç‰‡å®ç°"><a href="#é¦–é¡µåˆ†ç±»å¡ç‰‡å®ç°" class="headerlink" title="é¦–é¡µåˆ†ç±»å¡ç‰‡å®ç°"></a>é¦–é¡µåˆ†ç±»å¡ç‰‡å®ç°</h2><ul><li><p>å› ä¸ºæ˜¯å¯¹â€œè®°ä¸€æ¬¡blogä¼˜åŒ–â€çš„æ›´æ–°ï¼Œæ‰€ä»¥è¿™éƒ¨åˆ†ç›´æ¥è´´ä»£ç äº†ï¼ˆæ³¨ï¼šåŒºåˆ«æ›´å¤šæ˜¯åœ¨æ–‡ä»¶åä»swigå˜æˆäº†njkï¼‰</p><p>themes&#x2F;next&#x2F;layout&#x2F;index.njkï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs html">&#123;% extends &#x27;_layout.njk&#x27; %&#125;<br>&#123;% import &#x27;_macro/sidebar.njk&#x27; as sidebar_template with context %&#125;<br><br>&#123;% block title %&#125;&#123;&#123; title &#125;&#125;&#123;%- if theme.index_with_subtitle and subtitle %&#125; - &#123;&#123; subtitle &#125;&#125;&#123;%- endif %&#125;&#123;% endblock %&#125;<br><br>&#123;% block class %&#125;index categories-page&#123;% endblock %&#125;<br><br>&#123;% block content %&#125;<br><br>&#123;# è¿™éƒ¨åˆ†æ˜¯å®ç°categoryå¡ç‰‡ï¼Œæœ€åé¢è¿˜æœ‰æ²¡categoryçš„æ–‡ç« çš„å¤„ç†ï¼Œå› ä¸ºæˆ‘ä¸¥æ ¼äº†æ¯ç¯‡æ–‡ç« æœ‰categoryï¼Œå°±æ²¡ç®¡ç”»é¢å¦‚ä½•äº† #&#125;<br>&#123;% if site.categories.length &gt; 0 %&#125;<br><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;category-cards-container&quot;</span>&gt;</span><br>    &#123;% for cat in site.categories.toArray() %&#125;<br>      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;category-card&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;category-header&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">h2</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;category-name&quot;</span>&gt;</span>&#123;&#123; cat.name &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;post-count&quot;</span>&gt;</span>&#123;&#123; cat.posts.length &#125;&#125;ç¯‡æ–‡ç« <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>          <span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>&#123;# è¿™ä¸€éƒ¨åˆ†å®ç°å¡ç‰‡æ˜¾ç¤ºåŒ…å«çš„æ–‡ç« çš„æ ‡é¢˜ï¼Œæ•°é‡å¯ä»¥æ”¹ä¸‹é¢çš„limit()çš„æ•°å­— #&#125;<br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;recent-posts-list&quot;</span>&gt;</span><br>      &#123;% for post in cat.posts.sort(&#x27;date&#x27;, -1).limit(3).toArray() %&#125;<br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;recent-post-item&quot;</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;&#123;&#123; url_for(post.path) &#125;&#125;&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;post-title&quot;</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&quot;&#123;&#123; post.title &#125;&#125;&quot;</span>&gt;</span><br>            &#123;&#123; post.title | truncate(18) &#125;&#125;<br>          <span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;post-date&quot;</span>&gt;</span><br>&#123;% if post.updated %&#125; <br>&#123;&#123; post.updated.format(&#x27;MM/DD&#x27;) &#125;&#125;<br>&#123;% else %&#125;<br>&#123;&#123; post.date.format(&#x27;MM/DD&#x27;) &#125;&#125;<br>&#123;% endif %&#125;<br><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>      &#123;% endfor %&#125;<br><br><br> <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;more-posts-wrapper&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;&#123;&#123; url_for(&#x27;/categories/&#x27; + cat.name + &#x27;/&#x27;) &#125;&#125;&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;more-posts-button&quot;</span>&gt;</span><br>æ›´å¤šæ–‡ç«  â†’<br><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>&#123;% endfor %&#125;<br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>&#123;% else %&#125;<br><br> <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;no-categories-notice&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>æš‚æ— åˆ†ç±»æ•°æ®ï¼Œè¯·ä¸ºæ–‡ç« æ·»åŠ åˆ†ç±»<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br><br>  &#123;% endif %&#125;<br><br>&#123;% endblock %&#125;<br><br>&#123;% block sidebar %&#125;<br>  &#123;&#123; sidebar_template.render(false) &#125;&#125;<br>&#123;% endblock %&#125;<br></code></pre></td></tr></table></figure></li><li><p>source&#x2F;_data&#x2F;styles.stylï¼š</p><p>å¾—å…ˆåœ¨next&#x2F;config.ymlé‡Œæ‰“å¼€è¿™ä¸ªæ–‡ä»¶çš„æ”¯æŒï¼ˆå¯èƒ½æ˜¯æ–°ç‰¹æ€§å§ï¼Œç¬”è€…è®°å¾—ä¹‹å‰æ²¡æ”¹è¿‡configè®¾ç½®å°±æœ‰è¿™ä¸ªæ–‡ä»¶äº†ï¼Œä½†æ˜¯ç°åœ¨å¾—æ‰“å¼€æ”¯æŒå¹¶æ‰‹åŠ¨åˆ›å»º_dataæ–‡ä»¶å¤¹å’Œstyles.stylç­‰æ–‡ä»¶ï¼‰ï¼Œåœ¨custom_file_pathé‡Œåˆ é™¤styleçš„æ³¨é‡Š</p><p><img src="/../images/image-20250605144828365.png" alt="æ‰“å¼€æ–‡ä»¶æ”¯æŒ"></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-comment">/* åˆ†ç±»å¡ç‰‡æ ·å¼ - å®‰å…¨è¿½åŠ  */</span><br><span class="hljs-selector-class">.category-cards-container</span> &#123;<br>  <span class="hljs-attribute">margin</span>: <span class="hljs-number">40px</span> auto;<br>  <span class="hljs-attribute">max-width</span>: <span class="hljs-number">1200px</span>;<br>  <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span> <span class="hljs-number">20px</span>;<br><br>  <span class="hljs-selector-class">.category-card</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>,<span class="hljs-number">255</span>,<span class="hljs-number">255</span>,<span class="hljs-number">0.85</span>); <span class="hljs-comment">/* åŠé€æ˜ç™½è‰²ï¼Œä¸ä½ çš„opacity 0.85åè°ƒ */</span><br>    <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">8px</span>;<br>    <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">2px</span> <span class="hljs-number">15px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0.1</span>);<br>    <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">25px</span>;<br>    <span class="hljs-attribute">padding</span>: <span class="hljs-number">25px</span>;<br>    <span class="hljs-attribute">transition</span>: all <span class="hljs-number">0.3s</span> ease;<br>    <span class="hljs-attribute">backdrop-filter</span>: <span class="hljs-built_in">blur</span>(<span class="hljs-number">2px</span>); <span class="hljs-comment">/* æ¯›ç»ç’ƒæ•ˆæœå¢å¼ºèƒŒæ™¯èåˆ */</span><br>    <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>,<span class="hljs-number">255</span>,<span class="hljs-number">255</span>,<span class="hljs-number">0.3</span>); <span class="hljs-comment">/* æŸ”å’Œè¾¹æ¡† */</span><br>    <br>    <span class="hljs-selector-pseudo">&amp;:hover</span> &#123;<br>      <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(-<span class="hljs-number">5px</span>);<br>      <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">5px</span> <span class="hljs-number">25px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0.15</span>);<br>    &#125;<br><br>    <span class="hljs-selector-class">.category-name</span> &#123;<br>      <span class="hljs-attribute">color</span>: <span class="hljs-number">#2c3e50</span>;<br>      <span class="hljs-attribute">font-size</span>: <span class="hljs-number">1.4em</span>;<br>      <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">8px</span> <span class="hljs-number">0</span>;<br>      <span class="hljs-attribute">font-weight</span>: <span class="hljs-number">600</span>;<br>    &#125;<br><br>    <span class="hljs-selector-class">.post-count</span> &#123;<br>      <span class="hljs-attribute">color</span>: <span class="hljs-number">#7f8c8d</span>;<br>      <span class="hljs-attribute">font-size</span>: <span class="hljs-number">0.9em</span>;<br>      <span class="hljs-attribute">display</span>: block;<br>    &#125;<br>  &#125;<br>&#125;<br><br><br><span class="hljs-comment">/* è¿™éƒ¨åˆ†æ˜¯æˆ‘è‡ªå·±ç”¨çš„èƒŒæ™¯å›¾çš„è®¾ç½® */</span><br><span class="hljs-selector-tag">body</span> &#123;<br>  <span class="hljs-attribute">background-image</span>: <span class="hljs-built_in">url</span>(/images/background.jpg);<br>  <span class="hljs-attribute">background-repeat</span>: no-repeat;<br>  <span class="hljs-attribute">background-attachment</span>: fixed;<br>  <span class="hljs-attribute">background-size</span>: <span class="hljs-number">100%</span> <span class="hljs-number">100%</span>;<br>  <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0.85</span>;<br>&#125;<br><span class="hljs-comment">/* ======================== */</span><br><span class="hljs-comment">/* åˆ†ç±»å¡ç‰‡å†…çš„æ–‡ç« åˆ—è¡¨æ ·å¼ */</span><br><span class="hljs-comment">/* ======================== */</span><br><br><span class="hljs-selector-class">.category-card</span> &#123;<br>  <span class="hljs-attribute">position</span>: relative; <span class="hljs-comment">/* ä¸ºæ¯›ç»ç’ƒæ•ˆæœæä¾›å®šä½ä¸Šä¸‹æ–‡ */</span><br>  <br>  <span class="hljs-selector-class">.category-header</span> &#123;<br>    <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">15px</span>;<br>    <span class="hljs-attribute">padding-bottom</span>: <span class="hljs-number">12px</span>;<br>    <span class="hljs-attribute">border-bottom</span>: <span class="hljs-number">1px</span> solid <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0.08</span>);<br>  &#125;<br><br>  <span class="hljs-selector-class">.recent-posts-list</span> &#123;<br>    <span class="hljs-attribute">margin-top</span>: <span class="hljs-number">10px</span>;<br>    <br>    <span class="hljs-selector-class">.recent-post-item</span> &#123;<br>      <span class="hljs-attribute">display</span>: flex;<br>      <span class="hljs-attribute">justify-content</span>: space-between;<br>      <span class="hljs-attribute">align-items</span>: center;<br>      <span class="hljs-attribute">padding</span>: <span class="hljs-number">8px</span> <span class="hljs-number">0</span>;<br>      <span class="hljs-attribute">transition</span>: all <span class="hljs-number">0.2s</span> ease;<br><br>      <br>      <span class="hljs-selector-pseudo">&amp;:hover</span> &#123;<br>        <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(<span class="hljs-number">3px</span>);<br>      &#125;<br><br>      <span class="hljs-selector-class">.post-title</span> &#123;<br>        <span class="hljs-attribute">color</span>: <span class="hljs-number">#34495e</span>;<br>        <span class="hljs-attribute">font-size</span>: <span class="hljs-number">0.95em</span>;<br>        <span class="hljs-attribute">flex-grow</span>: <span class="hljs-number">1</span>;<br>        <span class="hljs-attribute">white-space</span>: nowrap;<br>        <span class="hljs-attribute">overflow</span>: hidden;<br>        <span class="hljs-attribute">text-overflow</span>: ellipsis;<br>        <span class="hljs-attribute">padding-right</span>: <span class="hljs-number">10px</span>;<br>        <br>        <span class="hljs-selector-pseudo">&amp;:hover</span> &#123;<br>          <span class="hljs-attribute">color</span>: <span class="hljs-number">#3498db</span>;<br>          <span class="hljs-attribute">text-decoration</span>: underline;<br>        &#125;<br>      &#125;<br><br>      <span class="hljs-selector-class">.post-date</span> &#123;<br>        <span class="hljs-attribute">color</span>: <span class="hljs-number">#95a5a6</span>;<br>        <span class="hljs-attribute">font-size</span>: <span class="hljs-number">0.8em</span>;<br>        <span class="hljs-attribute">font-family</span>: <span class="hljs-string">&#x27;Arial&#x27;</span>, sans-serif;<br>        <span class="hljs-attribute">flex-shrink</span>: <span class="hljs-number">0</span>;<br>      &#125;<br>    &#125;<br>  &#125;<br>  * &#123;<br>    <span class="hljs-attribute">border-bottom</span>: none <span class="hljs-meta">!important</span>;<br>    <span class="hljs-attribute">box-shadow</span>: none <span class="hljs-meta">!important</span>;<br>  &#125;<br>  <br>  <span class="hljs-selector-class">.category-header</span>, <br>  <span class="hljs-selector-class">.recent-post-item</span>, <br>  <span class="hljs-selector-class">.recent-posts-list</span> &#123;<br>    <span class="hljs-attribute">border</span>: none <span class="hljs-meta">!important</span>;<br>    <span class="hljs-attribute">border-bottom</span>: none <span class="hljs-meta">!important</span>;<br>  &#125;<br>&#125;<br><br><span class="hljs-comment">/* æ›´å¤šæ–‡ç« æŒ‰é’®æ ·å¼ */</span><br><span class="hljs-selector-class">.more-posts-wrapper</span> &#123;<br>  <span class="hljs-attribute">text-align</span>: left;<br>  <span class="hljs-attribute">margin-top</span>: <span class="hljs-number">12px</span>;<br>  <span class="hljs-attribute">padding-top</span>: <span class="hljs-number">10px</span>;<br>  <br>  <span class="hljs-selector-class">.more-posts-button</span> &#123;<br>    <span class="hljs-attribute">display</span>: inline-block;<br>    <span class="hljs-attribute">color</span>:<span class="hljs-built_in">rgb</span>(<span class="hljs-number">72</span>, <span class="hljs-number">168</span>, <span class="hljs-number">241</span>);<br>    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">0.9em</span>;<br>    <span class="hljs-attribute">padding</span>: <span class="hljs-number">6px</span> <span class="hljs-number">12px</span>;<br>    <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">4px</span>;<br>    <span class="hljs-attribute">transition</span>: all <span class="hljs-number">0.3s</span> ease;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">52</span>, <span class="hljs-number">152</span>, <span class="hljs-number">219</span>, <span class="hljs-number">0.1</span>);<br>    <br>    <span class="hljs-selector-pseudo">&amp;:hover</span> &#123;<br>      <span class="hljs-attribute">background</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">52</span>, <span class="hljs-number">152</span>, <span class="hljs-number">219</span>, <span class="hljs-number">0.2</span>);<br>      <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(<span class="hljs-number">3px</span>);<br>    &#125;<br>    <br>    <br>    <br>    <span class="hljs-selector-pseudo">&amp;:hover</span><span class="hljs-selector-pseudo">::after</span> &#123;<br>      <span class="hljs-attribute">margin-left</span>: <span class="hljs-number">8px</span>;<br>    &#125;<br>  &#125;<br>&#125;<br><span class="hljs-comment">/* å“åº”å¼è°ƒæ•´ */</span><br><span class="hljs-keyword">@media</span> (<span class="hljs-attribute">max-width</span>: <span class="hljs-number">767px</span>) &#123;<br>  <span class="hljs-selector-class">.category-card</span> &#123;<br>    <span class="hljs-attribute">padding</span>: <span class="hljs-number">18px</span>;<br>    <br>    <span class="hljs-selector-class">.recent-post-item</span> &#123;<br>      <span class="hljs-attribute">flex-direction</span>: column;<br>      <span class="hljs-attribute">align-items</span>: flex-start;<br>      <br>      <span class="hljs-selector-class">.post-date</span> &#123;<br>        <span class="hljs-attribute">margin-top</span>: <span class="hljs-number">3px</span>;<br>        <span class="hljs-attribute">align-self</span>: flex-end;<br>      &#125;<br>    &#125;<br>  &#125;<br>&#125;<br>.posts-<span class="hljs-attribute">container</span>&#123;<br>    <span class="hljs-attribute">margin</span>: <span class="hljs-number">40px</span> auto;<br>    <span class="hljs-attribute">max-width</span>: <span class="hljs-number">1200px</span>;<br>    <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span> <span class="hljs-number">20px</span>;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>æ•ˆæœè¯·è§â€œè®°ä¸€æ¬¡blogä¼˜åŒ–â€</p></li></ul><h2 id="ç‚¹å‡»æ›´å¤šæ–‡ç« åçš„æ–‡ç« åˆ—è¡¨å®ç°"><a href="#ç‚¹å‡»æ›´å¤šæ–‡ç« åçš„æ–‡ç« åˆ—è¡¨å®ç°" class="headerlink" title="ç‚¹å‡»æ›´å¤šæ–‡ç« åçš„æ–‡ç« åˆ—è¡¨å®ç°"></a>ç‚¹å‡»æ›´å¤šæ–‡ç« åçš„æ–‡ç« åˆ—è¡¨å®ç°</h2><ul><li><p>ä»ç„¶æ˜¯åŸºäºåŸæ¥çš„Index.njk</p></li><li><p>themes&#x2F;next&#x2F;layout&#x2F;category.njkï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs html">&#123;% extends &#x27;_layout.njk&#x27; %&#125;<br>&#123;% import &#x27;_macro/sidebar.njk&#x27; as sidebar_template with context %&#125;<br><br>&#123;% block title %&#125; <br>&#123;&#123; page.category &#125;&#125; | &#123;&#123; __(&#x27;title.category&#x27;) &#125;&#125; | &#123;&#123; config.title &#125;&#125;<br>&#123;% if theme.index_with_subtitle and subtitle %&#125; - &#123;&#123; subtitle &#125;&#125;&#123;% endif %&#125;<br>&#123;% endblock %&#125;<br><br>&#123;% block class %&#125;index posts-expand&#123;% endblock %&#125;<br><br>&#123;% block content %&#125;<br><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;category-title&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;text-align: center; margin: 30px 0;&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>&#123;&#123; page.category &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br>&#123;# æ–°å¢åŒ…è£¹å®¹å™¨å¹¶æ·»åŠ é—´è· class PS:è¿™ä¸€éƒ¨åˆ†æ˜¯ä¸ªäººæ„Ÿè§‰åˆ—è¡¨å¤ªè´´è¿‘ä¾§è¾¹æ äº†ï¼Œæ‰€ä»¥å’Œé¦–é¡µåˆ†ç±»å¡ç‰‡çš„ä½ç½®è®¾ç½®ä¿æŒä¸€è‡´äº†#&#125;<br>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;posts-container&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;margin-right: 30px ;&quot;</span>&gt;</span><br><br>  &#123;%- for post in page.posts.toArray() %&#125;<br>    &#123;&#123; partial(&#x27;_macro/post.njk&#x27;, &#123;post: post, is_index: true&#125;) &#125;&#125;<br>  &#123;%- endfor %&#125;<br><br>  &#123;%- include &#x27;_partials/pagination.njk&#x27; -%&#125;<br>  <br>&#123;% endblock %&#125;<br><br>&#123;% block sidebar %&#125;<br>  &#123;&#123; sidebar_template.render(false) &#125;&#125;<br>&#123;% endblock %&#125;<br></code></pre></td></tr></table></figure></li><li><p>æ•ˆæœä»è§ä¸Šä¸€ç¯‡åšå®¢</p></li></ul><h2 id="åˆ é™¤ä¾§è¾¹æ ç›®å½•ä¸‹åˆ’çº¿ä¸æ–‡æœ«æ ‡ç­¾çš„â€œ-â€"><a href="#åˆ é™¤ä¾§è¾¹æ ç›®å½•ä¸‹åˆ’çº¿ä¸æ–‡æœ«æ ‡ç­¾çš„â€œ-â€" class="headerlink" title="åˆ é™¤ä¾§è¾¹æ ç›®å½•ä¸‹åˆ’çº¿ä¸æ–‡æœ«æ ‡ç­¾çš„â€œ#â€"></a>åˆ é™¤ä¾§è¾¹æ ç›®å½•ä¸‹åˆ’çº¿ä¸æ–‡æœ«æ ‡ç­¾çš„â€œ#â€</h2><ul><li>è¿™ä¸¤ä¸ªéƒ¨åˆ†æ²¡æœ‰å˜åŠ¨ï¼Œé™¤äº†æ–‡ä»¶åçš„åç¼€æ”¹å˜äº†ï¼Œå…¶ä½™éƒ½ä¸€æ ·ã€‚è¯¦è§ä¸Šä¸€ç¯‡åšå®¢ã€‚</li></ul><h2 id="utterancesè¯„è®ºç³»ç»Ÿ"><a href="#utterancesè¯„è®ºç³»ç»Ÿ" class="headerlink" title="utterancesè¯„è®ºç³»ç»Ÿ"></a>utterancesè¯„è®ºç³»ç»Ÿ</h2><ul><li><p>æ–°ç‰ˆæœ¬NexTå·²ç»ä¸æ”¯æŒvalineäº†ï¼Œç»™çš„é€‰é¡¹åªæœ‰ï¼š</p><p><img src="/../images/image-20250605150357372.png" alt="è¯„è®ºç³»ç»Ÿé€‰é¡¹"></p></li><li><p>æ‰€ä»¥ç¬”è€…é€‰äº†utterancesã€‚è¿™ä¸ªç³»ç»Ÿå¥½åƒå’Œgithubæœ‰ç‚¹å…³ç³»</p></li><li><p>åœ¨next&#x2F;config.ymlçš„commentsé‡ŒæŠŠactiveæ”¹æˆutterances</p><p><img src="/../images/image-20250605150655597.png" alt="é€‰æ‹©utterances"></p></li><li><p>ç„¶åéœ€è¦ç»™githubä»“åº“å®‰è£…utterancesï¼Œè®¿é—®<a href="https://github.com/apps/utterances">https://github.com/apps/utterances</a> ï¼Œç„¶åç‚¹å‡»Install</p><p><img src="/../images/image-20250605185949763.png" alt="install utterances"></p></li><li><p>åœ¨è·³è½¬çš„é¡µé¢å‹¾é€‰only select repositoriesï¼Œç„¶åé€‰æ‹©åšå®¢ä»“åº“</p><p><img src="/../images/image-20250605190153428.png" alt="select repositories"></p></li><li><p>ç‚¹å‡»installå°±å¯ä»¥äº†</p></li><li><p>è¦æ³¨æ„çš„æ˜¯ï¼Œhexo sä¸‹æ˜¯è°ƒè¯•ä¸äº†è¿™ä¸ªåŠŸèƒ½çš„ï¼ˆè™½ç„¶ä¸çŸ¥é“æˆ‘ä¸ºä»€ä¹ˆè¦åœ¨hexo sä¸‹è°ƒè¯•è¿™ä¸ªåŠŸèƒ½ï¼‰ï¼Œä¼šæŠ¥é”™ï¼Œä½†æ˜¯éƒ¨ç½²åæ˜¯å¯ä»¥æ­£å¸¸å·¥ä½œçš„</p></li></ul><h2 id="firestoreç»Ÿè®¡è®¿é—®äººæ•°"><a href="#firestoreç»Ÿè®¡è®¿é—®äººæ•°" class="headerlink" title="firestoreç»Ÿè®¡è®¿é—®äººæ•°"></a>firestoreç»Ÿè®¡è®¿é—®äººæ•°</h2><ul><li><p>NexT8.23.0ä¸æ”¯æŒValineäº†ï¼Œå¾—é‡æ–°é€‰æ‹©æ•°æ®ç»Ÿè®¡ç³»ç»Ÿã€‚firestoreæ˜¯googleçš„äº§å“ï¼Œå› æ­¤éœ€è¦ç§‘å­¦ä¸Šç½‘ã€‚</p></li><li><p>å‚è€ƒå¤§ä½¬åšå®¢ï¼š<a href="https://weirenxue.github.io/2021/06/11/hexo_next_firestore_visitors/">https://weirenxue.github.io/2021/06/11/hexo_next_firestore_visitors/</a>  æ­¥éª¤å¾ˆç®€æ´å®Œæ•´äº†ï¼Œä½†æ˜¯ä¸ªäººå®ç°çš„æ—¶å€™ä¼šæœ‰ä¸€äº›é—®é¢˜ï¼Œæ¥ä¸‹æ¥è¯¦ç»†ä»‹ç»ç›¸å…³æ­¥éª¤</p></li><li><p>é¦–å…ˆï¼Œåœ¨next&#x2F;config.ymlé‡Œå¯ç”¨firestoreï¼š</p><p><img src="/../images/image-20250605192012733.png" alt="å¯ç”¨firestore"></p></li><li><p>æœ‰ä¸¤ä¸ªç©ºéœ€è¦å¡«å†™ï¼Œapikeyå’ŒprojectIdã€‚ä¸æ€¥ï¼Œéœ€è¦å…ˆæœ‰firestoreçš„é¡¹ç›®ã€‚æ¥ä¸‹æ¥è®¿é—®firebaseï¼š<a href="https://console.firebase.google.com/">https://console.firebase.google.com/</a>  ï¼ˆç§‘å­¦ä¸Šç½‘ï¼‰</p></li><li><p>ç™»å½•åç‚¹å‡»â€œåˆ›å»ºé¡¹ç›®â€</p><p><img src="/../images/image-20250605192451907.png" alt="åˆ›å»ºé¡¹ç›®"></p></li><li><p>æ¥ä¸‹æ¥æŒ‰ç…§å¼•å¯¼èµ°ä¸‹å»ï¼Œå¼€å‘è€…è®¡åˆ’ã€AIè¾…åŠ©ã€google analyticsæ ¹æ®ä¸ªäººéœ€æ±‚é€‰æ‹©ï¼Œç‚¹å‡»ç»§ç»­å¹¶ç¨ç­‰ç‰‡åˆ»å°±åˆ›å»ºæˆåŠŸäº†ã€‚</p><p><img src="/../images/image-20250605192821032.png" alt="åˆ›å»ºæˆåŠŸ"></p></li><li><p>ç‚¹å‡»æ–°é¡¹ç›®ï¼Œåœ¨å·¦ä¸Šè§’â€œé¡¹ç›®æ¦‚è¿°â€é‡Œç‚¹â€œé¡¹ç›®è®¾ç½®â€</p><p><img src="/../images/image-20250605193218565.png" alt="é¡¹ç›®è®¾ç½®"></p><p>è¿™æ—¶å€™å¯ä»¥çœ‹è§é¡¹ç›®IDç­‰ä¿¡æ¯äº†ï¼Œä½†æ˜¯apiè¿˜æ²¡æœ‰æ˜¾ç¤º</p><p><img src="/../images/image-20250605193311734.png" alt="é¡¹ç›®è®¾ç½®ä¿¡æ¯"></p></li><li><p>æ¥ä¸‹æ¥åœ¨å·¦ä¾§è¾¹æ â€œæ„å»ºâ€é‡Œæ‰¾åˆ°â€œAuthenticationâ€ï¼Œç‚¹å‡»â€œå¼€å§‹â€ï¼ˆå“‡ï¼Œè¿™ä¸ªç•Œé¢è®¾ç½®æˆ‘è¿˜ä»¥ä¸ºgoogleä¸è®©æ‰‹åŠ¨è®¾ç½®åªèƒ½ç”¨AIäº†ï¼ŒçæŒ‰äº†åŠå¤©æ‰çŸ¥é“ç‚¹â€å¼€å§‹â€ï¼‰</p><p><img src="/../images/image-20250605193844508.png" alt="Authentication"></p></li><li><p>æ¥ä¸‹æ¥é€‰æ‹©ç™»é™†æ–¹å¼ç™»å½•å³å¯ã€‚æˆ‘é€‰æ‹©è°·æ­Œï¼Œç‚¹å‡»å³ä¸Šè§’å¯ç”¨ï¼Œé¡¹ç›®å…¬å¼€åç§°é»˜è®¤å³å¯ï¼Œé¡¹ç›®æ”¯æŒé‚®ç®±é€‰æ‹©ä¸ªäººè°·æ­Œé‚®ç®±</p><p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-06-05%20194506.png" alt="ç™»å½•"></p></li><li><p>å›åˆ°é¡¹ç›®è®¾ç½®é¡µé¢ï¼Œå¯ä»¥çœ‹åˆ°apiå·²ç»å‡ºç°äº†</p><p><img src="/../images/image-20250605210227422.png" alt="apiå‡ºç°"></p></li><li><p>æ¥ä¸‹æ¥å°±å¯ä»¥æŠŠnext&#x2F;config.ymlé‡Œçš„projectIdå’ŒapiKeyå¡«ä¸Šäº†</p></li><li><p>ç„¶åæ‰“å¼€å·¦ä¾§è¾¹æ â€œæ„å»ºâ€é‡Œçš„â€œFirestore Databaseâ€ï¼Œç‚¹å‡»â€œåˆ›å»ºæ•°æ®åº“â€</p><p><img src="/../images/image-20250605210959567.png" alt="åˆ›å»ºæ•°æ®åº“"></p></li><li><p>æ¥ä¸‹æ¥çš„é¡µé¢ï¼Œè®¾ç½®ä½ç½®ï¼ˆæ•°æ®åº“IDä¼¼ä¹ä¸èƒ½æ”¹åŠ¨ï¼‰ï¼Œç„¶åä¸‹ä¸€æ­¥</p><p><img src="/../images/image-20250605211218445.png" alt="è®¾ç½®ä½ç½®"></p></li><li><p>æ¥ä¸‹æ¥é€‰æ‹©æµ‹è¯•æ¨¡å¼ï¼Œç­‰å¾…é¢„é…Cloud Firestore</p><p><img src="/../images/image-20250605211444337.png" alt="é€‰æ‹©æµ‹è¯•æ¨¡å¼"></p></li><li><p>åŠ è½½æˆåŠŸåé•¿è¿™æ ·</p><p><img src="/../images/image-20250605211643158.png" alt="databaseåˆ›å»ºæˆåŠŸå"></p></li><li><p>æ¥ä¸‹æ¥é‡æ–°éƒ¨ç½²åšå®¢åå°±å¯ä»¥æµ‹è¯•è®¡æ•°æœºåˆ¶æ˜¯å¦æ­£å¸¸äº†ã€‚ä½†æ˜¯ç¬”è€…åœ¨è¿™ä¸€æ­¥æŠ˜è…¾äº†å¾ˆä¹…ï¼Œå› ä¸ºè°ƒè¯•çš„æ—¶å€™å‘ç°ï¼š</p><p>1.æ•°æ®åº“çš„ä¿¡æ¯åœ¨ç¬¬ä¸€æ¬¡å¯ç”¨è®¡æ•°æœºåˆ¶åä¼šè‡ªåŠ¨ç”Ÿæˆï¼Œä½†æ˜¯å¯¹è¿™äº›ä¿¡æ¯è¿›è¡Œæ”¹åŠ¨åè®¡æ•°æœºåˆ¶å°±å¤±æ•ˆäº†  </p><p>2.å³ä½¿åœ¨è«åå…¶å¦™çš„æƒ…å†µä¸‹ï¼ˆå¯èƒ½æ˜¯å…³é—­firestoreé…ç½®åå†æ¬¡å¼€å¯çš„æƒ…å†µï¼‰é‡æ–°åˆå§‹åŒ–äº†æ•°æ®åº“ï¼Œè®¡æ•°1æ¬¡ä¹‹åå†æ€ä¹ˆè®¿é—®ï¼ˆå¦‚åˆ·æ–°ã€å…³é—­é¡µé¢é‡æ–°æ‰“å¼€ï¼‰ä¹Ÿä¸ä¼šè®°å½•ç¬¬2æ¬¡  </p></li><li><p>è¿˜æœ‰ä¸€äº›è°ƒè¯•è¿‡ç¨‹å‘ç°çš„é—®é¢˜ï¼Œä½†æ˜¯è°ƒè¯•è¿‡ç¨‹å¤ªä¹±äº†ä¸å¥½æè¿°ï¼Œæ‰€ä»¥ä¸‹é¢ç›´æ¥æŒ‡å‡ºé—®é¢˜å¹¶ç»™å‡ºè§£å†³æ–¹æ¡ˆ</p></li><li><p>é¦–å…ˆï¼Œfirestoreçš„è®¡æ•°æœºåˆ¶æœ‰ç‚¹ç‰¹åˆ«ï¼Œå®ƒä½¿ç”¨äº†localStorageæ¥åˆ¤æ–­æ˜¯å¦è®¿é—®è¿‡æ–‡ç« ï¼Œå¦‚æœè®¿é—®è¿‡æ–‡ç« ï¼Œå°†ä¸ä¼šå‡ºç°ç¬¬äºŒæ¬¡è®¡æ•°çš„æƒ…å†µï¼ˆæ°¸è¿œä¸ä¼šï¼Œé™¤éé‡ç½®localStorageï¼‰ã€‚è¿™ä¹Ÿè§£é‡Šäº†ä¸ºä»€ä¹ˆæ”¹åŠ¨æ•°æ®ä¿¡æ¯åè®¡æ•°æœºåˆ¶ä¼šå¤±æ•ˆï¼šå› ä¸ºæ²¡æœ‰ç¬¬äºŒæ¬¡è®¡æ•°ï¼Œæ‰€ä»¥æ•°æ®åº“ä¿¡æ¯ä¸ä¼šå†æ›´æ–°ã€‚å› æ­¤éœ€è¦å¯¹è®¡æ•°æœºåˆ¶è¿›è¡Œä¸€äº›ä¼˜åŒ–ï¼Œä¼˜åŒ–æ–¹æ¡ˆæ¥è‡ªDeepSeekï¼Œéœ€è¦æ”¹åŠ¨çš„é…ç½®ä¸ºnext&#x2F;source&#x2F;js&#x2F;third-party&#x2F;statistics&#x2F;firestore.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">/* global CONFIG, firebase */</span><br><br>firebase.<span class="hljs-title function_">initializeApp</span>(&#123;<br>  apiKey   : <span class="hljs-variable constant_">CONFIG</span>.<span class="hljs-property">firestore</span>.<span class="hljs-property">apiKey</span>,<br>  <span class="hljs-attr">projectId</span>: <span class="hljs-variable constant_">CONFIG</span>.<span class="hljs-property">firestore</span>.<span class="hljs-property">projectId</span><br>&#125;);<br><br>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">const</span> <span class="hljs-title function_">getCount</span> = (<span class="hljs-params">doc, increaseCount</span>) =&gt; &#123;<br>    <span class="hljs-comment">// IncreaseCount will be false when not in article page</span><br>    <span class="hljs-keyword">return</span> doc.<span class="hljs-title function_">get</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">d</span> =&gt;</span> &#123;<br>      <span class="hljs-comment">// Has no data, initialize count</span><br>      <span class="hljs-keyword">let</span> count = d.<span class="hljs-property">exists</span> ? d.<span class="hljs-title function_">data</span>().<span class="hljs-property">count</span> : <span class="hljs-number">0</span>;<br>      <span class="hljs-comment">// If first view this article</span><br>      <span class="hljs-keyword">if</span> (increaseCount) &#123;<br>        <span class="hljs-comment">// Increase count</span><br>        count++;<br>        doc.<span class="hljs-title function_">set</span>(&#123;<br>          count<br>        &#125;);<br>      &#125;<br>      <span class="hljs-keyword">return</span> count;<br>    &#125;);<br>  &#125;;<br><br>  <span class="hljs-keyword">const</span> db = firebase.<span class="hljs-title function_">firestore</span>();<br>  <span class="hljs-keyword">const</span> articles = db.<span class="hljs-title function_">collection</span>(<span class="hljs-variable constant_">CONFIG</span>.<span class="hljs-property">firestore</span>.<span class="hljs-property">collection</span>);<br><br>  <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;page:loaded&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable constant_">CONFIG</span>.<span class="hljs-property">page</span>.<span class="hljs-property">isPost</span>) &#123;<br>      <span class="hljs-comment">// Fix issue #118</span><br>      <span class="hljs-comment">// https://developer.mozilla.org/en-US/docs/Web/API/Node/textContent</span><br>      <span class="hljs-keyword">const</span> title = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.post-title&#x27;</span>).<span class="hljs-property">textContent</span>.<span class="hljs-title function_">trim</span>();<br>      <span class="hljs-keyword">const</span> doc = articles.<span class="hljs-title function_">doc</span>(title);<br>      <span class="hljs-keyword">let</span> increaseCount = <span class="hljs-variable constant_">CONFIG</span>.<span class="hljs-property">hostname</span> === location.<span class="hljs-property">hostname</span>;<br>      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">sessionStorage</span>.<span class="hljs-title function_">getItem</span>(title)) &#123;<br>        increaseCount = <span class="hljs-literal">false</span>;<br>      &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-comment">// Mark as visited in current session</span><br>        <span class="hljs-variable language_">sessionStorage</span>.<span class="hljs-title function_">setItem</span>(title, <span class="hljs-literal">true</span>);<br>      &#125;<br>      <span class="hljs-title function_">getCount</span>(doc, increaseCount).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">count</span> =&gt;</span> &#123;<br>        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.firestore-visitors-count&#x27;</span>).<span class="hljs-property">innerText</span> = count;<br>      &#125;).<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&#x27;Error updating count:&#x27;</span>, e));<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable constant_">CONFIG</span>.<span class="hljs-property">page</span>.<span class="hljs-property">isHome</span>) &#123;<br>      <span class="hljs-keyword">const</span> promises = [...<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">&#x27;.post-title&#x27;</span>)].<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">element</span> =&gt;</span> &#123;<br>        <span class="hljs-keyword">const</span> title = element.<span class="hljs-property">textContent</span>.<span class="hljs-title function_">trim</span>();<br>        <span class="hljs-keyword">const</span> doc = articles.<span class="hljs-title function_">doc</span>(title);<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_">getCount</span>(doc);<br>      &#125;);<br>      <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>(promises).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">counts</span> =&gt;</span> &#123;<br>        <span class="hljs-keyword">const</span> metas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">&#x27;.firestore-visitors-count&#x27;</span>);<br>        counts.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">val, idx</span>) =&gt;</span> &#123;<br>          metas[idx].<span class="hljs-property">innerText</span> = val;<br>        &#125;);<br>      &#125;).<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&#x27;Error fetching counts:&#x27;</span>, e));<br>    &#125;<br>  &#125;);<br>&#125;)();<br></code></pre></td></tr></table></figure><p>ç®€å•è§£é‡Šä¸€ä¸‹ä¼˜åŒ–çš„ä¸»è¦æ€è·¯ï¼šä½¿ç”¨sessionStorageæ›¿æ¢localStorageï¼Œè®¡æ•°æœºåˆ¶å˜ä¸ºä¼šè¯çº§ï¼Œå³æ¯æ¬¡æ‰“å¼€æ–‡ç« éƒ½ä¼šè®¡æ•°ï¼Œè€Œåˆ·æ–°ä¸ä¼šè®¡æ•°</p></li><li><p>é‚£ä¹ˆæ¥ä¸‹æ¥å°±è¦è®¾ç½®ä¸€ä¸‹æ•°æ®åº“çš„è§„åˆ™äº†ã€‚å¤§ä½¬çš„å®‰å…¨è§„åˆ™å¥½åƒæœ‰ä¸€äº›æ¼æ´ï¼Œä¸‹é¢æ˜¯DeepSeekç”Ÿæˆçš„å®‰å…¨è§„åˆ™ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs javascript">rules_version = <span class="hljs-string">&#x27;2&#x27;</span>;<br>service cloud.<span class="hljs-property">firestore</span> &#123;<br>  match /databases/&#123;database&#125;/documents &#123;<br>    <span class="hljs-comment">// é’ˆå¯¹æ–‡ç« é›†åˆçš„è§„åˆ™</span><br>    match /articles/&#123;articleId&#125; &#123;<br>      <span class="hljs-comment">// å…è®¸æ‰€æœ‰äººè¯»å–</span><br>      allow <span class="hljs-attr">read</span>: <span class="hljs-keyword">if</span> <span class="hljs-literal">true</span>;<br>      <br>      <span class="hljs-comment">// åˆ›å»ºæ–°æ–‡æ¡£æ—¶çš„è§„åˆ™</span><br>      allow <span class="hljs-attr">create</span>: <span class="hljs-keyword">if</span> request.<span class="hljs-property">resource</span>.<span class="hljs-property">data</span>.<span class="hljs-title function_">keys</span>().<span class="hljs-title function_">hasOnly</span>([<span class="hljs-string">&quot;count&quot;</span>]) <br>                   &amp;&amp; request.<span class="hljs-property">resource</span>.<span class="hljs-property">data</span>.<span class="hljs-property">count</span> == <span class="hljs-number">1</span>;<br>      <br>      <span class="hljs-comment">// æ›´æ–°æ–‡æ¡£æ—¶çš„è§„åˆ™ï¼ˆç¡®ä¿countåªèƒ½+1ï¼‰</span><br>      allow <span class="hljs-attr">update</span>: <span class="hljs-keyword">if</span> request.<span class="hljs-property">resource</span>.<span class="hljs-property">data</span>.<span class="hljs-title function_">keys</span>().<span class="hljs-title function_">hasOnly</span>([<span class="hljs-string">&quot;count&quot;</span>])<br>                   &amp;&amp; request.<span class="hljs-property">resource</span>.<span class="hljs-property">data</span>.<span class="hljs-property">count</span> == resource.<span class="hljs-property">data</span>.<span class="hljs-property">count</span> + <span class="hljs-number">1</span>;<br>    &#125;<br><br>    <span class="hljs-comment">// ç¦æ­¢å…¶ä»–æ‰€æœ‰æ“ä½œ</span><br>    match /&#123;<span class="hljs-variable language_">document</span>=**&#125; &#123;<br>      allow read, <span class="hljs-attr">write</span>: <span class="hljs-keyword">if</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ‰“å¼€â€œFirestore Databaseâ€çš„â€œè§„åˆ™â€ï¼ŒæŠŠè§„åˆ™ç²˜è´´è¿›å»ï¼Œç‚¹å‡»å‘å¸ƒå³å¯</p><p><img src="/../images/image-20250605214840666.png" alt="è®¾ç½®è§„åˆ™"></p></li></ul>]]></content>
    
    
    <summary type="html">éƒ¨ç½²Vercelå¤±è¯¯åçš„blogé‡å»ºï¼ˆåŸºäºhexo+NexT8.23.0ï¼Œé‡‡ç”¨utterancesè¯„è®ºç³»ç»Ÿå’Œfirestoreæ•°æ®è®°å½•ï¼‰</summary>
    
    
    
    <category term="æ‚è®°" scheme="https://sydzi.github.io/categories/%E6%9D%82%E8%AE%B0/"/>
    
    
    <category term="blog" scheme="https://sydzi.github.io/tags/blog/"/>
    
    <category term="æ‚è®°" scheme="https://sydzi.github.io/tags/%E6%9D%82%E8%AE%B0/"/>
    
  </entry>
  
</feed>
