<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Re:从0到1的脚本之路 - SydzI&#039;s Blog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="SydzI&#039;s Blog"><meta name="msapplication-TileImage" content="/img/Newspaper.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="SydzI&#039;s Blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="python脚本做题记录"><meta property="og:type" content="blog"><meta property="og:title" content="Re:从0到1的脚本之路"><meta property="og:url" content="https://sydzi.github.io/2025/06/02/Re-%E4%BB%8E0%E5%88%B01%E7%9A%84%E8%84%9A%E6%9C%AC%E4%B9%8B%E8%B7%AF/"><meta property="og:site_name" content="SydzI&#039;s Blog"><meta property="og:description" content="python脚本做题记录"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://sydzi.github.io/images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-04-13%20214924.png"><meta property="og:image" content="https://sydzi.github.io/images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-04-14%20214810.png"><meta property="og:image" content="https://sydzi.github.io/images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-04-15%20215658.png"><meta property="og:image" content="https://sydzi.github.io/images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-04-15%20215712.png"><meta property="og:image" content="https://sydzi.github.io/images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-04-15%20223128.png"><meta property="og:image" content="https://sydzi.github.io/images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-04-15%20223308.png"><meta property="og:image" content="https://sydzi.github.io/images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-04-15%20223321.png"><meta property="og:image" content="https://sydzi.github.io/images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-04-15%20223431.png"><meta property="og:image" content="https://sydzi.github.io/images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-04-22%20214614.png"><meta property="og:image" content="https://sydzi.github.io/images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-04-25%20214452.png"><meta property="article:published_time" content="2025-06-02T12:55:57.000Z"><meta property="article:modified_time" content="2025-10-03T11:40:49.774Z"><meta property="article:author" content="SydzI"><meta property="article:tag" content="CTF"><meta property="article:tag" content="Reverse"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://sydzi.github.io/images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-04-13%20214924.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://sydzi.github.io/2025/06/02/Re-%E4%BB%8E0%E5%88%B01%E7%9A%84%E8%84%9A%E6%9C%AC%E4%B9%8B%E8%B7%AF/"},"headline":"Re:从0到1的脚本之路","image":["https://sydzi.github.io/images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-04-13%20214924.png","https://sydzi.github.io/images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-04-14%20214810.png","https://sydzi.github.io/images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-04-15%20215658.png","https://sydzi.github.io/images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-04-15%20215712.png","https://sydzi.github.io/images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-04-15%20223128.png","https://sydzi.github.io/images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-04-15%20223308.png","https://sydzi.github.io/images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-04-15%20223321.png","https://sydzi.github.io/images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-04-15%20223431.png","https://sydzi.github.io/images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-04-22%20214614.png","https://sydzi.github.io/images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-04-25%20214452.png"],"datePublished":"2025-06-02T12:55:57.000Z","dateModified":"2025-10-03T11:40:49.774Z","author":{"@type":"Person","name":"SydzI"},"publisher":{"@type":"Organization","name":"SydzI's Blog","logo":{"@type":"ImageObject"}},"description":"python脚本做题记录"}</script><link rel="canonical" href="https://sydzi.github.io/2025/06/02/Re-%E4%BB%8E0%E5%88%B01%E7%9A%84%E8%84%9A%E6%9C%AC%E4%B9%8B%E8%B7%AF/"><link rel="icon" href="/img/Newspaper.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link data-pjax rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/styles/xcode.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link data-pjax rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><meta name="msvalidate.01" content="9FE0F2242662A1EB82C139F80B4118F0"><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=upLteeXJeF0vtcEfQngBefAoRrZBdbYGiIdhlziWygs" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'upLteeXJeF0vtcEfQngBefAoRrZBdbYGiIdhlziWygs');</script><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="SydzI's Blog" type="application/atom+xml">
</head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/">SydzI&#039;s Blog</a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">首页</a><a class="navbar-item" href="/archives">归档</a><a class="navbar-item" href="/about">关于</a></div><div class="navbar-end"><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item night" id="night-nav" title="Change Mode" href="javascript:;"><i class="fas fa-moon" id="night-icon"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-9-desktop is-9-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 level is-mobile"><div class="level-left"><span class="level-item"><i class="fas fa-calendar-alt mr-1"></i><time datetime="${date_xml(page.date)}" title="${new Date(page.date).toLocaleString()}">2025-06-02</time></span><span class="level-item"><i class="fas fa-sync-alt mr-1"></i><time datetime="${date_xml(page.updated)}" title="${new Date(page.updated).toLocaleString()}">2025-10-03</time></span><span class="level-item"><i class="far fa-folder-open mr-1"></i><a class="link-muted" href="/categories/Reverse%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">Reverse学习笔记</a></span><span class="level-item"><i class="far fa-clock mr-1"></i>22 分钟读完 (大约3301个字)</span><span class="level-item"><i class="far fa-eye mr-1"></i><span class="firestore-visitors-count">0</span></span></div></div><h1 class="title is-3 is-size-4-mobile">Re:从0到1的脚本之路</h1><div class="content"><p>python脚本做题记录</p>
<span id="more"></span>

<h2 id="SWPUCTF-2021-新生赛-fakebase"><a href="#SWPUCTF-2021-新生赛-fakebase" class="headerlink" title="[SWPUCTF 2021 新生赛]fakebase"></a>[SWPUCTF 2021 新生赛]fakebase</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#给的代码如下：</span><br>flag = <span class="hljs-string">&#x27;xxxxxxxxxxxxxxxxxxx&#x27;</span><br><br>s_box = <span class="hljs-string">&#x27;qwertyuiopasdfghjkzxcvb123456#$&#x27;</span><br>tmp = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> flag:<br>    tmp += <span class="hljs-built_in">str</span>(<span class="hljs-built_in">bin</span>(<span class="hljs-built_in">ord</span>(i)))[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">8</span>)<br>b1 = <span class="hljs-built_in">int</span>(tmp,<span class="hljs-number">2</span>)<br>s = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">while</span> b1//<span class="hljs-number">31</span> != <span class="hljs-number">0</span>:<br>    s += s_box[b1%<span class="hljs-number">31</span>]<br>    b1 = b1//<span class="hljs-number">31</span><br><br><span class="hljs-built_in">print</span>(s)<br><br><span class="hljs-comment"># s = u#k4ggia61egegzjuqz12jhfspfkay</span><br></code></pre></td></tr></table></figure>

<ul>
<li><p>代码中，把flag逐字符转化为二进制，截掉前缀，填充为8位，再拼接这些二进制数得到tmp</p>
</li>
<li><p>然后把tmp转化为十进制b1，不断除31，同时用余数做S_box索引，把索引值拼接得到S</p>
</li>
<li><p>所以，解密思路是，首先，还原b1：</p>
<ul>
<li>b1利用后得到一系列索引值，所以由索引值反推b1</li>
<li>逆序s对照s_box得出索引（为了从最后一个余数开始还原b1）并组成一个列表。因为循环终止条件是b1&#x2F;&#x2F;31&#x3D;&#x3D;0，所以最后一次除只利用了商等于0，而余数未知，于是从0-30假设被弃掉的余数，枚举各种可能。</li>
</ul>
</li>
<li><p>而如何判断哪种可能是我们需要的呢？就需要还原出flag并判断。把还原出来的b1转二进制，去掉前缀，填充到8的倍数方便截取二进制数，然后8个8个还原出字符，最后判断是不是flag就行了。</p>
</li>
<li><p>EXP：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python">buf=<span class="hljs-string">&quot;u#k4ggia61egegzjuqz12jhfspfkay&quot;</span><br>s_box = <span class="hljs-string">&#x27;qwertyuiopasdfghjkzxcvb123456#$&#x27;</span><br><br>index_list=[]<br><span class="hljs-comment">#求索引值列表</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> buf[::-<span class="hljs-number">1</span>]:<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(s_box)):<br>        <span class="hljs-keyword">if</span> i == s_box[j]:<br>           index_list.append(j)<br><span class="hljs-comment">#print(index_list)</span><br><br><span class="hljs-comment">#枚举达到终止条件时的余数</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">31</span>):<br>    <span class="hljs-comment">#开始还原b1</span><br>    b1=i<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(buf)):<br>        b1=b1*<span class="hljs-number">31</span>+index_list[j]<span class="hljs-comment">#不断加余数，乘31</span><br>    tmp=<span class="hljs-built_in">str</span>(<span class="hljs-built_in">bin</span>(b1)[<span class="hljs-number">2</span>:])<span class="hljs-comment">#加密流程是把tmp从2进制转10进制，这里就反着来，把b1从10进制转2进制，截去前缀</span><br>    tmp=tmp.zfill((<span class="hljs-built_in">len</span>(tmp)//<span class="hljs-number">8</span>+<span class="hljs-number">1</span>)*<span class="hljs-number">8</span>)<span class="hljs-comment">#加密时字符转成8位2进制数，反着来就是把8位2进制数转为字符，所以先把tmp 8位对齐方便后续截取</span><br>    flag=<span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(tmp),<span class="hljs-number">8</span>):<br>        flag+=<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(tmp[i:i+<span class="hljs-number">8</span>],<span class="hljs-number">2</span>))<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;NSSCTF&#x27;</span> <span class="hljs-keyword">in</span> flag:<br>        <span class="hljs-built_in">print</span>(flag)<br>        <br><span class="hljs-comment">#flag = &quot;NSSCTF&#123;WHAt_BASe31&#125;&quot;</span><br></code></pre></td></tr></table></figure></li>
</ul>
<h2 id="SWPUCTF-2021-新生赛-非常简单的逻辑题"><a href="#SWPUCTF-2021-新生赛-非常简单的逻辑题" class="headerlink" title="[SWPUCTF 2021 新生赛]非常简单的逻辑题"></a>[SWPUCTF 2021 新生赛]非常简单的逻辑题</h2><ul>
<li><p>题目给的代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">flag = <span class="hljs-string">&#x27;xxxxxxxxxxxxxxxxxxxxx&#x27;</span><br>s = <span class="hljs-string">&#x27;wesyvbniazxchjko1973652048@$+-&amp;*&lt;&gt;&#x27;</span><br>result = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(flag)):<br>    s1 = <span class="hljs-built_in">ord</span>(flag[i])//<span class="hljs-number">17</span><br>    s2 = <span class="hljs-built_in">ord</span>(flag[i])%<span class="hljs-number">17</span><br>    result += s[(s1+i)%<span class="hljs-number">34</span>]+s[-(s2+i+<span class="hljs-number">1</span>)%<span class="hljs-number">34</span>]<br><span class="hljs-built_in">print</span>(result)<br><span class="hljs-comment"># result = &#x27;v0b9n1nkajz@j0c4jjo3oi1h1i937b395i5y5e0e$i&#x27;</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>加密思路是：逐字符取flag，通过&#x2F;&#x2F;和%操作得到两个值s1和s2，把这两个值处理后，作为索引在s中索引出字符，拼接得到result</p>
</li>
<li><p>逆着来应该是把result错位分开，分成和s1有关的与和s2有关的，然后求出索引值，逆两个取余过程得到s1和s2，再把s1和s2运算得到flag字符</p>
</li>
<li><p>很显然，这个过程十分复杂，因为涉及取模的还原</p>
</li>
<li><p>所以考虑顺着加密的思路走，从常见的字符十进制值枚举，遇到加密后结果和result一样的就拿来拼接flag</p>
</li>
<li><p>EXP:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python">s = <span class="hljs-string">&#x27;wesyvbniazxchjko1973652048@$+-&amp;*&lt;&gt;&#x27;</span><br>result = <span class="hljs-string">&#x27;v0b9n1nkajz@j0c4jjo3oi1h1i937b395i5y5e0e$i&#x27;</span><br>tmp=<span class="hljs-string">&#x27;&#x27;</span><br>flag=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-comment">#提取出result里和s1、s2相关的字符</span><br>s1_list=[]<br>s2_list=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(result),<span class="hljs-number">2</span>):<br>    s1_list.append(result[i])<br>    s2_list.append(result[i+<span class="hljs-number">1</span>])<br><span class="hljs-comment">#开始爆破</span><br><span class="hljs-comment">#先求出加密过程两个索引值</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(s1_list)):<br>    index1=s.index(s1_list[i])<br>    index2=s.index(s2_list[i])<br>    <span class="hljs-comment">#以索引值为判断条件，在常见字符的范围内重现加密过程，加密结果和索引值一致即为flag的字符</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">33</span>,<span class="hljs-number">126</span>):<br>        s1=j//<span class="hljs-number">17</span><br>        s2=j%<span class="hljs-number">17</span><br>        <span class="hljs-keyword">if</span> (s1 + i) % <span class="hljs-number">34</span>==index1 <span class="hljs-keyword">and</span> -(s2 + i + <span class="hljs-number">1</span>) % <span class="hljs-number">34</span>==index2:<br>            flag+=<span class="hljs-built_in">chr</span>(j)<br>            <span class="hljs-keyword">break</span><br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment">#flag = &quot;NSSCTF&#123;Fake_RERE_QAQ&#125;&quot;&quot;</span><br></code></pre></td></tr></table></figure></li>
</ul>
<h2 id="SWPUCTF-2021-新生赛-re2"><a href="#SWPUCTF-2021-新生赛-re2" class="headerlink" title="[SWPUCTF 2021 新生赛]re2"></a>[SWPUCTF 2021 新生赛]re2</h2><ul>
<li><p>IDA打开，代码如下：</p>
<p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-04-13%20214924.png" alt="RE2"></p>
</li>
<li><p>简单的字符处理，先判断字符是否在范围内，然后采用不同处理方式</p>
</li>
<li><p>直接正向利用代码，省点脑子。</p>
</li>
<li><p>EXP:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python">alpha=<span class="hljs-string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890&#123;&#125;-_&#x27;</span><br>dic=&#123;&#125;<br><span class="hljs-built_in">str</span>=<span class="hljs-string">&#x27;ylqq]aycqyp&#123;&#x27;</span><br>flag=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> alpha:<br>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">ord</span>(i)&lt;=<span class="hljs-number">96</span> <span class="hljs-keyword">or</span> <span class="hljs-built_in">ord</span>(i)&gt;<span class="hljs-number">98</span>) <span class="hljs-keyword">and</span> (<span class="hljs-built_in">ord</span>(i)&lt;=<span class="hljs-number">64</span> <span class="hljs-keyword">or</span> <span class="hljs-built_in">ord</span>(i)&gt;<span class="hljs-number">66</span>):<br>        dic[<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(i)-<span class="hljs-number">2</span>)]=i<br>    <span class="hljs-keyword">else</span>:<br>        dic[<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(i)+<span class="hljs-number">24</span>)]=i<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">str</span>:<br>    flag+=dic[i]<br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment">#flag = &#x27;NSSCTF&#123;nss_caesar&#125;&#x27;</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>直接得出来的结果是{nss_c{es{r}，显然不对，猜测对应关系不唯一。打印出alpha经过处理后的结果，发现’{‘和’a’都对应’y’，所以把显然不对劲的两个’ { ‘改成’ a ‘</p>
</li>
</ul>
<h2 id="WUSTCTF-2020-level1"><a href="#WUSTCTF-2020-level1" class="headerlink" title="[WUSTCTF 2020]level1"></a>[WUSTCTF 2020]level1</h2><ul>
<li><p>附件给了ELF文件和一个txt，反汇编代码如下：</p>
<p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-04-14%20214810.png" alt="LEVEL1"></p>
</li>
<li><p>逻辑就是从flag文件里读数据，然后存到ptr里。后面是简单的可逆处理，但是要注意ptr是从下标1开始用的。给的txt应该就是处理后的结果，把它转成一个列表，第一位随便填一个数。然后逆。</p>
</li>
<li><p>EXP:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">output=[<span class="hljs-number">0</span>, <span class="hljs-number">198</span>, <span class="hljs-number">232</span>, <span class="hljs-number">816</span>, <span class="hljs-number">200</span>, <span class="hljs-number">1536</span>, <span class="hljs-number">300</span>, <span class="hljs-number">6144</span>, <span class="hljs-number">984</span>, <span class="hljs-number">51200</span>, <span class="hljs-number">570</span>, <span class="hljs-number">92160</span>, <span class="hljs-number">1200</span>, <span class="hljs-number">565248</span>, <span class="hljs-number">756</span>, <span class="hljs-number">1474560</span>, <span class="hljs-number">800</span>, <span class="hljs-number">6291456</span>, <span class="hljs-number">1782</span>, <span class="hljs-number">65536000</span>]<br>flag=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-built_in">len</span>(output)):<br>    <span class="hljs-keyword">if</span> (i&amp;<span class="hljs-number">1</span>)!=<span class="hljs-number">0</span>:<br>        flag+=<span class="hljs-built_in">chr</span>(output[i]&gt;&gt;i)<br>    <span class="hljs-keyword">else</span>:<br>        flag+=<span class="hljs-built_in">chr</span>(output[i]//i)<br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment">#flag = &#x27;NSSCTF&#123;d9-dE6-20c&#125;&#x27;（改了前缀）</span><br></code></pre></td></tr></table></figure></li>
</ul>
<h2 id="SWPUCTF-2021-新生赛-简简单单的解密"><a href="#SWPUCTF-2021-新生赛-简简单单的解密" class="headerlink" title="[SWPUCTF 2021 新生赛]简简单单的解密"></a>[SWPUCTF 2021 新生赛]简简单单的解密</h2><ul>
<li><p>给的python代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64,urllib.parse<br>key = <span class="hljs-string">&quot;HereIsFlagggg&quot;</span><br>flag = <span class="hljs-string">&quot;xxxxxxxxxxxxxxxxxxx&quot;</span><br><br>s_box = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))<br>j = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>    j = (j + s_box[i] + <span class="hljs-built_in">ord</span>(key[i % <span class="hljs-built_in">len</span>(key)])) % <span class="hljs-number">256</span><br>    s_box[i], s_box[j] = s_box[j], s_box[i]<br>res = []<br>i = j = <span class="hljs-number">0</span><br><br><span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> flag:<br>    i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>    j = (j + s_box[i]) % <span class="hljs-number">256</span><br>    s_box[i], s_box[j] = s_box[j], s_box[i]<br>    t = (s_box[i] + s_box[j]) % <span class="hljs-number">256</span><br>    k = s_box[t]<br>    res.append(<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(s) ^ k))<br>cipher = <span class="hljs-string">&quot;&quot;</span>.join(res)<br>crypt = (<span class="hljs-built_in">str</span>(base64.b64encode(cipher.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)), <span class="hljs-string">&#x27;utf-8&#x27;</span>))<br>enc = <span class="hljs-built_in">str</span>(base64.b64decode(crypt),<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>enc = urllib.parse.quote(enc)<br><span class="hljs-built_in">print</span>(enc)<br><span class="hljs-comment"># enc = %C2%A6n%C2%87Y%1Ag%3F%C2%A01.%C2%9C%C3%B7%C3%8A%02%C3%80%C2%92W%C3%8C%C3%BA</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>采用的加密算法是标准RC4，加密两遍恢复明文。最后面的调用base的两行经过调试发现相互抵消，所以整个逻辑就是先RC4加密，然后用urllib.parse.quote()方法编码，编码部分用原库自带的urllib.parse.unquote()就行了</p>
</li>
<li><p>EXP:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> urllib.parse<br>enc = <span class="hljs-string">&#x27;%C2%A6n%C2%87Y%1Ag%3F%C2%A01.%C2%9C%C3%B7%C3%8A%02%C3%80%C2%92W%C3%8C%C3%BA&#x27;</span><br>buf=urllib.parse.unquote(enc)<br>result=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> buf:<br>    result.append(i)<br><br>key = <span class="hljs-string">&quot;HereIsFlagggg&quot;</span><br>flag = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">RC4</span>(<span class="hljs-params">flag</span>):<br>    s_box = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))<br>    j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        j = (j + s_box[i] + <span class="hljs-built_in">ord</span>(key[i % <span class="hljs-built_in">len</span>(key)])) % <span class="hljs-number">256</span><br>        s_box[i], s_box[j] = s_box[j], s_box[i]<br>    res = []<br>    i = j = <span class="hljs-number">0</span><br><br>    <span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> flag:<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        j = (j + s_box[i]) % <span class="hljs-number">256</span><br>        s_box[i], s_box[j] = s_box[j], s_box[i]<br>        t = (s_box[i] + s_box[j]) % <span class="hljs-number">256</span><br>        k = s_box[t]<br>        res.append(<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(s) ^ k))<br>    cipher = <span class="hljs-string">&quot;&quot;</span>.join(res)<br>    <span class="hljs-keyword">return</span> cipher<br><br>flag+=RC4(result)<br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment"># flag = &#x27;NSSCTF&#123;REAL_EZ_RC4&#125;&#x27;</span><br></code></pre></td></tr></table></figure></li>
</ul>
<h2 id="LitCTF-2023-ez-XOR"><a href="#LitCTF-2023-ez-XOR" class="headerlink" title="[LitCTF 2023]ez_XOR"></a>[LitCTF 2023]ez_XOR</h2><ul>
<li><p>IDA打开，如图</p>
<p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-04-15%20215658.png" alt="ez_XOR"></p>
</li>
<li><p>用XOR函数对输入做处理后，与str比较。打开XOR：</p>
<p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-04-15%20215712.png" alt="function_xor"></p>
</li>
<li><p>功能就是遍历字符，异或处理，再异或一遍就可以了</p>
</li>
<li><p>EXP:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">str</span>=<span class="hljs-string">&#x27;E`&#125;J]OrQF[V8zV:hzpV&#125;fVF[t&#x27;</span><br>flag=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(<span class="hljs-built_in">str</span>)):<br>    flag+=<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(<span class="hljs-built_in">str</span>[i])^<span class="hljs-number">9</span>)<br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment"># flag = &#x27;NSSCTF&#123;XOR_1s_3asy_to_OR&#125;&#x27;(前缀做了改动)</span><br></code></pre></td></tr></table></figure></li>
</ul>
<h2 id="HUBUCTF-2022-新生赛-simple-RE"><a href="#HUBUCTF-2022-新生赛-simple-RE" class="headerlink" title="[HUBUCTF 2022 新生赛]simple_RE"></a>[HUBUCTF 2022 新生赛]simple_RE</h2><ul>
<li><p>IDA打开，如图</p>
<p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-04-15%20223128.png" alt="simpleRE"></p>
</li>
<li><p>加密函数看起来逻辑很复杂，但是点开名字很奇怪的数组，发现一个编码表，可以推测是base64编码。</p>
<p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-04-15%20223308.png" alt="加密函数"></p>
<p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-04-15%20223321.png" alt="编码表"></p>
</li>
<li><p>回过头看给的用来比较的字符串，基本可以确定是base64换表编码</p>
<p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-04-15%20223431.png" alt="预设字符串"></p>
</li>
<li><p>找到了一个可以自定义编码表的python库cusbase64，可以用config指定编码表，这样就容易多了</p>
</li>
<li><p>EXP:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> cusbase64<br>table=<span class="hljs-string">&#x27;qvEJAfHmUYjBac+u8Ph5n9Od17FrICL/X0gVtM4Qk6T2z3wNSsyoebilxWKGZpRD&#x27;</span><br>enc=<span class="hljs-string">&#x27;5Mc58bPHLiAx7J8ocJIlaVUxaJvMcoYMaoPMaOfg15c475tscHfM/8==&#x27;</span><br>b=cusbase64.CusBase64()<br>b.config(table)<br>b.decode(enc)<br><span class="hljs-comment">#flag = &#x27;NSSCTF&#123;a8d4347722800e72e34e1aba3fe914ae&#125;&#x27;</span><br></code></pre></td></tr></table></figure></li>
</ul>
<h2 id="NSSCTF-2022-Spring-Recruit-easy-C"><a href="#NSSCTF-2022-Spring-Recruit-easy-C" class="headerlink" title="[NSSCTF 2022 Spring Recruit]easy C"></a>[NSSCTF 2022 Spring Recruit]easy C</h2><ul>
<li><p>题目给的是c源文件，如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#include &lt;stdio.h&gt;</span><br><span class="hljs-comment">#include &lt;string.h&gt;</span><br><br><span class="hljs-built_in">int</span> main()&#123;<br>    char a[]=<span class="hljs-string">&quot;wwwwwww&quot;</span>;<br>    char b[]=<span class="hljs-string">&quot;d`vxbQd&quot;</span>;<br><br>    //<span class="hljs-keyword">try</span> to find out the flag<br>    printf(<span class="hljs-string">&quot;please input flag:&quot;</span>);<br>    scanf(<span class="hljs-string">&quot; %s&quot;</span>,&amp;a);<br><br>    <span class="hljs-keyword">if</span>(strlen(a)!=<span class="hljs-number">7</span>)&#123;<br>        printf(<span class="hljs-string">&quot;NoNoNo\n&quot;</span>);<br>        system(<span class="hljs-string">&quot;pause&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-built_in">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">7</span>;i++)&#123;<br>        a[i]++;<br>        a[i]=a[i]^<span class="hljs-number">2</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span>(!strcmp(a,b))&#123;<br>        printf(<span class="hljs-string">&quot;good!\n&quot;</span>);<br>        system(<span class="hljs-string">&quot;pause&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br><br>    printf(<span class="hljs-string">&quot;NoNoNo\n&quot;</span>);<br>    system(<span class="hljs-string">&quot;pause&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    //flag 记得包上 NSSCTF&#123;&#125; 再提交!!!<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>分析逻辑，把输入的flag按字符先递增，再和2异或，得到的新数组应该和b一样。逆着来就是先异或再递减。</p>
</li>
<li><p>EXP：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">str</span>=<span class="hljs-string">&#x27;d`vxbQd&#x27;</span><br>flag=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">str</span>:<br>    flag+=<span class="hljs-built_in">chr</span>((<span class="hljs-built_in">ord</span>(i)^<span class="hljs-number">2</span>)-<span class="hljs-number">1</span>)<br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment">#flag = &#x27;NSSCTF&#123;easy_Re&#125;&#x27;</span><br></code></pre></td></tr></table></figure></li>
</ul>
<h2 id="NSSCTF-2022-Spring-Recruit-easy-Python"><a href="#NSSCTF-2022-Spring-Recruit-easy-Python" class="headerlink" title="[NSSCTF 2022 Spring Recruit]easy Python"></a>[NSSCTF 2022 Spring Recruit]easy Python</h2><ul>
<li><p>题目给的py源码，如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> string<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encode</span>(<span class="hljs-params">string,string2</span>):<br>    tmp_str = <span class="hljs-built_in">str</span>()<br>    ret = <span class="hljs-built_in">str</span>()<br>    bit_string_str = string.encode()<br>    remain = <span class="hljs-built_in">len</span>( string ) % <span class="hljs-number">3</span><br>    remain_str = <span class="hljs-built_in">str</span>()<br>    <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> bit_string_str:<br>        b_char = (<span class="hljs-built_in">bin</span>(char)[<span class="hljs-number">2</span>:])<br>        b_char = <span class="hljs-string">&#x27;0&#x27;</span>*(<span class="hljs-number">8</span>-<span class="hljs-built_in">len</span>(b_char)) + b_char<br>        tmp_str += b_char<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(tmp_str)//<span class="hljs-number">6</span>):<br>        temp_nub = <span class="hljs-built_in">int</span>(tmp_str[i*<span class="hljs-number">6</span>:<span class="hljs-number">6</span>*(i+<span class="hljs-number">1</span>)],<span class="hljs-number">2</span>)<br>        ret += string2[temp_nub]<br>    <span class="hljs-keyword">if</span> remain==<span class="hljs-number">2</span>:<br>        remain_str = tmp_str[-<span class="hljs-number">4</span>:] + <span class="hljs-string">&#x27;0&#x27;</span>*<span class="hljs-number">2</span><br>        temp_nub = <span class="hljs-built_in">int</span>(remain_str,<span class="hljs-number">2</span>)<br>        ret += string2[temp_nub] + <span class="hljs-string">&quot;=&quot;</span><br>    <span class="hljs-keyword">elif</span> remain==<span class="hljs-number">1</span>:<br>        remain_str = tmp_str[-<span class="hljs-number">2</span>:] + <span class="hljs-string">&#x27;0&#x27;</span>*<span class="hljs-number">4</span><br>        temp_nub = <span class="hljs-built_in">int</span>(remain_str,<span class="hljs-number">2</span>)<br>        ret += string2[temp_nub] + <span class="hljs-string">&quot;=&quot;</span>*<span class="hljs-number">2</span><br>    <span class="hljs-keyword">return</span> ret.replace(<span class="hljs-string">&quot;=&quot;</span>,<span class="hljs-string">&quot;&quot;</span>)<br><br>res = encode(<span class="hljs-built_in">input</span>(),string.ascii_uppercase+string.ascii_lowercase+string.digits+<span class="hljs-string">&#x27;+/&#x27;</span>)<br><br><span class="hljs-keyword">if</span> res == <span class="hljs-string">&quot;TlNTQ1RGe2Jhc2U2NCEhfQ&quot;</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;good!&quot;</span>)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;bad!&quot;</span>)<br></code></pre></td></tr></table></figure>
</li>
<li><p>细细一看，encode()里面有加“&#x3D;”的操作，并且使用的string2是字母大小写+数字+’+&#x2F;‘，推测是base64，但是注意到encode()返回的时候把“&#x3D;”替换成了“”，也就是删除了“&#x3D;&#x3D;”，所以要把后面用于比较的也就是加密后的字符串加上“&#x3D;”</p>
</li>
<li><p>EXP:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pybase64<br><span class="hljs-built_in">str</span>=<span class="hljs-string">&#x27;TlNTQ1RGe2Jhc2U2NCEhfQ==&#x27;</span><br>flag=pybase64.b64decode(<span class="hljs-built_in">str</span>)<br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment">#flag = &#x27;NSSCTF&#123;base64!!&#125;&#x27;</span><br></code></pre></td></tr></table></figure></li>
</ul>
<h2 id="SWPUCTF-2021-新生赛-fakerandom"><a href="#SWPUCTF-2021-新生赛-fakerandom" class="headerlink" title="[SWPUCTF 2021 新生赛]fakerandom"></a>[SWPUCTF 2021 新生赛]fakerandom</h2><ul>
<li><p>依旧是Py源码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br>flag = <span class="hljs-string">&#x27;xxxxxxxxxxxxxxxxxxxx&#x27;</span><br>random.seed(<span class="hljs-number">1</span>)<br>l = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>    l.append(random.getrandbits(<span class="hljs-number">8</span>))<br>result=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(l)):<br>    random.seed(l[i])<br>    <span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>):<br>        result.append(<span class="hljs-built_in">ord</span>(flag[i*<span class="hljs-number">5</span>+n])^random.getrandbits(<span class="hljs-number">8</span>))<br><span class="hljs-built_in">print</span>(result)<br><span class="hljs-comment"># result = [201, 8, 198, 68, 131, 152, 186, 136, 13, 130, 190, 112, 251, 93, 212, 1, 31, 214, 116, 244]</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>逻辑就是，用生成的伪随机数来异或flag的特定位。异或可逆，已知种子，伪随机数可以确定。所以只需要在源码的基础上稍作改动，把result和flag的位置调换一下就可以了</p>
</li>
<li><p>EXP：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br>flag = <span class="hljs-string">&#x27;&#x27;</span><br>result = [<span class="hljs-number">201</span>, <span class="hljs-number">8</span>, <span class="hljs-number">198</span>, <span class="hljs-number">68</span>, <span class="hljs-number">131</span>, <span class="hljs-number">152</span>, <span class="hljs-number">186</span>, <span class="hljs-number">136</span>, <span class="hljs-number">13</span>, <span class="hljs-number">130</span>, <span class="hljs-number">190</span>, <span class="hljs-number">112</span>, <span class="hljs-number">251</span>, <span class="hljs-number">93</span>, <span class="hljs-number">212</span>, <span class="hljs-number">1</span>, <span class="hljs-number">31</span>, <span class="hljs-number">214</span>, <span class="hljs-number">116</span>, <span class="hljs-number">244</span>]<br>random.seed(<span class="hljs-number">1</span>)<br>l = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>    l.append(random.getrandbits(<span class="hljs-number">8</span>))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(l)):<br>    random.seed(l[i])<br>    <span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>):<br>        flag+=<span class="hljs-built_in">chr</span>(result[i*<span class="hljs-number">5</span>+n]^random.getrandbits(<span class="hljs-number">8</span>))<br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment">#flag = &#x27;NSSCTF&#123;FakeE_random&#125;&#x27;</span><br></code></pre></td></tr></table></figure></li>
</ul>
<h2 id="HNCTF-2022-Week1-X0r"><a href="#HNCTF-2022-Week1-X0r" class="headerlink" title="[HNCTF 2022 Week1]X0r"></a>[HNCTF 2022 Week1]X0r</h2><ul>
<li><p>IDA打开，main函数如下：</p>
<p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-04-22%20214614.png" alt="main函数"></p>
<p>可以看出，逻辑就是对输入的字符串按字符异或处理，最后与给定的arr比较</p>
</li>
<li><p>EXP：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">arr=[<span class="hljs-number">0x000003FE</span>, <span class="hljs-number">0x000003EB</span>, <span class="hljs-number">0x000003EB</span>, <span class="hljs-number">0x000003FB</span>, <span class="hljs-number">0x000003E4</span>, <span class="hljs-number">0x000003F6</span>, <span class="hljs-number">0x000003D3</span>, <span class="hljs-number">0x000003D0</span>, <span class="hljs-number">0x00000388</span>, <span class="hljs-number">0x000003CA</span>, <span class="hljs-number">0x000003EF</span>, <span class="hljs-number">0x00000389</span>, <span class="hljs-number">0x000003CB</span>, <span class="hljs-number">0x000003EF</span>, <span class="hljs-number">0x000003CB</span>, <span class="hljs-number">0x00000388</span>, <span class="hljs-number">0x000003EF</span>, <span class="hljs-number">0x000003D5</span>, <span class="hljs-number">0x000003D9</span>, <span class="hljs-number">0x000003CB</span>, <span class="hljs-number">0x000003D1</span>, <span class="hljs-number">0x000003CD</span>]<br>flag=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(arr)):<br>    flag+=<span class="hljs-built_in">chr</span>((arr[i]-<span class="hljs-number">900</span>)^<span class="hljs-number">0x34</span>)<br><span class="hljs-built_in">print</span>(flag)<br>flag = <span class="hljs-string">&#x27;NSSCTF&#123;x0r_1s_s0_easy&#125;&#x27;</span><br></code></pre></td></tr></table></figure></li>
</ul>
<h2 id="HGAME-2023-week1-easyenc"><a href="#HGAME-2023-week1-easyenc" class="headerlink" title="[HGAME 2023 week1]easyenc"></a>[HGAME 2023 week1]easyenc</h2><ul>
<li><p>IDA打开，main函数如图</p>
<p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-04-25%20214452.png" alt="main函数"></p>
</li>
<li><p>可以看到逻辑就是先遍历出输入字符串的长度（ * ( ( _BYTE *) v9 + v4 )这样的格式可以看成：v9[v4]，算是一种经验吧）然后循环对输入的字符串按字符进行运算，最后与给定的数据比较。</p>
</li>
<li><p>难点在于，给的是10个元素的数组，而输入的字符串却要求是41个字符。看来V7的格式不是很对，要把这么多位的数据进行划分才行。v7是DWORD类型，而参与运算的v9用的是BYTE类型，1DWORD&#x3D;4BYTE，要把v7的数分成4部分，这里的数据不好提取，可以直接丢给AI。当然手动复制也可以。</p>
</li>
<li><p>EXP：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python">buf=[<span class="hljs-number">0x9FDFF04</span>,<span class="hljs-number">0xB0F301</span>,<span class="hljs-number">0xADF00500</span>,<span class="hljs-number">0x5170607</span>,<span class="hljs-number">0x17FD17EB</span>,<span class="hljs-number">0x1EE01EA</span>,<span class="hljs-number">0xFA05B1EA</span>,<span class="hljs-number">0xAC170108</span>,<span class="hljs-number">0xFDEA01EC</span>,<span class="hljs-number">0x60705F0</span>]<br>flag=<span class="hljs-string">&#x27;&#x27;</span><br>buf1 = []<br><span class="hljs-keyword">for</span> num <span class="hljs-keyword">in</span> buf:<br>    bytes_data = num.to_bytes(<span class="hljs-number">4</span>, byteorder=<span class="hljs-string">&#x27;little&#x27;</span>)<br>    <span class="hljs-keyword">for</span> byte <span class="hljs-keyword">in</span> bytes_data:<br>        buf1.append(<span class="hljs-built_in">hex</span>(byte))<br><span class="hljs-comment">#print(buf1)</span><br><span class="hljs-keyword">for</span> num <span class="hljs-keyword">in</span> buf1:<br>    tmp=((<span class="hljs-built_in">int</span>(num,<span class="hljs-number">16</span>)+<span class="hljs-number">86</span>)^<span class="hljs-number">0x32</span>)&amp;<span class="hljs-number">0xff</span><br>    flag+=<span class="hljs-built_in">chr</span>(tmp)<br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment">#flag = &#x27;NSSCTF&#123;4ddit1on_is_a_rever5ible_0peration&#125;&#x27;（修改了前缀）</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>当然得多学一点，所以手搓v7，找DS问一下怎么处理数据，得到如上的方法。</p>
<ul>
<li><p>用to_bytes把v7的数转成字节形式，byteorder指定了小端序，然后hex转换成十六进制数存入新列表。至于为什么要转成十六进制数，和下面的代码有关。</p>
</li>
<li><p>然后用新列表的元素进行逆运算。因为直接使用这些元素会被判成字符，所以前面先转成十六进制数，再用int转成十进制数，这样就可以正常运算了</p>
</li>
<li><p>最后还要&amp;0xff，因为逆出来的数据有点超出ascii码范围了</p>
</li>
<li><p>还有就是，这样得出来的flag其实缺了一个“ } ”。回头看反编译的代码，那个未命名的用来输入v9的实际上不是纯粹的scanf那样的函数。里面有个FILE指针，推测是读文件的函数。所以读取的内容结尾按道理会有’\0’。但是，加上了’\0’算出来的flag也没有’ } ‘。所以，凭常识加上’ } ‘。</p>
</li>
</ul>
</li>
</ul>
</div><div class="article-licensing box"><div class="licensing-title"><p>Re:从0到1的脚本之路</p><p><a href="https://sydzi.github.io/2025/06/02/Re-从0到1的脚本之路/">https://sydzi.github.io/2025/06/02/Re-从0到1的脚本之路/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><p>SydzI</p></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2025-06-02</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2025-10-03</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/CTF/">CTF</a><a class="link-muted mr-2" rel="tag" href="/tags/Reverse/">Reverse</a></div><div class="sharethis-inline-share-buttons"></div><script src="https://platform-api.sharethis.com/js/sharethis.js#property=68b654c479868da1c7122aa1&amp;product=inline-share-buttons" defer></script><nav class="post-navigation mt-4 mb-2 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2025/06/02/%E8%AE%B0%E4%B8%80%E6%AC%A1blog%E4%BC%98%E5%8C%96/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">记一次blog优化</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2025/06/02/%E5%91%A8%E8%AE%B0/"><span class="level-item">周记</span><i class="level-item fas fa-chevron-right"></i></a></div></nav></article></div><!--!--><div class="card" id="comments"><div class="card-content"><h3 class="title is-5">评论</h3><script src="https://utteranc.es/client.js" repo="sydzi/sydzi.github.io" issue-term="pathname" theme="github-light" crossorigin="anonymous" async></script></div></div></div><div class="column column-left is-4-tablet is-3-desktop is-3-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/img/avatar.jpg" alt="SydzI"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">SydzI</p><p class="is-size-6 is-block">Action over inaction</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Nanjing, China</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives/"><p class="title">31</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories/"><p class="title">7</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags/"><p class="title">10</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/SydzI" target="_blank" rel="me noopener">关注我</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Github" href="https://github.com/SydzI"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="RSS" href="/atom.xml"><i class="fas fa-rss"></i></a></div></div></div><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="level is-mobile" href="#SWPUCTF-2021-新生赛-fakebase"><span class="level-left"><span class="level-item">1</span><span class="level-item">[SWPUCTF 2021 新生赛]fakebase</span></span></a></li><li><a class="level is-mobile" href="#SWPUCTF-2021-新生赛-非常简单的逻辑题"><span class="level-left"><span class="level-item">2</span><span class="level-item">[SWPUCTF 2021 新生赛]非常简单的逻辑题</span></span></a></li><li><a class="level is-mobile" href="#SWPUCTF-2021-新生赛-re2"><span class="level-left"><span class="level-item">3</span><span class="level-item">[SWPUCTF 2021 新生赛]re2</span></span></a></li><li><a class="level is-mobile" href="#WUSTCTF-2020-level1"><span class="level-left"><span class="level-item">4</span><span class="level-item">[WUSTCTF 2020]level1</span></span></a></li><li><a class="level is-mobile" href="#SWPUCTF-2021-新生赛-简简单单的解密"><span class="level-left"><span class="level-item">5</span><span class="level-item">[SWPUCTF 2021 新生赛]简简单单的解密</span></span></a></li><li><a class="level is-mobile" href="#LitCTF-2023-ez-XOR"><span class="level-left"><span class="level-item">6</span><span class="level-item">[LitCTF 2023]ez_XOR</span></span></a></li><li><a class="level is-mobile" href="#HUBUCTF-2022-新生赛-simple-RE"><span class="level-left"><span class="level-item">7</span><span class="level-item">[HUBUCTF 2022 新生赛]simple_RE</span></span></a></li><li><a class="level is-mobile" href="#NSSCTF-2022-Spring-Recruit-easy-C"><span class="level-left"><span class="level-item">8</span><span class="level-item">[NSSCTF 2022 Spring Recruit]easy C</span></span></a></li><li><a class="level is-mobile" href="#NSSCTF-2022-Spring-Recruit-easy-Python"><span class="level-left"><span class="level-item">9</span><span class="level-item">[NSSCTF 2022 Spring Recruit]easy Python</span></span></a></li><li><a class="level is-mobile" href="#SWPUCTF-2021-新生赛-fakerandom"><span class="level-left"><span class="level-item">10</span><span class="level-item">[SWPUCTF 2021 新生赛]fakerandom</span></span></a></li><li><a class="level is-mobile" href="#HNCTF-2022-Week1-X0r"><span class="level-left"><span class="level-item">11</span><span class="level-item">[HNCTF 2022 Week1]X0r</span></span></a></li><li><a class="level is-mobile" href="#HGAME-2023-week1-easyenc"><span class="level-left"><span class="level-item">12</span><span class="level-item">[HGAME 2023 week1]easyenc</span></span></a></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/">SydzI&#039;s Blog</a><p class="is-size-7"><span>&copy; 2025 SydzI</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="fab fa-creative-commons-nc"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script>moment.locale("zh-cn");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            },
            services: {
                firebase: {"enable":true,"collection":"articles","apiKey":"AIzaSyCL4X3DgCuPZ09mSUIYiIzwCrbKdVcf_jY","projectId":"sydzi-s-blog-counter"}
            }
        };</script><script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-app-compat.js"></script><script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-firestore-compat.js"></script><script data-pjax src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script data-pjax src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js"></script><script src="/js/pjax.js"></script><!--!--><!--!--><!--!--><script data-pjax src="/js/main.js" defer></script><script data-pjax src="/js/firebase_counter.js" defer></script><script src="/js/night.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script data-pjax src="/js/insight.js" defer></script><script data-pjax>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/wanko.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"css":false});</script></body></html>