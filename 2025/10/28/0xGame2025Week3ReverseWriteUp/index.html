<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>0xGame2025Week3WriteUp - SydzI&#039;s Blog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="SydzI&#039;s Blog"><meta name="msapplication-TileImage" content="/img/Newspaper.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="SydzI&#039;s Blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="0xGame2025 Week3 Reverse方向全解&amp;amp;详解"><meta property="og:type" content="blog"><meta property="og:title" content="0xGame2025Week3WriteUp"><meta property="og:url" content="https://sydzi.github.io/2025/10/28/0xGame2025Week3ReverseWriteUp/"><meta property="og:site_name" content="SydzI&#039;s Blog"><meta property="og:description" content="0xGame2025 Week3 Reverse方向全解&amp;amp;详解"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://sydzi.github.io/images/image-20251028215843640.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251023214651101.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251024093910480.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251023215359432.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251023083351084.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251024112642390.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251024162443124.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251024162904166.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251024165818790.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251024170022478.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251024172111827.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251024172507953.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251024175918607.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251024200050353.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251024200525655.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251024202016786.png"><meta property="og:image" content="https://sydzi.github.io/images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-10-24%20200936.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251024202256140.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251024202606398.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251024203359348.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251024203510922.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251024203610635.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251024212602045.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251024214150526.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251024214208963.png"><meta property="og:image" content="https://sydzi.github.io/images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-10-20%20215617.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251021220052848.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251021220816989.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251021220921683.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251021221202643.png"><meta property="og:image" content="https://sydzi.github.io/images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-10-21%20221235.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251021221613970.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251021221637985.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251021222114925.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251021222341398.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251021222417932.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251021222757420.png"><meta property="article:published_time" content="2025-10-28T13:44:17.000Z"><meta property="article:modified_time" content="2025-11-16T13:03:17.738Z"><meta property="article:author" content="SydzI"><meta property="article:tag" content="CTF"><meta property="article:tag" content="WriteUp"><meta property="article:tag" content="Reverse"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://sydzi.github.io/images/image-20251028215843640.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://sydzi.github.io/2025/10/28/0xGame2025Week3ReverseWriteUp/"},"headline":"0xGame2025Week3WriteUp","image":["https://sydzi.github.io/images/image-20251028215843640.png","https://sydzi.github.io/images/image-20251023214651101.png","https://sydzi.github.io/images/image-20251024093910480.png","https://sydzi.github.io/images/image-20251023215359432.png","https://sydzi.github.io/images/image-20251023083351084.png","https://sydzi.github.io/images/image-20251024112642390.png","https://sydzi.github.io/images/image-20251024162443124.png","https://sydzi.github.io/images/image-20251024162904166.png","https://sydzi.github.io/images/image-20251024165818790.png","https://sydzi.github.io/images/image-20251024170022478.png","https://sydzi.github.io/images/image-20251024172111827.png","https://sydzi.github.io/images/image-20251024172507953.png","https://sydzi.github.io/images/image-20251024175918607.png","https://sydzi.github.io/images/image-20251024200050353.png","https://sydzi.github.io/images/image-20251024200525655.png","https://sydzi.github.io/images/image-20251024202016786.png","https://sydzi.github.io/images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-10-24%20200936.png","https://sydzi.github.io/images/image-20251024202256140.png","https://sydzi.github.io/images/image-20251024202606398.png","https://sydzi.github.io/images/image-20251024203359348.png","https://sydzi.github.io/images/image-20251024203510922.png","https://sydzi.github.io/images/image-20251024203610635.png","https://sydzi.github.io/images/image-20251024212602045.png","https://sydzi.github.io/images/image-20251024214150526.png","https://sydzi.github.io/images/image-20251024214208963.png","https://sydzi.github.io/images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-10-20%20215617.png","https://sydzi.github.io/images/image-20251021220052848.png","https://sydzi.github.io/images/image-20251021220816989.png","https://sydzi.github.io/images/image-20251021220921683.png","https://sydzi.github.io/images/image-20251021221202643.png","https://sydzi.github.io/images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-10-21%20221235.png","https://sydzi.github.io/images/image-20251021221613970.png","https://sydzi.github.io/images/image-20251021221637985.png","https://sydzi.github.io/images/image-20251021222114925.png","https://sydzi.github.io/images/image-20251021222341398.png","https://sydzi.github.io/images/image-20251021222417932.png","https://sydzi.github.io/images/image-20251021222757420.png"],"datePublished":"2025-10-28T13:44:17.000Z","dateModified":"2025-11-16T13:03:17.738Z","author":{"@type":"Person","name":"SydzI"},"publisher":{"@type":"Organization","name":"SydzI's Blog","logo":{"@type":"ImageObject"}},"description":"0xGame2025 Week3 Reverse方向全解&amp;详解"}</script><link rel="canonical" href="https://sydzi.github.io/2025/10/28/0xGame2025Week3ReverseWriteUp/"><link rel="icon" href="/img/Newspaper.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link data-pjax rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/styles/xcode.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link data-pjax rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><meta name="msvalidate.01" content="9FE0F2242662A1EB82C139F80B4118F0"><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=upLteeXJeF0vtcEfQngBefAoRrZBdbYGiIdhlziWygs" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'upLteeXJeF0vtcEfQngBefAoRrZBdbYGiIdhlziWygs');</script><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="SydzI's Blog" type="application/atom+xml">
</head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/">SydzI&#039;s Blog</a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">首页</a><a class="navbar-item" href="/archives">归档</a><a class="navbar-item" href="/about">关于</a></div><div class="navbar-end"><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item night" id="night-nav" title="Change Mode" href="javascript:;"><i class="fas fa-moon" id="night-icon"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-9-desktop is-9-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 level is-mobile"><div class="level-left"><span class="level-item"><i class="fas fa-calendar-alt mr-1"></i><time datetime="${date_xml(page.date)}" title="${new Date(page.date).toLocaleString()}">2025-10-28</time></span><span class="level-item"><i class="fas fa-sync-alt mr-1"></i><time datetime="${date_xml(page.updated)}" title="${new Date(page.updated).toLocaleString()}">2025-11-16</time></span><span class="level-item"><i class="far fa-folder-open mr-1"></i><a class="link-muted" href="/categories/WriteUp-%E5%A4%8D%E7%8E%B0/">WriteUp&amp;复现</a></span><span class="level-item"><i class="far fa-clock mr-1"></i>1 小时读完 (大约9474个字)</span><span class="level-item"><i class="far fa-eye mr-1"></i><span class="firestore-visitors-count">0</span></span></div></div><h1 class="title is-3 is-size-4-mobile">0xGame2025Week3WriteUp</h1><div class="content"><p>0xGame2025 Week3 Reverse方向全解&amp;详解</p>
<span id="more"></span>

<h2 id="easyApp"><a href="#easyApp" class="headerlink" title="easyApp"></a>easyApp</h2><blockquote>
<p>考点：apk逆向、工具应用、base64编码解码、z3求解</p>
</blockquote>
<ul>
<li><p>附件程序是个apk，在模拟器中运行如图，推测按钮会触发flag检验逻辑：</p>
<p><img src="/../images/image-20251028215843640.png" alt="模拟器运行"></p>
</li>
<li><p>用JEB打开apk，找到MainActivity并右键解析后，得到JAVA代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.example.easyapp;<br><br><span class="hljs-keyword">import</span> android.content.Context;<br><span class="hljs-keyword">import</span> android.os.Bundle;<br><span class="hljs-keyword">import</span> android.util.Base64;<br><span class="hljs-keyword">import</span> android.view.View;<br><span class="hljs-keyword">import</span> android.widget.Button;<br><span class="hljs-keyword">import</span> android.widget.EditText;<br><span class="hljs-keyword">import</span> android.widget.Toast;<br><span class="hljs-keyword">import</span> androidx.activity.ComponentActivity;<br><span class="hljs-keyword">import</span> dalvik.system.DexClassLoader;<br><span class="hljs-keyword">import</span> java.io.File;<br><span class="hljs-keyword">import</span> java.io.FileOutputStream;<br><span class="hljs-keyword">import</span> java.io.InputStream;<br><span class="hljs-keyword">import</span> java.io.OutputStream;<br><span class="hljs-keyword">import</span> java.lang.reflect.Method;<br><span class="hljs-keyword">import</span> kotlin.Metadata;<br><span class="hljs-keyword">import</span> kotlin.collections.ArraysKt;<br><span class="hljs-keyword">import</span> kotlin.io.ByteStreamsKt;<br><span class="hljs-keyword">import</span> kotlin.jvm.functions.Function1;<br><span class="hljs-keyword">import</span> kotlin.jvm.internal.Intrinsics;<br><span class="hljs-keyword">import</span> kotlin.text.Charsets;<br><span class="hljs-keyword">import</span> kotlin.text.StringsKt;<br><br><span class="hljs-meta">@Metadata(d1 = &#123;&quot;\u0000\&quot;\n\u0002\u0018\u0002\n\u0002\u0018\u0002\n\u0002\b\u0002\n\u0002\u0010\u0002\n\u0000\n\u0002\u0018\u0002\n\u0000\n\u0002\u0010\u000E\n\u0002\u0010\u0012\n\u0000\b\u0007\u0018\u00002\u00020\u0001B\u0005¢\u0006\u0002\u0010\u0002J\u0012\u0010\u0003\u001A\u00020\u00042\b\u0010\u0005\u001A\u0004\u0018\u00010\u0006H\u0014J\f\u0010\u0007\u001A\u00020\b*\u00020\tH\u0002¨\u0006\n&quot;&#125;, d2 = &#123;&quot;Lcom/example/easyapp/MainActivity;&quot;, &quot;Landroidx/activity/ComponentActivity;&quot;, &quot;()V&quot;, &quot;onCreate&quot;, &quot;&quot;, &quot;savedInstanceState&quot;, &quot;Landroid/os/Bundle;&quot;, &quot;toHexString&quot;, &quot;&quot;, &quot;&quot;, &quot;app_release&quot;&#125;, k = 1, mv = &#123;1, 9, 0&#125;, xi = 0x30)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ComponentActivity</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> $stable;<br><br>    <span class="hljs-keyword">static</span> &#123;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span>  <span class="hljs-comment">// androidx.activity.ComponentActivity</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(Bundle arg3)</span> &#123;<br>        <span class="hljs-built_in">super</span>.onCreate(arg3);<br>        <span class="hljs-built_in">this</span>.setContentView(layout.activity_main);<br>        <span class="hljs-type">EditText</span> <span class="hljs-variable">v3</span> <span class="hljs-operator">=</span> (EditText)<span class="hljs-built_in">this</span>.findViewById(id.flagInput);<br>        ((Button)<span class="hljs-built_in">this</span>.findViewById(id.button)).setOnClickListener((View arg2) -&gt; MainActivity.onCreate$lambda$<span class="hljs-number">0</span>(v3, <span class="hljs-built_in">this</span>, arg2));  <span class="hljs-comment">// 这里将Click和onCreate$lambda$0绑定起来了</span><br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> onCreate$lambda$<span class="hljs-number">0</span>(EditText arg6, MainActivity arg7, View arg8) &#123;<br>        <span class="hljs-type">boolean</span> v6_4;  <span class="hljs-comment">// v8_1的返回值流向v6_4</span><br>        Intrinsics.checkNotNullParameter(arg7, <span class="hljs-string">&quot;this$0&quot;</span>);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">v6</span> <span class="hljs-operator">=</span> arg6.getText().toString();  <span class="hljs-comment">// v6存放了输入的flag</span><br>        <span class="hljs-type">File</span> <span class="hljs-variable">v8</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(arg7.getCacheDir(), <span class="hljs-string">&quot;dex.zip&quot;</span>);<br>        <span class="hljs-type">InputStream</span> <span class="hljs-variable">v0</span> <span class="hljs-operator">=</span> arg7.getAssets().open(<span class="hljs-string">&quot;dex.zip&quot;</span>);  <span class="hljs-comment">// 打开了asset/dex.zip</span><br>        Intrinsics.checkNotNullExpressionValue(v0, <span class="hljs-string">&quot;open(...)&quot;</span>);<br>        ByteStreamsKt.copyTo$<span class="hljs-keyword">default</span>(v0, ((OutputStream)<span class="hljs-keyword">new</span> <span class="hljs-title class_">FileOutputStream</span>(v8)), <span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-literal">null</span>);<br>        <span class="hljs-keyword">if</span>(v6.length() == <span class="hljs-number">42</span>) &#123;<br>            <span class="hljs-type">Method</span> <span class="hljs-variable">v8_1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DexClassLoader</span>(v8.getAbsolutePath(), arg7.getCacheDir().getAbsolutePath(), <span class="hljs-literal">null</span>, arg7.getClassLoader()).loadClass(<span class="hljs-string">&quot;com.example.easyapp.Secret&quot;</span>).getDeclaredMethod(<span class="hljs-string">&quot;check&quot;</span>, String.class);  <span class="hljs-comment">// v8指向了dex中的com.example.easyapp.Secret的check方法</span><br>            <span class="hljs-type">String</span> <span class="hljs-variable">v1</span> <span class="hljs-operator">=</span> v6.substring(<span class="hljs-number">0</span>, <span class="hljs-number">26</span>);  <span class="hljs-comment">// flag被截断，截断的部分流向v1</span><br>            Intrinsics.checkNotNullExpressionValue(v1, <span class="hljs-string">&quot;this as java.lang.String…ing(startIndex, endIndex)&quot;</span>);<br>            <span class="hljs-type">byte</span>[] v1_1 = v1.getBytes(Charsets.UTF_8);  <span class="hljs-comment">// flag截断部分流向v1_1</span><br>            Intrinsics.checkNotNullExpressionValue(((Object)v1_1), <span class="hljs-string">&quot;this as java.lang.String).getBytes(charset)&quot;</span>);<br>            <span class="hljs-type">String</span> <span class="hljs-variable">v1_2</span> <span class="hljs-operator">=</span> Base64.encodeToString(v1_1, <span class="hljs-number">0</span>);  <span class="hljs-comment">// flag截断部分被进行了base编码，流向v1_2</span><br>            Intrinsics.checkNotNullExpressionValue(v1_2, <span class="hljs-string">&quot;encodeToString(...)&quot;</span>);<br>            <span class="hljs-type">String</span> <span class="hljs-variable">v1_3</span> <span class="hljs-operator">=</span> StringsKt.trim(((CharSequence)v1_2)).toString();  <span class="hljs-comment">// 编码后的flag截断部分流向v1_3</span><br>            <span class="hljs-type">String</span> <span class="hljs-variable">v6_1</span> <span class="hljs-operator">=</span> v6.substring(<span class="hljs-number">26</span>);  <span class="hljs-comment">// flag的剩余部分流向了v6_1</span><br>            Intrinsics.checkNotNullExpressionValue(v6_1, <span class="hljs-string">&quot;this as java.lang.String).substring(startIndex)&quot;</span>);<br>            <span class="hljs-type">byte</span>[] v6_2 = v6_1.getBytes(Charsets.UTF_8);  <span class="hljs-comment">// flag的剩余部分从v6_1流向了v6_2</span><br>            Intrinsics.checkNotNullExpressionValue(((Object)v6_2), <span class="hljs-string">&quot;this as java.lang.String).getBytes(charset)&quot;</span>);<br>            <span class="hljs-keyword">if</span>(v1_3.equals(<span class="hljs-string">&quot;MHhHYW1le0RvX3kwdV9sMHYzX2FuZHIwMWQ=&quot;</span>)) &#123;  <span class="hljs-comment">// 此处为v1_3的检验逻辑</span><br>                <span class="hljs-type">Object</span> <span class="hljs-variable">v6_3</span> <span class="hljs-operator">=</span> v8_1.invoke(<span class="hljs-literal">null</span>, arg7.toHexString(v6_2));  <span class="hljs-comment">// v6_2经过toHexString处理后作为v8_1，即dex:com.example.easyapp.Secret.check的参数</span><br>                Intrinsics.checkNotNull(v6_3, <span class="hljs-string">&quot;null cannot be cast to non-null type kotlin.Boolean&quot;</span>);<br>                v6_4 = ((Boolean)v6_3).booleanValue();  <span class="hljs-comment">// v8_1的返回值流向v6_4</span><br>            &#125;<br>            <span class="hljs-keyword">else</span> &#123;<br>                v6_4 = <span class="hljs-literal">false</span>;<br>            &#125;<br><br>            <span class="hljs-keyword">if</span>(v6_4) &#123;  <span class="hljs-comment">// v6_4决定了最后的输出：Right/Oh no no</span><br>                Toast.makeText(((Context)arg7), <span class="hljs-string">&quot;Right!&quot;</span>, <span class="hljs-number">0</span>).show();<br>                <span class="hljs-keyword">return</span>;<br>            &#125;<br><br>            Toast.makeText(((Context)arg7), <span class="hljs-string">&quot;Oh no no&quot;</span>, <span class="hljs-number">0</span>).show();<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br><br>        Toast.makeText(((Context)arg7), <span class="hljs-string">&quot;Length wrong!&quot;</span>, <span class="hljs-number">0</span>).show();<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String <span class="hljs-title function_">toHexString</span><span class="hljs-params">(<span class="hljs-type">byte</span>[] arg11)</span> &#123;<br>        <span class="hljs-keyword">return</span> ArraysKt.joinToString$<span class="hljs-keyword">default</span>(arg11, <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, <span class="hljs-number">0</span>, <span class="hljs-literal">null</span>, ((Function1)MainActivity.toHexString<span class="hljs-number">.1</span>.INSTANCE), <span class="hljs-number">30</span>, <span class="hljs-literal">null</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>可以看到，flag被拆分成两部分进行检验，前26个字符经过base64编码后与”MHhHYW1le0RvX3kwdV9sMHYzX2FuZHIwMWQ&#x3D;”比对，剩下部分由dex中的com.example.easyapp.Secret.check方法检验。第一部分可以借助<a target="_blank" rel="noopener" href="https://cyberchef.org/">CyberChef</a>解密：</p>
<p><img src="/../images/image-20251023214651101.png" alt="第一部分flag"></p>
</li>
<li><p>现在来分析flag第二部分的检验。在JEB左上角工程浏览器中找到asset&#x2F;dex.zip&#x2F;dex.bin</p>
<p><img src="/../images/image-20251024093910480.png" alt="找到dex.bin"></p>
<p>Secret类解析后得到：</p>
<p><img src="/../images/image-20251023215359432.png" alt="Secret类"></p>
<p>其中check的逻辑等价为一个三元一次大数方程组，三个元从flag的第二部分截取：</p>
<p>v0 &#x3D; substring(flagPart2[0:16])<br>v3 &#x3D; substring(flagPart2[8:24])<br>v4 &#x3D; substring(flagPart2:[16:32])</p>
<p>v3 + 3 * v0 - 27454419028250566601 &#x3D; 0<br>2 * v4 - 5 * v3 + 20616666104378640363 &#x3D; 0<br>v0 + 4 * v4 - 0x1dce62be9f0fa2f6c &#x3D; 0</p>
<p>可以使用z3求解。解密脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> z3 <span class="hljs-keyword">import</span> *<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">v0 v3 v4分别存放[0:16],[8:24],[16:32]下标的字符，BigInteger将这些字符转成十六进制数，每个十六进制数4位，所以每个变量是64位</span><br><span class="hljs-string">需要关注两两变量之间有32位的重叠</span><br><span class="hljs-string">所以可以将三个64位变量分成4个32位变量来处理</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-comment"># 定义4个32位变量</span><br>u=BitVec(<span class="hljs-string">&#x27;u&#x27;</span>,<span class="hljs-number">32</span>)  <span class="hljs-comment"># v0的高32位</span><br>v=BitVec(<span class="hljs-string">&#x27;v&#x27;</span>,<span class="hljs-number">32</span>)  <span class="hljs-comment"># v0的低32位，也是v3的高32位</span><br>w=BitVec(<span class="hljs-string">&#x27;w&#x27;</span>,<span class="hljs-number">32</span>)  <span class="hljs-comment"># v3的低32位，也是v4的高32位</span><br>t=BitVec(<span class="hljs-string">&#x27;t&#x27;</span>,<span class="hljs-number">32</span>)  <span class="hljs-comment"># v4的低32位</span><br><br><span class="hljs-comment"># 通过拼接32位变量构造64位变量</span><br>v0=Concat(u,v) <span class="hljs-comment">#v0=u&lt;&lt;32|v</span><br>v3=Concat(v,w) <span class="hljs-comment">#v3=v&lt;&lt;32|w</span><br>v4=Concat(w,t) <span class="hljs-comment">#v4=w&lt;&lt;32|t</span><br><br><span class="hljs-comment">#定义常量</span><br>A=BitVecVal(<span class="hljs-number">27454419028250566601</span>,<span class="hljs-number">64</span>)<br>B=BitVecVal(-<span class="hljs-number">20616666104378640363</span>,<span class="hljs-number">64</span>)<br>C=BitVecVal(<span class="hljs-number">0x1dce62be9f0fa2f6c</span>,<span class="hljs-number">64</span>)<br><br><span class="hljs-comment">#建立约束</span><br>s=Solver()<br>s.add(v3+<span class="hljs-number">3</span>*v0==A)<br>s.add(<span class="hljs-number">2</span>*v4-<span class="hljs-number">5</span>*v3==B)<br>s.add(v0+<span class="hljs-number">4</span>*v4==C)<br><br><span class="hljs-keyword">if</span> s.check()==unsat:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;无解&quot;</span>)<br><span class="hljs-keyword">while</span> s.check()==sat:<br>    model=s.model()<br>    u_val=model[u].as_long()<br>    v_val=model[v].as_long()<br>    w_val=model[w].as_long()<br>    t_val=model[t].as_long()<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;found solution:&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;u: <span class="hljs-subst">&#123;u_val:08x&#125;</span>&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;v: <span class="hljs-subst">&#123;v_val:08x&#125;</span>&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;w: <span class="hljs-subst">&#123;w_val:08x&#125;</span>&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;t: <span class="hljs-subst">&#123;t_val:08x&#125;</span>&quot;</span>)<br><br>    <span class="hljs-comment"># 将32位变量还原成字符</span><br>    result=(u_val&lt;&lt;<span class="hljs-number">96</span>)|(v_val&lt;&lt;<span class="hljs-number">64</span>)|(w_val&lt;&lt;<span class="hljs-number">32</span>)|t_val<br><br>    hex_str=<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;result:032x&#125;</span>&quot;</span><br>    flag_bytes=<span class="hljs-built_in">bytes</span>.fromhex(hex_str)<br>    flag=flag_bytes.decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;flag: <span class="hljs-subst">&#123;flag&#125;</span>&quot;</span>)<br>	<br>    <span class="hljs-comment">#排除已有的解</span><br>    s.add(Or(u!=u_val,v!=v_val,w!=w_val,t!=t_val))<br>    <br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">found solution:</span><br><span class="hljs-string">u: 5f346e64</span><br><span class="hljs-string">v: 5f646578</span><br><span class="hljs-string">w: 5f6c6f61</span><br><span class="hljs-string">t: 6465727d</span><br><span class="hljs-string">flag: _4nd_dex_loader&#125;</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure></li>
</ul>
<blockquote>
<p>flag：0xGame{Do_y0u_l0v3_andr01d_4nd_dex_loader}</p>
</blockquote>
<h2 id="Minesweepr"><a href="#Minesweepr" class="headerlink" title="Minesweepr"></a>Minesweepr</h2><blockquote>
<p>考点：web逆向、js逆向</p>
</blockquote>
<ul>
<li><p>附件是html文件和js文件，推测是一个web逆向题。html打开是一个扫雷游戏网页。因为js主要用来处理网页交互，所以重点关注js文件的内容</p>
<p><img src="/../images/image-20251023083351084.png" alt="扫雷游戏"></p>
</li>
<li><p>网页按F12打开开发人员工具，可以在工具栏源代码模块看js脚本。搜索”flag”可以找到一个可疑的函数：</p>
<p><img src="/../images/image-20251024112642390.png" alt="js脚本与可疑函数"></p>
<p>这里函数名和变量名都不是有意义的，不好阅读，可以双击高亮来追踪数据流。</p>
<p>分析可以发现，0x55ea57被调用了很多次，追踪这个值可以到达0x183c，这个函数负责从0xca50中加载值返回，这算是一个全局的混淆手段了</p>
<p><img src="/../images/image-20251024162443124.png" alt="0x55ea57被调用了多次"></p>
<p><img src="/../images/image-20251024162904166.png" alt="0x183c函数"></p>
<p>根据0x183c的代码可以找到0xca50的字符串表0x1193d5，表中就可以索引出密钥winModal:message2：”WebIsInteresting”了，以及密文”g\x1d%(\x1e,\x15@SA\x5cFD\x0fWJn]P}^}\x0c\x12\x07_]AGYC^o\x04\x00yA-ZGT\x16U\x0e”（0x183c的索引算法有点奇怪，好像索引不到正确的位置上，没搞懂）</p>
<p>而0x172ca4的解密逻辑可以等价如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc)):<br>	flag+=enc[i]^key[i%<span class="hljs-built_in">len</span>(key)]<br></code></pre></td></tr></table></figure>

<p>因此可以得到解密脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">enc=<span class="hljs-string">&quot;g\x1d%(\x1e,\x15@SA\x5cFD\x0fWJn]P&#125;^&#125;\x0c\x12\x07_]AGYC^o\x04\x00yA-ZGT\x16U\x0e&quot;</span><br>key=<span class="hljs-string">&quot;WebIsInteresting&quot;</span><br>flag=<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc)):<br>    flag+=<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(enc[i])^<span class="hljs-built_in">ord</span>(key[i%<span class="hljs-built_in">len</span>(key)]))<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure></li>
</ul>
<blockquote>
<p>flag：0xGame{463950f9-9824-4bfb-8230-98ab02d431d0}</p>
</blockquote>
<h2 id="ezVBS"><a href="#ezVBS" class="headerlink" title="ezVBS"></a>ezVBS</h2><blockquote>
<p>考点：VBS逆向、VBS去混淆</p>
</blockquote>
<ul>
<li><p>附件程序是个VBS文件，运行显示：</p>
<p><img src="/../images/image-20251024165818790.png" alt="运行VBS"></p>
</li>
<li><p>用记事本打开VBS会发现是一堆奇怪的字符，查了一下说是加了混淆</p>
<p><img src="/../images/image-20251024170022478.png" alt="记事本打开"></p>
<p>参考<a target="_blank" rel="noopener" href="https://blog.csdn.net/Daphneohh/article/details/143783257">VBS代码混淆</a>，可以使用去混淆脚本进行去混淆，使用方法见链接：</p>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs vbscript"><span class="hljs-keyword">Option</span> <span class="hljs-keyword">Explicit</span><br> <br><span class="hljs-keyword">Function</span> Defuscator(vbs)<br>	<span class="hljs-keyword">Dim</span> t<br>	t = <span class="hljs-built_in">InStr</span>(<span class="hljs-number">1</span>, vbs, <span class="hljs-string">&quot;Execute&quot;</span>, <span class="hljs-number">1</span>)<br>	t = <span class="hljs-built_in">Mid</span>(vbs, t + <span class="hljs-built_in">Len</span>(<span class="hljs-string">&quot;Execute&quot;</span>)) <br>	t = <span class="hljs-built_in">Eval</span>(t)<br>	Defuscator = t<br><span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span><br> <br><span class="hljs-keyword">Dim</span> fso, i<br><span class="hljs-keyword">Const</span> ForReading = <span class="hljs-number">1</span><br><span class="hljs-keyword">Set</span> fso = <span class="hljs-built_in">CreateObject</span>(<span class="hljs-string">&quot;Scripting.FileSystemObject&quot;</span>)<br><span class="hljs-keyword">For</span> i = <span class="hljs-number">0</span> <span class="hljs-keyword">To</span> WScript.Arguments.Count - <span class="hljs-number">1</span> <br>	<span class="hljs-keyword">Dim</span> FileName<br>	FileName = WScript.Arguments(i)<br>	<span class="hljs-keyword">Dim</span> MyFile<br>	<span class="hljs-keyword">Set</span> MyFile = fso.OpenTextFile(FileName, ForReading)<br>	<span class="hljs-keyword">Dim</span> vbs<br>	vbs = MyFile.ReadAll	<br>	WScript.Echo Defuscator(vbs)<br>	MyFile.Close<br><span class="hljs-keyword">Next</span><br> <br><span class="hljs-keyword">Set</span> fso = <span class="hljs-literal">Nothing</span><br></code></pre></td></tr></table></figure>

<p>然后可以得到如下的代码：</p>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs vbscript">Microsoft (R) Windows Script Host Version <span class="hljs-number">5.812</span><br>版权所有(C) Microsoft Corporation。保留所有权利。<br><br>code = <span class="hljs-string">&quot;Function l(str):Dim i,j,k,r:j=Len(str):r=&quot;&quot;&quot;&quot;:For i=1 to j:k=Asc(Mid(str,i,1)):If k&gt;=33 And k&lt;=126 Then:r=r&amp;Chr(33+((k+14)Mod 94)):Else:r=r&amp;Chr(k):End If:Next:l=r:End Function:Execute l(&quot;&quot;DEC l x?AFEq@IWQt?E6C J@FC &gt;6DD286i QX i q2D6ec%23=6 l Q7Ie&#123;&amp;*d2Eh=?H&gt;5b%3BKF#JZp:A(w!s@)+z|uvr&#x27;ax^&quot;&quot;&quot;&quot;;$C6tD9`g&#125;y&lt;8_Gfc~4qQ i 7=28 l QH2+2pJ&#125;vsyhrH&#123;7&#125;5K*r?J&amp;DpyE$&gt;&#123;&amp;_HB&#125;z&gt;&#123;*u?J%g:J#|:d&amp;tp|w_52glQ i 6?4 l QQ i u@C : l ` %@ &#123;6?WDECX $E6A b i :7 : Z a kl &#123;6?WDECX %96? i 3:Eq=@4&lt; l pD4W|:5WDEC[ :[ `XX Y ade Y ade Z pD4W|:5WDEC[ : Z `[ `XX Y ade Z pD4W|:5WDEC[ : Z a[ `XX i 4` l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ec Y ecXX |@5 ec Z `[ `X i 4a l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ecXX |@5 ec Z `[ `X i 4b l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - ecX |@5 ec Z `[ `X i 4c l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt;X |@5 ec Z `[ `X i 6?4 l 6?4 U 4` U 4a U 4b U 4c i t=D6 i x7 : Z ` kl &#123;6?WDECX %96? i 3:Eq=@4&lt; l pD4W|:5WDEC[ :[ `XX Y ade Y ade Z pD4W|:5WDEC[ : Z `[ `XX Y ade i 4` l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ec Y ecXX |@5 ec Z `[ `X i 4a l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ecXX |@5 ec Z `[ `X i 4b l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - ecX |@5 ec Z `[ `X i 6?4 l 6?4 U 4` U 4a U 4b U QlQ i t=D6 i 3:Eq=@4&lt; l pD4W|:5WDEC[ :[ `XX Y ade Y ade i 4` l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ec Y ecXX |@5 ec Z `[ `X i 4a l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ecXX |@5 ec Z `[ `X i 6?4 l 6?4 U 4` U 4a U QlQ U QlQ i t?5 x7 i t?5 x7 i &#125;6IE i xu 6?4 l 7=28 %96? i |D8q@I Q*@FC 7=28 :D 4@CC64EPQ i t=D6 i |D8q@I Q*@FC 7=28 :D :?4@CC64EPQ i t?5 x7&quot;&quot;)&quot;</span><br><span class="hljs-keyword">Execute</span> code<br>code = <span class="hljs-string">&quot;Function l(str):Dim i,j,k,r:j=Len(str):r=&quot;&quot;&quot;&quot;:For i=1 to j:k=Asc(Mid(str,i,1)):If k&gt;=33 And k&lt;=126 Then:r=r&amp;Chr(33+((k+14)Mod 94)):Else:r=r&amp;Chr(k):End If:Next:l=r:End Function:Execute l(&quot;&quot;DEC l x?AFEq@IWQt?E6C J@FC 7=28i QX i q2D6ec%23=6 l QeHB)IvGyC%c~&quot;&quot;&quot;&quot;&gt;&#125;twp^h@fg&#x27;qZ`=+#s4EdAFa2(_5Du&#123;Jr$86;z79&amp;:x|*!&lt;Kb?3Q i 7=28 l Q^^H5q&#x27;Z2CGvJ+(fdZyaE#:vz=(faCy28#^H$=xwE#GKE+_f$CvZB@zHa`&#x27;%2qxpJs^6Esgb&amp;+AHF=:&amp;6#&#x27;p2+AHD+zHJ`gr2=yaE#GKEq(@Eq&#x27;p9qg&gt;&#123;ZgwEq(fFq&#x27;f7Z^H8ZAH9`G27~BHu#&#x27;&gt;9CGv7Cy28#&#x27;CEZ(;dZzH5q&#x27;&quot;&quot;&quot;&quot;Eq(f2=AH8#(fz#x%D#yp2=EllQ i 6?4 l QQ i u@C : l ` %@ &#123;6?WDECX $E6A b i :7 : Z a kl &#123;6?WDECX %96? i 3:Eq=@4&lt; l pD4W|:5WDEC[ :[ `XX Y ade Y ade Z pD4W|:5WDEC[ : Z `[ `XX Y ade Z pD4W|:5WDEC[ : Z a[ `XX i 4` l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ec Y ecXX |@5 ec Z `[ `X i 4a l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ecXX |@5 ec Z `[ `X i 4b l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - ecX |@5 ec Z `[ `X i 4c l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt;X |@5 ec Z `[ `X i 6?4 l 6?4 U 4` U 4a U 4b U 4c i t=D6 i x7 : Z ` kl &#123;6?WDECX %96? i 3:Eq=@4&lt; l pD4W|:5WDEC[ :[ `XX Y ade Y ade Z pD4W|:5WDEC[ : Z `[ `XX Y ade i 4` l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ec Y ecXX |@5 ec Z `[ `X i 4a l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ecXX |@5 ec Z `[ `X i 4b l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - ecX |@5 ec Z `[ `X i 6?4 l 6?4 U 4` U 4a U 4b U QlQ i t=D6 i 3:Eq=@4&lt; l pD4W|:5WDEC[ :[ `XX Y ade Y ade i 4` l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ec Y ecXX |@5 ec Z `[ `X i 4a l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ecXX |@5 ec Z `[ `X i 6?4 l 6?4 U 4` U 4a U QlQ U QlQ i t?5 x7 i t?5 x7 i &#125;6IE i xu 6?4 l 7=28 %96? i |D8q@I DEC i t=D6 i |D8q@I Q*@FC 7=28 :D :?4@CC64EPQ i |D8q@I 6?4 i t?5 x7&quot;&quot;)&quot;</span><br><span class="hljs-keyword">Set</span> objFSO = <span class="hljs-built_in">CreateObject</span>(<span class="hljs-string">&quot;Scripting.FileSystemObject&quot;</span>)<br>strScriptPath = WScript.ScriptFullName<br>strTextToWrite = code<br>objFSO.OpenTextFile(strScriptPath, <span class="hljs-number">2</span>, <span class="hljs-literal">True</span>).WriteLine(strTextToWrite)<br></code></pre></td></tr></table></figure>

<p>可以看到code中有一些可读明文，后面又是一大串奇怪的字符。推测还有一层混淆，可读明文即为解密函数。让AI给出解密脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">l</span>(<span class="hljs-params">encrypted_str</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;VBScript l 函数的 Python 实现&quot;&quot;&quot;</span><br>    result = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(encrypted_str)):<br>        k = <span class="hljs-built_in">ord</span>(encrypted_str[i])<br>        <span class="hljs-keyword">if</span> <span class="hljs-number">33</span> &lt;= k &lt;= <span class="hljs-number">126</span>:<br>            <span class="hljs-comment"># 与 VBScript 相同的算法</span><br>            result += <span class="hljs-built_in">chr</span>(<span class="hljs-number">33</span> + ((k + <span class="hljs-number">14</span>) % <span class="hljs-number">94</span>))<br>        <span class="hljs-keyword">else</span>:<br>            result += <span class="hljs-built_in">chr</span>(k)<br>    <span class="hljs-keyword">return</span> result<br><br><br><span class="hljs-comment"># 你的加密字符串</span><br>encrypted_strings = [<br>    <span class="hljs-string">&quot;DEC l x?AFEq@IWQt?E6C J@FC &gt;6DD286i QX i q2D6ec%23=6 l Q7Ie&#123;&amp;*d2Eh=?H&gt;5b%3BKF#JZp:A(w!s@)+z|uvr&#x27;ax^\&quot;\&quot;\&quot;\&quot;;$C6tD9`g&#125;y&lt;8_Gfc~4qQ i 7=28 l QH2+2pJ&#125;vsyhrH&#123;7&#125;5K*r?J&amp;DpyE$&gt;&#123;&amp;_HB&#125;z&gt;&#123;*u?J%g:J#|:d&amp;tp|w_52glQ i 6?4 l QQ i u@C : l ` %@ &#123;6?WDECX $E6A b i :7 : Z a kl &#123;6?WDECX %96? i 3:Eq=@4&lt; l pD4W|:5WDEC[ :[ `XX Y ade Y ade Z pD4W|:5WDEC[ : Z `[ `XX Y ade Z pD4W|:5WDEC[ : Z a[ `XX i 4` l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ec Y ecXX |@5 ec Z `[ `X i 4a l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ecXX |@5 ec Z `[ `X i 4b l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - ecX |@5 ec Z `[ `X i 4c l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt;X |@5 ec Z `[ `X i 6?4 l 6?4 U 4` U 4a U 4b U 4c i t=D6 i x7 : Z ` kl &#123;6?WDECX %96? i 3:Eq=@4&lt; l pD4W|:5WDEC[ :[ `XX Y ade Y ade Z pD4W|:5WDEC[ : Z `[ `XX Y ade i 4` l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ec Y ecXX |@5 ec Z `[ `X i 4a l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ecXX |@5 ec Z `[ `X i 4b l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - ecX |@5 ec Z `[ `X i 6?4 l 6?4 U 4` U 4a U 4b U QlQ i t=D6 i 3:Eq=@4&lt; l pD4W|:5WDEC[ :[ `XX Y ade Y ade i 4` l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ec Y ecXX |@5 ec Z `[ `X i 4a l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ecXX |@5 ec Z `[ `X i 6?4 l 6?4 U 4` U 4a U QlQ U QlQ i t?5 x7 i t?5 x7 i &#125;6IE i xu 6?4 l 7=28 %96? i |D8q@I Q*@FC 7=28 :D 4@CC64EPQ i t=D6 i |D8q@I Q*@FC 7=28 :D :?4@CC64EPQ i t?5 x7&quot;</span>,<br><br>    <span class="hljs-string">&quot;DEC l x?AFEq@IWQt?E6C J@FC 7=28i QX i q2D6ec%23=6 l QeHB)IvGyC%c~\&quot;\&quot;\&quot;\&quot;&gt;&#125;twp^h@fg&#x27;qZ`=+#s4EdAFa2(_5Du&#123;Jr$86;z79&amp;:x|*!&lt;Kb?3Q i 7=28 l Q^^H5q&#x27;Z2CGvJ+(fdZyaE#:vz=(faCy28#^H$=xwE#GKE+_f$CvZB@zHa`&#x27;%2qxpJs^6Esgb&amp;+AHF=:&amp;6#&#x27;p2+AHD+zHJ`gr2=yaE#GKEq(@Eq&#x27;p9qg&gt;&#123;ZgwEq(fFq&#x27;f7Z^H8ZAH9`G27~BHu#&#x27;&gt;9CGv7Cy28#&#x27;CEZ(;dZzH5q&#x27;\&quot;\&quot;\&quot;\&quot;Eq(f2=AH8#(fz#x%D#yp2=EllQ i 6?4 l QQ i u@C : l ` %@ &#123;6?WDECX $E6A b i :7 : Z a kl &#123;6?WDECX %96? i 3:Eq=@4&lt; l pD4W|:5WDEC[ :[ `XX Y ade Y ade Z pD4W|:5WDEC[ : Z `[ `XX Y ade Z pD4W|:5WDEC[ : Z a[ `XX i 4` l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ec Y ecXX |@5 ec Z `[ `X i 4a l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ecXX |@5 ec Z `[ `X i 4b l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - ecX |@5 ec Z `[ `X i 4c l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt;X |@5 ec Z `[ `X i 6?4 l 6?4 U 4` U 4a U 4b U 4c i t=D6 i x7 : Z ` kl &#123;6?WDECX %96? i 3:Eq=@4&lt; l pD4W|:5WDEC[ :[ `XX Y ade Y ade Z pD4W|:5WDEC[ : Z `[ `XX Y ade i 4` l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ec Y ecXX |@5 ec Z `[ `X i 4a l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ecXX |@5 ec Z `[ `X i 4b l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - ecX |@5 ec Z `[ `X i 6?4 l 6?4 U 4` U 4a U 4b U QlQ i t=D6 i 3:Eq=@4&lt; l pD4W|:5WDEC[ :[ `XX Y ade Y ade i 4` l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ec Y ecXX |@5 ec Z `[ `X i 4a l |:5Wq2D6ec%23=6[ x?EW3:Eq=@4&lt; - Wec Y ecXX |@5 ec Z `[ `X i 6?4 l 6?4 U 4` U 4a U QlQ U QlQ i t?5 x7 i t?5 x7 i &#125;6IE i xu 6?4 l 7=28 %96? i |D8q@I DEC i t=D6 i |D8q@I Q*@FC 7=28 :D :?4@CC64EPQ i |D8q@I 6?4 i t?5 x7&quot;</span><br>]<br><br><span class="hljs-comment"># 解密并显示结果</span><br><span class="hljs-keyword">for</span> i, encrypted <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(encrypted_strings, <span class="hljs-number">1</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;解密第 <span class="hljs-subst">&#123;i&#125;</span> 个字符串:&quot;</span>)<br>    decrypted = l(encrypted)<br>    <span class="hljs-built_in">print</span>(decrypted)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n&quot;</span> + <span class="hljs-string">&quot;=&quot;</span> * <span class="hljs-number">80</span> + <span class="hljs-string">&quot;\n&quot;</span>)<br></code></pre></td></tr></table></figure>

<p>输出：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">解密第 <span class="hljs-number">1</span> 个字符串:<br><span class="hljs-built_in">str</span> = InputBox(<span class="hljs-string">&quot;Enter your message: &quot;</span>) : Base64Table = <span class="hljs-string">&quot;fx6LUY5at9lnwmd3TbqzuRy+AipWHPDoXZKMFGCV2I/QQQQjSreEsh18NJkg0v74OcB&quot;</span> : flag = <span class="hljs-string">&quot;waZaAyNGDJ9CwLfNdzYCnyUsAJtSmLU0wqNKmLYFnyT8iyRMi5UEAMH0da8=&quot;</span> : enc = <span class="hljs-string">&quot;&quot;</span> : For i = <span class="hljs-number">1</span> To Len(<span class="hljs-built_in">str</span>) Step <span class="hljs-number">3</span> : <span class="hljs-keyword">if</span> i + <span class="hljs-number">2</span> &lt;= Len(<span class="hljs-built_in">str</span>) Then : bitBlock = Asc(Mid(<span class="hljs-built_in">str</span>, i, <span class="hljs-number">1</span>)) * <span class="hljs-number">256</span> * <span class="hljs-number">256</span> + Asc(Mid(<span class="hljs-built_in">str</span>, i + <span class="hljs-number">1</span>, <span class="hljs-number">1</span>)) * <span class="hljs-number">256</span> + Asc(Mid(<span class="hljs-built_in">str</span>, i + <span class="hljs-number">2</span>, <span class="hljs-number">1</span>)) : c1 = Mid(Base64Table, Int(bitBlock \ (<span class="hljs-number">64</span> * <span class="hljs-number">64</span> * <span class="hljs-number">64</span>)) Mod <span class="hljs-number">64</span> + <span class="hljs-number">1</span>, <span class="hljs-number">1</span>) : c2 = Mid(Base64Table, Int(bitBlock \ (<span class="hljs-number">64</span> * <span class="hljs-number">64</span>)) Mod <span class="hljs-number">64</span> + <span class="hljs-number">1</span>, <span class="hljs-number">1</span>) : c3 = Mid(Base64Table, Int(bitBlock \ <span class="hljs-number">64</span>) Mod <span class="hljs-number">64</span> + <span class="hljs-number">1</span>, <span class="hljs-number">1</span>) : c4 = Mid(Base64Table, Int(bitBlock) Mod <span class="hljs-number">64</span> + <span class="hljs-number">1</span>, <span class="hljs-number">1</span>) : enc = enc &amp; c1 &amp; c2 &amp; c3 &amp; c4 : Else : If i + <span class="hljs-number">1</span> &lt;= Len(<span class="hljs-built_in">str</span>) Then : bitBlock = Asc(Mid(<span class="hljs-built_in">str</span>, i, <span class="hljs-number">1</span>)) * <span class="hljs-number">256</span> * <span class="hljs-number">256</span> + Asc(Mid(<span class="hljs-built_in">str</span>, i + <span class="hljs-number">1</span>, <span class="hljs-number">1</span>)) * <span class="hljs-number">256</span> : c1 = Mid(Base64Table, Int(bitBlock \ (<span class="hljs-number">64</span> * <span class="hljs-number">64</span> * <span class="hljs-number">64</span>)) Mod <span class="hljs-number">64</span> + <span class="hljs-number">1</span>, <span class="hljs-number">1</span>) : c2 = Mid(Base64Table, Int(bitBlock \ (<span class="hljs-number">64</span> * <span class="hljs-number">64</span>)) Mod <span class="hljs-number">64</span> + <span class="hljs-number">1</span>, <span class="hljs-number">1</span>) : c3 = Mid(Base64Table, Int(bitBlock \ <span class="hljs-number">64</span>) Mod <span class="hljs-number">64</span> + <span class="hljs-number">1</span>, <span class="hljs-number">1</span>) : enc = enc &amp; c1 &amp; c2 &amp; c3 &amp; <span class="hljs-string">&quot;=&quot;</span> : Else : bitBlock = Asc(Mid(<span class="hljs-built_in">str</span>, i, <span class="hljs-number">1</span>)) * <span class="hljs-number">256</span> * <span class="hljs-number">256</span> : c1 = Mid(Base64Table, Int(bitBlock \ (<span class="hljs-number">64</span> * <span class="hljs-number">64</span> * <span class="hljs-number">64</span>)) Mod <span class="hljs-number">64</span> + <span class="hljs-number">1</span>, <span class="hljs-number">1</span>) : c2 = Mid(Base64Table, Int(bitBlock \ (<span class="hljs-number">64</span> * <span class="hljs-number">64</span>)) Mod <span class="hljs-number">64</span> + <span class="hljs-number">1</span>, <span class="hljs-number">1</span>) : enc = enc &amp; c1 &amp; c2 &amp; <span class="hljs-string">&quot;=&quot;</span> &amp; <span class="hljs-string">&quot;=&quot;</span> : End If : End If : Next : IF enc = flag Then : MsgBox <span class="hljs-string">&quot;Your flag is correct!&quot;</span> : Else : MsgBox <span class="hljs-string">&quot;Your flag is incorrect!&quot;</span> : End If<br><br>================================================================================<br><br>解密第 <span class="hljs-number">2</span> 个字符串:<br><span class="hljs-built_in">str</span> = InputBox(<span class="hljs-string">&quot;Enter your flag: &quot;</span>) : Base64Table = <span class="hljs-string">&quot;6wqXxGvJrT4OQQQQmNEHA/9o78VB+1lZRDct5pu2aW0dsFLyCSgejKfhUiIMYPkz3nb&quot;</span> : flag = <span class="hljs-string">&quot;//wdBV+arvGyZW75+J2tRiGKlW72rJagR/wSlIHtRvztZ07SrG+qoKw21VTaBIAyD/etD83UZpwuliUeRVAaZpwsZKwy18CalJ2tRvztBWotBVAhB8mL+8HtBW7uBV7f+/wg+pwh1vafOqwFRVmhrvGfrJagRVrt+Wj5+KwdBVQQQQtBW7alpwgRW7KRITsRJAalt==&quot;</span> : enc = <span class="hljs-string">&quot;&quot;</span> : For i = <span class="hljs-number">1</span> To Len(<span class="hljs-built_in">str</span>) Step <span class="hljs-number">3</span> : <span class="hljs-keyword">if</span> i + <span class="hljs-number">2</span> &lt;= Len(<span class="hljs-built_in">str</span>) Then : bitBlock = Asc(Mid(<span class="hljs-built_in">str</span>, i, <span class="hljs-number">1</span>)) * <span class="hljs-number">256</span> * <span class="hljs-number">256</span> + Asc(Mid(<span class="hljs-built_in">str</span>, i + <span class="hljs-number">1</span>, <span class="hljs-number">1</span>)) * <span class="hljs-number">256</span> + Asc(Mid(<span class="hljs-built_in">str</span>, i + <span class="hljs-number">2</span>, <span class="hljs-number">1</span>)) : c1 = Mid(Base64Table, Int(bitBlock \ (<span class="hljs-number">64</span> * <span class="hljs-number">64</span> * <span class="hljs-number">64</span>)) Mod <span class="hljs-number">64</span> + <span class="hljs-number">1</span>, <span class="hljs-number">1</span>) : c2 = Mid(Base64Table, Int(bitBlock \ (<span class="hljs-number">64</span> * <span class="hljs-number">64</span>)) Mod <span class="hljs-number">64</span> + <span class="hljs-number">1</span>, <span class="hljs-number">1</span>) : c3 = Mid(Base64Table, Int(bitBlock \ <span class="hljs-number">64</span>) Mod <span class="hljs-number">64</span> + <span class="hljs-number">1</span>, <span class="hljs-number">1</span>) : c4 = Mid(Base64Table, Int(bitBlock) Mod <span class="hljs-number">64</span> + <span class="hljs-number">1</span>, <span class="hljs-number">1</span>) : enc = enc &amp; c1 &amp; c2 &amp; c3 &amp; c4 : Else : If i + <span class="hljs-number">1</span> &lt;= Len(<span class="hljs-built_in">str</span>) Then : bitBlock = Asc(Mid(<span class="hljs-built_in">str</span>, i, <span class="hljs-number">1</span>)) * <span class="hljs-number">256</span> * <span class="hljs-number">256</span> + Asc(Mid(<span class="hljs-built_in">str</span>, i + <span class="hljs-number">1</span>, <span class="hljs-number">1</span>)) * <span class="hljs-number">256</span> : c1 = Mid(Base64Table, Int(bitBlock \ (<span class="hljs-number">64</span> * <span class="hljs-number">64</span> * <span class="hljs-number">64</span>)) Mod <span class="hljs-number">64</span> + <span class="hljs-number">1</span>, <span class="hljs-number">1</span>) : c2 = Mid(Base64Table, Int(bitBlock \ (<span class="hljs-number">64</span> * <span class="hljs-number">64</span>)) Mod <span class="hljs-number">64</span> + <span class="hljs-number">1</span>, <span class="hljs-number">1</span>) : c3 = Mid(Base64Table, Int(bitBlock \ <span class="hljs-number">64</span>) Mod <span class="hljs-number">64</span> + <span class="hljs-number">1</span>, <span class="hljs-number">1</span>) : enc = enc &amp; c1 &amp; c2 &amp; c3 &amp; <span class="hljs-string">&quot;=&quot;</span> : Else : bitBlock = Asc(Mid(<span class="hljs-built_in">str</span>, i, <span class="hljs-number">1</span>)) * <span class="hljs-number">256</span> * <span class="hljs-number">256</span> : c1 = Mid(Base64Table, Int(bitBlock \ (<span class="hljs-number">64</span> * <span class="hljs-number">64</span> * <span class="hljs-number">64</span>)) Mod <span class="hljs-number">64</span> + <span class="hljs-number">1</span>, <span class="hljs-number">1</span>) : c2 = Mid(Base64Table, Int(bitBlock \ (<span class="hljs-number">64</span> * <span class="hljs-number">64</span>)) Mod <span class="hljs-number">64</span> + <span class="hljs-number">1</span>, <span class="hljs-number">1</span>) : enc = enc &amp; c1 &amp; c2 &amp; <span class="hljs-string">&quot;=&quot;</span> &amp; <span class="hljs-string">&quot;=&quot;</span> : End If : End If : Next : IF enc = flag Then : MsgBox <span class="hljs-built_in">str</span> : Else : MsgBox <span class="hljs-string">&quot;Your flag is incorrect!&quot;</span> : MsgBox enc : End If<br><br>================================================================================<br></code></pre></td></tr></table></figure>

<p>解密出来是两段代码。但是代码给的base表不是很对，第2段代码中删除base表中间连续QQQQ的几个可以解密出一些类似提示的东西</p>
<p><img src="/../images/image-20251024172111827.png" alt="类似提示的东西"></p>
<p>第1段代码的编码表进行同样的修改就得到了flag：</p>
<p><img src="/../images/image-20251024172507953.png" alt="得到flag"></p>
</li>
</ul>
<blockquote>
<p>flag：0xGame{bf00591f-a1cb-4191-b41d-d4eecda0b798}</p>
</blockquote>
<h2 id="World’s-end-BlackBox"><a href="#World’s-end-BlackBox" class="headerlink" title="World’s_end_BlackBox"></a>World’s_end_BlackBox</h2><blockquote>
<p>考点：动态调试、魔改RC4算法</p>
</blockquote>
<ul>
<li><p>附件程序运行如图：</p>
<p><img src="/../images/image-20251024175918607.png" alt="附件程序运行"></p>
</li>
<li><p>用IDA打开，main函数由于类的影响不好分析，先进行简单的变量名优化：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br></pre></td><td class="code"><pre><code class="hljs C"><span class="hljs-type">int</span> __fastcall <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **argv, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **envp)</span><br>&#123;<br>  __int64 v3; <span class="hljs-comment">// rax</span><br>  __int64 v4; <span class="hljs-comment">// rax</span><br>  __int64 v5; <span class="hljs-comment">// rax</span><br>  __int64 v6; <span class="hljs-comment">// rax</span><br>  __int64 v7; <span class="hljs-comment">// rax</span><br>  __int64 v8; <span class="hljs-comment">// rax</span><br>  __int64 v9; <span class="hljs-comment">// rax</span><br>  __int64 v10; <span class="hljs-comment">// rax</span><br>  __int64 v11; <span class="hljs-comment">// rax</span><br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::iterator __for_end; <span class="hljs-comment">// [rsp+20h] [rbp-60h] BYREF</span><br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::iterator __for_begin; <span class="hljs-comment">// [rsp+28h] [rbp-58h] BYREF</span><br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt; EndFlag; <span class="hljs-comment">// [rsp+30h] [rbp-50h] BYREF</span><br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> encrypted_message; <span class="hljs-comment">// [rsp+50h] [rbp-30h] BYREF</span><br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> key; <span class="hljs-comment">// [rsp+70h] [rbp-10h] BYREF</span><br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> flag; <span class="hljs-comment">// [rsp+90h] [rbp+10h] BYREF</span><br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> v19; <span class="hljs-comment">// [rsp+B0h] [rbp+30h] BYREF</span><br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt;::value_type __x; <span class="hljs-comment">// [rsp+D0h] [rbp+50h] BYREF</span><br>  <span class="hljs-type">char</span> c; <span class="hljs-comment">// [rsp+D7h] [rbp+57h]</span><br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> *__for_range; <span class="hljs-comment">// [rsp+D8h] [rbp+58h]</span><br><br>  _main(argc, argv, envp);<br>  SetConsoleOutputCP(<span class="hljs-number">0xFDE9u</span>);<br>  basicString((__int64)&amp;flag);<br>  basicString((__int64)&amp;key);<br>  v3 = operateOut(pOut, &amp;unk_408078);<br>  stdOut(v3, out);<br>  v4 = operateOut(pOut, &amp;unk_408160);<br>  stdOut(v4, out);<br>  getLine(pIn, &amp;key);                           <span class="hljs-comment">// 获取密码</span><br>  <span class="hljs-keyword">if</span> ( getLength(&amp;key) != <span class="hljs-number">12</span> )                  <span class="hljs-comment">// 长度判断</span><br>  &#123;<br>    v5 = operateOut(pOut, <span class="hljs-string">&quot;Length Error!&quot;</span>);<br>    stdOut(v5, out);<br>    system(<span class="hljs-string">&quot;pause&quot;</span>);<br>    <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>  &#125;<br>  KeyGenerate(&amp;v19, &amp;KeyEnc[abi:cxx11], &amp;DeKey[abi:cxx11]);<span class="hljs-comment">// key的生成算法</span><br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::operator=(&amp;TrueKey[abi:cxx11], &amp;v19);<br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::~<span class="hljs-built_in">string</span>(&amp;v19);<br>  <span class="hljs-keyword">if</span> ( <span class="hljs-built_in">std</span>::operator!=&lt;<span class="hljs-type">char</span>&gt;(&amp;key, &amp;TrueKey[abi:cxx11]) )<span class="hljs-comment">// 出现了检验逻辑，可以从这里直接获取到真正的key</span><br>  &#123;<br>    v6 = operateOut(pOut, &amp;unk_4081A2);         <span class="hljs-comment">// key错误时的输出</span><br>    stdOut(v6, out);<br>    system(<span class="hljs-string">&quot;pause&quot;</span>);<br>    <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>  &#125;<br>  v7 = operateOut(pOut, &amp;Congratulation);       <span class="hljs-comment">// key正确时的输出</span><br>  stdOut(v7, out);<br>  v8 = operateOut(pOut, &amp;unk_408212);<br>  stdOut(v8, out);<br>  getLine(pIn, &amp;flag);                          <span class="hljs-comment">// 获取flag的输入</span><br>  <span class="hljs-keyword">if</span> ( getLength(&amp;flag) != <span class="hljs-number">51</span> )<br>  &#123;<br>    v9 = operateOut(pOut, <span class="hljs-string">&quot;Length Error!&quot;</span>);<br>    stdOut(v9, out);<br>    system(<span class="hljs-string">&quot;pause&quot;</span>);<br>    <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>  &#125;<br>  encrypt(&amp;encrypted_message, &amp;flag, &amp;key);     <span class="hljs-comment">// 加密算法，密钥即为前文的key</span><br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt;::<span class="hljs-built_in">vector</span>(&amp;EndFlag);<br>  __for_range = &amp;encrypted_message;<br>  __for_begin._M_current = (<span class="hljs-type">char</span> *)<span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::begin(&amp;encrypted_message);<br>  __for_end._M_current = (<span class="hljs-type">char</span> *)<span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::end(__for_range);<br>  <span class="hljs-keyword">while</span> ( __gnu_cxx::operator!=&lt;<span class="hljs-type">char</span> *,<span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>&gt;(&amp;__for_begin, &amp;__for_end) )<br>  &#123;<br>    c = *__gnu_cxx::__normal_iterator&lt;<span class="hljs-type">char</span> *,<span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>&gt;::operator*(&amp;__for_begin);<br>    __x = (<span class="hljs-type">unsigned</span> __int8)c;<br>    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt;::push_back(&amp;EndFlag, &amp;__x);<br>    __gnu_cxx::__normal_iterator&lt;<span class="hljs-type">char</span> *,<span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>&gt;::operator++(&amp;__for_begin);<br>  &#125;<br>  <span class="hljs-keyword">if</span> ( <span class="hljs-built_in">std</span>::operator==&lt;<span class="hljs-type">int</span>,<span class="hljs-built_in">std</span>::allocator&lt;<span class="hljs-type">int</span>&gt;&gt;(&amp;KALEIDXSCOPE, &amp;EndFlag) )<span class="hljs-comment">// 检验加密结果</span><br>  &#123;<br>    v10 = operateOut(pOut, <span class="hljs-string">&quot;All Perfect!&quot;</span>);<br>    stdOut(v10, out);<br>    system(<span class="hljs-string">&quot;pause&quot;</span>);<br>    <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>  &#125;<br>  v11 = operateOut(pOut, <span class="hljs-string">&quot;Try again!&quot;</span>);<br>  stdOut(v11, out);<br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt;::~<span class="hljs-built_in">vector</span>(&amp;EndFlag);<br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::~<span class="hljs-built_in">string</span>(&amp;encrypted_message);<br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::~<span class="hljs-built_in">string</span>(&amp;key);<br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::~<span class="hljs-built_in">string</span>(&amp;flag);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-comment">//加密函数</span><br><span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> *__cdecl <span class="hljs-title function_">modifiedRC4</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> *__return_ptr retstr, <span class="hljs-type">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> *plaintext, <span class="hljs-type">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> *key)</span><br>&#123;<br>  <span class="hljs-type">size_t</span> v3; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">size_t</span> length; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">char</span> v5; <span class="hljs-comment">// bl</span><br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt;::reference List; <span class="hljs-comment">// rax</span><br>  __int64 v8; <span class="hljs-comment">// [rsp+0h] [rbp-80h] BYREF</span><br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt; k; <span class="hljs-comment">// [rsp+20h] [rbp-60h] BYREF</span><br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt; s; <span class="hljs-comment">// [rsp+40h] [rbp-40h] BYREF</span><br>  <span class="hljs-built_in">std</span>::allocator&lt;<span class="hljs-type">int</span>&gt; __a; <span class="hljs-comment">// [rsp+66h] [rbp-1Ah] BYREF</span><br>  <span class="hljs-type">char</span> v12; <span class="hljs-comment">// [rsp+67h] [rbp-19h] BYREF</span><br>  <span class="hljs-type">size_t</span> i; <span class="hljs-comment">// [rsp+68h] [rbp-18h]</span><br><br>  <span class="hljs-built_in">std</span>::allocator&lt;<span class="hljs-type">int</span>&gt;::allocator((<span class="hljs-built_in">std</span>::allocator&lt;<span class="hljs-type">int</span>&gt; *<span class="hljs-type">const</span>)&amp;v8 + <span class="hljs-number">102</span>);<br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt;::<span class="hljs-built_in">vector</span>(&amp;s, <span class="hljs-number">0x100u</span>LL, &amp;__a);<br>  <span class="hljs-built_in">std</span>::allocator&lt;<span class="hljs-type">int</span>&gt;::~allocator(&amp;__a);<br>  rc4_ksa(&amp;s, key);                             <span class="hljs-comment">// RC4密钥调度算法</span><br>  v3 = <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::size(plaintext);<br>  rc4_prga(&amp;k, &amp;s, v3);                         <span class="hljs-comment">// RC4伪随机数生成算法</span><br>  <span class="hljs-built_in">std</span>::allocator&lt;<span class="hljs-type">char</span>&gt;::allocator(&amp;v12);<br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::basic_string(retstr, &amp;unk_408037, &amp;v12);<br>  <span class="hljs-built_in">std</span>::allocator&lt;<span class="hljs-type">char</span>&gt;::~allocator(&amp;v12);<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0LL</span>; ; ++i )<br>  &#123;<br>    length = <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::size(plaintext);<br>    <span class="hljs-keyword">if</span> ( i &gt;= length )<br>      <span class="hljs-keyword">break</span>;<br>    v5 = *(_BYTE *)StrMakeList(plaintext, i);<br>    List = IntMakeList(&amp;k, i);<br>    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::operator+=(retstr, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)(<span class="hljs-type">char</span>)(v5 ^ *(_BYTE *)List ^ <span class="hljs-number">7</span>));<span class="hljs-comment">// 魔改的地方在这</span><br>  &#125;<br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt;::~<span class="hljs-built_in">vector</span>(&amp;k);<br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt;::~<span class="hljs-built_in">vector</span>(&amp;s);<br>  <span class="hljs-keyword">return</span> retstr;<br>&#125;<br><br><span class="hljs-comment">//密钥调度算法</span><br><span class="hljs-type">void</span> __cdecl <span class="hljs-title function_">rc4_ksa</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt; *s, <span class="hljs-type">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> *key)</span><br>&#123;<br>  <span class="hljs-type">int</span> *M_current; <span class="hljs-comment">// rbx</span><br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt;::iterator v3; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">int</span> v4; <span class="hljs-comment">// ebx</span><br>  <span class="hljs-type">unsigned</span> __int64 v5; <span class="hljs-comment">// rdx</span><br>  _BYTE *List; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">char</span> v7; <span class="hljs-comment">// dl</span><br>  <span class="hljs-type">int</span> *s_j; <span class="hljs-comment">// rbx</span><br>  <span class="hljs-type">int</span> *s_i; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">size_t</span> i; <span class="hljs-comment">// [rsp+20h] [rbp-60h]</span><br>  <span class="hljs-type">int</span> j; <span class="hljs-comment">// [rsp+2Ch] [rbp-54h]</span><br><br>  M_current = <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt;::end(s)._M_current;<br>  v3._M_current = <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt;::begin(s)._M_current;<br>  <span class="hljs-built_in">std</span>::iota&lt;__gnu_cxx::__normal_iterator&lt;<span class="hljs-type">int</span> *,<span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt;&gt;,<span class="hljs-type">int</span>&gt;(<br>    v3,<br>    (__gnu_cxx::__normal_iterator&lt;<span class="hljs-type">int</span>*,<span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt; &gt;)M_current,<br>    <span class="hljs-number">0</span>);<br>  j = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0LL</span>; i &lt;= <span class="hljs-number">255</span>; ++i )<br>  &#123;<br>    v4 = *IntMakeList(s, i) + j;<br>    v5 = i % getLength(key);<br>    List = (_BYTE *)StrMakeList(key, v5);<br>    v7 = v4 + *List;<br>    LODWORD(List) = (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)((v4 + (<span class="hljs-type">char</span>)*List) &gt;&gt; <span class="hljs-number">31</span>) &gt;&gt; <span class="hljs-number">24</span>;<br>    j = (<span class="hljs-type">unsigned</span> __int8)((_BYTE)List + v7) - (_DWORD)List;<br>    s_j = IntMakeList(s, j);<br>    s_i = IntMakeList(s, i);<br>    <span class="hljs-built_in">std</span>::swap&lt;<span class="hljs-type">int</span>&gt;(s_i, s_j);<br>  &#125;<br>&#125;<br><br><span class="hljs-comment">//伪随机数生成算法</span><br><span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt; *__cdecl <span class="hljs-title function_">rc4_prga</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt; *__return_ptr retstr, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt; *s, <span class="hljs-type">size_t</span> length)</span><br>&#123;<br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt;::reference v3; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">int</span> *v4; <span class="hljs-comment">// rbx</span><br>  <span class="hljs-type">int</span> *v5; <span class="hljs-comment">// rax</span><br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt;::reference v6; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt;::value_type *v7; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">size_t</span> r; <span class="hljs-comment">// [rsp+30h] [rbp-50h]</span><br>  <span class="hljs-type">int</span> j; <span class="hljs-comment">// [rsp+38h] [rbp-48h]</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [rsp+3Ch] [rbp-44h]</span><br><br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt;::<span class="hljs-built_in">vector</span>(retstr);<br>  i = <span class="hljs-number">0</span>;<br>  j = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">for</span> ( r = <span class="hljs-number">0LL</span>; r &lt; length; ++r )<br>  &#123;<br>    i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span>;<br>    v3 = IntMakeList(s, i);<br>    j = (<span class="hljs-type">unsigned</span> __int8)(((<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)((j + *v3) &gt;&gt; <span class="hljs-number">31</span>) &gt;&gt; <span class="hljs-number">24</span>) + j + *(_BYTE *)v3)<br>      - ((<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)((j + *v3) &gt;&gt; <span class="hljs-number">31</span>) &gt;&gt; <span class="hljs-number">24</span>);<br>    v4 = IntMakeList(s, j);<br>    v5 = IntMakeList(s, i);<br>    <span class="hljs-built_in">std</span>::swap&lt;<span class="hljs-type">int</span>&gt;(v5, v4);<br>    LODWORD(v4) = *IntMakeList(s, i);<br>    v6 = IntMakeList(s, j);<br>    v7 = IntMakeList(<br>           s,<br>           (<span class="hljs-type">int</span>)((<span class="hljs-type">unsigned</span> __int8)(((<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)(((<span class="hljs-type">int</span>)v4 + *v6) &gt;&gt; <span class="hljs-number">31</span>) &gt;&gt; <span class="hljs-number">24</span>) + (_BYTE)v4 + *(_BYTE *)v6)<br>               - ((<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)(((<span class="hljs-type">int</span>)v4 + *v6) &gt;&gt; <span class="hljs-number">31</span>) &gt;&gt; <span class="hljs-number">24</span>)));<br>    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt;::push_back(retstr, v7);<br>  &#125;<br>  <span class="hljs-keyword">return</span> retstr;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>可以看到函数对输入的数据进行了魔改的RC4加密，但实际上没有改变RC4加解密同一个函数的性质，所以解密只需要复现这个代码即可</p>
<p>下面先获取密钥和加密后的flag数据。在main函数第一个getline处下断点，开始动态调试</p>
<p><img src="/../images/image-20251024200050353.png" alt="第一个getline处下断点"></p>
<p>随便输入一个字符后会到长度检测，要求输入的密码长度要等于12，可以输入12个字符也可以后续到这个cmp的时候改jz绕过</p>
<p><img src="/../images/image-20251024200525655.png" alt="长度检测"></p>
<p>过了长度检测后就可以一直运行到key检验处，双击生成的密钥的变量名(TrueKey)就可以得到真正的key了（从</p>
<p>hex窗口可以看到key即为”XaleidscopiX”）</p>
<p><img src="/../images/image-20251024202016786.png" alt="运行到key检验处"></p>
<p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-10-24%20200936.png" alt="真正的key"></p>
<p>然后还需要获得真正flag的加密数据。往下绕过key检验，运行到jz的时候再改一下ZF标志位（此处应当跳转）</p>
<p><img src="/../images/image-20251024202256140.png" alt="绕过key检验(已绕过)"></p>
<p>绕过后终端还有提示</p>
<p><img src="/../images/image-20251024202606398.png" alt="提示"></p>
<p>接下来运行到第二个getline，随便输几个数据（有长度检验，最好是输入51个字符，省的绕过长度检验）。然后继续运行到加密结果的检验处</p>
<p><img src="/../images/image-20251024203359348.png" alt="运行到加密结果检验处"></p>
<p>其中KALEIDXSCOPE的第一个offset就是正确的flag加密后的数据</p>
<p><img src="/../images/image-20251024203510922.png" alt="KALEIDXSCOPE第一个offset(unk_2692A10)"></p>
<p><img src="/../images/image-20251024203610635.png" alt="正确flag加密后的数据"></p>
<p>解密脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">rc4_decrypt</span>(<span class="hljs-params">data, key</span>):<br>    S = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))<br>    j = <span class="hljs-number">0</span><br>    out = []<br><br>    <span class="hljs-comment"># Key-scheduling algorithm (KSA)</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        j = (j + S[i] + key[i % <span class="hljs-built_in">len</span>(key)]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br><br>    <span class="hljs-comment"># Pseudo-random generation algorithm (PRGA)</span><br>    i = <span class="hljs-number">0</span><br>    j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> data:<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        j = (j + S[i]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br>        K = S[(S[i] + S[j]) % <span class="hljs-number">256</span>]<br>        out.append(K)<br><br>    <span class="hljs-keyword">return</span> out<br><br>enc=[<span class="hljs-number">0x000000FC</span>, <span class="hljs-number">0x000000EA</span>, <span class="hljs-number">0x00000015</span>, <span class="hljs-number">0x0000002C</span>, <span class="hljs-number">0x00000086</span>, <span class="hljs-number">0x00000038</span>, <span class="hljs-number">0x0000003F</span>, <span class="hljs-number">0x000000F3</span>, <span class="hljs-number">0x00000092</span>, <span class="hljs-number">0x000000CE</span>, <span class="hljs-number">0x000000DA</span>, <span class="hljs-number">0x0000008E</span>, <span class="hljs-number">0x00000048</span>, <span class="hljs-number">0x000000D3</span>, <span class="hljs-number">0x00000007</span>, <span class="hljs-number">0x0000009F</span>, <span class="hljs-number">0x000000D9</span>, <span class="hljs-number">0x00000057</span>, <span class="hljs-number">0x000000B1</span>, <span class="hljs-number">0x000000EE</span>, <span class="hljs-number">0x00000041</span>, <span class="hljs-number">0x0000009A</span>, <span class="hljs-number">0x0000004D</span>, <span class="hljs-number">0x000000C5</span>, <span class="hljs-number">0x00000065</span>, <span class="hljs-number">0x0000006A</span>, <span class="hljs-number">0x000000FF</span>, <span class="hljs-number">0x000000C9</span>, <span class="hljs-number">0x0000005D</span>, <span class="hljs-number">0x00000034</span>, <span class="hljs-number">0x000000AD</span>, <span class="hljs-number">0x000000EA</span>, <span class="hljs-number">0x000000B1</span>, <span class="hljs-number">0x00000020</span>, <span class="hljs-number">0x0000004B</span>, <span class="hljs-number">0x000000DC</span>, <span class="hljs-number">0x000000BD</span>, <span class="hljs-number">0x000000D2</span>, <span class="hljs-number">0x00000035</span>, <span class="hljs-number">0x00000002</span>, <span class="hljs-number">0x00000084</span>, <span class="hljs-number">0x00000035</span>, <span class="hljs-number">0x00000071</span>, <span class="hljs-number">0x000000EC</span>, <span class="hljs-number">0x000000E0</span>, <span class="hljs-number">0x00000048</span>, <span class="hljs-number">0x0000008E</span>, <span class="hljs-number">0x000000EA</span>, <span class="hljs-number">0x0000007B</span>, <span class="hljs-number">0x000000AA</span>, <span class="hljs-number">0x000000CF</span>]<br>_key=<span class="hljs-string">&quot;XaleidscopiX&quot;</span><br>key=[]<br>flag=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> _key:<br>    key.append(<span class="hljs-built_in">ord</span>(i))<br><span class="hljs-comment">#print(key)</span><br><br>keystream=rc4_decrypt(enc, key)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc)):<br>    flag.append(enc[i]^keystream[i]^<span class="hljs-number">7</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#x27;</span>.join([<span class="hljs-built_in">chr</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> flag]))<br></code></pre></td></tr></table></figure></li>
</ul>
<blockquote>
<p>flag：0xGame{RC4_15_4_b4s1c&amp;fl3x1bl3_3ncrYp710n4lg0r17hm}</p>
</blockquote>
<h2 id="Q-≧▽≦-T"><a href="#Q-≧▽≦-T" class="headerlink" title="Q(≧▽≦)T"></a>Q(≧▽≦)T</h2><blockquote>
<p>考点：QT程序逆向、crackme、动态调试、RC4、哈希校验</p>
</blockquote>
<ul>
<li><p>附件程序运行如图，是个序列号生成器：</p>
<p><img src="/../images/image-20251024212602045.png" alt="运行"></p>
</li>
<li><p>用IDA打开，出现的是start函数， 看不出什么东西来</p>
<p><img src="/../images/image-20251024214150526.png" alt="start函数"></p>
<p>shift+F12看看字符串表，可以发现两串可疑的字符串</p>
<p><img src="/../images/image-20251024214208963.png" alt="可疑的字符串"></p>
<p>跟踪过去可以找到这样一个函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br></pre></td><td class="code"><pre><code class="hljs C"><span class="hljs-type">void</span> __fastcall <span class="hljs-title function_">sub_140001890</span><span class="hljs-params">(__int64 a1, __int64 a2, __int64 a3, __int64 a4)</span><br>&#123;<br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v5; <span class="hljs-comment">// rax</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v6; <span class="hljs-comment">// [rsp+80h] [rbp-1F8h] BYREF</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v7; <span class="hljs-comment">// [rsp+88h] [rbp-1F0h]</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v8; <span class="hljs-comment">// [rsp+90h] [rbp-1E8h] BYREF</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v9; <span class="hljs-comment">// [rsp+98h] [rbp-1E0h]</span><br>  __int64 Block; <span class="hljs-comment">// [rsp+A0h] [rbp-1D8h] BYREF</span><br>  <span class="hljs-type">const</span> <span class="hljs-type">char</span> *v11; <span class="hljs-comment">// [rsp+A8h] [rbp-1D0h]</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v12[<span class="hljs-number">4</span>]; <span class="hljs-comment">// [rsp+B0h] [rbp-1C8h] BYREF</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v13[<span class="hljs-number">4</span>]; <span class="hljs-comment">// [rsp+D0h] [rbp-1A8h] BYREF</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v14[<span class="hljs-number">4</span>]; <span class="hljs-comment">// [rsp+F0h] [rbp-188h] BYREF</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v15; <span class="hljs-comment">// [rsp+110h] [rbp-168h] BYREF</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v16[<span class="hljs-number">4</span>]; <span class="hljs-comment">// [rsp+130h] [rbp-148h] BYREF</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v17[<span class="hljs-number">2</span>]; <span class="hljs-comment">// [rsp+150h] [rbp-128h] BYREF</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v18; <span class="hljs-comment">// [rsp+160h] [rbp-118h]</span><br>  __m128i v19[<span class="hljs-number">2</span>]; <span class="hljs-comment">// [rsp+170h] [rbp-108h] BYREF</span><br>  __m128i v20; <span class="hljs-comment">// [rsp+190h] [rbp-E8h] BYREF</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v21[<span class="hljs-number">4</span>]; <span class="hljs-comment">// [rsp+1B0h] [rbp-C8h] BYREF</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v22[<span class="hljs-number">2</span>]; <span class="hljs-comment">// [rsp+1D0h] [rbp-A8h] BYREF</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v23; <span class="hljs-comment">// [rsp+1E0h] [rbp-98h]</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v24[<span class="hljs-number">4</span>]; <span class="hljs-comment">// [rsp+1F0h] [rbp-88h] BYREF</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v25[<span class="hljs-number">13</span>]; <span class="hljs-comment">// [rsp+210h] [rbp-68h] BYREF</span><br><br>  ((<span class="hljs-type">void</span> (__fastcall *)(<span class="hljs-type">void</span> *, <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 **, _QWORD, <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 **))QLineEdit::text)(<br>    QLineEdit::text,<br>    v25,<br>    *(_QWORD *)(*(_QWORD *)(a4 + <span class="hljs-number">40</span>) + <span class="hljs-number">16LL</span>),<br>    v25);<br>  QString::trimmed_helper(QLineEdit::text, v25, v25, v12);<br>  <span class="hljs-keyword">if</span> ( v25[<span class="hljs-number">0</span>] &amp;&amp; !_InterlockedSub(v25[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>    <span class="hljs-built_in">free</span>(QLineEdit::text);<br>  ((<span class="hljs-type">void</span> (__fastcall *)(<span class="hljs-type">void</span> *, <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 **, _QWORD, <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 **))QLineEdit::text)(<br>    QLineEdit::text,<br>    v25,<br>    *(_QWORD *)(*(_QWORD *)(a4 + <span class="hljs-number">40</span>) + <span class="hljs-number">24LL</span>),<br>    v13);<br>  <span class="hljs-keyword">if</span> ( v12[<span class="hljs-number">2</span>] == (<span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *)<span class="hljs-number">4</span> )<br>  &#123;<br>    QString::toUtf8_helper(QLineEdit::text, v25, v12, v14);<br>    Block = (__int64)v14[<span class="hljs-number">2</span>];<br>    v11 = (<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)v14[<span class="hljs-number">1</span>];<br>    QCryptographicHash::hash(&amp;Block, v25, &amp;Block, &amp;v15, <span class="hljs-number">4LL</span>);<br>    sub_140001620((__int64)&amp;Block, (__int64)v25, a4, (__int64)v16);<br>    Block = <span class="hljs-number">64LL</span>;<br>    v11 = <span class="hljs-string">&quot;c94201919ec7463313c747d0a27fabcabf1400fa1e9a64d36a6b1a7e7b12ae68&quot;</span>;<br>    QString::fromUtf8(&amp;Block, v25, &amp;Block, v17);<br>    <span class="hljs-keyword">if</span> ( v18 == v16[<span class="hljs-number">2</span>]<br>      &amp;&amp; (v8 = v18, v6 = v18, v9 = v16[<span class="hljs-number">1</span>], v7 = v17[<span class="hljs-number">1</span>], (<span class="hljs-type">unsigned</span> __int8)QtPrivate::equalStrings(&amp;Block, v25, &amp;v6, &amp;v8)) )<br>    &#123;<br>      QString::toUtf8_helper(&amp;Block, v25, v13, v19);<br>      sub_1400016F0((__int64)&amp;Block, (__int64)v25, a4, &amp;v20, v19, (__int64)v14);<br>      sub_140001620((__int64)&amp;Block, (__int64)v25, a4, (__int64)v21);<br>      Block = <span class="hljs-number">72LL</span>;<br>      v11 = <span class="hljs-string">&quot;af33da5e152c15863b3a03c87601899a37d51b8b8168f65aca65352d3669e91959300ccb&quot;</span>;<br>      QString::fromUtf8(&amp;Block, v25, &amp;Block, v22);<br>      <span class="hljs-keyword">if</span> ( v23 == v21[<span class="hljs-number">2</span>]<br>        &amp;&amp; (v8 = v23, v9 = v21[<span class="hljs-number">1</span>],<br>                      v6 = v23,<br>                      v7 = v22[<span class="hljs-number">1</span>],<br>                      (<span class="hljs-type">unsigned</span> __int8)QtPrivate::equalStrings(&amp;Block, v25, &amp;v6, &amp;v8)) )<br>      &#123;<br>        Block = <span class="hljs-number">21LL</span>;<br>        v11 = (<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)&amp;unk_1400061D8;<br>        QString::fromUtf8(&amp;Block, v25, &amp;Block, v25);<br>        Block = <span class="hljs-number">12LL</span>;<br>        v11 = (<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)&amp;unk_1400061EE;<br>        QString::fromUtf8(&amp;Block, v25, &amp;Block, v24);<br>        QMessageBox::information(&amp;Block, v25, v24, a4, v25, <span class="hljs-number">1024LL</span>);<br>      &#125;<br>      <span class="hljs-keyword">else</span><br>      &#123;<br>        Block = <span class="hljs-number">22LL</span>;<br>        v11 = (<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)&amp;unk_1400061C1;<br>        QString::fromUtf8(&amp;Block, v25, &amp;Block, v25);<br>        Block = <span class="hljs-number">12LL</span>;<br>        v11 = (<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)&amp;unk_140006104;<br>        QString::fromUtf8(&amp;Block, v25, &amp;Block, v24);<br>        QMessageBox::warning(&amp;Block, v25, v24, a4, v25, <span class="hljs-number">1024LL</span>);<br>      &#125;<br>      <span class="hljs-keyword">if</span> ( v24[<span class="hljs-number">0</span>] &amp;&amp; !_InterlockedSub(v24[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>        <span class="hljs-built_in">free</span>(&amp;Block);<br>      <span class="hljs-keyword">if</span> ( v25[<span class="hljs-number">0</span>] &amp;&amp; !_InterlockedSub(v25[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>        <span class="hljs-built_in">free</span>(&amp;Block);<br>      <span class="hljs-keyword">if</span> ( v22[<span class="hljs-number">0</span>] &amp;&amp; !_InterlockedSub(v22[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>        <span class="hljs-built_in">free</span>(&amp;Block);<br>      <span class="hljs-keyword">if</span> ( v21[<span class="hljs-number">0</span>] &amp;&amp; !_InterlockedSub(v21[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>        <span class="hljs-built_in">free</span>(&amp;Block);<br>      <span class="hljs-keyword">if</span> ( v20.m128i_i64[<span class="hljs-number">0</span>] &amp;&amp; !_InterlockedSub((<span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *)v20.m128i_i64[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>        <span class="hljs-built_in">free</span>(&amp;Block);<br>      <span class="hljs-keyword">if</span> ( !v19[<span class="hljs-number">0</span>].m128i_i64[<span class="hljs-number">0</span>] || _InterlockedSub((<span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *)v19[<span class="hljs-number">0</span>].m128i_i64[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>        <span class="hljs-keyword">goto</span> LABEL_45;<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>      Block = <span class="hljs-number">25LL</span>;<br>      v11 = (<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)&amp;unk_140006159;<br>      QString::fromUtf8(&amp;Block, v25, &amp;Block, v25);<br>      Block = <span class="hljs-number">12LL</span>;<br>      v11 = (<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)&amp;unk_140006104;<br>      QString::fromUtf8(&amp;Block, v25, &amp;Block, v24);<br>      QMessageBox::warning(&amp;Block, v25, v24, a4, v25, <span class="hljs-number">1024LL</span>);<br>      <span class="hljs-keyword">if</span> ( v24[<span class="hljs-number">0</span>] &amp;&amp; !_InterlockedSub(v24[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>        <span class="hljs-built_in">free</span>(&amp;Block);<br>      <span class="hljs-keyword">if</span> ( !v25[<span class="hljs-number">0</span>] || _InterlockedSub(v25[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>        <span class="hljs-keyword">goto</span> LABEL_45;<br>    &#125;<br>    <span class="hljs-built_in">free</span>(&amp;Block);<br>LABEL_45:<br>    <span class="hljs-keyword">if</span> ( v17[<span class="hljs-number">0</span>] &amp;&amp; !_InterlockedSub(v17[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>      <span class="hljs-built_in">free</span>(&amp;Block);<br>    <span class="hljs-keyword">if</span> ( v16[<span class="hljs-number">0</span>] &amp;&amp; !_InterlockedSub(v16[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>      <span class="hljs-built_in">free</span>(&amp;Block);<br>    <span class="hljs-keyword">if</span> ( v15 &amp;&amp; !_InterlockedSub(v15, <span class="hljs-number">1u</span>) )<br>      <span class="hljs-built_in">free</span>(&amp;Block);<br>    <span class="hljs-keyword">if</span> ( v14[<span class="hljs-number">0</span>] &amp;&amp; !_InterlockedSub(v14[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>      <span class="hljs-built_in">free</span>(&amp;Block);<br>    <span class="hljs-keyword">goto</span> LABEL_10;<br>  &#125;<br>  Block = <span class="hljs-number">35LL</span>;<br>  v11 = (<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)&amp;unk_1400060E0;<br>  QString::fromUtf8(&amp;Block, v25, &amp;Block, v25);<br>  Block = <span class="hljs-number">12LL</span>;<br>  v11 = (<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)&amp;unk_140006104;<br>  QString::fromUtf8(&amp;Block, v25, &amp;Block, v24);<br>  QMessageBox::warning(&amp;Block, v25, v24, a4, v25, <span class="hljs-number">1024LL</span>);<br>  <span class="hljs-keyword">if</span> ( v24[<span class="hljs-number">0</span>] &amp;&amp; !_InterlockedSub(v24[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>  &#123;<br>    <span class="hljs-built_in">free</span>(&amp;Block);<br>    v5 = v25[<span class="hljs-number">0</span>];<br>    <span class="hljs-keyword">if</span> ( !v25[<span class="hljs-number">0</span>] )<br>      <span class="hljs-keyword">goto</span> LABEL_10;<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    v5 = v25[<span class="hljs-number">0</span>];<br>    <span class="hljs-keyword">if</span> ( !v25[<span class="hljs-number">0</span>] )<br>      <span class="hljs-keyword">goto</span> LABEL_10;<br>  &#125;<br>  <span class="hljs-keyword">if</span> ( !_InterlockedSub(v5, <span class="hljs-number">1u</span>) )<br>    <span class="hljs-built_in">free</span>(&amp;Block);<br>LABEL_10:<br>  <span class="hljs-keyword">if</span> ( v13[<span class="hljs-number">0</span>] &amp;&amp; !_InterlockedSub(v13[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>    <span class="hljs-built_in">free</span>(&amp;Block);<br>  <span class="hljs-keyword">if</span> ( v12[<span class="hljs-number">0</span>] )<br>  &#123;<br>    <span class="hljs-keyword">if</span> ( !_InterlockedSub(v12[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>      <span class="hljs-built_in">free</span>(&amp;Block);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>程序的图形化界面是QT实现的，引入了QT的很多类，所以阅读难度还是有点大的。借助AI优化一下以及一点点动态调试辅助分析可以得到：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">void</span> __fastcall <span class="hljs-title function_">check</span><span class="hljs-params">(__int64 a1, __int64 a2, __int64 a3, __int64 mainWindows)</span><br>&#123;<br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v5; <span class="hljs-comment">// rax</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v6; <span class="hljs-comment">// [rsp+80h] [rbp-1F8h] BYREF</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v7; <span class="hljs-comment">// [rsp+88h] [rbp-1F0h]</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v8; <span class="hljs-comment">// [rsp+90h] [rbp-1E8h] BYREF</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v9; <span class="hljs-comment">// [rsp+98h] [rbp-1E0h]</span><br>  __int64 Block; <span class="hljs-comment">// [rsp+A0h] [rbp-1D8h] BYREF</span><br>  <span class="hljs-type">const</span> <span class="hljs-type">char</span> *stringData; <span class="hljs-comment">// [rsp+A8h] [rbp-1D0h]</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *usernameUtf8[<span class="hljs-number">4</span>]; <span class="hljs-comment">// [rsp+B0h] [rbp-1C8h] BYREF</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *passwordUtf8[<span class="hljs-number">4</span>]; <span class="hljs-comment">// [rsp+D0h] [rbp-1A8h] BYREF</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *usernameBytes[<span class="hljs-number">4</span>]; <span class="hljs-comment">// [rsp+F0h] [rbp-188h] BYREF</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *usernameHash; <span class="hljs-comment">// [rsp+110h] [rbp-168h] BYREF</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *usernameHashHex[<span class="hljs-number">4</span>]; <span class="hljs-comment">// [rsp+130h] [rbp-148h] BYREF</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v17[<span class="hljs-number">2</span>]; <span class="hljs-comment">// [rsp+150h] [rbp-128h] BYREF</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *expectedUserHashSize; <span class="hljs-comment">// [rsp+160h] [rbp-118h]</span><br>  __m128i passwordBytes[<span class="hljs-number">2</span>]; <span class="hljs-comment">// [rsp+170h] [rbp-108h] BYREF</span><br>  __m128i v20; <span class="hljs-comment">// [rsp+190h] [rbp-E8h] BYREF</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v21[<span class="hljs-number">4</span>]; <span class="hljs-comment">// [rsp+1B0h] [rbp-C8h] BYREF</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v22[<span class="hljs-number">2</span>]; <span class="hljs-comment">// [rsp+1D0h] [rbp-A8h] BYREF</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v23; <span class="hljs-comment">// [rsp+1E0h] [rbp-98h]</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v24[<span class="hljs-number">4</span>]; <span class="hljs-comment">// [rsp+1F0h] [rbp-88h] BYREF</span><br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *tempBuffer[<span class="hljs-number">13</span>]; <span class="hljs-comment">// [rsp+210h] [rbp-68h] BYREF</span><br><br>  (QLineEdit::text)(QLineEdit::text, tempBuffer, *(*(mainWindows + <span class="hljs-number">40</span>) + <span class="hljs-number">16LL</span>), tempBuffer);<br>  QString::trimmed_helper(QLineEdit::text, tempBuffer, tempBuffer, usernameUtf8);<br>  <span class="hljs-keyword">if</span> ( tempBuffer[<span class="hljs-number">0</span>] &amp;&amp; !_InterlockedSub(tempBuffer[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>    <span class="hljs-built_in">free</span>(QLineEdit::text);<br>  (QLineEdit::text)(QLineEdit::text, tempBuffer, *(*(mainWindows + <span class="hljs-number">40</span>) + <span class="hljs-number">24LL</span>), passwordUtf8);<br>  <span class="hljs-keyword">if</span> ( usernameUtf8[<span class="hljs-number">2</span>] == <span class="hljs-number">4</span> )                   <span class="hljs-comment">// 长度检验</span><br>  &#123;<br>    QString::toUtf8_helper(QLineEdit::text, tempBuffer, usernameUtf8, usernameBytes);<br>    Block = usernameBytes[<span class="hljs-number">2</span>];<br>    stringData = usernameBytes[<span class="hljs-number">1</span>];<br>    QCryptographicHash::hash(&amp;Block, tempBuffer, &amp;Block, &amp;usernameHash, <span class="hljs-number">4LL</span>);<span class="hljs-comment">// 求输入的用户名hash</span><br>    toHex(&amp;Block, tempBuffer, mainWindows, usernameHashHex);<br>    Block = <span class="hljs-number">64LL</span>;<br>    stringData = <span class="hljs-string">&quot;c94201919ec7463313c747d0a27fabcabf1400fa1e9a64d36a6b1a7e7b12ae68&quot;</span>;<span class="hljs-comment">// 预设哈希值</span><br>    QString::fromUtf8(&amp;Block, tempBuffer, &amp;Block, v17);<br>    <span class="hljs-keyword">if</span> ( expectedUserHashSize == usernameHashHex[<span class="hljs-number">2</span>]<br>      &amp;&amp; (v8 = expectedUserHashSize,<br>          v6 = expectedUserHashSize,<br>          v9 = usernameHashHex[<span class="hljs-number">1</span>],<br>          v7 = v17[<span class="hljs-number">1</span>],<br>          QtPrivate::equalStrings(&amp;Block, tempBuffer, &amp;v6, &amp;v8)) )<span class="hljs-comment">// 用户名检验</span><br>    &#123;<br>      QString::toUtf8_helper(&amp;Block, tempBuffer, passwordUtf8, passwordBytes);<br>      RC4(&amp;Block, tempBuffer, mainWindows, &amp;v20, passwordBytes, usernameBytes);<br>      toHex(&amp;Block, tempBuffer, mainWindows, v21);<br>      Block = <span class="hljs-number">72LL</span>;<br>      stringData = <span class="hljs-string">&quot;af33da5e152c15863b3a03c87601899a37d51b8b8168f65aca65352d3669e91959300ccb&quot;</span>;<br>      QString::fromUtf8(&amp;Block, tempBuffer, &amp;Block, v22);<br>      <span class="hljs-keyword">if</span> ( v23 == v21[<span class="hljs-number">2</span>]<br>        &amp;&amp; (v8 = v23, v9 = v21[<span class="hljs-number">1</span>], v6 = v23, v7 = v22[<span class="hljs-number">1</span>], QtPrivate::equalStrings(&amp;Block, tempBuffer, &amp;v6, &amp;v8)) )<span class="hljs-comment">// 验证通过</span><br>      &#123;<br>        Block = <span class="hljs-number">21LL</span>;<br>        stringData = &amp;unk_7FF7F2EB61D8;<br>        QString::fromUtf8(&amp;Block, tempBuffer, &amp;Block, tempBuffer);<br>        Block = <span class="hljs-number">12LL</span>;<br>        stringData = &amp;unk_7FF7F2EB61EE;<br>        QString::fromUtf8(&amp;Block, tempBuffer, &amp;Block, v24);<br>        QMessageBox::information(&amp;Block, tempBuffer, v24, mainWindows, tempBuffer, <span class="hljs-number">1024LL</span>);<br>      &#125;<br>      <span class="hljs-keyword">else</span>                                      <span class="hljs-comment">// 密码验证不通过</span><br>      &#123;<br>        Block = <span class="hljs-number">22LL</span>;<br>        stringData = &amp;unk_7FF7F2EB61C1;<br>        QString::fromUtf8(&amp;Block, tempBuffer, &amp;Block, tempBuffer);<br>        Block = <span class="hljs-number">12LL</span>;<br>        stringData = &amp;unk_7FF7F2EB6104;<br>        QString::fromUtf8(&amp;Block, tempBuffer, &amp;Block, v24);<br>        QMessageBox::warning(&amp;Block, tempBuffer, v24, mainWindows, tempBuffer, <span class="hljs-number">1024LL</span>);<br>      &#125;<br>      <span class="hljs-keyword">if</span> ( v24[<span class="hljs-number">0</span>] &amp;&amp; !_InterlockedSub(v24[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>        <span class="hljs-built_in">free</span>(&amp;Block);<br>      <span class="hljs-keyword">if</span> ( tempBuffer[<span class="hljs-number">0</span>] &amp;&amp; !_InterlockedSub(tempBuffer[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>        <span class="hljs-built_in">free</span>(&amp;Block);<br>      <span class="hljs-keyword">if</span> ( v22[<span class="hljs-number">0</span>] &amp;&amp; !_InterlockedSub(v22[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>        <span class="hljs-built_in">free</span>(&amp;Block);<br>      <span class="hljs-keyword">if</span> ( v21[<span class="hljs-number">0</span>] &amp;&amp; !_InterlockedSub(v21[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>        <span class="hljs-built_in">free</span>(&amp;Block);<br>      <span class="hljs-keyword">if</span> ( v20.m128i_i64[<span class="hljs-number">0</span>] &amp;&amp; !_InterlockedSub(v20.m128i_i64[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>        <span class="hljs-built_in">free</span>(&amp;Block);<br>      <span class="hljs-keyword">if</span> ( !passwordBytes[<span class="hljs-number">0</span>].m128i_i64[<span class="hljs-number">0</span>] || _InterlockedSub(passwordBytes[<span class="hljs-number">0</span>].m128i_i64[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>        <span class="hljs-keyword">goto</span> LABEL_45;<br>    &#125;<br>    <span class="hljs-keyword">else</span>                                        <span class="hljs-comment">// 用户名验证不通过</span><br>    &#123;<br>      Block = <span class="hljs-number">25LL</span>;<br>      stringData = &amp;unk_7FF7F2EB6159;<br>      QString::fromUtf8(&amp;Block, tempBuffer, &amp;Block, tempBuffer);<br>      Block = <span class="hljs-number">12LL</span>;<br>      stringData = &amp;unk_7FF7F2EB6104;<br>      QString::fromUtf8(&amp;Block, tempBuffer, &amp;Block, v24);<br>      QMessageBox::warning(&amp;Block, tempBuffer, v24, mainWindows, tempBuffer, <span class="hljs-number">1024LL</span>);<br>      <span class="hljs-keyword">if</span> ( v24[<span class="hljs-number">0</span>] &amp;&amp; !_InterlockedSub(v24[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>        <span class="hljs-built_in">free</span>(&amp;Block);<br>      <span class="hljs-keyword">if</span> ( !tempBuffer[<span class="hljs-number">0</span>] || _InterlockedSub(tempBuffer[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>        <span class="hljs-keyword">goto</span> LABEL_45;<br>    &#125;<br>    <span class="hljs-built_in">free</span>(&amp;Block);<br>LABEL_45:<br>    <span class="hljs-keyword">if</span> ( v17[<span class="hljs-number">0</span>] &amp;&amp; !_InterlockedSub(v17[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>      <span class="hljs-built_in">free</span>(&amp;Block);<br>    <span class="hljs-keyword">if</span> ( usernameHashHex[<span class="hljs-number">0</span>] &amp;&amp; !_InterlockedSub(usernameHashHex[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>      <span class="hljs-built_in">free</span>(&amp;Block);<br>    <span class="hljs-keyword">if</span> ( usernameHash &amp;&amp; !_InterlockedSub(usernameHash, <span class="hljs-number">1u</span>) )<br>      <span class="hljs-built_in">free</span>(&amp;Block);<br>    <span class="hljs-keyword">if</span> ( usernameBytes[<span class="hljs-number">0</span>] &amp;&amp; !_InterlockedSub(usernameBytes[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>      <span class="hljs-built_in">free</span>(&amp;Block);<br>    <span class="hljs-keyword">goto</span> LABEL_10;<br>  &#125;<br>  Block = <span class="hljs-number">35LL</span>;<br>  stringData = &amp;unk_7FF7F2EB60E0;<br>  QString::fromUtf8(&amp;Block, tempBuffer, &amp;Block, tempBuffer);<br>  Block = <span class="hljs-number">12LL</span>;<br>  stringData = &amp;unk_7FF7F2EB6104;<br>  QString::fromUtf8(&amp;Block, tempBuffer, &amp;Block, v24);<br>  QMessageBox::warning(&amp;Block, tempBuffer, v24, mainWindows, tempBuffer, <span class="hljs-number">1024LL</span>);<br>  <span class="hljs-keyword">if</span> ( v24[<span class="hljs-number">0</span>] &amp;&amp; !_InterlockedSub(v24[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>  &#123;<br>    <span class="hljs-built_in">free</span>(&amp;Block);<br>    v5 = tempBuffer[<span class="hljs-number">0</span>];<br>    <span class="hljs-keyword">if</span> ( !tempBuffer[<span class="hljs-number">0</span>] )<br>      <span class="hljs-keyword">goto</span> LABEL_10;<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    v5 = tempBuffer[<span class="hljs-number">0</span>];<br>    <span class="hljs-keyword">if</span> ( !tempBuffer[<span class="hljs-number">0</span>] )<br>      <span class="hljs-keyword">goto</span> LABEL_10;<br>  &#125;<br>  <span class="hljs-keyword">if</span> ( !_InterlockedSub(v5, <span class="hljs-number">1u</span>) )<br>    <span class="hljs-built_in">free</span>(&amp;Block);<br>LABEL_10:<br>  <span class="hljs-keyword">if</span> ( passwordUtf8[<span class="hljs-number">0</span>] &amp;&amp; !_InterlockedSub(passwordUtf8[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>    <span class="hljs-built_in">free</span>(&amp;Block);<br>  <span class="hljs-keyword">if</span> ( usernameUtf8[<span class="hljs-number">0</span>] )<br>  &#123;<br>    <span class="hljs-keyword">if</span> ( !_InterlockedSub(usernameUtf8[<span class="hljs-number">0</span>], <span class="hljs-number">1u</span>) )<br>      <span class="hljs-built_in">free</span>(&amp;Block);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>可以看到用户名采用的是哈希检验，密码采用的是RC4检验，密钥为用户名。</p>
<p>密码检验套在用户名检验里，所以第一步先解出用户名。借助在线解密网站<a target="_blank" rel="noopener" href="https://hashes.com/zh/decrypt/hash">MD5 在線免費解密</a>可以得到用户名”Kath”：</p>
<p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-10-20%20215617.png" alt="sha256解密得到用户名"></p>
<p>接下来求解密码。RC4函数如下：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><code class="hljs C">__m128i *__fastcall <span class="hljs-title function_">RC4</span><span class="hljs-params">(</span><br><span class="hljs-params">        __int64 a1,</span><br><span class="hljs-params">        __int64 a2,</span><br><span class="hljs-params">        __int64 a3,</span><br><span class="hljs-params">        __m128i *a4,</span><br><span class="hljs-params">        <span class="hljs-type">const</span> __m128i *passwordBytes,</span><br><span class="hljs-params">        __int64 usernameBytes)</span><br>&#123;<br>  <span class="hljs-keyword">volatile</span> <span class="hljs-type">signed</span> __int32 *v6; <span class="hljs-comment">// rax</span><br>  __int64 v7; <span class="hljs-comment">// rdx</span><br>  <span class="hljs-type">bool</span> v8; <span class="hljs-comment">// zf</span><br>  <span class="hljs-type">int</span> keyLength; <span class="hljs-comment">// r11d</span><br>  <span class="hljs-type">int</span> *sBoxPtr; <span class="hljs-comment">// r8</span><br>  __m128i initVal; <span class="hljs-comment">// xmm0</span><br>  __m128i *sBoxInitPtr; <span class="hljs-comment">// rax</span><br>  __m128i v15; <span class="hljs-comment">// xmm2</span><br>  __m128i currentVal; <span class="hljs-comment">// xmm1</span><br>  __int64 keyBytes; <span class="hljs-comment">// rdi</span><br>  <span class="hljs-type">int</span> i_ksa; <span class="hljs-comment">// ecx</span><br>  <span class="hljs-type">int</span> j_ksa; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v20; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">int</span> sBoxVal; <span class="hljs-comment">// r10d</span><br>  __int64 sum; <span class="hljs-comment">// kr00_8</span><br>  __int64 passwordIndex; <span class="hljs-comment">// r12</span><br>  <span class="hljs-type">int</span> j; <span class="hljs-comment">// ebp</span><br>  __int64 i; <span class="hljs-comment">// rdi</span><br>  <span class="hljs-type">int</span> temp; <span class="hljs-comment">// eax</span><br>  __int64 v27; <span class="hljs-comment">// kr08_8</span><br>  <span class="hljs-type">char</span> v28; <span class="hljs-comment">// r14</span><br>  _DWORD S[<span class="hljs-number">256</span>]; <span class="hljs-comment">// [rsp+20h] [rbp-438h] BYREF</span><br>  <span class="hljs-type">char</span> v31; <span class="hljs-comment">// [rsp+420h] [rbp-38h] BYREF</span><br><br>  v6 = passwordBytes-&gt;m128i_i64[<span class="hljs-number">0</span>];<br>  v7 = passwordBytes[<span class="hljs-number">1</span>].m128i_i64[<span class="hljs-number">0</span>];<br>  v8 = passwordBytes-&gt;m128i_i64[<span class="hljs-number">0</span>] == <span class="hljs-number">0</span>;<br>  *a4 = _mm_loadu_si128(passwordBytes);<br>  a4[<span class="hljs-number">1</span>].m128i_i64[<span class="hljs-number">0</span>] = v7;<br>  <span class="hljs-keyword">if</span> ( !v8 )<br>    _InterlockedAdd(v6, <span class="hljs-number">1u</span>);<br>  keyLength = *(usernameBytes + <span class="hljs-number">16</span>);<br>  sBoxPtr = S;<br>  initVal = _mm_load_si128(&amp;xmmword_7FF7F2EB6200);<br>  sBoxInitPtr = S;<br>  v15 = _mm_load_si128(&amp;xmmword_7FF7F2EB6210);<br>  <span class="hljs-keyword">do</span><br>  &#123;<br>    currentVal = initVal;<br>    ++sBoxInitPtr;<br>    initVal = _mm_add_epi32(initVal, v15);<br>    sBoxInitPtr[<span class="hljs-number">-1</span>] = currentVal;<br>  &#125;<br>  <span class="hljs-keyword">while</span> ( sBoxInitPtr != &amp;v31 );<br>  keyBytes = *(usernameBytes + <span class="hljs-number">8</span>);<br>  i_ksa = <span class="hljs-number">0</span>;<br>  j_ksa = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">do</span>                                            <span class="hljs-comment">// RC4_KSA</span><br>  &#123;<br>    v20 = i_ksa;<br>    sBoxVal = *sBoxPtr;<br>    ++i_ksa;<br>    ++sBoxPtr;<br>    sum = sBoxVal + j_ksa + *(keyBytes + v20 % keyLength);<br>    j_ksa = (HIBYTE(sum) + sum) - HIBYTE(HIDWORD(sum));<span class="hljs-comment">// j = j % 256</span><br>    *(sBoxPtr - <span class="hljs-number">1</span>) = S[j_ksa];<br>    S[j_ksa] = sBoxVal;<br>  &#125;<br>  <span class="hljs-keyword">while</span> ( i_ksa != <span class="hljs-number">256</span> );<br>  <span class="hljs-keyword">if</span> ( passwordBytes[<span class="hljs-number">1</span>].m128i_i64[<span class="hljs-number">0</span>] &gt; <span class="hljs-number">0</span> )      <span class="hljs-comment">// RC4_PRGA和RC4decrypt</span><br>  &#123;<br>    passwordIndex = <span class="hljs-number">0LL</span>;<br>    j = <span class="hljs-number">0</span>;<br>    LODWORD(i) = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">do</span><br>    &#123;<br>      i = ((i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span>);<br>      temp = S[i];<br>      j = (temp + j) % <span class="hljs-number">256</span>;<br>      S[i] = S[j];<br>      S[j] = temp;<br>      v27 = S[i] + temp;<br>      v28 = *(passwordBytes-&gt;m128i_i64[<span class="hljs-number">1</span>] + passwordIndex) ^ S[(HIBYTE(v27) + v27) - HIBYTE(HIDWORD(v27))];<span class="hljs-comment">// v28 = passwordBytes[passwordIndex] ^ S[(S[i]+S[j])%256]</span><br>      <span class="hljs-keyword">if</span> ( !a4-&gt;m128i_i64[<span class="hljs-number">0</span>] || *a4-&gt;m128i_i64[<span class="hljs-number">0</span>] &gt; <span class="hljs-number">1</span> )<br>        QByteArray::reallocData(i, passwordBytes, a4[<span class="hljs-number">1</span>].m128i_i64[<span class="hljs-number">0</span>], a4, <span class="hljs-number">1LL</span>, *initVal.m128i_i64);<br>      *(a4-&gt;m128i_i64[<span class="hljs-number">1</span>] + passwordIndex++) = v28;<br>    &#125;<br>    <span class="hljs-keyword">while</span> ( passwordBytes[<span class="hljs-number">1</span>].m128i_i64[<span class="hljs-number">0</span>] &gt; passwordIndex );<br>  &#125;<br>  <span class="hljs-keyword">return</span> a4;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>可以看出是标准的RC4，直接复现加密函数即可。解密脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">rc4_ksa</span>(<span class="hljs-params">key</span>):<br>    S = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))<br>    j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        j = (j + S[i] + key[i % <span class="hljs-built_in">len</span>(key)]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br>    <span class="hljs-keyword">return</span> S<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rc4_prga</span>(<span class="hljs-params">S, n</span>):<br>    i = j = <span class="hljs-number">0</span><br>    keystream = []<br>    S = S[:]  <span class="hljs-comment"># copy</span><br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        j = (j + S[i]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br>        k = S[(S[i] + S[j]) % <span class="hljs-number">256</span>]<br>        keystream.append(k)<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(keystream)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rc4_decrypt</span>(<span class="hljs-params">key, ciphertext</span>):<br>    S = rc4_ksa(key)<br>    ks = rc4_prga(S, <span class="hljs-built_in">len</span>(ciphertext))<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(c ^ k <span class="hljs-keyword">for</span> c, k <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(ciphertext, ks))<br><br>key = <span class="hljs-string">b&quot;Kath&quot;</span><br>cipher = <span class="hljs-string">&quot;af33da5e152c15863b3a03c87601899a37d51b8b8168f65aca65352d3669e91959300ccb&quot;</span><br><br><span class="hljs-comment"># 转成bytes</span><br>ciphertext = <span class="hljs-built_in">bytes</span>.fromhex(cipher)<br><br><span class="hljs-comment"># 解密</span><br>plaintext = rc4_decrypt(key, ciphertext)<br><br><span class="hljs-comment"># 输出</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Plaintext:&quot;</span>, plaintext)<br><br></code></pre></td></tr></table></figure></li>
</ul>
<blockquote>
<p>flag：0xGame{ce5e5621-3d6b-4429-b72a-957abf353390}</p>
</blockquote>
<h2 id="Calamity-Fortune"><a href="#Calamity-Fortune" class="headerlink" title="Calamity_Fortune"></a>Calamity_Fortune</h2><blockquote>
<p><del>这题，哈哈，数据提取错了题目截止提交48分钟后我才发现这个问题解出flag😄🫠我永远都不会原谅我自己了😄哈哈哈哈</del></p>
<p>考点：函数重写、复杂加密算法逆向、动态调试绕过程序机制</p>
</blockquote>
<ul>
<li><p>附件程序双击运行会提示如图</p>
<p><img src="/../images/image-20251021220052848.png" alt="双击提示"></p>
<p>然而，随便输一个数字的话会闪退</p>
</li>
<li><p>程序用IDA打开，main函数反编译如下：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs C"><span class="hljs-type">int</span> __fastcall <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **argv, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **envp)</span><br>&#123;<br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v3; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">int</span> v4; <span class="hljs-comment">// ebx</span><br>  <span class="hljs-type">int</span> v5; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">int</span> v6; <span class="hljs-comment">// ecx</span><br>  __int64 v7; <span class="hljs-comment">// rbx</span><br>  <span class="hljs-type">char</span> v8; <span class="hljs-comment">// cl</span><br>  <span class="hljs-type">int</span> v10; <span class="hljs-comment">// [rsp+20h] [rbp-58h] BYREF</span><br>  <span class="hljs-type">char</span> v11[<span class="hljs-number">9</span>]; <span class="hljs-comment">// [rsp+27h] [rbp-51h] BYREF</span><br>  _QWORD v12[<span class="hljs-number">5</span>]; <span class="hljs-comment">// [rsp+30h] [rbp-48h]</span><br>  <span class="hljs-type">int</span> v13; <span class="hljs-comment">// [rsp+58h] [rbp-20h]</span><br>  __int16 v14; <span class="hljs-comment">// [rsp+5Ch] [rbp-1Ch]</span><br><br>  sub_401600(argc, argv, envp);<br>  SetConsoleOutputCP(<span class="hljs-number">0xFDE9u</span>);<br>  SetConsoleCP(<span class="hljs-number">0xFDE9u</span>);<br>  v3 = time64(<span class="hljs-number">0LL</span>);<br>  srand(v3);<br>  v10 = <span class="hljs-number">0</span>;<br>  v4 = rand();<br>  <span class="hljs-built_in">puts</span>(&amp;Buffer);<br>  v5 = <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;v10);<br>  v6 = <span class="hljs-number">1</span>;<br>  <span class="hljs-keyword">if</span> ( v5 == <span class="hljs-number">1</span> )<br>  &#123;<br>    <span class="hljs-keyword">if</span> ( v10 == v4 % <span class="hljs-number">100</span> + <span class="hljs-number">1</span> )<br>    &#123;<br>      MessageBoxA(<span class="hljs-number">0LL</span>, <span class="hljs-string">&quot;You guessed right! Is it really right?&quot;</span>, <span class="hljs-string">&quot;Result&quot;</span>, <span class="hljs-number">0</span>);<br>      <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>      v7 = <span class="hljs-number">0LL</span>;<br>      <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;You guessed it wrong!&quot;</span>);<br>      <span class="hljs-built_in">puts</span>(&amp;byte_405098);<br>      v12[<span class="hljs-number">0</span>] = <span class="hljs-number">0xD0F0C00002B1973L</span>L;<br>      v12[<span class="hljs-number">1</span>] = <span class="hljs-number">0x182B1A043E1F082BL</span>L;<br>      v12[<span class="hljs-number">2</span>] = <span class="hljs-number">0x151236080A0D071CL</span>L;<br>      v12[<span class="hljs-number">3</span>] = <span class="hljs-number">0xA150C0111330622L</span>L;<br>      v12[<span class="hljs-number">4</span>] = <span class="hljs-number">0xD2B190804073E26L</span>L;<br>      v13 = <span class="hljs-number">251992113</span>;<br>      v14 = <span class="hljs-number">5130</span>;<br>      <span class="hljs-built_in">strcpy</span>(v11, <span class="hljs-string">&quot;Calamity&quot;</span>);<br>      <span class="hljs-keyword">do</span><br>      &#123;<br>        v8 = *((_BYTE *)v12 + v7) ^ v11[v7 &amp; <span class="hljs-number">7</span>];<br>        ++v7;<br>        <span class="hljs-built_in">putchar</span>(v8);<br>      &#125;<br>      <span class="hljs-keyword">while</span> ( v7 != <span class="hljs-number">46</span> );<br>      <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">return</span> v6;<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>v12看着像密文，的确是密文，但不是flag的密文，因为它在输入错误的提示里。暂时没有发现flag检验函数，尝试先绕过数字检验</p>
<p>在汇编窗口找到数字判断语句（可以在反编译界面选中判断语句所在行，右键Jump to Disasm到达）</p>
<p><img src="/../images/image-20251021220816989.png" alt="判断语句的汇编"></p>
<p>可以看到这是一个jz，只需要在执行到这句但是还没步过时，修改ZF标志位即可绕过。在此处F2下断点，开始动调程序。随便输个数字，按回车</p>
<p><img src="/../images/image-20251021220921683.png" alt="随便输个数字"></p>
<p>此时程序停在jz处，即我们下断点的地方</p>
<p><img src="/../images/image-20251021221202643.png" alt="停在jz处"></p>
<p>在右上侧寄存器窗口找到ZF</p>
<p><img src="/../images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-10-21%20221235.png" alt="找到ZF"></p>
<p>双击ZF把它的值改成0x1</p>
<p><img src="/../images/image-20251021221613970.png" alt="修改ZF标志位"></p>
<p>可以看到jz语句处有一条箭头出来了</p>
<p><img src="/../images/image-20251021221637985.png" alt="绿色箭头"></p>
<p>F8执行jz跳转，跟踪程序执行流。可以看到程序运行到一个类似输出函数的地方</p>
<p><img src="/../images/image-20251021222114925.png" alt="类似输出函数的地方"></p>
<p>这时候，在这里多试几次会发现MessageBoxA可以步入。当然要是步过这个call MessageBoxA会发现程序没有弹出窗口，倒是终端输出了新的句子，十分可疑</p>
<p><img src="/../images/image-20251021222341398.png" alt="终端的新输出"></p>
<p>所以在程序执行到call cs:MessageBoxA这句的时候按F7步入，就会发现这个MessageBoxA别有洞天</p>
<p><img src="/../images/image-20251021222417932.png" alt="别有洞天"></p>
<p>这显然不像是MessageBoxA应该有的操作。可以看到一个可疑的地址被放到了rax里，跟踪这个jmp看看（jmp rax处F7步入）</p>
<p><img src="/../images/image-20251021222757420.png" alt="jmp后"></p>
<p>可以看到程序运行到了一个新函数，F5反编译，反编译代码如下（函数有多个模块的加密处理，还是很复杂的，以下是经过变量名优化的代码）</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br></pre></td><td class="code"><pre><code class="hljs C">__int64 <span class="hljs-title function_">realMain</span><span class="hljs-params">()</span><br>&#123;<br>  <span class="hljs-type">char</span> v0; <span class="hljs-comment">// dl</span><br>  <span class="hljs-type">char</span> *v1; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">char</span> v2; <span class="hljs-comment">// dl</span><br>  <span class="hljs-type">char</span> *i; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">int</span> v4; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">unsigned</span> __int8 *pFlag1; <span class="hljs-comment">// r9</span><br>  _BYTE *pFlag; <span class="hljs-comment">// rdx</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v7; <span class="hljs-comment">// esi</span><br>  <span class="hljs-type">char</span> v8; <span class="hljs-comment">// dl</span><br>  <span class="hljs-type">char</span> *j; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> *p_block0; <span class="hljs-comment">// r10</span><br>  <span class="hljs-type">unsigned</span> __int8 *current_1; <span class="hljs-comment">// rdx</span><br>  <span class="hljs-type">int</span> shift; <span class="hljs-comment">// ecx</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> temp_2; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> temp_1; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> cureent_block; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> delta; <span class="hljs-comment">// r11d</span><br>  <span class="hljs-type">int</span> key_value; <span class="hljs-comment">// ebp</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> prev_block; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> *block; <span class="hljs-comment">// r8</span><br>  <span class="hljs-type">int</span> rounds; <span class="hljs-comment">// ecx</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> next; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> oriDelta; <span class="hljs-comment">// ecx</span><br>  <span class="hljs-type">unsigned</span> __int8 *encrypted_bytes_1; <span class="hljs-comment">// r10</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> *v24; <span class="hljs-comment">// rdi</span><br>  _DWORD *v25; <span class="hljs-comment">// r8</span><br>  _DWORD *v26; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">int</span> shift_1; <span class="hljs-comment">// ecx</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v28; <span class="hljs-comment">// edx</span><br>  _BYTE *v29; <span class="hljs-comment">// r9</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v30; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">unsigned</span> __int64 k; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">char</span> v32; <span class="hljs-comment">// dl</span><br>  _BYTE *current1; <span class="hljs-comment">// rbx</span><br>  <span class="hljs-type">int</span> randNum; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> tmp; <span class="hljs-comment">// r8</span><br>  _BYTE *target; <span class="hljs-comment">// rdx</span><br>  <span class="hljs-type">unsigned</span> __int8 *v37; <span class="hljs-comment">// rdx</span><br>  <span class="hljs-type">unsigned</span> __int8 *end; <span class="hljs-comment">// rbx</span><br>  <span class="hljs-type">unsigned</span> __int8 *current; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">char</span> *v40; <span class="hljs-comment">// rcx</span><br>  <span class="hljs-type">int</span> m; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v42; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">char</span> n; <span class="hljs-comment">// dl</span><br>  <span class="hljs-type">char</span> v44; <span class="hljs-comment">// dl</span><br>  <span class="hljs-type">char</span> *ii; <span class="hljs-comment">// rax</span><br>  _QWORD key[<span class="hljs-number">2</span>]; <span class="hljs-comment">// [rsp+20h] [rbp-218h] BYREF</span><br>  <span class="hljs-type">char</span> notice2[<span class="hljs-number">22</span>]; <span class="hljs-comment">// [rsp+30h] [rbp-208h] BYREF</span><br>  __int16 v49; <span class="hljs-comment">// [rsp+46h] [rbp-1F2h] BYREF</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> block0; <span class="hljs-comment">// [rsp+50h] [rbp-1E8h] BYREF</span><br>  <span class="hljs-type">int</span> v51; <span class="hljs-comment">// [rsp+54h] [rbp-1E4h] BYREF</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> block10; <span class="hljs-comment">// [rsp+78h] [rbp-1C0h]</span><br>  _BYTE encrypted_bytes[<span class="hljs-number">44</span>]; <span class="hljs-comment">// [rsp+80h] [rbp-1B8h] BYREF</span><br>  <span class="hljs-type">int</span> v54; <span class="hljs-comment">// [rsp+ACh] [rbp-18Ch] BYREF</span><br>  _BYTE flag[<span class="hljs-number">44</span>]; <span class="hljs-comment">// [rsp+B0h] [rbp-188h] BYREF</span><br>  <span class="hljs-type">char</span> v56; <span class="hljs-comment">// [rsp+DCh] [rbp-15Ch] BYREF</span><br>  _QWORD enc[<span class="hljs-number">7</span>]; <span class="hljs-comment">// [rsp+E0h] [rbp-158h] BYREF</span><br>  <span class="hljs-type">int</span> v58; <span class="hljs-comment">// [rsp+118h] [rbp-120h]</span><br>  _BYTE base64_output[<span class="hljs-number">59</span>]; <span class="hljs-comment">// [rsp+120h] [rbp-118h] BYREF</span><br>  _BYTE end_1[<span class="hljs-number">5</span>]; <span class="hljs-comment">// [rsp+15Bh] [rbp-DDh] BYREF</span><br>  <span class="hljs-type">char</span> temp[<span class="hljs-number">64</span>]; <span class="hljs-comment">// [rsp+160h] [rbp-D8h] BYREF</span><br>  <span class="hljs-type">char</span> notice1[<span class="hljs-number">85</span>]; <span class="hljs-comment">// [rsp+1A0h] [rbp-98h] BYREF</span><br>  _BYTE v63[<span class="hljs-number">3</span>]; <span class="hljs-comment">// [rsp+1F5h] [rbp-43h] BYREF</span><br><br>  v0 = <span class="hljs-number">79</span>;<br>  enc[<span class="hljs-number">0</span>] = <span class="hljs-number">0x280D30732B077874L</span>L;<br>  enc[<span class="hljs-number">1</span>] = <span class="hljs-number">0x242D00103573060BL</span>L;<br>  enc[<span class="hljs-number">2</span>] = <span class="hljs-number">0x141C3406727D2F73L</span>L;<br>  enc[<span class="hljs-number">3</span>] = <span class="hljs-number">0xA71137676362833L</span>L;<br>  enc[<span class="hljs-number">4</span>] = <span class="hljs-number">0xE232B242F04742AL</span>L;<br>  enc[<span class="hljs-number">5</span>] = <span class="hljs-number">0x2F373F03033D7310L</span>L;<br>  enc[<span class="hljs-number">6</span>] = <span class="hljs-number">0x77067C3612772D7DL</span>L;<br>  qmemcpy(key, <span class="hljs-string">&quot;Calamity_Fortune&quot;</span>, <span class="hljs-keyword">sizeof</span>(key));<br>  qmemcpy(<br>    notice1,<br>    <span class="hljs-string">&quot;Ofqni`&#x27;jfcb&#x27;ns&#x27;sont&#x27;afu+&#x27;sob&#x27;tretbvrbis&#x27;bidu~wsnhi&#x27;tohrkc&#x27;eb&#x27;f&#x27;wnbdb&#x27;ha&#x27;dflb&#x27;ahu&#x27;~hry&quot;</span>,<br>    <span class="hljs-keyword">sizeof</span>(notice1));<br>  v1 = notice1;<br>  v58 = <span class="hljs-number">0x37233104</span>;<br>  <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>  &#123;<br>    *v1++ = v0 ^ <span class="hljs-number">7</span>;<br>    <span class="hljs-keyword">if</span> ( v63 == v1 )<br>      <span class="hljs-keyword">break</span>;<br>    v0 = *v1;<br>  &#125;<br>  <span class="hljs-built_in">puts</span>(notice1);                                <span class="hljs-comment">// Having made it this far,......</span><br>  v2 = <span class="hljs-number">87</span>;<br>  qmemcpy(notice2, <span class="hljs-string">&quot;Wkbftb&#x27;Niwrs&#x27;~hru&#x27;akf`&quot;</span>, <span class="hljs-keyword">sizeof</span>(notice2));<br>  <span class="hljs-keyword">for</span> ( i = notice2; ; v2 = *i )<br>  &#123;<br>    *i++ = v2 ^ <span class="hljs-number">7</span>;<br>    <span class="hljs-keyword">if</span> ( i == &amp;v49 )<br>      <span class="hljs-keyword">break</span>;<br>  &#125;<br>  <span class="hljs-built_in">puts</span>(notice2);                                <span class="hljs-comment">// Please input your flag</span><br>  <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%44s&quot;</span>, flag);<br>  v4 = flag[<span class="hljs-number">0</span>];<br>  v56 = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">if</span> ( !flag[<span class="hljs-number">0</span>] )<br>    <span class="hljs-keyword">goto</span> LABEL_11;<br>  pFlag1 = flag;<br>  pFlag = flag;<br>  <span class="hljs-keyword">do</span><br>    v7 = <span class="hljs-number">1</span> - flag + pFlag++;<br>  <span class="hljs-keyword">while</span> ( *pFlag );<br>  <span class="hljs-keyword">if</span> ( v7 != <span class="hljs-number">44</span> )<br>  &#123;<br>LABEL_11:                                       <span class="hljs-comment">// 错误时的输出</span><br>    v8 = <span class="hljs-number">75</span>;<br>    qmemcpy(temp, <span class="hljs-string">&quot;Kbi`so&#x27;Buuhu&amp;&quot;</span>, <span class="hljs-number">13</span>);<br>    <span class="hljs-keyword">for</span> ( j = temp; ; v8 = *j )<br>    &#123;<br>      *j++ = v8 ^ <span class="hljs-number">7</span>;<br>      <span class="hljs-keyword">if</span> ( &amp;temp[<span class="hljs-number">13</span>] == j )<br>        <span class="hljs-keyword">break</span>;<br>    &#125;<br>    <span class="hljs-built_in">puts</span>(temp);                                 <span class="hljs-comment">// 错误时的输出</span><br>    <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>  &#125;<br>  p_block0 = &amp;block0;<br>  <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )                                   <span class="hljs-comment">// bytesToBlock，转成uint32_t</span><br>  &#123;<br>    current_1 = pFlag1;<br>    shift = <span class="hljs-number">0</span>;<br>    temp_2 = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>    &#123;<br>      temp_1 = v4 &lt;&lt; shift;<br>      shift += <span class="hljs-number">8</span>;<br>      ++current_1;<br>      temp_2 |= temp_1;<br>      <span class="hljs-keyword">if</span> ( shift == <span class="hljs-number">32</span> )<br>        <span class="hljs-keyword">break</span>;<br>      v4 = *current_1;<br>    &#125;<br>    pFlag1 += <span class="hljs-number">4</span>;<br>    *p_block0++ = temp_2;<br>    <span class="hljs-keyword">if</span> ( &amp;v56 == pFlag1 )<br>      <span class="hljs-keyword">break</span>;<br>    v4 = *pFlag1;<br>  &#125;<br>  cureent_block = block10;<br>  delta = <span class="hljs-number">0x9E3779B9</span>;<br>  key_value = <span class="hljs-number">0x616C6143</span>;<br>  prev_block = block0;<br>  <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )                                   <span class="hljs-comment">// xxtea</span><br>  &#123;<br>    block = &amp;block0;<br>    <span class="hljs-keyword">for</span> ( rounds = <span class="hljs-number">0</span>; ; ++rounds )<br>    &#123;<br>      next = block[<span class="hljs-number">1</span>];<br>      ++block;<br>      cureent_block = prev_block<br>                    + (((cureent_block ^ *(key + (((delta &gt;&gt; <span class="hljs-number">2</span>) ^ rounds) &amp; <span class="hljs-number">3</span>))) + (next ^ delta)) ^ (((<span class="hljs-number">4</span> * next) ^ (cureent_block &gt;&gt; <span class="hljs-number">5</span>)) + ((<span class="hljs-number">16</span> * cureent_block) ^ (next &gt;&gt; <span class="hljs-number">3</span>))));<br>      *(block - <span class="hljs-number">1</span>) = cureent_block;<br>      <span class="hljs-keyword">if</span> ( rounds == <span class="hljs-number">9</span> )<br>        <span class="hljs-keyword">break</span>;<br>      prev_block = *block;<br>    &#125;<br>    prev_block = block0;<br>    oriDelta = delta;<br>    delta -= <span class="hljs-number">0x61C88647</span>;<br>    cureent_block = block10<br>                  + ((((cureent_block &gt;&gt; <span class="hljs-number">5</span>) ^ (<span class="hljs-number">4</span> * block0)) + ((<span class="hljs-number">16</span> * cureent_block) ^ (block0 &gt;&gt; <span class="hljs-number">3</span>))) ^ ((block0 ^ oriDelta) + (key_value ^ cureent_block)));<br>    block10 = cureent_block;<br>    <span class="hljs-keyword">if</span> ( delta == <span class="hljs-number">0xCC623AF3</span> )<br>      <span class="hljs-keyword">break</span>;<br>    key_value = *(key + (((delta &gt;&gt; <span class="hljs-number">2</span>) ^ <span class="hljs-number">0xA</span>) &amp; <span class="hljs-number">3</span>));<br>  &#125;<br>  encrypted_bytes_1 = encrypted_bytes;<br>  v24 = &amp;v51;                                   <span class="hljs-comment">// blockToBytes，uint32_t转成bytes</span><br>  v25 = encrypted_bytes;<br>  <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>  &#123;<br>    v26 = v25;<br>    <span class="hljs-keyword">for</span> ( shift_1 = <span class="hljs-number">0</span>; shift_1 != <span class="hljs-number">32</span>; shift_1 += <span class="hljs-number">8</span> )<br>    &#123;<br>      v26 = (v26 + <span class="hljs-number">1</span>);<br>      v28 = prev_block &gt;&gt; shift_1;<br>      *(v26 - <span class="hljs-number">1</span>) = v28;<br>    &#125;<br>    <span class="hljs-keyword">if</span> ( &amp;v54 == ++v25 )<br>      <span class="hljs-keyword">break</span>;<br>    prev_block = *v24++;<br>  &#125;<br>  qmemcpy(temp, <span class="hljs-string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span>, <span class="hljs-keyword">sizeof</span>(temp));<br>  v29 = base64_output;<br>  <span class="hljs-keyword">do</span>                                            <span class="hljs-comment">// base64encode</span><br>  &#123;<br>    v30 = *encrypted_bytes_1 &lt;&lt; <span class="hljs-number">16</span>;<br>    <span class="hljs-keyword">if</span> ( v7 != <span class="hljs-number">1</span> )<br>    &#123;<br>      v30 |= encrypted_bytes_1[<span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">8</span>;<br>      <span class="hljs-keyword">if</span> ( v7 &gt; <span class="hljs-number">2</span> )<br>        v30 |= encrypted_bytes_1[<span class="hljs-number">2</span>];<br>    &#125;<br>    <span class="hljs-keyword">for</span> ( k = <span class="hljs-number">0LL</span>; k != <span class="hljs-number">4</span>; ++k )<br>    &#123;<br>      v32 = <span class="hljs-number">61</span>;<br>      <span class="hljs-keyword">if</span> ( k &lt;= v7 )<br>        v32 = temp[(v30 &gt;&gt; (<span class="hljs-number">-6</span> * k + <span class="hljs-number">18</span>)) &amp; <span class="hljs-number">0x3F</span>];<br>      v29[k] = v32;<br>    &#125;<br>    encrypted_bytes_1 += <span class="hljs-number">3</span>;<br>    v29 += <span class="hljs-number">4</span>;<br>    v7 -= <span class="hljs-number">3</span>;<br>  &#125;<br>  <span class="hljs-keyword">while</span> ( (&amp;v54 + <span class="hljs-number">1</span>) != encrypted_bytes_1 );<br>  current1 = end_1;<br>  end_1[<span class="hljs-number">1</span>] = <span class="hljs-number">0</span>;<br>  srand(<span class="hljs-number">0x65u</span>);                                 <span class="hljs-comment">// shuffle</span><br>  <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>  &#123;<br>    randNum = rand();<br>    tmp = *current1;<br>    target = &amp;base64_output[randNum % (<span class="hljs-number">60</span> - end_1 + current1)];<br>    *current1 = *target;<br>    *target = tmp;<br>    v37 = current1 - <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">if</span> ( base64_output == current1 - <span class="hljs-number">1</span> )<br>      <span class="hljs-keyword">break</span>;<br>    --current1;<br>  &#125;<br>  end = current1 + <span class="hljs-number">59</span>;<br>  current = v37;<br>  <span class="hljs-keyword">do</span>                                            <span class="hljs-comment">// xor</span><br>    *current++ ^= <span class="hljs-number">0x45u</span>;<br>  <span class="hljs-keyword">while</span> ( end != current );<br>  v40 = enc + <span class="hljs-number">1</span>;<br>  <span class="hljs-keyword">for</span> ( m = <span class="hljs-number">116</span>; ; m = *v40++ )<br>  &#123;<br>    <span class="hljs-keyword">if</span> ( *v37 != m )                            <span class="hljs-comment">// 错误处理的输出</span><br>    &#123;<br>      qmemcpy(temp, <span class="hljs-string">&quot;Dfkfjns~&amp;&#x27;wkbftb&#x27;su~&#x27;f`fni&quot;</span>, <span class="hljs-number">26</span>);<br>      v42 = temp;<br>      <span class="hljs-keyword">for</span> ( n = <span class="hljs-number">68</span>; ; n = *v42 )<br>      &#123;<br>        *v42++ = n ^ <span class="hljs-number">7</span>;<br>        <span class="hljs-keyword">if</span> ( &amp;temp[<span class="hljs-number">26</span>] == v42 )<br>          <span class="hljs-keyword">break</span>;<br>      &#125;<br>      <span class="hljs-built_in">puts</span>(temp);<br>      <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>    &#125;                                           <span class="hljs-comment">// 错误处理的输出</span><br>    <span class="hljs-keyword">if</span> ( end == ++v37 )<br>      <span class="hljs-keyword">break</span>;<br>  &#125;<br>  v44 = <span class="hljs-number">65</span>;<br>  qmemcpy(temp, <span class="hljs-string">&quot;Ahusrib&amp;@hhc&#x27;Krdl&amp;&quot;</span>, <span class="hljs-number">18</span>);<br>  <span class="hljs-keyword">for</span> ( ii = temp; ; v44 = *ii )<br>  &#123;<br>    *ii++ = v44 ^ <span class="hljs-number">7</span>;<br>    <span class="hljs-keyword">if</span> ( &amp;temp[<span class="hljs-number">18</span>] == ii )<br>      <span class="hljs-keyword">break</span>;<br>  &#125;<br>  <span class="hljs-built_in">puts</span>(temp);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">1LL</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>函数出现在程序输入flag的提示之后，应该就是flag检验函数了。函数使用了很多加密手段，甚至连提示词都是实时解密的。可以看到对输入的flag依次进行了格式转换、魔改XXTEA加密、格式转换、base64编码、shuffle洗牌算法打乱、异或处理，最后才和预设的密文进行比较检验。</p>
<p>这里给出一个AI复现的、经过测试等价的脚本，方便理解这个复杂的算法（被函数改写整怕了，所以随机数生成算法也复现了）：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><code class="hljs C"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span><br><br><span class="hljs-comment">// MSVC-compatible rand</span><br><span class="hljs-type">static</span> <span class="hljs-type">uint32_t</span> rand_seed;<br><span class="hljs-type">void</span> <span class="hljs-title function_">custom_srand</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> seed)</span> &#123; rand_seed = seed; &#125;<br><span class="hljs-type">uint32_t</span> <span class="hljs-title function_">custom_rand</span><span class="hljs-params">()</span> &#123;<br>    rand_seed = rand_seed * <span class="hljs-number">214013</span> + <span class="hljs-number">2531011</span>;<br>    <span class="hljs-keyword">return</span> (rand_seed &gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0x7FFF</span>;<br>&#125;<br><br><span class="hljs-comment">// XXTEA encryption (as in realMain)</span><br><span class="hljs-type">void</span> <span class="hljs-title function_">encrypt_xxtea_variant</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> block[<span class="hljs-number">11</span>], <span class="hljs-type">const</span> <span class="hljs-type">uint32_t</span> key[<span class="hljs-number">4</span>])</span> &#123;<br>    <span class="hljs-type">uint32_t</span> cureent_block = block[<span class="hljs-number">10</span>];<br>    <span class="hljs-type">uint32_t</span> delta = <span class="hljs-number">0x9E3779B9U</span>;<br>    <span class="hljs-type">uint32_t</span> key_value = <span class="hljs-number">0x616C6143U</span>; <span class="hljs-comment">// 初始值，但第一轮内循环不用它</span><br>    <span class="hljs-type">uint32_t</span> prev_block = block[<span class="hljs-number">0</span>];<br><br>    <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>) &#123;<br>        <span class="hljs-type">uint32_t</span>* bptr = &amp;block[<span class="hljs-number">0</span>];<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> rounds = <span class="hljs-number">0</span>; ; ++rounds) &#123;<br>            <span class="hljs-type">uint32_t</span> next = bptr[<span class="hljs-number">1</span>];<br>            ++bptr;<br>            <span class="hljs-type">uint32_t</span> k = key[((delta &gt;&gt; <span class="hljs-number">2</span>) ^ rounds) &amp; <span class="hljs-number">3</span>];<br>            <span class="hljs-type">uint32_t</span> term1 = (cureent_block ^ k) + (next ^ delta);<br>            <span class="hljs-type">uint32_t</span> term2 = (<span class="hljs-number">4</span> * next ^ (cureent_block &gt;&gt; <span class="hljs-number">5</span>)) + (<span class="hljs-number">16</span> * cureent_block ^ (next &gt;&gt; <span class="hljs-number">3</span>));<br>            cureent_block = prev_block + (term1 ^ term2);<br>            *(bptr - <span class="hljs-number">1</span>) = cureent_block;<br>            <span class="hljs-keyword">if</span> (rounds == <span class="hljs-number">9</span>) <span class="hljs-keyword">break</span>;<br>            prev_block = *bptr; <span class="hljs-comment">// 此时 *bptr 尚未被修改（是原始值）</span><br>        &#125;<br><br>        prev_block = block[<span class="hljs-number">0</span>];<br>        <span class="hljs-type">uint32_t</span> oriDelta = delta;<br>        delta -= <span class="hljs-number">0x61C88647U</span>;<br>        key_value = key[((oriDelta &gt;&gt; <span class="hljs-number">2</span>) ^ <span class="hljs-number">0xA</span>) &amp; <span class="hljs-number">3</span>];<br>        <span class="hljs-type">uint32_t</span> term1 = ((cureent_block &gt;&gt; <span class="hljs-number">5</span>) ^ (<span class="hljs-number">4</span> * block[<span class="hljs-number">0</span>])) + ((<span class="hljs-number">16</span> * cureent_block) ^ (block[<span class="hljs-number">0</span>] &gt;&gt; <span class="hljs-number">3</span>));<br>        <span class="hljs-type">uint32_t</span> term2 = (block[<span class="hljs-number">0</span>] ^ oriDelta) + (key_value ^ cureent_block);<br>        cureent_block = block[<span class="hljs-number">10</span>] + (term1 ^ term2);<br>        block[<span class="hljs-number">10</span>] = cureent_block;<br><br>        <span class="hljs-keyword">if</span> (delta == <span class="hljs-number">0xCC623AF3U</span>) <span class="hljs-keyword">break</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// Base64 encode 44 bytes -&gt; 60 chars</span><br><span class="hljs-type">void</span> <span class="hljs-title function_">base64_encode</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">uint8_t</span>* input, <span class="hljs-type">char</span>* output)</span> &#123;<br>    <span class="hljs-type">const</span> <span class="hljs-type">char</span>* table = <span class="hljs-string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">44</span>; i += <span class="hljs-number">3</span>) &#123;<br>        <span class="hljs-type">uint32_t</span> val = (input[i] &lt;&lt; <span class="hljs-number">16</span>) |<br>            ((i + <span class="hljs-number">1</span> &lt; <span class="hljs-number">44</span> ? input[i + <span class="hljs-number">1</span>] : <span class="hljs-number">0</span>) &lt;&lt; <span class="hljs-number">8</span>) |<br>            ((i + <span class="hljs-number">2</span> &lt; <span class="hljs-number">44</span> ? input[i + <span class="hljs-number">2</span>] : <span class="hljs-number">0</span>));<br>        output[<span class="hljs-number">0</span>] = table[(val &gt;&gt; <span class="hljs-number">18</span>) &amp; <span class="hljs-number">0x3F</span>];<br>        output[<span class="hljs-number">1</span>] = table[(val &gt;&gt; <span class="hljs-number">12</span>) &amp; <span class="hljs-number">0x3F</span>];<br>        output[<span class="hljs-number">2</span>] = (i + <span class="hljs-number">1</span> &lt; <span class="hljs-number">44</span>) ? table[(val &gt;&gt; <span class="hljs-number">6</span>) &amp; <span class="hljs-number">0x3F</span>] : <span class="hljs-string">&#x27;=&#x27;</span>;<br>        output[<span class="hljs-number">3</span>] = (i + <span class="hljs-number">2</span> &lt; <span class="hljs-number">44</span>) ? table[val &amp; <span class="hljs-number">0x3F</span>] : <span class="hljs-string">&#x27;=&#x27;</span>;<br>        output += <span class="hljs-number">4</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-comment">// Step 1: Input flag</span><br>    <span class="hljs-type">char</span> flag[<span class="hljs-number">45</span>] = <span class="hljs-string">&quot;0xGame&#123;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&#125;&quot;</span>;<span class="hljs-comment">//测试样例</span><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Input flag: %s\n&quot;</span>, flag);<br><br>    <span class="hljs-comment">// Step 2: Convert to 11 uint32_t (little-endian)</span><br>    <span class="hljs-type">uint32_t</span> blocks[<span class="hljs-number">11</span>];<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">11</span>; i++) &#123;<br>        blocks[i] = (<span class="hljs-type">uint8_t</span>)flag[i * <span class="hljs-number">4</span>] |<br>            ((<span class="hljs-type">uint8_t</span>)flag[i * <span class="hljs-number">4</span> + <span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">8</span>) |<br>            ((<span class="hljs-type">uint8_t</span>)flag[i * <span class="hljs-number">4</span> + <span class="hljs-number">2</span>] &lt;&lt; <span class="hljs-number">16</span>) |<br>            ((<span class="hljs-type">uint8_t</span>)flag[i * <span class="hljs-number">4</span> + <span class="hljs-number">3</span>] &lt;&lt; <span class="hljs-number">24</span>);<br>    &#125;<br><br>    <span class="hljs-comment">// Step 3: XXTEA encrypt</span><br>    <span class="hljs-type">uint32_t</span> key[<span class="hljs-number">4</span>] = &#123;<br>        <span class="hljs-number">0x616C6143</span>, <span class="hljs-comment">// &#x27;C&#x27;,&#x27;a&#x27;,&#x27;l&#x27;,&#x27;a&#x27;</span><br>        <span class="hljs-number">0x7974696D</span>, <span class="hljs-comment">// &#x27;m&#x27;,&#x27;i&#x27;,&#x27;t&#x27;,&#x27;y&#x27;</span><br>        <span class="hljs-number">0x726F465F</span>, <span class="hljs-comment">// &#x27;_&#x27;,&#x27;F&#x27;,&#x27;o&#x27;,&#x27;r&#x27;</span><br>        <span class="hljs-number">0x656E7574</span>  <span class="hljs-comment">// &#x27;t&#x27;,&#x27;u&#x27;,&#x27;n&#x27;,&#x27;e&#x27;</span><br>    &#125;;<br>    encrypt_xxtea_variant(blocks, key);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;TEA encrypted blocks (hex, little-endian order):\n&quot;</span>);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">11</span>; i++) &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%08x\n&quot;</span>, blocks[i]);<br>    &#125;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n&quot;</span>);<br>    <span class="hljs-comment">// Step 4: Convert back to bytes (little-endian)</span><br>    <span class="hljs-type">uint8_t</span> encrypted_bytes[<span class="hljs-number">44</span>];<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">11</span>; i++) &#123;<br>        encrypted_bytes[i * <span class="hljs-number">4</span>] = blocks[i] &amp; <span class="hljs-number">0xFF</span>;<br>        encrypted_bytes[i * <span class="hljs-number">4</span> + <span class="hljs-number">1</span>] = (blocks[i] &gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xFF</span>;<br>        encrypted_bytes[i * <span class="hljs-number">4</span> + <span class="hljs-number">2</span>] = (blocks[i] &gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xFF</span>;<br>        encrypted_bytes[i * <span class="hljs-number">4</span> + <span class="hljs-number">3</span>] = (blocks[i] &gt;&gt; <span class="hljs-number">24</span>) &amp; <span class="hljs-number">0xFF</span>;<br>    &#125;<br><br>    <span class="hljs-comment">// Step 5: Base64 encode</span><br>    <span class="hljs-type">char</span> base64_str[<span class="hljs-number">61</span>] = &#123; <span class="hljs-number">0</span> &#125;;<br>    base64_encode(encrypted_bytes, base64_str);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Base64: %s\n&quot;</span>, base64_str);<br><br>    <span class="hljs-comment">// Step 6: Shuffle (Fisher-Yates, i=59 downto 1)</span><br>    custom_srand(<span class="hljs-number">0x65</span>);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">59</span>; i &gt;= <span class="hljs-number">1</span>; i--) &#123;<br>        <span class="hljs-type">int</span> j = custom_rand() % (i + <span class="hljs-number">1</span>);<br>        <span class="hljs-comment">// Swap base64_str[i] and base64_str[j]</span><br>        <span class="hljs-type">char</span> tmp = base64_str[i];<br>        base64_str[i] = base64_str[j];<br>        base64_str[j] = tmp;<br>    &#125;<br><br>    <span class="hljs-comment">// Output shuffled result (before XOR)</span><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;After shuffle (before XOR): %s\n&quot;</span>, base64_str);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Hex dump:\n&quot;</span>);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">60</span>; i++) &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%02x &quot;</span>, (<span class="hljs-type">uint8_t</span>)base64_str[i]);<br>        <span class="hljs-keyword">if</span> ((i + <span class="hljs-number">1</span>) % <span class="hljs-number">16</span> == <span class="hljs-number">0</span>) <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-number">60</span> % <span class="hljs-number">16</span> != <span class="hljs-number">0</span>) <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n&quot;</span>);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n&quot;</span>);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">60</span>; i++) &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%02x &quot;</span>, (<span class="hljs-type">uint8_t</span>)base64_str[i] ^ <span class="hljs-number">0x45</span>);<br>    &#125;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>解密思路：异或模块直接一模一样地重复一遍即可；shuffle模块可以先从加密算法获得随机数序列，这样方便从后往前索引还原；剩下的看脚本吧🫠（对了，要注意enc数据要从栈上提取，笔者让AI从反编译的代码里提取，肉眼检验没发现bytes截取错了，浪费了好多时间）</p>
</li>
<li><p>解密脚本：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br></pre></td><td class="code"><pre><code class="hljs C"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span><br><br><span class="hljs-comment">// ========== 你提供的解密函数 ==========</span><br><span class="hljs-type">void</span> <span class="hljs-title function_">decrypt_xxtea_variant</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> block[<span class="hljs-number">11</span>], <span class="hljs-type">const</span> <span class="hljs-type">uint32_t</span> key[<span class="hljs-number">4</span>])</span> &#123;<br>    <span class="hljs-type">const</span> <span class="hljs-type">int</span> TOTAL_ROUNDS = <span class="hljs-number">10</span>;<br>    <span class="hljs-type">uint32_t</span> delta = <span class="hljs-number">0xCC623AF3U</span>;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> round = <span class="hljs-number">0</span>; round &lt; TOTAL_ROUNDS; round++) &#123;<br>        <span class="hljs-type">uint32_t</span> oriDelta = delta + <span class="hljs-number">0x61C88647U</span>;<br>        <span class="hljs-type">uint32_t</span> key_value = key[((oriDelta &gt;&gt; <span class="hljs-number">2</span>) ^ <span class="hljs-number">0xA</span>) &amp; <span class="hljs-number">3</span>];<br><br>        <span class="hljs-type">uint32_t</span> C9 = block[<span class="hljs-number">9</span>];<br>        <span class="hljs-type">uint32_t</span> C0 = block[<span class="hljs-number">0</span>];<br>        <span class="hljs-type">uint32_t</span> term1 = ((C9 &gt;&gt; <span class="hljs-number">5</span>) ^ (<span class="hljs-number">4</span> * C0)) + ((<span class="hljs-number">16</span> * C9) ^ (C0 &gt;&gt; <span class="hljs-number">3</span>));<br>        <span class="hljs-type">uint32_t</span> term2 = (C0 ^ oriDelta) + (key_value ^ C9);<br>        <span class="hljs-type">uint32_t</span> G = term1 ^ term2;<br>        <span class="hljs-type">uint32_t</span> original_block10 = block[<span class="hljs-number">10</span>] - G;<br><br>        <span class="hljs-type">uint32_t</span> saved_block10 = original_block10;<br><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">9</span>; i &gt;= <span class="hljs-number">0</span>; i--) &#123;<br>            <span class="hljs-type">uint32_t</span> next = (i == <span class="hljs-number">9</span>) ? saved_block10 : block[i + <span class="hljs-number">1</span>];<br>            <span class="hljs-type">uint32_t</span> prev_C = (i == <span class="hljs-number">0</span>) ? saved_block10 : block[i - <span class="hljs-number">1</span>];<br><br>            <span class="hljs-type">uint32_t</span> k = key[((oriDelta &gt;&gt; <span class="hljs-number">2</span>) ^ i) &amp; <span class="hljs-number">3</span>];<br>            <span class="hljs-type">uint32_t</span> part1 = (prev_C ^ k) + (next ^ oriDelta);<br>            <span class="hljs-type">uint32_t</span> part2 = (<span class="hljs-number">4</span> * next ^ (prev_C &gt;&gt; <span class="hljs-number">5</span>)) + (<span class="hljs-number">16</span> * prev_C ^ (next &gt;&gt; <span class="hljs-number">3</span>));<br>            <span class="hljs-type">uint32_t</span> H = part1 ^ part2;<br><br>            block[i] = block[i] - H;<br>        &#125;<br><br>        block[<span class="hljs-number">10</span>] = original_block10;<br>        delta += <span class="hljs-number">0x61C88647U</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-type">const</span> <span class="hljs-type">char</span>* table = <span class="hljs-string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span>;<br><span class="hljs-type">int</span> <span class="hljs-title function_">base64_decode</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span>* input, <span class="hljs-type">uint8_t</span>* output)</span> &#123;<br>    <span class="hljs-type">int</span> out_len = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">60</span>; i += <span class="hljs-number">4</span>) &#123;<br>        <span class="hljs-type">uint32_t</span> val = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">4</span>; j++) &#123;<br>            <span class="hljs-type">const</span> <span class="hljs-type">char</span>* p = <span class="hljs-built_in">strchr</span>(table, input[i + j]);<br>            <span class="hljs-keyword">if</span> (p) val = (val &lt;&lt; <span class="hljs-number">6</span>) | (p - table);<br>            <span class="hljs-keyword">else</span> val &lt;&lt;= <span class="hljs-number">6</span>;<br>        &#125;<br>        output[out_len++] = (val &gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xFF</span>;<br>        <span class="hljs-keyword">if</span> (input[i + <span class="hljs-number">2</span>] != <span class="hljs-string">&#x27;=&#x27;</span>) output[out_len++] = (val &gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xFF</span>;<br>        <span class="hljs-keyword">if</span> (input[i + <span class="hljs-number">3</span>] != <span class="hljs-string">&#x27;=&#x27;</span>) output[out_len++] = val &amp; <span class="hljs-number">0xFF</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> out_len;<br>&#125;<br><br><span class="hljs-type">void</span> <span class="hljs-title function_">deshuffle</span><span class="hljs-params">(<span class="hljs-type">char</span>* cipher, <span class="hljs-type">uint32_t</span>* rand_seq)</span> &#123;<br>    <span class="hljs-comment">// 逆序遍历：t 从 58 到 0</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> t = <span class="hljs-number">58</span>; t &gt;= <span class="hljs-number">0</span>; t--) &#123;<br>        <span class="hljs-type">int</span> i = <span class="hljs-number">59</span> - t;          <span class="hljs-comment">// 加密时的 i</span><br>        <span class="hljs-type">int</span> j = rand_seq[t];     <span class="hljs-comment">// 加密时的 j</span><br>        <span class="hljs-comment">// 再次交换 cipher[i] 和 cipher[j]</span><br>        <span class="hljs-type">char</span> temp = cipher[i];<br>        cipher[i] = cipher[j];<br>        cipher[j] = temp;<br>    &#125;<br>&#125;<br><span class="hljs-comment">// ========== 主程序 ==========</span><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-comment">// Step 1: 使用你提供的 60 字节目标密文</span><br>    <span class="hljs-type">uint8_t</span> encrypted_target_bytes[<span class="hljs-number">60</span>] = &#123;<br>        <span class="hljs-number">0x74</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x28</span>,<br>        <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0x24</span>,<br>        <span class="hljs-number">0x73</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0x14</span>,<br>        <span class="hljs-number">0x33</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x0A</span>,<br>        <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x4</span>, <span class="hljs-number">0x2f</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x2b</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0xe</span>,<br>        <span class="hljs-number">0x10</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x2F</span>,<br>        <span class="hljs-number">0x7D</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x77</span>,<br>        <span class="hljs-number">0x04</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x37</span><br>    &#125;;<br><br>    <span class="hljs-comment">// Step 2: XOR 0x45 得到 shuffled base64 字符串</span><br>    <span class="hljs-type">char</span> shuffled_b64[<span class="hljs-number">60</span>] = &#123; <span class="hljs-number">0</span> &#125;;<br>    <span class="hljs-comment">//printf(&quot;step1: xor\n&quot;);</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">60</span>; i++) &#123;<br>        shuffled_b64[i] = encrypted_target_bytes[i] ^ <span class="hljs-number">0x45</span>;<br>        <span class="hljs-comment">//printf(&quot;%c&quot;, shuffled_b64[i]);</span><br>    &#125;<br>    <span class="hljs-comment">//printf(&quot;\nstep2: deshuffle\n&quot;);</span><br>    <span class="hljs-comment">// Step 3: 使用你提供的 rand() 序列（原始值，未取模）</span><br>    <span class="hljs-type">uint32_t</span> rand_seq[<span class="hljs-number">59</span>] = &#123;<br>        <span class="hljs-number">8</span>, <span class="hljs-number">46</span>, <span class="hljs-number">21</span>, <span class="hljs-number">19</span>, <span class="hljs-number">35</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">7</span>, <span class="hljs-number">37</span>, <span class="hljs-number">17</span>,<br>        <span class="hljs-number">33</span>, <span class="hljs-number">13</span>, <span class="hljs-number">17</span>, <span class="hljs-number">10</span>, <span class="hljs-number">34</span>, <span class="hljs-number">34</span>, <span class="hljs-number">6</span>, <span class="hljs-number">20</span>, <span class="hljs-number">35</span>, <span class="hljs-number">10</span>,<br>        <span class="hljs-number">22</span>, <span class="hljs-number">21</span>, <span class="hljs-number">7</span>, <span class="hljs-number">16</span>, <span class="hljs-number">6</span>, <span class="hljs-number">18</span>, <span class="hljs-number">30</span>, <span class="hljs-number">32</span>, <span class="hljs-number">6</span>, <span class="hljs-number">2</span>,<br>        <span class="hljs-number">9</span>, <span class="hljs-number">0</span>, <span class="hljs-number">7</span>, <span class="hljs-number">4</span>, <span class="hljs-number">23</span>, <span class="hljs-number">18</span>, <span class="hljs-number">18</span>, <span class="hljs-number">16</span>, <span class="hljs-number">15</span>, <span class="hljs-number">15</span>,<br>        <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">16</span>, <span class="hljs-number">3</span>, <span class="hljs-number">13</span>, <span class="hljs-number">13</span>, <span class="hljs-number">9</span>, <span class="hljs-number">2</span>, <span class="hljs-number">11</span>, <span class="hljs-number">10</span>,<br>        <span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">0</span>, <span class="hljs-number">3</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span><br>    &#125;;<br>    deshuffle(shuffled_b64, rand_seq);<br>    <span class="hljs-comment">//for (int i = 0; i &lt; 60; i++) &#123;</span><br>        <span class="hljs-comment">//printf(&quot;%c&quot;, shuffled_b64[i]);</span><br>    <span class="hljs-comment">//&#125;</span><br>    <span class="hljs-type">char</span> original_b64[<span class="hljs-number">61</span>] = &#123; <span class="hljs-number">0</span> &#125;;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">60</span>; i++) &#123;<br>        original_b64[i] = shuffled_b64[i];<br>    &#125;<br>    original_b64[<span class="hljs-number">60</span>] = <span class="hljs-string">&#x27;\0&#x27;</span>;<br>    <span class="hljs-comment">//printf(&quot;\n&quot;);</span><br><br>    <span class="hljs-comment">// Step 4: Base64 解码</span><br>    <span class="hljs-type">uint8_t</span> encrypted_bytes[<span class="hljs-number">44</span>];<br>    <span class="hljs-type">int</span> decoded_len = base64_decode(original_b64, encrypted_bytes);<br>    <span class="hljs-keyword">if</span> (decoded_len != <span class="hljs-number">44</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>    &#125;<br><br>    <span class="hljs-comment">// Step 5: 重组为 11 个 uint32_t（小端序）</span><br>    <span class="hljs-type">uint32_t</span> block[<span class="hljs-number">11</span>];<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">11</span>; i++) &#123;<br>        block[i] = ((<span class="hljs-type">uint32_t</span>)encrypted_bytes[i * <span class="hljs-number">4</span> + <span class="hljs-number">0</span>] &lt;&lt; <span class="hljs-number">0</span>) |<br>            ((<span class="hljs-type">uint32_t</span>)encrypted_bytes[i * <span class="hljs-number">4</span> + <span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">8</span>) |<br>            ((<span class="hljs-type">uint32_t</span>)encrypted_bytes[i * <span class="hljs-number">4</span> + <span class="hljs-number">2</span>] &lt;&lt; <span class="hljs-number">16</span>) |<br>            ((<span class="hljs-type">uint32_t</span>)encrypted_bytes[i * <span class="hljs-number">4</span> + <span class="hljs-number">3</span>] &lt;&lt; <span class="hljs-number">24</span>);<br>    &#125;<br><br>    <span class="hljs-comment">// Step 6: 设置密钥 &quot;Calamity_Fortune&quot;（16 字节）</span><br>    <span class="hljs-type">uint32_t</span> key[<span class="hljs-number">4</span>] = &#123;<br>        <span class="hljs-number">0x616C6143U</span>,<br>        <span class="hljs-number">0x7974696DU</span>,<br>        <span class="hljs-number">0x726F465FU</span>,<br>        <span class="hljs-number">0x656E7574U</span><br>    &#125;;<br><br>    <span class="hljs-comment">// Step 7: 调用你提供的解密函数</span><br>    decrypt_xxtea_variant(block, key);<br><br>    <span class="hljs-comment">// Step 8: 转回 flag 字符串（小端）</span><br>    <span class="hljs-type">char</span> flag[<span class="hljs-number">45</span>] = &#123; <span class="hljs-number">0</span> &#125;;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">11</span>; i++) &#123;<br>        flag[i * <span class="hljs-number">4</span> + <span class="hljs-number">0</span>] = (block[i] &gt;&gt; <span class="hljs-number">0</span>) &amp; <span class="hljs-number">0xFF</span>;<br>        flag[i * <span class="hljs-number">4</span> + <span class="hljs-number">1</span>] = (block[i] &gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xFF</span>;<br>        flag[i * <span class="hljs-number">4</span> + <span class="hljs-number">2</span>] = (block[i] &gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xFF</span>;<br>        flag[i * <span class="hljs-number">4</span> + <span class="hljs-number">3</span>] = (block[i] &gt;&gt; <span class="hljs-number">24</span>) &amp; <span class="hljs-number">0xFF</span>;<br>    &#125;<br><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Flag: %s\n&quot;</span>, flag);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<blockquote>
<p>flag：0xGame{f279c1e7-8b0d-4a3b-9c6f-5e4d2a1b0c89}</p>
</blockquote>
</div><div class="article-licensing box"><div class="licensing-title"><p>0xGame2025Week3WriteUp</p><p><a href="https://sydzi.github.io/2025/10/28/0xGame2025Week3ReverseWriteUp/">https://sydzi.github.io/2025/10/28/0xGame2025Week3ReverseWriteUp/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><p>SydzI</p></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2025-10-28</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2025-11-16</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/CTF/">CTF</a><a class="link-muted mr-2" rel="tag" href="/tags/WriteUp/">WriteUp</a><a class="link-muted mr-2" rel="tag" href="/tags/Reverse/">Reverse</a></div><div class="sharethis-inline-share-buttons"></div><script src="https://platform-api.sharethis.com/js/sharethis.js#property=68b654c479868da1c7122aa1&amp;product=inline-share-buttons" defer></script><nav class="post-navigation mt-4 mb-2 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2025/11/03/week35-week39/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">week35-week39</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2025/10/19/0xGame2025Week2ReverseWriteUp/"><span class="level-item">0xGame2025Week2WriteUp</span><i class="level-item fas fa-chevron-right"></i></a></div></nav></article></div><!--!--><div class="card" id="comments"><div class="card-content"><h3 class="title is-5">评论</h3><script src="https://utteranc.es/client.js" repo="sydzi/sydzi.github.io" issue-term="pathname" theme="github-light" crossorigin="anonymous" async></script></div></div></div><div class="column column-left is-4-tablet is-3-desktop is-3-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/img/avatar.jpg" alt="SydzI"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">SydzI</p><p class="is-size-6 is-block">Action over inaction</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Nanjing, China</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives/"><p class="title">32</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories/"><p class="title">4</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags/"><p class="title">7</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/SydzI" target="_blank" rel="me noopener">关注我</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Github" href="https://github.com/SydzI"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="RSS" href="/atom.xml"><i class="fas fa-rss"></i></a></div></div></div><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="level is-mobile" href="#easyApp"><span class="level-left"><span class="level-item">1</span><span class="level-item">easyApp</span></span></a></li><li><a class="level is-mobile" href="#Minesweepr"><span class="level-left"><span class="level-item">2</span><span class="level-item">Minesweepr</span></span></a></li><li><a class="level is-mobile" href="#ezVBS"><span class="level-left"><span class="level-item">3</span><span class="level-item">ezVBS</span></span></a></li><li><a class="level is-mobile" href="#World’s-end-BlackBox"><span class="level-left"><span class="level-item">4</span><span class="level-item">World’s_end_BlackBox</span></span></a></li><li><a class="level is-mobile" href="#Q-≧▽≦-T"><span class="level-left"><span class="level-item">5</span><span class="level-item">Q(≧▽≦)T</span></span></a></li><li><a class="level is-mobile" href="#Calamity-Fortune"><span class="level-left"><span class="level-item">6</span><span class="level-item">Calamity_Fortune</span></span></a></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/">SydzI&#039;s Blog</a><p class="is-size-7"><span>&copy; 2025 SydzI</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="fab fa-creative-commons-nc"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script>moment.locale("zh-cn");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            },
            services: {
                firebase: {"enable":true,"collection":"articles","apiKey":"AIzaSyCL4X3DgCuPZ09mSUIYiIzwCrbKdVcf_jY","projectId":"sydzi-s-blog-counter"}
            }
        };</script><script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-app-compat.js"></script><script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-firestore-compat.js"></script><script data-pjax src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script data-pjax src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js"></script><script src="/js/pjax.js"></script><!--!--><!--!--><!--!--><script data-pjax src="/js/main.js" defer></script><script data-pjax src="/js/firebase_counter.js" defer></script><script src="/js/night.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script data-pjax src="/js/insight.js" defer></script><script data-pjax>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/wanko.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"css":false});</script></body></html>