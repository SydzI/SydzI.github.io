<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>0xGame2025Week4WriteUp - SydzI&#039;s Blog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="SydzI&#039;s Blog"><meta name="msapplication-TileImage" content="/img/Newspaper.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="SydzI&#039;s Blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="0xGame2025 Week4 Reverse方向全解&amp;amp;详解"><meta property="og:type" content="blog"><meta property="og:title" content="0xGame2025Week4WriteUp"><meta property="og:url" content="https://sydzi.github.io/2025/11/16/0xGame2025Week4ReverseWriteUp/"><meta property="og:site_name" content="SydzI&#039;s Blog"><meta property="og:description" content="0xGame2025 Week4 Reverse方向全解&amp;amp;详解"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://sydzi.github.io/images/image-20251029221337039.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251105204720304.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251105205201725.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251105210910030.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251105212443210.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251105213100678.png"><meta property="og:image" content="c:/Users/21132/AppData/Roaming/Typora/typora-user-images/image-20251105213705664.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251105220015560.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251105220511591.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251106193030935.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251106193216226.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251106193251339.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251106193416659.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251106195811100.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251106195827424.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251106195843505.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251107170326209.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251107171007199.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251107171139700.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251107171338976.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251107172247039.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251107172437327.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251107173258987.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251107173428095.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251112220409411.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251112220643619.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251113211300972.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251107211205450.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251107211234103.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251107212238679.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251107212753102.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251107212917688.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251107215116511.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251107215446744.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251107220443790.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251107220708346.png"><meta property="og:image" content="https://sydzi.github.io/images/image-20251107220805016.png"><meta property="article:published_time" content="2025-11-16T12:59:56.000Z"><meta property="article:modified_time" content="2025-11-16T13:07:32.585Z"><meta property="article:author" content="SydzI"><meta property="article:tag" content="CTF"><meta property="article:tag" content="WriteUp"><meta property="article:tag" content="Reverse"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://sydzi.github.io/images/image-20251029221337039.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://sydzi.github.io/2025/11/16/0xGame2025Week4ReverseWriteUp/"},"headline":"0xGame2025Week4WriteUp","image":["https://sydzi.github.io/images/image-20251029221337039.png","https://sydzi.github.io/images/image-20251105204720304.png","https://sydzi.github.io/images/image-20251105205201725.png","https://sydzi.github.io/images/image-20251105210910030.png","https://sydzi.github.io/images/image-20251105212443210.png","https://sydzi.github.io/images/image-20251105213100678.png","c:/Users/21132/AppData/Roaming/Typora/typora-user-images/image-20251105213705664.png","https://sydzi.github.io/images/image-20251105220015560.png","https://sydzi.github.io/images/image-20251105220511591.png","https://sydzi.github.io/images/image-20251106193030935.png","https://sydzi.github.io/images/image-20251106193216226.png","https://sydzi.github.io/images/image-20251106193251339.png","https://sydzi.github.io/images/image-20251106193416659.png","https://sydzi.github.io/images/image-20251106195811100.png","https://sydzi.github.io/images/image-20251106195827424.png","https://sydzi.github.io/images/image-20251106195843505.png","https://sydzi.github.io/images/image-20251107170326209.png","https://sydzi.github.io/images/image-20251107171007199.png","https://sydzi.github.io/images/image-20251107171139700.png","https://sydzi.github.io/images/image-20251107171338976.png","https://sydzi.github.io/images/image-20251107172247039.png","https://sydzi.github.io/images/image-20251107172437327.png","https://sydzi.github.io/images/image-20251107173258987.png","https://sydzi.github.io/images/image-20251107173428095.png","https://sydzi.github.io/images/image-20251112220409411.png","https://sydzi.github.io/images/image-20251112220643619.png","https://sydzi.github.io/images/image-20251113211300972.png","https://sydzi.github.io/images/image-20251107211205450.png","https://sydzi.github.io/images/image-20251107211234103.png","https://sydzi.github.io/images/image-20251107212238679.png","https://sydzi.github.io/images/image-20251107212753102.png","https://sydzi.github.io/images/image-20251107212917688.png","https://sydzi.github.io/images/image-20251107215116511.png","https://sydzi.github.io/images/image-20251107215446744.png","https://sydzi.github.io/images/image-20251107220443790.png","https://sydzi.github.io/images/image-20251107220708346.png","https://sydzi.github.io/images/image-20251107220805016.png"],"datePublished":"2025-11-16T12:59:56.000Z","dateModified":"2025-11-16T13:07:32.585Z","author":{"@type":"Person","name":"SydzI"},"publisher":{"@type":"Organization","name":"SydzI's Blog","logo":{"@type":"ImageObject"}},"description":"0xGame2025 Week4 Reverse方向全解&amp;详解"}</script><link rel="canonical" href="https://sydzi.github.io/2025/11/16/0xGame2025Week4ReverseWriteUp/"><link rel="icon" href="/img/Newspaper.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link data-pjax rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/styles/xcode.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link data-pjax rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><meta name="msvalidate.01" content="9FE0F2242662A1EB82C139F80B4118F0"><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=upLteeXJeF0vtcEfQngBefAoRrZBdbYGiIdhlziWygs" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'upLteeXJeF0vtcEfQngBefAoRrZBdbYGiIdhlziWygs');</script><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="SydzI's Blog" type="application/atom+xml">
</head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/">SydzI&#039;s Blog</a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">首页</a><a class="navbar-item" href="/archives">归档</a><a class="navbar-item" href="/about">关于</a></div><div class="navbar-end"><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item night" id="night-nav" title="Change Mode" href="javascript:;"><i class="fas fa-moon" id="night-icon"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-9-desktop is-9-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 level is-mobile"><div class="level-left"><span class="level-item"><i class="fas fa-calendar-alt mr-1"></i><time datetime="${date_xml(page.date)}" title="${new Date(page.date).toLocaleString()}">2025-11-16</time></span><span class="level-item"><i class="fas fa-sync-alt mr-1"></i><time datetime="${date_xml(page.updated)}" title="${new Date(page.updated).toLocaleString()}">2025-11-16</time></span><span class="level-item"><i class="far fa-folder-open mr-1"></i><a class="link-muted" href="/categories/WriteUp-%E5%A4%8D%E7%8E%B0/">WriteUp&amp;复现</a></span><span class="level-item"><i class="far fa-clock mr-1"></i>44 分钟读完 (大约6654个字)</span><span class="level-item"><i class="far fa-eye mr-1"></i><span class="firestore-visitors-count">0</span></span></div></div><h1 class="title is-3 is-size-4-mobile">0xGame2025Week4WriteUp</h1><div class="content"><p>0xGame2025 Week4 Reverse方向全解&amp;详解（未完待续）</p>
<span id="more"></span>

<h2 id="镜渊折枝"><a href="#镜渊折枝" class="headerlink" title="镜渊折枝"></a>镜渊折枝</h2><blockquote>
<p>考点：native层逆向，AES</p>
</blockquote>
<ul>
<li><p>附件apk运行起来是这样：</p>
<p><img src="/../images/image-20251029221337039.png" alt="运行附件apk"></p>
</li>
<li><p>JEB打开，可以得到下面这些MainActivity和相关函数的内容：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.example.easynative;<br><br><span class="hljs-keyword">import</span> android.content.Context;<br><span class="hljs-keyword">import</span> android.os.Bundle;<br><span class="hljs-keyword">import</span> android.view.View;<br><span class="hljs-keyword">import</span> android.widget.Button;<br><span class="hljs-keyword">import</span> android.widget.EditText;<br><span class="hljs-keyword">import</span> android.widget.Toast;<br><span class="hljs-keyword">import</span> androidx.activity.ComponentActivity;<br><span class="hljs-keyword">import</span> java.io.InputStream;<br><span class="hljs-keyword">import</span> kotlin.Metadata;<br><span class="hljs-keyword">import</span> kotlin.io.ByteStreamsKt;<br><span class="hljs-keyword">import</span> kotlin.jvm.internal.Intrinsics;<br><br><span class="hljs-meta">@Metadata(d1 = &#123;&quot;\u0000\u0018\n\u0002\u0018\u0002\n\u0002\u0018\u0002\n\u0002\b\u0002\n\u0002\u0010\u0002\n\u0000\n\u0002\u0018\u0002\n\u0000\b\u0007\u0018\u00002\u00020\u0001B\u0005¢\u0006\u0002\u0010\u0002J\u0012\u0010\u0003\u001A\u00020\u00042\b\u0010\u0005\u001A\u0004\u0018\u00010\u0006H\u0014¨\u0006\u0007&quot;&#125;, d2 = &#123;&quot;Lcom/example/easynative/MainActivity;&quot;, &quot;Landroidx/activity/ComponentActivity;&quot;, &quot;()V&quot;, &quot;onCreate&quot;, &quot;&quot;, &quot;savedInstanceState&quot;, &quot;Landroid/os/Bundle;&quot;, &quot;app_release&quot;&#125;, k = 1, mv = &#123;1, 9, 0&#125;, xi = 0x30)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ComponentActivity</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> $stable;<br><br>    <span class="hljs-keyword">static</span> &#123;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span>  <span class="hljs-comment">// androidx.activity.ComponentActivity</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(Bundle arg3)</span> &#123;<br>        <span class="hljs-built_in">super</span>.onCreate(arg3);<br>        <span class="hljs-built_in">this</span>.setContentView(layout.activity_main);<br>        <span class="hljs-type">EditText</span> <span class="hljs-variable">v3</span> <span class="hljs-operator">=</span> (EditText)<span class="hljs-built_in">this</span>.findViewById(id.flagInput);<br>        ((Button)<span class="hljs-built_in">this</span>.findViewById(id.button)).setOnClickListener((View arg2) -&gt; MainActivity.onCreate$lambda$<span class="hljs-number">0</span>(v3, <span class="hljs-built_in">this</span>, arg2));<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> onCreate$lambda$<span class="hljs-number">0</span>(EditText arg2, MainActivity arg3, View arg4) &#123;<br>        Intrinsics.checkNotNullParameter(arg3, <span class="hljs-string">&quot;this$0&quot;</span>);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">v2</span> <span class="hljs-operator">=</span> arg2.getText().toString();<br>        <span class="hljs-type">InputStream</span> <span class="hljs-variable">v4</span> <span class="hljs-operator">=</span> arg3.getAssets().open(<span class="hljs-string">&quot;secret.bin&quot;</span>);<br>        Intrinsics.checkNotNullExpressionValue(v4, <span class="hljs-string">&quot;open(...)&quot;</span>);<br>        <span class="hljs-type">byte</span>[] v4_1 = ByteStreamsKt.readBytes(v4);<br>        <span class="hljs-keyword">if</span>(((CharSequence)v2).length() &gt; <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-type">Context</span> <span class="hljs-variable">v1</span> <span class="hljs-operator">=</span> (Context)arg3;<br>            <span class="hljs-keyword">if</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">FlagChecker</span>(v1, v2).check(v4_1)) &#123;  <span class="hljs-comment">// v4从secret.bin中被读取出来，读取的内容给了v4_1作为check的参数，输入的内容作为FlagChecker的第二个参数</span><br>                Toast.makeText(v1, ((CharSequence)arg3.getString(string.correct)), <span class="hljs-number">0</span>).show();<br>                <span class="hljs-keyword">return</span>;<br>            &#125;<br><br>            Toast.makeText(v1, ((CharSequence)arg3.getString(string.wrong)), <span class="hljs-number">0</span>).show();<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">package</span> com.example.easynative;<br><br><span class="hljs-keyword">import</span> android.content.Context;<br><span class="hljs-keyword">import</span> java.security.Key;<br><span class="hljs-keyword">import</span> java.security.spec.AlgorithmParameterSpec;<br><span class="hljs-keyword">import</span> javax.crypto.Cipher;<br><span class="hljs-keyword">import</span> javax.crypto.spec.IvParameterSpec;<br><span class="hljs-keyword">import</span> javax.crypto.spec.SecretKeySpec;<br><span class="hljs-keyword">import</span> kotlin.Metadata;<br><span class="hljs-keyword">import</span> kotlin.jvm.internal.DefaultConstructorMarker;<br><span class="hljs-keyword">import</span> kotlin.jvm.internal.Intrinsics;<br><span class="hljs-keyword">import</span> kotlin.text.Charsets;<br><br><span class="hljs-meta">@Metadata(d1 = &#123;&quot;\u0000.\n\u0002\u0018\u0002\n\u0002\u0010\u0000\n\u0000\n\u0002\u0018\u0002\n\u0000\n\u0002\u0010\u000E\n\u0002\b\u0002\n\u0002\u0010\u000B\n\u0000\n\u0002\u0010\u0012\n\u0002\b\u0002\n\u0002\u0010\b\n\u0002\b\u0005\b\u0007\u0018\u0000 \u00112\u00020\u0001:\u0001\u0011B\u0015\u0012\u0006\u0010\u0002\u001A\u00020\u0003\u0012\u0006\u0010\u0004\u001A\u00020\u0005¢\u0006\u0002\u0010\u0006J\u000E\u0010\u0007\u001A\u00020\b2\u0006\u0010\t\u001A\u00020\nJ\u0019\u0010\u000B\u001A\u00020\b2\u0006\u0010\f\u001A\u00020\r2\u0006\u0010\u000E\u001A\u00020\nH\u0086 J\u001E\u0010\u000F\u001A\u00020\n2\u0006\u0010\u0004\u001A\u00020\u00052\u0006\u0010\u0010\u001A\u00020\n2\u0006\u0010\t\u001A\u00020\nR\u000E\u0010\u0002\u001A\u00020\u0003X\u0082\u0004¢\u0006\u0002\n\u0000R\u000E\u0010\u0004\u001A\u00020\u0005X\u0082\u0004¢\u0006\u0002\n\u0000¨\u0006\u0012&quot;&#125;, d2 = &#123;&quot;Lcom/example/easynative/FlagChecker;&quot;, &quot;&quot;, &quot;context&quot;, &quot;Landroid/content/Context;&quot;, &quot;plainText&quot;, &quot;&quot;, &quot;(Landroid/content/Context;Ljava/lang/String;)V&quot;, &quot;check&quot;, &quot;&quot;, &quot;iv&quot;, &quot;&quot;, &quot;compare&quot;, &quot;length&quot;, &quot;&quot;, &quot;data&quot;, &quot;encrypt&quot;, &quot;key&quot;, &quot;Companion&quot;, &quot;app_release&quot;&#125;, k = 1, mv = &#123;1, 9, 0&#125;, xi = 0x30)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FlagChecker</span> &#123;<br>    <span class="hljs-meta">@Metadata(d1 = &#123;&quot;\u0000\f\n\u0002\u0018\u0002\n\u0002\u0010\u0000\n\u0002\b\u0002\b\u0086\u0003\u0018\u00002\u00020\u0001B\u0007\b\u0002¢\u0006\u0002\u0010\u0002¨\u0006\u0003&quot;&#125;, d2 = &#123;&quot;Lcom/example/easynative/FlagChecker$Companion;&quot;, &quot;&quot;, &quot;()V&quot;, &quot;app_release&quot;&#125;, k = 1, mv = &#123;1, 9, 0&#125;, xi = 0x30)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Companion</span> &#123;<br>        <span class="hljs-keyword">private</span> <span class="hljs-title function_">Companion</span><span class="hljs-params">()</span> &#123;<br>        &#125;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-title function_">Companion</span><span class="hljs-params">(DefaultConstructorMarker arg1)</span> &#123;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> $stable;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Companion Companion;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Context context;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String plainText;<br><br>    <span class="hljs-keyword">static</span> &#123;<br>        FlagChecker.Companion = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Companion</span>(<span class="hljs-literal">null</span>);<br>        FlagChecker.$stable = <span class="hljs-number">8</span>;<br>        System.loadLibrary(<span class="hljs-string">&quot;easynative&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">FlagChecker</span><span class="hljs-params">(Context arg2, String arg3)</span> &#123;<br>        Intrinsics.checkNotNullParameter(arg2, <span class="hljs-string">&quot;context&quot;</span>);<br>        Intrinsics.checkNotNullParameter(arg3, <span class="hljs-string">&quot;plainText&quot;</span>);<br>        <span class="hljs-built_in">super</span>();<br>        <span class="hljs-built_in">this</span>.context = arg2;<br>        <span class="hljs-built_in">this</span>.plainText = arg3;  <span class="hljs-comment">// 输入的内容被赋值给plaintext</span><br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">check</span><span class="hljs-params">(<span class="hljs-type">byte</span>[] arg4)</span> &#123;  <span class="hljs-comment">// 参数是从secret.bin读取的内容</span><br>        Intrinsics.checkNotNullParameter(((Object)arg4), <span class="hljs-string">&quot;iv&quot;</span>);  <span class="hljs-comment">// arg4即从secret.bin读取的内容被标识为iv</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">v0</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>.context.getString(string.key);  <span class="hljs-comment">// v0为string.key</span><br>        Intrinsics.checkNotNullExpressionValue(v0, <span class="hljs-string">&quot;getString(...)&quot;</span>);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">v1</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>.plainText;  <span class="hljs-comment">// v1是输入的内容plaintext</span><br>        <span class="hljs-type">byte</span>[] v0_1 = v0.getBytes(Charsets.UTF_8);  <span class="hljs-comment">// v0读取为bytes</span><br>        Intrinsics.checkNotNullExpressionValue(((Object)v0_1), <span class="hljs-string">&quot;this as java.lang.String).getBytes(charset)&quot;</span>);<br>        <span class="hljs-type">byte</span>[] v4 = <span class="hljs-built_in">this</span>.encrypt(v1, v0_1, arg4);  <span class="hljs-comment">// 三个参数分别为：输入的plaintext，string.key，从secret.bin读取的iv</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.compare(v4.length, v4);  <span class="hljs-comment">// compare从native层easynative.so导入</span><br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">native</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">compare</span><span class="hljs-params">(<span class="hljs-type">int</span> arg1, <span class="hljs-type">byte</span>[] arg2)</span> &#123;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">byte</span>[] encrypt(String arg3, <span class="hljs-type">byte</span>[] arg4, <span class="hljs-type">byte</span>[] arg5) &#123;<br>        Intrinsics.checkNotNullParameter(arg3, <span class="hljs-string">&quot;plainText&quot;</span>);  <span class="hljs-comment">// 此处再次对参数进行了标识</span><br>        Intrinsics.checkNotNullParameter(((Object)arg4), <span class="hljs-string">&quot;key&quot;</span>);<br>        Intrinsics.checkNotNullParameter(((Object)arg5), <span class="hljs-string">&quot;iv&quot;</span>);<br>        <span class="hljs-type">SecretKeySpec</span> <span class="hljs-variable">v0</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SecretKeySpec</span>(arg4, <span class="hljs-string">&quot;AES&quot;</span>);  <span class="hljs-comment">// 加密算法AES，CTR模式</span><br>        <span class="hljs-type">Cipher</span> <span class="hljs-variable">v4</span> <span class="hljs-operator">=</span> Cipher.getInstance(<span class="hljs-string">&quot;AES/CTR/NoPadding&quot;</span>);<br>        v4.init(<span class="hljs-number">1</span>, ((Key)v0), ((AlgorithmParameterSpec)<span class="hljs-keyword">new</span> <span class="hljs-title class_">IvParameterSpec</span>(arg5)));<br>        <span class="hljs-type">byte</span>[] v3 = arg3.getBytes(Charsets.UTF_8);<br>        Intrinsics.checkNotNullExpressionValue(((Object)v3), <span class="hljs-string">&quot;this as java.lang.String).getBytes(charset)&quot;</span>);<br>        <span class="hljs-type">byte</span>[] v3_1 = v4.doFinal(v3);<br>        Intrinsics.checkNotNull(((Object)v3_1));<br>        <span class="hljs-keyword">return</span> v3_1;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>可以看到Mainactivity使用了FlagChecker来校验，而FlagChecker对输入的内容进行了AES加密，然后用native层的compare函数来检验加密结果。下面是native层compare函数的内容(IDA中显示的函数名是check而非compare)：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-function">__int64 __fastcall <span class="hljs-title">check</span><span class="hljs-params">(JNIEnv *a1, __int64 a2, <span class="hljs-type">int</span> a3, <span class="hljs-type">void</span> *a4)</span></span><br><span class="hljs-function"></span>&#123;<br>  __int64 v5; <span class="hljs-comment">// x0</span><br>  __int64 i; <span class="hljs-comment">// x9</span><br>  <span class="hljs-type">int</span> v7; <span class="hljs-comment">// w11</span><br>  <span class="hljs-type">int</span> v8; <span class="hljs-comment">// w10</span><br><br>  v5 = (__int64)(*a1)-&gt;<span class="hljs-built_in">GetByteArrayElements</span>(a1, a4, <span class="hljs-number">0LL</span>);<br>  <span class="hljs-keyword">if</span> ( a3 != <span class="hljs-number">48</span> )<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0LL</span>; i != <span class="hljs-number">48</span>; ++i )<br>  &#123;<br>    v7 = (<span class="hljs-type">unsigned</span> __int8)byte_5A2[i];<br>    v8 = *(<span class="hljs-type">unsigned</span> __int8 *)(v5 + i) ^ (<span class="hljs-type">unsigned</span> __int8)i;<br>    <span class="hljs-keyword">if</span> ( v8 != v7 )<br>      <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>  &#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">1LL</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>可以看到compare函数是先拿AES加密结果异或索引后才进行校验的，所以解密应该拿compare中的密文和索引异或得到AES加密的数据，然后找出key和iv进行AES解密。</p>
<p>脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><br>enc=[<span class="hljs-number">0x38</span>, <span class="hljs-number">0xEA</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x8B</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x9E</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0xC5</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0xF0</span>, <span class="hljs-number">0x9D</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0xA7</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0xE5</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0xA5</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0xFC</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x8B</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0xF7</span>]<br><span class="hljs-comment">#先对数据进行异或还原</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc)):<br>    enc[i]=enc[i]^i<br><span class="hljs-comment">#提取AES相关参数</span><br>key=<span class="hljs-string">b&quot;0xgame-SecretKey&quot;</span><br>iv=<span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-string">&quot;8A A5 61 0C 74 41 1B 11 A3 53 68 DE 56 BF 6A B3&quot;</span>)<br><span class="hljs-comment">#AES解密</span><br>cipher=AES.new(key, AES.MODE_CTR, nonce=<span class="hljs-string">b&#x27;&#x27;</span>, initial_value=iv)<br>flag=cipher.decrypt(<span class="hljs-built_in">bytes</span>(enc))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;flag: &quot;</span>,flag.decode())<br></code></pre></td></tr></table></figure></li>
</ul>
<blockquote>
<p>flag：0xGame{Native_1s_also_1nt3r3st1ng_ef492d80a257c}</p>
</blockquote>
<h2 id="夜雀之歌"><a href="#夜雀之歌" class="headerlink" title="夜雀之歌"></a>夜雀之歌</h2><blockquote>
<p>考点：迷宫题，动态调试，反调试</p>
</blockquote>
<ul>
<li><p>附件程序运行起来是这样的：</p>
<p><img src="/../images/image-20251105204720304.png" alt="运行"></p>
<p>用IDA打开，通过Shift+F12字符串窗口可以找到一些信息定位main函数的位置</p>
<p><img src="/../images/image-20251105205201725.png" alt="字符串窗口的信息"></p>
<p>main函数有一大串的循环语句，结合上图终端输出的WASD可以推测这是一道迷宫逆向题。#是迷宫的墙，终端显示的是迷宫的一小部分，在终端按下WASD可以控制P移动。所以第一步要提取迷宫</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">//main函数</span><br>__int64 <span class="hljs-title function_">sub_7FF6645A1D2B</span><span class="hljs-params">()</span><br>&#123;<br>  <span class="hljs-type">int</span> v0; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">int</span> v1; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">int</span> v2; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">int</span> v3; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">int</span> v5; <span class="hljs-comment">// [rsp+28h] [rbp-8h]</span><br>  <span class="hljs-type">int</span> v6; <span class="hljs-comment">// [rsp+2Ch] [rbp-4h]</span><br><br>  sub_7FF7EC581FC0();<br>  sub_7FF7EC581B30();<br>  sub_7FF7EC5815B6();<br>  v6 = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">do</span><br>  &#123;<br>    sub_7FF7EC581C5F();<br>    sub_7FF7EC5815B6();<br>    <span class="hljs-built_in">puts</span>(&amp;aWasdEsc);<br>    v5 = getch();<br>    sub_7FF7EC583060(<span class="hljs-string">&quot;%c\n&quot;</span>, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v5);<br><br>    <span class="hljs-keyword">if</span> ( v5 == <span class="hljs-number">119</span> )<br>    &#123;<br>LABEL_19:<br>      sub_7FF7EC581BB7(<span class="hljs-number">0LL</span>, <span class="hljs-number">0xFFFFFFFFL</span>L);<br>      v0 = v6++;<br>      byte_7FF7EC58E0E0[v0] = <span class="hljs-number">119</span>;<br>      <span class="hljs-keyword">continue</span>;<br>    &#125;<br>    <span class="hljs-keyword">if</span> ( v5 &lt;= <span class="hljs-number">119</span> )<br>    &#123;<br>      <span class="hljs-keyword">if</span> ( v5 == <span class="hljs-number">115</span> )<br>        <span class="hljs-keyword">goto</span> LABEL_22;<br>      <span class="hljs-keyword">if</span> ( v5 &lt;= <span class="hljs-number">115</span> )<br>      &#123;<br>        <span class="hljs-keyword">if</span> ( v5 == <span class="hljs-number">100</span> )<br>          <span class="hljs-keyword">goto</span> LABEL_21;<br>        <span class="hljs-keyword">if</span> ( v5 &lt;= <span class="hljs-number">100</span> )<br>        &#123;<br>          <span class="hljs-keyword">if</span> ( v5 == <span class="hljs-number">97</span> )<br>            <span class="hljs-keyword">goto</span> LABEL_20;<br>          <span class="hljs-keyword">if</span> ( v5 &lt;= <span class="hljs-number">97</span> )<br>          &#123;<br>            <span class="hljs-keyword">if</span> ( v5 == <span class="hljs-number">87</span> )<br>              <span class="hljs-keyword">goto</span> LABEL_19;<br>            <span class="hljs-keyword">if</span> ( v5 &lt;= <span class="hljs-number">87</span> )<br>            &#123;<br>              <span class="hljs-keyword">if</span> ( v5 == <span class="hljs-number">83</span> )<br>              &#123;<br>LABEL_22:<br>                sub_7FF7EC581BB7(<span class="hljs-number">0LL</span>, <span class="hljs-number">1LL</span>);<br>                v3 = v6++;<br>                byte_7FF7EC58E0E0[v3] = <span class="hljs-number">115</span>;<br>                <span class="hljs-keyword">continue</span>;<br>              &#125;<br>              <span class="hljs-keyword">if</span> ( v5 &lt;= <span class="hljs-number">83</span> )<br>              &#123;<br>                <span class="hljs-keyword">if</span> ( v5 == <span class="hljs-number">68</span> )<br>                &#123;<br>LABEL_21:<br>                  sub_7FF7EC581BB7(<span class="hljs-number">1LL</span>, <span class="hljs-number">0LL</span>);<br>                  v2 = v6++;<br>                  byte_7FF7EC58E0E0[v2] = <span class="hljs-number">100</span>;<br>                  <span class="hljs-keyword">continue</span>;<br>                &#125;<br>                <span class="hljs-keyword">if</span> ( v5 &lt;= <span class="hljs-number">68</span> )<br>                &#123;<br>                  <span class="hljs-keyword">if</span> ( v5 == <span class="hljs-number">27</span> )<br>                    <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>                  <span class="hljs-keyword">if</span> ( v5 == <span class="hljs-number">65</span> )<br>                  &#123;<br>LABEL_20:<br>                    sub_7FF7EC581BB7(<span class="hljs-number">0xFFFFFFFFL</span>L, <span class="hljs-number">0LL</span>);<br>                    v1 = v6++;<br>                    byte_7FF7EC58E0E0[v1] = <span class="hljs-number">97</span>;<br>                  &#125;<br>                &#125;<br>              &#125;<br>            &#125;<br>          &#125;<br>        &#125;<br>      &#125;<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">while</span> ( dword_7FF7EC58E0C4 != dword_7FF7EC58E0D4 || dword_7FF7EC58E0C8 != dword_7FF7EC58E0D8 );<br>  sub_7FF7EC583060(<span class="hljs-string">&quot;Congratulations your flag is: 0xGame&#123;md5(your_path)&#125; (lowercase)&quot;</span>);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>点进LABEL_19下的第一个函数可以看到一个比较逻辑</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs c">__int64 __fastcall <span class="hljs-title function_">sub_7FF7EC581BB7</span><span class="hljs-params">(<span class="hljs-type">int</span> a1, <span class="hljs-type">int</span> a2)</span><br>&#123;<br>  <span class="hljs-type">int</span> v3; <span class="hljs-comment">// [rsp+24h] [rbp-Ch]</span><br>  <span class="hljs-type">int</span> v4; <span class="hljs-comment">// [rsp+28h] [rbp-8h]</span><br>  <span class="hljs-type">int</span> v5; <span class="hljs-comment">// [rsp+2Ch] [rbp-4h]</span><br><br>  v5 = dword_7FF7EC58E0C4 + a1;<br>  v4 = dword_7FF7EC58E0C8 + a2;<br>  v3 = dword_7FF7EC58E0C4 + a1 + <span class="hljs-number">101</span> * (dword_7FF7EC58E0C8 + a2);<br>  <span class="hljs-keyword">if</span> ( byte_7FF7EC589040[v3] == <span class="hljs-number">35</span> )<span class="hljs-comment">//比较逻辑</span><br>  &#123;<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;不能移动到墙壁&quot;</span>);<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    byte_7FF7EC589040[<span class="hljs-number">101</span> * dword_7FF7EC58E0C8 + dword_7FF7EC58E0C4] = <span class="hljs-number">32</span>;<br>    dword_7FF7EC58E0C4 = v5;<br>    dword_7FF7EC58E0C8 = v4;<br>    byte_7FF7EC589040[v3] = <span class="hljs-number">80</span>;<br>  &#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>在Hex View跟随比较逻辑中的这个数组的地址(7FF7EC589040)可以看到迷宫：</p>
<p><img src="/../images/image-20251105210910030.png" alt="迷宫"></p>
<p>但是提取出迷宫会发现，这个迷宫和直接运行程序时终端显示的迷宫不一样</p>
<p>推测程序加了反调试。最直接的绕过方法就是用xdbg调试，用插件ScyllaHide直接绕过反调试检测。在转储找到相同的地址可以得到真正的迷宫</p>
<p><img src="/../images/image-20251105212443210.png" alt="真正的迷宫"></p>
<p>选中迷宫地图数据右键二进制保存到文件，把文件格式改为txt</p>
<p><img src="/../images/image-20251105213100678.png" alt="保存迷宫地图"></p>
<p>然后就可以让AI写个解迷宫脚本解出路径，按照程序的提示把路径进行MD5加密就可以得到flag了</p>
</li>
<li><p>解迷宫脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> deque<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">solve_maze</span>(<span class="hljs-params">maze, start, end, wall=<span class="hljs-string">&#x27;#&#x27;</span>, free=<span class="hljs-string">&#x27; &#x27;</span></span>):<br>    <span class="hljs-string">&quot;&quot;&quot;Maze solver using BFS&quot;&quot;&quot;</span><br>    directions = &#123;<br>        (-<span class="hljs-number">1</span>, <span class="hljs-number">0</span>): <span class="hljs-string">&#x27;w&#x27;</span>,  <span class="hljs-comment"># up</span><br>        (<span class="hljs-number">1</span>, <span class="hljs-number">0</span>): <span class="hljs-string">&#x27;s&#x27;</span>,   <span class="hljs-comment"># down  </span><br>        (<span class="hljs-number">0</span>, -<span class="hljs-number">1</span>): <span class="hljs-string">&#x27;a&#x27;</span>,  <span class="hljs-comment"># left</span><br>        (<span class="hljs-number">0</span>, <span class="hljs-number">1</span>): <span class="hljs-string">&#x27;d&#x27;</span>    <span class="hljs-comment"># right</span><br>    &#125;<br>    <br>    rows, cols = <span class="hljs-built_in">len</span>(maze), <span class="hljs-built_in">len</span>(maze[<span class="hljs-number">0</span>])<br>    visited = [[<span class="hljs-literal">False</span>] * cols <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(rows)]<br>    <br>    <span class="hljs-comment"># BFS</span><br>    queue = deque([(start[<span class="hljs-number">0</span>], start[<span class="hljs-number">1</span>], <span class="hljs-string">&quot;&quot;</span>)])<br>    visited[start[<span class="hljs-number">0</span>]][start[<span class="hljs-number">1</span>]] = <span class="hljs-literal">True</span><br>    <br>    <span class="hljs-keyword">while</span> queue:<br>        row, col, path = queue.popleft()<br>        <br>        <span class="hljs-keyword">if</span> (row, col) == end:<br>            <span class="hljs-keyword">return</span> path<br>        <br>        <span class="hljs-keyword">for</span> dr, dc <span class="hljs-keyword">in</span> directions.keys():<br>            new_row, new_col = row + dr, col + dc<br>            <br>            <span class="hljs-keyword">if</span> (<span class="hljs-number">0</span> &lt;= new_row &lt; rows <span class="hljs-keyword">and</span> <span class="hljs-number">0</span> &lt;= new_col &lt; cols <span class="hljs-keyword">and</span> <br>                <span class="hljs-keyword">not</span> visited[new_row][new_col] <span class="hljs-keyword">and</span> <br>                maze[new_row][new_col] != wall):<br>                <br>                visited[new_row][new_col] = <span class="hljs-literal">True</span><br>                new_path = path + directions[(dr, dc)]<br>                queue.append((new_row, new_col, new_path))<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br><span class="hljs-comment"># Load maze and solve</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;final_maze.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    maze = [<span class="hljs-built_in">list</span>(line.strip()) <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> f]<br><br>start = (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>)<br>end = (<span class="hljs-number">99</span>, <span class="hljs-number">99</span>)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Maze size: <span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(maze)&#125;</span> x <span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(maze[<span class="hljs-number">0</span>])&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Start: <span class="hljs-subst">&#123;start&#125;</span>, End: <span class="hljs-subst">&#123;end&#125;</span>&quot;</span>)<br><br><span class="hljs-comment"># Solve the maze</span><br>solution = solve_maze(maze, start, end, wall=<span class="hljs-string">&#x27;#&#x27;</span>, free=<span class="hljs-string">&#x27; &#x27;</span>)<br><br><span class="hljs-keyword">if</span> solution:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Solution found!&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Path length: <span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(solution)&#125;</span>&quot;</span>)<br>    <br>    <span class="hljs-comment"># Print FULL path</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;\nFULL PATH:&quot;</span>)<br>    <span class="hljs-built_in">print</span>(solution)<br>    <br>    <span class="hljs-comment"># Save full path</span><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;maze_solution.txt&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> f:<br>        f.write(solution)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;\nFull path saved to maze_solution.txt&quot;</span>)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;No solution found!&quot;</span>)<br></code></pre></td></tr></table></figure></li>
</ul>
<blockquote>
<p>flag：0xGame{44fc4bc18c87b3992af1d7726185ed36}</p>
</blockquote>
<h2 id="绯想天则"><a href="#绯想天则" class="headerlink" title="绯想天则"></a>绯想天则</h2><blockquote>
<p>考点：unity逆向改游戏机制</p>
</blockquote>
<ul>
<li><p>附件是个unity游戏</p>
<p><img src="C:/Users/21132/AppData/Roaming/Typora/typora-user-images/image-20251105213705664.png" alt="unity游戏"></p>
<p>boss血条很厚，怎么打都打不过，角色很容易死。所以考虑改游戏机制</p>
</li>
<li><p>参考<a target="_blank" rel="noopener" href="https://blog.csdn.net/xianyu_yuan/article/details/140899803">从出题到做题——浅探Unity游戏逆向</a>，找到IWANNATENSHIFUMOのINESBATTLE\I WANNA TENSHI FUMOのFIGHT WITH INES_Data\Managed\Assembly-CSharp.dll，用dnspy打开进行修改。修改思路是给角色加上锁血和一击毙命buff，修改的类是CharacterStats，至于怎么修改可以把整个类的代码发给AI问怎么改锁血和一击毙命，因为附件程序工程比较大，没有上下文的话不好描述，此处省略修改方案了。修改方法是在类代码页右键选择编辑类</p>
<p><img src="/../images/image-20251105220015560.png" alt="右键编辑类"></p>
<p>修改完点击右下角的编译即可。此外，笔者在编译的时候遇到了一些报错：random’is anbiguous reference between ‘unityengine.random’and ‘system.random，此时把代码中所有的Random.Range都改成UnityEngine.Random.Range即可。</p>
<p>修改完成后，重新运行游戏就可以速通得到flag了</p>
<p><img src="/../images/image-20251105220511591.png" alt="速通"></p>
</li>
</ul>
<blockquote>
<p>flag：0xGame{TenshiSamaSaiko_IWANNATENSHIFUMO_INESBATTLE}</p>
</blockquote>
<h2 id="幻视调律"><a href="#幻视调律" class="headerlink" title="幻视调律"></a>幻视调律</h2><blockquote>
<p>考点：函数重写，RC4，TEA</p>
</blockquote>
<ul>
<li><p>附件程序运行起来是很常规的输入flag提示：</p>
<p><img src="/../images/image-20251106193030935.png" alt="常规"></p>
<p>用IDA打开，Shift+F12可以看到可疑字符串</p>
<p><img src="/../images/image-20251106193216226.png" alt="可疑字符串"></p>
<p>跟踪可疑字符串可以找到main函数</p>
<p><img src="/../images/image-20251106193251339.png" alt="main函数"></p>
<p>简单优化一下</p>
<p><img src="/../images/image-20251106193416659.png" alt="优化后的main函数"></p>
<p>可以看到函数对输入的内容进行了RC4加密后才校验。但是作为第四周的题目，这样子显然还是太直白了。动调一下可以发现，strcmp函数被重写了</p>
<p><img src="/../images/image-20251106195811100.png" alt="跟踪strcmp1"></p>
<p><img src="/../images/image-20251106195827424.png" alt="跟踪strcmp2"></p>
<p><img src="/../images/image-20251106195843505.png" alt="跟踪strcmp3"></p>
<p>可以看到，strcmp最后被导向了sub_140003000，函数反编译如下（经过优化），是个TEA加密</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs C">_BOOL8 __fastcall <span class="hljs-title function_">sub_140003000</span><span class="hljs-params">(<span class="hljs-type">void</span> *a1, _DWORD *a2)</span><br>&#123;<br>  _DWORD Buf2[<span class="hljs-number">14</span>]; <span class="hljs-comment">// [rsp+20h] [rbp-60h] BYREF</span><br>  _DWORD *key; <span class="hljs-comment">// [rsp+58h] [rbp-28h]</span><br>  <span class="hljs-type">void</span> *Buf1; <span class="hljs-comment">// [rsp+60h] [rbp-20h]</span><br>  <span class="hljs-type">int</span> j; <span class="hljs-comment">// [rsp+6Ch] [rbp-14h]</span><br>  <span class="hljs-type">int</span> sum; <span class="hljs-comment">// [rsp+70h] [rbp-10h]</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> p2; <span class="hljs-comment">// [rsp+74h] [rbp-Ch]</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> p1; <span class="hljs-comment">// [rsp+78h] [rbp-8h]</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [rsp+7Ch] [rbp-4h]</span><br><br>  Buf1 = a1;<br>  key = a2;<br>  Buf2[<span class="hljs-number">0</span>] = <span class="hljs-number">1111022553</span>;<br>  Buf2[<span class="hljs-number">1</span>] = <span class="hljs-number">987309029</span>;<br>  Buf2[<span class="hljs-number">2</span>] = <span class="hljs-number">-1041056711</span>;<br>  Buf2[<span class="hljs-number">3</span>] = <span class="hljs-number">979189025</span>;<br>  Buf2[<span class="hljs-number">4</span>] = <span class="hljs-number">189565873</span>;<br>  Buf2[<span class="hljs-number">5</span>] = <span class="hljs-number">173973774</span>;<br>  Buf2[<span class="hljs-number">6</span>] = <span class="hljs-number">1090109393</span>;<br>  Buf2[<span class="hljs-number">7</span>] = <span class="hljs-number">-591836169</span>;<br>  Buf2[<span class="hljs-number">8</span>] = <span class="hljs-number">-394857933</span>;<br>  Buf2[<span class="hljs-number">9</span>] = <span class="hljs-number">668605093</span>;<br>  Buf2[<span class="hljs-number">10</span>] = <span class="hljs-number">0xB952BACB</span>;<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">9</span>; ++i )<br>  &#123;<br>    sum = <span class="hljs-number">0</span>;<br>    p1 = *((_DWORD *)Buf1 + i);<br>    p2 = *((_DWORD *)Buf1 + i + <span class="hljs-number">1</span>);<br>    sum = <span class="hljs-number">0x9E3779B9</span>;<br>    <span class="hljs-keyword">for</span> ( j = <span class="hljs-number">0</span>; j &lt;= <span class="hljs-number">31</span>; ++j )<br>    &#123;<br>      p1 += (sum + p2) ^ (*key + <span class="hljs-number">16</span> * p2) ^ ((p2 &gt;&gt; <span class="hljs-number">5</span>) + key[<span class="hljs-number">1</span>]);<br>      sum -= <span class="hljs-number">0x61C88647</span>;<br>      p2 += (sum + p1) ^ (key[<span class="hljs-number">2</span>] + <span class="hljs-number">16</span> * p1) ^ ((p1 &gt;&gt; <span class="hljs-number">5</span>) + key[<span class="hljs-number">3</span>]);<br>    &#125;<br>    *((_DWORD *)Buf1 + i) = p1;<br>    *((_DWORD *)Buf1 + i + <span class="hljs-number">1</span>) = p2;<br>  &#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-built_in">memcmp</span>(Buf1, Buf2, <span class="hljs-number">0x2Cu</span>LL) != <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>所以，完整的加密流程是先RC4再TEA，TEA的key是main函数中strcmp的参数str2，密文是TEA最后面出现的Buf2。</p>
<p>还有一些需要关注的点：程序事实上进行了两次RC4加密，第一次是为了输出”input your flag:”，第二次才是加密输入的内容。所以，动调时在函数进行输出后、第二次RC4加密前才能提取出真的S盒</p>
<p>在反编译出来的函数的基础上可以写出解密脚本：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><code class="hljs C"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdint.h&gt;</span></span><br><span class="hljs-type">void</span> <span class="hljs-title function_">RC4_decrypt</span><span class="hljs-params">(<span class="hljs-type">char</span> *a1, <span class="hljs-type">int</span> a2)</span> &#123;<br>    <span class="hljs-comment">//直接提取S盒</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> byte_140008060[<span class="hljs-number">256</span>] = &#123;<br>    <span class="hljs-number">0x99</span>, <span class="hljs-number">0x9B</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0xF6</span>, <span class="hljs-number">0x8B</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0xBD</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x87</span>, <br>    <span class="hljs-number">0x2C</span>, <span class="hljs-number">0xB5</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0xA5</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0xAA</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x4E</span>, <br>    <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x8A</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0xF3</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0xD3</span>, <span class="hljs-number">0xA0</span>, <span class="hljs-number">0x2D</span>, <br>    <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0xFA</span>, <span class="hljs-number">0xD0</span>, <span class="hljs-number">0xC5</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0xDF</span>, <span class="hljs-number">0xB3</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x8E</span>, <span class="hljs-number">0xB4</span>, <br>    <span class="hljs-number">0x8C</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0xD2</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0xAD</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0x77</span>, <br>    <span class="hljs-number">0x4B</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0xC8</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0xF9</span>, <span class="hljs-number">0xA2</span>, <span class="hljs-number">0xE0</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0xE1</span>, <br>    <span class="hljs-number">0xCD</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0xF0</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0x9D</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0xCA</span>, <br>    <span class="hljs-number">0x89</span>, <span class="hljs-number">0xA8</span>, <span class="hljs-number">0xD5</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0xBB</span>, <span class="hljs-number">0xE3</span>, <span class="hljs-number">0xB2</span>, <span class="hljs-number">0x9F</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0xB6</span>, <span class="hljs-number">0xA3</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0xEB</span>, <br>    <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x8F</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0xA6</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0xE5</span>, <span class="hljs-number">0xC0</span>, <span class="hljs-number">0xF5</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0xE9</span>, <br>    <span class="hljs-number">0x3F</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0xA4</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0xEC</span>, <span class="hljs-number">0xE7</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0xDB</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0xED</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x51</span>, <br>    <span class="hljs-number">0xFB</span>, <span class="hljs-number">0xD4</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0xC9</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0xDD</span>, <span class="hljs-number">0xCF</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0xFC</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x7D</span>, <br>    <span class="hljs-number">0x7C</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0xDA</span>, <span class="hljs-number">0xB0</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0xAE</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x7A</span>, <br>    <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0xC4</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0xAC</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0xA7</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0xB1</span>, <br>    <span class="hljs-number">0xE6</span>, <span class="hljs-number">0xB8</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xF4</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0xBA</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0xB7</span>, <span class="hljs-number">0x3B</span>, <br>    <span class="hljs-number">0x35</span>, <span class="hljs-number">0xA1</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x2B</span>, <br>    <span class="hljs-number">0xCC</span>, <span class="hljs-number">0xB9</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0xA9</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0xEA</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0xBC</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x9E</span><br>&#125;;<br>    <span class="hljs-type">unsigned</span> __int8 v3; <span class="hljs-comment">// [rsp+0h] [rbp-10h]</span><br>    <span class="hljs-type">int</span> i; <span class="hljs-comment">// [rsp+4h] [rbp-Ch]</span><br>    <span class="hljs-type">int</span> v5; <span class="hljs-comment">// [rsp+8h] [rbp-8h]</span><br>    <span class="hljs-type">int</span> v6; <span class="hljs-comment">// [rsp+Ch] [rbp-4h]</span><br><br>    v6 = <span class="hljs-number">0</span>;<br>    v5 = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; a2; ++i )<br>    &#123;<br>        v6 = (v6 + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span>;<br>        v5 = (byte_140008060[v6] + v5) % <span class="hljs-number">256</span>;<br>        v3 = byte_140008060[v6];<br>        byte_140008060[v6] = byte_140008060[v5];<br>        byte_140008060[v5] = v3;<br>        *(<span class="hljs-type">char</span> *)(i + a1) = byte_140008060[(<span class="hljs-type">unsigned</span> __int8)(byte_140008060[v6] + byte_140008060[v5])] ^ *(<span class="hljs-type">char</span> *)(a1 + i);<br>    &#125;<br>&#125;<br><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;<br>  	<span class="hljs-comment">//用作key的str2</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> Str2[<span class="hljs-number">44</span>] = &#123;<br>    <span class="hljs-number">0x9F</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0xF0</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0xC0</span>, <span class="hljs-number">0xA4</span>, <span class="hljs-number">0xF6</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x55</span>, <br>    <span class="hljs-number">0x80</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0xEC</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0xC8</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x25</span>, <br>    <span class="hljs-number">0x7B</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0xE9</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0xC7</span><br>    &#125;;<br>    <br>    <span class="hljs-comment">//下面是在反编译TEA的基础上改的，直接解密Buf2</span><br>    <span class="hljs-type">uint32_t</span> Buf2[<span class="hljs-number">14</span>]; <span class="hljs-comment">// [rsp+20h] [rbp-60h] BYREF</span><br>    <span class="hljs-type">uint32_t</span> *key; <span class="hljs-comment">// [rsp+58h] [rbp-28h]</span><br>    <span class="hljs-comment">//void *Buf1; // [rsp+60h] [rbp-20h]</span><br>    <span class="hljs-type">int</span> j; <span class="hljs-comment">// [rsp+6Ch] [rbp-14h]</span><br>    <span class="hljs-type">int</span> sum; <span class="hljs-comment">// [rsp+70h] [rbp-10h]</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> p2; <span class="hljs-comment">// [rsp+74h] [rbp-Ch]</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> p1; <span class="hljs-comment">// [rsp+78h] [rbp-8h]</span><br>    <span class="hljs-type">int</span> i; <span class="hljs-comment">// [rsp+7Ch] [rbp-4h]</span><br><br>    <span class="hljs-comment">//Buf1 = a1;</span><br>    key = (<span class="hljs-type">uint32_t</span> *)Str2;<br>    Buf2[<span class="hljs-number">0</span>] = <span class="hljs-number">1111022553</span>;<br>    Buf2[<span class="hljs-number">1</span>] = <span class="hljs-number">987309029</span>;<br>    Buf2[<span class="hljs-number">2</span>] = <span class="hljs-number">-1041056711</span>;<br>    Buf2[<span class="hljs-number">3</span>] = <span class="hljs-number">979189025</span>;<br>    Buf2[<span class="hljs-number">4</span>] = <span class="hljs-number">189565873</span>;<br>    Buf2[<span class="hljs-number">5</span>] = <span class="hljs-number">173973774</span>;<br>    Buf2[<span class="hljs-number">6</span>] = <span class="hljs-number">1090109393</span>;<br>    Buf2[<span class="hljs-number">7</span>] = <span class="hljs-number">-591836169</span>;<br>    Buf2[<span class="hljs-number">8</span>] = <span class="hljs-number">-394857933</span>;<br>    Buf2[<span class="hljs-number">9</span>] = <span class="hljs-number">668605093</span>;<br>    Buf2[<span class="hljs-number">10</span>] = <span class="hljs-number">0xB952BACB</span>;<br>    <span class="hljs-comment">//这里原来是从&lt;Buf[0],Buf[1]&gt;到&lt;Buf[9],Buf[10]&gt;一对一对加密，现在反过来从&lt;Buf[9],Buf[10]&gt;开始到&lt;Buf[0],Buf[1]&gt;</span><br>    <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">9</span>; i &gt;= <span class="hljs-number">0</span>; --i )<br>    &#123;<br>        sum = <span class="hljs-number">0</span>;<br>        p1 = *((<span class="hljs-type">uint32_t</span>*)Buf2 + i);<br>        p2 = *((<span class="hljs-type">uint32_t</span>*)Buf2 + i + <span class="hljs-number">1</span>);<br>        sum = <span class="hljs-number">0x9E3779B9</span>;<br>        <span class="hljs-comment">//模拟正向加密得到最后的sum值</span><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; i++)&#123;<br>            sum-=<span class="hljs-number">0x61C88647</span>;<br>        &#125;<br>        <span class="hljs-comment">//p1，p2的处理顺序调换，加减调换，sum加减调换</span><br>        <span class="hljs-keyword">for</span> ( j = <span class="hljs-number">0</span>; j &lt;= <span class="hljs-number">31</span>; ++j )<br>        &#123;<br>        p2 -= (sum + p1) ^ (key[<span class="hljs-number">2</span>] + <span class="hljs-number">16</span> * p1) ^ ((p1 &gt;&gt; <span class="hljs-number">5</span>) + key[<span class="hljs-number">3</span>]);<br>        sum += <span class="hljs-number">0x61C88647</span>;<br>        p1 -= (sum + p2) ^ (*key + <span class="hljs-number">16</span> * p2) ^ ((p2 &gt;&gt; <span class="hljs-number">5</span>) + key[<span class="hljs-number">1</span>]);<br>        &#125;<br>        *((<span class="hljs-type">uint32_t</span>*)Buf2 + i) = p1;<br>        *((<span class="hljs-type">uint32_t</span>*)Buf2 + i + <span class="hljs-number">1</span>) = p2;<br>    &#125;<br>    RC4_decrypt((<span class="hljs-type">char</span> *)Buf2,<span class="hljs-number">44</span>);<br>    <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">44</span>;i++)<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>,((<span class="hljs-type">char</span> *)Buf2)[i]);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<blockquote>
<p>flag：0xGame{20994d4d-30ab-4918-b00a-5ca6ae138613}</p>
</blockquote>
<h2 id="花鸟风月"><a href="#花鸟风月" class="headerlink" title="花鸟风月"></a>花鸟风月</h2><blockquote>
<p>考点：花指令，魔改base64，异或，动态调试</p>
</blockquote>
<ul>
<li><p>附件程序运行起来是这样的：</p>
<p><img src="/../images/image-20251107170326209.png" alt="运行程序"></p>
<p>用IDA打开，Shift+F12在字符串窗口可以找到类似base64编码表的可疑字符串</p>
<p><img src="/../images/image-20251107171007199.png" alt="可疑的字符串"></p>
<p>随后可以跟踪到这样一个貌似base64编码的函数</p>
<p><img src="/../images/image-20251107171139700.png" alt="跟踪到一个类似base64编码的函数"></p>
<p>选中函数名按X回溯上层函数，会发现无法反编译了，栈帧报错</p>
<p><img src="/../images/image-20251107171338976.png" alt="栈帧报错"></p>
<p>在报错的附近可以看到反汇编失败的一堆数字，以及一个典型的jnz+jz花指令</p>
<p>选中上图中的loc_4012F2按U可以得到下图</p>
<p><img src="/../images/image-20251107172247039.png" alt="undefine"></p>
<p>此时只需要把jnz和jz以及后面的0E8h给nop掉即可，再选中unk_4012F3按C即可得到修正后的汇编代码</p>
<p><img src="/../images/image-20251107172437327.png" alt="修正后的汇编代码"></p>
<p>同样的花指令大概有3个，去除后可以在上文找到另一个报错</p>
<p><img src="/../images/image-20251107173258987.png" alt="另一个报错"></p>
<p>这里可以发现报错处的上一句是retn，所以把下面的loc_4012C0右键create function</p>
<p><img src="/../images/image-20251107173428095.png" alt="create function"></p>
<p>然后再回过头看这个报错，前面不远有一个很可疑的call $+5，显然是人为修改的</p>
<p><img src="/../images/image-20251112220409411.png" alt="可疑的call $+5"></p>
<p>仔细分析这段汇编代码会发现，这也是一个花指令</p>
<p><img src="/../images/image-20251112220643619.png" alt="分析汇编代码"></p>
<p>实际上程序在jz处不跳直接retn后，会回到xor eax,1这一行，原因是：call $+5即call 0x0040122D，又即push rip(0x0040122D)  jmp 0x0040122D，所以retn后程序回到栈上的rip(0x0040122D)处，即xor eax,1。IDA反编译会被这个retn给欺骗，误以为函数到此结束，其实后面还有一些内容。所以直接吧loc_401223这一整段nop掉，就可以得到完整的反编译代码</p>
<p><img src="/../images/image-20251113211300972.png" alt="完整的反编译代码"></p>
<p>优化一下这个函数和上文的类似base编码的函数的命名，可以得到。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs C"><span class="hljs-type">int</span> <span class="hljs-title function_">sub_4012C0</span><span class="hljs-params">()</span><br>&#123;<br>  <span class="hljs-type">char</span> *v0; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v1; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v2; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v3; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v5; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v6; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v7; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v8; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">int</span> v9; <span class="hljs-comment">// [esp-4h] [ebp-ECh]</span><br>  <span class="hljs-type">int</span> v10; <span class="hljs-comment">// [esp+10h] [ebp-D8h] BYREF</span><br>  <span class="hljs-type">int</span> v11; <span class="hljs-comment">// [esp+14h] [ebp-D4h]</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [esp+18h] [ebp-D0h]</span><br>  _BYTE v13[<span class="hljs-number">100</span>]; <span class="hljs-comment">// [esp+1Ch] [ebp-CCh] BYREF</span><br>  _BYTE v14[<span class="hljs-number">100</span>]; <span class="hljs-comment">// [esp+80h] [ebp-68h] BYREF</span><br><br>  v11 = <span class="hljs-number">0x81428113</span>;<br>  v0 = sub_401000((<span class="hljs-type">int</span>)&amp;unk_422054);<br>  sub_401670(v0);<br>  v1 = sub_401000((<span class="hljs-type">int</span>)&amp;unk_422068);<br>  sub_4016B0(v1, (<span class="hljs-type">char</span>)&amp;v10);<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; ++i )<br>  &#123;<br>    v11 = <span class="hljs-number">21106755</span> * v11 + <span class="hljs-number">1126795285</span>;<br>    v11 ^= __ROL4__(<br>             v10,<br>             i * (byte_422007 + byte_422004)<br>           % (byte_422008<br>            + byte_422004<br>            + byte_422005 * byte_422008<br>            + byte_422AA0 * (byte_422002 + byte_422006 + byte_422003)<br>            - byte_422005 * byte_422005));<br>  &#125;<br>  <span class="hljs-keyword">if</span> ( v11 == <span class="hljs-number">0xA745DA5D</span> )<br>  &#123;<br>    v2 = sub_401000((<span class="hljs-type">int</span>)&amp;unk_42206C);<br>    sub_401670(v2);<br>    v5 = sub_401000((<span class="hljs-type">int</span>)&amp;unk_422094);<br>    sub_401670(v5);<br>    v6 = sub_401000((<span class="hljs-type">int</span>)&amp;unk_4220A4);<br>    sub_4016B0(v6, (<span class="hljs-type">char</span>)v14);<br>    XORencrypt(v14, v10, byte_422004 + byte_422002 + byte_422008 * byte_422003);<br>    baseEncode((<span class="hljs-type">int</span>)v14, (<span class="hljs-type">int</span>)v13, byte_422005 + byte_422001 + byte_422008 * byte_422003);<br>    v9 = byte_422004 * byte_422003 * byte_422002;<br>    v7 = sub_401000((<span class="hljs-type">int</span>)&amp;unk_4220A8);<br>    <span class="hljs-keyword">if</span> ( sub_40B460(v13, v7, v9) )<br>      v8 = sub_401000((<span class="hljs-type">int</span>)&amp;unk_4220FC);<br>    <span class="hljs-keyword">else</span><br>      v8 = sub_401000((<span class="hljs-type">int</span>)&amp;unk_4220E8);<br>    sub_401670(v8);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    v3 = sub_401000((<span class="hljs-type">int</span>)&amp;unk_422080);<br>    sub_401670(v3);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>其中byte_42200x的值都是x+1，所以可以进一步优化</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs C"><span class="hljs-type">int</span> <span class="hljs-title function_">sub_4012C0</span><span class="hljs-params">()</span><br>&#123;<br>  <span class="hljs-type">char</span> *v0; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v1; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v2; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v3; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v5; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v6; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v7; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v8; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">int</span> v9; <span class="hljs-comment">// [esp-4h] [ebp-ECh]</span><br>  <span class="hljs-type">int</span> v10; <span class="hljs-comment">// [esp+10h] [ebp-D8h] BYREF</span><br>  <span class="hljs-type">int</span> v11; <span class="hljs-comment">// [esp+14h] [ebp-D4h]</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [esp+18h] [ebp-D0h]</span><br>  _BYTE v13[<span class="hljs-number">100</span>]; <span class="hljs-comment">// [esp+1Ch] [ebp-CCh] BYREF</span><br>  _BYTE v14[<span class="hljs-number">100</span>]; <span class="hljs-comment">// [esp+80h] [ebp-68h] BYREF</span><br><br>  v11 = <span class="hljs-number">0x81428113</span>;<br>  v0 = sub_401000((<span class="hljs-type">int</span>)&amp;unk_422054);<br>  sub_401670(v0);<br>  v1 = sub_401000((<span class="hljs-type">int</span>)&amp;unk_422068);<br>  sub_4016B0(v1, (<span class="hljs-type">char</span>)&amp;v10);<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; ++i )<br>  &#123;<br>    v11 = <span class="hljs-number">0x1421043</span> * v11 + <span class="hljs-number">0x43298815</span>;<br>    v11 ^= __ROL4__(v10, i * (<span class="hljs-number">8</span> + <span class="hljs-number">5</span>) % (<span class="hljs-number">9</span> + <span class="hljs-number">5</span> + <span class="hljs-number">6</span> * <span class="hljs-number">9</span> + <span class="hljs-number">0</span> * (<span class="hljs-number">3</span> + <span class="hljs-number">7</span> + <span class="hljs-number">4</span>) - <span class="hljs-number">6</span> * <span class="hljs-number">6</span>));<br>  &#125;<br>  <span class="hljs-keyword">if</span> ( v11 == <span class="hljs-number">0xA745DA5D</span> )<br>  &#123;<br>    v2 = sub_401000((<span class="hljs-type">int</span>)&amp;unk_42206C);<br>    sub_401670(v2);<br>    v5 = sub_401000((<span class="hljs-type">int</span>)&amp;unk_422094);<br>    sub_401670(v5);<br>    v6 = sub_401000((<span class="hljs-type">int</span>)&amp;unk_4220A4);<br>    sub_4016B0(v6, (<span class="hljs-type">char</span>)v14);<br>    XORencrypt(v14, v10, <span class="hljs-number">5</span> + <span class="hljs-number">3</span> + <span class="hljs-number">9</span> * <span class="hljs-number">4</span>);<br>    baseEncode((<span class="hljs-type">int</span>)v14, (<span class="hljs-type">int</span>)v13, <span class="hljs-number">6</span> + <span class="hljs-number">2</span> + <span class="hljs-number">9</span> * <span class="hljs-number">4</span>);<br>    v9 = <span class="hljs-number">5</span> * <span class="hljs-number">4</span> * <span class="hljs-number">3</span>;<br>    v7 = sub_401000((<span class="hljs-type">int</span>)&amp;unk_4220A8);<br>    <span class="hljs-keyword">if</span> ( sub_40B460(v13, v7, v9) )<br>      v8 = sub_401000((<span class="hljs-type">int</span>)&amp;unk_4220FC);<br>    <span class="hljs-keyword">else</span><br>      v8 = sub_401000((<span class="hljs-type">int</span>)&amp;unk_4220E8);<br>    sub_401670(v8);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    v3 = sub_401000((<span class="hljs-type">int</span>)&amp;unk_422080);<br>    sub_401670(v3);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>动调可以发现程序的提示词是实时解密的，sub_401000是解密函数，sub_401670是输出函数，sub_4016B0是输入函数。下面是具体过程：</p>
<p>在函数的开头下断点，开始调试。程序停在了下图这个地方，可以看到随后有一些奇怪的数据，直接nop掉</p>
<p><img src="/../images/image-20251107211205450.png" alt="奇怪的数据"></p>
<p><img src="/../images/image-20251107211234103.png" alt="nop掉"></p>
<p>继续运行程序会发现执行过sub_7C1670（对应静态分析时的sub_401670，动态调试换基址了所以地址前两位有些不同）后程序会有提示输出，因此推断sub_7C1670是print</p>
<p><img src="/../images/image-20251107212238679.png" alt="提示输出"></p>
<p>而观察静态分析时的代码可以发现，sub_401000几乎和sub_401670是同时出现的，动态调试对应的sub_7C1000函数反编译如下</p>
<p><img src="/../images/image-20251107212753102.png" alt="sub_7C1000反编译"></p>
<p>同时可以发现byte_7E3440此时存储的正好是Input key (Hex) （此时已经步过这个函数了，所以byte_7E3440已经被处理过了）:</p>
<p><img src="/../images/image-20251107212917688.png" alt="byte_7E3440"></p>
<p>所以可以推测提示词是实时解密的，sub_401000是解密函数</p>
<p>接下来还有个sub_7C16B0，推测是scanf</p>
<p><img src="/../images/image-20251107215116511.png" alt="sub_7C16B0"></p>
<p>在动态调试随后的代码里，会发现还有花指令（有两处，不知道是不是静态分析时的去混淆没有保存）</p>
<p><img src="/../images/image-20251107215446744.png" alt="花指令"></p>
<p>同样的操作nop掉后，反编译得到</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs C"><span class="hljs-type">void</span> <span class="hljs-title function_">sub_7C12C0</span><span class="hljs-params">()</span><br>&#123;<br>  <span class="hljs-type">char</span> *v0; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v1; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v2; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v3; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v4; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v5; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v6; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v7; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">int</span> v8; <span class="hljs-comment">// [esp-4h] [ebp-ECh]</span><br>  <span class="hljs-type">int</span> v9; <span class="hljs-comment">// [esp+10h] [ebp-D8h] BYREF</span><br>  <span class="hljs-type">int</span> v10; <span class="hljs-comment">// [esp+14h] [ebp-D4h]</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [esp+18h] [ebp-D0h]</span><br>  _BYTE v12[<span class="hljs-number">100</span>]; <span class="hljs-comment">// [esp+1Ch] [ebp-CCh] BYREF</span><br>  _BYTE v13[<span class="hljs-number">100</span>]; <span class="hljs-comment">// [esp+80h] [ebp-68h] BYREF</span><br><br>  v10 = <span class="hljs-number">0x81428113</span>;<br>  v0 = decodeNotice((<span class="hljs-type">int</span>)&amp;unk_7E2054);<br>  print(v0);<br>  v1 = decodeNotice((<span class="hljs-type">int</span>)&amp;unk_7E2068);<br>  <span class="hljs-built_in">scanf</span>(v1, (<span class="hljs-type">char</span>)&amp;v9);<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; ++i )<br>  &#123;<br>    v10 = <span class="hljs-number">0x1421043</span> * v10 + <span class="hljs-number">0x43298815</span>;<br>    v10 ^= __ROL4__(v9, i * (<span class="hljs-number">8</span> + <span class="hljs-number">5</span>) % (<span class="hljs-number">9</span> + <span class="hljs-number">5</span> + <span class="hljs-number">6</span> * <span class="hljs-number">9</span> + <span class="hljs-number">0</span> * (<span class="hljs-number">3</span> + <span class="hljs-number">7</span> + <span class="hljs-number">4</span>) - <span class="hljs-number">6</span> * <span class="hljs-number">6</span>));<br>  &#125;<br>  <span class="hljs-keyword">if</span> ( v10 == <span class="hljs-number">0xA745DA5D</span> )<br>  &#123;<br>    v2 = decodeNotice((<span class="hljs-type">int</span>)&amp;unk_7E206C);<br>    print(v2);<br>    v4 = decodeNotice((<span class="hljs-type">int</span>)&amp;unk_7E2094);<br>    print(v4);<br>    v5 = decodeNotice((<span class="hljs-type">int</span>)&amp;unk_7E20A4);<br>    <span class="hljs-built_in">scanf</span>(v5, (<span class="hljs-type">char</span>)v13);<br>    XORencrypt((<span class="hljs-type">int</span>)v13, v9, <span class="hljs-number">5</span> + <span class="hljs-number">3</span> + <span class="hljs-number">9</span> * <span class="hljs-number">4</span>);<br>    baseEncode((<span class="hljs-type">int</span>)v13, (<span class="hljs-type">int</span>)v12, <span class="hljs-number">6</span> + <span class="hljs-number">2</span> + <span class="hljs-number">9</span> * <span class="hljs-number">4</span>);<br>    v8 = <span class="hljs-number">5</span> * <span class="hljs-number">4</span> * <span class="hljs-number">3</span>;<br>    v6 = decodeNotice((<span class="hljs-type">int</span>)&amp;unk_7E20A8);<br>    <span class="hljs-keyword">if</span> ( sub_7CB460(v12, v6, v8) )<br>      v7 = decodeNotice((<span class="hljs-type">int</span>)&amp;unk_7E20FC);<br>    <span class="hljs-keyword">else</span><br>      v7 = decodeNotice((<span class="hljs-type">int</span>)&amp;unk_7E20E8);<br>    print(v7);<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    v3 = decodeNotice((<span class="hljs-type">int</span>)&amp;unk_7E2080);<br>    print(v3);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>此时得到更加清晰的代码了，同时可以发现程序首先对输入的key进行了校验。</p>
<p>为了继续了解程序逻辑，这里选择修改if语句条件的判断结果来绕过key检验，只需要在cmp后修改ZF标志位，让jnz不成立即可</p>
<p><img src="/../images/image-20251107220443790.png" alt="绕过key检验"></p>
<p><img src="/../images/image-20251107220708346.png" alt="成功绕过key检验"></p>
<p>继续运行程序会有输入flag的提示</p>
<p><img src="/../images/image-20251107220805016.png" alt="输入flag的提示"></p>
<p>至此，可以猜出程序的大致逻辑：接收一个key并进行检验，检验成功则继续检验flag，同时需要注意key会作为flag检验的一个参数。下面是优化后的最终代码</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs C"><span class="hljs-type">void</span> <span class="hljs-title function_">sub_7C12C0</span><span class="hljs-params">()</span><br>&#123;<br>  <span class="hljs-type">char</span> *v0; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v1; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v2; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v3; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v4; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v5; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *targetResult; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v7; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">int</span> v8; <span class="hljs-comment">// [esp-4h] [ebp-ECh]</span><br>  <span class="hljs-type">int</span> key; <span class="hljs-comment">// [esp+10h] [ebp-D8h] BYREF</span><br>  <span class="hljs-type">int</span> v10; <span class="hljs-comment">// [esp+14h] [ebp-D4h]</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [esp+18h] [ebp-D0h]</span><br>  _BYTE encodedInput[<span class="hljs-number">100</span>]; <span class="hljs-comment">// [esp+1Ch] [ebp-CCh] BYREF</span><br>  _BYTE input[<span class="hljs-number">100</span>]; <span class="hljs-comment">// [esp+80h] [ebp-68h] BYREF</span><br><br>  v10 = <span class="hljs-number">0x81428113</span>;<br>  v0 = decodeNotice((<span class="hljs-type">int</span>)&amp;unk_7E2054);          <span class="hljs-comment">// input key</span><br>  print(v0);<br>  v1 = decodeNotice((<span class="hljs-type">int</span>)&amp;unk_7E2068);<br>  <span class="hljs-built_in">scanf</span>(v1, (<span class="hljs-type">char</span>)&amp;key);<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; ++i )<br>  &#123;<br>    v10 = <span class="hljs-number">0x1421043</span> * v10 + <span class="hljs-number">0x43298815</span>;<br>    v10 ^= __ROL4__(key, i * (<span class="hljs-number">8</span> + <span class="hljs-number">5</span>) % (<span class="hljs-number">9</span> + <span class="hljs-number">5</span> + <span class="hljs-number">6</span> * <span class="hljs-number">9</span> + <span class="hljs-number">0</span> * (<span class="hljs-number">3</span> + <span class="hljs-number">7</span> + <span class="hljs-number">4</span>) - <span class="hljs-number">6</span> * <span class="hljs-number">6</span>));<br>  &#125;<br>  <span class="hljs-keyword">if</span> ( v10 == <span class="hljs-number">0xA745DA5D</span> )<br>  &#123;<br>    v2 = decodeNotice((<span class="hljs-type">int</span>)&amp;unk_7E206C);        <span class="hljs-comment">// key is correct</span><br>    print(v2);<br>    v4 = decodeNotice((<span class="hljs-type">int</span>)&amp;unk_7E2094);        <span class="hljs-comment">// input flag</span><br>    print(v4);<br>    v5 = decodeNotice((<span class="hljs-type">int</span>)&amp;unk_7E20A4);<br>    <span class="hljs-built_in">scanf</span>(v5, (<span class="hljs-type">char</span>)input);<br>    XORencrypt((<span class="hljs-type">int</span>)input, key, <span class="hljs-number">5</span> + <span class="hljs-number">3</span> + <span class="hljs-number">9</span> * <span class="hljs-number">4</span>);<br>    baseEncode((<span class="hljs-type">int</span>)input, (<span class="hljs-type">int</span>)encodedInput, <span class="hljs-number">6</span> + <span class="hljs-number">2</span> + <span class="hljs-number">9</span> * <span class="hljs-number">4</span>);<br>    v8 = <span class="hljs-number">5</span> * <span class="hljs-number">4</span> * <span class="hljs-number">3</span>;<br>    targetResult = decodeNotice((<span class="hljs-type">int</span>)&amp;unk_7E20A8);<span class="hljs-comment">// 此处解密的值被用来和输入值的加密结果进行比较了，所以推测是真正的flag密文</span><br>    <span class="hljs-keyword">if</span> ( <span class="hljs-built_in">strcmp</span>(encodedInput, targetResult, v8) )<br>      v7 = decodeNotice((<span class="hljs-type">int</span>)&amp;unk_7E20FC);<br>    <span class="hljs-keyword">else</span><br>      v7 = decodeNotice((<span class="hljs-type">int</span>)&amp;unk_7E20E8);<br>    print(v7);<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    v3 = decodeNotice((<span class="hljs-type">int</span>)&amp;unk_7E2080);<br>    print(v3);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>targetResult也是实时解密的结果，所以可以动调提取</p>
<p>程序的加密流程是先XORencrypt再baseEncode，所以解密要先baseDecode再XORenc。baseEncode优化后如下，可以发现不是标准的base64编码</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs C"><span class="hljs-type">int</span> __cdecl <span class="hljs-title function_">baseEncode</span><span class="hljs-params">(<span class="hljs-type">int</span> input, <span class="hljs-type">int</span> output, <span class="hljs-type">int</span> length)</span><br>&#123;<br>  <span class="hljs-type">int</span> result; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> code2; <span class="hljs-comment">// [esp+Ah] [ebp-56h]</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [esp+Ch] [ebp-54h]</span><br>  <span class="hljs-type">char</span> code4; <span class="hljs-comment">// [esp+12h] [ebp-4Eh]</span><br>  <span class="hljs-type">char</span> code3; <span class="hljs-comment">// [esp+13h] [ebp-4Dh]</span><br>  <span class="hljs-type">int</span> v8; <span class="hljs-comment">// [esp+14h] [ebp-4Ch]</span><br>  <span class="hljs-type">int</span> v9; <span class="hljs-comment">// [esp+14h] [ebp-4Ch]</span><br>  <span class="hljs-type">char</span> baseTable[<span class="hljs-number">68</span>]; <span class="hljs-comment">// [esp+18h] [ebp-48h] BYREF</span><br><br>  v8 = <span class="hljs-number">0</span>;<br>  <span class="hljs-built_in">strcpy</span>(baseTable, <span class="hljs-string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span>);<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; length; i += <span class="hljs-number">3</span> )<br>  &#123;<br>    code3 = baseTable[((*(i + input + <span class="hljs-number">1</span>) &gt;&gt; <span class="hljs-number">4</span>) | (<span class="hljs-number">16</span> * *(i + input))) &amp; <span class="hljs-number">63</span>];<span class="hljs-comment">// baseTable[((input[i+1]&gt;&gt;4)|(input[i]&lt;&lt;4))&amp;63]</span><br>    <span class="hljs-keyword">if</span> ( i + <span class="hljs-number">1</span> &gt;= length )<br>      code3 = <span class="hljs-string">&#x27;=&#x27;</span>;<br>    <span class="hljs-keyword">else</span><br>      code2 = baseTable[((*(i + input + <span class="hljs-number">2</span>) &gt;&gt; <span class="hljs-number">6</span>) | (<span class="hljs-number">4</span> * *(i + input + <span class="hljs-number">1</span>))) &amp; <span class="hljs-number">63</span>];<span class="hljs-comment">// baseTable[((input[i+2]&gt;&gt;6)|(input[i+1]&lt;&lt;2))&amp;63]</span><br>    <span class="hljs-keyword">if</span> ( i + <span class="hljs-number">2</span> &gt;= length )<br>      code4 = <span class="hljs-string">&#x27;=&#x27;</span>;<br>    <span class="hljs-keyword">else</span><br>      code4 = baseTable[*(i + input + <span class="hljs-number">2</span>) &amp; <span class="hljs-number">63</span>]; <span class="hljs-comment">// baseTable[input[i+2]&amp;63]</span><br>    *(v8 + output) = baseTable[(*(i + input) &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">63</span>];<span class="hljs-comment">// baseTable[(input[i]&gt;&gt;2)&amp;63]</span><br>    v9 = v8 + <span class="hljs-number">1</span>;<br>    *(v9 + output) = code2;<br>    *(++v9 + output) = code3;<br>    *(++v9 + output) = code4;<br>    v8 = v9 + <span class="hljs-number">1</span>;<br>    result = i + <span class="hljs-number">3</span>;<br>  &#125;<br>  *(v8 + output) = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>标准base64编码是按照字符顺序，把3个8bit的char转成4个6bit，即</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs C">code1=baseTable[input[i]&gt;&gt;<span class="hljs-number">2</span>];<br>code2=baseTable[(input[i]&lt;&lt;<span class="hljs-number">6</span>)|(input[i+<span class="hljs-number">1</span>]&gt;&gt;<span class="hljs-number">4</span>)];<br>code3=baseTable[(input[i+<span class="hljs-number">1</span>]&lt;&lt;<span class="hljs-number">4</span>)|(input[i+<span class="hljs-number">2</span>]&gt;&gt;<span class="hljs-number">6</span>)];<br>code4=baseTable[input[i+<span class="hljs-number">2</span>]&lt;&lt;<span class="hljs-number">2</span>];<br></code></pre></td></tr></table></figure>

<p>而程序里code2和code3顺序反了</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs C">code1=baseTable[(input[i]&gt;&gt;<span class="hljs-number">2</span>)&amp;<span class="hljs-number">63</span>];<br>code2=baseTable[((input[i+<span class="hljs-number">1</span>]&lt;&lt;<span class="hljs-number">2</span>)|(input[i+<span class="hljs-number">2</span>]&gt;&gt;<span class="hljs-number">6</span>))&amp;<span class="hljs-number">63</span>];<br>code3=baseTable[((input[i]&lt;&lt;<span class="hljs-number">4</span>)|(input[i+<span class="hljs-number">1</span>]&gt;&gt;<span class="hljs-number">4</span>))&amp;<span class="hljs-number">63</span>];<br>code4=baseTable[input[i+<span class="hljs-number">2</span>]&amp;<span class="hljs-number">63</span>];<br><span class="hljs-comment">//PS：这里因为&amp;了63，所以拼成8位的code被截掉了高2位，剩下6位</span><br></code></pre></td></tr></table></figure>

<p>也就是说，程序的魔改base64编码和标准base64编码的不同点在于，编码时置换了第2、3个字符。因此我们此处的解密就是把每4个字符的第2、3个字符互换位置，然后使用标准base64解码即可。下面是basedecode的脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><br>enc=[<span class="hljs-number">0x4D</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x3D</span>]<br>basedecoded=<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(enc),<span class="hljs-number">4</span>):<br>    basedecoded+=<span class="hljs-built_in">chr</span>(enc[i])<br>    basedecoded+=<span class="hljs-built_in">chr</span>(enc[i+<span class="hljs-number">2</span>])<br>    basedecoded+=<span class="hljs-built_in">chr</span>(enc[i+<span class="hljs-number">1</span>])<br>    basedecoded+=<span class="hljs-built_in">chr</span>(enc[i+<span class="hljs-number">3</span>])<br><span class="hljs-built_in">print</span>(basedecoded)<br><span class="hljs-comment">#MPADcG3tP3Q4v3MpNbB1PGWxcHctvHx1NaV9JTPtaSc57iIlNu5xJWS5Imw=</span><br>xorencoded=base64.b64decode(basedecoded)<br></code></pre></td></tr></table></figure>

<p>接下来是XORdecrypt。首先需要得到密钥，既然程序给了密钥的检验算法，可以复现这个算法来爆破密钥。下面是爆破脚本：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs C"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> __ROL4__(x, y)   ((((x) <span class="hljs-string">&lt;&lt; (y)) | ((x) &gt;</span>&gt; (32 - (y))))&amp;0xFFFFFFFF)</span><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v9,key;<br>    <span class="hljs-keyword">for</span>(key=<span class="hljs-number">0</span>;key&lt;=<span class="hljs-number">0xFFFFFFFF</span>;key++)&#123;<br>        v9 = <span class="hljs-number">0x81428113</span>;<br>        <span class="hljs-keyword">for</span> ( <span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; ++i )<br>        &#123;<br>            v9 = <span class="hljs-number">0x1421043</span> * v9 + <span class="hljs-number">0x43298815</span>;<br>            v9 ^= __ROL4__(key, i * (<span class="hljs-number">8</span> + <span class="hljs-number">5</span>) % (<span class="hljs-number">9</span> + <span class="hljs-number">5</span> + <span class="hljs-number">6</span> * <span class="hljs-number">9</span> + <span class="hljs-number">0</span> * (<span class="hljs-number">3</span> + <span class="hljs-number">7</span> + <span class="hljs-number">4</span>) - <span class="hljs-number">6</span> * <span class="hljs-number">6</span>));<br>        &#125;<br>        <span class="hljs-keyword">if</span> ( v9 == <span class="hljs-number">0xA745DA5D</span> )<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;key: 0x%08x\n&quot;</span>,key);<br>        &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><span class="hljs-comment">//key: 0x98bf3b77</span><br></code></pre></td></tr></table></figure>

<p>然后是XOR解密，由于异或过程中不涉及密文前后位，只是单纯使用key，所以只需要复现异或过程就行了。但是照抄也不是很对，XORencrypt使用key的时候是进行了取位操作，把key分成了四个部分的，所以这部分要单独拿出来处理。脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">XORdecrypt</span>(<span class="hljs-params">data, key</span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">44</span>):<br>        key_byte=(key &gt;&gt; (<span class="hljs-number">8</span> * (i % <span class="hljs-number">4</span>)))&amp;<span class="hljs-number">0xff</span><span class="hljs-comment">#单独处理每次使用的key，每次只取四分之一，直接抄原代码没有&amp;0xff的话会解密失败。</span><br>        data[i]^=key_byte<br>        data[i]=data[i]&amp;<span class="hljs-number">0xff</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">44</span>):<br>        key_byte=(key &gt;&gt; (<span class="hljs-number">8</span> * (j % <span class="hljs-number">4</span>)))&amp;<span class="hljs-number">0xff</span><br>        data[j]^=((key_byte &gt;&gt; <span class="hljs-number">4</span>) | (<span class="hljs-number">16</span> * key_byte))<br>        data[j]=data[j]&amp;<span class="hljs-number">0xff</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(data)<br></code></pre></td></tr></table></figure>

<p>完整脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">XORdecrypt</span>(<span class="hljs-params">data, key</span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">44</span>):<br>        key_byte=(key &gt;&gt; (<span class="hljs-number">8</span> * (i % <span class="hljs-number">4</span>)))&amp;<span class="hljs-number">0xff</span><br>        data[i]^=key_byte<br>        data[i]=data[i]&amp;<span class="hljs-number">0xff</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">44</span>):<br>        key_byte=(key &gt;&gt; (<span class="hljs-number">8</span> * (j % <span class="hljs-number">4</span>)))&amp;<span class="hljs-number">0xff</span><br>        data[j]^=((key_byte &gt;&gt; <span class="hljs-number">4</span>) | (<span class="hljs-number">16</span> * key_byte))<br>        data[j]=data[j]&amp;<span class="hljs-number">0xff</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(data)<br><br>enc=[<span class="hljs-number">0x4D</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x3D</span>]<br>basedecoded=<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(enc),<span class="hljs-number">4</span>):<br>    basedecoded+=<span class="hljs-built_in">chr</span>(enc[i])<br>    basedecoded+=<span class="hljs-built_in">chr</span>(enc[i+<span class="hljs-number">2</span>])<br>    basedecoded+=<span class="hljs-built_in">chr</span>(enc[i+<span class="hljs-number">1</span>])<br>    basedecoded+=<span class="hljs-built_in">chr</span>(enc[i+<span class="hljs-number">3</span>])<br><span class="hljs-comment">#print(basedecoded)</span><br>xorencoded=base64.b64decode(basedecoded)<br><span class="hljs-comment">#print(len(xorencoded))</span><br>flag=XORdecrypt(<span class="hljs-built_in">list</span>(xorencoded),<span class="hljs-number">0x98bf3b77</span>)<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure></li>
</ul>
<blockquote>
<p>flag：0xGame{e8778581-e94f-48d5-943e-69ff46f54d1f}</p>
</blockquote>
<h2 id="云消雾散"><a href="#云消雾散" class="headerlink" title="云消雾散"></a>云消雾散</h2><ul>
<li>待更新</li>
</ul>
<h2 id="蔷薇地狱"><a href="#蔷薇地狱" class="headerlink" title="蔷薇地狱"></a>蔷薇地狱</h2><ul>
<li>待更新</li>
</ul>
</div><div class="article-licensing box"><div class="licensing-title"><p>0xGame2025Week4WriteUp</p><p><a href="https://sydzi.github.io/2025/11/16/0xGame2025Week4ReverseWriteUp/">https://sydzi.github.io/2025/11/16/0xGame2025Week4ReverseWriteUp/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><p>SydzI</p></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2025-11-16</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2025-11-16</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/CTF/">CTF</a><a class="link-muted mr-2" rel="tag" href="/tags/WriteUp/">WriteUp</a><a class="link-muted mr-2" rel="tag" href="/tags/Reverse/">Reverse</a></div><div class="sharethis-inline-share-buttons"></div><script src="https://platform-api.sharethis.com/js/sharethis.js#property=68b654c479868da1c7122aa1&amp;product=inline-share-buttons" defer></script><nav class="post-navigation mt-4 mb-2 level is-mobile"><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2025/11/03/week35-week38/"><span class="level-item">week35-week38</span><i class="level-item fas fa-chevron-right"></i></a></div></nav></article></div><!--!--><div class="card" id="comments"><div class="card-content"><h3 class="title is-5">评论</h3><script src="https://utteranc.es/client.js" repo="sydzi/sydzi.github.io" issue-term="pathname" theme="github-light" crossorigin="anonymous" async></script></div></div></div><div class="column column-left is-4-tablet is-3-desktop is-3-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/img/avatar.jpg" alt="SydzI"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">SydzI</p><p class="is-size-6 is-block">Action over inaction</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Nanjing, China</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives/"><p class="title">33</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories/"><p class="title">6</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags/"><p class="title">10</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/SydzI" target="_blank" rel="me noopener">关注我</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Github" href="https://github.com/SydzI"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="RSS" href="/atom.xml"><i class="fas fa-rss"></i></a></div></div></div><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="level is-mobile" href="#镜渊折枝"><span class="level-left"><span class="level-item">1</span><span class="level-item">镜渊折枝</span></span></a></li><li><a class="level is-mobile" href="#夜雀之歌"><span class="level-left"><span class="level-item">2</span><span class="level-item">夜雀之歌</span></span></a></li><li><a class="level is-mobile" href="#绯想天则"><span class="level-left"><span class="level-item">3</span><span class="level-item">绯想天则</span></span></a></li><li><a class="level is-mobile" href="#幻视调律"><span class="level-left"><span class="level-item">4</span><span class="level-item">幻视调律</span></span></a></li><li><a class="level is-mobile" href="#花鸟风月"><span class="level-left"><span class="level-item">5</span><span class="level-item">花鸟风月</span></span></a></li><li><a class="level is-mobile" href="#云消雾散"><span class="level-left"><span class="level-item">6</span><span class="level-item">云消雾散</span></span></a></li><li><a class="level is-mobile" href="#蔷薇地狱"><span class="level-left"><span class="level-item">7</span><span class="level-item">蔷薇地狱</span></span></a></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/">SydzI&#039;s Blog</a><p class="is-size-7"><span>&copy; 2025 SydzI</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="fab fa-creative-commons-nc"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script>moment.locale("zh-cn");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            },
            services: {
                firebase: {"enable":true,"collection":"articles","apiKey":"AIzaSyCL4X3DgCuPZ09mSUIYiIzwCrbKdVcf_jY","projectId":"sydzi-s-blog-counter"}
            }
        };</script><script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-app-compat.js"></script><script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-firestore-compat.js"></script><script data-pjax src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script data-pjax src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js"></script><script src="/js/pjax.js"></script><!--!--><!--!--><!--!--><script data-pjax src="/js/main.js" defer></script><script data-pjax src="/js/firebase_counter.js" defer></script><script src="/js/night.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script data-pjax src="/js/insight.js" defer></script><script data-pjax>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/wanko.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"css":false});</script></body></html>